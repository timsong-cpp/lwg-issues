<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 2518: [fund.ts.v2] Non-member swap for propagate_const should call member swap</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<p>Revised 2016-11-16 at 09:11:03 UTC</p>
<hr>
<h3><a name="2518" href="2518">2518.</a> [fund.ts.v2] Non-member <tt>swap</tt> for <tt>propagate_const</tt> should call member <tt>swap</tt></h3>
<p><b>Section:</b> 99 [fund.ts.v2::propagate_const.algorithms] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2015-07-08 <b>Last modified:</b> 2016-11-16</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v2</b></p>
<p>
For consistency with the rest of the standard library, the non-member <tt>swap</tt> for <tt>propagate_const</tt> should 
call member <tt>swap</tt>.
</p>

<p><i>[2015-07, Telecom]</i></p>

<p>
Both P3 and NAD were suggested.
</p>

<p><i>[2016-02-20, Ville comments]</i></p>

<p>
Feedback from an implementation:
<p/>
The implementation of <tt>propagate_const</tt> in libstdc++ calls <tt>propagate_const</tt>'s
member <tt>swap</tt> from the non-member <tt>swap</tt>.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4529.html">N4529</a>.
</p>

<ol>
<li><p>Edit [propagate_const.algorithms] as indicated:</p>
<blockquote>
<pre>
-1- template &lt;class T&gt;
constexpr void swap(propagate_const&lt;T&gt;&amp; pt1, propagate_const&lt;T&gt;&amp; pt2) noexcept(<i>see below</i>)
</pre>
<blockquote>
<p>
-2- The constant-expression in the exception-specification is <tt>noexcept(<del>swap(pt1.t_, pt2.t_)</del><ins>pt1.swap(pt2)</ins>)</tt>.
<p/>
-3- <i>Effects</i>: <tt><del>swap(pt1.t_, pt2.t_)</del><ins>pt1.swap(pt2)</ins></tt>. 
</p>
</blockquote>
</blockquote>
</li>
</ol>





</body>
</html>
