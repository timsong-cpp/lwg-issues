<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 1258: std::function Effects clause impossible to satisfy</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<hr>
<h3><a name="1258" href="1258">1258.</a> std::function Effects clause impossible to satisfy</h3>
<p><b>Section:</b> 20.14.13.2.2 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.mod">[func.wrap.func.mod]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Resolved</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2009-11-05 <b>Last modified:</b> 2016-01-28 10:01:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Resolved">Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
As of 20.14.13.2.2 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.mod">[func.wrap.func.mod]</a>/2+ we have the following
prototype description:
</p>

<blockquote><pre>
template&lt;class F, Allocator Alloc&gt;
  void assign(F, const Alloc&amp;);
</pre>
<blockquote><p>
<i>Effects:</i> <tt>function(f, a).swap(*this)</tt>
</p></blockquote>
</blockquote>

<p>
Two things: First the concept debris needs to be removed, second and
much more importantly, the effects clause is now impossible to satisfy,
because there is no constructor that would match the parameter sequence
(<tt>FunctionObject</tt>, <tt>Allocator</tt>) [plus the fact that no
<tt>f</tt> and no <tt>a</tt> is part of the signature]. The most
probable candidate is
</p>

<blockquote><pre>
template&lt;class F, class A&gt; function(allocator_arg_t, const A&amp;, F);
</pre></blockquote>

<p>
and the effects clause needs to be adapted to use this signature.
</p>

<p><i>[
2009-11-13 Daniel brought wording up to date.
]</i></p>


<p><i>[
2009-11-15 Moved to Tentatively Ready after 5 positive votes on c++std-lib.
]</i></p>


<p><i>[
2010-02-11 Moved to Tentatively NAD Editorial after 5 positive votes on
c++std-lib.  It was noted that this issue was in partial conflict with <a href="1288">1288</a>, and the two issues were merged in <a href="1288">1288</a>.
]</i></p>


<p><b>Rationale:</b></p>
<p>
Addressed by <a href="1288">1288</a>.
</p>




<p><b>Proposed resolution:</b></p>
<p>
Change in 20.14.13.2.2 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.mod">[func.wrap.func.mod]</a> the complete prototype description as
indicated
</p>
<p><i>[
Question to
the editor: Shouldn't there a paragraph number in front of the Effects clause?
]</i></p>


<blockquote><pre>
template&lt;class F, <del>Allocator Alloc</del><ins>class A</ins>>
  void assign(F <ins>f</ins>, const A<del>lloc</del>&amp; <ins>a</ins>);
</pre>
<blockquote><p>
<ins>3</ins> <i>Effects:</i> <tt>function(<del>f, a</del><ins>allocator_arg, a,
f</ins>).swap(*this)</tt>
</p></blockquote>
</blockquote>





</body>
</html>
