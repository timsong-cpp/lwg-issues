<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 729: Problem in [rand.req.eng]/3</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<hr>
<h3><a name="729" href="lwg-closed.html#729">729.</a> Problem in [rand.req.eng]/3</h3>
<p><b>Section:</b> 29.6.1.4 <a href="https://timsong-cpp.github.io/cppwp/rand.req.eng">[rand.req.eng]</a> <b>Status:</b> <a href="lwg-active.html#NAD">NAD</a>
 <b>Submitter:</b> Stephan Tolksdorf <b>Opened:</b> 2007-09-21 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#rand.req.eng">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/rand.req.eng">[rand.req.eng]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#NAD">NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The 3rd table row in 29.6.1.4 <a href="https://timsong-cpp.github.io/cppwp/rand.req.eng">[rand.req.eng]</a>/3 requires random number engines to accept any 
arithmetic type as a seed, which is then casted to the engine's <tt>result_type</tt> and subsequently 
used for seeding the state of the engine. The requirement stated as "Creates an engine with 
initial state determined by <tt>static_cast&lt;X::result_type&gt;(s)</tt>" forces random number engines 
to either use a seeding method that completely depends on the <tt>result_type</tt> (see the discussion 
of seeding for the <tt>mersenne_twister_engine</tt> in point T2 above) or at least to throw away "bits 
of randomness" in the seed value if the <tt>result_type</tt> is smaller than the seed type. This seems 
to be inappropriate for many modern random number generators, in particular F2-linear or 
cryptographic ones, which operate on an internal bit array that in principle is independent of the 
type of numbers returned.
</p>

<p>
<b>Possible resolution:</b> I propose to change the wording to a version similar to "Creates an 
engine with initial state determined by <tt>static_cast&lt;UintType&gt;(s)</tt>, where <tt>UintType</tt> is an 
implementation specific unsigned integer type."
</p>

<p>
Additionally, the definition of s in 29.6.1.4 <a href="https://timsong-cpp.github.io/cppwp/rand.req.eng">[rand.req.eng]</a>/1 c) could be restricted to unsigned integer types.
</p>

<p>
Similarly, the type of the seed in 29.6.1.5 <a href="https://timsong-cpp.github.io/cppwp/rand.req.adapt">[rand.req.adapt]</a>/3 e) could be left unspecified.
</p>

<p>
See <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2424.pdf">N2424</a>
for further discussion.
</p>

<p><i>[
Stephan Tolksdorf adds pre-Bellevue:
]</i></p>


<blockquote>
<p>
In reply to the discussion in
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2424.pdf">N2424</a>
regarding this issue:
</p>
<p>
The descriptions of all engines and engine adaptors given in sections
29.6.3 <a href="https://timsong-cpp.github.io/cppwp/rand.eng">[rand.eng]</a> and 29.6.4 <a href="https://timsong-cpp.github.io/cppwp/rand.adapt">[rand.adapt]</a> already specify the concrete
types of the integer arguments for seeding. Hence, relaxing the general
requirement in 29.6.1.4 <a href="https://timsong-cpp.github.io/cppwp/rand.req.eng">[rand.req.eng]</a> would not affect portability and
reproducibility of the standard library. Furthermore, it is not clear to
me what exactly the guarantee "with initial state determined by
<tt>static_cast&lt;X::result_type&gt;(s)</tt>" is useful for. On the other hand,
relaxing the requirement would allow developers to implement  other
random number engines that do not have to cast all arithmetic seed
arguments to their result_types.
</p>
</blockquote>

<p><i>[
Bellevue:
]</i></p>


<blockquote><p>
Propose close NAD for the reasons given in N2424.
</p></blockquote>




<p><b>Proposed resolution:</b></p>
<p>
See <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2424.pdf">N2424</a>
for further discussion.
</p>

<p><i>[
Stephan Tolksdorf adds pre-Bellevue:
]</i></p>


<blockquote>
<p>
Change row 3 of table 105 "Random number engine requirements" in 29.6.1.4 <a href="https://timsong-cpp.github.io/cppwp/rand.req.eng">[rand.req.eng]</a>/3
</p>

<blockquote><p>
Creates an engine with initial state determined by
<tt><del>static_cast&lt;X::result_type&gt;(</del>s<del>)</del></tt>
</p></blockquote>

<p>
Similarly, change 29.6.1.5 <a href="https://timsong-cpp.github.io/cppwp/rand.req.adapt">[rand.req.adapt]</a>/3 e)
</p>

<blockquote><p>
When <tt>X::X</tt> is invoked with <del>an <tt>X::result_type</tt></del> value <tt>s</tt>
<ins>of arithmetic type (3.9.1)</ins>, ...
</p></blockquote>

</blockquote>






</body>
</html>
