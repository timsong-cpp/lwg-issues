<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 2802: shared_ptr constructor requirements for a deleter</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<p>Revised 2016-11-30 at 07:11:35 UTC</p>
<hr>
<h3><a name="2802" href="2802">2802.</a> <tt>shared_ptr</tt> constructor requirements for a deleter</h3>
<p><b>Section:</b> 20.11.2.2.1 [util.smartptr.shared.const] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2016-11-09 <b>Last modified:</b> 2016-11-10</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared.const">issues</a> in [util.smartptr.shared.const].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<b>Addresses US 127</b>
<p/>
It should suffice for the deleter <tt>D</tt> to be nothrow move-constructible.
However, to avoid potentially leaking the pointer <tt>p</tt> if <tt>D</tt> is also 
copy-constructible when copying the argument by-value, we should continue 
to require the copy constructor does not throw if <tt>D</tt> 
is <tt>CopyConstructible</tt>.
</p>
<p>
Proposed change:
<p/>
Relax the requirement the <tt>D</tt> be <tt>CopyConstructible</tt> 
to simply require that <tt>D</tt> be <tt>MoveConstructible</tt>.  
Clarify the requirement that construction of any of the arguments 
passed by-value shall not throw exceptions. Note that we have library-wide 
wording in clause 17 that says any type supported by the 
library, not just this delete, shall not throw exceptions from its destructor, 
so that wording could be editorially removed. Similarly, the requirements 
that <tt>A</tt> shall be an allocator satisfy that neither 
constructor nor destructor for <tt>A</tt> can throw.
</p>


<p><b>Proposed resolution:</b></p>





</body>
</html>
