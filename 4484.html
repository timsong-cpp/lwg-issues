<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Issue 4484: std::meta::reflect_constant_{string,array} talks about template parameter objects of built-in array types</title>
<meta property="og:title" content="Issue 4484: std::meta::reflect_constant_{string,array} talks about template parameter objects of built-in array types">
<meta property="og:description" content="C++ library issue. Status: NAD">
<meta property="og:url" content="https://timsong-cpp.github.io/lwg-issues/4484.html">
<meta property="og:type" content="website">
<meta property="og:image" content="http://cplusplus.github.io/LWG/images/cpp_logo.png">
<meta property="og:image:alt" content="C++ logo">
<style>
  p {text-align:justify}
  li {text-align:justify}
  pre code.backtick::before { content: "`" }
  pre code.backtick::after { content: "`" }
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table.issues-index { border: 1px solid; border-collapse: collapse; }
  table.issues-index th { text-align: center; padding: 4px; border: 1px solid; }
  table.issues-index td { padding: 4px; border: 1px solid; }
  table.issues-index td:nth-child(1) { text-align: right; }
  table.issues-index td:nth-child(2) { text-align: left; }
  table.issues-index td:nth-child(3) { text-align: left; }
  table.issues-index td:nth-child(4) { text-align: left; }
  table.issues-index td:nth-child(5) { text-align: center; }
  table.issues-index td:nth-child(6) { text-align: center; }
  table.issues-index td:nth-child(7) { text-align: left; }
  table.issues-index td:nth-child(5) span.no-pr { color: red; }
  @media (prefers-color-scheme: dark) {
     html {
        color: #ddd;
        background-color: black;
     }
     ins {
        background-color: #225522
     }
     del {
        background-color: #662222
     }
     a {
        color: #6af
     }
     a:visited {
        color: #6af
     }
     blockquote.note
     {
        background-color: rgba(255, 255, 255, .10)
     }
  }
</style>
</head>
<body>
<hr>
<h3 id="4484"><a href="lwg-closed.html#4484">4484</a>. <code class='backtick'>std::meta::reflect_constant_{string,array}</code> talks about template parameter objects of built-in array types</h3>
<p><b>Section:</b> 21.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.define.static">[meta.define.static]</a> <b>Status:</b> <a href="lwg-active.html#NAD">NAD</a>
 <b>Submitter:</b> Jiang An <b>Opened:</b> 2025-11-25 <b>Last modified:</b> 2025-12-05</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.define.static">issues</a> in [meta.define.static].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#NAD">NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Currently, 21.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.define.static">[meta.define.static]</a> is talking about template parameter objects of built-in array types, 
but per 13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>/13, a template parameter object must be of a class type. So 
<code class='backtick'>std::meta::reflect_constant_{string,array}</code> are perhaps mis-specified.
</p>

<p><i>[2025-11-27; Tomasz comments]</i></p>

<p>
The template argument object defintion was extended to cover objects of array types by CWG 3111.
The usage of the term "template parameter object" is intentional here, as it guarantees that
<code class='backtick'>reflect_constant_string</code> produces the same objects, where their content is the same.
</p>
<p><i>[2025-12-05 Status changed: New &rarr; NAD.]</i></p>

<p>Will be resolved by CWG 3111.</p>



<p id="res-4484"><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/N5014" title=" Working Draft, Standard for Programming Language C++">N5014</a>.
</p>

<ol>

<li><p>Modify 21.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.define.static">[meta.define.static]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;ranges::input_range R&gt;
  consteval info reflect_constant_string(R&amp;&amp; r);
</pre>
<blockquote>
<p>
-2- Let <code class='backtick'>CharT</code> be <code>ranges::range_value_t&lt;R&gt;</code>.
<p/>
-3- <i>Mandates</i>: <code class='backtick'>CharT</code> is one of <code class='backtick'>char</code>, <code class='backtick'>wchar_t</code>, <code class='backtick'>char8_t</code>, <code class='backtick'>char16_t</code>, <code class='backtick'>char32_t</code>.
<p/>
-4- Let <code><i>V</i></code> be the pack of values of type <code class='backtick'>CharT</code> whose elements 
are the corresponding elements of <code class='backtick'>r</code>, except that if <code class='backtick'>r</code> refers to a string literal object, 
then <code><i>V</i></code> does not include the trailing null terminator of <code class='backtick'>r</code>.
<p/>
-5- Let <code><i>P</i></code> be <del>the template parameter object 
(13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>)</del><ins>a constexpr object with static storage duration 
(6.8.6.1 <a href="https://timsong-cpp.github.io/cppwp/basic.stc.general">[basic.stc.general]</a>)</ins> of type <code>const CharT[sizeof...(<i>V</i>) + 1]</code> 
initialized with <code>{<i>V</i> ..., CharT()}</code>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;ranges::input_range R&gt;
  consteval info reflect_constant_array(R&amp;&amp; r);
</pre>
<blockquote>
<p>
-8- Let <code class='backtick'>T</code> be <code>ranges::range_value_t&lt;R&gt;</code>.
<p/>
-9- <i>Mandates</i>: <code class='backtick'>T</code> is a structural type (13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>), [&hellip;].
<p/>
-10- Let <code><i>V</i></code> be the pack of values [&hellip;].
<p/>
-11- Let <code><i>P</i></code> be
</p>
<ul style="list-style-type: none">
<li>(11.1) &mdash; 
If <code>sizeof...(<i>V</i>) &gt; 0</code> is <code class='backtick'>true</code>, then <del>the template parameter object 
(13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>)</del><ins>a constexpr object with static storage duration 
(6.8.6.1 <a href="https://timsong-cpp.github.io/cppwp/basic.stc.general">[basic.stc.general]</a>)</ins> of type <code>const T[sizeof...(<i>V</i>)]</code> 
initialized with <code>{[:<i>V</i>:]...}</code>.
</li>
<li>(11.2) &mdash; 
Otherwise, the template parameter object of type <code>array&lt;T, 0&gt;</code> initialized with <code class='backtick'>{}</code>.
</li>
</ul>
<p>
[&hellip;]
</p>
</blockquote>
</blockquote>

</li>
</ol>








</body>
</html>
