<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 3147: Definitions of "likely" and "unlikely" are likely to cause problems</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<hr>
<h3><a name="3147" href="lwg-active.html#3147">3147.</a> Definitions of "likely" and "unlikely" are likely to cause problems</h3>
<p><b>Section:</b> 15.5.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/macro.names">[macro.names]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-08-01 <b>Last modified:</b> 2018-10-08 05:13:59 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#macro.names">active issues</a> in [macro.names].</p>
<p><b>View all other</b> <a href="lwg-index.html#macro.names">issues</a> in [macro.names].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
15.5.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/macro.names">[macro.names]</a>/2 forbids a translation unit to define names "lexically identical to [&hellip;] the 
<i>attribute-token</i>s described in 9.11 <a href="https://timsong-cpp.github.io/cppwp/dcl.attr">[dcl.attr]</a>." We recently added the attribute-tokens <tt>likely</tt> 
and <tt>unlikely</tt> (9.11.7 <a href="https://timsong-cpp.github.io/cppwp/dcl.attr.likelihood">[dcl.attr.likelihood]</a>). These names are in extremely wide use as function-like 
macros in the open source community, forbidding users to define them breaks large amounts of code. (Reportedly 
Chromium contains 19 definitions each of "likely" and "unlikely" as function-like macros.)
<p/>
Indeed, this issue came up during EWG discussion of <a href="http://wg21.link/p0479R1">P0479R1</a> "Attributes 
for Likely and Unlikely Statements" in Kona, and EWG decided to keep the names "likely" and "unlikely" for the attribute 
tokens since the usage wouldn't conflict with defining them as function-like macros. 15.5.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/macro.names">[macro.names]</a>/2 should 
not break large amounts of existing code that doesn't actually conflict with the use of the <tt>[[likely]]</tt> and 
<tt>[[unlikely]]</tt> attributes.
</p>

<p><i>[2018-08-20 Status to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4762">N4762</a>.
</p>

<ol>
<li>
<p>Change 15.5.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/macro.names">[macro.names]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting Note:</i> If both this proposed resolution and the proposed resolution of LWG <a href="3132">3132</a> are accepted, 
the text inserted by LWG <a href="3132">3132</a> should precede the text added here.]
</p>
</blockquote>

<blockquote>
<p>
-2- A translation unit shall not <tt>#define</tt> or <tt>#undef</tt> names lexically identical to keywords, to 
the identifiers listed in Table 4, or to the <i>attribute-token</i>s described in 9.11 <a href="https://timsong-cpp.github.io/cppwp/dcl.attr">[dcl.attr]</a><ins>, 
except that the names <tt>likely</tt> and <tt>unlikely</tt> may be defined as function-like macros 
(14.3 <a href="https://timsong-cpp.github.io/cppwp/cpp.replace">[cpp.replace]</a>)</ins>.
</p>
</blockquote>
</li>
</ol>





</body>
</html>
