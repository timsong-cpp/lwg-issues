<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 2188: Reverse iterator does not fully support targets that overload operator&amp;</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<hr>
<h3><a name="2188" href="2188">2188.</a> Reverse iterator does not fully support targets that overload <tt>operator&amp;</tt></h3>
<p><b>Section:</b> 27.5.1.3.5 <a href="https://timsong-cpp.github.io/cppwp/reverse.iter.opref">[reverse.iter.opref]</a> <b>Status:</b> <a href="lwg-active.html#C++14">C++14</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2012-09-23 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all other</b> <a href="lwg-index.html#reverse.iter.opref">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/reverse.iter.opref">[reverse.iter.opref]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#C++14">C++14</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The specification for <tt>reverse_iterator::operator-></tt>
returns the address of the object yielded by dereferencing
with <tt>operator*</tt>, but does not have the usual
wording about returning the true address of the object.  As
<tt>reverse_iterator</tt> requires the adapted iterator have
at least the bidirectional iterator category, we know that
the returned reference is a true reference, and not a proxy,
hence we can use <tt>std::addressof</tt> on the reference
to get the right answer.
</p>
<p>
This will most likely show itself as an issue with a <tt>list</tt>
or <tt>vector</tt> of a type with such an overloaded operator,
where algorithms are likely to work with a forward iteration, but
not with reverse iteration.
</p>

<p><i>[2013-04-20, Bristol]</i></p>


<p>
Resolution: Goes to open now and move to review as soon as Daniel proposes a new wording.
</p>

<p><i>[2014-02-12 Issaquah meeting]</i></p>

<p>
Use <tt>std::addressof</tt> as the library uses elsewhere, then move as Immediate.
</p>



<p><b>Proposed resolution:</b></p>
<p>
Revise 27.5.1.3.5 <a href="https://timsong-cpp.github.io/cppwp/reverse.iter.opref">[reverse.iter.opref]</a> p1, as indicated:
</p>
<p>
<i>Returns:</i> <tt><ins>addressof</ins><del>&amp;(</del>operator*()<del>)</del></tt>.
</p>





</body>
</html>
