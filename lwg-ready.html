<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>C++ Standard Library Issues to be moved in [INSERT CURRENT MEETING HERE]</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<h1>C++ Standard Library Issues to be moved in [INSERT CURRENT MEETING HERE]</h1>
<table>
<tr>
<td align="left">Doc. no.</td>
<td align="left">R0165???</td>
</tr>
<tr>
<td align="left">Date:</td>
<td align="left"><p>Revised 2020-02-10 at 20:51:00 UTC</p>
</td>
</tr>
<tr>
<td align="left">Project:</td>
<td align="left">Programming Language C++</td>
</tr>
<tr>
<td align="left">Reply to:</td>
<td align="left">Marshall Clow &lt;<a href="mailto:lwgchair@gmail.com">lwgchair@gmail.com</a>&gt;</td>
</tr>
</table>
<h2>Ready Issues</h2>
<hr>
<h3><a name="3358" href="3358">3358.</a> &sect;[span.cons] is mistaken that <tt>to_address</tt> can throw</h3>
<p><b>Section:</b> 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-12-10 <b>Last modified:</b> 2020-01-14 13:40:39 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#span.cons">active issues</a> in [span.cons].</p>
<p><b>View all other</b> <a href="lwg-index.html#span.cons">issues</a> in [span.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[span.cons] paragraphs 6 and 9:
</p>
<blockquote><p>
<i>Throws:</i> When and what <tt>to_address(first)</tt> throws.
</p></blockquote>
<p>
could equivalently be "<i>Throws:</i> Nothing." since all overloads of <tt>std::to_address</tt> are 
<tt>noexcept</tt>. However, paragraph 9 fails to account for the fact that paragraph 8:
</p>
<blockquote><p>
<i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> with 
<tt>last - first</tt>.
</p></blockquote>
<p>
must evaluate <tt>last - first</tt>.
</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after ten positive votes on the reflector.]</i></p>


<p><i>[2020-01-14; Daniel comments]</i></p>

<p>
The fixed wording in 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p9 depends on the no-throw-guarantee of integer-class
conversions to integral types. This guarantee is specified by LWG <a href="3367">3367</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> paragraphs 6 and 9 as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> 
<ol>
<li><p>The missing paragraph number of the <i>Preconditions</i> element at p7/p8 has
already been reported as <a href="https://github.com/cplusplus/draft/issues/3540">editorial issue</a></p></li>
<li><p>The effective change to "Throws: Nothing." in p6 has already been 
<a href="https://github.com/cplusplus/draft/commit/e01989e83849323ab49089ea18a52ccbac08d90a">applied editorially</a>.</p></li>
</ol>
]
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class It&gt;
  constexpr span(It first, size_type count);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-4- <i>Preconditions:</i> [&hellip;]
<p/>
-5- <i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> with 
<tt>count</tt>.
<p/>
-6- <i>Throws:</i> <del>When and what <tt>to_address(first)</tt> throws</del><ins>Nothing</ins>.
</p>
</blockquote>
<pre>
template&lt;class It, class End&gt;
  constexpr span(It first, End last);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-?- <i>Preconditions:</i> [&hellip;]
<p/>
-8- <i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> 
with <tt>last - first</tt>.
<p/>
-9- <i>Throws:</i> When and what <tt><del>to_address(first)</del><ins>last - first</ins></tt> throws.
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3362" href="3362">3362.</a> Strike <tt>stop_source</tt>'s <tt>operator!=</tt></h3>
<p><b>Section:</b> 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-03 <b>Last modified:</b> 2020-01-14 12:59:29 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Just like <tt>stop_token</tt> (see LWG <a href="3254">3254</a>), <tt>stop_source</tt> in 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a>
declares an <tt>operator!=</tt> friend that is unnecessary in light of the new core language rules and 
should be struck.
</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a>, class <tt>stop_source</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  [&hellip;]

  class stop_source {
  public:
    [&hellip;]

    [[nodiscard]] friend bool
    operator==(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;
    <del>[[nodiscard]] friend bool
    operator!=(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;</del>
    friend void swap(stop_source&amp; lhs, stop_source&amp; rhs) noexcept;
  };
}
</pre>
</blockquote>

</li>

<li><p>Modify 32.3.4.3 <a href="https://timsong-cpp.github.io/cppwp/stopsource.cmp">[stopsource.cmp]</a> and 32.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource.special">[stopsource.special]</a> as indicated:</p>

<blockquote>
<p>
<b>32.3.4.3 <ins>Non-member functions</ins><del>Comparisons</del> [stopsource.<ins>nonmembers</ins><del>cmp</del>]</b>
</p>
<pre>
[[nodiscard]] bool operator==(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>true</tt> if <tt>lhs</tt> and <tt>rhs</tt> have ownership of the same stop
state or if both <tt>lhs</tt> and <tt>rhs</tt> do not have ownership of a stop state; otherwise <tt>false</tt>.
</p>
</blockquote>
<pre>
<del>[[nodiscard]] bool operator!=(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Returns:</i> <tt>!(lhs==rhs)</tt>.</del>
</p>
</blockquote>
<p>
<del><b>32.3.4.4 Specialized algorithms [stopsource.special]</b></del>
</p>
<pre>
friend void swap(stop_source&amp; x, stop_source&amp; y) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to: <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3364" href="3364">3364.</a> Initialize data members of ranges and their iterators</h3>
<p><b>Section:</b> 24.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.while.view">[range.take.while.view]</a>, 24.7.8.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.view">[range.drop.view]</a>, 24.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.while.view">[range.drop.while.view]</a>, 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-01-14 11:58:48 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.take.while.view">active issues</a> in [range.take.while.view].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.take.while.view">issues</a> in [range.take.while.view].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>Before <a href="http://wg21.link/p1035">P1035</a> was accepted, no data member in [ranges] whose type could
potentially be an aggregate or fundamental type was left without initializer. P1035 left some such data members 
without initializer, so it is possible to have them have indeterminate values. We propose restoring consistency.</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/N4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.while.view">[range.take.while.view]</a> as follows:</p>
<blockquote>
<pre>
class take_while_view : public view_interface&lt;take_while_view&lt;V, Pred&gt;&gt; {
  template&lt;bool&gt; class sentinel;                      <i>// exposition only</i>

  V base_ <ins>= V()</ins>;                                      <i>// exposition only</i>
  semiregular-box&lt;Pred&gt; pred_;                        <i>// exposition only</i>

public:
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.8.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.view">[range.drop.view]</a> as follows:</p>
<blockquote>
<pre>
private:
  V base_ <ins>= V()</ins>;                                     <i>// exposition only</i>
  range_difference_t&lt;V&gt; count_ <ins>= 0</ins>;                  <i>// exposition only</i>
};
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.while.view">[range.drop.while.view]</a> as follows:</p>
<blockquote>
<pre>
private:
  V base_ <ins>= V()</ins>;                                     <i>// exposition only</i>
  semiregular-box&lt;Pred&gt; pred_;                       <i>// exposition only</i>
};
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> as follows:</p>
<blockquote>
<pre>
class elements_view&lt;V, N&gt;::iterator {                <i>// exposition only</i>
  using base-t = conditional_t&lt;Const, const V, V&gt;;
  friend iterator&lt;!Const&gt;;

  iterator_t&lt;base-t&gt; current_ <ins>= iterator_t&lt;base-t&gt;()</ins>;
public:
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3367" href="3367">3367.</a> Integer-class conversions should not throw</h3>
<p><b>Section:</b> 23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-01-25 14:35:08 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.concept.winc">active issues</a> in [iterator.concept.winc].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.concept.winc">issues</a> in [iterator.concept.winc].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It's widely established that neither conversions of integral types to <tt>bool</tt> nor conversions 
between different integral types throw exceptions. These properties are crucial to supporting exception 
guarantees in algorithms, containers, and other uses of iterators and their difference types. 
Integer-class types must provide the same guarantees to support the same use cases as do integer types.
</p>

<p><i>[2020-01-14; Daniel comments]</i></p>

<ol>
<li><p>We probably need to think about providing the stronger guarantee that all integer-class operations 
are also <tt>noexcept</tt> in addition to the guarantee that they do not throw any exceptions.</p></li>
<li><p>The fixed wording in LWG <a href="3358">3358</a>, 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p9 depends on the no-throw-guarantee 
of integer-class conversions to integral types.</p></li>
</ol>

<p><i>[2020-01-25 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> There's a bit of drive-by editing here to change occurrences of the meaningless 
"type is convertible to type" to "expression is convertible to type". Paragraph 7 only has drive-by edits. ]
</p>
</blockquote>

<blockquote>
<p>
-6- <del>All</del><ins>Expressions of</ins> integer-class type<del>s</del> are explicitly convertible to 
<del>all</del><ins>any</ins> integral type<del>s and</del><ins>. Expressions of integral type are both</ins>
implicitly and explicitly convertible <del>from all integral types</del><ins>to any integer-class type. 
Conversions between integral and integer-class types do not exit via an exception</ins>.
<p/>
-7- <del>All</del><ins>Expressions <tt><i>E</i></tt> of</ins> integer-class type<del>s</del> <ins><tt>I</tt></ins> 
are contextually convertible to <tt>bool</tt> as if by <tt>bool(<del>a</del><ins><i>E</i></ins> != I(0))</tt><del>, 
where <tt>a</tt> is an instance of the integral-class type <tt>I</tt></del>.
</p>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3368" href="3368">3368.</a> Exactly when does <tt>size</tt> return <tt>end - begin</tt>?</h3>
<p><b>Section:</b> 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-01-25 12:29:23 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The specification of <tt>ranges::size</tt> in 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a> suggests that bullet 1.3 
("Otherwise, <tt><i>make-unsigned-like</i>(ranges::end(E) - ranges::begin(E)) ...")</tt> only applies 
when <tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> is <tt>true</tt>. This is not the 
design intent, but the result of an erroneous attempt to factor out the common 
"<tt>disable_sized_range</tt> is <tt>false</tt>" requirement from the member and non-member <tt>size</tt> 
cases in bullets 1.2.1 and 1.2.2 that occurred between <a href="http://wg21.link/p0896r3">P0896R3</a> and 
<a href="http://wg21.link/p0896r4">P0896R4</a>. The intended design has always been that a range with 
member or non-member <tt>size</tt> with the same syntax but different semantics may opt-out of being 
sized by specializing <tt>disable_sized_range</tt>. It has never been intended that arrays or ranges 
whose iterator and sentinel model <tt>sized_sentinel_for</tt> be able to opt out of being sized via 
<tt>disable_sized_range</tt>. <tt>disable_sized_sentinel_for</tt> can/must be used to opt out in the 
latter case so that library functions oblivious to the range type that operate on the iterator and 
sentinel of such a range will avoid subtraction.
</p>

<p><i>[2020-01-25 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> There are drive-by changes here to (1) avoid introducing unused type placeholders, 
(2) avoid reusing "<tt>T</tt>" as both the type of the subexpression and the template parameter of the 
poison pill, and (3) fix the cross-reference for <tt><i>make-unsigned-like</i></tt> which is defined in 
[ranges.syn]/1, not in [range.subrange].]
</p>
</blockquote>

<blockquote>
<p>
-1- The name <tt>size</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
The expression <tt>ranges::size(E)</tt> for some subexpression <tt>E</tt> with type <tt>T</tt> is 
expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt><i>decay-copy</i>(extent_v&lt;T&gt;)</tt> if <tt>T</tt> is an array type 
(6.8.2 <a href="https://timsong-cpp.github.io/cppwp/basic.compound">[basic.compound]</a>).</p></li>
<li><p><del>(1.2) &mdash; Otherwise, if <tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> 
(24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a>) is <tt>false</tt>:</del></p>
<li><p>(1.<ins>?</ins><del>2.1</del>) &mdash; <ins>Otherwise, if 
<tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> (24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a>) is <tt>false</tt> 
and</ins> <tt><i>decay-copy</i>(E.size())</tt> <del>if it</del> is a valid expression <del>and its 
type <tt>I</tt> is</del><ins>of</ins> integer-like <ins>type</ins> 
(23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a>)<ins>, <tt><i>decay-copy</i>(E.size())</tt></ins>.</p></li>
<li><p>(1.<ins>?</ins><del>2.2</del>) &mdash; Otherwise, <ins>if 
<tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> is <tt>false</tt> and</ins>
<tt><i>decay-copy</i>(size(E))</tt> <del>if it</del> is a valid expression <del>and its type 
<tt>I</tt> is</del><ins>of</ins> integer-like <ins>type</ins> with overload resolution performed in a 
context that includes the declaration:
<blockquote><pre>
<del>template&lt;class T&gt;</del> void size(<del>T</del><ins>auto</ins>&amp;&amp;) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::size</tt><ins>, <tt><i>decay-copy</i>(size(E))</tt></ins>.</p></li>
</li>
<li><p>(1.3) &mdash; Otherwise, <tt><i>make-unsigned-like</i>(ranges::end(E) - ranges::begin(E))</tt> 
(<del>24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a></del><ins>24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a></ins>) if it is a valid 
expression and the types <tt>I</tt> and <tt>S</tt> of 
<tt>ranges::begin(E)</tt> and <tt>ranges::end(E)</tt> (respectively) model both
<tt>sized_sentinel_for&lt;S, I&gt;</tt> (23.3.4.8 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.sizedsentinel">[iterator.concept.sizedsentinel]</a>) and 
<tt>forward_iterator&lt;I&gt;</tt>. However, <tt>E</tt> is evaluated only once.
</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3369" href="3369">3369.</a> <tt>span</tt>'s deduction-guide for built-in arrays doesn't work</h3>
<p><b>Section:</b> 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2020-01-08 <b>Last modified:</b> 2020-01-25 14:28:23 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#span.overview">active issues</a> in [span.overview].</p>
<p><b>View all other</b> <a href="lwg-index.html#span.overview">issues</a> in [span.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/n4842">N4842</a> 22.7.3.1 [span.overview] depicts:
</p>
<blockquote><pre>
template&lt;class T, size_t N&gt;
span(T (&amp;)[N]) -&gt; span&lt;T, N&gt;;
</pre></blockquote> 
<p>
This isn't constrained by 22.7.3.3 [span.deduct]. Then, 22.7.3.2 [span.cons]/10 
specifies:
</p>
<blockquote><pre>
template&lt;size_t N&gt; constexpr span(element_type (&amp;arr)[N]) noexcept;
template&lt;size_t N&gt; constexpr span(array&lt;value_type, N&gt;&amp; arr) noexcept;
template&lt;size_t N&gt; constexpr span(const array&lt;value_type, N&gt;&amp; arr) noexcept;
</pre>
<blockquote>
<p>
<i>Constraints:</i>
</p>
<ul>
<li><p><tt>extent == dynamic_extent || N == extent</tt> is <tt>true</tt>, and</p></li>
<li><p><tt>remove_pointer_t&lt;decltype(data(arr))&gt;(*)[]</tt> is convertible to 
<tt>ElementType(*)[]</tt>.</p></li>
</ul>
</blockquote>
</blockquote>
<p>
Together, these cause CTAD to behave unexpectedly. Here's a minimal test case, reduced from libcxx's 
test suite:
</p>
<blockquote><pre>
C:\Temp&gt;type span_ctad.cpp
#include &lt;stddef.h&gt;
#include &lt;type_traits&gt; 

inline constexpr size_t dynamic_extent = static_cast&lt;size_t&gt;(-1);

template &lt;typename T, size_t Extent = dynamic_extent&gt;
struct span {
  template &lt;size_t Size&gt;
  requires (Extent == dynamic_extent || Extent == Size)
#ifdef WORKAROUND_WITH_TYPE_IDENTITY_T
  span(std::type_identity_t&lt;T&gt; (&amp;)[Size]) {}
#else
  span(T (&amp;)[Size]) {}
#endif
};

template &lt;typename T, size_t Extent&gt;
#ifdef WORKAROUND_WITH_REQUIRES_TRUE
requires (true)
#endif
span(T (&amp;)[Extent]) -&gt; span&lt;T, Extent&gt;;

int main() {
  int arr[] = {1,2,3};
  span s{arr};
  static_assert(std::is_same_v&lt;decltype(s), span&lt;int, 3&gt;&gt;,
    "CTAD should deduce span&lt;int, 3&gt;.");
}

C:\Temp&gt;cl /EHsc /nologo /W4 /std:c++latest span_ctad.cpp
span_ctad.cpp
span_ctad.cpp(26): error C2338: CTAD should deduce span&lt;int, 3&gt;.

C:\Temp&gt;cl /EHsc /nologo /W4 /std:c++latest /DWORKAROUND_WITH_TYPE_IDENTITY_T span_ctad.cpp
span_ctad.cpp

C:\Temp&gt;cl /EHsc /nologo /W4 /std:c++latest /DWORKAROUND_WITH_REQUIRES_TRUE span_ctad.cpp
span_ctad.cpp

C:\Temp&gt;
</pre></blockquote> 
<p>
(MSVC and GCC 10 demonstrate this behavior. Clang is currently affected by 
<a href="https://bugs.llvm.org/show_bug.cgi?id=44484">LLVM#44484</a>.)
<p/>
Usually, when there's an explicit deduction-guide, we can ignore any corresponding constructor, 
because the overload resolution tiebreaker 12.4.3 [over.match.best]/2.10 prefers deduction-guides. 
However, this is a mental shortcut only, and it's possible for guides generated from constructors 
to out-compete deduction-guides during CTAD. That's what's happening here.
<p/>
Specifically, the constructor is constrained, while the deduction-guide is not constrained. This 
activates the "more specialized" tiebreaker first (12.4.3 [over.match.best]/2.5 is considered before 
/2.10 for deduction-guides). That goes through 13.7.6.2 [temp.func.order]/2 and 13.5.4 [temp.constr.order] 
to prefer the more constrained overload.
<p/>
(In the test case, this results in <tt>span&lt;int, dynamic_extent&gt;</tt> being deduced. That's 
because the constructor allows <tt>T</tt> to be deduced to be <tt>int</tt>. The constructor's <tt>Size</tt> 
template parameter is deduced to be 3, but that's unrelated to the class's <tt>Extent</tt> parameter. 
Because <tt>Extent</tt> has a default argument of <tt>dynamic_extent</tt>, CTAD succeeds and deduces 
<tt>span&lt;int, dynamic_extent&gt;</tt>.)
<p/>
There are at least two possible workarounds: we could alter the constructor to prevent it from 
participating in CTAD, or we could constrain the deduction-guide, as depicted in the test case. Either 
way, we should probably include a Note, following the precedent of 21.3.2.2 [string.cons]/12.
<p/>
Note that there are also deduction-guides for span from <tt>std::array</tt>. However, the constructors 
take <tt>array&lt;value_type, N&gt;</tt> with <tt>using value_type = remove_cv_t&lt;ElementType&gt;;</tt> 
so that prevents the constructors from interfering with CTAD.
<p/>
I'm currently proposing to alter the constructor from built-in arrays. An alternative resolution to 
constrain the deduction-guide would look like: "<i>Constraints:</i> <tt>true</tt>. [<i>Note:</i> This 
affects class template argument deduction. &mdash; <i>end note</i>]"
</p>

<p><i>[2020-01-25 Status set to Tentatively Ready after seven positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a>, class template <tt>span</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
template&lt;class ElementType, size_t Extent = dynamic_extent&gt;
class span {
public:
  [&hellip;]
  <i>// 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a>, constructors, copy, and assignment</i>
  constexpr span() noexcept;
  [&hellip;]
  template&lt;size_t N&gt;
  constexpr span(<ins>type_identity_t&lt;</ins>element_type<ins>&gt;</ins> (&amp;arr)[N]) noexcept;
  [&hellip;]
};
[&hellip;]
</pre>
</blockquote>

</li>

<li><p>Modify 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;size_t N&gt; constexpr span(<ins>type_identity_t&lt;</ins>element_type<ins>&gt;</ins> (&amp;arr)[N]) noexcept;
template&lt;size_t N&gt; constexpr span(array&lt;value_type, N&gt;&amp; arr) noexcept;
template&lt;size_t N&gt; constexpr span(const array&lt;value_type, N&gt;&amp; arr) noexcept;
</pre>
<blockquote>
<p>
-10- <i>Constraints:</i>
<ol style="list-style-type: none">
<li><p>(10.1) &mdash; <tt>extent == dynamic_extent || N == extent</tt> is <tt>true</tt>, and</p></li>
<li><p>(10.2) &mdash; <tt>remove_pointer_t&lt;decltype(data(arr))&gt;(*)[]</tt> is convertible to 
<tt>ElementType(*)[]</tt>.</p></li>
</ol>
<p/>
-11- <i>Effects:</i> Constructs a <tt>span</tt> that is a view over the supplied array. <ins>[<i>Note:</i> 
<tt>type_identity_t</tt> affects class template argument deduction. &mdash; <i>end note</i>]</ins>
<p/>
-12- <i>Postconditions:</i> <tt>size() == N &amp;&amp; data() == data(arr)</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3371" href="3371">3371.</a> <tt>visit_format_arg</tt> and <tt>make_format_args</tt> are not hidden friends</h3>
<p><b>Section:</b> 20.20.5.1 <a href="https://timsong-cpp.github.io/cppwp/format.arg">[format.arg]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-16 <b>Last modified:</b> 2020-02-01 13:16:12 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#format.arg">issues</a> in [format.arg].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
After <a href="https://wg21.link/P1965R0">P1965R0</a>, friend function and function template
declarations always introduce hidden friends under the new blanket wording in
16.5.5.6 <a href="https://timsong-cpp.github.io/cppwp/hidden.friends">[hidden.friends]</a>. However, 20.20.5.1 <a href="https://timsong-cpp.github.io/cppwp/format.arg">[format.arg]</a> contains
"exposition only" friend declarations of <tt>visit_format_arg</tt> and <tt>make_format_args</tt>,
and those are not intended to be hidden. The only reason to have these declarations in the first
place is because these function templates are specified using the exposition-only private data
members of <tt>basic_format_arg</tt>, but that's unnecessary &mdash; for example,
<tt>shared_ptr</tt>'s constructors are not exposition-only friends of <tt>enable_shared_from_this</tt>,
even though the former are shown as assigning to the latter's exposition-only <tt>weak_this</tt>
private data member (see 20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a>p1).
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Edit 20.20.5.1 <a href="https://timsong-cpp.github.io/cppwp/format.arg">[format.arg]</a>, class template <tt>basic_format_arg</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;class Context&gt;
  class basic_format_arg {

    [&hellip;]

<del>    template&lt;class Visitor, class Ctx&gt;
      friend auto visit_format_arg(Visitor&amp;&amp; vis,
                                   basic_format_arg&lt;Ctx&gt; arg);                  // <i>exposition only</i>

    template&lt;class Ctx, class... Args>
      friend <i>format-arg-store</i>&lt;Ctx, Args...&gt;
        make_format_args(const Args&amp;... args);                                  // <i>exposition only</i></del>

    [&hellip;]
  };
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3372" href="3372">3372.</a> <tt>vformat_to</tt> should not try to deduce <tt>Out</tt> twice</h3>
<p><b>Section:</b> 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-16 <b>Last modified:</b> 2020-02-07 16:07:43 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.functions">active issues</a> in [format.functions].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.functions">issues</a> in [format.functions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>vformat_to</tt> currently deduces <tt>Out</tt> from its first and last arguments.
This requires its last argument's type to be a specialization of <tt>basic_format_args</tt>,
which notably prevents the use of <tt><i>format-arg-store</i></tt> arguments directly.
This is unnecessary: we should only deduce from the first argument.
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Edit 20.20.1 <a href="https://timsong-cpp.github.io/cppwp/format.syn">[format.syn]</a>, header <tt>&lt;format&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {

  [&hellip;]

  template&lt;class Out&gt;
    Out vformat_to(Out out, string_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, wstring_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, string_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, wstring_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);

  [&hellip;]
}
</pre>
</blockquote>
</li>
<li><p>Edit 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> p8 through p10 as indicated:</p>

<blockquote>
<pre>
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, string_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, wstring_view fmt, const Args&amp;... args);
</pre>
<blockquote>
<p> -8- <i>Effects:</i> Equivalent to:</p>
<blockquote>
<pre>
using context = basic_format_context&lt;Out, decltype(fmt)::value_type&gt;;
return vformat_to(out, fmt, <del>{</del>make_format_args&lt;context&gt;(args...)<del>}</del>);
</pre>
</blockquote>
</blockquote>
<pre>
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, const locale&amp; loc, string_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, const locale&amp; loc, wstring_view fmt, const Args&amp;... args);
</pre>
<blockquote>
<p> -9- <i>Effects:</i> Equivalent to:</p>
<blockquote>
<pre>
using context = basic_format_context&lt;Out, decltype(fmt)::value_type&gt;;
return vformat_to(out, loc, fmt, <del>{</del>make_format_args&lt;context&gt;(args...)<del>}</del>);
</pre>
</blockquote>
</blockquote>
<pre>
  template&lt;class Out&gt;
    Out vformat_to(Out out, string_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, wstring_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, string_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, wstring_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);
</pre>
<blockquote>
<p> -10- Let <tt>charT</tt> be <tt>decltype(fmt)::value_type</tt>.</p>
<p> [&hellip;] </p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3373" href="3373">3373.</a> <tt>{to,from}_chars_result</tt> and <tt>format_to_n_result</tt> need the
 "we really mean what we say" wording</h3>
<p><b>Section:</b> 20.19.1 <a href="https://timsong-cpp.github.io/cppwp/charconv.syn">[charconv.syn]</a>, 20.20.1 <a href="https://timsong-cpp.github.io/cppwp/format.syn">[format.syn]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-16 <b>Last modified:</b> 2020-02-01 13:23:15 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#charconv.syn">issues</a> in [charconv.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
To ensure that <tt>to_chars_result</tt>, <tt>from_chars_result</tt>, and
<tt>format_to_n_result</tt> can be used in structured bindings, they need the
special wording we use to negate the general library permission to add private
data members and bases.
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Add a paragraph at the end of 20.19.1 <a href="https://timsong-cpp.github.io/cppwp/charconv.syn">[charconv.syn]</a> as follows:</p>

<blockquote>
<p>
-?- The types <tt>to_chars_result</tt> and <tt>from_chars_result</tt> have the
data members and special members specified above. They have no base classes or
members other than those specified.
</p>
</blockquote>
</li>

<li><p>Add a paragraph at the end of 20.20.1 <a href="https://timsong-cpp.github.io/cppwp/format.syn">[format.syn]</a> as follows:</p>

<blockquote>
<p>
-1- The class template <tt>format_to_n_result</tt> has the template parameters,
data members, and special members specified above. It has no base classes or
members other than those specified.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3374" href="3374">3374.</a> P0653 + P1006 should have made the other <tt>std::to_address</tt> overload <tt>constexpr</tt></h3>
<p><b>Section:</b> 20.10.4 <a href="https://timsong-cpp.github.io/cppwp/pointer.conversion">[pointer.conversion]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2020-01-14 <b>Last modified:</b> 2020-02-01 13:19:22 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
While reviewing some interactions with <a href="http://wg21.link/p0653">P0653</a> + 
<a href="http://wg21.link/p1006">P1006</a>, Billy discovered that one of the overloads was 
missing the <tt>constexpr</tt> tag. This might be a typo or a missed merge interaction between 
P0653 (which adds <tt>to_address</tt> with the pointer overload being <tt>constexpr</tt>) and 
P1006 (which makes <tt>pointer_traits::pointer_to constexpr</tt>). Mail was sent the LWG reflector, 
and Glen Fernandes, the author of P0653, indicates that this might have been an oversight.
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after seven positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a>, header <tt>&lt;memory&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<i>// 20.10.4 <a href="https://timsong-cpp.github.io/cppwp/pointer.conversion">[pointer.conversion]</a>, pointer conversion</i>
template&lt;class T&gt;
  constexpr T* to_address(T* p) noexcept;
template&lt;class Ptr&gt;
  <ins>constexpr</ins> auto to_address(const Ptr&amp; p) noexcept;
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 20.10.4 <a href="https://timsong-cpp.github.io/cppwp/pointer.conversion">[pointer.conversion]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Ptr&gt; <ins>constexpr</ins> auto to_address(const Ptr&amp; p) noexcept;
</pre>
<blockquote>
<p>
-3- <i>Returns:</i> <tt>pointer_traits&lt;Ptr&gt;::to_address(p)</tt> if that expression is well-formed 
(see 20.10.3.3 <a href="https://timsong-cpp.github.io/cppwp/pointer.traits.optmem">[pointer.traits.optmem]</a>), otherwise <tt>to_address(p.operator-&gt;())</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3377" href="3377">3377.</a> <tt>elements_view::iterator</tt> befriends a specialization of itself</h3>
<p><b>Section:</b> 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-18 <b>Last modified:</b> 2020-02-08 12:11:39 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The synopsis of the exposition-only class template <tt>elements_view::iterator</tt> in 
24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> includes the declaration "<tt>friend iterator&lt;!Const&gt;;</tt>". 
We typically don't depict such friend relationships in the Library specification, leaving the 
choice of how to implement access to private data from external sources to implementer magic. 
For consistency, we should strike this occurrence from <tt>elements_view::iterator</tt>.
</p>

<p><i>[2020-02-08 Status set to Tentatively Ready after ten positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a>, class template <tt>elements_view::iterator</tt> 
synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;class V, size_t N&gt;
  template&lt;bool Const&gt;
  class elements_view&lt;V, N&gt;::iterator { <i>// exposition only</i>
    using base_t = conditional_t&lt;Const, const V, V&gt;;
    <del>friend iterator&lt;!Const&gt;;</del>

    iterator_t&lt;base_t&gt; current_;
  public:
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3380" href="3380">3380.</a> <tt>common_type</tt> and comparison categories</h3>
<p><b>Section:</b> 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-23 <b>Last modified:</b> 2020-02-08 11:51:24 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.trans.other">active issues</a> in [meta.trans.other].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.trans.other">issues</a> in [meta.trans.other].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
There are two paragraphs in the the definition of <tt>common_type</tt>:
</p>
<ul>
<li><p>Otherwise, if both <tt>D1</tt> and <tt>D2</tt> denote comparison category types 
(17.11.2.1 <a href="https://timsong-cpp.github.io/cppwp/cmp.categories.pre">[cmp.categories.pre]</a>), let <tt>C</tt> denote the common comparison type 
(11.11.3 <a href="https://timsong-cpp.github.io/cppwp/class.spaceship">[class.spaceship]</a>) of <tt>D1</tt> and <tt>D2</tt>.</p></li>
<li><p>Otherwise, if <tt>decay_t&lt;decltype(false ? declval&lt;D1&gt;() : declval&lt;D2&gt;())&gt;</tt> 
denotes a valid type, let <tt>C</tt> denote that type.</p></li>
</ul>
<p>
<a href="https://wg21.link/p1614r2">P1614R2</a> added the first bullet so that 
<tt>common_type_t&lt;strong_equality, T&gt;</tt> would be the same type as 
<tt>common_comparison_category_t&lt;strong_equality, T&gt;</tt>; other cases are correctly handled 
by the second (pre-existing) bullet. After application of <a href="https://wg21.link/p1959r0">P1959R0</a> 
in Belfast, <tt>std::strong_equality</tt> is no more. We can now strike the first bullet without 
changing the behavior of <tt>common_type</tt>.
</p>

<p><i>[2020-02-08 Status set to Tentatively Ready after seven positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> as indicated:</p>

<blockquote>
<p>
-3- Note A: For the <tt>common_type</tt> trait applied to a template parameter pack <tt>T</tt> of types, 
the member <tt>type</tt> shall be either defined or not present as follows:
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(3.3) &mdash; If <tt>sizeof...(T)</tt> is two, let the first and second types constituting <tt>T</tt> 
be denoted by <tt>T1</tt> and <tt>T2</tt>, respectively, and let <tt>D1</tt> and <tt>D2</tt> denote the 
same types as <tt>decay_t&lt;T1&gt;</tt> and <tt>decay_t&lt;T2&gt;</tt>, respectively.</p>
<ol style="list-style-type: none">
<li><p>(3.3.1) &mdash; If <tt>is_same_v&lt;T1, D1&gt;</tt> is <tt>false</tt> or <tt>is_same_v&lt;T2, D2&gt;</tt> 
is <tt>false</tt>, let <tt>C</tt> denote the same type, if any, as <tt>common_type_t&lt;D1, D2&gt;</tt>.</p></li>
<li><p>(3.3.2) &mdash; [<i>Note:</i> None of the following will apply if there is a specialization 
<tt>common_type&lt;D1, D2&gt;</tt>. &mdash; <i>end note</i>]</p></li>
<li><p><del>(3.3.3) &mdash; Otherwise, if both <tt>D1</tt> and <tt>D2</tt> denote comparison category types 
(17.11.2.1 <a href="https://timsong-cpp.github.io/cppwp/cmp.categories.pre">[cmp.categories.pre]</a>), let <tt>C</tt> denote the common comparison type 
(11.11.3 <a href="https://timsong-cpp.github.io/cppwp/class.spaceship">[class.spaceship]</a>) of <tt>D1</tt> and <tt>D2</tt>.</del></p></li>
<li><p>(3.3.4) &mdash; Otherwise, if</p>
<blockquote><pre>
decay_t&lt;decltype(false ? declval&lt;D1&gt;() : declval&lt;D2&gt;())>
</pre></blockquote>
<p>
denotes a valid type, let <tt>C</tt> denote that type.</p></li>
<li><p>(3.3.5) &mdash; [&hellip;]</p></li>
</ol>
</li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
</li>
</ol>





</body>
</html>
