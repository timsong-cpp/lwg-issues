<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>C++ Standard Library Issues to be moved in [INSERT CURRENT MEETING HERE]</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<h1>C++ Standard Library Issues to be moved in [INSERT CURRENT MEETING HERE]</h1>
<table>
<tr>
<td align="left">Doc. no.</td>
<td align="left">R0165???</td>
</tr>
<tr>
<td align="left">Date:</td>
<td align="left"><p>Revised 2020-01-19 at 15:58:11 UTC</p>
</td>
</tr>
<tr>
<td align="left">Project:</td>
<td align="left">Programming Language C++</td>
</tr>
<tr>
<td align="left">Reply to:</td>
<td align="left">Marshall Clow &lt;<a href="mailto:lwgchair@gmail.com">lwgchair@gmail.com</a>&gt;</td>
</tr>
</table>
<h2>Ready Issues</h2>
<hr>
<h3><a name="3358" href="3358">3358.</a> &sect;[span.cons] is mistaken that <tt>to_address</tt> can throw</h3>
<p><b>Section:</b> 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-12-10 <b>Last modified:</b> 2020-01-14 13:40:39 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#span.cons">active issues</a> in [span.cons].</p>
<p><b>View all other</b> <a href="lwg-index.html#span.cons">issues</a> in [span.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[span.cons] paragraphs 6 and 9:
</p>
<blockquote><p>
<i>Throws:</i> When and what <tt>to_address(first)</tt> throws.
</p></blockquote>
<p>
could equivalently be "<i>Throws:</i> Nothing." since all overloads of <tt>std::to_address</tt> are 
<tt>noexcept</tt>. However, paragraph 9 fails to account for the fact that paragraph 8:
</p>
<blockquote><p>
<i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> with 
<tt>last - first</tt>.
</p></blockquote>
<p>
must evaluate <tt>last - first</tt>.
</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after ten positive votes on the reflector.]</i></p>


<p><i>[2020-01-14; Daniel comments]</i></p>

<p>
The fixed wording in 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p9 depends on the no-throw-guarantee of integer-class
conversions to integral types. This guarantee is specified by LWG <a href="3367">3367</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> paragraphs 6 and 9 as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> 
<ol>
<li><p>The missing paragraph number of the <i>Preconditions</i> element at p7/p8 has
already been reported as <a href="https://github.com/cplusplus/draft/issues/3540">editorial issue</a></p></li>
<li><p>The effective change to "Throws: Nothing." in p6 has already been 
<a href="https://github.com/cplusplus/draft/commit/e01989e83849323ab49089ea18a52ccbac08d90a">applied editorially</a>.</p></li>
</ol>
]
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class It&gt;
  constexpr span(It first, size_type count);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-4- <i>Preconditions:</i> [&hellip;]
<p/>
-5- <i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> with 
<tt>count</tt>.
<p/>
-6- <i>Throws:</i> <del>When and what <tt>to_address(first)</tt> throws</del><ins>Nothing</ins>.
</p>
</blockquote>
<pre>
template&lt;class It, class End&gt;
  constexpr span(It first, End last);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-?- <i>Preconditions:</i> [&hellip;]
<p/>
-8- <i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> 
with <tt>last - first</tt>.
<p/>
-9- <i>Throws:</i> When and what <tt><del>to_address(first)</del><ins>last - first</ins></tt> throws.
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3362" href="3362">3362.</a> Strike <tt>stop_source</tt>'s <tt>operator!=</tt></h3>
<p><b>Section:</b> 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-03 <b>Last modified:</b> 2020-01-14 12:59:29 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Just like <tt>stop_token</tt> (see LWG <a href="3254">3254</a>), <tt>stop_source</tt> in 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a>
declares an <tt>operator!=</tt> friend that is unnecessary in light of the new core language rules and 
should be struck.
</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a>, class <tt>stop_source</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  [&hellip;]

  class stop_source {
  public:
    [&hellip;]

    [[nodiscard]] friend bool
    operator==(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;
    <del>[[nodiscard]] friend bool
    operator!=(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;</del>
    friend void swap(stop_source&amp; lhs, stop_source&amp; rhs) noexcept;
  };
}
</pre>
</blockquote>

</li>

<li><p>Modify 32.3.4.3 <a href="https://timsong-cpp.github.io/cppwp/stopsource.cmp">[stopsource.cmp]</a> and 32.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource.special">[stopsource.special]</a> as indicated:</p>

<blockquote>
<p>
<b>32.3.4.3 <ins>Non-member functions</ins><del>Comparisons</del> [stopsource.<ins>nonmembers</ins><del>cmp</del>]</b>
</p>
<pre>
[[nodiscard]] bool operator==(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>true</tt> if <tt>lhs</tt> and <tt>rhs</tt> have ownership of the same stop
state or if both <tt>lhs</tt> and <tt>rhs</tt> do not have ownership of a stop state; otherwise <tt>false</tt>.
</p>
</blockquote>
<pre>
<del>[[nodiscard]] bool operator!=(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Returns:</i> <tt>!(lhs==rhs)</tt>.</del>
</p>
</blockquote>
<p>
<del><b>32.3.4.4 Specialized algorithms [stopsource.special]</b></del>
</p>
<pre>
friend void swap(stop_source&amp; x, stop_source&amp; y) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to: <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3364" href="3364">3364.</a> Initialize data members of ranges and their iterators</h3>
<p><b>Section:</b> 24.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.while.view">[range.take.while.view]</a>, 24.7.8.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.view">[range.drop.view]</a>, 24.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.while.view">[range.drop.while.view]</a>, 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-01-14 11:58:48 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.take.while.view">active issues</a> in [range.take.while.view].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.take.while.view">issues</a> in [range.take.while.view].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>Before <a href="http://wg21.link/p1035">P1035</a> was accepted, no data member in [ranges] whose type could
potentially be an aggregate or fundamental type was left without initializer. P1035 left some such data members 
without initializer, so it is possible to have them have indeterminate values. We propose restoring consistency.</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/N4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.while.view">[range.take.while.view]</a> as follows:</p>
<blockquote>
<pre>
class take_while_view : public view_interface&lt;take_while_view&lt;V, Pred&gt;&gt; {
  template&lt;bool&gt; class sentinel;                      <i>// exposition only</i>

  V base_ <ins>= V()</ins>;                                      <i>// exposition only</i>
  semiregular-box&lt;Pred&gt; pred_;                        <i>// exposition only</i>

public:
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.8.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.view">[range.drop.view]</a> as follows:</p>
<blockquote>
<pre>
private:
  V base_ <ins>= V()</ins>;                                     <i>// exposition only</i>
  range_difference_t&lt;V&gt; count_ <ins>= 0</ins>;                  <i>// exposition only</i>
};
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.while.view">[range.drop.while.view]</a> as follows:</p>
<blockquote>
<pre>
private:
  V base_ <ins>= V()</ins>;                                     <i>// exposition only</i>
  semiregular-box&lt;Pred&gt; pred_;                       <i>// exposition only</i>
};
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> as follows:</p>
<blockquote>
<pre>
class elements_view&lt;V, N&gt;::iterator {                <i>// exposition only</i>
  using base-t = conditional_t&lt;Const, const V, V&gt;;
  friend iterator&lt;!Const&gt;;

  iterator_t&lt;base-t&gt; current_ <ins>= iterator_t&lt;base-t&gt;()</ins>;
public:
</pre>
</blockquote>
</li>

</ol>





</body>
</html>
