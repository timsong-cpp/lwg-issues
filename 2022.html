<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 2022: reference_wrapper&lt;T&gt;::result_type is underspecified</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<hr>
<h3><a name="2022" href="2022">2022.</a> <tt>reference_wrapper&lt;T&gt;::result_type</tt> is underspecified</h3>
<p><b>Section:</b> 23.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a> <b>Status:</b> <a href="lwg-active.html#C++11">C++11</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2010-12-08 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#refwrap">active issues</a> in <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a>.</p>
<p><b>View all other</b> <a href="lwg-index.html#refwrap">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#C++11">C++11</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Issue <a href="1295">1295</a> correctly removed function types and references to function types from the
bullet 1 of 23.14.3 <a href="https://timsong-cpp.github.io/cppwp/func.require">[func.require]</a> p. 3 because neither function types nor function references
satisfy the requirements for a target object which is <em>defined</em> to be an object of a callable 
type. This has the effect that the reference in 23.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a> p. 2
</p>
<blockquote><p>
<tt>reference_wrapper</tt> has a weak result type (20.8.2).
</p></blockquote>
<p>
is insufficient as a reference to define the member type <tt>result_type</tt> when the template argument 
<tt>T</tt> is a function type.
<p/>
There are basically two approaches to solve the problem:
</p>
<ol>
<li><p>Extend the definition of a <i>weak result type</i> in 23.14.3 <a href="https://timsong-cpp.github.io/cppwp/func.require">[func.require]</a> p. 3 to both
function types and references thereof. This extension must be specified independend from the concept
of a call wrapper, though.</p>
</li>
<li><p>Add one extra sentence to 23.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a> p. 2 that simply defines the member type
<tt>result_type</tt> for <tt>reference_wrapper&lt;T&gt;</tt>, when <tt>T</tt> is a function type.</p>
</li>
</ol>
<p>
I checked the current usages of <i>weak result type</i> to have a base to argue for one or the other
approach. It turns out, that there is no further reference to this definition in regard to
function types or references thereof. The only other reference can be found in 
23.14.11.3 <a href="https://timsong-cpp.github.io/cppwp/func.bind.bind">[func.bind.bind]</a> p. 3, where <tt>g</tt> is required to be a class type.
</p>

<p><i>[2011-02-23 Reflector discussion]</i></p>

<p>
Moved to Tentatively Ready after 5 votes.
</p> 


<p><b>Proposed resolution:</b></p>
<p>
The suggested wording changes are against the working draft N3242.
</p>

<ol>
<li>
<p>Change 23.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a> p. 2 as indicated:</p>

<blockquote><p>
2 <tt>reference_wrapper<ins>&lt;T&gt;</ins></tt> has a weak result type (20.8.2). <ins>If <tt>T</tt> is a function type, 
<tt>result_type</tt> shall be a synonym for the return type of <tt>T</tt>.</ins>
</p></blockquote>

</li>

</ol>





</body>
</html>
