<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 2811: "Selected constructor" wording is incorrect for optional/variant/any</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<p>Revised 2016-11-23 at 07:11:07 UTC</p>
<hr>
<h3><a name="2811" href="2811">2811.</a> "Selected constructor" wording is incorrect for <tt>optional</tt>/<tt>variant</tt>/<tt>any</tt></h3>
<p><b>Section:</b> 20.6.3.1 [optional.object.ctor], 20.6.3.3 [optional.object.assign], 20.7.2.1 [variant.ctor], 20.8.3.1 [any.cons], 20.8.3.3 [any.modifiers] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2016-10-29 <b>Last modified:</b> 2016-11-13</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#optional.object.ctor">active issues</a> in [optional.object.ctor].</p>
<p><b>View all other</b> <a href="lwg-index.html#optional.object.ctor">issues</a> in [optional.object.ctor].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Throughout <tt>optional</tt>/<tt>variant</tt>/<tt>any</tt>'s specification references are made to "the selected constructor 
of <tt>T</tt>". For example, 20.6.3.1 [optional.object.ctor]/16 says of the constructor from <tt>const T&amp;</tt>:
</p>
<blockquote><p>
-16- <i>Remarks:</i> If <tt>T</tt>'s selected constructor is a <tt>constexpr</tt> constructor, this constructor shall be a 
<tt>constexpr</tt> constructor.
</p></blockquote>
<p>
Similarly, the in-place constructor has this wording (20.6.3.1 [optional.object.ctor]/25-26):
</p>
<blockquote><p>
-25- <i>Throws:</i> Any exception thrown by the selected constructor of <tt>T</tt>.
<p/>
-26- <i>Remarks:</i> If <tt>T</tt>'s constructor selected for the initialization is a <tt>constexpr</tt> constructor, 
this constructor shall be a <tt>constexpr</tt> constructor.
</p></blockquote>
<p>
If <tt>T</tt> is a scalar type, it has no constructor at all. Moreover, even for 
class types, the in-place constructor wording ignores any implicit conversion done on the argument before the selected 
constructor is called, which 1) may not be valid in constant expressions and 2) may throw an exception; such exceptions 
aren't thrown "by the selected constructor of <tt>T</tt>" but outside it.
<p/>
The wording should probably be recast to refer to the entire initialization.
</p>


<p><b>Proposed resolution:</b></p>





</body>
</html>
