<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 706: make_pair() should behave as make_tuple() wrt. reference_wrapper()</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<hr>
<h3><a name="706" href="lwg-defects.html#706">706.</a> <tt>make_pair()</tt> should behave as <tt>make_tuple()</tt> wrt. <tt>reference_wrapper()</tt></h3>
<p><b>Section:</b> 23.4 <a href="https://timsong-cpp.github.io/cppwp/pairs">[pairs]</a> <b>Status:</b> <a href="lwg-active.html#CD1">CD1</a>
 <b>Submitter:</b> Thorsten Ottosen <b>Opened:</b> 2007-07-08 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs">issues</a> in [pairs].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#CD1">CD1</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current draft has <tt>make_pair()</tt> in 23.4 <a href="https://timsong-cpp.github.io/cppwp/pairs">[pairs]</a>/16
and <tt>make_tuple()</tt> in 23.5.3.4 <a href="https://timsong-cpp.github.io/cppwp/tuple.creation">[tuple.creation]</a>.
<tt>make_tuple()</tt> detects the presence of
<tt>reference_wrapper&lt;X&gt;</tt> arguments and "unwraps" the reference in
such cases. <tt>make_pair()</tt> would OTOH create a
<tt>reference_wrapper&lt;X&gt;</tt> member. I suggest that the two
functions are made to behave similar in this respect to minimize
confusion.
</p>


<p><b>Proposed resolution:</b></p>
<p>
In 23.2 <a href="https://timsong-cpp.github.io/cppwp/utility">[utility]</a> change the synopsis for make_pair() to read
</p>

<blockquote><pre>
template &lt;class T1, class T2&gt;
  pair&lt;<del>typename decay&lt;T1&gt;::type</del> <ins>V1</ins>, <del>typename decay&lt;T2&gt;::type</del> <ins>V2</ins>&gt; make_pair(T1&amp;&amp;, T2&amp;&amp;);
</pre></blockquote>

<p>
In 23.4 <a href="https://timsong-cpp.github.io/cppwp/pairs">[pairs]</a>/16 change the declaration to match the above synopsis.
Then change the 23.4 <a href="https://timsong-cpp.github.io/cppwp/pairs">[pairs]</a>/17 to:
</p>

<blockquote>
<p>
<i>Returns:</i> <tt>pair&lt;<del>typename decay&lt;T1&gt;::type</del> <ins>V1</ins>,<del>typename decay&lt;T2&gt;::type</del> <ins>V2</ins>&gt;(forward&lt;T1&gt;(x),forward&lt;T2&gt;(y))</tt> <ins>where <tt>V1</tt> and
<tt>V2</tt> are determined as follows: Let <tt>Ui</tt> be
<tt>decay&lt;Ti&gt;::type</tt> for each <tt>Ti</tt>. Then each
<tt>Vi</tt> is <tt>X&amp;</tt> if <tt>Ui</tt> equals
<tt>reference_wrapper&lt;X&gt;</tt>, otherwise <tt>Vi</tt> is
<tt>Ui</tt>.</ins>
</p>
</blockquote>






</body>
</html>
