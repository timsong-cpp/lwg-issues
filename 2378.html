<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Issue 2378: Behaviour of standard exception types</title>
<meta property="og:title" content="Issue 2378: Behaviour of standard exception types">
<meta property="og:description" content="C++ library issue. Status: C++17">
<meta property="og:url" content="https://timsong-cpp.github.io/lwg-issues/2378.html">
<meta property="og:type" content="website">
<meta property="og:image" content="http://cplusplus.github.io/LWG/images/cpp_logo.png">
<meta property="og:image:alt" content="C++ logo">
<style>
  p {text-align:justify}
  li {text-align:justify}
  pre code.backtick::before { content: "`" }
  pre code.backtick::after { content: "`" }
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table.issues-index { border: 1px solid; border-collapse: collapse; }
  table.issues-index th { text-align: center; padding: 4px; border: 1px solid; }
  table.issues-index td { padding: 4px; border: 1px solid; }
  table.issues-index td:nth-child(1) { text-align: right; }
  table.issues-index td:nth-child(2) { text-align: left; }
  table.issues-index td:nth-child(3) { text-align: left; }
  table.issues-index td:nth-child(4) { text-align: left; }
  table.issues-index td:nth-child(5) { text-align: center; }
  table.issues-index td:nth-child(6) { text-align: center; }
  table.issues-index td:nth-child(7) { text-align: left; }
  table.issues-index td:nth-child(5) span.no-pr { color: red; }
  @media (prefers-color-scheme: dark) {
     html {
        color: #ddd;
        background-color: black;
     }
     ins {
        background-color: #225522
     }
     del {
        background-color: #662222
     }
     a {
        color: #6af
     }
     a:visited {
        color: #6af
     }
     blockquote.note
     {
        background-color: rgba(255, 255, 255, .10)
     }
  }
</style>
</head>
<body>
<hr>
<h3 id="2378"><a href="lwg-defects.html#2378">2378</a>. Behaviour of standard exception types</h3>
<p><b>Section:</b> 17.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/bad.alloc">[bad.alloc]</a>, 17.6.4.2 <a href="https://timsong-cpp.github.io/cppwp/new.badlength">[new.badlength]</a>, 17.7.4 <a href="https://timsong-cpp.github.io/cppwp/bad.cast">[bad.cast]</a>, 17.7.5 <a href="https://timsong-cpp.github.io/cppwp/bad.typeid">[bad.typeid]</a>, 17.9.4 <a href="https://timsong-cpp.github.io/cppwp/bad.exception">[bad.exception]</a> <b>Status:</b> <a href="lwg-active.html#C++17">C++17</a>
 <b>Submitter:</b> Andy Sawyer <b>Opened:</b> 2014-03-31 <b>Last modified:</b> 2017-07-30</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#C++17">C++17</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I think we have an issue with the specification of some of the standard exception types. 
In particular, several of them have default constructors with remarks to the effect that 
"The result of calling <code>what()</code> on the newly constructed object is implementation-defined". 
(In some cases this is contradictory to a further specification of <code>what()</code>, which 
is specified to return an implementation-defined NTBS.)
</p>

<p>
<strong>Previous resolution from Andy [SUPERSEDED]:</strong>
</p>
<blockquote class="note">
<p>This wording is relative to N3936.</p>

<ol>
<li><p>Edit 17.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/bad.alloc">[bad.alloc]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_alloc() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
-3- <i>Remarks</i>: <del>The result of calling <code>what()</code> on the newly constructed object is 
  implementation-defined</del><ins><code>what()</code> returns an implementation-defined NTBS</ins>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.6.4.2 <a href="https://timsong-cpp.github.io/cppwp/new.badlength">[new.badlength]</a> p3 as indicated: [<i>Drafting note</i>: Added the Postcondition, since we don't 
say anything else about <code>bad_array_new_length::what()</code> &mdash; <i>end of note</i>]</p>

<blockquote>
<pre>
bad_array_new_length() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
-3- <i><del>Remarks</del><ins>Postcondition</ins></i>: <del>The result of calling <code>what()</code> on the newly constructed object is 
  implementation-defined</del><ins><code>what()</code> returns an implementation-defined NTBS</ins>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.7.4 <a href="https://timsong-cpp.github.io/cppwp/bad.cast">[bad.cast]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_cast() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is implementation-defined.</del>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.7.5 <a href="https://timsong-cpp.github.io/cppwp/bad.typeid">[bad.typeid]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_typeid() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is implementation-defined.</del>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.9.4 <a href="https://timsong-cpp.github.io/cppwp/bad.exception">[bad.exception]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_exception() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is implementation-defined.</del>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2014-06-17, Rapperswil]</i></p>

<p>
Jonathan provides alternative wording.
</p>

<p><i>[2015-02, Cologne]</i></p>

<p>
NJ: I don't know why we need the explict statement about <code>what()</code> here, since <code>bad_array_new_length</code> 
already derives.<br/> 
AM: yes.<br/> 
NJ: Then "what()" is missing from the synopsis.<br/> 
AM: Yes, that's an error and it needs to be added.
<p/>
Conclusion: Update the wording to add the missing entry in the synopsis. 
<p/>
AM: The issue needs another update; we need to add missing "Remarks". DK updates the paper.<br/> 
AM: Any objections to "tentatively ready"? No objections. 
</p>


<p id="res-2378"><b>Proposed resolution:</b></p>
<p>This wording is relative to N4296.</p>

<ol>
<li><p>Edit 17.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/bad.alloc">[bad.alloc]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_alloc() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is 
  implementation-defined.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/bad.alloc">[bad.alloc]</a> p5 as indicated:</p>

<blockquote>
<pre>
virtual const char* what() const noexcept;
</pre>
<blockquote>
<p>
-5- <i>Returns</i>: An implementation-defined NTBS.
<p/>
<ins>-?- <i>Remarks</i>: The message may be a null-terminated multibyte string (17.5.2.1.4.2), suitable for conversion
and display as a <code>wstring</code> (21.3, 22.4.1.4).</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Edit class <code>bad_array_new_length</code> synopsis 17.6.4.2 <a href="https://timsong-cpp.github.io/cppwp/new.badlength">[new.badlength]</a> as indicated:</p>

<blockquote>
<pre>
namespace std {
  class bad_array_new_length : public bad_alloc {
  public:
    bad_array_new_length() noexcept;
    <ins>virtual const char* what() const noexcept;</ins>
  };
}
</pre>
</blockquote>
</li>

<li><p>Edit 17.6.4.2 <a href="https://timsong-cpp.github.io/cppwp/new.badlength">[new.badlength]</a> as indicated:</p>

<blockquote>
<pre>
bad_array_new_length() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is 
  implementation-defined.</del>
</p>
</blockquote>
<pre>
<ins>virtual const char* what() const noexcept;</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Returns</i>: An implementation-defined NTBS.</ins>
<p/>
<ins>-?- <i>Remarks</i>: The message may be a null-terminated multibyte string (17.5.2.1.4.2), suitable for conversion
and display as a <code>wstring</code> (21.3, 22.4.1.4).</ins>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.7.4 <a href="https://timsong-cpp.github.io/cppwp/bad.cast">[bad.cast]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_cast() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is implementation-defined.</del>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.7.5 <a href="https://timsong-cpp.github.io/cppwp/bad.typeid">[bad.typeid]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_typeid() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is implementation-defined.</del>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.9.4 <a href="https://timsong-cpp.github.io/cppwp/bad.exception">[bad.exception]</a> p3 as indicated:</p>

<blockquote>
<pre>
bad_exception() noexcept;
</pre><blockquote>
<p>
[&hellip;]
<p/>
<del>-3- <i>Remarks</i>: The result of calling <code>what()</code> on the newly constructed object is implementation-defined.</del>.
</p>
</blockquote>
</blockquote>
</li>
</ol>






</body>
</html>
