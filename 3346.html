<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 3346: pair and tuple copy and move constructor have backwards specification</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<hr>
<h3><a name="3346" href="lwg-active.html#3346">3346.</a> <tt>pair</tt> and <tt>tuple</tt> copy and move constructor have backwards specification</h3>
<p><b>Section:</b> 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a>, 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-11-26 <b>Last modified:</b> 2019-12-08 18:39:21 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#pairs.pair">active issues</a> in [pairs.pair].</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs.pair">issues</a> in [pairs.pair].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> p2 and 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> p3 say:
</p>
<blockquote>
<p>
The defaulted move and copy constructor, respectively, of {<tt>pair</tt>,<tt>tuple</tt>} is a constexpr 
function if and only if all required element-wise initializations for copy and move, respectively, 
would satisfy the requirements for a constexpr function.
</p>
</blockquote>
<p>
Note that we specify the copy constructor in terms of element move operations and the move constructor 
in terms of element copy operations. Is that really the intent? This appears to be how this was originally 
specified when the wording was added by <a href="https://wg21.link/n3471">N3471</a>.
</p>

<p><i>[2019-12-01; Daniel comments and provides wording]</i></p>

<p>
These inverted wording effects are an unintended oversight caused by <a href="https://wg21.link/n3471">N3471</a>.
</p>

<p><i>[2019-12-08 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after ten positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> as indicated:</p>

<blockquote>
<p>
-2- The defaulted move and copy constructor, respectively, of <tt>pair</tt> shall be a constexpr function 
if and only if all required element-wise initializations for <del>copy</del><ins>move</ins> and 
<del>move</del><ins>copy</ins>, respectively, would satisfy the requirements for a constexpr function.
</p>
</blockquote>
</li>

<li><p>Modify 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> as indicated:</p>

<blockquote>
<p>
-3- The defaulted move and copy constructor, respectively, of <tt>tuple</tt> shall be a constexpr function 
if and only if all required element-wise initializations for <del>copy</del><ins>move</ins> and 
<del>move</del><ins>copy</ins>, respectively, would satisfy the requirements for a constexpr function. 
The defaulted move and copy constructor of <tt>tuple&lt;&gt;</tt> shall be constexpr functions.
</p>
</blockquote>
</li>


</ol>




</body>
</html>
