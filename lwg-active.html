<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>C++ Standard Library Active Issues List</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<table>
<tr>
  <td align="left">Doc. no.</td>
  <td align="left">D????</td>
</tr>
<tr>
  <td align="left">Date:</td>
  <td align="left">2020-02-14</td>
</tr>
<tr>
  <td align="left">Project:</td>
  <td align="left">Programming Language C++</td>
</tr>
<tr>
  <td align="left">Reply to:</td>
  <td align="left">Marshall Clow &lt;<a href="mailto:lwgchair@gmail.com">lwgchair@gmail.com</a>&gt;</td>
</tr>
</table>
<h1>C++ Standard Library Active Issues List (Revision D121)</h1>
<p><p>Revised 2020-02-14 at 09:37:04 UTC</p>
</p>
  <p>Reference ISO/IEC IS 14882:2014(E)</p>
  <p>Also see:</p>
  <ul>
      <li><a href="lwg-toc.html">Table of Contents</a> for all library issues.</li>
      <li><a href="lwg-index.html">Index by Section</a> for all library issues.</li>
      <li><a href="lwg-status.html">Index by Status</a> for all library issues.</li>
      <li><a href="lwg-defects.html">Library Defect Reports and Accepted Issues</a></li>
      <li><a href="lwg-closed.html">Library Closed Issues List</a></li>
  </ul>
  <p>The purpose of this document is to record the status of issues
  which have come before the Library Working Group (LWG) of the INCITS PL22.16
  and ISO WG21 C++ Standards Committee. Issues represent
  potential defects in the ISO/IEC IS 14882:2014(E) document.
  </p>

  <p>This document contains only library issues which are actively being
  considered by the Library Working Group, i.e., issues which have a
  status of <a href="lwg-active.html#New">New</a>, <a href="lwg-active.html#Open">Open</a>,
  <a href="lwg-active.html#Ready">Ready</a>, or <a href="lwg-active.html#Review">Review</a>.
  See <a href="lwg-defects.html">Library Defect Reports and Accepted Issues</a> for issues considered defects
  and <a href="lwg-closed.html">Library Closed Issues List</a> for issues considered closed.</p>

  <p>The issues in these lists are not necessarily formal ISO Defect
  Reports (DR's). While some issues will eventually be elevated to
  official Defect Report status, other issues will be disposed of in
  other ways. See <a href="#Status">Issue Status</a>.</p>

  <p>Prior to Revision 14, library issues lists existed in two slightly
  different versions; a Committee Version and a Public
  Version. Beginning with Revision 14 the two versions were combined
  into a single version.</p>

  <p>This document includes <i>[bracketed italicized notes]</i> as a
  reminder to the LWG of current progress on issues. Such notes are
  strictly unofficial and should be read with caution as they may be
  incomplete or incorrect. Be aware that LWG support for a particular
  resolution can quickly change if new viewpoints or killer examples are
  presented in subsequent discussions.</p>

  <p>For the most current official version of this document see
  <a href="http://www.open-std.org/jtc1/sc22/wg21/">http://www.open-std.org/jtc1/sc22/wg21/</a>.
  Requests for further information about this document should include
  the document number above, reference ISO/IEC 14882:2014(E), and be
  submitted to Information Technology Industry Council (ITI), 1250 Eye
  Street NW, Washington, DC 20005.</p>

  <p>Public information as to how to obtain a copy of the C++ Standard,
  join the standards committee, submit an issue, or comment on an issue
  can be found in the comp.std.c++ FAQ.
  </p>

<p><a name="submit_issue"></a><b>How to submit an issue</b></p>

<ol style="list-style-type:upper-alpha">
<li><a name="submit_issue_A"></a>
Mail your issue to the author of this list.
</li>
<li><a name="submit_issue_B"></a>
Specify a short descriptive title.  If you fail to do so, the subject line of your
mail will be used as the issue title.
</li>
<li><a name="submit_issue_C"></a>
If the "From" on your email is not the name you wish to appear as issue submitter,
then specify issue submitter.
</li>
<li><a name="submit_issue_D"></a>
Provide a brief discussion of the problem you wish to correct.  Refer to the latest
working draft or standard using [section.tag] and paragraph numbers where appropriate.
</li>
<li><a name="submit_issue_E"></a>
Provide proposed wording.  This should indicate exactly how you want the standard
to be changed.  General solution statements belong in the discussion area.  This
area contains very clear and specific directions on how to modify the current
draft.  If you are not sure how to word a solution, you may omit this part.
But your chances of a successful issue greatly increase if you attempt wording.
</li>
<li><a name="submit_issue_F"></a>
It is not necessary for you to use html markup.  However, if you want to, you can
&lt;ins&gt;<ins>insert text like this</ins>&lt;/ins&gt; and &lt;del&gt;<del>delete text like
this</del>&lt;/del&gt;.  The only strict requirement is to communicate clearly to
the list maintainer exactly how you want your issue to look.
</li>
<li><a name="submit_issue_G"></a>
It is not necessary for you to specify other html font/formatting
mark-up, but if you do the list maintainer will attempt to respect your
formatting wishes (as described by html markup, or other common idioms).
</li>
<li><a name="submit_issue_H"></a>
It is not necessary for you to specify open date or last modified date (the date
of your mail will be used).
</li>
<li><a name="submit_issue_I"></a>
It is not necessary for you to cross reference other issues, but you can if you
like.  You do not need to form the hyperlinks when you do, the list maintainer will
take care of that.
</li>
<li><a name="submit_issue_J"></a>
One issue per email is best.
</li>
<li><a name="submit_issue_K"></a>
Between the time you submit the issue, and the next mailing deadline
(date at the top of the Revision History), you <em>own</em> this issue.
You control the content, the stuff that is right, the stuff that is
wrong, the format, the misspellings, etc.  You can even make the issue
disappear if you want.  Just let the list maintainer know how you want
it to look, and he will try his best to accommodate you.  After the
issue appears in an official mailing, you no longer enjoy exclusive
ownership of it.
</li>
</ol>


<h2>Revision History</h2>
<ul>
<li>D121: 2020-03-02 post-Prague mailing<ul>
<li><b>Summary:</b><ul>
<li>410 open issues, up by 30.</li>
<li>2476 closed issues, up by 4.</li>
<li>35 reassigned issues, up by 0.</li>
<li>2921 issues total, up by 34.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 22 Immediate issues: <a href="3367">3367</a>, <a href="3369">3369</a>, <a href="3371">3371</a>, <a href="3372">3372</a>, <a href="3373">3373</a>, <a href="3374">3374</a>, <a href="3375">3375</a>, <a href="3377">3377</a>, <a href="3379">3379</a>, <a href="3380">3380</a>, <a href="3381">3381</a>, <a href="3383">3383</a>, <a href="3384">3384</a>, <a href="3385">3385</a>, <a href="3387">3387</a>, <a href="3388">3388</a>, <a href="3389">3389</a>, <a href="3390">3390</a>, <a href="3393">3393</a>, <a href="3395">3395</a>, <a href="3396">3396</a>, <a href="3397">3397</a>.</li>
<li>Added the following Tentatively Ready issue: <a href="3368">3368</a>.</li>
<li>Added the following 10 New issues: <a href="3366">3366</a>, <a href="3370">3370</a>, <a href="3376">3376</a>, <a href="3378">3378</a>, <a href="3382">3382</a>, <a href="3386">3386</a>, <a href="3391">3391</a>, <a href="3394">3394</a>, <a href="3398">3398</a>, <a href="3399">3399</a>.</li>
<li>Added the following LEWG issue: <a href="3392">3392</a>.</li>
<li>Changed the following 25 issues to Voting (from Ready): <a href="3264">3264</a>, <a href="3280">3280</a>, <a href="3281">3281</a>, <a href="3292">3292</a>, <a href="3302">3302</a>, <a href="3303">3303</a>, <a href="3304">3304</a>, <a href="3307">3307</a>, <a href="3310">3310</a>, <a href="3313">3313</a>, <a href="3315">3315</a>, <a href="3316">3316</a>, <a href="3317">3317</a>, <a href="3318">3318</a>, <a href="3319">3319</a>, <a href="3320">3320</a>, <a href="3321">3321</a>, <a href="3323">3323</a>, <a href="3324">3324</a>, <a href="3325">3325</a>, <a href="3326">3326</a>, <a href="3327">3327</a>, <a href="3329">3329</a>, <a href="3330">3330</a>, <a href="3331">3331</a>.</li>
<li>Changed the following 19 issues to Voting (from Tentatively Ready): <a href="3194">3194</a>, <a href="3233">3233</a>, <a href="3254">3254</a>, <a href="3284">3284</a>, <a href="3285">3285</a>, <a href="3286">3286</a>, <a href="3291">3291</a>, <a href="3294">3294</a>, <a href="3296">3296</a>, <a href="3299">3299</a>, <a href="3300">3300</a>, <a href="3332">3332</a>, <a href="3338">3338</a>, <a href="3346">3346</a>, <a href="3349">3349</a>, <a href="3350">3350</a>, <a href="3351">3351</a>, <a href="3356">3356</a>, <a href="3360">3360</a>.</li>
<li>Changed the following 25 issues to Immediate (from New): <a href="3141">3141</a>, <a href="3175">3175</a>, <a href="3201">3201</a>, <a href="3226">3226</a>, <a href="3237">3237</a>, <a href="3242">3242</a>, <a href="3247">3247</a>, <a href="3250">3250</a>, <a href="3251">3251</a>, <a href="3252">3252</a>, <a href="3255">3255</a>, <a href="3262">3262</a>, <a href="3270">3270</a>, <a href="3301">3301</a>, <a href="3314">3314</a>, <a href="3328">3328</a>, <a href="3334">3334</a>, <a href="3335">3335</a>, <a href="3340">3340</a>, <a href="3347">3347</a>, <a href="3352">3352</a>, <a href="3358">3358</a>, <a href="3362">3362</a>, <a href="3363">3363</a>, <a href="3364">3364</a>.</li>
<li>Changed the following 3 issues to Immediate (from Open): <a href="2859">2859</a>, <a href="3050">3050</a>, <a href="3282">3282</a>.</li>
<li>Changed the following issue to Immediate (from LEWG): <a href="3354">3354</a>.</li>
<li>Changed the following 3 issues to Ready (from New): <a href="3211">3211</a>, <a href="3236">3236</a>, <a href="3249">3249</a>.</li>
<li>Changed the following issue to Tentatively NAD (from New): <a href="3365">3365</a>.</li>
<li>Changed the following issue to Open (from New): <a href="3305">3305</a>.</li>
<li>Changed the following issue to Tentatively Resolved (from New): <a href="3151">3151</a>.</li>
<li>Changed the following issue to Tentatively Resolved (from Open): <a href="3125">3125</a>.</li>
<li>Changed the following issue to Resolved (from New): <a href="3336">3336</a>.</li>
<li>Changed the following 2 issues to NAD (from New): <a href="3298">3298</a>, <a href="3333">3333</a>.</li>
<li>Changed the following issue to NAD (from Open): <a href="2860">2860</a>.</li>
</ul></li>
</ul>
</li>
<li>R120: 
2020-01-13 pre-Prague mailing
<ul>
<li><b>Summary:</b><ul>
<li>380 open issues, up by 4.</li>
<li>2472 closed issues, up by 7.</li>
<li>35 reassigned issues, up by 0.</li>
<li>2887 issues total, up by 11.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 2 Tentatively Ready issues: <a href="3356">3356</a>, <a href="3360">3360</a>.</li>
<li>Added the following 8 New issues: <a href="3355">3355</a>, <a href="3358">3358</a>, <a href="3359">3359</a>, <a href="3361">3361</a>, <a href="3362">3362</a>, <a href="3363">3363</a>, <a href="3364">3364</a>, <a href="3365">3365</a>.</li>
<li>Added the following LEWG issue: <a href="3357">3357</a>.</li>
<li>Changed the following 2 issues to Ready (from New): <a href="3280">3280</a>, <a href="3292">3292</a>.</li>
<li>Changed the following issue to Ready (from LEWG): <a href="3304">3304</a>.</li>
<li>Changed the following 5 issues to Tentatively Ready (from New): <a href="3194">3194</a>, <a href="3254">3254</a>, <a href="3349">3349</a>, <a href="3350">3350</a>, <a href="3351">3351</a>.</li>
<li>Changed the following issue to LEWG (from New): <a href="3354">3354</a>.</li>
<li>Changed the following issue to Tentatively Resolved (from Ready): <a href="3322">3322</a>.</li>
<li>Changed the following 3 issues to Resolved (from New): <a href="2957">2957</a>, <a href="3023">3023</a>, <a href="3176">3176</a>.</li>
<li>Changed the following 3 issues to Resolved (from Open): <a href="2894">2894</a>, <a href="3061">3061</a>, <a href="3295">3295</a>.</li>
<li>Changed the following issue to Resolved (from EWG): <a href="2089">2089</a>.</li>
</ul></li>
</ul>
</li>
<li>R119: 
2019-12-09 post-Belfast mailing
<ul>
<li><b>Summary:</b><ul>
<li>376 open issues, up by 25.</li>
<li>2465 closed issues, up by 32.</li>
<li>35 reassigned issues, down by 1.</li>
<li>2876 issues total, up by 56.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 21 Ready issues: <a href="3302">3302</a>, <a href="3303">3303</a>, <a href="3307">3307</a>, <a href="3310">3310</a>, <a href="3313">3313</a>, <a href="3315">3315</a>, <a href="3316">3316</a>, <a href="3317">3317</a>, <a href="3318">3318</a>, <a href="3319">3319</a>, <a href="3320">3320</a>, <a href="3321">3321</a>, <a href="3322">3322</a>, <a href="3323">3323</a>, <a href="3324">3324</a>, <a href="3325">3325</a>, <a href="3326">3326</a>, <a href="3327">3327</a>, <a href="3329">3329</a>, <a href="3330">3330</a>, <a href="3331">3331</a>.</li>
<li>Added the following 5 Tentatively Ready issues: <a href="3299">3299</a>, <a href="3300">3300</a>, <a href="3332">3332</a>, <a href="3338">3338</a>, <a href="3346">3346</a>.</li>
<li>Added the following 27 New issues: <a href="3301">3301</a>, <a href="3305">3305</a>, <a href="3306">3306</a>, <a href="3308">3308</a>, <a href="3309">3309</a>, <a href="3314">3314</a>, <a href="3328">3328</a>, <a href="3333">3333</a>, <a href="3334">3334</a>, <a href="3335">3335</a>, <a href="3336">3336</a>, <a href="3337">3337</a>, <a href="3339">3339</a>, <a href="3340">3340</a>, <a href="3341">3341</a>, <a href="3342">3342</a>, <a href="3343">3343</a>, <a href="3344">3344</a>, <a href="3345">3345</a>, <a href="3347">3347</a>, <a href="3348">3348</a>, <a href="3349">3349</a>, <a href="3350">3350</a>, <a href="3351">3351</a>, <a href="3352">3352</a>, <a href="3353">3353</a>, <a href="3354">3354</a>.</li>
<li>Added the following LEWG issue: <a href="3304">3304</a>.</li>
<li>Added the following 2 Dup issues: <a href="lwg-closed.html#3311">3311</a>, <a href="lwg-closed.html#3312">3312</a>.</li>
<li>Changed the following issue to Ready (from New): <a href="3264">3264</a>.</li>
<li>Changed the following issue to Ready (from LEWG): <a href="3281">3281</a>.</li>
<li>Changed the following 7 issues to Tentatively Ready (from New): <a href="3233">3233</a>, <a href="3284">3284</a>, <a href="3285">3285</a>, <a href="3286">3286</a>, <a href="3291">3291</a>, <a href="3294">3294</a>, <a href="3296">3296</a>.</li>
<li>Changed the following issue to Open (from New): <a href="3295">3295</a>.</li>
<li>Changed the following issue to Open (from LEWG): <a href="3282">3282</a>.</li>
<li>Changed the following issue to LEWG (from New): <a href="3228">3228</a>.</li>
<li>Changed the following 4 issues to WP (from Ready): <a href="3070">3070</a>, <a href="3103">3103</a>, <a href="3149">3149</a>, <a href="3190">3190</a>.</li>
<li>Changed the following 23 issues to WP (from Tentatively Ready): <a href="3218">3218</a>, <a href="3221">3221</a>, <a href="3222">3222</a>, <a href="3224">3224</a>, <a href="3225">3225</a>, <a href="3230">3230</a>, <a href="3231">3231</a>, <a href="3232">3232</a>, <a href="3235">3235</a>, <a href="3241">3241</a>, <a href="3244">3244</a>, <a href="3245">3245</a>, <a href="3246">3246</a>, <a href="3253">3253</a>, <a href="3256">3256</a>, <a href="3257">3257</a>, <a href="3259">3259</a>, <a href="3266">3266</a>, <a href="3272">3272</a>, <a href="3273">3273</a>, <a href="3274">3274</a>, <a href="3276">3276</a>, <a href="3277">3277</a>.</li>
<li>Changed the following 2 issues to Resolved (from New): <a href="3239">3239</a>, <a href="3279">3279</a>.</li>
<li>Changed the following issue to Resolved (from SG1): <a href="2334">2334</a>.</li>
</ul></li>
</ul>
</li>
<li>R118: 
2019-10-06 pre-Belfast mailing
<ul>
<li><b>Summary:</b><ul>
<li>351 open issues, up by 48.</li>
<li>2433 closed issues, up by 0.</li>
<li>36 reassigned issues, up by 2.</li>
<li>2820 issues total, up by 50.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 10 Tentatively Ready issues: <a href="3253">3253</a>, <a href="3256">3256</a>, <a href="3257">3257</a>, <a href="3259">3259</a>, <a href="3266">3266</a>, <a href="3272">3272</a>, <a href="3273">3273</a>, <a href="3274">3274</a>, <a href="3276">3276</a>, <a href="3277">3277</a>.</li>
<li>Added the following 38 New issues: <a href="3249">3249</a>, <a href="3250">3250</a>, <a href="3251">3251</a>, <a href="3252">3252</a>, <a href="3254">3254</a>, <a href="3255">3255</a>, <a href="3258">3258</a>, <a href="3260">3260</a>, <a href="3261">3261</a>, <a href="3262">3262</a>, <a href="3263">3263</a>, <a href="3264">3264</a>, <a href="3265">3265</a>, <a href="3267">3267</a>, <a href="3268">3268</a>, <a href="3269">3269</a>, <a href="3270">3270</a>, <a href="3271">3271</a>, <a href="3275">3275</a>, <a href="3278">3278</a>, <a href="3279">3279</a>, <a href="3280">3280</a>, <a href="3283">3283</a>, <a href="3284">3284</a>, <a href="3285">3285</a>, <a href="3286">3286</a>, <a href="3287">3287</a>, <a href="3288">3288</a>, <a href="3289">3289</a>, <a href="3290">3290</a>, <a href="3291">3291</a>, <a href="3292">3292</a>, <a href="3293">3293</a>, <a href="3294">3294</a>, <a href="3295">3295</a>, <a href="3296">3296</a>, <a href="3297">3297</a>, <a href="3298">3298</a>.</li>
<li>Added the following 2 LEWG issues: <a href="3281">3281</a>, <a href="3282">3282</a>.</li>
<li>Changed the following 5 issues to Tentatively Ready (from New): <a href="3235">3235</a>, <a href="3241">3241</a>, <a href="3244">3244</a>, <a href="3245">3245</a>, <a href="3246">3246</a>.</li>
</ul></li>
</ul>
</li>
<li>R117: 
2019-08-05 post-Cologne mailing
<ul>
<li><b>Summary:</b><ul>
<li>303 open issues, up by 8.</li>
<li>2433 closed issues, up by 20.</li>
<li>34 reassigned issues, down by 1.</li>
<li>2770 issues total, up by 27.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 6 Tentatively Ready issues: <a href="3222">3222</a>, <a href="3224">3224</a>, <a href="3225">3225</a>, <a href="3230">3230</a>, <a href="3231">3231</a>, <a href="3232">3232</a>.</li>
<li>Added the following 21 New issues: <a href="3223">3223</a>, <a href="3226">3226</a>, <a href="3227">3227</a>, <a href="3228">3228</a>, <a href="3229">3229</a>, <a href="3233">3233</a>, <a href="3234">3234</a>, <a href="3235">3235</a>, <a href="3236">3236</a>, <a href="3237">3237</a>, <a href="3238">3238</a>, <a href="3239">3239</a>, <a href="3240">3240</a>, <a href="3241">3241</a>, <a href="3242">3242</a>, <a href="3243">3243</a>, <a href="3244">3244</a>, <a href="3245">3245</a>, <a href="3246">3246</a>, <a href="3247">3247</a>, <a href="3248">3248</a>.</li>
<li>Changed the following 2 issues to Ready (from New): <a href="3070">3070</a>, <a href="3190">3190</a>.</li>
<li>Changed the following 2 issues to Ready (from Open): <a href="3103">3103</a>, <a href="3149">3149</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from New): <a href="3218">3218</a>, <a href="3221">3221</a>.</li>
<li>Changed the following 2 issues to Open (from New): <a href="2818">2818</a>, <a href="3170">3170</a>.</li>
<li>Changed the following 6 issues to WP (from Ready): <a href="2899">2899</a>, <a href="3055">3055</a>, <a href="3158">3158</a>, <a href="3169">3169</a>, <a href="3186">3186</a>, <a href="3187">3187</a>.</li>
<li>Changed the following 11 issues to WP (from Tentatively Ready): <a href="3183">3183</a>, <a href="3184">3184</a>, <a href="3185">3185</a>, <a href="3191">3191</a>, <a href="3196">3196</a>, <a href="3198">3198</a>, <a href="3199">3199</a>, <a href="3202">3202</a>, <a href="3206">3206</a>, <a href="3208">3208</a>, <a href="3209">3209</a>.</li>
<li>Changed the following issue to Resolved (from New): <a href="3091">3091</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="3139">3139</a>.</li>
<li>Changed the following issue to NAD (from LEWG): <a href="3138">3138</a>.</li>
</ul></li>
</ul>
</li>
<li>R116: 
2019-06-17 pre-Cologne mailing
<ul>
<li><b>Summary:</b><ul>
<li>295 open issues, up by 25.</li>
<li>2413 closed issues, up by 0.</li>
<li>35 reassigned issues, up by 0.</li>
<li>2743 issues total, up by 25.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 6 Tentatively Ready issues: <a href="3198">3198</a>, <a href="3199">3199</a>, <a href="3202">3202</a>, <a href="3206">3206</a>, <a href="3208">3208</a>, <a href="3209">3209</a>.</li>
<li>Added the following Tentatively NAD issue: <a href="3207">3207</a>.</li>
<li>Added the following 18 New issues: <a href="3197">3197</a>, <a href="3200">3200</a>, <a href="3201">3201</a>, <a href="3203">3203</a>, <a href="3204">3204</a>, <a href="3205">3205</a>, <a href="3210">3210</a>, <a href="3211">3211</a>, <a href="3212">3212</a>, <a href="3213">3213</a>, <a href="3214">3214</a>, <a href="3215">3215</a>, <a href="3216">3216</a>, <a href="3217">3217</a>, <a href="3218">3218</a>, <a href="3219">3219</a>, <a href="3220">3220</a>, <a href="3221">3221</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from New): <a href="3191">3191</a>, <a href="3196">3196</a>.</li>
</ul></li>
</ul>
</li>
<li>R115: 
2019-04-02 post-Kona mailing
<ul>
<li><b>Summary:</b><ul>
<li>270 open issues, down by 19.</li>
<li>2413 closed issues, up by 31.</li>
<li>35 reassigned issues, up by 0.</li>
<li>2718 issues total, up by 12.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 2 Ready issues: <a href="3186">3186</a>, <a href="3187">3187</a>.</li>
<li>Added the following Tentatively Ready issue: <a href="3185">3185</a>.</li>
<li>Added the following 9 New issues: <a href="3188">3188</a>, <a href="3189">3189</a>, <a href="3190">3190</a>, <a href="3191">3191</a>, <a href="3192">3192</a>, <a href="3193">3193</a>, <a href="3194">3194</a>, <a href="3195">3195</a>, <a href="3196">3196</a>.</li>
<li>Changed the following 3 issues to Ready (from New): <a href="3055">3055</a>, <a href="3158">3158</a>, <a href="3169">3169</a>.</li>
<li>Changed the following issue to Ready (from Open): <a href="2899">2899</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from New): <a href="3183">3183</a>, <a href="3184">3184</a>.</li>
<li>Changed the following 4 issues to Open (from New): <a href="3036">3036</a>, <a href="3161">3161</a>, <a href="3168">3168</a>, <a href="3171">3171</a>.</li>
<li>Changed the following 5 issues to Tentatively Resolved (from New): <a href="2292">2292</a>, <a href="2808">2808</a>, <a href="2832">2832</a>, <a href="2999">2999</a>, <a href="3178">3178</a>.</li>
<li>Changed the following issue to Tentatively Resolved (from Open): <a href="2155">2155</a>.</li>
<li>Changed the following 2 issues to WP (from Ready): <a href="3012">3012</a>, <a href="3119">3119</a>.</li>
<li>Changed the following 11 issues to WP (from Tentatively Ready): <a href="3040">3040</a>, <a href="3077">3077</a>, <a href="3087">3087</a>, <a href="3101">3101</a>, <a href="3112">3112</a>, <a href="3133">3133</a>, <a href="3144">3144</a>, <a href="3173">3173</a>, <a href="3179">3179</a>, <a href="3180">3180</a>, <a href="3182">3182</a>.</li>
<li>Changed the following 2 issues to Resolved (from New): <a href="2951">2951</a>, <a href="3113">3113</a>.</li>
<li>Changed the following 16 issues to NAD (from Tentatively NAD): <a href="708">708</a>, <a href="935">935</a>, <a href="1121">1121</a>, <a href="1154">1154</a>, <a href="1188">1188</a>, <a href="1217">1217</a>, <a href="1235">1235</a>, <a href="1282">1282</a>, <a href="1289">1289</a>, <a href="1317">1317</a>, <a href="1406">1406</a>, <a href="1499">1499</a>, <a href="2226">2226</a>, <a href="2417">2417</a>, <a href="2600">2600</a>, <a href="3106">3106</a>.</li>
</ul></li>
</ul>
</li>
<li>R114: 
2019-01-21 pre-Kona mailing
<ul>
<li><b>Summary:</b><ul>
<li>289 open issues, up by 14.</li>
<li>2382 closed issues, up by 1.</li>
<li>35 reassigned issues, up by 0.</li>
<li>2706 issues total, up by 15.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 4 Tentatively Ready issues: <a href="3173">3173</a>, <a href="3179">3179</a>, <a href="3180">3180</a>, <a href="3182">3182</a>.</li>
<li>Added the following 10 New issues: <a href="3170">3170</a>, <a href="3171">3171</a>, <a href="3172">3172</a>, <a href="3174">3174</a>, <a href="3175">3175</a>, <a href="3176">3176</a>, <a href="3177">3177</a>, <a href="3178">3178</a>, <a href="3183">3183</a>, <a href="3184">3184</a>.</li>
<li>Added the following NAD issue: <a href="3181">3181</a>.</li>
<li>Changed the following 4 issues to Tentatively Ready (from New): <a href="3077">3077</a>, <a href="3112">3112</a>, <a href="3133">3133</a>, <a href="3144">3144</a>.</li>
</ul></li>
</ul>
</li>
<li>R113: 
2018-11-26 post-San Diego mailing
<ul>
<li><b>Summary:</b><ul>
<li>275 open issues, down by 45.</li>
<li>2381 closed issues, up by 52.</li>
<li>35 reassigned issues, up by 0.</li>
<li>2691 issues total, up by 7.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 4 New issues: <a href="3166">3166</a>, <a href="3167">3167</a>, <a href="3168">3168</a>, <a href="3169">3169</a>.</li>
<li>Added the following LEWG issue: <a href="3165">3165</a>.</li>
<li>Added the following 2 NAD issues: <a href="3163">3163</a>, <a href="3164">3164</a>.</li>
<li>Changed the following issue to Ready (from New): <a href="3119">3119</a>.</li>
<li>Changed the following issue to Ready (from Open): <a href="3012">3012</a>.</li>
<li>Changed the following issue to Tentatively Ready (from New): <a href="3087">3087</a>.</li>
<li>Changed the following issue to Tentatively Ready (from Open): <a href="3040">3040</a>.</li>
<li>Changed the following issue to Tentatively Ready (from LEWG): <a href="3101">3101</a>.</li>
<li>Changed the following 7 issues to Open (from New): <a href="2962">2962</a>, <a href="2994">2994</a>, <a href="3057">3057</a>, <a href="3061">3061</a>, <a href="3103">3103</a>, <a href="3121">3121</a>, <a href="3149">3149</a>.</li>
<li>Changed the following 2 issues to Open (from Core): <a href="2859">2859</a>, <a href="2860">2860</a>.</li>
<li>Changed the following issue to LEWG (from New): <a href="3138">3138</a>.</li>
<li>Changed the following issue to LEWG (from Open): <a href="2307">2307</a>.</li>
<li>Changed the following 10 issues to WP (from Ready): <a href="2183">2183</a>, <a href="2184">2184</a>, <a href="2412">2412</a>, <a href="2682">2682</a>, <a href="2697">2697</a>, <a href="2936">2936</a>, <a href="2995">2995</a>, <a href="2996">2996</a>, <a href="3054">3054</a>, <a href="3116">3116</a>.</li>
<li>Changed the following 24 issues to WP (from Tentatively Ready): <a href="2943">2943</a>, <a href="2960">2960</a>, <a href="3008">3008</a>, <a href="3025">3025</a>, <a href="3031">3031</a>, <a href="3037">3037</a>, <a href="3038">3038</a>, <a href="3065">3065</a>, <a href="3096">3096</a>, <a href="3122">3122</a>, <a href="3127">3127</a>, <a href="3128">3128</a>, <a href="3129">3129</a>, <a href="3130">3130</a>, <a href="3131">3131</a>, <a href="3132">3132</a>, <a href="3137">3137</a>, <a href="3140">3140</a>, <a href="3145">3145</a>, <a href="3147">3147</a>, <a href="3148">3148</a>, <a href="3153">3153</a>, <a href="3154">3154</a>, <a href="3160">3160</a>.</li>
<li>Changed the following issue to Resolved (from Tentatively Ready): <a href="3134">3134</a>.</li>
<li>Changed the following 6 issues to Resolved (from New): <a href="2318">2318</a>, <a href="2836">2836</a>, <a href="2841">2841</a>, <a href="2929">2929</a>, <a href="3022">3022</a>, <a href="3115">3115</a>.</li>
<li>Changed the following 6 issues to Resolved (from Open): <a href="1052">1052</a>, <a href="2151">2151</a>, <a href="2499">2499</a>, <a href="2780">2780</a>, <a href="2797">2797</a>, <a href="3111">3111</a>.</li>
<li>Changed the following 2 issues to NAD (from New): <a href="2563">2563</a>, <a href="3016">3016</a>.</li>
<li>Changed the following issue to NAD (from Open): <a href="1242">1242</a>.</li>
</ul></li>
</ul>
</li>
<li>R112: 
2018-10-08 pre-San Diego mailing
<ul>
<li><b>Summary:</b><ul>
<li>320 open issues, up by 36.</li>
<li>2329 closed issues, up by 3.</li>
<li>35 reassigned issues, up by 0.</li>
<li>2684 issues total, up by 39.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 15 Tentatively Ready issues: <a href="3127">3127</a>, <a href="3128">3128</a>, <a href="3129">3129</a>, <a href="3130">3130</a>, <a href="3131">3131</a>, <a href="3132">3132</a>, <a href="3134">3134</a>, <a href="3137">3137</a>, <a href="3140">3140</a>, <a href="3145">3145</a>, <a href="3147">3147</a>, <a href="3148">3148</a>, <a href="3153">3153</a>, <a href="3154">3154</a>, <a href="3160">3160</a>.</li>
<li>Added the following 22 New issues: <a href="3124">3124</a>, <a href="3126">3126</a>, <a href="3133">3133</a>, <a href="3135">3135</a>, <a href="3136">3136</a>, <a href="3138">3138</a>, <a href="3139">3139</a>, <a href="3141">3141</a>, <a href="3142">3142</a>, <a href="3143">3143</a>, <a href="3144">3144</a>, <a href="3146">3146</a>, <a href="3149">3149</a>, <a href="3150">3150</a>, <a href="3151">3151</a>, <a href="3152">3152</a>, <a href="3156">3156</a>, <a href="3157">3157</a>, <a href="3158">3158</a>, <a href="3159">3159</a>, <a href="3161">3161</a>, <a href="3162">3162</a>.</li>
<li>Added the following 2 Open issues: <a href="3125">3125</a>, <a href="3155">3155</a>.</li>
<li>Changed the following 6 issues to Tentatively Ready (from New): <a href="2960">2960</a>, <a href="3025">3025</a>, <a href="3031">3031</a>, <a href="3037">3037</a>, <a href="3065">3065</a>, <a href="3096">3096</a>.</li>
<li>Changed the following 3 issues to Tentatively Ready (from Open): <a href="2943">2943</a>, <a href="3008">3008</a>, <a href="3038">3038</a>.</li>
<li>Changed the following issue to Tentatively NAD (from New): <a href="3106">3106</a>.</li>
<li>Changed the following 5 issues to Open (from New): <a href="2220">2220</a>, <a href="3081">3081</a>, <a href="3085">3085</a>, <a href="3092">3092</a>, <a href="3120">3120</a>.</li>
<li>Changed the following issue to EWG (from Open): <a href="2813">2813</a>.</li>
<li>Changed the following issue to Resolved (from Tentatively NAD): <a href="1150">1150</a>.</li>
<li>Changed the following issue to Resolved (from Open): <a href="2840">2840</a>.</li>
<li>Changed the following issue to Resolved (from LEWG): <a href="1201">1201</a>.</li>
</ul></li>
</ul>
</li>
<li>R111: 
2018-06-25 post-Rapperswil mailing
<ul>
<li><b>Summary:</b><ul>
<li>284 open issues, up by 15.</li>
<li>2326 closed issues, up by 25.</li>
<li>35 reassigned issues, down by 26.</li>
<li>2645 issues total, up by 14.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following Ready issue: <a href="3116">3116</a>.</li>
<li>Added the following Tentatively Ready issue: <a href="3122">3122</a>.</li>
<li>Added the following 10 New issues: <a href="3110">3110</a>, <a href="3112">3112</a>, <a href="3113">3113</a>, <a href="3115">3115</a>, <a href="3117">3117</a>, <a href="3118">3118</a>, <a href="3119">3119</a>, <a href="3120">3120</a>, <a href="3121">3121</a>, <a href="3123">3123</a>.</li>
<li>Added the following Open issue: <a href="3111">3111</a>.</li>
<li>Added the following LEWG issue: <a href="3114">3114</a>.</li>
<li>Changed the following 4 issues to Ready (from Review): <a href="2412">2412</a>, <a href="2682">2682</a>, <a href="2697">2697</a>, <a href="2936">2936</a>.</li>
<li>Changed the following 4 issues to Ready (from New): <a href="2183">2183</a>, <a href="2184">2184</a>, <a href="2995">2995</a>, <a href="3054">3054</a>.</li>
<li>Changed the following issue to Ready (from LEWG): <a href="2996">2996</a>.</li>
<li>Changed the following 16 issues to Tentatively NAD (from LEWG): <a href="708">708</a>, <a href="935">935</a>, <a href="1121">1121</a>, <a href="1150">1150</a>, <a href="1154">1154</a>, <a href="1188">1188</a>, <a href="1217">1217</a>, <a href="1235">1235</a>, <a href="1282">1282</a>, <a href="1289">1289</a>, <a href="1317">1317</a>, <a href="1406">1406</a>, <a href="1499">1499</a>, <a href="2226">2226</a>, <a href="2417">2417</a>, <a href="2600">2600</a>.</li>
<li>Changed the following issue to Open (from Review): <a href="2708">2708</a>.</li>
<li>Changed the following 7 issues to Open (from New): <a href="2173">2173</a>, <a href="2286">2286</a>, <a href="2829">2829</a>, <a href="3008">3008</a>, <a href="3038">3038</a>, <a href="3050">3050</a>, <a href="3082">3082</a>.</li>
<li>Changed the following 11 issues to Open (from LEWG): <a href="423">423</a>, <a href="523">523</a>, <a href="1052">1052</a>, <a href="1203">1203</a>, <a href="1238">1238</a>, <a href="1242">1242</a>, <a href="1396">1396</a>, <a href="1521">1521</a>, <a href="2471">2471</a>, <a href="2762">2762</a>, <a href="2780">2780</a>.</li>
<li>Changed the following 3 issues to LEWG (from New): <a href="3052">3052</a>, <a href="3068">3068</a>, <a href="3101">3101</a>.</li>
<li>Changed the following 3 issues to WP (from Ready): <a href="2139">2139</a>, <a href="3058">3058</a>, <a href="3076">3076</a>.</li>
<li>Changed the following 12 issues to WP (from Tentatively Ready): <a href="2970">2970</a>, <a href="3062">3062</a>, <a href="3067">3067</a>, <a href="3071">3071</a>, <a href="3074">3074</a>, <a href="3079">3079</a>, <a href="3080">3080</a>, <a href="3083">3083</a>, <a href="3094">3094</a>, <a href="3100">3100</a>, <a href="3102">3102</a>, <a href="3104">3104</a>.</li>
<li>Changed the following 4 issues to Resolved (from New): <a href="2511">2511</a>, <a href="2693">2693</a>, <a href="2776">2776</a>, <a href="2938">2938</a>.</li>
<li>Changed the following 2 issues to Resolved (from Open): <a href="2800">2800</a>, <a href="2897">2897</a>.</li>
<li>Changed the following 2 issues to Resolved (from LEWG): <a href="2040">2040</a>, <a href="2419">2419</a>.</li>
<li>Changed the following 2 issues to NAD (from New): <a href="2121">2121</a>, <a href="2892">2892</a>.</li>
</ul></li>
</ul>
</li>
<li>R110: 
2018-05-07 pre-Rapperswil mailing
<ul>
<li><b>Summary:</b><ul>
<li>269 open issues, up by 17.</li>
<li>2301 closed issues, up by 0.</li>
<li>61 reassigned issues, up by 0.</li>
<li>2631 issues total, up by 17.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 4 Tentatively Ready issues: <a href="3094">3094</a>, <a href="3100">3100</a>, <a href="3102">3102</a>, <a href="3104">3104</a>.</li>
<li>Added the following 13 New issues: <a href="3093">3093</a>, <a href="3095">3095</a>, <a href="3096">3096</a>, <a href="3097">3097</a>, <a href="3098">3098</a>, <a href="3099">3099</a>, <a href="3101">3101</a>, <a href="3103">3103</a>, <a href="3105">3105</a>, <a href="3106">3106</a>, <a href="3107">3107</a>, <a href="3108">3108</a>, <a href="3109">3109</a>.</li>
<li>No issues changed.</li>
</ul></li>
</ul>
</li>
<li>R109: 
2018-04-02 post-Jacksonville mailing
<ul>
<li><b>Summary:</b><ul>
<li>252 open issues, down by 5.</li>
<li>2301 closed issues, up by 36.</li>
<li>61 reassigned issues, down by 1.</li>
<li>2614 issues total, up by 30.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following Ready issue: <a href="3076">3076</a>.</li>
<li>Added the following 6 Tentatively Ready issues: <a href="3067">3067</a>, <a href="3071">3071</a>, <a href="3074">3074</a>, <a href="3079">3079</a>, <a href="3080">3080</a>, <a href="3083">3083</a>.</li>
<li>Added the following 22 New issues: <a href="3063">3063</a>, <a href="3064">3064</a>, <a href="3065">3065</a>, <a href="3066">3066</a>, <a href="3068">3068</a>, <a href="3069">3069</a>, <a href="3070">3070</a>, <a href="3072">3072</a>, <a href="3073">3073</a>, <a href="3077">3077</a>, <a href="3078">3078</a>, <a href="3081">3081</a>, <a href="3082">3082</a>, <a href="3084">3084</a>, <a href="3085">3085</a>, <a href="3086">3086</a>, <a href="3087">3087</a>, <a href="3088">3088</a>, <a href="3089">3089</a>, <a href="3090">3090</a>, <a href="3091">3091</a>, <a href="3092">3092</a>.</li>
<li>Added the following WP issue: <a href="3075">3075</a>.</li>
<li>Changed the following issue to Ready (from New): <a href="3058">3058</a>.</li>
<li>Changed the following issue to Ready (from Open): <a href="2139">2139</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from New): <a href="2970">2970</a>, <a href="3062">3062</a>.</li>
<li>Changed the following 2 issues to Open (from New): <a href="2823">2823</a>, <a href="3049">3049</a>.</li>
<li>Changed the following issue to SG1 (from New): <a href="2506">2506</a>.</li>
<li>Changed the following 5 issues to WP (from Ready): <a href="2843">2843</a>, <a href="2969">2969</a>, <a href="2975">2975</a>, <a href="3014">3014</a>, <a href="3030">3030</a>.</li>
<li>Changed the following 27 issues to WP (from Tentatively Ready): <a href="2164">2164</a>, <a href="2243">2243</a>, <a href="2816">2816</a>, <a href="2849">2849</a>, <a href="2851">2851</a>, <a href="2989">2989</a>, <a href="3000">3000</a>, <a href="3002">3002</a>, <a href="3004">3004</a>, <a href="3005">3005</a>, <a href="3007">3007</a>, <a href="3009">3009</a>, <a href="3010">3010</a>, <a href="3013">3013</a>, <a href="3015">3015</a>, <a href="3017">3017</a>, <a href="3020">3020</a>, <a href="3026">3026</a>, <a href="3034">3034</a>, <a href="3035">3035</a>, <a href="3039">3039</a>, <a href="3041">3041</a>, <a href="3042">3042</a>, <a href="3043">3043</a>, <a href="3045">3045</a>, <a href="3048">3048</a>, <a href="3051">3051</a>.</li>
<li>Changed the following issue to WP (from New): <a href="2946">2946</a>.</li>
<li>Changed the following 2 issues to Resolved (from LEWG): <a href="2831">2831</a>, <a href="2968">2968</a>.</li>
</ul></li>
</ul>
</li>
<li>R108: 
2018-02-12 pre-Jacksonville mailing
<ul>
<li><b>Summary:</b><ul>
<li>257 open issues, up by 16.</li>
<li>2265 closed issues, up by 7.</li>
<li>62 reassigned issues, up by 0.</li>
<li>2584 issues total, up by 23.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 6 Tentatively Ready issues: <a href="3041">3041</a>, <a href="3042">3042</a>, <a href="3043">3043</a>, <a href="3045">3045</a>, <a href="3048">3048</a>, <a href="3051">3051</a>.</li>
<li>Added the following 16 New issues: <a href="3044">3044</a>, <a href="3046">3046</a>, <a href="3047">3047</a>, <a href="3049">3049</a>, <a href="3050">3050</a>, <a href="3052">3052</a>, <a href="3053">3053</a>, <a href="3054">3054</a>, <a href="3055">3055</a>, <a href="3056">3056</a>, <a href="3057">3057</a>, <a href="3058">3058</a>, <a href="3059">3059</a>, <a href="3060">3060</a>, <a href="3061">3061</a>, <a href="3062">3062</a>.</li>
<li>Added the following Open issue: <a href="3040">3040</a>.</li>
<li>Changed the following 6 issues to Tentatively Ready (from New): <a href="2243">2243</a>, <a href="2816">2816</a>, <a href="2849">2849</a>, <a href="2851">2851</a>, <a href="2989">2989</a>, <a href="3015">3015</a>.</li>
<li>Changed the following issue to Tentatively Ready (from Open): <a href="2164">2164</a>.</li>
<li>Changed the following 3 issues to Review (from Open): <a href="2682">2682</a>, <a href="2708">2708</a>, <a href="2936">2936</a>.</li>
<li>Changed the following 4 issues to Open (from New): <a href="2839">2839</a>, <a href="2840">2840</a>, <a href="2990">2990</a>, <a href="3003">3003</a>.</li>
<li>Changed the following 2 issues to C++17 (from Open): <a href="2569">2569</a>, <a href="2587">2587</a>.</li>
<li>Changed the following 3 issues to Resolved (from New): <a href="2734">2734</a>, <a href="2821">2821</a>, <a href="2856">2856</a>.</li>
<li>Changed the following issue to Resolved (from Open): <a href="2055">2055</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2772">2772</a>.</li>
</ul></li>
</ul>
</li>
<li>R107: 
2017-11-28 2017 post-Albuquerque mailing
<ul>
<li><b>Summary:</b><ul>
<li>241 open issues, down by 16.</li>
<li>2258 closed issues, up by 29.</li>
<li>62 reassigned issues, up by 0.</li>
<li>2561 issues total, up by 13.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following Ready issue: <a href="3030">3030</a>.</li>
<li>Added the following 3 Tentatively Ready issues: <a href="3034">3034</a>, <a href="3035">3035</a>, <a href="3039">3039</a>.</li>
<li>Added the following 7 New issues: <a href="3027">3027</a>, <a href="3028">3028</a>, <a href="3031">3031</a>, <a href="3032">3032</a>, <a href="3036">3036</a>, <a href="3037">3037</a>, <a href="3038">3038</a>.</li>
<li>Added the following Open issue: <a href="3029">3029</a>.</li>
<li>Added the following NAD Editorial issue: <a href="3033">3033</a>.</li>
<li>Changed the following 4 issues to Ready (from New): <a href="2843">2843</a>, <a href="2969">2969</a>, <a href="2975">2975</a>, <a href="3014">3014</a>.</li>
<li>Changed the following 11 issues to Tentatively Ready (from New): <a href="3000">3000</a>, <a href="3002">3002</a>, <a href="3004">3004</a>, <a href="3005">3005</a>, <a href="3007">3007</a>, <a href="3009">3009</a>, <a href="3010">3010</a>, <a href="3013">3013</a>, <a href="3017">3017</a>, <a href="3020">3020</a>, <a href="3026">3026</a>.</li>
<li>Changed the following 6 issues to Open (from New): <a href="2800">2800</a>, <a href="2833">2833</a>, <a href="2897">2897</a>, <a href="2943">2943</a>, <a href="3011">3011</a>, <a href="3012">3012</a>.</li>
<li>Changed the following 23 issues to WP (from Ready): <a href="2779">2779</a>, <a href="2870">2870</a>, <a href="2935">2935</a>, <a href="2941">2941</a>, <a href="2944">2944</a>, <a href="2945">2945</a>, <a href="2948">2948</a>, <a href="2950">2950</a>, <a href="2952">2952</a>, <a href="2953">2953</a>, <a href="2964">2964</a>, <a href="2965">2965</a>, <a href="2972">2972</a>, <a href="2976">2976</a>, <a href="2977">2977</a>, <a href="2978">2978</a>, <a href="2979">2979</a>, <a href="2980">2980</a>, <a href="2981">2981</a>, <a href="2982">2982</a>, <a href="2988">2988</a>, <a href="2993">2993</a>, <a href="2998">2998</a>.</li>
<li>Changed the following 2 issues to WP (from Tentatively Ready): <a href="3001">3001</a>, <a href="3024">3024</a>.</li>
<li>Changed the following issue to WP (from New): <a href="2958">2958</a>.</li>
<li>Changed the following 2 issues to Resolved (from New): <a href="2541">2541</a>, <a href="2799">2799</a>.</li>
</ul></li>
</ul>
</li>
<li>R106: 
2017-10-16 2017 pre-Albuquerque mailing
<ul>
<li><b>Summary:</b><ul>
<li>257 open issues, up by 22.</li>
<li>2229 closed issues, up by 0.</li>
<li>62 reassigned issues, up by 0.</li>
<li>2548 issues total, up by 22.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following Tentatively Ready issue: <a href="3024">3024</a>.</li>
<li>Added the following 21 New issues: <a href="3005">3005</a>, <a href="3006">3006</a>, <a href="3007">3007</a>, <a href="3008">3008</a>, <a href="3009">3009</a>, <a href="3010">3010</a>, <a href="3011">3011</a>, <a href="3012">3012</a>, <a href="3013">3013</a>, <a href="3014">3014</a>, <a href="3015">3015</a>, <a href="3016">3016</a>, <a href="3017">3017</a>, <a href="3018">3018</a>, <a href="3019">3019</a>, <a href="3020">3020</a>, <a href="3021">3021</a>, <a href="3022">3022</a>, <a href="3023">3023</a>, <a href="3025">3025</a>, <a href="3026">3026</a>.</li>
<li>No issues changed.</li>
</ul></li>
</ul>
</li>
<li>R105: 
2017-07-30 2017 post-Toronto mailing
<ul>
<li><b>Summary:</b><ul>
<li>235 open issues, down by 22.</li>
<li>2229 closed issues, up by 36.</li>
<li>62 reassigned issues, up by 8.</li>
<li>2526 issues total, up by 22.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 3 Ready issues: <a href="2988">2988</a>, <a href="2993">2993</a>, <a href="2998">2998</a>.</li>
<li>Added the following Tentatively Ready issue: <a href="3001">3001</a>.</li>
<li>Added the following 14 New issues: <a href="2983">2983</a>, <a href="2984">2984</a>, <a href="2986">2986</a>, <a href="2987">2987</a>, <a href="2989">2989</a>, <a href="2990">2990</a>, <a href="2994">2994</a>, <a href="2995">2995</a>, <a href="2997">2997</a>, <a href="2999">2999</a>, <a href="3000">3000</a>, <a href="3002">3002</a>, <a href="3003">3003</a>, <a href="3004">3004</a>.</li>
<li>Added the following 3 LEWG issues: <a href="2985">2985</a>, <a href="2991">2991</a>, <a href="2996">2996</a>.</li>
<li>Added the following NAD issue: <a href="2992">2992</a>.</li>
<li>Changed the following 19 issues to Ready (from New): <a href="2870">2870</a>, <a href="2935">2935</a>, <a href="2941">2941</a>, <a href="2944">2944</a>, <a href="2945">2945</a>, <a href="2948">2948</a>, <a href="2950">2950</a>, <a href="2952">2952</a>, <a href="2953">2953</a>, <a href="2964">2964</a>, <a href="2965">2965</a>, <a href="2972">2972</a>, <a href="2976">2976</a>, <a href="2977">2977</a>, <a href="2978">2978</a>, <a href="2979">2979</a>, <a href="2980">2980</a>, <a href="2981">2981</a>, <a href="2982">2982</a>.</li>
<li>Changed the following issue to Ready (from LEWG): <a href="2779">2779</a>.</li>
<li>Changed the following 6 issues to Open (from New): <a href="2731">2731</a>, <a href="2741">2741</a>, <a href="2813">2813</a>, <a href="2820">2820</a>, <a href="2899">2899</a>, <a href="2936">2936</a>.</li>
<li>Changed the following 6 issues to LEWG (from New): <a href="2883">2883</a>, <a href="2884">2884</a>, <a href="2885">2885</a>, <a href="2922">2922</a>, <a href="2968">2968</a>, <a href="2973">2973</a>.</li>
<li>Changed the following issue to WP (from Ready): <a href="2932">2932</a>.</li>
<li>Changed the following 11 issues to WP (from Tentatively Ready): <a href="2444">2444</a>, <a href="2593">2593</a>, <a href="2597">2597</a>, <a href="2783">2783</a>, <a href="2937">2937</a>, <a href="2940">2940</a>, <a href="2942">2942</a>, <a href="2954">2954</a>, <a href="2961">2961</a>, <a href="2966">2966</a>, <a href="2974">2974</a>.</li>
<li>Changed the following 2 issues to C++17 (from New): <a href="2901">2901</a>, <a href="2956">2956</a>.</li>
<li>Changed the following 279 issues to C++17 (from WP): <a href="1169">1169</a>, <a href="2016">2016</a>, <a href="2059">2059</a>, <a href="2062">2062</a>, <a href="2063">2063</a>, <a href="2072">2072</a>, <a href="2076">2076</a>, <a href="2101">2101</a>, <a href="2106">2106</a>, <a href="2111">2111</a>, <a href="2119">2119</a>, <a href="2127">2127</a>, <a href="2129">2129</a>, <a href="2133">2133</a>, <a href="2156">2156</a>, <a href="2160">2160</a>, <a href="2166">2166</a>, <a href="2168">2168</a>, <a href="2170">2170</a>, <a href="2181">2181</a>, <a href="2192">2192</a>, <a href="2212">2212</a>, <a href="2217">2217</a>, <a href="2218">2218</a>, <a href="2219">2219</a>, <a href="2221">2221</a>, <a href="2223">2223</a>, <a href="2224">2224</a>, <a href="2230">2230</a>, <a href="2233">2233</a>, <a href="2234">2234</a>, <a href="2239">2239</a>, <a href="2244">2244</a>, <a href="2250">2250</a>, <a href="2259">2259</a>, <a href="2260">2260</a>, <a href="2261">2261</a>, <a href="2266">2266</a>, <a href="2273">2273</a>, <a href="2276">2276</a>, <a href="2296">2296</a>, <a href="2309">2309</a>, <a href="2310">2310</a>, <a href="2312">2312</a>, <a href="2325">2325</a>, <a href="2328">2328</a>, <a href="2336">2336</a>, <a href="2340">2340</a>, <a href="2353">2353</a>, <a href="2354">2354</a>, <a href="2361">2361</a>, <a href="2364">2364</a>, <a href="2365">2365</a>, <a href="2367">2367</a>, <a href="2369">2369</a>, <a href="2376">2376</a>, <a href="2377">2377</a>, <a href="2378">2378</a>, <a href="2380">2380</a>, <a href="2384">2384</a>, <a href="2385">2385</a>, <a href="2387">2387</a>, <a href="2393">2393</a>, <a href="2394">2394</a>, <a href="2396">2396</a>, <a href="2399">2399</a>, <a href="2400">2400</a>, <a href="2401">2401</a>, <a href="2403">2403</a>, <a href="2404">2404</a>, <a href="2406">2406</a>, <a href="2407">2407</a>, <a href="2408">2408</a>, <a href="2411">2411</a>, <a href="2415">2415</a>, <a href="2420">2420</a>, <a href="2422">2422</a>, <a href="2425">2425</a>, <a href="2426">2426</a>, <a href="2427">2427</a>, <a href="2428">2428</a>, <a href="2433">2433</a>, <a href="2434">2434</a>, <a href="2435">2435</a>, <a href="2436">2436</a>, <a href="2437">2437</a>, <a href="2438">2438</a>, <a href="2439">2439</a>, <a href="2440">2440</a>, <a href="2441">2441</a>, <a href="2442">2442</a>, <a href="2447">2447</a>, <a href="2448">2448</a>, <a href="2450">2450</a>, <a href="2454">2454</a>, <a href="2455">2455</a>, <a href="2458">2458</a>, <a href="2459">2459</a>, <a href="2460">2460</a>, <a href="2462">2462</a>, <a href="2464">2464</a>, <a href="2466">2466</a>, <a href="2467">2467</a>, <a href="2468">2468</a>, <a href="2469">2469</a>, <a href="2470">2470</a>, <a href="2473">2473</a>, <a href="2475">2475</a>, <a href="2476">2476</a>, <a href="2477">2477</a>, <a href="2482">2482</a>, <a href="2483">2483</a>, <a href="2484">2484</a>, <a href="2485">2485</a>, <a href="2486">2486</a>, <a href="2487">2487</a>, <a href="2488">2488</a>, <a href="2489">2489</a>, <a href="2492">2492</a>, <a href="2495">2495</a>, <a href="2503">2503</a>, <a href="2510">2510</a>, <a href="2514">2514</a>, <a href="2519">2519</a>, <a href="2520">2520</a>, <a href="2523">2523</a>, <a href="2531">2531</a>, <a href="2534">2534</a>, <a href="2536">2536</a>, <a href="2537">2537</a>, <a href="2540">2540</a>, <a href="2542">2542</a>, <a href="2544">2544</a>, <a href="2545">2545</a>, <a href="2549">2549</a>, <a href="2550">2550</a>, <a href="2556">2556</a>, <a href="2557">2557</a>, <a href="2559">2559</a>, <a href="2560">2560</a>, <a href="2562">2562</a>, <a href="2565">2565</a>, <a href="2566">2566</a>, <a href="2567">2567</a>, <a href="2571">2571</a>, <a href="2572">2572</a>, <a href="2576">2576</a>, <a href="2577">2577</a>, <a href="2578">2578</a>, <a href="2579">2579</a>, <a href="2581">2581</a>, <a href="2582">2582</a>, <a href="2583">2583</a>, <a href="2584">2584</a>, <a href="2585">2585</a>, <a href="2586">2586</a>, <a href="2589">2589</a>, <a href="2590">2590</a>, <a href="2591">2591</a>, <a href="2596">2596</a>, <a href="2598">2598</a>, <a href="2664">2664</a>, <a href="2667">2667</a>, <a href="2669">2669</a>, <a href="2670">2670</a>, <a href="2671">2671</a>, <a href="2672">2672</a>, <a href="2673">2673</a>, <a href="2674">2674</a>, <a href="2676">2676</a>, <a href="2678">2678</a>, <a href="2679">2679</a>, <a href="2680">2680</a>, <a href="2681">2681</a>, <a href="2683">2683</a>, <a href="2684">2684</a>, <a href="2685">2685</a>, <a href="2686">2686</a>, <a href="2687">2687</a>, <a href="2688">2688</a>, <a href="2689">2689</a>, <a href="2694">2694</a>, <a href="2696">2696</a>, <a href="2698">2698</a>, <a href="2699">2699</a>, <a href="2704">2704</a>, <a href="2706">2706</a>, <a href="2707">2707</a>, <a href="2709">2709</a>, <a href="2710">2710</a>, <a href="2711">2711</a>, <a href="2712">2712</a>, <a href="2716">2716</a>, <a href="2718">2718</a>, <a href="2719">2719</a>, <a href="2720">2720</a>, <a href="2721">2721</a>, <a href="2722">2722</a>, <a href="2723">2723</a>, <a href="2724">2724</a>, <a href="2725">2725</a>, <a href="2726">2726</a>, <a href="2727">2727</a>, <a href="2728">2728</a>, <a href="2729">2729</a>, <a href="2732">2732</a>, <a href="2735">2735</a>, <a href="2736">2736</a>, <a href="2738">2738</a>, <a href="2739">2739</a>, <a href="2740">2740</a>, <a href="2742">2742</a>, <a href="2744">2744</a>, <a href="2747">2747</a>, <a href="2748">2748</a>, <a href="2749">2749</a>, <a href="2752">2752</a>, <a href="2755">2755</a>, <a href="2756">2756</a>, <a href="2758">2758</a>, <a href="2759">2759</a>, <a href="2760">2760</a>, <a href="2765">2765</a>, <a href="2767">2767</a>, <a href="2768">2768</a>, <a href="2769">2769</a>, <a href="2770">2770</a>, <a href="2771">2771</a>, <a href="2773">2773</a>, <a href="2777">2777</a>, <a href="2778">2778</a>, <a href="2781">2781</a>, <a href="2782">2782</a>, <a href="2784">2784</a>, <a href="2785">2785</a>, <a href="2786">2786</a>, <a href="2787">2787</a>, <a href="2788">2788</a>, <a href="2789">2789</a>, <a href="2790">2790</a>, <a href="2793">2793</a>, <a href="2794">2794</a>, <a href="2795">2795</a>, <a href="2796">2796</a>, <a href="2801">2801</a>, <a href="2802">2802</a>, <a href="2804">2804</a>, <a href="2806">2806</a>, <a href="2807">2807</a>, <a href="2812">2812</a>, <a href="2824">2824</a>, <a href="2826">2826</a>, <a href="2834">2834</a>, <a href="2835">2835</a>, <a href="2837">2837</a>, <a href="2838">2838</a>, <a href="2842">2842</a>, <a href="2850">2850</a>, <a href="2853">2853</a>, <a href="2855">2855</a>, <a href="2857">2857</a>, <a href="2861">2861</a>, <a href="2866">2866</a>, <a href="2868">2868</a>, <a href="2872">2872</a>, <a href="2873">2873</a>, <a href="2874">2874</a>, <a href="2875">2875</a>, <a href="2876">2876</a>, <a href="2878">2878</a>, <a href="2890">2890</a>, <a href="2900">2900</a>, <a href="2903">2903</a>, <a href="2904">2904</a>, <a href="2905">2905</a>, <a href="2908">2908</a>, <a href="2911">2911</a>, <a href="2921">2921</a>, <a href="2934">2934</a>.</li>
<li>Changed the following 2 issues to Resolved (from New): <a href="2880">2880</a>, <a href="2955">2955</a>.</li>
<li>Changed the following 3 issues to Resolved (from Open): <a href="2070">2070</a>, <a href="2368">2368</a>, <a href="2665">2665</a>.</li>
<li>Changed the following issue to Resolved (from Pending Resolved): <a href="2798">2798</a>.</li>
<li>Changed the following 4 issues to NAD (from Tentatively NAD): <a href="760">760</a>, <a href="2337">2337</a>, <a href="2692">2692</a>, <a href="2717">2717</a>.</li>
<li>Changed the following 11 issues to NAD (from New): <a href="2852">2852</a>, <a href="2871">2871</a>, <a href="2886">2886</a>, <a href="2891">2891</a>, <a href="2893">2893</a>, <a href="2902">2902</a>, <a href="2907">2907</a>, <a href="2909">2909</a>, <a href="2916">2916</a>, <a href="2967">2967</a>, <a href="2971">2971</a>.</li>
<li>Changed the following issue to Dup (from New): <a href="2910">2910</a>.</li>
<li>Changed the following 77 issues to TS (from WP): <a href="2371">2371</a>, <a href="2374">2374</a>, <a href="2389">2389</a>, <a href="2390">2390</a>, <a href="2395">2395</a>, <a href="2409">2409</a>, <a href="2410">2410</a>, <a href="2418">2418</a>, <a href="2451">2451</a>, <a href="2463">2463</a>, <a href="2494">2494</a>, <a href="2500">2500</a>, <a href="2509">2509</a>, <a href="2515">2515</a>, <a href="2516">2516</a>, <a href="2517">2517</a>, <a href="2518">2518</a>, <a href="2521">2521</a>, <a href="2522">2522</a>, <a href="2525">2525</a>, <a href="2526">2526</a>, <a href="2527">2527</a>, <a href="2539">2539</a>, <a href="2551">2551</a>, <a href="2555">2555</a>, <a href="2558">2558</a>, <a href="2568">2568</a>, <a href="2570">2570</a>, <a href="2573">2573</a>, <a href="2574">2574</a>, <a href="2575">2575</a>, <a href="2588">2588</a>, <a href="2601">2601</a>, <a href="2602">2602</a>, <a href="2603">2603</a>, <a href="2605">2605</a>, <a href="2606">2606</a>, <a href="2607">2607</a>, <a href="2608">2608</a>, <a href="2609">2609</a>, <a href="2614">2614</a>, <a href="2615">2615</a>, <a href="2616">2616</a>, <a href="2618">2618</a>, <a href="2619">2619</a>, <a href="2621">2621</a>, <a href="2622">2622</a>, <a href="2624">2624</a>, <a href="2625">2625</a>, <a href="2627">2627</a>, <a href="2629">2629</a>, <a href="2632">2632</a>, <a href="2633">2633</a>, <a href="2634">2634</a>, <a href="2635">2635</a>, <a href="2636">2636</a>, <a href="2637">2637</a>, <a href="2640">2640</a>, <a href="2641">2641</a>, <a href="2644">2644</a>, <a href="2645">2645</a>, <a href="2647">2647</a>, <a href="2648">2648</a>, <a href="2649">2649</a>, <a href="2650">2650</a>, <a href="2652">2652</a>, <a href="2653">2653</a>, <a href="2655">2655</a>, <a href="2656">2656</a>, <a href="2657">2657</a>, <a href="2658">2658</a>, <a href="2660">2660</a>, <a href="2662">2662</a>, <a href="2733">2733</a>, <a href="2745">2745</a>, <a href="2750">2750</a>, <a href="2792">2792</a>.</li>
</ul></li>
</ul>
</li>
<li>R104: 
2017-06-18 2017 pre-Toronto mailing
<ul>
<li><b>Summary:</b><ul>
<li>257 open issues, up by 38.</li>
<li>2193 closed issues, up by 17.</li>
<li>54 reassigned issues, down by 19.</li>
<li>2504 issues total, up by 36.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 4 Tentatively Ready issues: <a href="2954">2954</a>, <a href="2961">2961</a>, <a href="2966">2966</a>, <a href="2974">2974</a>.</li>
<li>Added the following 32 New issues: <a href="2947">2947</a>, <a href="2948">2948</a>, <a href="2949">2949</a>, <a href="2950">2950</a>, <a href="2951">2951</a>, <a href="2952">2952</a>, <a href="2953">2953</a>, <a href="2955">2955</a>, <a href="2956">2956</a>, <a href="2957">2957</a>, <a href="2958">2958</a>, <a href="2959">2959</a>, <a href="2960">2960</a>, <a href="2962">2962</a>, <a href="2963">2963</a>, <a href="2964">2964</a>, <a href="2965">2965</a>, <a href="2967">2967</a>, <a href="2968">2968</a>, <a href="2969">2969</a>, <a href="2970">2970</a>, <a href="2971">2971</a>, <a href="2972">2972</a>, <a href="2973">2973</a>, <a href="2975">2975</a>, <a href="2976">2976</a>, <a href="2977">2977</a>, <a href="2978">2978</a>, <a href="2979">2979</a>, <a href="2980">2980</a>, <a href="2981">2981</a>, <a href="2982">2982</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from New): <a href="2940">2940</a>, <a href="2942">2942</a>.</li>
<li>Changed the following issue to Tentatively Ready (from LEWG): <a href="2593">2593</a>.</li>
<li>Changed the following issue to Open (from New): <a href="2797">2797</a>.</li>
<li>Changed the following 3 issues to Open (from LEWG): <a href="484">484</a>, <a href="1422">1422</a>, <a href="2055">2055</a>.</li>
<li>Changed the following issue to Pending Resolved (from Open): <a href="2798">2798</a>.</li>
<li>Changed the following issue to Resolved (from LEWG): <a href="2232">2232</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2898">2898</a>.</li>
<li>Changed the following 14 issues to NAD (from LEWG): <a href="255">255</a>, <a href="851">851</a>, <a href="877">877</a>, <a href="933">933</a>, <a href="1031">1031</a>, <a href="1053">1053</a>, <a href="1112">1112</a>, <a href="1120">1120</a>, <a href="1184">1184</a>, <a href="1320">1320</a>, <a href="2242">2242</a>, <a href="2430">2430</a>, <a href="2446">2446</a>, <a href="2854">2854</a>.</li>
</ul></li>
</ul>
</li>
<li>R103: 
2017-03-20 2017 post-Kona mailing
<ul>
<li><b>Summary:</b><ul>
<li>219 open issues, down by 86.</li>
<li>2176 closed issues, up by 104.</li>
<li>73 reassigned issues, up by 0.</li>
<li>2468 issues total, up by 18.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following Ready issue: <a href="2932">2932</a>.</li>
<li>Added the following Tentatively Ready issue: <a href="2937">2937</a>.</li>
<li>Added the following 13 New issues: <a href="2929">2929</a>, <a href="2933">2933</a>, <a href="2935">2935</a>, <a href="2936">2936</a>, <a href="2938">2938</a>, <a href="2939">2939</a>, <a href="2940">2940</a>, <a href="2941">2941</a>, <a href="2942">2942</a>, <a href="2943">2943</a>, <a href="2944">2944</a>, <a href="2945">2945</a>, <a href="2946">2946</a>.</li>
<li>Added the following Open issue: <a href="2931">2931</a>.</li>
<li>Added the following WP issue: <a href="2934">2934</a>.</li>
<li>Added the following NAD issue: <a href="2930">2930</a>.</li>
<li>Changed the following issue to Tentatively Ready (from New): <a href="2783">2783</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from Open): <a href="2444">2444</a>, <a href="2597">2597</a>.</li>
<li>Changed the following issue to Review (from SG1): <a href="2412">2412</a>.</li>
<li>Changed the following issue to Open (from New): <a href="2894">2894</a>.</li>
<li>Changed the following 2 issues to Core (from New): <a href="2859">2859</a>, <a href="2860">2860</a>.</li>
<li>Changed the following 6 issues to WP (from Ready): <a href="2781">2781</a>, <a href="2782">2782</a>, <a href="2784">2784</a>, <a href="2785">2785</a>, <a href="2786">2786</a>, <a href="2787">2787</a>.</li>
<li>Changed the following 18 issues to WP (from Tentatively Ready): <a href="2260">2260</a>, <a href="2768">2768</a>, <a href="2769">2769</a>, <a href="2789">2789</a>, <a href="2794">2794</a>, <a href="2795">2795</a>, <a href="2804">2804</a>, <a href="2812">2812</a>, <a href="2824">2824</a>, <a href="2826">2826</a>, <a href="2834">2834</a>, <a href="2835">2835</a>, <a href="2837">2837</a>, <a href="2838">2838</a>, <a href="2842">2842</a>, <a href="2850">2850</a>, <a href="2853">2853</a>, <a href="2855">2855</a>.</li>
<li>Changed the following 3 issues to WP (from Review): <a href="2676">2676</a>, <a href="2790">2790</a>, <a href="2796">2796</a>.</li>
<li>Changed the following 22 issues to WP (from New): <a href="2788">2788</a>, <a href="2801">2801</a>, <a href="2802">2802</a>, <a href="2806">2806</a>, <a href="2807">2807</a>, <a href="2861">2861</a>, <a href="2866">2866</a>, <a href="2868">2868</a>, <a href="2872">2872</a>, <a href="2873">2873</a>, <a href="2874">2874</a>, <a href="2875">2875</a>, <a href="2876">2876</a>, <a href="2878">2878</a>, <a href="2890">2890</a>, <a href="2900">2900</a>, <a href="2903">2903</a>, <a href="2904">2904</a>, <a href="2905">2905</a>, <a href="2908">2908</a>, <a href="2911">2911</a>, <a href="2921">2921</a>.</li>
<li>Changed the following issue to WP (from LEWG): <a href="2857">2857</a>.</li>
<li>Changed the following issue to Resolved (from Review): <a href="2245">2245</a>.</li>
<li>Changed the following 27 issues to Resolved (from New): <a href="2715">2715</a>, <a href="2803">2803</a>, <a href="2862">2862</a>, <a href="2863">2863</a>, <a href="2864">2864</a>, <a href="2867">2867</a>, <a href="2869">2869</a>, <a href="2877">2877</a>, <a href="2879">2879</a>, <a href="2882">2882</a>, <a href="2887">2887</a>, <a href="2888">2888</a>, <a href="2889">2889</a>, <a href="2895">2895</a>, <a href="2912">2912</a>, <a href="2913">2913</a>, <a href="2914">2914</a>, <a href="2915">2915</a>, <a href="2917">2917</a>, <a href="2918">2918</a>, <a href="2919">2919</a>, <a href="2920">2920</a>, <a href="2924">2924</a>, <a href="2925">2925</a>, <a href="2926">2926</a>, <a href="2927">2927</a>, <a href="2928">2928</a>.</li>
<li>Changed the following 19 issues to Resolved (from Tentatively Resolved): <a href="lwg-defects.html#839">839</a>, <a href="1041">1041</a>, <a href="2179">2179</a>, <a href="2208">2208</a>, <a href="2241">2241</a>, <a href="2294">2294</a>, <a href="2343">2343</a>, <a href="2370">2370</a>, <a href="2391">2391</a>, <a href="2424">2424</a>, <a href="2443">2443</a>, <a href="2501">2501</a>, <a href="2502">2502</a>, <a href="2505">2505</a>, <a href="2529">2529</a>, <a href="2548">2548</a>, <a href="2663">2663</a>, <a href="2677">2677</a>, <a href="2757">2757</a>.</li>
<li>Changed the following 3 issues to NAD (from New): <a href="2256">2256</a>, <a href="2449">2449</a>, <a href="2865">2865</a>.</li>
<li>Changed the following 2 issues to Dup (from New): <a href="2764">2764</a>, <a href="2896">2896</a>.</li>
</ul></li>
</ul>
</li>
<li>R102: 
2017-02-06 2017 pre-Kona mailing
<ul>
<li><b>Summary:</b><ul>
<li>305 open issues, up by 89.</li>
<li>2072 closed issues, up by 9.</li>
<li>73 reassigned issues, up by 5.</li>
<li>2450 issues total, up by 103.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 9 Tentatively Ready issues: <a href="2826">2826</a>, <a href="2834">2834</a>, <a href="2835">2835</a>, <a href="2837">2837</a>, <a href="2838">2838</a>, <a href="2842">2842</a>, <a href="2850">2850</a>, <a href="2853">2853</a>, <a href="2855">2855</a>.</li>
<li>Added the following 89 New issues: <a href="2827">2827</a>, <a href="2829">2829</a>, <a href="2832">2832</a>, <a href="2833">2833</a>, <a href="2836">2836</a>, <a href="2839">2839</a>, <a href="2840">2840</a>, <a href="2841">2841</a>, <a href="2843">2843</a>, <a href="2844">2844</a>, <a href="2845">2845</a>, <a href="2846">2846</a>, <a href="2847">2847</a>, <a href="2848">2848</a>, <a href="2849">2849</a>, <a href="2851">2851</a>, <a href="2852">2852</a>, <a href="2856">2856</a>, <a href="2858">2858</a>, <a href="2859">2859</a>, <a href="2860">2860</a>, <a href="2861">2861</a>, <a href="2862">2862</a>, <a href="2863">2863</a>, <a href="2864">2864</a>, <a href="2865">2865</a>, <a href="2866">2866</a>, <a href="2867">2867</a>, <a href="2868">2868</a>, <a href="2869">2869</a>, <a href="2870">2870</a>, <a href="2871">2871</a>, <a href="2872">2872</a>, <a href="2873">2873</a>, <a href="2874">2874</a>, <a href="2875">2875</a>, <a href="2876">2876</a>, <a href="2877">2877</a>, <a href="2878">2878</a>, <a href="2879">2879</a>, <a href="2880">2880</a>, <a href="2881">2881</a>, <a href="2882">2882</a>, <a href="2883">2883</a>, <a href="2884">2884</a>, <a href="2885">2885</a>, <a href="2886">2886</a>, <a href="2887">2887</a>, <a href="2888">2888</a>, <a href="2889">2889</a>, <a href="2890">2890</a>, <a href="2891">2891</a>, <a href="2892">2892</a>, <a href="2893">2893</a>, <a href="2894">2894</a>, <a href="2895">2895</a>, <a href="2896">2896</a>, <a href="2897">2897</a>, <a href="2898">2898</a>, <a href="2899">2899</a>, <a href="2900">2900</a>, <a href="2901">2901</a>, <a href="2902">2902</a>, <a href="2903">2903</a>, <a href="2904">2904</a>, <a href="2905">2905</a>, <a href="2906">2906</a>, <a href="2907">2907</a>, <a href="2908">2908</a>, <a href="2909">2909</a>, <a href="2910">2910</a>, <a href="2911">2911</a>, <a href="2912">2912</a>, <a href="2913">2913</a>, <a href="2914">2914</a>, <a href="2915">2915</a>, <a href="2916">2916</a>, <a href="2917">2917</a>, <a href="2918">2918</a>, <a href="2919">2919</a>, <a href="2920">2920</a>, <a href="2921">2921</a>, <a href="2922">2922</a>, <a href="2923">2923</a>, <a href="2924">2924</a>, <a href="2925">2925</a>, <a href="2926">2926</a>, <a href="2927">2927</a>, <a href="2928">2928</a>.</li>
<li>Added the following 3 LEWG issues: <a href="2831">2831</a>, <a href="2854">2854</a>, <a href="2857">2857</a>.</li>
<li>Added the following Resolved issue: <a href="2830">2830</a>.</li>
<li>Added the following NAD Editorial issue: <a href="2828">2828</a>.</li>
<li>Changed the following 5 issues to Tentatively Ready (from New): <a href="2789">2789</a>, <a href="2795">2795</a>, <a href="2804">2804</a>, <a href="2812">2812</a>, <a href="2824">2824</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from Open): <a href="2768">2768</a>, <a href="2769">2769</a>.</li>
<li>Changed the following 2 issues to Review (from New): <a href="2790">2790</a>, <a href="2796">2796</a>.</li>
<li>Changed the following 2 issues to LEWG (from New): <a href="2814">2814</a>, <a href="2825">2825</a>.</li>
<li>Changed the following 2 issues to WP (from New): <a href="2792">2792</a>, <a href="2793">2793</a>.</li>
<li>Changed the following 3 issues to Resolved (from New): <a href="2805">2805</a>, <a href="2809">2809</a>, <a href="2810">2810</a>.</li>
<li>Changed the following issue to Resolved (from Open): <a href="2754">2754</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2822">2822</a>.</li>
</ul></li>
</ul>
</li>
<li>R101: 
2016-11-28 2016 post-Issaquah mailing
<ul>
<li><b>Summary:</b><ul>
<li>216 open issues, down by 44.</li>
<li>2063 closed issues, up by 85.</li>
<li>68 reassigned issues, up by 0.</li>
<li>2347 issues total, up by 41.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 3 Ready issues: <a href="2785">2785</a>, <a href="2786">2786</a>, <a href="2787">2787</a>.</li>
<li>Added the following Tentatively Ready issue: <a href="2794">2794</a>.</li>
<li>Added the following 34 New issues: <a href="2788">2788</a>, <a href="2789">2789</a>, <a href="2790">2790</a>, <a href="2792">2792</a>, <a href="2793">2793</a>, <a href="2795">2795</a>, <a href="2796">2796</a>, <a href="2797">2797</a>, <a href="2799">2799</a>, <a href="2800">2800</a>, <a href="2801">2801</a>, <a href="2802">2802</a>, <a href="2803">2803</a>, <a href="2804">2804</a>, <a href="2805">2805</a>, <a href="2806">2806</a>, <a href="2807">2807</a>, <a href="2808">2808</a>, <a href="2809">2809</a>, <a href="2810">2810</a>, <a href="2811">2811</a>, <a href="2812">2812</a>, <a href="2813">2813</a>, <a href="2814">2814</a>, <a href="2815">2815</a>, <a href="2816">2816</a>, <a href="2818">2818</a>, <a href="2819">2819</a>, <a href="2820">2820</a>, <a href="2821">2821</a>, <a href="2822">2822</a>, <a href="2823">2823</a>, <a href="2824">2824</a>, <a href="2825">2825</a>.</li>
<li>Added the following Open issue: <a href="2798">2798</a>.</li>
<li>Added the following 2 Resolved issues: <a href="2791">2791</a>, <a href="2817">2817</a>.</li>
<li>Changed the following 3 issues to Ready (from New): <a href="2781">2781</a>, <a href="2782">2782</a>, <a href="2784">2784</a>.</li>
<li>Changed the following issue to Tentatively Ready (from Open): <a href="2260">2260</a>.</li>
<li>Changed the following issue to Review (from New): <a href="2697">2697</a>.</li>
<li>Changed the following 3 issues to Open (from Tentatively Ready): <a href="2569">2569</a>, <a href="2754">2754</a>, <a href="2768">2768</a>.</li>
<li>Changed the following 2 issues to Open (from New): <a href="2597">2597</a>, <a href="2730">2730</a>.</li>
<li>Changed the following issue to LEWG (from New): <a href="2780">2780</a>.</li>
<li>Changed the following issue to Pending NAD Editorial (from Open): <a href="2178">2178</a>.</li>
<li>Changed the following 66 issues to WP (from Tentatively Ready): <a href="2062">2062</a>, <a href="2166">2166</a>, <a href="2221">2221</a>, <a href="2223">2223</a>, <a href="2261">2261</a>, <a href="2394">2394</a>, <a href="2460">2460</a>, <a href="2468">2468</a>, <a href="2475">2475</a>, <a href="2503">2503</a>, <a href="2510">2510</a>, <a href="2514">2514</a>, <a href="2519">2519</a>, <a href="2531">2531</a>, <a href="2534">2534</a>, <a href="2536">2536</a>, <a href="2540">2540</a>, <a href="2544">2544</a>, <a href="2556">2556</a>, <a href="2562">2562</a>, <a href="2567">2567</a>, <a href="2570">2570</a>, <a href="2578">2578</a>, <a href="2584">2584</a>, <a href="2589">2589</a>, <a href="2591">2591</a>, <a href="2598">2598</a>, <a href="2664">2664</a>, <a href="2672">2672</a>, <a href="2678">2678</a>, <a href="2679">2679</a>, <a href="2680">2680</a>, <a href="2681">2681</a>, <a href="2686">2686</a>, <a href="2694">2694</a>, <a href="2696">2696</a>, <a href="2699">2699</a>, <a href="2712">2712</a>, <a href="2722">2722</a>, <a href="2729">2729</a>, <a href="2732">2732</a>, <a href="2733">2733</a>, <a href="2735">2735</a>, <a href="2736">2736</a>, <a href="2738">2738</a>, <a href="2739">2739</a>, <a href="2740">2740</a>, <a href="2742">2742</a>, <a href="2744">2744</a>, <a href="2745">2745</a>, <a href="2747">2747</a>, <a href="2748">2748</a>, <a href="2749">2749</a>, <a href="2750">2750</a>, <a href="2752">2752</a>, <a href="2755">2755</a>, <a href="2756">2756</a>, <a href="2758">2758</a>, <a href="2759">2759</a>, <a href="2760">2760</a>, <a href="2765">2765</a>, <a href="2767">2767</a>, <a href="2771">2771</a>, <a href="2773">2773</a>, <a href="2777">2777</a>, <a href="2778">2778</a>.</li>
<li>Changed the following 4 issues to WP (from New): <a href="2518">2518</a>, <a href="2521">2521</a>, <a href="2525">2525</a>, <a href="2527">2527</a>.</li>
<li>Changed the following 3 issues to WP (from Open): <a href="2568">2568</a>, <a href="2588">2588</a>, <a href="2770">2770</a>.</li>
<li>Changed the following 2 issues to Resolved (from Tentatively Ready): <a href="2543">2543</a>, <a href="2753">2753</a>.</li>
<li>Changed the following issue to Resolved (from New): <a href="2763">2763</a>.</li>
<li>Changed the following issue to Resolved (from Open): <a href="2465">2465</a>.</li>
<li>Changed the following issue to Resolved (from SG1): <a href="2445">2445</a>.</li>
<li>Changed the following issue to NAD Editorial (from New): <a href="2201">2201</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2668">2668</a>.</li>
<li>Changed the following 2 issues to NAD (from Open): <a href="1173">1173</a>, <a href="2199">2199</a>.</li>
</ul></li>
</ul>
</li>
<li>R100: 
2016-10-17 2016 pre-Issaquah mailing
<ul>
<li><b>Summary:</b><ul>
<li>260 open issues, up by 31.</li>
<li>1978 closed issues, up by 5.</li>
<li>68 reassigned issues, up by 5.</li>
<li>2306 issues total, up by 41.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 21 Tentatively Ready issues: <a href="2744">2744</a>, <a href="2745">2745</a>, <a href="2747">2747</a>, <a href="2748">2748</a>, <a href="2749">2749</a>, <a href="2750">2750</a>, <a href="2752">2752</a>, <a href="2753">2753</a>, <a href="2754">2754</a>, <a href="2755">2755</a>, <a href="2756">2756</a>, <a href="2758">2758</a>, <a href="2759">2759</a>, <a href="2760">2760</a>, <a href="2765">2765</a>, <a href="2767">2767</a>, <a href="2768">2768</a>, <a href="2771">2771</a>, <a href="2773">2773</a>, <a href="2777">2777</a>, <a href="2778">2778</a>.</li>
<li>Added the following 13 New issues: <a href="2746">2746</a>, <a href="2751">2751</a>, <a href="2763">2763</a>, <a href="2764">2764</a>, <a href="2766">2766</a>, <a href="2772">2772</a>, <a href="2774">2774</a>, <a href="2776">2776</a>, <a href="2780">2780</a>, <a href="2781">2781</a>, <a href="2782">2782</a>, <a href="2783">2783</a>, <a href="2784">2784</a>.</li>
<li>Added the following 2 Open issues: <a href="2769">2769</a>, <a href="2770">2770</a>.</li>
<li>Added the following 2 LEWG issues: <a href="2762">2762</a>, <a href="2779">2779</a>.</li>
<li>Added the following Tentatively Resolved issue: <a href="2757">2757</a>.</li>
<li>Added the following NAD issue: <a href="2761">2761</a>.</li>
<li>Added the following Dup issue: <a href="2775">2775</a>.</li>
<li>Changed the following 45 issues to Tentatively Ready (from New): <a href="2166">2166</a>, <a href="2221">2221</a>, <a href="2261">2261</a>, <a href="2394">2394</a>, <a href="2460">2460</a>, <a href="2475">2475</a>, <a href="2503">2503</a>, <a href="2514">2514</a>, <a href="2519">2519</a>, <a href="2531">2531</a>, <a href="2534">2534</a>, <a href="2536">2536</a>, <a href="2540">2540</a>, <a href="2544">2544</a>, <a href="2556">2556</a>, <a href="2562">2562</a>, <a href="2567">2567</a>, <a href="2569">2569</a>, <a href="2570">2570</a>, <a href="2578">2578</a>, <a href="2584">2584</a>, <a href="2589">2589</a>, <a href="2591">2591</a>, <a href="2598">2598</a>, <a href="2664">2664</a>, <a href="2672">2672</a>, <a href="2678">2678</a>, <a href="2679">2679</a>, <a href="2680">2680</a>, <a href="2681">2681</a>, <a href="2686">2686</a>, <a href="2694">2694</a>, <a href="2696">2696</a>, <a href="2699">2699</a>, <a href="2712">2712</a>, <a href="2722">2722</a>, <a href="2729">2729</a>, <a href="2732">2732</a>, <a href="2733">2733</a>, <a href="2735">2735</a>, <a href="2736">2736</a>, <a href="2738">2738</a>, <a href="2739">2739</a>, <a href="2740">2740</a>, <a href="2742">2742</a>.</li>
<li>Changed the following 5 issues to Tentatively Ready (from Open): <a href="2062">2062</a>, <a href="2223">2223</a>, <a href="2468">2468</a>, <a href="2510">2510</a>, <a href="2543">2543</a>.</li>
<li>Changed the following issue to Review (from New): <a href="2676">2676</a>.</li>
<li>Changed the following issue to Review (from Open): <a href="2245">2245</a>.</li>
<li>Changed the following 13 issues to Open (from New): <a href="2158">2158</a>, <a href="2358">2358</a>, <a href="2381">2381</a>, <a href="2465">2465</a>, <a href="2512">2512</a>, <a href="2530">2530</a>, <a href="2532">2532</a>, <a href="2568">2568</a>, <a href="2587">2587</a>, <a href="2588">2588</a>, <a href="2665">2665</a>, <a href="2682">2682</a>, <a href="2708">2708</a>.</li>
<li>Changed the following 3 issues to LEWG (from New): <a href="2242">2242</a>, <a href="2471">2471</a>, <a href="2593">2593</a>.</li>
<li>Changed the following 3 issues to LEWG (from Open): <a href="2095">2095</a>, <a href="2152">2152</a>, <a href="2153">2153</a>.</li>
<li>Changed the following 6 issues to Tentatively Resolved (from New): <a href="2343">2343</a>, <a href="2501">2501</a>, <a href="2502">2502</a>, <a href="2548">2548</a>, <a href="2663">2663</a>, <a href="2677">2677</a>.</li>
<li>Changed the following 4 issues to Tentatively Resolved (from Open): <a href="2294">2294</a>, <a href="2370">2370</a>, <a href="2424">2424</a>, <a href="2505">2505</a>.</li>
<li>Changed the following 3 issues to Tentatively Resolved (from LEWG): <a href="839">839</a>, <a href="1041">1041</a>, <a href="2443">2443</a>.</li>
<li>Changed the following issue to NAD Editorial (from New): <a href="2701">2701</a>.</li>
<li>Changed the following 2 issues to NAD (from New): <a href="2161">2161</a>, <a href="2535">2535</a>.</li>
</ul></li>
</ul>
</li>
<li>R99: 
2016-07-11 2016 post-Oulu mailing
<ul>
<li><b>Summary:</b><ul>
<li>292 open issues, down by 26.</li>
<li>1973 closed issues, up by 51.</li>
<li>2265 issues total, up by 25.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 16 New issues: <a href="2722">2722</a>, <a href="2729">2729</a>, <a href="2730">2730</a>, <a href="2731">2731</a>, <a href="2732">2732</a>, <a href="2733">2733</a>, <a href="2734">2734</a>, <a href="2735">2735</a>, <a href="2736">2736</a>, <a href="2737">2737</a>, <a href="2738">2738</a>, <a href="2739">2739</a>, <a href="2740">2740</a>, <a href="2741">2741</a>, <a href="2742">2742</a>, <a href="2743">2743</a>.</li>
<li>Added the following 9 WP issues: <a href="2719">2719</a>, <a href="2720">2720</a>, <a href="2721">2721</a>, <a href="2723">2723</a>, <a href="2724">2724</a>, <a href="2725">2725</a>, <a href="2726">2726</a>, <a href="2727">2727</a>, <a href="2728">2728</a>.</li>
<li>Changed the following issue to Tentatively NAD (from New): <a href="2717">2717</a>.</li>
<li>Changed the following issue to Tentatively Resolved (from Open): <a href="2241">2241</a>.</li>
<li>Changed the following 21 issues to WP (from Ready): <a href="2181">2181</a>, <a href="2309">2309</a>, <a href="2310">2310</a>, <a href="2328">2328</a>, <a href="2393">2393</a>, <a href="2426">2426</a>, <a href="2436">2436</a>, <a href="2441">2441</a>, <a href="2451">2451</a>, <a href="2516">2516</a>, <a href="2542">2542</a>, <a href="2549">2549</a>, <a href="2550">2550</a>, <a href="2551">2551</a>, <a href="2555">2555</a>, <a href="2573">2573</a>, <a href="2667">2667</a>, <a href="2669">2669</a>, <a href="2670">2670</a>, <a href="2671">2671</a>, <a href="2673">2673</a>.</li>
<li>Changed the following 12 issues to WP (from Tentatively Ready): <a href="2509">2509</a>, <a href="2596">2596</a>, <a href="2674">2674</a>, <a href="2683">2683</a>, <a href="2684">2684</a>, <a href="2685">2685</a>, <a href="2688">2688</a>, <a href="2689">2689</a>, <a href="2698">2698</a>, <a href="2706">2706</a>, <a href="2707">2707</a>, <a href="2710">2710</a>.</li>
<li>Changed the following 6 issues to WP (from New): <a href="2687">2687</a>, <a href="2704">2704</a>, <a href="2709">2709</a>, <a href="2711">2711</a>, <a href="2716">2716</a>, <a href="2718">2718</a>.</li>
<li>Changed the following 2 issues to WP (from Open): <a href="2312">2312</a>, <a href="2422">2422</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2700">2700</a>.</li>
</ul></li>
</ul>
</li>
<li>R98: 
2016-05-29 2016 pre-Oulu mailing
<ul>
<li><b>Summary:</b><ul>
<li>318 open issues, up by 50.</li>
<li>1922 closed issues, up by 0.</li>
<li>2240 issues total, up by 50.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 10 Tentatively Ready issues: <a href="2596">2596</a>, <a href="2683">2683</a>, <a href="2684">2684</a>, <a href="2685">2685</a>, <a href="2688">2688</a>, <a href="2689">2689</a>, <a href="2698">2698</a>, <a href="2706">2706</a>, <a href="2707">2707</a>, <a href="2710">2710</a>.</li>
<li>Added the following Tentatively NAD issue: <a href="2692">2692</a>.</li>
<li>Added the following 37 New issues: <a href="2595">2595</a>, <a href="2597">2597</a>, <a href="2598">2598</a>, <a href="2599">2599</a>, <a href="2675">2675</a>, <a href="2676">2676</a>, <a href="2677">2677</a>, <a href="2678">2678</a>, <a href="2679">2679</a>, <a href="2680">2680</a>, <a href="2681">2681</a>, <a href="2682">2682</a>, <a href="2686">2686</a>, <a href="2687">2687</a>, <a href="2691">2691</a>, <a href="2693">2693</a>, <a href="2694">2694</a>, <a href="2695">2695</a>, <a href="2696">2696</a>, <a href="2697">2697</a>, <a href="2699">2699</a>, <a href="2700">2700</a>, <a href="2701">2701</a>, <a href="2702">2702</a>, <a href="2703">2703</a>, <a href="2704">2704</a>, <a href="2705">2705</a>, <a href="2708">2708</a>, <a href="2709">2709</a>, <a href="2711">2711</a>, <a href="2712">2712</a>, <a href="2713">2713</a>, <a href="2714">2714</a>, <a href="2715">2715</a>, <a href="2716">2716</a>, <a href="2717">2717</a>, <a href="2718">2718</a>.</li>
<li>Added the following 2 LEWG issues: <a href="2600">2600</a>, <a href="2690">2690</a>.</li>
<li>Changed the following issue to Tentatively Ready (from New): <a href="2674">2674</a>.</li>
<li>Changed the following issue to Tentatively Ready (from Open): <a href="2509">2509</a>.</li>
<li>Changed the following 2 issues to Tentatively Resolved (from New): <a href="2208">2208</a>, <a href="2529">2529</a>.</li>
<li>Changed the following issue to Tentatively Resolved (from Open): <a href="2179">2179</a>.</li>
<li>Changed the following issue to Tentatively Resolved (from LEWG): <a href="2391">2391</a>.</li>
</ul></li>
</ul>
</li>
<li>R97: 
2016-03-22 2016 post-Jacksonville mailing
<ul>
<li><b>Summary:</b><ul>
<li>268 open issues, down by 37.</li>
<li>1922 closed issues, up by 40.</li>
<li>2190 issues total, up by 3.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 3 New issues: <a href="2592">2592</a>, <a href="2593">2593</a>, <a href="2594">2594</a>.</li>
<li>Changed the following 7 issues to Ready (from Review): <a href="2181">2181</a>, <a href="2309">2309</a>, <a href="2310">2310</a>, <a href="2328">2328</a>, <a href="2393">2393</a>, <a href="2441">2441</a>, <a href="2516">2516</a>.</li>
<li>Changed the following 11 issues to Ready (from New): <a href="2542">2542</a>, <a href="2549">2549</a>, <a href="2550">2550</a>, <a href="2551">2551</a>, <a href="2555">2555</a>, <a href="2573">2573</a>, <a href="2667">2667</a>, <a href="2669">2669</a>, <a href="2670">2670</a>, <a href="2671">2671</a>, <a href="2673">2673</a>.</li>
<li>Changed the following issue to Ready (from Open): <a href="2426">2426</a>.</li>
<li>Changed the following 2 issues to Ready (from LEWG): <a href="2436">2436</a>, <a href="2451">2451</a>.</li>
<li>Changed the following issue to Open (from Review): <a href="2424">2424</a>.</li>
<li>Changed the following issue to Open (from New): <a href="2368">2368</a>.</li>
<li>Changed the following 3 issues to WP (from Ready): <a href="2276">2276</a>, <a href="2523">2523</a>, <a href="2537">2537</a>.</li>
<li>Changed the following 25 issues to WP (from Tentatively Ready): <a href="2192">2192</a>, <a href="2450">2450</a>, <a href="2520">2520</a>, <a href="2522">2522</a>, <a href="2539">2539</a>, <a href="2545">2545</a>, <a href="2557">2557</a>, <a href="2558">2558</a>, <a href="2559">2559</a>, <a href="2560">2560</a>, <a href="2565">2565</a>, <a href="2566">2566</a>, <a href="2571">2571</a>, <a href="2572">2572</a>, <a href="2574">2574</a>, <a href="2575">2575</a>, <a href="2576">2576</a>, <a href="2577">2577</a>, <a href="2579">2579</a>, <a href="2581">2581</a>, <a href="2582">2582</a>, <a href="2583">2583</a>, <a href="2585">2585</a>, <a href="2586">2586</a>, <a href="2590">2590</a>.</li>
<li>Changed the following issue to WP (from Review): <a href="2296">2296</a>.</li>
<li>Changed the following issue to Resolved (from New): <a href="2554">2554</a>.</li>
<li>Changed the following issue to Resolved (from Open): <a href="2456">2456</a>.</li>
<li>Changed the following issue to NAD Editorial (from New): <a href="2666">2666</a>.</li>
<li>Changed the following issue to NAD (from Review): <a href="2402">2402</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2553">2553</a>.</li>
<li>Changed the following issue to NAD (from LEWG): <a href="2372">2372</a>.</li>
<li>Changed the following 2 issues to NAD Arrays (from Ready): <a href="2253">2253</a>, <a href="2255">2255</a>.</li>
<li>Changed the following 3 issues to NAD Arrays (from Open): <a href="2254">2254</a>, <a href="2264">2264</a>, <a href="2277">2277</a>.</li>
</ul></li>
</ul>
</li>
<li>R96: 
2016-02-12 2016 pre-Jacksonville mailing (includes the FS TS bugs for the first time)
<ul>
<li><b>Summary:</b><ul>
<li>305 open issues, up by 48.</li>
<li>1882 closed issues, up by 63.</li>
<li>2187 issues total, up by 111.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 19 Tentatively Ready issues: <a href="2557">2557</a>, <a href="2558">2558</a>, <a href="2559">2559</a>, <a href="2560">2560</a>, <a href="2565">2565</a>, <a href="2566">2566</a>, <a href="2571">2571</a>, <a href="2572">2572</a>, <a href="2574">2574</a>, <a href="2575">2575</a>, <a href="2576">2576</a>, <a href="2577">2577</a>, <a href="2579">2579</a>, <a href="2581">2581</a>, <a href="2582">2582</a>, <a href="2583">2583</a>, <a href="2585">2585</a>, <a href="2586">2586</a>, <a href="2590">2590</a>.</li>
<li>Added the following 30 New issues: <a href="2554">2554</a>, <a href="2555">2555</a>, <a href="2556">2556</a>, <a href="2561">2561</a>, <a href="2562">2562</a>, <a href="2563">2563</a>, <a href="2564">2564</a>, <a href="2567">2567</a>, <a href="2568">2568</a>, <a href="2569">2569</a>, <a href="2570">2570</a>, <a href="2573">2573</a>, <a href="2578">2578</a>, <a href="2584">2584</a>, <a href="2587">2587</a>, <a href="2588">2588</a>, <a href="2589">2589</a>, <a href="2591">2591</a>, <a href="2663">2663</a>, <a href="2664">2664</a>, <a href="2665">2665</a>, <a href="2666">2666</a>, <a href="2667">2667</a>, <a href="2668">2668</a>, <a href="2669">2669</a>, <a href="2670">2670</a>, <a href="2671">2671</a>, <a href="2672">2672</a>, <a href="2673">2673</a>, <a href="2674">2674</a>.</li>
<li>Added the following 3 NAD Future issues: <a href="2611">2611</a>, <a href="2612">2612</a>, <a href="2654">2654</a>.</li>
<li>Added the following 41 WP issues: <a href="2601">2601</a>, <a href="2602">2602</a>, <a href="2603">2603</a>, <a href="2605">2605</a>, <a href="2606">2606</a>, <a href="2607">2607</a>, <a href="2608">2608</a>, <a href="2609">2609</a>, <a href="2614">2614</a>, <a href="2615">2615</a>, <a href="2616">2616</a>, <a href="2618">2618</a>, <a href="2619">2619</a>, <a href="2621">2621</a>, <a href="2622">2622</a>, <a href="2624">2624</a>, <a href="2625">2625</a>, <a href="2627">2627</a>, <a href="2629">2629</a>, <a href="2632">2632</a>, <a href="2633">2633</a>, <a href="2634">2634</a>, <a href="2635">2635</a>, <a href="2636">2636</a>, <a href="2637">2637</a>, <a href="2640">2640</a>, <a href="2641">2641</a>, <a href="2644">2644</a>, <a href="2645">2645</a>, <a href="2647">2647</a>, <a href="2648">2648</a>, <a href="2649">2649</a>, <a href="2650">2650</a>, <a href="2652">2652</a>, <a href="2653">2653</a>, <a href="2655">2655</a>, <a href="2656">2656</a>, <a href="2657">2657</a>, <a href="2658">2658</a>, <a href="2660">2660</a>, <a href="2662">2662</a>.</li>
<li>Added the following 2 NAD Editorial issues: <a href="2639">2639</a>, <a href="2659">2659</a>.</li>
<li>Added the following 14 NAD issues: <a href="2580">2580</a>, <a href="2604">2604</a>, <a href="2610">2610</a>, <a href="2613">2613</a>, <a href="2617">2617</a>, <a href="2623">2623</a>, <a href="2626">2626</a>, <a href="2628">2628</a>, <a href="2630">2630</a>, <a href="2631">2631</a>, <a href="2638">2638</a>, <a href="2642">2642</a>, <a href="2646">2646</a>, <a href="2661">2661</a>.</li>
<li>Added the following 2 Dup issues: <a href="2643">2643</a>, <a href="2651">2651</a>.</li>
<li>Changed the following issue to Tentatively Ready (from New): <a href="2545">2545</a>.</li>
<li>Changed the following 2 issues to Review (from Open): <a href="2310">2310</a>, <a href="2516">2516</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2552">2552</a>.</li>
</ul></li>
</ul>
</li>
<li>R95: 
2015-11-15 2015 post-Kona mailing
<ul>
<li><b>Summary:</b><ul>
<li>257 open issues, down by 37.</li>
<li>1819 closed issues, up by 47.</li>
<li>2076 issues total, up by 10.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 10 New issues: <a href="2544">2544</a>, <a href="2545">2545</a>, <a href="2546">2546</a>, <a href="2547">2547</a>, <a href="2548">2548</a>, <a href="2549">2549</a>, <a href="2550">2550</a>, <a href="2551">2551</a>, <a href="2552">2552</a>, <a href="2553">2553</a>.</li>
<li>Changed the following 2 issues to Ready (from New): <a href="2523">2523</a>, <a href="2537">2537</a>.</li>
<li>Changed the following issue to Ready (from Open): <a href="2276">2276</a>.</li>
<li>Changed the following 3 issues to Tentatively Ready (from New): <a href="2520">2520</a>, <a href="2522">2522</a>, <a href="2539">2539</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from Open): <a href="2192">2192</a>, <a href="2450">2450</a>.</li>
<li>Changed the following issue to Review (from Ready): <a href="2181">2181</a>.</li>
<li>Changed the following 4 issues to Review (from Open): <a href="2309">2309</a>, <a href="2393">2393</a>, <a href="2402">2402</a>, <a href="2441">2441</a>.</li>
<li>Changed the following issue to Open (from Tentatively Ready): <a href="2510">2510</a>.</li>
<li>Changed the following 10 issues to Open (from New): <a href="2117">2117</a>, <a href="2164">2164</a>, <a href="2290">2290</a>, <a href="2468">2468</a>, <a href="2499">2499</a>, <a href="2505">2505</a>, <a href="2509">2509</a>, <a href="2516">2516</a>, <a href="2524">2524</a>, <a href="2543">2543</a>.</li>
<li>Changed the following issue to SG1 (from New): <a href="2533">2533</a>.</li>
<li>Changed the following 35 issues to WP (from Ready): <a href="1169">1169</a>, <a href="2072">2072</a>, <a href="2101">2101</a>, <a href="2111">2111</a>, <a href="2119">2119</a>, <a href="2127">2127</a>, <a href="2133">2133</a>, <a href="2156">2156</a>, <a href="2218">2218</a>, <a href="2219">2219</a>, <a href="2244">2244</a>, <a href="2250">2250</a>, <a href="2259">2259</a>, <a href="2336">2336</a>, <a href="2353">2353</a>, <a href="2367">2367</a>, <a href="2380">2380</a>, <a href="2384">2384</a>, <a href="2385">2385</a>, <a href="2435">2435</a>, <a href="2447">2447</a>, <a href="2462">2462</a>, <a href="2466">2466</a>, <a href="2469">2469</a>, <a href="2473">2473</a>, <a href="2476">2476</a>, <a href="2477">2477</a>, <a href="2483">2483</a>, <a href="2484">2484</a>, <a href="2485">2485</a>, <a href="2486">2486</a>, <a href="2487">2487</a>, <a href="2489">2489</a>, <a href="2492">2492</a>, <a href="2494">2494</a>.</li>
<li>Changed the following 8 issues to WP (from Tentatively Ready): <a href="2224">2224</a>, <a href="2234">2234</a>, <a href="2273">2273</a>, <a href="2495">2495</a>, <a href="2500">2500</a>, <a href="2515">2515</a>, <a href="2517">2517</a>, <a href="2526">2526</a>.</li>
<li>Changed the following issue to Resolved (from Core): <a href="2165">2165</a>.</li>
<li>Changed the following 2 issues to NAD (from New): <a href="2474">2474</a>, <a href="2538">2538</a>.</li>
<li>Changed the following issue to NAD (from Open): <a href="2379">2379</a>.</li>
<li>Changed the following issue to NAD (from Resolved): <a href="2319">2319</a>.</li>
</ul></li>
</ul>
</li>
<li>R94: 
2015-09-25 2015 pre-Kona mailing
<ul>
<li><b>Summary:</b><ul>
<li>294 open issues, up by 38.</li>
<li>1772 closed issues, up by 2.</li>
<li>2066 issues total, up by 40.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 4 Tentatively Ready issues: <a href="2510">2510</a>, <a href="2515">2515</a>, <a href="2517">2517</a>, <a href="2526">2526</a>.</li>
<li>Added the following 36 New issues: <a href="2504">2504</a>, <a href="2505">2505</a>, <a href="2506">2506</a>, <a href="2507">2507</a>, <a href="2508">2508</a>, <a href="2509">2509</a>, <a href="2511">2511</a>, <a href="2512">2512</a>, <a href="2513">2513</a>, <a href="2514">2514</a>, <a href="2516">2516</a>, <a href="2518">2518</a>, <a href="2519">2519</a>, <a href="2520">2520</a>, <a href="2521">2521</a>, <a href="2522">2522</a>, <a href="2523">2523</a>, <a href="2524">2524</a>, <a href="2525">2525</a>, <a href="2527">2527</a>, <a href="2528">2528</a>, <a href="2529">2529</a>, <a href="2530">2530</a>, <a href="2531">2531</a>, <a href="2532">2532</a>, <a href="2533">2533</a>, <a href="2534">2534</a>, <a href="2535">2535</a>, <a href="2536">2536</a>, <a href="2537">2537</a>, <a href="2538">2538</a>, <a href="2539">2539</a>, <a href="2540">2540</a>, <a href="2541">2541</a>, <a href="2542">2542</a>, <a href="2543">2543</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from New): <a href="2495">2495</a>, <a href="2500">2500</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from Open): <a href="2234">2234</a>, <a href="2273">2273</a>.</li>
<li>Changed the following issue to Resolved (from Open): <a href="2051">2051</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2326">2326</a>.</li>
</ul></li>
</ul>
</li>
<li>R93: 
2014-05-22 2015 post-Lenexa mailing
<ul>
<li><b>Summary:</b><ul>
<li>256 open issues, down by 36.</li>
<li>1770 closed issues, up by 48.</li>
<li>2026 issues total, up by 12.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 2 Ready issues: <a href="2492">2492</a>, <a href="2494">2494</a>.</li>
<li>Added the following 10 New issues: <a href="2493">2493</a>, <a href="2495">2495</a>, <a href="2496">2496</a>, <a href="2497">2497</a>, <a href="2498">2498</a>, <a href="2499">2499</a>, <a href="2500">2500</a>, <a href="2501">2501</a>, <a href="2502">2502</a>, <a href="2503">2503</a>.</li>
<li>Changed the following 2 issues to Ready (from Review): <a href="2111">2111</a>, <a href="2380">2380</a>.</li>
<li>Changed the following 20 issues to Ready (from New): <a href="2244">2244</a>, <a href="2250">2250</a>, <a href="2259">2259</a>, <a href="2336">2336</a>, <a href="2353">2353</a>, <a href="2367">2367</a>, <a href="2384">2384</a>, <a href="2385">2385</a>, <a href="2435">2435</a>, <a href="2462">2462</a>, <a href="2466">2466</a>, <a href="2473">2473</a>, <a href="2476">2476</a>, <a href="2477">2477</a>, <a href="2483">2483</a>, <a href="2484">2484</a>, <a href="2485">2485</a>, <a href="2486">2486</a>, <a href="2487">2487</a>, <a href="2489">2489</a>.</li>
<li>Changed the following 12 issues to Ready (from Open): <a href="1169">1169</a>, <a href="2072">2072</a>, <a href="2101">2101</a>, <a href="2119">2119</a>, <a href="2127">2127</a>, <a href="2133">2133</a>, <a href="2156">2156</a>, <a href="2181">2181</a>, <a href="2218">2218</a>, <a href="2219">2219</a>, <a href="2447">2447</a>, <a href="2469">2469</a>.</li>
<li>Changed the following issue to Tentatively Ready (from Open): <a href="2224">2224</a>.</li>
<li>Changed the following issue to Review (from New): <a href="2296">2296</a>.</li>
<li>Changed the following issue to Review (from Open): <a href="2328">2328</a>.</li>
<li>Changed the following 11 issues to Open (from New): <a href="2262">2262</a>, <a href="2289">2289</a>, <a href="2338">2338</a>, <a href="2348">2348</a>, <a href="2349">2349</a>, <a href="2370">2370</a>, <a href="2398">2398</a>, <a href="2402">2402</a>, <a href="2422">2422</a>, <a href="2450">2450</a>, <a href="2456">2456</a>.</li>
<li>Changed the following 8 issues to Open (from SG1): <a href="2245">2245</a>, <a href="2265">2265</a>, <a href="2276">2276</a>, <a href="2309">2309</a>, <a href="2363">2363</a>, <a href="2379">2379</a>, <a href="2426">2426</a>, <a href="2441">2441</a>.</li>
<li>Changed the following issue to LEWG (from New): <a href="2372">2372</a>.</li>
<li>Changed the following issue to EWG (from New): <a href="2432">2432</a>.</li>
<li>Changed the following issue to Deferred (from Open): <a href="2202">2202</a>.</li>
<li>Changed the following 14 issues to WP (from Ready): <a href="2160">2160</a>, <a href="2168">2168</a>, <a href="2364">2364</a>, <a href="2403">2403</a>, <a href="2406">2406</a>, <a href="2411">2411</a>, <a href="2425">2425</a>, <a href="2427">2427</a>, <a href="2428">2428</a>, <a href="2433">2433</a>, <a href="2434">2434</a>, <a href="2438">2438</a>, <a href="2439">2439</a>, <a href="2440">2440</a>.</li>
<li>Changed the following 18 issues to WP (from Tentatively Ready): <a href="2059">2059</a>, <a href="2076">2076</a>, <a href="2239">2239</a>, <a href="2369">2369</a>, <a href="2378">2378</a>, <a href="2410">2410</a>, <a href="2415">2415</a>, <a href="2418">2418</a>, <a href="2437">2437</a>, <a href="2448">2448</a>, <a href="2454">2454</a>, <a href="2455">2455</a>, <a href="2458">2458</a>, <a href="2459">2459</a>, <a href="2463">2463</a>, <a href="2467">2467</a>, <a href="2470">2470</a>, <a href="2482">2482</a>.</li>
<li>Changed the following 3 issues to WP (from New): <a href="2420">2420</a>, <a href="2464">2464</a>, <a href="2488">2488</a>.</li>
<li>Changed the following issue to WP (from Open): <a href="2063">2063</a>.</li>
<li>Changed the following 2 issues to WP (from SG1): <a href="2407">2407</a>, <a href="2442">2442</a>.</li>
<li>Changed the following issue to Resolved (from Review): <a href="2228">2228</a>.</li>
<li>Changed the following 3 issues to Resolved (from Open): <a href="1526">1526</a>, <a href="2274">2274</a>, <a href="2397">2397</a>.</li>
<li>Changed the following 5 issues to NAD (from New): <a href="2079">2079</a>, <a href="2251">2251</a>, <a href="2351">2351</a>, <a href="2373">2373</a>, <a href="2386">2386</a>.</li>
<li>Changed the following issue to NAD (from Open): <a href="2388">2388</a>.</li>
</ul></li>
</ul>
</li>
<li>R92: 
2015-04-09 pre-Lenexa mailing
<ul>
<li><b>Summary:</b><ul>
<li>292 open issues, up by 33.</li>
<li>1722 closed issues, up by 0.</li>
<li>2014 issues total, up by 33.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 5 Tentatively Ready issues: <a href="2459">2459</a>, <a href="2463">2463</a>, <a href="2467">2467</a>, <a href="2470">2470</a>, <a href="2482">2482</a>.</li>
<li>Added the following 27 New issues: <a href="2460">2460</a>, <a href="2461">2461</a>, <a href="2462">2462</a>, <a href="2464">2464</a>, <a href="2465">2465</a>, <a href="2466">2466</a>, <a href="2468">2468</a>, <a href="2471">2471</a>, <a href="2472">2472</a>, <a href="2473">2473</a>, <a href="2474">2474</a>, <a href="2475">2475</a>, <a href="2476">2476</a>, <a href="2477">2477</a>, <a href="2478">2478</a>, <a href="2479">2479</a>, <a href="2480">2480</a>, <a href="2481">2481</a>, <a href="2483">2483</a>, <a href="2484">2484</a>, <a href="2485">2485</a>, <a href="2486">2486</a>, <a href="2487">2487</a>, <a href="2488">2488</a>, <a href="2489">2489</a>, <a href="2490">2490</a>, <a href="2491">2491</a>.</li>
<li>Added the following Open issue: <a href="2469">2469</a>.</li>
<li>Changed the following issue to Tentatively Ready (from Review): <a href="2378">2378</a>.</li>
<li>Changed the following 11 issues to Tentatively Ready (from New): <a href="2076">2076</a>, <a href="2239">2239</a>, <a href="2369">2369</a>, <a href="2410">2410</a>, <a href="2415">2415</a>, <a href="2418">2418</a>, <a href="2437">2437</a>, <a href="2448">2448</a>, <a href="2454">2454</a>, <a href="2455">2455</a>, <a href="2458">2458</a>.</li>
<li>Changed the following issue to Tentatively Ready (from Open): <a href="2059">2059</a>.</li>
<li>Changed the following issue to Tentatively NAD (from New): <a href="2337">2337</a>.</li>
<li>Changed the following issue to Tentatively NAD (from Open): <a href="760">760</a>.</li>
<li>Changed the following 5 issues to Open (from New): <a href="2312">2312</a>, <a href="2388">2388</a>, <a href="2393">2393</a>, <a href="2444">2444</a>, <a href="2447">2447</a>.</li>
<li>Changed the following 4 issues to LEWG (from New): <a href="2391">2391</a>, <a href="2417">2417</a>, <a href="2436">2436</a>, <a href="2451">2451</a>.</li>
<li>Changed the following issue to EWG (from Open): <a href="2089">2089</a>.</li>
<li>Changed the following issue to Core (from New): <a href="2452">2452</a>.</li>
<li>Changed the following 13 issues to SG1 (from New): <a href="2236">2236</a>, <a href="2245">2245</a>, <a href="2265">2265</a>, <a href="2276">2276</a>, <a href="2309">2309</a>, <a href="2334">2334</a>, <a href="2363">2363</a>, <a href="2379">2379</a>, <a href="2407">2407</a>, <a href="2412">2412</a>, <a href="2426">2426</a>, <a href="2442">2442</a>, <a href="2445">2445</a>.</li>
<li>Changed the following issue to SG1 (from Open): <a href="2441">2441</a>.</li>
</ul></li>
</ul>
</li>
<li>R91: 
2014-11-23 post-Urbana mailing
<ul>
<li><b>Summary:</b><ul>
<li>259 open issues, up by 32.</li>
<li>1722 closed issues, down by 20.</li>
<li>1981 issues total, up by 12.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 12 New issues: <a href="2447">2447</a>, <a href="2448">2448</a>, <a href="2449">2449</a>, <a href="2450">2450</a>, <a href="2451">2451</a>, <a href="2452">2452</a>, <a href="2453">2453</a>, <a href="2454">2454</a>, <a href="2455">2455</a>, <a href="2456">2456</a>, <a href="2457">2457</a>, <a href="2458">2458</a>.</li>
<li>Changed the following 2 issues to Ready (from Review): <a href="2160">2160</a>, <a href="2364">2364</a>.</li>
<li>Changed the following 11 issues to Ready (from New): <a href="2403">2403</a>, <a href="2406">2406</a>, <a href="2411">2411</a>, <a href="2425">2425</a>, <a href="2427">2427</a>, <a href="2428">2428</a>, <a href="2433">2433</a>, <a href="2434">2434</a>, <a href="2438">2438</a>, <a href="2439">2439</a>, <a href="2440">2440</a>.</li>
<li>Changed the following issue to Ready (from Open): <a href="2168">2168</a>.</li>
<li>Changed the following issue to Review (from New): <a href="2424">2424</a>.</li>
<li>Changed the following 5 issues to Open (from New): <a href="2307">2307</a>, <a href="2310">2310</a>, <a href="2383">2383</a>, <a href="2414">2414</a>, <a href="2441">2441</a>.</li>
<li>Changed the following 2 issues to Open (from NAD Future): <a href="760">760</a>, <a href="1173">1173</a>.</li>
<li>Changed the following 4 issues to LEWG (from New): <a href="2419">2419</a>, <a href="2430">2430</a>, <a href="2443">2443</a>, <a href="2446">2446</a>.</li>
<li>Changed the following 48 issues to LEWG (from NAD Future): <a href="255">255</a>, <a href="423">423</a>, <a href="484">484</a>, <a href="523">523</a>, <a href="532">532</a>, <a href="708">708</a>, <a href="839">839</a>, <a href="851">851</a>, <a href="877">877</a>, <a href="933">933</a>, <a href="935">935</a>, <a href="936">936</a>, <a href="961">961</a>, <a href="1025">1025</a>, <a href="1031">1031</a>, <a href="1041">1041</a>, <a href="1052">1052</a>, <a href="1053">1053</a>, <a href="1112">1112</a>, <a href="1120">1120</a>, <a href="1121">1121</a>, <a href="1150">1150</a>, <a href="1154">1154</a>, <a href="1184">1184</a>, <a href="1188">1188</a>, <a href="1201">1201</a>, <a href="1203">1203</a>, <a href="1217">1217</a>, <a href="1235">1235</a>, <a href="1238">1238</a>, <a href="1242">1242</a>, <a href="1282">1282</a>, <a href="1289">1289</a>, <a href="1317">1317</a>, <a href="1320">1320</a>, <a href="1396">1396</a>, <a href="1406">1406</a>, <a href="1422">1422</a>, <a href="1459">1459</a>, <a href="1484">1484</a>, <a href="1488">1488</a>, <a href="1493">1493</a>, <a href="1499">1499</a>, <a href="1521">1521</a>, <a href="2040">2040</a>, <a href="2055">2055</a>, <a href="2226">2226</a>, <a href="2232">2232</a>.</li>
<li>Changed the following 2 issues to Pending NAD (from Tentatively NAD): <a href="2302">2302</a>, <a href="2382">2382</a>.</li>
<li>Changed the following 11 issues to WP (from Ready): <a href="2016">2016</a>, <a href="2170">2170</a>, <a href="2340">2340</a>, <a href="2354">2354</a>, <a href="2377">2377</a>, <a href="2396">2396</a>, <a href="2399">2399</a>, <a href="2400">2400</a>, <a href="2401">2401</a>, <a href="2404">2404</a>, <a href="2408">2408</a>.</li>
<li>Changed the following 12 issues to WP (from Tentatively Ready): <a href="2106">2106</a>, <a href="2129">2129</a>, <a href="2212">2212</a>, <a href="2217">2217</a>, <a href="2230">2230</a>, <a href="2233">2233</a>, <a href="2266">2266</a>, <a href="2325">2325</a>, <a href="2361">2361</a>, <a href="2365">2365</a>, <a href="2376">2376</a>, <a href="2387">2387</a>.</li>
<li>Changed the following issue to Resolved (from Ready): <a href="2319">2319</a>.</li>
<li>Changed the following issue to Resolved (from Review): <a href="2118">2118</a>.</li>
<li>Changed the following issue to Resolved (from New): <a href="2416">2416</a>.</li>
<li>Changed the following issue to Resolved (from Open): <a href="2108">2108</a>.</li>
<li>Changed the following issue to NAD (from New): <a href="2429">2429</a>.</li>
</ul></li>
</ul>
</li>
<li>R90: 
2014-10-13 pre-Urbana mailing
<ul>
<li><b>Summary:</b><ul>
<li>227 open issues, up by 31.</li>
<li>1742 closed issues, up by 0.</li>
<li>1969 issues total, up by 31.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 31 New issues: <a href="2416">2416</a>, <a href="2417">2417</a>, <a href="2418">2418</a>, <a href="2419">2419</a>, <a href="2420">2420</a>, <a href="2421">2421</a>, <a href="2422">2422</a>, <a href="2423">2423</a>, <a href="2424">2424</a>, <a href="2425">2425</a>, <a href="2426">2426</a>, <a href="2427">2427</a>, <a href="2428">2428</a>, <a href="2429">2429</a>, <a href="2430">2430</a>, <a href="2431">2431</a>, <a href="2432">2432</a>, <a href="2433">2433</a>, <a href="2434">2434</a>, <a href="2435">2435</a>, <a href="2436">2436</a>, <a href="2437">2437</a>, <a href="2438">2438</a>, <a href="2439">2439</a>, <a href="2440">2440</a>, <a href="2441">2441</a>, <a href="2442">2442</a>, <a href="2443">2443</a>, <a href="2444">2444</a>, <a href="2445">2445</a>, <a href="2446">2446</a>.</li>
<li>No issues changed.</li>
</ul></li>
</ul>
</li>
<li>R89: 
2014-07-08 post-Rapperswil mailing
<ul>
<li><b>Summary:</b><ul>
<li>196 open issues, up by 14.</li>
<li>1742 closed issues, up by 12.</li>
<li>1938 issues total, up by 26.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 6 Ready issues: <a href="2396">2396</a>, <a href="2399">2399</a>, <a href="2400">2400</a>, <a href="2401">2401</a>, <a href="2404">2404</a>, <a href="2408">2408</a>.</li>
<li>Added the following 15 New issues: <a href="2391">2391</a>, <a href="2392">2392</a>, <a href="2393">2393</a>, <a href="2394">2394</a>, <a href="2398">2398</a>, <a href="2402">2402</a>, <a href="2403">2403</a>, <a href="2406">2406</a>, <a href="2407">2407</a>, <a href="2410">2410</a>, <a href="2411">2411</a>, <a href="2412">2412</a>, <a href="2413">2413</a>, <a href="2414">2414</a>, <a href="2415">2415</a>.</li>
<li>Added the following Open issue: <a href="2397">2397</a>.</li>
<li>Added the following 3 WP issues: <a href="2390">2390</a>, <a href="2395">2395</a>, <a href="2409">2409</a>.</li>
<li>Added the following NAD issue: <a href="2405">2405</a>.</li>
<li>Changed the following issue to Ready (from New): <a href="2377">2377</a>.</li>
<li>Changed the following 2 issues to Ready (from Deferred): <a href="2253">2253</a>, <a href="2255">2255</a>.</li>
<li>Changed the following 2 issues to Tentatively Ready (from New): <a href="2325">2325</a>, <a href="2387">2387</a>.</li>
<li>Changed the following issue to Tentatively NAD (from New): <a href="2382">2382</a>.</li>
<li>Changed the following 3 issues to Review (from New): <a href="2364">2364</a>, <a href="2378">2378</a>, <a href="2380">2380</a>.</li>
<li>Changed the following 2 issues to Review (from Open): <a href="2118">2118</a>, <a href="2160">2160</a>.</li>
<li>Changed the following 3 issues to Open (from New): <a href="2168">2168</a>, <a href="2238">2238</a>, <a href="2273">2273</a>.</li>
<li>Changed the following 3 issues to Open (from Deferred): <a href="2254">2254</a>, <a href="2264">2264</a>, <a href="2277">2277</a>.</li>
<li>Changed the following 3 issues to WP (from New): <a href="2371">2371</a>, <a href="2374">2374</a>, <a href="2389">2389</a>.</li>
<li>Changed the following 4 issues to Resolved (from Deferred): <a href="2282">2282</a>, <a href="2283">2283</a>, <a href="2287">2287</a>, <a href="2333">2333</a>.</li>
<li>Changed the following issue to NAD (from Deferred): <a href="2305">2305</a>.</li>
</ul></li>
</ul>
</li>
<li>R88: 
2014-05-24 pre-Rapperswil mailing
<ul>
<li><b>Summary:</b><ul>
<li>182 open issues, up by 29.</li>
<li>1730 closed issues, up by 0.</li>
<li>1912 issues total, up by 29.</li>
</ul></li>
<li><b>Details:</b><ul>
<li>Added the following 3 Tentatively Ready issues: <a href="2361">2361</a>, <a href="2365">2365</a>, <a href="2376">2376</a>.</li>
<li>Added the following 26 New issues: <a href="2362">2362</a>, <a href="2363">2363</a>, <a href="2364">2364</a>, <a href="2366">2366</a>, <a href="2367">2367</a>, <a href="2368">2368</a>, <a href="2369">2369</a>, <a href="2370">2370</a>, <a href="2371">2371</a>, <a href="2372">2372</a>, <a href="2373">2373</a>, <a href="2374">2374</a>, <a href="2375">2375</a>, <a href="2377">2377</a>, <a href="2378">2378</a>, <a href="2379">2379</a>, <a href="2380">2380</a>, <a href="2381">2381</a>, <a href="2382">2382</a>, <a href="2383">2383</a>, <a href="2384">2384</a>, <a href="2385">2385</a>, <a href="2386">2386</a>, <a href="2387">2387</a>, <a href="2388">2388</a>, <a href="2389">2389</a>.</li>
<li>Changed the following 5 issues to Tentatively Ready (from Open): <a href="2106">2106</a>, <a href="2129">2129</a>, <a href="2212">2212</a>, <a href="2230">2230</a>, <a href="2233">2233</a>.</li>
</ul></li>
</ul>
</li>
</ul>

<h2><a name="Status"></a>Issue Status</h2>

  <p>Issues reported to the LWG transition through a variety of statuses,
  indicating their progress towards a resolution.  Typically, most issues
  will flow through the following stages.
  </p>

  <p><b><a name="New">New</a></b> - The issue has not yet been
  reviewed by the LWG. Any <b>Proposed Resolution</b> is purely a
  suggestion from the issue submitter, and should not be construed as
  the view of LWG.</p>

  <p><b><a name="Open">Open</a></b> - The LWG has discussed the issue
  but is not yet ready to move the issue forward. There are several
  possible reasons for open status:</p>
     <ul>
        <li>Consensus may have not yet have been reached as to how to deal
            with the issue.</li>
        <li>Informal consensus may have been reached, but the LWG awaits
            exact <b>Proposed Resolution</b> wording for review.</li>
        <li>The LWG wishes to consult additional technical experts before
            proceeding.</li>
        <li>The issue may require further study.</li>
     </ul>

  <p>A <b>Proposed Resolution</b> for an open issue is still not be
  construed as the view of LWG. Comments on the current state of
  discussions are often given at the end of open issues in an italic
  font. Such comments are for information only and should not be given
  undue importance.</p>

  <p><b><a name="Review">Review</a></b> - Exact wording of a
  <b>Proposed Resolution</b> is now available for review on an issue
  for which the LWG previously reached informal consensus.</p>

  <p><b><a name="Ready">Ready</a></b> - The LWG has reached consensus
  that the issue is a defect in the Standard, the <b>Proposed
  Resolution</b> is correct, and the issue is ready to forward to the
  full committee for further action as a Defect Report (DR).</p>

  <p>Typically, an issue must have a proposed resolution in the currently
  published issues list, whose wording does not change during LWG review, to
  move to the Ready status.</p>

  <p><b><a name="Voting">Voting</a></b> - This status should not be seen
  in a published issues list, but is a marker for use during meetings to
  indicate an issues was Ready in the pre-meeting mailing, the <b>Proposed
  Resolution</b> is correct, and the issue will be offered to the working
  group at the end of the current meeting to apply to the current working
  paper (WP) or to close in some other appropriate manner.  This easily
  distinguishes such issues from those moving to Ready status during the
  meeting itself, that should not be forwarded until the next meeting.  If
  the issue does not move forward, it should fall back to one of the other
  open states before the next list is published.</p>

  <p><b><a name="Immediate">Immediate</a></b> - This status should not be
  seen in a published issues list, but is a marker for use during meetings
  to indicate an issues was not Ready in the pre-meeting mailing, but the
  <b>Proposed Resolution</b> is correct, and the issue will be offered to
  the working group at the end of the current meeting to apply to the
  current working paper (WP) or to close in some other appropriate manner.
  This status is used only rarely, typically for fixes that are both small
  and obvious, and usually within a meeting of the expected publication of
  a revised standard.  If the issue does not move forward, it should fall
  back to one of the other open states before the next list is published.</p>

  <p>In addition, there are a few ways to categorise and issue that remains
  open to a resolution within the library, but is not actively being worked
  on.
  </p>

  <p><b><a name="Deferred">Deferred</a></b> - The LWG has discussed the issue,
  is not yet ready to move the issue forward, but neither does it deem the
  issue significant enough to delay publishing a standard or Technical Report.
  A typical deferred issue would be seeking to clarify wording that might be
  technically correct, but easily mis-read.</p>

  <p>A <b>Proposed Resolution</b> for a deferred issue is still not be
  construed as the view of LWG. Comments on the current state of
  discussions are often given at the end of open issues in an italic
  font. Such comments are for information only and should not be given
  undue importance.</p>

  <p><b><a name="Core">Core</a></b> - The LWG has discussed the issue, and feels
  that some key part of resolving the issue is better handled by a cleanup of
  the language in the Core part of the standard.  The issue is passed to the Core
  Working Group, which should ideally open a corresponding issue that can be
  linked from the library issue.  Such issues will be revisitted after Core have
  made (or declined to make) any changes.
  </p>

  <p><b><a name="EWG">EWG</a></b> - The LWG has discussed the issue, and wonder
  that some key part of resolving the issue is better handled by some (hopefully
  small) extension to the language.  The issue is passed to the Evolution Working
  Group, which should ideally open a corresponding issue that can be linked from
  the library issue.  Such issues will be revisitted after Evoltion have made (or
  declined to make) any recommendations.  Positive recommendations from EWG will
  often mean the issue transition to <i>Core</i> status while we wait for some
  proposed new feature to land in the working paper.
  </p>

  <p><b><a name="LEWG">LEWG</a></b> - The LWG has discussed the issue, and deemd
  the issue is either an extension, however small, or changes the library design
  in some fundamental way, and so has delegated the initial work to the Library
  Evolution Working Group.
  </p>

  <p>Ultimately, all issues should reach closure with one of the following statuses.
  </p>

  <p><b><a name="DR">DR</a></b> - (Defect Report) - The full WG21/PL22.16
  committee has voted to forward the issue to the Project Editor to be
  processed as a Potential Defect Report. The Project Editor reviews
  the issue, and then forwards it to the WG21 Convenor, who returns it
  to the full committee for final disposition. This issues list
  accords the status of DR to all these Defect Reports regardless of
  where they are in that process.</p>

  <p><b><a name="WP">WP</a></b> - (Working Paper) - The proposed resolution has not been
  accepted as a Technical Corrigendum, but the full WG21/PL22.16 committee has voted to
  apply the Defect Report's Proposed Resolution to the working paper.</p>

  <p><b><a name="C++17">C++17</a></b> - (C++ Standard, as revised for 2017) - The full
  WG21/PL22.16 committee has voted to accept the Defect Report's Proposed Resolution into
  the published 2017 revision to the C++ standard, ISO/IEC IS 14882:2017(E).</p>

  <p><b><a name="C++14">C++14</a></b> - (C++ Standard, as revised for 2014) - The full
  WG21/PL22.16 committee has voted to accept the Defect Report's Proposed Resolution into
  the published 2014 revision to the C++ standard, ISO/IEC IS 14882:2014(E).</p>

   <p><b><a name="C++11">C++11</a></b> - (C++ Standard, as revised for 2011) - The full
  WG21/PL22.16 committee has voted to accept the Defect Report's Proposed Resolution into
  the published 2011 revision to the C++ standard, ISO/IEC IS 14882:2011(E).</p>

   <p><b><a name="CD1">CD1</a></b> - (Committee Draft 2008) - The full
  WG21/PL22.16 committee has voted to accept the Defect Report's Proposed
  Resolution into the Fall 2008 Committee Draft.</p>

  <p><b><a name="TC1">TC1</a></b> - (Technical Corrigenda 1) - The full
  WG21/PL22.16 committee has voted to accept the Defect Report's Proposed
  Resolution as a Technical Corrigenda.  Action on this issue is thus
  complete and no further action is possible under ISO rules.</p>

  <p><b><a name="TRDec">TRDec</a></b> - (Decimal TR defect) - The LWG has voted to
  accept the Defect Report's Proposed Resolution into the Decimal TR.  Action on this
  issue is thus complete and no further action is expected.</p>

  <p><b><a name="TS">TS</a></b> - (TS - various) - The full
  WG21/PL22.16 committee has voted to accept the Defect Report's Proposed
  Resolution into a published Technical Specification.</p>

  <p><b><a name="Resolved">Resolved</a></b> - The LWG has reached consensus
  that the issue is a defect in the Standard, but the resolution adopted to
  resolve the issue came via some other mechanism than this issue in the
  list - typically by applying a formal paper, occasionally as a side effect
  of consolidating several interacting issue resolutions into a single issue.</p>

  <p><b><a name="Dup">Dup</a></b> - The LWG has reached consensus that
  the issue is a duplicate of another issue, and will not be further
  dealt with. A <b>Rationale</b> identifies the duplicated issue's
  issue number.</p>

  <p><b><a name="NAD">NAD</a></b> - The LWG has reached consensus that
  the issue is not a defect in the Standard.</p>

  <p><b><a name="NAD Editorial">NAD Editorial</a></b> - The LWG has reached consensus that
  the issue can either be handled editorially, or is handled by a paper (usually
  linked to in the rationale).</p>

  <p><b>Tentatively</b> - This is a <i>status qualifier</i>.  The issue has
  been reviewed online, or at an unofficial meeting, but not in an official meeting, and
  some support has been formed for the qualified status.  Tentatively qualified issues may
  be moved to the unqualified status and forwarded to full committee (if Ready) within the
  same meeting.  Unlike Ready issues, Tentatively Ready issues will be reviewed in
  subcommittee prior to forwarding to full committee.  When a status is qualified with
  Tentatively, the issue is still considered active.</p>

  <p><b>Pending</b> - This is a <i>status qualifier</i>.  When prepended to a status this
  indicates the issue has been processed by the committee, and a decision has been made to
  move the issue to the associated unqualified status.  However for logistical reasons the
  indicated outcome of the issue has not yet appeared in the latest working paper.</p>

  <p>The following statuses have been retired, but may show up on older issues lists.</p>

  <p><b><a name="NAD Future">NAD Future</a></b> - In addition to the regular status, the
  LWG believes that this issue should be revisited at the next revision of the standard.
  That is now an ongoing task managed by the Library Evolution Working Group, and most
  issues in this status were reopended with the status <a href="#NAD Editorial">LEWG</a>.
  </p>

  <p><b><a name="NAD Concepts">NAD Concepts</a></b> - This status reflects an evolution
  of the language during the development of C++11, where a new feature entered the
  language, called <i>concepts</i>, that fundamentally changed the way templates would
  be specified and written.  While this language feature was removed towards the end of
  the C++11 project, there is a clear intent to revisit this part of the language design.
  During that development, a number of issues were opened against the updated library
  related to use of that feature, or requesting fixes that would require explicit use of
  the concepts feature.  All such issues have been closed with this status, and may be
  revisitted should this or a similar language feature return for a future standard.</p>

  <p><b><a name="NAD Arrays">NAD Arrays</a></b> - This status reflects an evolution
  of the language during the development of C++14/17, where work on a Technical
  Specification, called the <i>Arrays TS</i> was begun. In early 2016, this work was
  abandoned, and the work item was officially withdrawn.  During development of the TS,
  a number of issues were opened the features in the TS. All such issues have been closed
  with this status, and may be revisitted should this or a similar language feature
  return for a future standard.</p>

  <p>Issues are always given the status of <a href="lwg-active.html#New">New</a> when
  they first appear on the issues list. They may progress to
  <a href="lwg-active.html#Open">Open</a> or <a href="lwg-active.html#Review">Review</a>
  while the LWG is actively working on them. When the LWG has reached consensus on
  the disposition of an issue, the status will then change to
  <a href="lwg-active.html#Dup">Dup</a>, <a href="lwg-active.html#NAD">NAD</a>, or
  <a href="lwg-active.html#Ready">Ready</a> as appropriate.  Once the full PL22.16 committee
  votes to forward Ready issues to the Project Editor, they are given the status of Defect
  Report (<a href="lwg-active.html#DR">DR</a>). These in turn may become the basis for
  Technical Corrigenda (<a href="lwg-active.html#TC1">TC1</a>), an updated standard
  (<a href="lwg-defects.html#C++11">C++11</a>, <a href="lwg-defects.html#C++14">C++14</a>),
  or are closed without action other than a Record of Response
  (<a href="lwg-active.html#Resolved">Resolved</a>) where the desired effect has already
  been achieved by some other process.  The intent of this LWG process is that only issues
  which are truly defects in the Standard move to the formal ISO DR status.
  </p>


<h2>Active Issues</h2>
<hr>
<h3><a name="423" href="423">423.</a> Effects of negative <tt>streamsize</tt> in iostreams</h3>
<p><b>Section:</b> 29 <a href="https://timsong-cpp.github.io/cppwp/input.output">[input.output]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Martin Sebor <b>Opened:</b> 2003-09-18 <b>Last modified:</b> 2018-12-09 12:44:26 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#input.output">issues</a> in [input.output].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
A third party test suite tries to exercise <tt>istream::ignore(N)</tt> with a negative value of 
<tt>N</tt> and expects that the implementation will treat <tt>N</tt> as if it were <tt>0</tt>. Our 
implementation asserts that (<tt>N &gt;= 0</tt>) holds and aborts the test.
</p>

<p>
I can't find anything in section 27 that prohibits such values but I don't
see what the effects of such calls should be, either (this applies to
a number of unformatted input functions as well as some member functions
of the <tt>basic_streambuf</tt> template).
</p>

<p><i>[
2009-07 Frankfurt
]</i></p>


<blockquote>
<p>
This is related to LWG <a href="255">255</a>.
</p>
<p>
Move to NAD Future.
</p>
</blockquote>

<p><i>[LEWG Kona 2017]</i></p>

<p>Recommend Open: We agree that we should require <tt>N &gt;= 0</tt> for the selected functions</p>

<p><i>[2018-12-04 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
I propose that we add to each function in clause 27 that takes an argument, say <tt>N</tt>, of type 
<tt>streamsize</tt> a <i>Requires</i> clause saying that "<tt>N &gt;= 0</tt>." The intent is to allow 
negative streamsize values in calls to <tt>precision()</tt> and <tt>width()</tt> but disallow it in 
calls to <tt>streambuf::sgetn()</tt>, <tt>istream::ignore()</tt>, or <tt>ostream::write()</tt>.
</p>

<p><i>[Kona: The LWG agreed that this is probably what we want. However, we
  need a review to find all places where functions in clause 27 take
  arguments of type <tt>streamsize</tt> that shouldn't be allowed to go
  negative. Martin will do that review.]</i></p>






<hr>
<h3><a name="484" href="484">484.</a> Convertible to <tt>T</tt></h3>
<p><b>Section:</b> 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Chris Jefferson <b>Opened:</b> 2004-09-16 <b>Last modified:</b> 2018-01-27 03:09:29 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#input.iterators">active issues</a> in [input.iterators].</p>
<p><b>View all other</b> <a href="lwg-index.html#input.iterators">issues</a> in [input.iterators].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>From comp.std.c++:</p>

<p>
I note that given an input iterator a for type <tt>T</tt>, 
then <tt>*a</tt> only has to be "convertable to <tt>T</tt>", 
not actually of type <tt>T</tt>.
</p>

<p>Firstly, I can't seem to find an exact definition of "convertable to <tt>T</tt>". 
While I assume it is the obvious definition (an implicit conversion), I 
can't find an exact definition. Is there one?</p>

<p>Slightly more worryingly, there doesn't seem to be any restriction on 
the this type, other than it is "convertable to <tt>T</tt>". Consider two input 
iterators <tt>a</tt> and <tt>b</tt>. I would personally assume that most people would 
expect <tt>*a==*b</tt> would perform <tt>T(*a)==T(*b)</tt>, however it doesn't seem that 
the standard requires that, and that whatever type <tt>*a</tt> is (call it <tt>U</tt>) 
could have == defined on it with totally different symantics and still 
be a valid inputer iterator.</p>

<p>Is this a correct reading? When using input iterators should I write 
<tt>T(*a)</tt> all over the place to be sure that the object I'm using is the 
class I expect?</p>

<p>This is especially a nuisance for operations that are defined to be
  "convertible to <tt>bool</tt>".  (This is probably allowed so that
  implementations could return say an <tt>int</tt> and avoid an unnessary
  conversion. However all implementations I have seen simply return a
  <tt>bool</tt> anyway.  Typical implemtations of STL algorithms just write
  things like <tt>while(a!=b &amp;&amp; *a!=0)</tt>.  But strictly
  speaking, there are lots of types that are convertible to <tt>T</tt> but
  that also overload the appropriate operators so this doesn't behave
  as expected.</p>

<p>If we want to make code like this legal (which most people seem to
  expect), then we'll need to tighten up what we mean by "convertible
  to <tt>T</tt>".</p>

<p><i>[Lillehammer: The first part is NAD, since "convertible" is
 well-defined in core. The second part is basically about pathological
 overloads. It's a minor problem but a real one. So leave open for
 now, hope we solve it as part of iterator redesign.]</i></p>


<p><i>[
2009-07-28 Reopened by Alisdair. No longer solved by concepts.
]</i></p>


<p><i>[
2009-10 Santa Cruz:
]</i></p>


<blockquote><p>
Mark as NAD Future. We agree there's an issue, but there is no
proposed solution at this time and this will be solved by concepts in
the future.
</p></blockquote>

<p><i>[2017-02 in Kona, LEWG recommends NAD]</i></p>

<p>Has been clarified by 14. By design. Ranges might make it go away. 
Current wording for input iterators is more constrained.</p>

<p><i>[2017-06-02 Issues Telecon]</i></p>

<p>Move to Open. This is very similar to <a href="2962">2962</a>, possibly a duplicate.</p>
<p>Marshall to research</p>

<p><i>[2017-07 Toronto Thurs Issue Prioritization]</i></p>

<p>Priority 2; same as <a href="2962">2962</a>.</p>


<p><b>Proposed resolution:</b></p>


<p><b>Rationale:</b></p>
<p><i>[
San Francisco:
]</i></p>


<blockquote><p>
Solved by
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2758.pdf">N2758</a>.
</p></blockquote>





<hr>
<h3><a name="523" href="523">523.</a> regex case-insensitive character ranges are unimplementable as specified</h3>
<p><b>Section:</b> 30 <a href="https://timsong-cpp.github.io/cppwp/re">[re]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2005-07-01 <b>Last modified:</b> 2018-06-24 10:53:02 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re">active issues</a> in [re].</p>
<p><b>View all other</b> <a href="lwg-index.html#re">issues</a> in [re].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
A problem with TR1 regex is currently being discussed on the Boost 
developers list. It involves the handling of case-insensitive matching 
of character ranges such as [Z-a]. The proper behavior (according to the 
ECMAScript standard) is unimplementable given the current specification 
of the TR1 <tt>regex_traits&lt;&gt;</tt> class template. John Maddock, the author of 
the TR1 regex proposal, agrees there is a problem. The full discussion 
can be found at http://lists.boost.org/boost/2005/06/28850.php (first 
message copied below). We don't have any recommendations as yet.
</p>
<p>
-- Begin original message --
</p>
<p>
The situation of interest is described in the ECMAScript specification
(ECMA-262), section 15.10.2.15:
</p>
<p>
"Even if the pattern ignores case, the case of the two ends of a range
is significant in determining which characters belong to the range.
Thus, for example, the pattern /[E-F]/i matches only the letters E, F,
e, and f, while the pattern /[E-f]/i matches all upper and lower-case
ASCII letters as well as the symbols [, \, ], ^, _, and `."
</p>
<p>
A more interesting case is what should happen when doing a
case-insensitive match on a range such as [Z-a]. It should match z, Z,
a, A and the symbols [, \, ], ^, _, and `. This is not what happens with
Boost.Regex (it throws an exception from the regex constructor).
</p>
<p>
The tough pill to swallow is that, given the specification in TR1, I
don't think there is any effective way to handle this situation.
According to the spec, case-insensitivity is handled with
<tt>regex_traits&lt;&gt;::translate_nocase(CharT)</tt> &mdash; two characters are equivalent
if they compare equal after both are sent through the <tt>translate_nocase</tt>
function. But I don't see any way of using this translation function to
make character ranges case-insensitive. Consider the difficulty of
detecting whether "z" is in the range [Z-a]. Applying the transformation
to "z" has no effect (it is essentially <tt>std::tolower</tt>). And we're not
allowed to apply the transformation to the ends of the range, because as
ECMA-262 says, "the case of the two ends of a range is significant."
</p>
<p>
So AFAICT, TR1 regex is just broken, as is Boost.Regex. One possible fix
is to redefine translate_nocase to return a string_type containing all
the characters that should compare equal to the specified character. But
this function is hard to implement for Unicode, and it doesn't play nice
with the existing ctype facet. What a mess!
</p>
<p>
-- End original message --
</p>

<p><i>[
John Maddock adds:
]</i></p>


<p>
One small correction, I have since found that ICU's regex package does 
implement this correctly, using a similar mechanism to the current 
TR1.Regex.
</p>
<p>
Given an expression [c1-c2] that is compiled as case insensitive it:
</p>
<p>
Enumerates every character in the range c1 to c2 and converts it to it's 
case folded equivalent.  That case folded character is then used a key to a 
table of equivalence classes, and each member of the class is added to the 
list of possible matches supported by the character-class.  This second step 
isn't possible with our current traits class design, but isn't necessary if 
the input text is also converted to a case-folded equivalent on the fly.
</p>
<p>
ICU applies similar brute force mechanisms to character classes such as 
[[:lower:]] and [[:word:]], however these are at least cached, so the impact 
is less noticeable in this case.
</p>
<p>
Quick and dirty performance comparisons show that expressions such as 
"[X-\\x{fff0}]+" are indeed very slow to compile with ICU (about 200 times 
slower than a "normal" expression).  For an application that uses a lot of 
regexes this could have a noticeable performance impact.  ICU also has an 
advantage in that it knows the range of valid characters codes: code points 
outside that range are assumed not to require enumeration, as they can not 
be part of any equivalence class.  I presume that if we want the TR1.Regex 
to work with arbitrarily large character sets enumeration really does become 
impractical.
</p>
<p>
Finally note that Unicode has:
</p>
<p>
Three cases (upper, lower and title).
One to many, and many to one case transformations.
Character that have context sensitive case translations - for example an 
uppercase sigma has two different lowercase forms  - the form chosen depends 
on context(is it end of a word or not), a caseless match for an upper case 
sigma should match either of the lower case forms, which is why case folding 
is often approximated by tolower(toupper(c)).
</p>
<p>
Probably we need some way to enumerate character equivalence classes, 
including digraphs (either as a result or an input), and some way to tell 
whether the next character pair is a valid digraph in the current locale.
</p>
<p>
Hoping this doesn't make this even more complex that it was already,
</p>

<p><i>[
Portland: Alisdair: Detect as invalid, throw an exception.
Pete: Possible general problem with case insensitive ranges.
]</i></p>


<p><i>[
2009-07 Frankfurt
]</i></p>


<blockquote>
<p>
We agree that this is a problem, but we do not know the answer.
</p>
<p>
We are going to declare this NAD until existing practice leads us in some direction.
</p>
<p>
No objection to NAD Future.
</p>
<p>
Move to NAD Future.
</p>
</blockquote>

<p><i>[LEWG Kona 2017]</i></p>

<p>Recommend Open: Tim Shen proposes: forbid use of case-insensitive ranges with regex traits other than 
<tt>std::regex_traits&lt;{char, wchar_t, char16_t, char32_t}&gt;</tt> when regex_constants::collate is specified.</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="532" href="532">532.</a> Tuple comparison</h3>
<p><b>Section:</b> 20.5.8 <a href="https://timsong-cpp.github.io/cppwp/tuple.rel">[tuple.rel]</a>, 99 [tr.tuple.rel] <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> David Abrahams <b>Opened:</b> 2005-11-29 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#tuple.rel">active issues</a> in [tuple.rel].</p>
<p><b>View all other</b> <a href="lwg-index.html#tuple.rel">issues</a> in [tuple.rel].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Duplicate of:</b> <a href="348">348</a></p>
<p><b>Discussion:</b></p>
<p>
Where possible, <tt>tuple</tt> comparison operators &lt;,&lt;=,=&gt;, and &gt; ought to be
defined in terms of <tt>std::less</tt> rather than <tt>operator&lt;</tt>, in order to
support comparison of tuples of pointers.  
</p>

<p><i>[
2009-07-28 Reopened by Alisdair.  No longer solved by concepts.
]</i></p>


<p><i>[
2009-10 Santa Cruz:
]</i></p>


<blockquote>
<p>
If we solve this for <tt>tuple</tt> we would have to solve it for <tt>pair</tt>
algorithms, etc.  It is too late to do that at this time.  Move to NAD Future.
</p>
</blockquote>



<p><b>Proposed resolution:</b></p>
<p>
change 6.1.3.5/5 from:
</p>

<blockquote><p>
  Returns: The result of a lexicographical comparison between t and
  u. The result is defined as: (bool)(get&lt;0&gt;(t) &lt; get&lt;0&gt;(u)) ||
  (!(bool)(get&lt;0&gt;(u) &lt; get&lt;0&gt;(t)) &amp;&amp; ttail &lt; utail), where rtail for
  some tuple r is a tuple containing all but the first element of
  r. For any two zero-length tuples e and f, e &lt; f returns false.
</p></blockquote>

<p>
to:
</p>

<blockquote>
<p>
  Returns: The result of a lexicographical comparison between t and
  u. For any two zero-length tuples e and f, e &lt; f returns false.
  Otherwise, the result is defined as: cmp( get&lt;0&gt;(t), get&lt;0&gt;(u)) ||
  (!cmp(get&lt;0&gt;(u), get&lt;0&gt;(t)) &amp;&amp; ttail &lt; utail), where rtail for some
  tuple r is a tuple containing all but the first element of r, and
  cmp(x,y) is an unspecified function template defined as follows.
</p>
<p>
  Where T is the type of x and U is the type of y:
</p>

<p>
     if T and U are pointer types and T is convertible to U, returns
     less&lt;U&gt;()(x,y)
</p>

<p>
     otherwise, if T and U are pointer types, returns less&lt;T&gt;()(x,y)
</p>

<p>
     otherwise, returns (bool)(x &lt; y)
</p>
</blockquote>

<p><i>[
Berlin: This issue is much bigger than just tuple (pair, containers,
algorithms). Dietmar will survey and work up proposed wording.
]</i></p>




<p><b>Rationale:</b></p>
<p>
Recommend NAD.  This will be fixed with the next revision of concepts.
</p>

<p><i>[
San Francisco:
]</i></p>


<blockquote><p>
Solved by
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2770.pdf">N2770</a>.
</p></blockquote>





<hr>
<h3><a name="936" href="936">936.</a> Mutex type overspecified</h3>
<p><b>Section:</b> 32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Pete Becker <b>Opened:</b> 2008-12-05 <b>Last modified:</b> 2017-03-01 18:09:34 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#thread.mutex.requirements">active issues</a> in [thread.mutex.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#thread.mutex.requirements">issues</a> in [thread.mutex.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Duplicate of:</b> <a href="961">961</a></p>
<p><b>Discussion:</b></p>



<p>
32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> describes the requirements for a type to be
a "Mutex type". A Mutex type can be used as the template argument for
the <tt>Lock</tt> type that's passed to <tt>condition_variable_any::wait</tt> (although
<tt>Lock</tt> seems like the wrong name here, since <tt>Lock</tt> is given a different
formal meaning in 32.5.4 <a href="https://timsong-cpp.github.io/cppwp/thread.lock">[thread.lock]</a>) and, although the WD doesn't quite say
so, as the template argument for <tt>lock_guard</tt> and <tt>unique_lock</tt>.
</p>

<p>
The requirements for a Mutex type include:
</p>

<ul>
<li>
<tt>m.lock()</tt> shall be well-formed and have [described] semantics, including a return type of <tt>void</tt>.
</li>
<li>
<tt>m.try_lock()</tt> shall be well-formed and have [described] semantics, including a return type of <tt>bool</tt>.
</li>
<li>
<tt>m.unlock()</tt> shall be well-formed and have [described] semantics, including a return type of <tt>void</tt>.
</li>
</ul>

<p>
Also, a Mutex type "shall not be copyable nor movable".
</p>

<p>
The latter requirement seems completely irrelevant, and the three
requirements on return types are tighter than they need to be. For
example, there's no reason that <tt>lock_guard</tt> can't be instantiated with a
type that's copyable. The rule is, in fact, that <tt>lock_guard</tt>, etc. won't
try to copy objects of that type. That's a constraint on locks, not on
mutexes. Similarly, the requirements for <tt>void</tt> return types are
unnecessary; the rule is, in fact, that <tt>lock_guard</tt>, etc. won't use any
returned value. And with the return type of <tt>bool</tt>, the requirement should
be that the return type is convertible to <tt>bool</tt>.
</p>

<p><i>[
Summit:
]</i></p>


<blockquote>
<p>
Move to open. Related to conceptualization and should probably be tackled as part of that.
</p>
<ul>
<li>
The intention is not only to place a constraint on what types such as
<tt>lock_guard</tt> may do with mutex types, but on what any code, including user
code, may do with mutex types. Thus the constraints as they are apply to
the mutex types themselves, not the current users of mutex types in the
standard.
</li>
<li>
This is a low priority issue; the wording as it is may be overly
restrictive but this may not be a real issue.
</li>
</ul>
</blockquote>

<p><i>[
Post Summit Anthony adds:
]</i></p>


<blockquote>
<p>
Section 32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> conflates the
requirements on a generic Mutex type (including user-supplied mutexes)
with the requirements placed on the standard-supplied mutex types in an
attempt to group everything together and save space.
</p>
<p>
When applying concepts to chapter 30, I suggest that the concepts
<tt>Lockable</tt> and <tt>TimedLockable</tt> embody the requirements for
*use* of a mutex type as required by
<tt>unique_lock/lock_guard/condition_variable_any</tt>. These should be
relaxed as Pete describes in the issue. The existing words in 32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> are requirements on all of
<tt>std::mutex</tt>, <tt>std::timed_mutex</tt>,
<tt>std::recursive_mutex</tt> and <tt>std::recursive_timed_mutex</tt>,
and should be rephrased as such.
</p>
</blockquote>

<p><i>[2017-03-01, Kona]</i></p>

<p>
SG1: Agreement that we need a paper.
</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="961" href="961">961.</a> Various threading bugs #11</h3>
<p><b>Section:</b> 32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Pete Becker <b>Opened:</b> 2009-01-07 <b>Last modified:</b> 2017-03-01 18:09:34 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#thread.mutex.requirements">active issues</a> in [thread.mutex.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#thread.mutex.requirements">issues</a> in [thread.mutex.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Duplicate of:</b> <a href="936">936</a></p>
<p><b>Discussion:</b></p>
<p>
32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> describes required member
functions of mutex types, and requires that they throw exceptions under
certain circumstances. This is overspecified. User-defined types can
abort on such errors without affecting the operation of templates
supplied by standard-library.
</p>

<p><i>[
Summit:
]</i></p>

<blockquote><p>
Move to open. Related to conceptualization and should probably be
tackled as part of that.
</p></blockquote>

<p><i>[
2009-10 Santa Cruz:
]</i></p>


<blockquote>
<p>
Would be OK to leave it as is for time constraints, could loosen later.
</p>

<p>
Mark as NAD Future.
</p>
</blockquote>

<p><i>[2017-03-01, Kona]</i></p>

<p>
SG1: Agreement that we need a paper.
</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="1025" href="1025">1025.</a> The library should provide more specializations for <tt>std::hash</tt></h3>
<p><b>Section:</b> 20.14.18 <a href="https://timsong-cpp.github.io/cppwp/unord.hash">[unord.hash]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2009-03-11 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#unord.hash">issues</a> in [unord.hash].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>

<p><b>Addresses UK 208 [CD1]</b></p>

<p>
<tt>std::hash</tt> should be implemented for much more of the standard
library. In particular for <tt>pair</tt>, <tt>tuple</tt> and all the
standard containers.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1175" href="1175">1175.</a> <tt>unordered</tt> complexity</h3>
<p><b>Section:</b> 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Pablo Halpern <b>Opened:</b> 2009-07-17 <b>Last modified:</b> 2019-03-19 18:40:31 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#unord.req">active issues</a> in [unord.req].</p>
<p><b>View all other</b> <a href="lwg-index.html#unord.req">issues</a> in [unord.req].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
When I look at the <tt>unordered_*</tt> constructors, I think the complexity is poorly
described and does not follow the style of the rest of the standard.
</p>

<p>
The complexity for the default constructor is specified as constant.
Actually, it is proportional to <tt>n</tt>, but there are no invocations of
<tt>value_type</tt> constructors or other <tt>value_type</tt> operations.
</p>

<p>
For the iterator-based constructor the complexity should be:
</p>

<blockquote><p>
<i>Complexity:</i> exactly <tt>n</tt> calls to construct <tt>value_type</tt>
from <tt>InputIterator::value_type</tt> (where <tt>n = distance(f,l)</tt>).
The number of calls to <tt>key_equal::operator()</tt> is proportional to
<tt>n</tt> in the average case and <tt>n*n</tt> in the worst case.
</p></blockquote>

<p><i>[
2010 Rapperswil:
]</i></p>


<blockquote><p>
Concern that the current wording may require O(1) where that cannot be delivered.  We need to look at 
both the clause 23 requirements tables and the constructor description of each unordered container to be sure.
</p>
<p>
Howard suggests NAD Editorial as we updated the container requirement tables since this issue was written.
</p>
<p>
Daniel offers to look deeper, and hopefully produce wording addressing any outstanding concerns at the next meeting.
</p>
<p>
Move to Open.
</p>
</blockquote>

<p><i>[2011-02-26: Daniel provides wording]</i></p>


<p>I strongly suggest to clean-up the differences between requirement tables and individual
specifications. In the usual way, the most specific specifications wins, which is in this
case the wrong one. In regard to the concern expressed about missing <tt>DefaultConstructible</tt>
requirements of the value type I disagree: The function argument <tt>n</tt> is no size-control
parameter, but only some effective capacity parameter: No elements will be value-initialized
by these constructors. The necessary requirement for the value type, <tt>EmplaceConstructible</tt>
into <tt>*this</tt>, is already listed in Table 103 &mdash; Unordered associative container requirements.
Another part of the proposed resolution is the fact that there is an inconsistency of the
complexity counting when both a range <strong>and</strong> a bucket count is involved compared
to constructions where only bucket counts are provided: E.g. the construction <tt>X a(n);</tt>
has a complexity of <tt>n</tt> bucket allocations, but this part of the work is omitted for
<tt>X a(i, j, n);</tt>, even though it is considerable larger (in the average case) for 
<tt>n &#8811; distance(i, j)</tt>.
</p>

<p><i>[2011-03-24 Madrid meeting]</i></p>


<p>Move to deferred</p>

<p><i>[
2011 Bloomington
]</i></p>


<p>
The proposed wording looks good.  Move to Review.
</p>

<p><i>[2012, Kona]</i></p>

<p>
Fix up some presentation issues with the wording, combining the big-O expressions into single
expressions rather than the sum of two separate big-Os.
</p>
<p>
Strike "constant or linear", prefer "linear in the number of buckets".
This allows for number of buckets being larger than requested <tt>n</tt> as well.
</p>
<p>
Default <tt>n</tt> to "unspecified" rather than "implementation-defined".  It seems an un-necessary
burden asking vendors to document a quantity that is easily determined through the public API of
these classes.
</p>
<p>
Replace <tt>distance(f,l)</tt> with "number of elements in the range <tt>[f,l)</tt>"
</p>
<p>
Retain in Review with the updated wording
</p>

<p><i>[2012, Portland: Move to Open]</i></p>

<p>
The wording still does not call out Pablo's original concern, that the element constructor is called
no more than <tt>N</tt> times, and that the <tt>N</tt> squared term applies to moves during rehash.
</p>

<p>
Inconsistent use of O(n)+O(N) vs. O(n+N), with a preference for the former.
</p>

<p>
AJM to update wording with a reference to "no more than <tt>N</tt> element constructor calls".
</p>

<p>
Matt concerned that calling out the O(n) requirements is noise, and dangerous noise in suggesting a precision
we do not mean.  The cost of constructing a bucket is very different to constructing an element of user-supplied
type.
</p>

<p>
AJM notes that if there are multiple rehashes, the 'n' complexity is probably not linear.
</p>

<p>
Matt suggests back to Open, Pablo suggests potentially NAD if we keep revisitting without achieving a resolution.
</p>

<p>
Matt suggests complexity we are concerned with is the number of operations, such as constructing elements, moving
nodes, and comparing/hashing keys.  We are less concerned with constructing buckets, which are generally noise in
this bigger picture.
</p>

<p><i>[2015-01-29 Telecon]</i></p>

<p>
AM: essentially correct, but do we want to complicate the spec?
<p/>
HH: Pablo has given us permission to NAD it
<p/>
JM: when I look at the first change in the P/R I find it mildly disturbing that the existing wording says you have a 
constant time constructor with a single element even if your <tt>n</tt> is 10^6, so I think adding this change makes people 
aware there might be a large cost in initializing the hash table, even though it doesn't show up in user-visible constructions.
<p/>
HH: one way to avoid that problem is make the default ctor <tt>noexcept</tt>. Then the container isn't allowed to create 
an arbitrarily large hash table
<p/>
AM: but this is the constructor where the user provides <tt>n</tt>
<p/>
MC: happy with the changes, except I agree with the editorial recommendation to keep the two &#x1d4aa;s separate.
<p/>
JW: yes, the constant '<tt>k</tt>' is different in &#x1d4aa;(n) and &#x1d4aa;(N)
<p/>
GR: do we want to talk about buckets at all
<p/>
JM: yes, good to highlight that bucket construction might be a significant cost
<p/>
HH: suggest we take the suggestion to split &#x1d4aa;(n+N) to &#x1d4aa;(n)+&#x1d4aa;(N) and move to Tentatively Ready
<p/>
GR: 23.2.1p2 says all complexity requirements are stated solely in terms of the number of operations on the contained 
object, so we shouldn't be stating complexity in terms of the hash table initialization
<p/>
HH: channeling Pete, there's an implicit "unless otherwise specified" everywhere.
<p/>
VV: seem to be requesting modifications that render this not Tentatively Ready
<p/>
GR: I think it can't be T/R
<p/>
AM: make the editorial recommendation, consider fixing 23.2.1/3 to give us permission to state complexity in terms 
of bucket initialization
<p/>
HH: only set it to Review after we get new wording to review 
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
Update wording, revisit later.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<ol>
<li><p>Modify the following rows in Table 103 &mdash; Unordered associative container requirements to
add the explicit bucket allocation overhead of some constructions. As editorial recommendation it is 
suggested <em>not</em> to shorten the sum <tt>&#x1d4aa;(n) + &#x1d4aa;(<em>N</em>)</tt> to
<tt>&#x1d4aa;(n + <em>N</em>)</tt>, because two different work units are involved.</p>

<blockquote>
<table border="1">
<caption>Table 103 &mdash; Unordered associative container requirements (in addition to container)</caption>

<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="4" style="text-align:center;">&hellip;</td>
</tr>

<tr>
<td><tt>X(i, j, n, hf, eq)</tt><br/>
<tt>X a(i, j, n, hf, eq)</tt>
</td>
<td><tt>X</tt></td>
<td>&hellip;<br/>
<i>Effects</i>: Constructs an empty container with at least <tt>n</tt><br/>
buckets, using <tt>hf</tt> as the hash function and <tt>eq</tt> as the key<br/>
equality predicate, and inserts elements from <tt>[i, j)</tt> into it.
</td>
<td>Average case &#x1d4aa;(<tt><i><ins>n + </ins>N</i></tt>) (<tt><i>N</i></tt> is <tt>distance(i, j)</tt>),<br/>
worst case <ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>)</td>
</tr>

<tr>
<td><tt>X(i, j, n, hf)</tt><br/>
<tt>X a(i, j, n, hf)</tt>
</td>
<td><tt>X</tt></td>
<td>&hellip;<br/>
<i>Effects</i>: Constructs an empty container with at least <tt>n</tt><br/>
buckets, using <tt>hf</tt> as the hash function and <tt>key_equal()</tt> as the key<br/>
equality predicate, and inserts elements from <tt>[i, j)</tt> into it.
</td>
<td>Average case &#x1d4aa;(<tt><i><ins>n + </ins>N</i></tt>) (<tt><i>N</i></tt> is <tt>distance(i, j)</tt>),<br/>
worst case &#x1d4aa;(<tt><i><ins>n + </ins>N</i><sup>2</sup></tt>)</td>
</tr>

<tr>
<td><tt>X(i, j, n)</tt><br/>
<tt>X a(i, j, n)</tt>
</td>
<td><tt>X</tt></td>
<td>&hellip;<br/>
<i>Effects</i>: Constructs an empty container with at least <tt>n</tt><br/>
buckets, using <tt>hasher()</tt> as the hash function and <tt>key_equal()</tt> as the key<br/>
equality predicate, and inserts elements from <tt>[i, j)</tt> into it.
</td>
<td>Average case &#x1d4aa;(<tt><i><ins>n + </ins>N</i></tt>) (<tt><i>N</i></tt> is <tt>distance(i, j)</tt>),<br/>
worst case &#x1d4aa;(<tt><i><ins>n + </ins>N</i><sup>2</sup></tt>)</td>
</tr>

<tr>
<td colspan="4" style="text-align:center;">&hellip;</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Modify 22.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/unord.map.cnstr">[unord.map.cnstr]</a> p. 1-4 as indicated (The edits of p. 1 and p. 3 attempt to fix some
editorial oversight.):</p>

<blockquote><pre>
explicit unordered_map(size_type n = <i>see below</i>,
                       const hasher&amp; hf = hasher(),
                       const key_equal&amp; eql = key_equal(),
                       const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
1 <i>Effects</i>: Constructs an empty <tt>unordered_map</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_map</tt></del>. 
<tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
2 <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p></blockquote>
</blockquote>

<blockquote><pre>
template &lt;class InputIterator&gt;
unordered_map(InputIterator f, InputIterator l,
              size_type n = <i>see below</i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
3 <i>Effects</i>: Constructs an empty <tt>unordered_map</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_map</tt></del>.
Then inserts elements from the range <tt>[f, l)</tt>. <tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
4 <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets.
In the average case linear in <tt><i>N</i></tt> and in the worst case quadratic in <tt><i>N</i></tt> to insert
the elements, where <tt><i>N</i></tt> is equal to number of elements in the range <tt>[f,l)</tt></ins>.
</p></blockquote>
</blockquote>
</li>

<li><p>Modify 22.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.cnstr">[unord.multimap.cnstr]</a> p. 1-4 as indicated (The edits of p. 1 and p. 3 attempt to fix some
editorial oversight.):</p>

<blockquote><pre>
explicit unordered_multimap(size_type n = <i>see below</i>,
                            const hasher&amp; hf = hasher(),
                            const key_equal&amp; eql = key_equal(),
                            const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
1 <i>Effects</i>: Constructs an empty <tt>unordered_multimap</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_multimap</tt></del>. 
<tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
2 <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p></blockquote>
</blockquote>

<blockquote><pre>
template &lt;class InputIterator&gt;
unordered_multimap(InputIterator f, InputIterator l,
                   size_type n = <i>see below</i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
3 <i>Effects</i>: Constructs an empty <tt>unordered_multimap</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_multimap</tt></del>.
Then inserts elements from the range <tt>[f, l)</tt>. <tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
4 <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets.
In the average case linear in <tt><i>N</i></tt> and in the worst case quadratic in <tt><i>N</i></tt> to insert
the elements, where <tt><i>N</i></tt> is equal to number of elements in the range <tt>[f,l)</tt></ins>.
</p></blockquote>
</blockquote>
</li>

<li><p>Modify 22.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/unord.set.cnstr">[unord.set.cnstr]</a> p. 1-4 as indicated (The edits of p. 1 and p. 3 attempt to fix some
editorial oversight.):</p>

<blockquote><pre>
explicit unordered_set(size_type n = <i>see below</i>,
                       const hasher&amp; hf = hasher(),
                       const key_equal&amp; eql = key_equal(),
                       const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
1 <i>Effects</i>: Constructs an empty <tt>unordered_set</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_set</tt></del>. 
<tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
2 <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p></blockquote>
</blockquote>

<blockquote><pre>
template &lt;class InputIterator&gt;
unordered_set(InputIterator f, InputIterator l,
              size_type n = <i>see below</i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
3 <i>Effects</i>: Constructs an empty <tt>unordered_set</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_set</tt></del>.
Then inserts elements from the range <tt>[f, l)</tt>. <tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
4 <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets.
In the average case linear in <tt><i>N</i></tt> and in the worst case quadratic in <tt><i>N</i></tt> to insert
the elements, where <tt><i>N</i></tt> is equal to number of elements in the range <tt>[f,l)</tt></ins>.
</p></blockquote>
</blockquote>
</li>

<li><p>Modify 22.5.7.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.cnstr">[unord.multiset.cnstr]</a> p. 1-4 as indicated (The edits of p. 1 and p. 3 attempt to fix some
editorial oversight.):</p>

<blockquote><pre>
explicit unordered_multiset(size_type n = <i>see below</i>,
                            const hasher&amp; hf = hasher(),
                            const key_equal&amp; eql = key_equal(),
                            const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
1 <i>Effects</i>: Constructs an empty <tt>unordered_multiset</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_multiset</tt></del>. 
<tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
2 <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p></blockquote>
</blockquote>

<blockquote><pre>
template &lt;class InputIterator&gt;
unordered_multiset(InputIterator f, InputIterator l,
                   size_type n = <i>see below</i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());
</pre><blockquote><p>
3 <i>Effects</i>: Constructs an empty <tt>unordered_multiset</tt> using the specified hash function, key equality function,
and allocator, and using at least <tt>n</tt> buckets. If <tt>n</tt> is not provided, the number of buckets is 
<ins>unspecified</ins><del>impldefdefault number of buckets in <tt>unordered_multiset</tt></del>.
Then inserts elements from the range <tt>[f, l)</tt>. <tt>max_load_factor()</tt> returns <tt>1.0</tt>.
</p></blockquote>
<blockquote><p>
4 <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets.
In the average case linear in <tt><i>N</i></tt> and in the worst case quadratic in <tt><i>N</i></tt> to insert
the elements, where <tt><i>N</i></tt> is equal to number of elements in the range <tt>[f,l)</tt></ins>.
</p></blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-03-17; Daniel comments and provides revised wording]</i></p>

<p>
The updated wording ensures that we can now specify complexity requirements for containers even when they are <em>not</em>
expressed in terms of the number on the contained objects by an exception of the rule. This allows us to say that
<tt>&#x1d4aa;(n)</tt> describes the complexity in terms of bucket initialization instead.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> as indicated:</p>

<blockquote>
<p>
-2- <ins>Unless otherwise specified,</ins><del>All of the</del> complexity requirements in this Clause are stated 
solely in terms of the number of operations on the contained objects. [<i>Example:</i> The copy constructor of type 
<tt>vector&lt;vector&lt;int&gt;&gt;</tt> has linear complexity, even though the complexity of copying each contained 
<tt>vector&lt;int&gt;</tt> is itself linear. &mdash; <i>end example</i>]
</p>
</blockquote>
</li>

<li><p>Modify 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> as indicated:</p>

<blockquote>
<p>
-11- In Table 70:
<ol style="list-style-type: none">
<li><p>(11.1) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(11.23) &mdash; [&hellip;]</p></li>
<li><p><ins>(11.?) &mdash; Notwithstanding the complexity requirements restrictions of 
22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>, the complexity form <tt>&#x1d4aa;(n)</tt> describes 
the number of operations on buckets.</ins></p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify the following rows in Table 70 &mdash; "Unordered associative container requirements" to
add the explicit bucket allocation overhead of some constructions.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> It is kindly suggested to the Project Editor <em>not</em> to shorten the sum 
<tt>&#x1d4aa;(n) + &#x1d4aa;(<em>N</em>)</tt> to <tt>&#x1d4aa;(n + <em>N</em>)</tt>, because two 
different work units are involved. &mdash; <i>end drafting note</i>]
</p>
</blockquote>

<blockquote>
<table border="1">
<caption>Table 70 &mdash; Unordered associative container requirements (in addition to container)</caption>

<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="4" style="text-align:center;">&hellip;</td>
</tr>

<tr>
<td><tt>X()</tt><br/>
<tt>X a;</tt>
</td>
<td><tt>X</tt></td>
<td><i>Expects:</i> [&hellip;]<br/>
<i>Effects:</i> Constructs an empty container with an unspecified number <ins><tt>n</tt></ins> of<br/>
buckets, using <tt>hasher()</tt> as the hash function and <tt>key_equal()</tt> as the key<br/>
equality predicate.
</td>
<td><del>constant</del><ins>&#x1d4aa;(<tt>n</tt>)</ins></td>
</tr>

<tr>
<td><tt>X(i, j, n, hf, eq)</tt><br/>
<tt>X a(i, j, n, hf, eq)</tt>
</td>
<td><tt>X</tt></td>
<td><i>Expects:</i> [&hellip;]<br/>
<i>Effects</i>: Constructs an empty container with at least <tt>n</tt><br/>
buckets, using <tt>hf</tt> as the hash function and <tt>eq</tt> as the key<br/>
equality predicate, and inserts elements from <tt>[i, j)</tt> into it.
</td>
<td>Average case <ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i></tt>) (<tt><i>N</i></tt><br/> 
is <tt>distance(i, j)</tt>), worst case<br/>
<ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>)</td>
</tr>

<tr>
<td><tt>X(i, j, n, hf)</tt><br/>
<tt>X a(i, j, n, hf)</tt>
</td>
<td><tt>X</tt></td>
<td><i>Expects:</i> [&hellip;]<br/>
<i>Effects</i>: Constructs an empty container with at least <tt>n</tt><br/>
buckets, using <tt>hf</tt> as the hash function and <tt>key_equal()</tt> as the key<br/>
equality predicate, and inserts elements from <tt>[i, j)</tt> into it.
</td>
<td>Average case <ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i></tt>) (<tt><i>N</i></tt><br/> 
is <tt>distance(i, j)</tt>), worst case<br/> 
<ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>)</td>
</tr>

<tr>
<td><tt>X(i, j, n)</tt><br/>
<tt>X a(i, j, n)</tt>
</td>
<td><tt>X</tt></td>
<td><i>Expects:</i> [&hellip;]<br/>
<i>Effects</i>: Constructs an empty container with at least <tt>n</tt><br/>
buckets, using <tt>hasher()</tt> as the hash function and <tt>key_equal()</tt> as the key<br/>
equality predicate, and inserts elements from <tt>[i, j)</tt> into it.
</td>
<td>Average case <ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i></tt>) (<tt><i>N</i></tt><br/> 
is <tt>distance(i, j)</tt>), worst case<br/> 
<ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>)</td>
</tr>

<tr>
<td><tt>X(i, j)</tt><br/>
<tt>X a(i, j)</tt>
</td>
<td><tt>X</tt></td>
<td><i>Expects:</i> [&hellip;]<br/>
<i>Effects</i>: Constructs an empty container with an unspecified number <ins><tt>n</tt></ins> of<br/>
buckets, using <tt>hasher()</tt> as the hash function and <tt>key_equal()</tt> as the key<br/>
equality predicate, and inserts elements from <tt>[i, j)</tt> into it.
</td>
<td>Average case <ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i></tt>) (<tt><i>N</i></tt><br/> 
is <tt>distance(i, j)</tt>), worst case<br/> 
<ins>&#x1d4aa;(<tt>n</tt>) +</ins> &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>)</td>
</tr>

<tr>
<td colspan="4" style="text-align:center;">&hellip;</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify 22.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/unord.map.overview">[unord.map.overview]</a>, class template <tt>unordered_map</tt>, as indicated:</p>

<blockquote><pre>
<i>// 22.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/unord.map.cnstr">[unord.map.cnstr]</a>, construct/copy/destroy</i>
[&hellip;]
template &lt;class InputIterator&gt;
  unordered_map(InputIterator f, InputIterator l,
                size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                const hasher&amp; hf = hasher(),
                const key_equal&amp; eql = key_equal(),
                const allocator_type&amp; a = allocator_type());
[&hellip;]
unordered_map(initializer_list&lt;value_type&gt; il,
              size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());
[&hellip;]
</pre></blockquote>
</li>

<li><p>Modify 22.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/unord.map.cnstr">[unord.map.cnstr]</a> as indicated:</p>

<blockquote>
<pre>
unordered_map() : unordered_map(size_type(<i><del>see below</del><ins>unspecified</ins></i>)) { }
explicit unordered_map(size_type n,
                       const hasher&amp; hf = hasher(),
                       const key_equal&amp; eql = key_equal(),
                       const allocator_type&amp; a = allocator_type());
</pre><blockquote>
<p>
-1- <i>Effects</i>: Constructs an empty <tt>unordered_map</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>For the default constructor, the number of buckets is
implementation-defined.</del> <del><tt>max_load_factor()</tt> returns <tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-2- <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p>
</blockquote>
<pre>
template &lt;class InputIterator&gt;
unordered_map(InputIterator f, InputIterator l,
              size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());
unordered_map(initializer_list&lt;value_type&gt; il,
              size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());
</pre>
<blockquote>
<p>
-3- <i>Effects</i>: Constructs an empty <tt>unordered_map</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>If <tt>n</tt> is not provided, the number of buckets is 
implementation-defined.</del> Then inserts elements from the range <tt>[f, l)</tt> for 
the first form, or from the range <tt>[il.begin(), il.end())</tt> for the second form. <del><tt>max_load_factor()</tt> 
returns <tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-4- <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets, 
plus &#x1d4aa;(<tt><i>N</i></tt>) (average case) or &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>) (worst case) where 
<tt><i>N</i></tt> is the number of insertions</ins>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.5.5.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.overview">[unord.multimap.overview]</a>, class template <tt>unordered_multimap</tt>, as indicated:</p>

<blockquote><pre>
<i>// 22.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.cnstr">[unord.multimap.cnstr]</a>, construct/copy/destroy</i>
[&hellip;]
template &lt;class InputIterator&gt;
  unordered_multimap(InputIterator f, InputIterator l,
                     size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                     const hasher&amp; hf = hasher(),
                     const key_equal&amp; eql = key_equal(),
                     const allocator_type&amp; a = allocator_type());
[&hellip;]
unordered_multimap(initializer_list&lt;value_type&gt; il,
                   size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());
[&hellip;]
</pre></blockquote>
</li>

<li><p>Modify 22.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.cnstr">[unord.multimap.cnstr]</a> as indicated:</p>

<blockquote>
<pre>
unordered_multimap() : unordered_multimap(size_type(<i><del>see below</del><ins>unspecified</ins></i>)) { }
explicit unordered_multimap(size_type n,
                            const hasher&amp; hf = hasher(),
                            const key_equal&amp; eql = key_equal(),
                            const allocator_type&amp; a = allocator_type());
</pre>
<blockquote>
<p>
-1- <i>Effects</i>: Constructs an empty <tt>unordered_multimap</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>For the default constructor, the number of buckets is 
implementation-defined. <tt>max_load_factor()</tt> returns <tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-2- <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p>
</blockquote>
<pre>
template &lt;class InputIterator&gt;
unordered_multimap(InputIterator f, InputIterator l,
                   size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());
unordered_multimap(initializer_list&lt;value_type&gt; il,
                   size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());
</pre>
<blockquote>
<p>
-3- <i>Effects</i>: Constructs an empty <tt>unordered_multimap</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>If <tt>n</tt> is not provided, the number of buckets is 
implementation-defined.</del> Then inserts elements from the range <tt>[f, l)</tt> for the 
first form, or from the range <tt>[il.begin(), il.end())</tt> for the second form. <del><tt>max_load_factor()</tt> returns 
<tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-4- <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets, 
plus &#x1d4aa;(<tt><i>N</i></tt>) (average case) or &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>) (worst case) where 
<tt><i>N</i></tt> is the number of insertions</ins>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/unord.set.overview">[unord.set.overview]</a>, class template <tt>unordered_set</tt>, as indicated:</p>

<blockquote><pre>
<i>// 22.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/unord.set.cnstr">[unord.set.cnstr]</a>, construct/copy/destroy</i>
[&hellip;]
template &lt;class InputIterator&gt;
  unordered_set(InputIterator f, InputIterator l,
                size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                const hasher&amp; hf = hasher(),
                const key_equal&amp; eql = key_equal(),
                const allocator_type&amp; a = allocator_type());
[&hellip;]
unordered_set(initializer_list&lt;value_type&gt; il,
              size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());              
[&hellip;]
</pre></blockquote>
</li>

<li><p>Modify 22.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/unord.set.cnstr">[unord.set.cnstr]</a> as indicated:</p>

<blockquote>
<pre>
unordered_set() : unordered_set(size_type(<i><del>see below</del><ins>unspecified</ins></i>)) { }
explicit unordered_set(size_type n,
                       const hasher&amp; hf = hasher(),
                       const key_equal&amp; eql = key_equal(),
                       const allocator_type&amp; a = allocator_type());
</pre>
<blockquote>
<p>
-1- <i>Effects</i>: Constructs an empty <tt>unordered_set</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>For the default constructor, the number of buckets is 
implementation-defined.</del> <del><tt>max_load_factor()</tt> returns <tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-2- <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p>
</blockquote>
<pre>
template &lt;class InputIterator&gt;
unordered_set(InputIterator f, InputIterator l,
              size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());
unordered_set(initializer_list&lt;value_type&gt; il,
              size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
              const hasher&amp; hf = hasher(),
              const key_equal&amp; eql = key_equal(),
              const allocator_type&amp; a = allocator_type());              
</pre>
<blockquote>
<p>
-3- <i>Effects</i>: Constructs an empty <tt>unordered_set</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>If <tt>n</tt> is not provided, the number of buckets is 
implementation-defined.</del> Then inserts elements from the range <tt>[f, l)</tt> for the 
first form, or from the range <tt>[il.begin(), il.end())</tt> for the second form. <del><tt>max_load_factor()</tt> returns 
<tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-4- <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets, 
plus &#x1d4aa;(<tt><i>N</i></tt>) (average case) or &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>) (worst case) where 
<tt><i>N</i></tt> is the number of insertions</ins>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/unord.set.overview">[unord.set.overview]</a>, class template <tt>unordered_multiset</tt>, as indicated:</p>

<blockquote><pre>
<i>// 22.5.7.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.cnstr">[unord.multiset.cnstr]</a>, construct/copy/destroy</i>
[&hellip;]
template &lt;class InputIterator&gt;
  unordered_multiset(InputIterator f, InputIterator l,
                     size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                     const hasher&amp; hf = hasher(),
                     const key_equal&amp; eql = key_equal(),
                     const allocator_type&amp; a = allocator_type());
[&hellip;]
unordered_multiset(initializer_list&lt;value_type&gt; il,
                   size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());                   
[&hellip;]
</pre></blockquote>
</li>

<li><p>Modify 22.5.7.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.cnstr">[unord.multiset.cnstr]</a> as indicated:</p>

<blockquote>
<pre>
unordered_multiset() : unordered_multiset(size_type(<i><del>see below</del><ins>unspecified</ins></i>)) { }
explicit unordered_multiset(size_type n,
                            const hasher&amp; hf = hasher(),
                            const key_equal&amp; eql = key_equal(),
                            const allocator_type&amp; a = allocator_type());
</pre>
<blockquote>
<p>
-1- <i>Effects</i>: Constructs an empty <tt>unordered_multiset</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>For the default constructor, the number of buckets is 
implementation-defined.</del> <del><tt>max_load_factor()</tt> returns <tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-2- <i>Complexity</i>: <del>Constant</del><ins>Linear in the number of buckets</ins>.
</p>
</blockquote>
<pre>
template &lt;class InputIterator&gt;
unordered_multiset(InputIterator f, InputIterator l,
                   size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());
unordered_multiset(initializer_list&lt;value_type&gt; il,
                   size_type n = <i><del>see below</del><ins>unspecified</ins></i>,
                   const hasher&amp; hf = hasher(),
                   const key_equal&amp; eql = key_equal(),
                   const allocator_type&amp; a = allocator_type());                   
</pre>
<blockquote>
<p>
-3- <i>Effects</i>: Constructs an empty <tt>unordered_multiset</tt> using the specified hash function, key equality predicate,
and allocator, and using at least <tt>n</tt> buckets. <del>If <tt>n</tt> is not provided, the number of buckets is 
implementation-defined.</del> Then inserts elements from the range <tt>[f, l)</tt> for the 
first form, or from the range <tt>[il.begin(), il.end())</tt> for the second form. <del><tt>max_load_factor()</tt> returns 
<tt>1.0</tt>.</del>
<p/>
<ins>-?- <i>Ensures:</i> <tt>max_load_factor() == 1.0</tt></ins>
<p/>
-4- <i>Complexity</i>: <del>Average case linear, worst case quadratic</del><ins>Linear in the number of buckets, 
plus &#x1d4aa;(<tt><i>N</i></tt>) (average case) or &#x1d4aa;(<tt><i>N</i><sup>2</sup></tt>) (worst case) where 
<tt><i>N</i></tt> is the number of insertions</ins>.
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="1203" href="1203">1203.</a> More useful rvalue stream insertion</h3>
<p><b>Section:</b> 29.7.5.5 <a href="https://timsong-cpp.github.io/cppwp/ostream.rvalue">[ostream.rvalue]</a>, 29.7.4.5 <a href="https://timsong-cpp.github.io/cppwp/istream.rvalue">[istream.rvalue]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Howard Hinnant <b>Opened:</b> 2009-09-06 <b>Last modified:</b> 2019-03-18 21:12:24 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#ostream.rvalue">issues</a> in [ostream.rvalue].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
29.7.5.5 <a href="https://timsong-cpp.github.io/cppwp/ostream.rvalue">[ostream.rvalue]</a> was created to preserve the ability to insert
into (and extract from 29.7.4.5 <a href="https://timsong-cpp.github.io/cppwp/istream.rvalue">[istream.rvalue]</a>) rvalue streams:
</p>

<blockquote><pre>
template &lt;class charT, class traits, class T&gt;
  basic_ostream&lt;charT, traits&gt;&amp;
  operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp;&amp; os, const T&amp; x);
</pre>
<blockquote>
<p>
1 <i>Effects:</i> <tt>os &lt;&lt; x</tt>
</p>
<p>
2 <i>Returns:</i> <tt>os</tt>
</p>
</blockquote>
</blockquote>

<p>
This is good as it allows code that wants to (for example) open, write to, and
close an <tt>ofstream</tt> all in one statement:
</p>

<blockquote><pre>
std::ofstream("log file") &lt;&lt; "Some message\n";
</pre></blockquote>

<p>
However, I think we can easily make this "rvalue stream helper" even easier to
use.  Consider trying to quickly create a formatted string.  With the current
spec you have to write:
</p>

<blockquote><pre>
std::string s = static_cast&lt;std::ostringstream&amp;&gt;(std::ostringstream() &lt;&lt; "i = " &lt;&lt; i).str();
</pre></blockquote>

<p>
This will store "<tt>i = 10</tt>" (for example) in the string <tt>s</tt>.  Note
the need to cast the stream back to <tt>ostringstream&amp;</tt> prior to using
the member <tt>.str()</tt>.  This is necessary because the inserter has cast
the <tt>ostringstream</tt> down to a more generic <tt>ostream</tt> during the
insertion process.
</p>

<p>
I believe we can re-specify the rvalue-inserter so that this cast is unnecessary.
Thus our customer now has to only type:
</p>

<blockquote><pre>
std::string s = (std::ostringstream() &lt;&lt; "i = " &lt;&lt; i).str();
</pre></blockquote>

<p>
This is accomplished by having the rvalue stream inserter return an rvalue of
the same type, instead of casting it down to the base class.  This is done by
making the stream generic, and constraining it to be an rvalue of a type derived
from <tt>ios_base</tt>.
</p>

<p>
The same argument and solution also applies to the inserter.  This code has been
implemented and tested.
</p>

<p><i>[
2009 Santa Cruz:
]</i></p>

<blockquote><p>
NAD Future. No concensus for change.
</p></blockquote>

<p><i>[LEWG Kona 2017]</i></p>

<p>Recommend Open: Design looks right.</p>

<p><i>[
2018-05-25, Billy O'Neal requests this issue be reopened and provides P/R
rebased against N4750
]</i></p>


<p>Billy O'Neal requests this issue be reopened, as changing operator&gt;&gt;
and operator&lt;&lt; to use perfect forwarding as described here is necessary to
implement LWG <a href="2534">2534</a> which was accepted. Moreover, this P/R also resolves
LWG <a href="2498">2498</a>.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
Change 29.7.4.5 <a href="https://timsong-cpp.github.io/cppwp/istream.rvalue">[istream.rvalue]</a>:
</p>

<blockquote><pre>
template &lt;class <del>charT, class traits</del> <ins>Istream</ins>, class T&gt;
  <del>basic_istream&lt;charT, traits&gt;&amp;</del> <ins>Istream&amp;&amp;</ins>
  operator&gt;&gt;(<del>basic_istream&lt;charT, traits&gt;</del> <ins>Istream</ins>&amp;&amp; is, T&amp; x);
</pre>
<blockquote>
<p>
1 <i>Effects:</i> <tt>is &gt;&gt; x</tt>
</p>
<p>
2 <i>Returns:</i> <tt><ins>std::move(</ins>is<ins>)</ins></tt>
</p>
<p><ins>
3 <i>Remarks:</i> This signature shall participate in overload resolution if
and only if <tt>Istream</tt> is not an lvalue reference type and is derived from
<tt>ios_base</tt>.
</ins></p>
</blockquote>
</blockquote>

<p>
Change 29.7.5.5 <a href="https://timsong-cpp.github.io/cppwp/ostream.rvalue">[ostream.rvalue]</a>:
</p>

<blockquote><pre>
template &lt;class <del>charT, class traits</del> <ins>Ostream</ins>, class T&gt;
  <del>basic_ostream&lt;charT, traits&gt;&amp;</del> <ins>Ostream&amp;&amp;</ins>
  operator&lt;&lt;(<del>basic_ostream&lt;charT, traits&gt;</del> <ins>Ostream</ins>&amp;&amp; os, const T&amp; x);
</pre>
<blockquote>
<p>
1 <i>Effects:</i> <tt>os &lt;&lt; x</tt>
</p>
<p>
2 <i>Returns:</i> <tt><ins>std::move(</ins>os<ins>)</ins></tt>
</p>
<p><ins>
3 <i>Remarks:</i> This signature shall participate in overload resolution if
and only if <tt>Ostream</tt> is not an lvalue reference type and is derived from
<tt>ios_base</tt>.
</ins></p>
</blockquote>
</blockquote>
</blockquote>

<p><i>[2018-12-03, Ville comments]</i></p>

<p>
The implementation in libstdc++ doesn't require derivation from <tt>ios_base</tt>, it 
requires convertibility to <tt>basic_istream/basic_ostream</tt>. This has been found to be 
important to avoid regressions with existing stream wrappers.
<p/>
In libstdc++, the inserter/extractor also don't return a reference to the template parameter, 
they return a reference to the <tt>basic_istream/basic_ostream</tt> <em>specialization</em>
the template parameter converts to. This was done in order to try and be closer to the earlier 
specification's return type, which specified <tt>basic_ostream&lt;charT, traits&gt;&amp;</tt>
and <tt>basic_istream&lt;charT, traits&gt;&amp;</tt>. So we detected convertibility to
(a type convertible to) those, and returned the result of that conversion. That doesn't seem to 
be necessary, and probably bothers certain chaining cases. Based on recent experiments, it seems
that this return-type dance (as opposed to just returning what the p/r suggests) is unnecessary, 
and doesn't trigger any regressions.
</p>
<p><i>[2019-01-20 Reflector prioritization]</i></p>

<p>Set Priority to 2</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This resolution is relative to N4750.</p>
<p>
Change 29.7.4.5 <a href="https://timsong-cpp.github.io/cppwp/istream.rvalue">[istream.rvalue]</a> as follows:
</p>

<blockquote><pre>
template &lt;class <del>charT, class traits</del> <ins>Istream</ins>, class T&gt;
  <del>basic_istream&lt;charT, traits&gt;&amp;</del> <ins>Istream&amp;&amp;</ins>
  operator&gt;&gt;(<del>basic_istream&lt;charT, traits&gt;</del> <ins>Istream</ins>&amp;&amp; is, T&amp;&amp; x);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to:
</p>
<pre>
<tt>is &gt;&gt; std::forward&lt;T&gt;(x)</tt>
return <ins>std::move(</ins>is<ins>)</ins>;
</pre>
<p>-2- <i>Remarks:</i> This function shall not participate in overload
resolution unless the expression <tt>is &gt;&gt; std::forward&lt;T&gt;(x)</tt> is
well-formed<ins>, <tt>Istream</tt> is not an lvalue reference type, and
<tt>Istream</tt> is derived from <tt>ios_base</tt></ins>.</p>
</blockquote>
</blockquote>

<p>
Change 29.7.5.5 <a href="https://timsong-cpp.github.io/cppwp/ostream.rvalue">[ostream.rvalue]</a>:
</p>

<blockquote><pre>
template &lt;class <del>charT, class traits</del> <ins>Ostream</ins>, class T&gt;
  <del>basic_ostream&lt;charT, traits&gt;&amp;</del> <ins>Ostream&amp;&amp;</ins>
  operator&lt;&lt;(<del>basic_ostream&lt;charT, traits&gt;</del> <ins>Ostream</ins>&amp;&amp; os, const T&amp; x);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> As if by: <tt>os &lt;&lt; x;</tt>
</p>
<p>
-2- <i>Returns:</i> <tt><ins>std::move(</ins>os<ins>)</ins></tt>
</p>
<p>
-3- <i>Remarks:</i> This signature shall not participate in overload resolution
unless the expression <tt>os &lt;&lt; x</tt> is well-formed<ins>,
<tt>Ostream</tt> is not an lvalue reference type, and <tt>Ostream</tt> is
derived from <tt>ios_base</tt></ins>.</p>
</blockquote>
</blockquote>
</blockquote>

<p><i>[2019-03-17; Daniel comments and provides updated wording]</i></p>

<p>
After discussion with Ville it turns out that the "derived from <tt>ios_base</tt>" approach works fine and
no breakages were found in regression tests. As result of that discussion the wording was rebased to the 
most recent working draft and the "overload resolution participation" wording was replaced by a 
corresponding <i>Constraints:</i> element.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Change 29.7.4.5 <a href="https://timsong-cpp.github.io/cppwp/istream.rvalue">[istream.rvalue]</a> as follows:</p>

<blockquote><pre>
template &lt;class <del>charT, class traits</del> <ins>Istream</ins>, class T&gt;
  <del>basic_istream&lt;charT, traits&gt;&amp;</del> <ins>Istream&amp;&amp;</ins>
  operator&gt;&gt;(<del>basic_istream&lt;charT, traits&gt;</del> <ins>Istream</ins>&amp;&amp; is, T&amp;&amp; x);
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The expression <tt>is &gt;&gt; std::forward&lt;T&gt;(x)</tt> is
well-formed and <tt>Istream</tt> is publicly and unambiguously derived from <tt>ios_base</tt>.</ins>
<p/>
-1- <i>Effects:</i> Equivalent to:
</p>
<blockquote><pre>
<tt>is &gt;&gt; std::forward&lt;T&gt;(x)</tt>;
return <ins>std::move(</ins>is<ins>)</ins>;
</pre></blockquote>
<p><del>-2- <i>Remarks:</i> This function shall not participate in overload resolution 
unless the expression <tt>is &gt;&gt; std::forward&lt;T&gt;(x)</tt> is well-formed.</del></p>
</blockquote>
</blockquote>
</li>

<li>
<p>
Change 29.7.5.5 <a href="https://timsong-cpp.github.io/cppwp/ostream.rvalue">[ostream.rvalue]</a>:
</p>

<blockquote><pre>
template &lt;class <del>charT, class traits</del> <ins>Ostream</ins>, class T&gt;
  <del>basic_ostream&lt;charT, traits&gt;&amp;</del> <ins>Ostream&amp;&amp;</ins>
  operator&lt;&lt;(<del>basic_ostream&lt;charT, traits&gt;</del> <ins>Ostream</ins>&amp;&amp; os, const T&amp; x);
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The expression <tt>os &lt;&lt; x</tt> is well-formed and <tt>Ostream</tt> 
is publicly and unambiguously derived from <tt>ios_base</tt>.</ins>
<p/>
-1- <i>Effects:</i> As if by: <tt>os &lt;&lt; x;</tt>
<p/>
-2- <i>Returns:</i> <tt><ins>std::move(</ins>os<ins>)</ins></tt>.
<p/>
<del>-3- <i>Remarks:</i> This signature shall not participate in overload resolution
unless the expression <tt>os &lt;&lt; x</tt> is well-formed.</del></p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="1213" href="1213">1213.</a> Meaning of valid and singular iterator underspecified</h3>
<p><b>Section:</b> 23.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements">[iterator.requirements]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2009-09-19 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.requirements">issues</a> in [iterator.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The terms <em>valid</em> iterator and <em>singular</em> aren't
properly defined. The fuzziness of those terms became even worse
after the resolution of <a href="208">208</a> (including further updates by <a href="278">278</a>). In
23.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements">[iterator.requirements]</a> as of
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2723.pdf">N2723</a>
the standard says now:
</p>

<blockquote>
<p>
5 - These values are called past-the-end values. Values of an iterator <tt>i</tt> for
which the expression <tt>*i</tt> is defined are called dereferenceable. The library
never assumes that past-the-end values are dereferenceable. Iterators
can also have singular values that are not associated with any
container. [...] Results of most expressions are undefined for singular
values; the only exceptions are destroying an iterator that holds a
singular value and the assignment of a non-singular value to an iterator
that holds a singular value. [...] Dereferenceable values are always
non-singular.
</p>

<p>
10 - An invalid iterator is an iterator that may be singular.
</p>
</blockquote>

<p>
First, issue <a href="208">208</a> intentionally removed the earlier constraint that past-the-end
values are always non-singular. The reason for this was to support null
pointers as past-the-end iterators of e.g. empty sequences. But there
seem to exist different views on what a singular (iterator) value is. E.g.
according to the <a href="http://www.sgi.com/tech/stl/trivial.html">SGI definition</a>
a null pointer is <em>not</em> a singular value:
</p>

<blockquote><p>
Dereferenceable iterators are always nonsingular, but the converse is
not true.
For example, a null pointer is nonsingular (there are well defined operations
involving null pointers) even thought it is not dereferenceable.
</p></blockquote>

<p>
and <a href="http://www.sgi.com/tech/stl/InputIterator.html">proceeds</a>:
</p>

<blockquote><p>
An iterator is valid if it is dereferenceable or past-the-end.
</p></blockquote>

<p>
Even if the standard prefers a different meaning of singular here, the
change was incomplete, because by restricting feasible expressions of singular
iterators to destruction and assignment isn't sufficient for a past-the-end
iterator: Of-course it must still be equality-comparable and in general be a readable value.
</p>

<p>
Second, the standard doesn't clearly say whether a past-the-end value is
a valid iterator or not. E.g. 20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a>/1 says:
</p>

<blockquote><p>
In all of the following algorithms, the formal template parameter <tt>ForwardIterator</tt> 
is required to satisfy the requirements of a forward iterator (24.1.3)
[..], and is required to have the property that no exceptions are thrown from [..], or
dereference of valid iterators.
</p></blockquote>

<p>
The standard should make better clear what "singular pointer" and "valid
iterator" means. The fact that the meaning of a valid <em>value</em>
has a core language meaning doesn't imply that for an iterator concept
the term "valid iterator" has the same meaning.
</p>

<p>
Let me add a final example: In 99 [allocator.concepts.members] of
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2914.pdf">N2914</a>
we find:
</p>

<blockquote><pre>
pointer X::allocate(size_type n);
</pre>

<blockquote><p>
11 <i>Returns:</i> a pointer to the allocated memory. [<i>Note:</i> if <tt>n == 0</tt>, the return
value is unspecified. &mdash;<i>end note</i>]
</p></blockquote>

<p>
[..]
</p>

<pre>
void X::deallocate(pointer p, size_type n);
</pre>

<blockquote><p>
<i>Preconditions:</i> <tt>p</tt> shall be a non-singular pointer value obtained from a call
to <tt>allocate()</tt> on this allocator or one that compares equal to it.
</p></blockquote>
</blockquote>

<p>
If singular pointer value would include null pointers this make the
preconditions
unclear if the pointer value is a result of <tt>allocate(0)</tt>: Since the return value
is unspecified, it could be a null pointer. Does that mean that programmers
need to check the pointer value for a null value before calling deallocate?
</p>

<p><i>[
2010-11-09 Daniel comments:
]</i></p>


<p>
A later paper is in preparation.
</p>

<p><i>[
2010 Batavia:
]</i></p>


<p>
Doesn't need to be resolved for Ox
</p>


<p><i>[2014-02-20 Re-open Deferred issues as Priority 4]</i></p>


<p>
Consider to await the paper.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1238" href="1238">1238.</a> Defining algorithms taking iterator for range</h3>
<p><b>Section:</b> 25 <a href="https://timsong-cpp.github.io/cppwp/algorithms">[algorithms]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2009-10-15 <b>Last modified:</b> 2019-03-24 20:27:49 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#algorithms">active issues</a> in [algorithms].</p>
<p><b>View all other</b> <a href="lwg-index.html#algorithms">issues</a> in [algorithms].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The library has many algorithms that take a source range represented by
a pair of iterators, and the start of some second sequence given by a
single iterator. Internally, these algorithms will produce undefined
behaviour if the second 'range' is not as large as the input range, but
none of the algorithms spell this out in Requires clauses, and there is
no catch-all wording to cover this in clause 17 or the front matter of
25.
</p>

<p>
There was an attempt to provide such wording in paper <a href="http://wg21.link/n2944">n2944</a>
but this seems incidental to the focus of the paper, and getting the wording of
this issue right seems substantially more difficult than the simple
approach taken in that paper.  Such wording will be removed from an
updated paper, and hopefully tracked via the LWG issues list instead.
</p>

<p>
It seems there are several classes of problems here and finding wording
to solve all in one paragraph could be too much.  I suspect we need
several overlapping requirements that should cover the desired range of
behaviours.
</p>

<p>
Motivating examples:
</p>

<p>
A good initial example is the <tt>swap_ranges</tt> algorithm.  Here there is a
clear requirement that <tt>first2</tt> refers to the start of a valid range at
least as long as the range <tt>[first1, last1)</tt>.  <a href="http://wg21.link/n2944">n2944</a> tries to solve this
by positing a hypothetical <tt>last2</tt> iterator that is implied by the
signature, and requires <tt>distance(first2,last2) &lt; distance(first1,last1)</tt>.
 This mostly works, although I am uncomfortable assuming that <tt>last2</tt> is
clearly defined and well known without any description of how to obtain
it (and I have no idea how to write that).
</p>

<p>
A second motivating example might be the <tt>copy</tt> algorithm.  Specifically,
let us image a call like:
</p>

<blockquote><pre>
copy(istream_iterator&lt;int&gt;(is),istream_iterator(),ostream_iterator&lt;int&gt;(os));
</pre></blockquote>

<p>
In this case, our input iterators are literally simple <tt>InputIterators</tt>,
and the destination is a simple <tt>OutputIterator</tt>.  In neither case am I
happy referring to <tt>std::distance</tt>, in fact it is not possible for the
<tt>ostream_iterator</tt> at all as it does not meet the requirements.  However,
any wording we provide must cover both cases.  Perhaps we might deduce
<tt>last2 == ostream_iterator&lt;int&gt;{}</tt>, but that might not always be valid for
user-defined iterator types.  I can well imagine an 'infinite range'
that writes to <tt>/dev/null</tt> and has no meaningful <tt>last2</tt>.
</p>

<p>
The motivating example in <a href="http://wg21.link/n2944">n2944</a> is <tt>std::equal</tt>, 
and that seems to fall somewhere between the two.
</p>

<p>
Outlying examples might be <tt>partition_copy</tt> that takes two output
iterators, and the <tt>_n</tt> algorithms where a range is specified by a
specific number of iterations, rather than traditional iterator pair. 
We should also <em>not</em> accidentally apply inappropriate constraints to
<tt>std::rotate</tt> which takes a third iterator that is not intended to be a
separate range at all.
</p>

<p>
I suspect we want some wording similar to:
</p>

<blockquote><p>
For algorithms that operate on ranges where the end iterator of the
second range is not specified, the second range shall contain at least
as many elements as the first.
</p></blockquote>

<p>
I don't think this quite captures the intent yet though.  I am not sure
if 'range' is the right term here rather than sequence.  More awkwardly,
I am not convinced we can describe an Output sequence such as produce by
an <tt>ostream_iterator</tt> as "containing elements", at least not as a
precondition to the call before they have been written.
</p>

<p>
Another idea was to describe require that the trailing iterator support
at least distance(input range) applications of <tt>operator++</tt> and may be
written through the same number of times if a mutable/output iterator.
</p>

<p>
We might also consider handling the case of an output range vs. an input
range in separate paragraphs, if that simplifies how we describe some of
these constraints.
</p>

<p><i>[
2009-11-03 Howard adds:
]</i></p>


<blockquote><p>
Moved to Tentatively NAD Future after 5 positive votes on c++std-lib.
</p></blockquote>

<p><i>[LEWG Kona 2017]</i></p>

<p>Recommend Open: The design is clear here; we just need wording</p>

<p><i>[2019-01-20 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Rationale:</b></p>
<p>
Does not have sufficient support at this time. May wish to reconsider for a
future standard.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1396" href="1396">1396.</a> <tt>regex</tt> should support allocators</h3>
<p><b>Section:</b> 30.8 <a href="https://timsong-cpp.github.io/cppwp/re.regex">[re.regex]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> INCITS <b>Opened:</b> 2010-08-25 <b>Last modified:</b> 2018-06-24 10:53:02 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.regex">active issues</a> in [re.regex].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.regex">issues</a> in [re.regex].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Duplicate of:</b> <a href="1451">1451</a></p>
<p><b>Discussion:</b></p>
<p><b>Addresses US-104, US-141</b></p>
<p>
<tt>std::basic_regex</tt> should have an allocator for all the
reasons that a <tt>std::string</tt> does. For example, I can use
<tt>boost::interprocess</tt> to put a <tt>string</tt> or <tt>vector</tt>
in shared memory, but not a <tt>regex</tt>.
</p>

<p><i>[
Resolution proposed by ballot comment
]</i></p>

<p>
Add allocators to regexes
</p>

<p><i>[
2010-10-24 Daniel adds:
]</i></p>


<blockquote><p>
Accepting <a href="http://wg21.link/n3171.pdf">n3171</a> would solve this issue.
</p></blockquote>

<p><i>[2011-03-22 Madrid]</i></p>

<p>Close 1396 as NAD Future.</p>

<p><i>[LEWG Kona 2017]</i></p>

<p>Recommend Open: Covered in LEWG9, P0269, which is in wording review.</p>


<p><b>Rationale:</b></p><p>No consensus for a change at this time</p>

<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1422" href="1422">1422.</a> <tt>vector&lt;bool&gt;</tt> iterators are not random access</h3>
<p><b>Section:</b> 22.3.12 <a href="https://timsong-cpp.github.io/cppwp/vector.bool">[vector.bool]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> BSI <b>Opened:</b> 2010-08-25 <b>Last modified:</b> 2017-06-05 20:39:07 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#vector.bool">issues</a> in [vector.bool].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses GB-118</b></p>
<p>
<tt>vector&lt;bool&gt;</tt> iterators are not random access iterators
because their reference type is a special class, and not
<tt>bool &amp;</tt>. All standard libary operations taking iterators
should treat this iterator as if it was a random access iterator, rather
than a simple input iterator.
</p>

<p><i>[
Resolution proposed in ballot comment
]</i></p>

<p>
Either revise the iterator requirements to support proxy iterators
(restoring functionality that was lost when the Concept facility was
removed) or add an extra paragraph to the <tt>vector&lt;bool&gt;</tt>
specification requiring the library to treat <tt>vector&lt;bool&gt;</tt>
iterators as-if they were random access iterators, despite having the wrong
reference type.
</p>

<p><i>[
Rapperswil Review
]</i></p>

<p>
The consensus at Rapperswil is that it is too late for full support for
proxy iterators, but requiring the library to respect <tt>vector&lt;bool&gt;</tt>
iterators as-if they were random access would be preferable to flagging
this container as deliberately incompatible with standard library algorithms.
</p>
<p>
Alisdair to write the note, which may become normative <i>Remark</i> depending
on the preferences of the project editor.
</p>

<p><i>[
Post-Rapperswil Alisdair provides wording
]</i></p>

<p>
Initial wording is supplied, deliberately using <i>Note</i> in preference to
<i>Remark</i> although the author notes his preference for <i>Remark</i>.  The
issue of whether <tt>iterator_traits&lt;vector&lt;bool&gt;&gt;::iterator_category</tt>
is permitted to report <tt>random_access_iterator_tag</tt> or must report 
<tt>input_iterator_tag</tt> is not addressed.
</p>

<p><i>[
Old Proposed Resolution:
]</i></p>

<blockquote>
<p>
Insert a new paragraph into 22.3.12 <a href="https://timsong-cpp.github.io/cppwp/vector.bool">[vector.bool]</a> between p4 and p5:
</p>
<blockquote><p>
[<i>Note</i> All functions in the library that take a pair of iterators to
denote a range shall treat <tt>vector&lt;bool&gt;</tt> iterators as-if they were
random access iterators, even though the <tt>reference</tt> type is not a
true reference.<i>-- end note</i>]
</p></blockquote>
</blockquote>

<p><i>[
2010-11 Batavia:
]</i></p>

<blockquote><p>
Closed as NAD Future, because the current iterator categories cannot correctly describe
<tt>vector&lt;bool&gt;::iterator</tt>. But saying that they are Random Access Iterators
is also incorrect, because it is not too hard to create a corresponding test that fails.
We should deal with the more general proxy iterator problem in the future, and see no
benefit to take a partial workaround specific to <tt>vector&lt;bool&gt;</tt> now.
</p></blockquote>

<p><i>[2017-02 in Kona, LEWG recommends NAD]</i></p>

<p>D0022 Proxy Iterators for the Ranges Extensions -
as much a fix as were going to get for vector&lt;bool&gt;.</p>

<p><i>[2017-06-02 Issues Telecon]</i></p>

<p><a href="http://wg21.link/P0022">P0022</a> is exploring a resolution. 
We consider this to be fairly important issue</p>
<p>Move to Open, set priority to 3</p>


<p><b>Proposed resolution:</b></p>


<p><b>Rationale:</b></p>
<p>
No consensus to make this change at this time.
</p>





<hr>
<h3><a name="1459" href="1459">1459.</a> Overlapping evaluations are allowed</h3>
<p><b>Section:</b> 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Canada <b>Opened:</b> 2010-08-25 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#atomics.order">active issues</a> in [atomics.order].</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.order">issues</a> in [atomics.order].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Duplicate of:</b> <a href="1458">1458</a></p>
<p><b>Discussion:</b></p>
<p><b>Addresses CA-21, GB-131</b></p>
<p>
31.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.lockfree">[atomics.lockfree]</a> p.8 states:
</p>
<blockquote><p>
An atomic store shall only store a value that has
been computed from constants and program input values
by a finite sequence of program evaluations, such
that each evaluation observes the values of variables
as computed by the last prior assignment in the
sequence.
</p></blockquote>
<p>
... but 6.9.1 <a href="https://timsong-cpp.github.io/cppwp/intro.execution">[intro.execution]</a> p.13 states:
</p>
<blockquote><p>
If A is not sequenced before B and B is not
sequenced before A, then A and B are unsequenced.
[ <em>Note</em>: The execution of unsequenced
evaluations can overlap. &mdash; <em>end note</em> ]
</p></blockquote>
<p>
Overlapping executions can make it impossible to
construct the sequence described in 31.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.lockfree">[atomics.lockfree]</a> p.8. We are not
sure of the intention here and do not offer a suggestion for
change, but note that 31.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.lockfree">[atomics.lockfree]</a> p.8 is the condition that prevents
out-of-thin-air reads.
</p>
<p>
For an example, suppose we have a function invocation
f(e1,e2). The evaluations of e1 and e2 can overlap.
Suppose that the evaluation of e1 writes y and reads x
whereas the evaluation of e2 reads y and writes x, with
reads-from edges as below (all this is within a single
thread).
</p>
<pre>
 e1           e2
Wrlx y--   --Wrlx x
      rf\ /rf
         X
        / \
Rrlx x&lt;-   -&gt;Rrlx y
</pre>
<p>
This seems like it should be allowed, but there seems to
be no way to produce a sequence of evaluations with the
property above.
</p>
<p>
In more detail, here the two evaluations, e1 and e2, are
being executed as the arguments of a function and are
consequently not sequenced-before each other. In
practice we'd expect that they could overlap (as allowed
by 6.9.1 <a href="https://timsong-cpp.github.io/cppwp/intro.execution">[intro.execution]</a> p.13), with the two writes taking effect before the two
reads. However, if we have to construct a linear order of
evaluations, as in 31.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.lockfree">[atomics.lockfree]</a> p.8, then the execution above is not
permited. Is that really intended?
</p>

<p><i>[
Resolution proposed by ballot comment
]</i></p>

<p>
Please clarify.
</p>

<p><i>[2011-03-09 Hans comments:]</i></p>


<p>I'm not proud of 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p9 (formerly p8), and I agree with the comments that this
isn't entirely satisfactory. 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p9 was designed to preclude
out-of-thin-air results for races among <tt>memory_order_relaxed</tt> atomics, in spite of 
the fact that Java experience has shown we don't really know how to do that adequately. In 
the long run, we probably want to revisit this.
<p/>
However, in the short term, I'm still inclined to declare this NAD, for two separate reasons:
</p>

<ol>
<li><p>6.9.1 <a href="https://timsong-cpp.github.io/cppwp/intro.execution">[intro.execution]</a> p15 states: "If a side effect on a scalar
object is unsequenced relative to either another side
effect on the same scalar object or a value computation
using the value of the same scalar object, the behavior is undefined."
I think the examples presented here have undefined behavior as a result.
It's not completely clear to me whether examples can be constructed
that exhibit this problem, and don't have undefined behavior.</p></li>

<li><p>This comment seems to be using a different meaning of "evaluation"
from what is used elsewhere in the standard. The sequence of evaluations
here doesn't have to consist of full expression evaluations.  They
can be evaluations of operations like lvalue to rvalue conversion,
or individual assignments. In particular, the reads and writes
executed by <tt>e1</tt> and <tt>e2</tt> in the example could be treated as separate
evaluations for purposes of producing the sequence.
The definition of "sequenced before" in 6.9.1 <a href="https://timsong-cpp.github.io/cppwp/intro.execution">[intro.execution]</a> makes
little sense if the term "evaluation" is restricted to any notion
of complete expression. Perhaps we should add yet another note
to clarify this?  31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p10 probably leads to 
the wrong impression here.
<p/>
An alternative resolution would be to simply delete our flakey
attempt at preventing out-of-thin-air reads, by removing 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p9-11,
possibly adding a note that explains that we technically allow,
but strongly discourage them. If we were starting this from scratch
now, that would probably be my preference.  But it seems like too drastic
a resolution at this stage.
</p></li>
</ol>

<p><i>[2011-03-24 Madrid]</i></p>

<p>
Moved to NAD Future
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1484" href="1484">1484.</a> Need a way to join a thread with a timeout</h3>
<p><b>Section:</b> 32.4.2 <a href="https://timsong-cpp.github.io/cppwp/thread.thread.class">[thread.thread.class]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> INCITS <b>Opened:</b> 2010-08-25 <b>Last modified:</b> 2017-03-01 18:09:34 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses US-183</b></p>

<p>
There is no way to join a thread with a timeout.
</p>

<p><i>[
Resolution proposed by ballot comment:
]</i></p>

<blockquote><p>
Add <tt>join_for</tt> and <tt>join_until</tt>. Or decide one should
never join a thread with a timeout since <tt>pthread_join</tt> doesn't have a 
timeout version.
</p></blockquote>

<p><i>[
2010 Batavia
]</i></p>

<p>
The concurrency working group deemed this an extension beyond the scope of C++0x.
</p>
<p><b>Rationale:</b></p><p>The LWG does not wish to make a change at this time.</p>

<p><i>[2017-03-01, Kona]</i></p>

<p>
SG1 recommends: Close as NAD
<p/>
There has not been much demand for it, and it would usually be difficult to deal with <tt>thread_local</tt> destructor races. 
It can be approximated with a condition variable wait followed by an unconditional <tt>join</tt>. Adding it would create 
implementation issues on Posix. As always, this may be revisited if we have a paper exploring the issues in detail.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1488" href="1488">1488.</a> Improve interoperability between the C++0x and C1x threads APIs</h3>
<p><b>Section:</b> 32.5 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex">[thread.mutex]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> INCITS <b>Opened:</b> 2010-08-25 <b>Last modified:</b> 2017-03-01 18:09:34 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#thread.mutex">issues</a> in [thread.mutex].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses US-185</b></p>

<p>
Cooperate with WG14 to improve interoperability between
the <tt>C++0x</tt> and <tt>C1x</tt> threads APIs. In particular, <tt>C1x</tt>
mutexes should be conveniently usable with a <tt>C++0x</tt>
<tt>lock_guard</tt>. Performance overheads for this combination
should be considered.
</p>

<p><i>[
Resolution proposed by ballot comment:
]</i></p>

<blockquote><p>
Remove <tt>C++0x</tt> <tt>timed_mutex</tt> and
<tt>timed_recursive_mutex</tt> if that facilitates
development of more compatible APIs.
</p></blockquote>

<p><i>[
2010 Batavia
]</i></p>

<p>
The concurrency sub-group reviewed the options, and decided that closer harmony should wait until both standards are published.
</p>

<p><b>Rationale:</b></p>
<p>
The LWG does not wish to make any change at this time.
</p>


<p><i>[2017-03-01, Kona]</i></p>

<p>
SG1 recommends: Close as NAD
<p/>
Papers about C compatibility are welcome, but there may be more pressing issues. C threads are not consistently available 
at this point, so there seems to be little demand to fix this particular problem.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1493" href="1493">1493.</a> Add <tt>mutex</tt>, <tt>recursive_mutex</tt>, <tt>is_locked</tt> function</h3>
<p><b>Section:</b> 32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> INCITS <b>Opened:</b> 2010-08-25 <b>Last modified:</b> 2017-03-01 18:09:34 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#thread.mutex.requirements">active issues</a> in [thread.mutex.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#thread.mutex.requirements">issues</a> in [thread.mutex.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses US-189</b></p>

<p>
<tt>mutex</tt> and <tt>recursive_mutex</tt> should have an <tt>is_locked()</tt>
member function. <tt>is_locked</tt> allows a user to test a lock
without acquiring it and can be used to implement a lightweight
<tt>try_try_lock</tt>.
</p>

<p><i>[
Resolution proposed by ballot comment:
]</i></p>

<blockquote><p>
Add a member function:
</p>
<pre>
bool is_locked() const;
</pre>
<p>
to <tt>std::mutex</tt> and <tt>std::recursive_mutex</tt>. These
functions return true if the current thread would
not be able to obtain a mutex. These functions do
not synchronize with anything (and, thus, can
avoid a memory fence).
</p></blockquote>

<p><i>[
2010 Batavia
]</i></p>

<p>
The Concurrency subgroup reviewed this issue and deemed it to be an extension to be handled after publishing C++0x.
</p>

<p><b>Rationale:</b></p><p>The LWG does not wish to make a change at this time.</p>

<p><i>[2017-03-01, Kona]</i></p>

<p>
SG1 recommends: Close as NAD
<p/>
Several participants voiced strong objections, based on either memory model issues or lock elision. No support. It is 
already possible to write a wrapper that explicitly tracks ownership for testing in the owning thread, which may have 
been part of the intent here.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="1521" href="1521">1521.</a> Requirements on internal pointer representations in containers</h3>
<p><b>Section:</b> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Mike Spertus <b>Opened:</b> 2010-10-16 <b>Last modified:</b> 2019-01-20 16:20:00 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#container.requirements.general">active issues</a> in [container.requirements.general].</p>
<p><b>View all other</b> <a href="lwg-index.html#container.requirements.general">issues</a> in [container.requirements.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses US-104, US-141</b></p>

<p>
The standard doesn't say that containers should use abstract pointer 
types internally. Both Howard and Pablo agree that this is the intent. 
Further, it is necessary for containers to be stored, for example, in 
shared memory with an interprocess allocator (the type of scenario that 
allocators are intended to support).
</p>
<p>
In spite of the (possible) agreement on intent, it is necessary to make 
this explicit:
</p>
<p>
An implementations may like to store the result of dereferencing the 
pointer (which is a raw reference) as an optimization, but that prevents 
the data structure from being put in shared memory, etc. In fact, a 
container could store raw references to the allocator, which would be a 
little weird but conforming as long as it has one by-value copy. 
Furthermore, pointers to locales, ctypes, etc. may be there, which also 
prevents the data structure from being put in shared memory, so we 
should make explicit that a container does not store raw pointers or 
references at all.
</p>

<p><i>[
Pre-batavia
]</i></p>

<p>
This issue is being opened as part of the response to NB comments US-104/141. 
See paper <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3171.pdf">N3171</a>
in the pre-Batavia mailing. 
</p>

<p><i>[2011-03-23 Madrid meeting]</i></p>


<p>Deferred</p>

<p><i>[
2011 Batavia
]</i></p>


<p>
This may be an issue, but it is not clear.  We want to gain a few years experience
with the C++11 allocator model to see if this is already implied by the existing
specification.
</p>

<p><i>[LEWG Kona 2017]</i></p>

<p>Status to Open: Acknowledged, need wording: (N4618 numbering) 23.2.1 container.requirements.general p8 first sentence. Replace non-normative note with requirement.</p>
<p>See discussion on LEWG Wiki</p>

<p><i>[2019-01-20 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
Add to the end of 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> p. 8:
</p>
<blockquote><p>
[..] In all container types defined in this Clause, the member <tt>get_allocator()</tt> returns 
a copy of the allocator used to construct the container or, if that allocator has been replaced, 
a copy of the most recent replacement. <ins>The container may not store internal objects whose 
types are of the form  <tt>T *</tt> or <tt>T &amp;</tt> except insofar as they are part of the 
item type or members.</ins>
</p></blockquote>





<hr>
<h3><a name="2035" href="2035">2035.</a> Output iterator requirements are broken</h3>
<p><b>Section:</b> 23.3.5.3 <a href="https://timsong-cpp.github.io/cppwp/output.iterators">[output.iterators]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2011-02-27 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#output.iterators">active issues</a> in [output.iterators].</p>
<p><b>View all other</b> <a href="lwg-index.html#output.iterators">issues</a> in [output.iterators].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>During the Pittsburgh meeting the proposal <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3066.html">N3066</a>
became accepted because it fixed several severe issues related to the iterator specification. But the current working draft (N3225)
does not reflect all these changes. Since I'm unaware whether every correction can be done editorial, this issue is submitted to take
care of that. To give one example: All expressions of Table 108 &mdash; &quot;Output iterator requirements&quot; have a post-condition
that the iterator is incrementable. This is impossible, because it would exclude any finite sequence that is accessed by an output 
iterator, such as a pointer to a C array. The N3066 wording changes did not have these effects.
</p>

<p><i>[2011-03-01: Daniel comments:]</i></p>


<p>This issue has some overlap with the issue <a href="2038">2038</a> and I would prefer if we
could solve both at one location. I suggest the following approach:
</p>
<ol>
<li><p>The terms <tt><i>dereferencable</i></tt> and <tt><i>incrementable</i></tt> could be defined in a more
general way not restricted to iterators (similar to the concepts <tt>HasDereference</tt> and 
<tt>HasPreincrement</tt> from working draft N2914). But on the other hand, all current usages of 
<tt><i>dereferencable</i></tt> and <tt><i>incrementable</i></tt> are involved with types that satisfy 
iterator requirements. Thus, I believe that it is sufficient for C++0x to add corresponding definitions to 
23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a> and to let all previous usages of these terms refer to this 
sub-clause. Since the same problem occurs with the past-the-end iterator, this proposal suggest providing 
similar references to usages that precede its definition as well.
</p></li>
<li><p>We also need to ensure that all iterator expressions get either an operational semantics in
terms of others or we need to add missing pre- and post-conditions. E.g. we have the following
ones without semantics:
</p><blockquote><pre>
*r++ = o // output iterator
*r--     // bidirectional iterator
</pre></blockquote><p>
According to the <a href="http://www.sgi.com/tech/stl/OutputIterator.html">SGI specification</a>
these correspond to
</p><blockquote><pre>
{ *r = o; ++r; }                         // output iterator
{ reference tmp = *r; --r; return tmp; } // bidirectional iterator
</pre></blockquote><p>
respectively. Please note especially the latter expression for bidirectional iterator. It fixes a problem
that we have for forward iterator as well: Both these iterator categories provide stronger guarantees
than input iterator, because the result of the dereference operation is <tt>reference</tt>, and <strong>not</strong>
only convertible to the value type (The exact form from the SGI documentation does not correctly refer to
<tt>reference</tt>).
</p></li>
</ol>

<p><i>[2011-03-14: Daniel comments and updates the suggested wording]</i></p>


<p>In addition to the before mentioned necessary changes there is another one need, which
became obvious due to issue <a href="2042">2042</a>: <tt>forward_list&lt;&gt;::before_begin()</tt> returns
an iterator value which is not dereferencable, but obviously the intention is that it should
be incrementable. This leads to the conclusion that imposing dereferencable as a requirement
for the expressions <tt>++r</tt> is wrong: We only need the iterator to be incrementable. A
similar conclusion applies to the expression <tt>--r</tt> of bidirectional iterators.</p>

<p><i>[
2011 Bloomington
]</i></p>


<p>
Consensus this is the correct direction, but there are (potentially) missing <i>incrementable</i>
preconditions on some table rows, and the Remarks on when an output iterator becomes dereferencable
are probably better handled outside the table, in a manner similar to the way we word for input
iterators.
</p>

<p>
There was some concern about redundant pre-conditions when the operational semantic is defined in
terms of operations that have preconditions, and a similar level of concern over dropping such
redundancies vs. applying a consistent level of redundant specification in all the iterator tables.
Wording clean-up in either direction would be welcome.
</p>

<p><i>[2011-08-18: Daniel adapts the proposed resolution to honor the Bloomington request]</i></p>


<p>
There is only a small number of further changes suggested to get rid of superfluous 
requirements and essentially non-normative assertions. Operations should not have extra 
pre-conditions, if defined by "in-terms-of" semantics, see e.g. <tt>a != b</tt> or <tt>a-&gt;m</tt> 
for Table 107. Further, some remarks, that do not impose anything or say nothing new have been removed, 
because I could not find anything helpful they provide.
E.g. consider the remarks for Table 108 for the operations dereference-assignment and
preincrement: They don't provide additional information say nothing surprising. With the
new pre-conditions <em>and</em> post-conditions it is implied what the remarks intend to say.
</p>

<p><i>[
2011-11-03: Some observations from Alexander Stepanov via c++std-lib-31405
]</i></p>


<p>
The following sentence is dropped from the standard section on OutputIterators:
<p/>
"In particular, the following two conditions should hold: first, any
iterator value should be assigned through before it is incremented
(this is, for an output iterator <tt>i, i++; i++;</tt> is not a valid code
sequence); second, any value of an output iterator may have at most
one active copy at any given time (for example, <tt>i = j; *++i = a; *j = b;</tt> 
is not a valid code sequence)."
</p>

<p><i>[
2011-11-04: Daniel comments and improves the wording
]</i></p>


<p>
In regard to the first part of the comment, the intention of the newly proposed wording 
was to make clear that for the expression
</p>
<blockquote><pre>
*r = o
</pre></blockquote>
<p>
we have the precondition dereferenceable and the post-condition
incrementable. And for the expression
</p>
<blockquote><pre>
++r
</pre></blockquote>
<p>
we have the precondition incrementable and the post-condition dereferenceable 
or past-the-end. This <em>should not</em>  allow for a sequence like <tt>i++; i++;</tt> 
but I agree that it doesn't exactly say that.
<p/>
In regard to the second point: To make this point clearer, I suggest to
add a similar additional wording as we already have for input iterator to the 
"Assertion&#47;note" column of the expression <tt>++r</tt>:
<p/>
"Post: any copies of the previous value of <tt>r</tt> are no longer 
required to be dereferenceable or incrementable."
<p/>
The proposed has been updated to honor the observations of Alexander Stepanov.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
The matter is complicated, Daniel volunteers to write a paper.
</p>



<p><b>Proposed resolution:</b></p>
<ol>
<li><p>Add a reference to 23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a> to the following parts of the
library preceding Clause 24 Iterators library: (I stopped from 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> on, because
the remaining references are the concrete containers)</p>
<ol>
<li><p>16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a> p5:</p>

<blockquote><p>
-5- A type <tt>X</tt> satisfying any of the iterator requirements (24.2) is <tt><i>ValueSwappable</i></tt> if, 
for any dereferenceable <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins> object <tt>x</tt> of type 
<tt>X</tt>, <tt>*x</tt> is swappable.
</p></blockquote>
</li>

<li><p>16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 27 &mdash; &quot;Descriptive variable definitions&quot;, 
row with the expression <tt>c</tt>:</p>

<blockquote><p>
a dereferenceable <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins> pointer of type <tt>C*</tt>
</p></blockquote>

</li>

<li><p>20.10.3.2 <a href="https://timsong-cpp.github.io/cppwp/pointer.traits.functions">[pointer.traits.functions]</a>:</p>
<blockquote><p>
<i>Returns</i>: The first template function returns a dereferenceable <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins> 
pointer to <tt>r</tt> obtained by calling <tt>Ptr::pointer_to(r)</tt>;  [&hellip;]
</p></blockquote>
</li>

<li><p>21.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/string.iterators">[string.iterators]</a> p. 2:</p>
<blockquote><p>
<i>Returns</i>: An iterator which is the past-the-end value <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins>.
</p></blockquote>
</li>

<li><p>28.4.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get.virtuals">[locale.time.get.virtuals]</a> p. 11:</p>
<blockquote><pre>
iter_type do_get(iter_type s, iter_type end, ios_base&amp; f,
  ios_base::iostate&amp; err, tm *t, char format, char modifier) const;
</pre><blockquote><p>
<i>Requires</i>: <tt>t</tt> shall be dereferenceable <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins>.
</p></blockquote></blockquote>
</li>

<li><p>22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> p. 6:</p>

<blockquote><p>
[&hellip;]  <tt>end()</tt> returns an iterator which is the past-the-end <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins> 
value for the container.  [&hellip;]
</p></blockquote>
</li>

<li><p>22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> p. 3:</p>

<blockquote><p>
[&hellip;]  <tt>q</tt> denotes a valid dereferenceable <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins> 
const iterator to <tt>a</tt>,  [&hellip;]
</p></blockquote>
</li>

<li><p>22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a> p. 8 (I omit intentionally one further reference in the same sub-clause):</p>

<blockquote><p>
[&hellip;]  <tt>q</tt> denotes a valid dereferenceable <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins> 
const iterator to <tt>a</tt>,  [&hellip;]
</p></blockquote>
</li>

<li><p>22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> p. 10 (I omit intentionally one further reference in the same sub-clause):</p>

<blockquote><p>
[&hellip;]  <tt>q</tt> and <tt>q1</tt> are valid dereferenceable <ins>(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)</ins> 
const iterators to <tt>a</tt>,  [&hellip;]
</p></blockquote>
</li>
</ol>

</li>
<li><p>Edit 23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a> p. 5 as indicated (The intent is to properly define
<i>incrementable</i> and to ensure some further library guarantee related to past-the-end iterator values):</p>

<blockquote><p>
-5- Just as a regular pointer to an array guarantees that there is a pointer value pointing past the last element
of the array, so for any iterator type there is an iterator value that points past the last element of a
corresponding sequence. These values are called <i>past-the-end values</i>. Values of an iterator <tt>i</tt> for which the
expression <tt>*i</tt> is defined are called <i>dereferenceable</i>. <ins>Values of an iterator <tt>i</tt> for which the
expression <tt>++i</tt> is defined are called <i>incrementable</i>. </ins> The library never assumes that 
past-the-end values are dereferenceable <ins>or incrementable</ins>. Iterators can also have singular values 
that are not associated with any sequence. [&hellip;]
</p></blockquote>
</li>

<li><p>Modify the column contents of Table 106 &mdash; &quot;Iterator requirements&quot;, 
23.3.5.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.iterators">[iterator.iterators]</a>, as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 106 &mdash; Iterator requirements</caption>

<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>

<tr>
<td><tt>*r</tt></td>
<td><tt>reference</tt></td>
<td><tt>&nbsp;</tt></td>
<td>pre: <tt>r</tt> is dereferenceable.</td>
</tr>

<tr>
<td><tt>++r</tt></td>
<td><tt>X&amp;</tt></td>
<td><tt>&nbsp;</tt></td>
<td><ins>pre: <tt>r</tt> is incrementable.</ins></td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify the column contents of Table 107 &mdash; &quot;Input iterator requirements&quot;, 
23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>, as indicated [<i>Rationale</i>: The wording changes attempt
to define a minimal "independent" set of operations, namely <tt>*a</tt> and <tt>++r</tt>, and 
to specify the semantics of the remaining ones. This approach seems to be in agreement with the 
original <a href="http://www.sgi.com/tech/stl/InputIterator.html">SGI specification</a> 
&mdash; <i>end rationale</i>]:</p>

<blockquote>
<table border="1">
<caption>Table 107 &mdash; Input iterator requirements (in addition to Iterator)</caption>

<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>

<tr>
<td><tt>a != b</tt></td>
<td>contextually<br/>
convertible to <tt>bool</tt></td>
<td><tt>!(a == b)</tt></td>
<td><del>pre: <tt>(a, b)</tt> is in the domain<br/>
of <tt>==</tt>.</del>
</td>
</tr>

<tr>
<td><tt>*a</tt></td>
<td>convertible to <tt>T</tt></td>
<td><tt>&nbsp;</tt></td>
<td>pre: <tt>a</tt> is dereferenceable.<br/>
The expression<br/>
<tt>(void)*a, *a</tt> is equivalent<br/>
to <tt>*a</tt>.<br/>
If <tt>a == b</tt> and <tt>(a,b)</tt> is in<br/>
the domain of <tt>==</tt> then <tt>*a</tt> is<br/>
equivalent to <tt>*b</tt>.
</td>
</tr>

<tr>
<td><tt>a-&gt;m</tt></td>
<td><tt>&nbsp;</tt></td>
<td><tt>(*a).m</tt></td>
<td><del>pre: <tt>a</tt> is dereferenceable.</del></td>
</tr>

<tr>
<td><tt>++r</tt></td>
<td><tt>X&amp;</tt></td>
<td><tt>&nbsp;</tt></td>
<td>pre: <tt>r</tt> is <del>dereferenceable</del><ins>incrementable</ins>.<br/>
post: <tt>r</tt> is dereferenceable or<br/>
<tt>r</tt> is past-the-end.<br/>
post: any copies of the<br/>
previous value of <tt>r</tt> are no<br/>
longer required either to be<br/>
dereferenceable<ins>, incrementable,</ins><br/>
or to be in the domain of <tt>==</tt>.
</td>
</tr>

<tr>
<td><tt>(void)r++</tt></td>
<td><tt>&nbsp;</tt></td>
<td><ins><tt>(void)++r</tt></ins></td>
<td><del>equivalent to <tt>(void)++r</tt></del></td>
</tr>

<tr>
<td><tt>*r++</tt></td>
<td>convertible to <tt>T</tt></td>
<td><tt>{ T tmp = *r;<br/>
++r;<br/>
return tmp; }
</tt></td>
<td><tt>&nbsp;</tt></td>
</tr>

</table>
</blockquote>
</li>

<li>
<p>Modify the column contents of Table 108 &mdash; &quot;Output iterator requirements&quot;, 
23.3.5.3 <a href="https://timsong-cpp.github.io/cppwp/output.iterators">[output.iterators]</a>, as indicated [<i>Rationale</i>: The wording changes attempt
to define a minimal "independent" set of operations, namely <tt>*r = o</tt> and <tt>++r</tt>,
and to specify the semantics of the remaining ones. This approach seems to be in agreement with
the original <a href="http://www.sgi.com/tech/stl/OutputIterator.html">SGI specification</a> 
&mdash; <i>end rationale</i>]:</p>

<blockquote>
<table border="1">
<caption>Table 108 &mdash; Output iterator requirements (in addition to Iterator)</caption>

<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>

<tr>
<td><tt>*r = o</tt></td>
<td>result is not used</td>
<td><tt>&nbsp;</tt></td>
<td><ins>pre: <tt>r</tt> is dereferenceable.</ins><br/>
<i>Remark</i>: After this operation<br/>
<tt>r</tt> is not required to be<br/>
dereferenceable <ins>and any copies of<br/>
the previous value of <tt>r</tt> are no<br/>
longer required to be dereferenceable<br/>
or incrementable.</ins><br/>
post: <tt>r</tt> is incrementable.
</td>
</tr>

<tr>
<td><tt>++r</tt></td>
<td><tt>X&amp;</tt></td>
<td><tt>&nbsp;</tt></td>
<td><ins>pre: <tt>r</tt> is incrementable.</ins><br/>
<tt>&amp;r == &amp;++r</tt>.<br/>
<del><i>Remark</i>: After this operation<br/>
<tt>r</tt> is not required to be<br/>
dereferenceable.<br/></del>
<ins><i>Remark</i>: After this operation<br/>
<tt>r</tt> is not required to be<br/>
incrementable and any copies of<br/>
the previous value of <tt>r</tt> are no<br/>
longer required to be dereferenceable<br/>
or incrementable.</ins><br/>
post: <tt>r</tt> is <ins>dereferenceable<br/>
or <tt>r</tt> is past-the-end</ins><del>incrementable</del>.<br/>
</td>
</tr>

<tr>
<td><tt>r++</tt></td>
<td>convertible to <tt>const X&amp;</tt></td>
<td><tt>{ X tmp = r;<br/>
  ++r;<br/>
  return tmp; }</tt>
</td>
<td><del><i>Remark</i>: After this operation<br/>
<tt>r</tt> is not required to be<br/>
dereferenceable.<br/>
post: <tt>r</tt> is incrementable.</del>
</td>
</tr>

<tr>
<td><tt>*r++ = o</tt></td>
<td>result is not used</td>
<td><ins><tt>{ *r = o; ++r; }</tt></ins></td>
<td><del><i>Remark</i>: After this operation<br/>
<tt>r</tt> is not required to be<br/>
dereferenceable.<br/>
post: <tt>r</tt> is incrementable.</del>
</td>
</tr>
</table>
</blockquote>
</li>

<li><p>Modify the column contents of Table 109 &mdash; &quot;Forward iterator requirements&quot;, 
23.3.5.4 <a href="https://timsong-cpp.github.io/cppwp/forward.iterators">[forward.iterators]</a>, as indicated [<i>Rationale</i>: Since the return type of the
expression <tt>*r++</tt> is now guaranteed to be type <tt>reference</tt>, the implied operational
semantics from input iterator based on value copies is wrong &mdash; <i>end rationale</i>]</p>

<blockquote>
<table border="1">
<caption>Table 109 &mdash; Forward iterator requirements (in addition to input iterator)</caption>

<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>

<tr>
<td><tt>r++</tt></td>
<td>convertible to <tt>const X&amp;</tt></td>
<td><tt>{ X tmp = r;<br/>
  ++r;<br/>
  return tmp; }</tt>
</td>
<td><tt>&nbsp;</tt></td>
</tr>

<tr>
<td><tt>*r++</tt></td>
<td>reference</td>
<td><ins><tt>{ reference tmp = *r;<br/>
 ++r;<br/> 
 return tmp; }</tt></ins></td>
<td><tt>&nbsp;</tt></td>
</tr>
</table>
</blockquote>

</li>

<li><p>Modify the column contents of Table 110 &mdash; &quot;Bidirectional iterator requirements&quot;, 
23.3.5.5 <a href="https://timsong-cpp.github.io/cppwp/bidirectional.iterators">[bidirectional.iterators]</a>, as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 110 &mdash; Bidirectional iterator requirements (in addition to forward iterator)</caption>

<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>

<tr>
<td><tt>--r</tt></td>
<td><tt>X&amp;</tt></td>
<td><tt>&nbsp;</tt></td>
<td>pre: there exists <tt>s</tt> such that<br/>
<tt>r == ++s</tt>.<br/>
post: <tt>r</tt> is <del>dereferenceable</del><ins>incrementable</ins>.<br/>
<tt>--(++r) == r</tt>.<br/>
<tt>--r == --s</tt> implies <tt>r == s</tt>.<br/>
<tt>&amp;r == &amp;--r</tt>.
</td>
</tr>

<tr>
<td><tt>r--</tt></td>
<td>convertible to <tt>const X&amp;</tt></td>
<td><tt>{ X tmp = r;<br/>
  --r;<br/>
  return tmp; }</tt>
</td>
<td><tt>&nbsp;</tt></td>
</tr>

<tr>
<td><tt>*r--</tt></td>
<td>reference</td>
<td><ins><tt>{ reference tmp = *r;<br/>
 --r;<br/> 
 return tmp; }</tt></ins></td>
<td><tt>&nbsp;</tt></td>
</tr>
</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2038" href="2038">2038.</a> Missing definition for <tt>incrementable</tt> iterator</h3>
<p><b>Section:</b> 23.3.5.3 <a href="https://timsong-cpp.github.io/cppwp/output.iterators">[output.iterators]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Pete Becker <b>Opened:</b> 2011-02-27 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#output.iterators">active issues</a> in [output.iterators].</p>
<p><b>View all other</b> <a href="lwg-index.html#output.iterators">issues</a> in [output.iterators].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>In comp.lang.c++, Vicente Botet raises the following questions:</p>

<blockquote><p>
&quot;In "24.2.4 Output iterators" there are 3 uses of incrementable. I've
not found the definition. Could some one point me where it is defined?
<p/>
Something similar occurs with dereferenceable. While the definition is
given in "24.2.1 In general" it is used several times before.
<p/>
Shouldn't these definitions be moved to some previous section?&quot;
</p></blockquote>

<p>He's right: both terms are used without being properly defined.
<p/>
There is no definition of "incrementable".
<p/>
While there is a definition of "dereferenceable", it is, in fact, a definition of 
"dereferenceable iterator". "dereferenceable" is used throughout Clause 23 (Containers) 
before its definition in Clause 24. In almost all cases it's referring to iterators, 
but in 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a> there is a mention of "dereferenceable object"; in 
16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> the table of Descriptive variable definitions refers to a 
"dereferenceable pointer"; 20.10.3.2 <a href="https://timsong-cpp.github.io/cppwp/pointer.traits.functions">[pointer.traits.functions]</a> refers to a 
"dereferenceable pointer"; in 28.4.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get.virtuals">[locale.time.get.virtuals]</a>&#47;11 (<tt>do_get</tt>) 
there is a requirement that a pointer "shall be dereferenceable". In those specific cases 
it is not defined.
</p>

<p><i>[2011-03-02: Daniel comments:]</i></p>


<p>I believe that the currently proposed resolution of issue <a href="2035">2035</a> solves this
issue as well.</p>

<p><i>[
2011 Bloomington
]</i></p>


<p>
Agree with Daniel, this will be handled by the resolution of <a href="2035">2035</a>.
</p>



<p><b>Proposed resolution:</b></p>
<p></p>





<hr>
<h3><a name="2077" href="2077">2077.</a> Further incomplete constraints for type traits</h3>
<p><b>Section:</b> 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2011-08-20 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.unary.prop">active issues</a> in [meta.unary.prop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.unary.prop">issues</a> in [meta.unary.prop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The currently agreed on proposed wording for <a href="2015">2015</a> using 
<tt>remove_all_extents&lt;T&gt;::type</tt> instead of the "an array of 
unknown bound" terminology in the precondition should be extended to 
some further entries especially in Table 49, notably the 
<tt>is_*constructible</tt>, <tt>is_*assignable</tt>, and 
<tt>is_*destructible</tt> entries. To prevent ODR violations, incomplete
element types of arrays must be excluded for value-initialization and
destruction for example. Construction and assignment has to be honored, 
when we have array-to-pointer conversions or pointer conversions of
incomplete pointees in effect.
</p>

<p><i>[2012, Kona]</i></p>

<p>
The issue is that in three type traits, we are accidentally saying that in certain
circumstances the type must give a specified answer when given an incomplete type.
(Specifically: an array of unknown bound of incomplete type.)  The issue asserts
that there's an ODR violation, since the trait returns false in that case but might
return a different version when the trait is completed.
</p>
<p>
Howard argues: no, there is no risk of an ODR violation.
<tt>is_constructible&lt;A[]></tt> must return <tt>false</tt> regardless of whether
<tt>A</tt> is complete, so there's no reason to forbid an array of unknown bound of
incomplete types. Same argument applies to <tt>is_assignable</tt>. General agreement
with Howard's reasoning.
</p>
<p>
There may be a real issue for <tt>is_destructible</tt>. None of us are sure what
<tt>is_destructible</tt> is supposed to mean for an array of unknown bound
(regardless of whether its type is complete), and the standard doesn't make it clear.
The middle column doesn't say what it's supposed to do for incomplete types.
</p>
<p>
In at least one implementation, <tt>is_destructible&lt;A[]></tt> does return <tt>true</tt>
if <tt>A</tt> is complete, which would result in ODR violation unless we forbid it for
incomplete types.
</p>
<p>
Move to open. We believe there is no issue for <tt>is_constructible</tt> or
<tt>is_assignable</tt>, but that there is a real issue for <tt>is_destructible</tt>.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2088" href="2088">2088.</a> <tt>std::terminate</tt> problem</h3>
<p><b>Section:</b> 17.9.4 <a href="https://timsong-cpp.github.io/cppwp/exception.terminate">[exception.terminate]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2011-09-25 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
Andrzej Krzemienski reported the following on comp.std.c++:
</p>
<blockquote>
<p>
In N3290, which is to become the official standard, in 17.9.4.4 <a href="https://timsong-cpp.github.io/cppwp/terminate">[terminate]</a>,
paragraph 1 reads
</p>
<blockquote><p>
<i>Remarks</i>: Called by the implementation when exception handling must
be abandoned for any of several reasons (15.5.1), in effect immediately after 
evaluating the <em>throw-expression</em> (18.8.3.1). May also be called directly by the 
program.
</p></blockquote>
<p>It is not clear what is "in effect". It was clear in previous drafts where paragraphs 
1 and 2 read:
</p>
<blockquote><p>
Called by the implementation when exception handling must be
abandoned for any of several reasons (15.5.1). May also be called directly
by the program.
<p/>
<i>Effects</i>: Calls the <tt>terminate_handler</tt> function in effect
immediately after evaluating the <em>throw-expression</em> (18.8.3.1), if called by the
implementation, or calls the current <tt>terminate_handler</tt> function,
if called by the program.
</p>
</blockquote>
<p>
It was changed by N3189. The same applies to function unexpected (D. 11.4, paragraph 1).
<p/>
Assuming the previous wording is still intended, the wording can be read
"unless <tt>std::terminate</tt> is called by the program, we will use the handler
that was in effect immediately after evaluating the throw-expression".
<p/>
  This assumes that there is some throw-expression connected to every
  situation that triggers the call to <tt>std::terminate</tt>. But this is not
  the case:
</p>
<ul>
<li>
  In case <tt>std::thread</tt> is assigned to or destroyed while being joinable
  there is no throw-expression involved.
</li>
<li>
  In case <tt>std::unexpected</tt> is called by the program, <tt>std::terminate</tt> is
  triggered by the implementation - no throw-expression involved.
</li>
<li>
  In case a destructor throws during stack unwinding we have two throw-expressions 
  involved.
 </li>
 </ul>
<p>
Which one is referred to?
<p/>
In case <tt>std::nested_exception::rethrow_nested</tt> is called for an object that has 
captured no exception, there is no throw-expression involved directly (and may no throw 
be involved even indirectly).
<p/>
Next, 17.9.4.1 <a href="https://timsong-cpp.github.io/cppwp/terminate.handler">[terminate.handler]</a>, paragraph 2 says 
</p>
<blockquote><p>
<i>Required behavior</i>: A <tt>terminate_handler</tt> shall terminate execution
of the program without returning to the caller.
</p></blockquote>
<p>
This seems to allow that the function may exit by throwing an
exception (because word "return" implies a normal return).
<p/>
One could argue that words "terminate execution of the program" are sufficient,
but then why "without returning to the caller" would be mentioned. In
case such handler throws, noexcept specification in function <tt>std::terminate</tt> 
is violated, and <tt>std::terminate</tt> would be called recursively - should 
<tt>std::abort</tt> not be called in case of recursive <tt>std::terminate</tt> 
call? On the other hand some controlled recursion could be useful, like in the 
<a href="http://cplusplus.co.il/2010/03/21/catching-uncaught-exceptions-within-terminate/">following technique</a>.
</p>
</blockquote>

<p>
The here mentioned wording changes by N3189 in regard to 17.9.4.4 <a href="https://timsong-cpp.github.io/cppwp/terminate">[terminate]</a> p1 
were done for a better separation of effects (Effects element) and additional normative 
wording explanations (Remarks element), there was no meaning change intended. Further,
there was already a defect existing in the previous wording, which was not updated when 
further situations where defined, when <tt>std::terminate</tt> where supposed to be 
called by the implementation. 
<p/>
The part
<p/>
"in effect immediately after evaluating the throw-expression"
<p/>
should be removed and the quoted reference to 17.9.4.1 <a href="https://timsong-cpp.github.io/cppwp/terminate.handler">[terminate.handler]</a> 
need to be part of the effects element where it refers to the current <tt>terminate_handler</tt> 
function, so should be moved just after
<p/>
"Effects: Calls the current <tt>terminate_handler</tt> function."
<p/>
It seems ok to allow a termination handler to exit via an exception, but the 
suggested idiom should better be replaced by a more simpler one based on
evaluating the current exception pointer in the terminate handler, e.g.
</p>
<blockquote><pre>
void our_terminate (void) {
  std::exception_ptr p = std::current_exception();
  if (p) {
    ... // OK to rethrow and to determine it's nature
  } else {
    ... // Do something else
  }
}
</pre></blockquote>

<p><i>[2011-12-09: Daniel comments]</i></p>


<p>
A related issue is <a href="2111">2111</a>.
</p>


<p><i>[2012, Kona]</i></p>

<p>
Move to Open.
</p>
<p>
There is an interaction with Core issues in this area that Jens is already supplying wording
for.  Review this issue again once Jens wording is available.
</p>
<p>
Alisdair to review clause 15.5 (per Jens suggestion) and recommend any changes, then integrate
Jens wording into this issue.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2095" href="2095">2095.</a> <tt>promise</tt> and <tt>packaged_task</tt> missing constructors needed for uses-allocator construction</h3>
<p><b>Section:</b> 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a>, 32.9.10 <a href="https://timsong-cpp.github.io/cppwp/futures.task">[futures.task]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2011-11-01 <b>Last modified:</b> 2019-06-03 09:53:50 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#futures.promise">active issues</a> in [futures.promise].</p>
<p><b>View all other</b> <a href="lwg-index.html#futures.promise">issues</a> in [futures.promise].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>

<p>
This example is ill-formed according to C++11 because <tt>uses_allocator&lt;promise&lt;R&gt;, A&gt;::value</tt> is true, but
<tt>is_constructible&lt;promise&lt;R&gt;, A, promise&lt;R&gt;&amp;&amp;&gt;::value</tt> is false. Similarly for <tt>packaged_task</tt>.
</p>
<blockquote><pre>
#include &lt;future&gt;
#include &lt;memory&gt;
#include &lt;tuple&gt;

using namespace std;

typedef packaged_task&lt;void()&gt; task;
typedef promise&lt;void&gt; prom;
allocator&lt;task&gt; a;

tuple&lt;task, prom&gt; t1{ allocator_arg, a };
tuple&lt;task, prom&gt; t2{ allocator_arg, a, task{}, prom{} };
</pre></blockquote>

<p><i>[2012, Portland]</i></p>

<p>
This is an allocator issue, and should be dealt with directly by LWG.
</p>

<p><i>[2013-03-06]</i></p>


<p>
Jonathan suggests to make the new constructors non-explicit and makes some representational improvements.
</p>


<p><i>[2013-09 Chicago]</i></p>

<p>
Move to deferred.
</p>
<p>
This issue has much in common with similar problems with <tt>std::function</tt> that are being addressed
by the polymorphic allocators proposal currently under evaluation in LEWG.  Defer further discussion on
this topic until the final outcome of that paper and its proposed resolution is known.
</p>

<p><i>[2014-02-20 Re-open Deferred issues as Priority 4]</i></p>


<p><i>[2016-08 Chicago]</i></p>

<p>Fri PM: Send to LEWG  - and this also applies to <tt>function</tt> in LFTS.</p>

<p><i>[2019-06-03 Jonathan Wakely provides updated wording]</i></p>

<p>Jonathan updates wording post-<a href="2976">2976</a>
and observes that this resolution conflicts with <a href="3003">3003</a>.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p><i>[This wording is relative to the FDIS.]</i></p>


<ol>
<li><p>Add to 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a>, class template <tt>promise</tt> synopsis, 
as indicated:</p>

<blockquote><pre>
namespace std {
  template &lt;class R&gt;
  class promise {
  public:
    promise();
    template &lt;class Allocator&gt;
    promise(allocator_arg_t, const Allocator&amp; a);
    <ins>template &lt;class Allocator&gt;
    promise(allocator_arg_t, const Allocator&amp; a, promise&amp;&amp; rhs) noexcept;</ins>
    promise(promise&amp;&amp; rhs) noexcept;
    promise(const promise&amp; rhs) = delete;
    ~promise();	
    [&hellip;]
  };
  [&hellip;]
}
</pre></blockquote>
</li>

<li><p>Change 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a> as indicated:</p>

<blockquote><pre>
promise(promise&amp;&amp; rhs) noexcept;
<ins>template &lt;class Allocator&gt;
promise(allocator_arg_t, const Allocator&amp; a, promise&amp;&amp; rhs) noexcept;</ins>
</pre><blockquote>
<p>
-5- <i>Effects</i>: constructs a new <tt>promise</tt> object and transfers ownership of 
the shared state of <tt>rhs</tt> (if any) to the newly-constructed object.
<p/>
-6- <i>Postcondition</i>: <tt>rhs</tt> has no shared state.
<p/>
<ins>-?- [<i>Note</i>: <tt>a</tt> is not used &mdash; <i>end note</i>]</ins>
</p>
</blockquote></blockquote>

</li>

<li><p>Add to 32.9.10 <a href="https://timsong-cpp.github.io/cppwp/futures.task">[futures.task]</a>, class template <tt>packaged_task</tt> synopsis, 
as indicated:</p>

<blockquote><pre>
namespace std {
  template&lt;class&gt; class packaged_task; // <i>undefined</i>

  template&lt;class R, class... ArgTypes&gt;
  class packaged_task&lt;R(ArgTypes...)&gt; {
  public:
    // construction and destruction
    packaged_task() noexcept;
    <ins>template &lt;class Allocator&gt;
      packaged_task(allocator_arg_t, const Allocator&amp; a) noexcept;</ins>
    template &lt;class F&gt;
      explicit packaged_task(F&amp;&amp; f);
    template &lt;class F, class Allocator&gt;
      explicit packaged_task(allocator_arg_t, const Allocator&amp; a, F&amp;&amp; f);
    ~packaged_task();
	
    // no copy
    packaged_task(const packaged_task&amp;) = delete;
    <ins>template&lt;class Allocator&gt;
      packaged_task(allocator_arg_t, const Allocator&amp; a, const packaged_task&amp;) = delete;</ins>
    packaged_task&amp; operator=(const packaged_task&amp;) = delete;
    
    // move support
    packaged_task(packaged_task&amp;&amp; rhs) noexcept;
    <ins>template &lt;class Allocator&gt;
      packaged_task(allocator_arg_t, const Allocator&amp; a, packaged_task&amp;&amp; rhs) noexcept;</ins>
    packaged_task&amp; operator=(packaged_task&amp;&amp; rhs) noexcept;
    void swap(packaged_task&amp; other) noexcept;
    [&hellip;]
  };
  [&hellip;]
}
</pre></blockquote>
</li>

<li><p>Change 32.9.10.1 <a href="https://timsong-cpp.github.io/cppwp/futures.task.members">[futures.task.members]</a> as indicated:</p>

<blockquote><pre>
packaged_task() noexcept;
<ins>template &lt;class Allocator&gt;
  packaged_task(allocator_arg_t, const Allocator&amp; a) noexcept;</ins>
</pre><blockquote>
<p>
-1- <i>Effects</i>: constructs a <tt>packaged_task</tt> object with no shared state and no stored task.
<p/>
<ins>-?- [<i>Note</i>: <tt>a</tt> is not used &mdash; <i>end note</i>]</ins>
</p>
</blockquote></blockquote>
<p>[&hellip;]</p>
<blockquote><pre>
packaged_task(packaged_task&amp;&amp; rhs) noexcept;
<ins>template &lt;class Allocator&gt;
  packaged_task(allocator_arg_t, const Allocator&amp; a, packaged_task&amp;&amp; rhs) noexcept;</ins>
</pre><blockquote>
<p>
-5- <i>Effects</i>: constructs a new <tt>packaged_task</tt> object and transfers ownership of <tt>rhs</tt>'s 
shared state to <tt>*this</tt>, leaving <tt>rhs</tt> with no shared state. Moves the stored task from <tt>rhs</tt> 
to <tt>*this</tt>.
<p/>
-6- <i>Postcondition</i>: <tt>rhs</tt> has no shared state.
<p/>
<ins>-?- [<i>Note</i>: <tt>a</tt> is not used &mdash; <i>end note</i>]</ins>
</p>
</blockquote></blockquote>

</li>
</ol>

</blockquote>



<p><b>Proposed resolution:</b></p>
<p><i>[This wording is relative to N4810.]</i></p>


<ol>
<li><p>Add to 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a>, class template <tt>promise</tt> synopsis,
as indicated:</p>

<blockquote><pre>
namespace std {
  template &lt;class R&gt;
  class promise {
  public:
    promise();
    template &lt;class Allocator&gt;
      promise(allocator_arg_t, const Allocator&amp; a);
    <ins>template &lt;class Allocator&gt;
      promise(allocator_arg_t, const Allocator&amp; a, promise&amp;&amp; rhs) noexcept;</ins>
    promise(promise&amp;&amp; rhs) noexcept;
    promise(const promise&amp; rhs) = delete;
    ~promise();
    [&hellip;]
  };
  [&hellip;]
}
</pre></blockquote>
</li>

<li><p>Change 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a> as indicated:</p>

<blockquote><pre>
promise(promise&amp;&amp; rhs) noexcept;
<ins>template &lt;class Allocator&gt;
  promise(allocator_arg_t, const Allocator&amp; a, promise&amp;&amp; rhs) noexcept;</ins>
</pre><blockquote>
<p>
-5- <i>Effects</i>: constructs a new <tt>promise</tt> object and transfers ownership of
the shared state of <tt>rhs</tt> (if any) to the newly-constructed object.
<p/>
-6- <i>Postcondition</i>: <tt>rhs</tt> has no shared state.
<p/>
<ins>-?- [<i>Note</i>: <tt>a</tt> is not used &mdash; <i>end note</i>]</ins>
</p>
</blockquote></blockquote>

</li>
</ol>





<hr>
<h3><a name="2114" href="2114">2114.</a> Incorrect "<em>contextually</em> convertible to <tt>bool</tt>" requirements</h3>
<p><b>Section:</b> 16.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/nullablepointer.requirements">[nullablepointer.requirements]</a>, 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>, 23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a>, 25.1 <a href="https://timsong-cpp.github.io/cppwp/algorithms.general">[algorithms.general]</a>, 25.7 <a href="https://timsong-cpp.github.io/cppwp/alg.sorting">[alg.sorting]</a>, 32.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.req.paramname">[thread.req.paramname]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2011-12-09 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
As of 16.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/utility.arg.requirements">[utility.arg.requirements]</a> Table 17&#47;18, the return types of the expressions
</p>
<blockquote><pre>
a == b
</pre></blockquote>
<p>
or
</p>
<blockquote><pre>
a &lt; b
</pre></blockquote>
<p>
for types satisfying the <tt>EqualityComparable</tt> or <tt>LessThanComparable</tt>
types, respectively, are required to be "convertible to <tt>bool</tt>" which corresponds to
a copy-initialization context. But several newer parts of the library that refer to 
such contexts have lowered the requirements taking  advantage of the new terminology of 
"<em>contextually</em> convertible to <tt>bool</tt>" instead, which corresponds to a 
direct-initialization context (In addition to "normal" direct-initialization constructions, 
operands of logical operations as well as <tt>if</tt> or <tt>switch</tt> conditions also 
belong to this special context).
<p/>
One example for these new requirements are input iterators which satisfy <tt>EqualityComparable</tt> 
but also specify that the expression
</p>
<blockquote><pre>
a != b
</pre></blockquote>
<p>
shall be just "<strong>contextually</strong> convertible to <tt>bool</tt>". The same discrepancy 
exists for requirement set <tt>NullablePointer</tt> in regard to several equality-related expressions.
<p/>
For random access iterators we have
</p>
<blockquote><p>
<tt>a &lt; b</tt>      contextually convertible to <tt>bool</tt>
</p></blockquote>
<p>
as well as for all derived comparison functions, so strictly speaking we could have a random access 
iterator that does not satisfy the <tt>LessThanComparable</tt> requirements, which looks like an
artifact to me.
<p/>
Even if we keep with the existing requirements based on <tt>LessThanComparable</tt> or
<tt>EqualityComparable</tt> we still would have the problem that some current specifications 
are actually  based on the assumption of implicit convertibility instead of "explicit convertibility", e.g. 
20.11.1.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.special">[unique.ptr.special]</a> p3:
</p>
<blockquote><pre>
template &lt;class T1, class D1, class T2, class D2&gt;
bool operator!=(const unique_ptr&lt;T1, D1&gt;&amp; x, const unique_ptr&lt;T2, D2&gt;&amp; y);
</pre>
<blockquote>
<p>
-3- <i>Returns</i>: <tt>x.get() != y.get()</tt>.
</p>
</blockquote></blockquote>
<p>
Similar examples exist in 20.11.1.2.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.dtor">[unique.ptr.single.dtor]</a> p2, 20.11.1.2.3 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.asgn">[unique.ptr.single.asgn]</a> p9,
20.11.1.2.4 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.observers">[unique.ptr.single.observers]</a> p1+3+8, etc.
<p/>
In all these places the expressions involving comparison functions (but <em>not</em> those of the conversion 
of a <tt>NullablePointer</tt> to <tt>bool</tt>!) assume to be "convertible to <tt>bool</tt>". I think this
is a very natural assumption and all delegations of the comparison functions of some type <tt>X</tt> to some
other API type <tt>Y</tt> in third-party code does so assuming that copy-initialization semantics will
just work.
<p/>
The actual reason for using the newer terminology can be rooted back to LWG <a href="556">556</a>. My hypotheses 
is that the resolution of that issue also needs a slight correction. Why so?
<p/>
The reason for opening that issue were worries based on the previous "convertible to <tt>bool</tt>"
wording. An expressions like "<tt>!pred(a, b)</tt>" might not be well-formed in those situations, because
<tt>operator!</tt> might not be accessible or might have an unusual semantics (and similarly for other logical
operations). This can indeed happen with unusual proxy return types, so the idea was that the evaluation of 
<tt>Predicate</tt>, <tt>BinaryPredicate</tt> (25.1 <a href="https://timsong-cpp.github.io/cppwp/algorithms.general">[algorithms.general]</a> p8+9), and <tt>Compare</tt> 
(25.7 <a href="https://timsong-cpp.github.io/cppwp/alg.sorting">[alg.sorting]</a> p2) should be defined based on contextual conversion to <tt>bool</tt>. 
Unfortunately this <em>alone</em> is not sufficient: In addition, I think, we <em>also</em> want the predicates 
to be (implicitly) convertible to <tt>bool</tt>! Without this wording, several conditions are plain wrong, 
e.g. 25.5.5 <a href="https://timsong-cpp.github.io/cppwp/alg.find">[alg.find]</a> p2, which talks about "<tt>pred(*i) != false</tt>" (<tt>find_if</tt>) and 
"<tt>pred(*i) == false</tt>" (<tt>find_if_not</tt>). These expressions are not within a boolean context! 
<p/>
While we could simply fix all these places by proper wording to be considered in a "contextual conversion to
<tt>bool</tt>", I think that this is not the correct solution: Many third-party libraries already refer to
the previous C++03 <tt>Predicate</tt> definition &mdash; it actually predates C++98 and is as old as the 
<a href="http://www.sgi.com/tech/stl/Predicate.html">SGI specification</a>. It seems to be a high price to
pay to switch to direct initialization here instead of fixing a completely different specification problem.
<p/>
A final observation is that we have another definition for a <tt>Predicate</tt> in 32.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.req.paramname">[thread.req.paramname]</a> p2:
</p>
<blockquote><p>
If a parameter is <tt>Predicate</tt>, <tt>operator()</tt> applied to the actual template argument shall return a value that
is convertible to <tt>bool</tt>.
</p></blockquote>
<p>
The problem here is not that we have two different definitions of <tt>Predicate</tt> in the standard &mdash; this 
is confusing, but this fact alone is not a defect. The first (minor) problem is that this definition does not properly 
apply to function objects that are function pointers, because <tt>operator()</tt> is not defined in a strict sense. 
But the actually worse second problem is that this wording has the very <tt>same</tt> problem that has originally lead to
LWG <a href="556">556</a>! We only need to look at 32.6.3 <a href="https://timsong-cpp.github.io/cppwp/thread.condition.condvar">[thread.condition.condvar]</a> p15 to recognice this:
</p>
<blockquote><pre>
while (!pred())
  wait(lock);
</pre></blockquote>
<p>
The negation expression here looks very familiar to the example provided in LWG <a href="556">556</a> and is sensitive
to the same "unusual proxy" problem. Changing the 32.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.req.paramname">[thread.req.paramname]</a> wording to a corresponding
"contextual conversion to <tt>bool</tt>" wouldn't work either, because existing specifications rely on "convertible
to <tt>bool</tt>", e.g. 32.6.3 <a href="https://timsong-cpp.github.io/cppwp/thread.condition.condvar">[thread.condition.condvar]</a> p32+33+42 or 32.6.4 <a href="https://timsong-cpp.github.io/cppwp/thread.condition.condvarany">[thread.condition.condvarany]</a> 
p25+26+32+33.
<p/>
To summarize: I believe that LWG <a href="556">556</a> was not completely resolved. A pessimistic interpretation is,
that even with the current wording based on "contextually convertible to <tt>bool</tt>" the actual problem of that 
issue has <em>not</em> been fixed. What actually needs to be required here is some normative wording that basically
expresses something along the lines of:
</p>
<blockquote><p>
The semantics of <em>any</em> contextual conversion to <tt>bool</tt> shall be equivalent to the semantics of 
any implicit conversion to <tt>bool</tt>.
</p></blockquote>
<p>
This is still not complete without having concepts, but it seems to be a better approximation. Another way of solving
this issue would be to define a minimum requirements table with equivalent semantics. The proposed wording is a bit
simpler but attempts to express the same thing.
</p>

<p><i>[2012, Kona]</i></p>

<p>
Agree with Daniel that we potentially broke some C++03 user code, accept the changes striking
"contextually" from tables.  Stefan to provide revised wording for section 25, and figure out
changes to section 30.
</p>
<p>
Move to open, and then to Review when updated wording from Stefan is available.
</p>

<p><i>[2012-10-12, STL comments]</i></p>


<ol>
<li>
<p>
The current proposed resolution still isn't completely satisfying. It would certainly be possible for the Standard to 
require these various expressions to be implicitly and contextually convertible to <tt>bool</tt>, but that would have 
a subtle consequence (which, I will argue, is undesirable - regardless of the fact that it dates all the way back to 
C++98/03). It would allow users to provide really wacky types to the Standard Library, with one of two effects:
</p>
<ol style="list-style-type:upper-alpha">
<li>
<p>Standard Library implementations would have to go to great lengths to respect such wacky types, essentially using 
<tt>static_cast&lt;bool&gt;</tt> when invoking any predicates or comparators.
</p>
</li>

<li>
<p>
Otherwise, such wacky types would be de facto nonportable, because they would make Standard Library implementations 
explode.
</p>
</li>
</ol>

<p>
Effect B is the status quo we're living with today. What Standard Library implementations want to do with <tt>pred(args)</tt> 
goes beyond "<tt>if (pred(args))</tt>" (C++03), contextually converting <tt>pred(args)</tt> to <tt>bool</tt> (C++11), or 
implicitly and contextually converting <tt>pred(args)</tt> to <tt>bool</tt> (the current proposed resolution). 
Implementations want to say things like:
</p>

<blockquote><pre>
if (pred(args))
if (!pred(args))
if (cond &amp;&amp; pred(args))
if (cond &amp;&amp; !pred(args))
</pre></blockquote>

<p>
These are real examples taken from Dinkumware's implementation. There are others that would be realistic 
("<tt>pred(args) &amp;&amp; cond</tt>", "<tt>cond || pred(args)</tt>", etc.)
<p/>
Although negation was mentioned in this issue's Discussion section, and in LWG <a href="556">556</a>'s, the current proposed 
resolution doesn't fix this problem. Requiring <tt>pred(args)</tt> to be implicitly and contextually convertible to <tt>bool</tt> 
doesn't prevent <tt>operator!()</tt> from being overloaded and returning <tt>std::string</tt> (as a wacky example). More 
ominously, it doesn't prevent <tt>operator&amp;&amp;()</tt> and <tt>operator||()</tt> from being overloaded and destroying 
short-circuiting.
</p>

</li>

<li>
<p>
I would like LWG input before working on Standardese for a new proposed resolution. Here's an outline of what I'd like to 
do:
</p>
<ol style="list-style-type:upper-alpha">
<li>
<p>
Introduce a new "concept" in 16.5.3 <a href="https://timsong-cpp.github.io/cppwp/utility.requirements">[utility.requirements]</a>, which I would call <tt>BooleanTestable</tt> in the 
absence of better ideas.
</p>
</li>

<li>
<p>
Centralize things and reduce verbosity by having everything simply refer to <tt>BooleanTestable</tt> when necessary. 
I believe that the tables could say "Return type: <tt>BooleanTestable</tt>", while Predicate/BinaryPredicate/Compare 
would need the incantation "shall satisfy the requirements of BooleanTestable".
</p>
</li>

<li>
<p>
Resolve the tug-of-war between users (who occasionally want to do weird things) and implementers (who don't want to have 
to contort their code) by requiring that:
</p>
<ol style="list-style-type:upper-roman">
<li>
<p>
Given a <tt>BooleanTestable x</tt>, <tt>x</tt> is both implicitly and contextually convertible to <tt>bool</tt>.
</p>
</li>

<li>
<p>
Given a <tt>BooleanTestable x</tt>, <tt>!x</tt> is <tt>BooleanTestable</tt>. (This is intentionally "recursive".)
</p>
</li>

<li>
<p>
Given a <tt>BooleanTestable x</tt>, <tt>bool t = x, t2(x), f = !x;</tt> has the postcondition <tt>t == t2 &amp;&amp; t != f</tt>.
</p>
</li>

<li>
<p>
Given a <tt>BooleanTestable x</tt> and a <tt>BooleanTestable y</tt> of possibly different types, "<tt>x &amp;&amp; y</tt>" 
and "<tt>x || y</tt>" invoke the built-in <tt>operator&amp;&amp;()</tt> and <tt>operator||()</tt>, triggering short-circuiting.
</p>
</li>

<li>
<p>
<tt>bool</tt> is <tt>BooleanTestable</tt>.
</p>
</li>
</ol>

</li>

</ol>

<p>
 I believe that this simultaneously gives users great latitude to use types other than <tt>bool</tt>, while allowing 
 implementers to write reasonable code in order to get their jobs done. (If I'm forgetting anything that implementers 
 would want to say, please let me know.)
</p>

</li>

<li>
<p>
About requirement (I): As Daniel patiently explained to me, we need to talk about both implicit conversions and 
contextual conversions, because it's possible for a devious type to have both "<tt>explicit operator bool()</tt>" 
and "<tt>operator int()</tt>", which might behave differently (or be deleted, etc.).
</p>
</li>

<li>
<p>
About requirement (IV): This is kind of tricky. What we'd like to say is, "<tt>BooleanTestable</tt> can't ever trigger 
an overloaded logical operator". However, given a perfectly reasonable type <tt>Nice</tt> - perhaps even <tt>bool</tt> itself! - 
other code (perhaps a third-party library) could overload <tt>operator&amp;&amp;(Nice, Evil)</tt>. Therefore, I believe 
that the requirement should be "no first use" - the Standard Library will ask for various <tt>BooleanTestable</tt> types 
from users (for example, the result of "<tt>first != last</tt>" and the result of "<tt>pred(args)</tt>"), and as long 
as they don't trigger overloaded logical operators with each other, everything is awesome.
</p>
</li>


<li>
<p>
About requirement (V): This is possibly redundant, but it's trivial to specify, makes it easier for users to understand 
what they need to do ("oh, I can always achieve this with <tt>bool</tt>"), and provides a "base case" for requirement 
(IV) that may or may not be necessary.  Since <tt>bool</tt> is <tt>BooleanTestable</tt>, overloading 
<tt>operator&amp;&amp;(bool, Other)</tt> (etc.) clearly makes the <tt>Other</tt> type non-<tt>BooleanTestable</tt>.
</p>
</li>
</ol>

<strong>Previous resolution from Daniel [SUPERSEDED]:</strong>
<p/>
<blockquote class="note">
<p>This wording is relative to the FDIS.</p>

<ol>
<li><p>Change Table 25 &mdash; "<tt>NullablePointer</tt> requirements" in 16.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/nullablepointer.requirements">[nullablepointer.requirements]</a>
as indicated:</p>

<table border="1">
<caption>Table 25 &mdash; <tt>NullablePointer</tt> requirements</caption>
<tr align="center">
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
</tr> 

<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>a != b</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>!(a == b)</tt>
</td>
</tr>

<tr>
<td>
<tt>a == np<br/>
np == a</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>a == P()</tt>
</td>
</tr>

<tr>
<td>
<tt>a != np<br/>
np != a</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>!(a == np)</tt>
</td>
</tr>

</table>
 
</li>

<li><p>Change Table 107 &mdash; "Input iterator requirements" in 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>
as indicated:</p>

<table border="1">
<caption>Table 107 &mdash; Input iterator requirements (in addition to Iterator)</caption>
<tr align="center">
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr> 

<tr>
<td>
<tt>a != b</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>!(a == b)</tt>
</td>
<td>
pre: <tt>(a, b)</tt> is in the domain of <tt>==</tt>.
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

</table>
 
</li>

<li><p>Change Table 111 &mdash; "Random access iterator requirements" in 23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a>
as indicated:</p>

<table border="1">
<caption>Table 111 &mdash; Random access iterator requirements (in addition to bidirectional iterator)</caption>
<tr align="center">
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr> 

<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>a &lt; b</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>b - a &gt; 0</tt>
</td>
<td>
<tt>&lt;</tt> is a total ordering relation
</td>
</tr>

<tr>
<td>
<tt>a &gt; b</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>b &lt; a</tt>
</td>
<td>
<tt>&gt;</tt> is a total ordering relation opposite to <tt>&lt;</tt>.
</td>
</tr>

<tr>
<td>
<tt>a &gt;= b</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>!(a &lt; b)</tt>
</td>
<td>
</td>
</tr>

<tr>
<td>
<tt>a &lt;= b</tt>
</td>
<td>
<del>contextually</del> convertible to <tt>bool</tt>
</td>
<td>
<tt>!(a &gt; b)</tt>
</td>
<td>
</td>
</tr>

</table>
 
</li>

<li><p>Change 25.1 <a href="https://timsong-cpp.github.io/cppwp/algorithms.general">[algorithms.general]</a> p8+9 as indicated:</p>

<blockquote>
<p>
-8- The <tt>Predicate</tt> parameter is used whenever an algorithm expects a function object 
(20.14 <a href="https://timsong-cpp.github.io/cppwp/function.objects">[function.objects]</a>) that, when applied to the result of dereferencing the corresponding iterator, 
returns a value testable as <tt>true</tt>. In other words, if an algorithm takes <tt>Predicate pred</tt> 
as its argument and first as its iterator argument, it should work correctly in the construct 
<tt>pred(*first)</tt> <ins>implicitly or</ins> contextually converted to <tt>bool</tt> (Clause 7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>). 
The function object <tt>pred</tt> shall not apply any non-constant function through the dereferenced iterator.
<p/>
-9- The <tt>BinaryPredicate</tt> parameter is used whenever an algorithm expects a function object that when applied
to the result of dereferencing two corresponding iterators or to dereferencing an iterator and type
<tt>T</tt> when <tt>T</tt> is part of the signature returns a value testable as <tt>true</tt>. In other words, if an algorithm takes
<tt>BinaryPredicate binary_pred</tt> as its argument and <tt>first1</tt> and <tt>first2</tt> as its iterator arguments, it should
work correctly in the construct <tt>binary_pred(*first1, *first2)</tt> <ins>implicitly or</ins> contextually converted to 
<tt>bool</tt> (Clause 7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>).
<tt>BinaryPredicate</tt> always takes the first iterator's <tt>value_type</tt> as its first argument, that is, in those cases
when <tt>T</tt> value is part of the signature, it should work correctly in the construct <tt>binary_pred(*first1, value)</tt> 
<ins>implicitly or</ins> contextually converted to <tt>bool</tt> (Clause 7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>). <tt>binary_pred</tt> shall 
not apply any non-constant function through the dereferenced iterators.
</p>
</blockquote>
</li>

<li><p>Change 25.7 <a href="https://timsong-cpp.github.io/cppwp/alg.sorting">[alg.sorting]</a> p2 as indicated:</p>

<blockquote>
<p>
-2- <tt>Compare</tt> is a function object type (20.14 <a href="https://timsong-cpp.github.io/cppwp/function.objects">[function.objects]</a>). The return value of the function 
call operation applied to an object of type <tt>Compare</tt>, when <ins>implicitly or</ins> contextually converted 
to <tt>bool</tt> (7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>), yields <tt>true</tt> if the first argument of the call is less than the second, and 
<tt>false</tt> otherwise. <tt>Compare comp</tt> is used throughout for algorithms assuming an ordering relation. It is assumed 
that <tt>comp</tt> will not apply any non-constant function through the dereferenced iterator.
</p>
</blockquote>
</li>

<li><p>Change 32.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.req.paramname">[thread.req.paramname]</a> p2 as indicated:</p>

<blockquote>
<p>
-2- <del>If a parameter is <tt>Predicate</tt>, operator() applied to the actual template argument shall return a value that
is convertible to <tt>bool</tt></del><ins><tt>Predicate</tt> is a function object type (20.14 <a href="https://timsong-cpp.github.io/cppwp/function.objects">[function.objects]</a>).
The return value of the function call operation applied to an object of type <tt>Predicate</tt>, when implicitly or 
contextually converted to <tt>bool</tt> (7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>), yields <tt>true</tt> if the corresponding test condition is
satisfied, and <tt>false</tt> otherwise</ins>.
</p>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2014-05-20, Daniel suggests concrete wording based on STL's proposal]</i></p>

<p>
The presented wording follows relatively closely STL's outline with the following notable exceptions:
</p>
<ol style="list-style-type:upper-alpha">
<li><p>
A reference to <tt>BooleanTestable</tt> in table "Return Type" specifications seemed very unusual to me and
I found no "prior art" for this in the Standard. Instead I decided to follow the usual style to add a symbol
with a specific meaning to a specific paragraph that specifies symbols and their meanings.
</p></li>
<li><p>
STL's requirement IV suggested to directly refer to built-in operators <tt>&amp;&amp;</tt> and <tt>||</tt>. In my
opinion this concrete requirement isn't needed if we simply require that two <tt>BooleanTestable</tt> operands behave 
equivalently to two those operands after conversion to <tt>bool</tt> (each of them).
</p></li>
<li><p>
I couldn't find a good reason to require normatively that type <tt>bool</tt> meets the requirements of <tt>BooleanTestable</tt>: My
assertion is that after having defined them, the result simply falls out of this. But to make this a bit clearer, I added
also a non-normative note to these effects.
</p></li>
</ol>

<p><i>[2014-06-10, STL comments]</i></p>

<p>
In the current wording I would like to see changed the suggested changes described by bullet #6:
</p>
<ol style="list-style-type:upper-alpha">
<li><p>In 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> p4 undo the suggested change</p></li>
<li><p>Then change the 7 occurrences of "convertible to <tt>bool</tt>" in the denoted tables to "<tt>bool</tt>".</p></li>
</ol>

<p><i>[2015-05-05 Lenexa]</i></p>

<p>STL: Alisdair wanted to do something here, but Daniel gave us updated wording.</p>

<p><i>[2015-07 Telecon]</i></p>
<p>
Alisdair: Should specify we don't break short circuiting.<br/>
Ville: Looks already specified because that's the way it works for bool. <br/>
Geoffrey: Maybe add a note about the short circuiting.<br/>
B2/P2 is somewhat ambiguous. It implies that B has to be both implicitly convertible to bool and contextually convertible to bool.<br/>
We like this, just have nits.<br/>
Status stays Open.<br/>
Marshall to ping Daniel with feedback.<br/>
</p>

<p><i>[2016-02-27, Daniel updates wording]</i></p>

<ol>
<li>
<p>
The revised wording has been updated from N3936 to N4567. 
</p>
</li>
<li>
<p>
To satisfy the Kona 2015 committee comments, the wording in 
[booleantestable.requirements] has been improved to better separate the two different requirements of "can be 
contextually converted to <tt>bool</tt>" and "can be implicitly converted to <tt>bool</tt>. Both are necessary because 
it is possible to define a type that has the latter property but not the former, such as the following one:
</p>
<blockquote class="note">
<p>
2016-08-07, Daniel: The below example has been corrected to reduce confusion about the performed conversions as indicated
by the delta markers:
</p>
</blockquote>
<blockquote><pre>
using Bool = int;

struct OddBoolean 
{
  explicit <ins>operator bool() const = delete;
  operator Bool() const;</ins>
  <del>OddBoolean(bool) = delete;
  OddBoolean(Bool){}</del>
} <ins>ob</ins>;

<ins>bool b2 = ob; // OK
bool b1(ob);  // Error</ins>
<del>OddBoolean b2 = true; // OK
OddBoolean b1(true);  // Error</del>
<ins></ins>
</pre></blockquote>
</li>
<li>
<p>
In [booleantestable.requirements] a note has been added to ensure that an implementation is not allowed to 
break any short-circuiting semantics.
</p>
</li>
<li>
<p>
I decided to separate LWG <a href="2587">2587</a>/<a href="2588">2588</a> from this issue. Both these issues aren't exactly the
same but depending on the committee's position, their resolution might benefit from the new vocabulary introduced
here.
</p>
</li>
</ol>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4567.</p>

<ol>
<li><p>Change 16.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/utility.arg.requirements">[utility.arg.requirements]</a> p1, Table 17 &mdash; "EqualityComparable requirements", and
Table 18 &mdash; "LessThanComparable requirements" as indicated:</p>

<blockquote>
<p>
-1- [&hellip;] In these tables, <tt>T</tt> is an object or reference type to be supplied by a C++ program
instantiating a template; <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> are values of type (possibly <tt>const</tt>) <tt>T</tt>; 
<tt>s</tt> and <tt>t</tt> are modifiable lvalues of type <tt>T</tt>; <tt>u</tt> denotes an identifier; <tt>rv</tt> 
is an rvalue of type <tt>T</tt>; <del>and</del> <tt>v</tt> is an lvalue of type (possibly <tt>const</tt>) <tt>T</tt> or an
rvalue of type <tt>const T</tt><ins>; and <tt>BT</tt> denotes a type that meets the <tt>BooleanTestable</tt> 
requirements ([booleantestable.requirements])</ins>.
<p/>
[&hellip;]
</p>
<blockquote>
<table border="1">
<caption>Table 17 &mdash; <tt>EqualityComparable</tt> requirements [equalitycomparable]</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">Requirement</th>
</tr>

<tr>
<td>
<tt>a == b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
<tt>==</tt> is an equivalence relation, that is, it has the
following properties: [&hellip;]
</td>
</tr>

</table>
</blockquote>
<p>
[&hellip;]
</p>
<blockquote>
<table border="1">
<caption>Table 18 &mdash; <tt>LessThanComparable</tt> requirements [lessthancomparable]</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">Requirement</th>
</tr>

<tr>
<td>
<tt>a &lt; b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
<tt>&lt;</tt> is a strict weak ordering relation (25.7 <a href="https://timsong-cpp.github.io/cppwp/alg.sorting">[alg.sorting]</a>)
</td>
</tr>

</table>
</blockquote>

</blockquote>

</li>

<li><p>Between 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a> and 16.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/nullablepointer.requirements">[nullablepointer.requirements]</a> insert a new sub-clause 
as indicated:</p>

<blockquote>
?.?.?.? <b><tt>BooleanTestable</tt> requirements [booleantestable.requirements]</b>  
<blockquote>
<p>
-?- A <tt>BooleanTestable</tt> type is a boolean-like type that also supports conversions to <tt>bool</tt>.
A type <tt>B</tt> meets the <tt>BooleanTestable</tt> requirements if the expressions described in Table ?? are valid 
and have the indicated semantics, and if <tt>B</tt> also satisfies all the other requirements of this sub-clause 
[booleantestable.requirements].
<p/>
An object <tt>b</tt> of type <tt>B</tt> can be implicitly converted to <tt>bool</tt> and in addition can be 
contextually converted to <tt>bool</tt> (Clause 4). The result values of both kinds of conversions shall be equivalent. 
<p/>
[<i>Example</i>: The types <tt>bool</tt>, <tt>std::true_type</tt>, and <tt>std::bitset&lt;&gt;::reference</tt> are 
<tt>BooleanTestable</tt> types. &mdash; <i>end example</i>]
<p/>
For the purpose of Table ??, let <tt>B2</tt> and <tt>Bn</tt> denote types (possibly both equal to <tt>B</tt> or to each other) 
that meet the <tt>BooleanTestable</tt> requirements, let <tt>b1</tt> denote a (possibly <tt>const</tt>) value of <tt>B</tt>, 
let <tt>b2</tt> denote a (possibly <tt>const</tt>) value of <tt>B2</tt>, and let <tt>t1</tt> denote a value of type 
<tt>bool</tt>.
<p/>
[<i>Note</i>: These rules ensure what an implementation can rely on but doesn't grant it
license to break short-circuiting behavior of a <tt>BooleanTestable</tt> type. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Somewhere within the new sub-clause [booleantestable.requirements] insert the following new Table (?? denotes
the assigned table number):</p>

<blockquote>
<table border="1">
<caption>Table ?? &mdash; <tt>BooleanTestable</tt> requirements [booleantestable]</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">Operational semantics</th>
</tr>

<tr>
<td>
<tt>bool(b1)</tt>
</td>
<td>
<tt>bool</tt>
</td>
<td>
<i>Remarks</i>: <tt>bool(b1) == t1</tt> for every value<br/>
<tt>b1</tt> implicitly converted to <tt>t1</tt>.
</td>
</tr>

<tr>
<td>
<tt>!b1</tt>
</td>
<td>
<tt>Bn</tt>
</td>
<td>
<i>Remarks</i>: <tt>bool(b1) == !bool(!b1)</tt> for<br/>
every value <tt>b1</tt>.
</td>
</tr>

<tr>
<td>
<tt>b1 &amp;&amp; b2</tt>
</td>
<td>
<tt>bool</tt>
</td>
<td>
<tt>bool(b1) &amp;&amp; bool(b2)</tt>
</td>
</tr>

<tr>
<td>
<tt>b1 || b2</tt>
</td>
<td>
<tt>bool</tt>
</td>
<td>
<tt>bool(b1) || bool(b2)</tt>
</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Change 16.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/nullablepointer.requirements">[nullablepointer.requirements]</a> p5 and Table 25 &mdash; "NullablePointer requirements" as indicated:</p>

<blockquote>
<p>
[&hellip;]
<p/>
-5- In Table 25, <tt>u</tt> denotes an identifier, <tt>t</tt> denotes a non-<tt>const</tt> lvalue of type <tt>P</tt>, <tt>a</tt> 
and <tt>b</tt> denote values of type (possibly <tt>const</tt>) <tt>P</tt>, <del>and</del> <tt>np</tt> denotes a value of type 
(possibly <tt>const</tt>) <tt>std::nullptr_t</tt><ins>, and <tt>BT</tt> denotes a type that meets the <tt>BooleanTestable</tt> 
requirements ([booleantestable.requirements])</ins>.
<p/>
[&hellip;]
</p>
<blockquote>
<table border="1">
<caption>Table 25 &mdash; <tt>NullablePointer</tt> requirements [nullablepointer]</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">Operational semantics</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a != b</tt>
</td>
<td>
<del>contextually convertible to <tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a == np</tt><br/>
<tt>np == a</tt>
</td>
<td>
<del>contextually convertible to <tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a != np</tt><br/>
<tt>np != a</tt>
</td>
<td>
<del>contextually convertible to <tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

</table>
</blockquote>
</blockquote>
</li>

<li><p>Change 20.5.8 <a href="https://timsong-cpp.github.io/cppwp/tuple.rel">[tuple.rel]</a> as indicated;</p>

<blockquote>
<pre>
template&lt;class... TTypes, class... UTypes&gt;
constexpr bool operator==(const tuple&lt;TTypes...&gt;&amp; t, const tuple&lt;UTypes...&gt;&amp; u);
</pre>
<blockquote>
<p>
-1- <i>Requires</i>: For all <tt>i</tt>, where <tt>0 &lt;= i</tt> and <tt>i &lt; sizeof...(TTypes)</tt>, 
<tt>get&lt;i&gt;(t) == get&lt;i&gt;(u)</tt> is a valid expression returning a type that <del>is convertible to 
<tt>bool</tt></del><ins>meets the <tt>BooleanTestable</tt> requirements ([booleantestable.requirements])</ins>. 
<tt>sizeof...(TTypes) == sizeof...(UTypes)</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class... TTypes, class... UTypes&gt;
constexpr bool operator&lt;(const tuple&lt;TTypes...&gt;&amp; t, const tuple&lt;UTypes...&gt;&amp; u);
</pre>
<blockquote>
<p>
-4- <i>Requires</i>: For all <tt>i</tt>, where <tt>0 &lt;= i</tt> and <tt>i &lt; sizeof...(TTypes)</tt>, 
<tt>get&lt;i&gt;(t) &lt; get&lt;i&gt;(u)</tt> and <tt>get&lt;i&gt;(u) &lt; get&lt;i&gt;(t)</tt> are valid 
expressions returning types that <del>are convertible to 
<tt>bool</tt></del><ins>meet the <tt>BooleanTestable</tt> requirements ([booleantestable.requirements])</ins>. 
<tt>sizeof...(TTypes) == sizeof...(UTypes)</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Change 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>, Table 95 &mdash; "Container requirements", and
Table 97 &mdash; "Optional container operations" as indicated:</p>

<blockquote>
<p>
-4- In Tables 95, 96, and 97 <tt>X</tt> denotes a container class containing objects of type <tt>T</tt>, <tt>a</tt> and 
<tt>b</tt> denote values of type <tt>X</tt>, <tt>u</tt> denotes an identifier, <tt>r</tt> denotes a non-<tt>const</tt> value 
of type <tt>X</tt>, <del>and</del> <tt>rv</tt> denotes a non-<tt>const</tt> rvalue of type <tt>X</tt><ins>, and <tt>BT</tt> 
denotes a type that meets the <tt>BooleanTestable</tt> requirements ([booleantestable.requirements])</ins>.
</p>
<blockquote>
<table border="1">
<caption>Table 95 &mdash; Container requirements</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">[&hellip;]</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a == b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a != b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.empty()</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

</table>
</blockquote>
<p>
[&hellip;]
</p>
<blockquote>
<table border="1">
<caption>Table 97 &mdash; Optional container requirements</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">[&hellip;]</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a &lt; b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a &gt; b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a &lt;= b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a &gt;= b</tt>
</td>
<td>
<del>convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

</table>
</blockquote>
</blockquote>
</li>

<li><p>Change 23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>, Table 106 &mdash; "Input iterator requirements", and
Table 110 &mdash; "Random access iterator requirements" as indicated:</p>

<blockquote>
<p>
-12- In the following sections, <tt>a</tt> and <tt>b</tt> denote values of type <tt>X</tt> or <tt>const X</tt>, 
<tt>difference_type</tt> and <tt>reference</tt> refer to the types <tt>iterator_traits&lt;X&gt;::difference_type</tt> and 
<tt>iterator_traits&lt;X&gt;::reference</tt>, respectively, <tt>n</tt> denotes a value of <tt>difference_type</tt>, <tt>u</tt>, 
<tt>tmp</tt>, and <tt>m</tt> denote identifiers, <tt>r</tt> denotes a value of <tt>X&amp;</tt>, <tt>t</tt> denotes
a value of value type <tt>T</tt>, <tt>o</tt> denotes a value of some type that is writable to the output iterator<ins>, and <tt>BT</tt> 
denotes a type that meets the <tt>BooleanTestable</tt> requirements ([booleantestable.requirements])</ins>.
</p>
<blockquote>
<table border="1">
<caption>Table 106 &mdash; Input iterator requirements</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">[&hellip;]</th>
</tr>

<tr>
<td>
<tt>a != b</tt>
</td>
<td>
<del>contextually convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>
</table>
</blockquote>
<p>
[&hellip;]
</p>
<blockquote>
<table border="1">
<caption>Table 110 &mdash; Random access iterator requirements</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">[&hellip;]</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a &lt; b</tt>
</td>
<td>
<del>contextually convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a &gt; b</tt>
</td>
<td>
<del>contextually convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a &gt;= b</tt>
</td>
<td>
<del>contextually convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>a &lt;= b</tt>
</td>
<td>
<del>contextually convertible to<br/>
<tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

</table>
</blockquote>
</blockquote>
</li>

<li><p>Change 25.1 <a href="https://timsong-cpp.github.io/cppwp/algorithms.general">[algorithms.general]</a> p8+p9 as indicated:</p>
<blockquote class="note">
<p>
[<i>Drafting note</i>: The wording changes below also fix
(a) unusual wording forms used ("should work") which are unclear in which sense they are imposing normative requirements and
(b) the problem, that the current wording seems to allow that the predicate may mutate a call argument, if that is not a 
dereferenced iterator.
Upon applying the new wording it became obvious that the both the previous and the new wording has the effect that currently 
algorithms such as <tt>adjacent_find</tt>, <tt>search_n</tt>, <tt>unique</tt>, and <tt>unique_copy</tt> are not correctly 
described (because they have no iterator argument named <tt>first1</tt>), which could give raise to a new library issue. 
&mdash; <i>end drafting note</i>]
</p>
</blockquote>

<blockquote>
<p>
-8- The <tt>Predicate</tt> parameter is used whenever an algorithm expects a function object (20.9) that, when applied
to the result of dereferencing the corresponding iterator, returns a value testable as <tt>true</tt>. <del>In other words,
i</del><ins>I</ins>f an algorithm takes <tt>Predicate pred</tt> as its argument and <tt>first</tt> as its iterator argument, 
<del>it should work correctly in the construct <tt>pred(*first)</tt> contextually converted to 
<tt>bool</tt> (Clause 4)</del><ins>the expression <tt>pred(*first)</tt> shall have a type that meets the <tt>BooleanTestable</tt> 
requirements ( [booleantestable.requirements])</ins>. 
The function object <tt>pred</tt> shall not apply any non-constant function through <del>the dereferenced 
iterator</del><ins>its argument</ins>.
<p/>
-9- The <tt>BinaryPredicate</tt> parameter is used whenever an algorithm expects a function object that when applied
to the result of dereferencing two corresponding iterators or to dereferencing an iterator and type
<tt>T</tt> when <tt>T</tt> is part of the signature returns a value testable as <tt>true</tt>. <del>In other words, 
i</del><ins>I</ins>f an algorithm takes <tt>BinaryPredicate binary_pred</tt> as its argument and <tt>first1</tt> and 
<tt>first2</tt> as its iterator arguments, <del>it should work correctly in the construct <tt>binary_pred(*first1, *first2)</tt> 
contextually converted to <tt>bool</tt> (Clause 4)</del><ins>the expression <tt>binary_pred(*first1, *first2)</tt> shall 
have a type that meets the <tt>BooleanTestable</tt> requirements ( [booleantestable.requirements])</ins>. 
<tt>BinaryPredicate</tt> always takes the first iterator's <tt>value_type</tt> as its first argument, that is, in those cases 
when <tt>T</tt> value is part of the signature, <del>it should work correctly in the construct <tt>binary_pred(*first1, value)</tt> 
contextually converted to <tt>bool</tt> (Clause 4)</del><ins>the expression <tt>binary_pred(*first1, value)</tt> shall have a 
type that meets the <tt>BooleanTestable</tt> requirements ( [booleantestable.requirements])</ins>. <tt>binary_pred</tt> 
shall not apply any non-constant function through <del>the dereferenced iterators</del><ins>any of its arguments</ins>.
</p>
</blockquote>
</li>

<li><p>Change 25.7 <a href="https://timsong-cpp.github.io/cppwp/alg.sorting">[alg.sorting]</a> p2 as indicated:</p>

<blockquote>
<p>
[&hellip;]
<p/>
-2- <tt>Compare</tt> is a function object type (20.9). <del>The return value of the function call 
operation applied to an object of type <tt>Compare</tt>, when contextually converted 
to <tt>bool</tt>(Clause 4), yields <tt>true</tt> if the first argument of the call is less than the second, 
and <tt>false</tt> otherwise.</del> <tt>Compare comp</tt> is used throughout for algorithms assuming an ordering relation. 
<ins>Let <tt>a</tt> and <tt>b</tt> denote two argument values whose types depend on the corresponding algorithm. Then the expression 
<tt>comp(a, b)</tt> shall have a type that meets the <tt>BooleanTestable</tt> requirements ( [booleantestable.requirements]).
The return value of <tt>comp(a, b)</tt>, converted to <tt>bool</tt>, yields <tt>true</tt> if the 
first argument <tt>a</tt> is less than the second argument <tt>b</tt>, and <tt>false</tt> otherwise.</ins> It is assumed that 
<tt>comp</tt> will not apply any non-constant function through <del>the dereferenced iterator</del><ins>any of its arguments</ins>.
<p/>
[&hellip;]
</p>
</blockquote>
</li>

<li><p>Change 29.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/fpos.operations">[fpos.operations]</a> and Table 126 &mdash; "Position type requirements" as indicated:</p>

<blockquote>
<p>
-1- Operations specified in Table 126 are permitted. In that table,
</p>
<ul>
<li><p><tt>P</tt> refers to an instance of <tt>fpos</tt>,</p></li>
<li><p>[&hellip;]</p></li>
<li><p><tt>o</tt> refers to a value of type <tt>streamoff</tt>,</p></li>
<li><p><ins><tt>BT</tt> refers to a type that meets the <tt>BooleanTestable</tt> requirements ([booleantestable.requirements]),</ins></p></li>
<li><p>[&hellip;]</p></li>
</ul>
<blockquote>
<table border="1">
<caption>Table 126 &mdash; Position type requirements</caption>
<tr>
<th align="center">Expression</th>
<th align="center">Return type</th>
<th align="center">[&hellip;]</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>p == q</tt>
</td>
<td>
<del>convertible to <tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>p != q</tt>
</td>
<td>
<del>convertible to <tt>bool</tt></del><ins><tt>BT</tt></ins>
</td>
<td>
[&hellip;]
</td>
</tr>

</table>
</blockquote>
</blockquote>
<blockquote>
</blockquote>
</li>

<li><p>Change 32.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.req.paramname">[thread.req.paramname]</a> p1 as indicated:</p>

<blockquote>
<p>
-1- Throughout this Clause, the names of template parameters are used to express type requirements. <del>If a template
parameter is named <tt>Predicate</tt>, <tt>operator()</tt> applied to the template argument shall return a value that
is convertible to <tt>bool</tt></del><ins><tt>Predicate</tt> is a function object type (20.14 <a href="https://timsong-cpp.github.io/cppwp/function.objects">[function.objects]</a>).
Let <tt>pred</tt> denote an lvalue of type <tt>Predicate</tt>. Then the expression <tt>pred()</tt> shall have a type that meets the 
<tt>BooleanTestable</tt> requirements ( [booleantestable.requirements]). The return value of <tt>pred()</tt>, 
converted to <tt>bool</tt>, yields <tt>true</tt> if the corresponding test condition is satisfied, and <tt>false</tt> otherwise</ins>.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2115" href="2115">2115.</a> Undefined behaviour for <tt>valarray</tt> assignments with <tt>mask_array</tt> index?</h3>
<p><b>Section:</b> 26.7.8 <a href="https://timsong-cpp.github.io/cppwp/template.mask.array">[template.mask.array]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Thomas Plum <b>Opened:</b> 2011-12-10 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
Recently I received a Service Request (SR) alleging that one of our testcases causes an 
undefined behavior. The complaint is that 26.7.8 <a href="https://timsong-cpp.github.io/cppwp/template.mask.array">[template.mask.array]</a> in C++11 
(and the corresponding subclause in C++03) are interpreted by some people to require that 
in an assignment "<tt>a[mask] = b</tt>", the subscript <tt>mask</tt> and the rhs <tt>b</tt> 
must have the same number of elements.
<p/>
IMHO, if that is the intended requirement, it should be stated explicitly.
<p/>
In any event, there is a tiny editorial cleanup that could be made:
<p/>
In C++11, 26.7.8.1 <a href="https://timsong-cpp.github.io/cppwp/template.mask.array.overview">[template.mask.array.overview]</a> para 2 mentions
</p>
<blockquote><p>
"the expression <tt>a[mask] = b;</tt>"
</p></blockquote>
<p>
but the semicolon cannot be part of an expression. The correction could omit the 
semicolon, or change the word "expression" to "assignment" or "statement".
<p/>
Here is the text of the SR, slightly modified for publication:
</p>
<blockquote>
<p>
Subject:  SR01174 LVS _26322Y31 has undefined behavior [open]
<p/>
[Client:]<br/>
The test case t263.dir&#47;_26322Y31.cpp seems to be illegal as it has an undefined 
behaviour. I searched into the SRs but found SRs were not related to the topic 
explained in this mail (SR00324, SR00595, SR00838).
</p>
<blockquote><pre>
const char vl[] = {"abcdefghijklmnopqrstuvwxyz"};
const char vu[] = {"ABCDEFGHIJKLMNOPQRSTUVWXYZ"};
const std::valarray&lt;char&gt; v0(vl, 27), vm5(vu, 5), vm6(vu, 6);
std::valarray&lt;char&gt; x = v0;
[&hellip;]
const bool vb[] = {false, false, true, true, false, true};
const std::valarray&lt;bool&gt; vmask(vb, 6);
x = v0;
x[vmask] = vm5;      // ***** HERE....
steq(&amp;x[0], "abABeCghijklmnopqrstuvwxyz");
x2 = x[vmask];       // ***** ....AND HERE
[&hellip;]
</pre></blockquote>
<p>
This problem has already been discussed between [experts]:
See thread <a href="http://gcc.gnu.org/ml/libstdc++/2009-11/threads.html#00051">http:&#47;&#47;gcc.gnu.org&#47;ml&#47;libstdc++&#47;2009-11&#47;threads.html#00051</a> 
Conclusion <a href="http://gcc.gnu.org/ml/libstdc++/2009-11/msg00099.html">http:&#47;&#47;gcc.gnu.org&#47;ml&#47;libstdc++&#47;2009-11&#47;msg00099.html</a>
<p/>
[Plum Hall:]<br/>
Before I log this as an SR, I need to check one detail with you.
<p/>
I did read the email thread you mentioned, and I did find a citation (see INCITS ISO&#47;IEC 14882-2003 
Section 26.3.2.6 on valarray computed assignments):
<p/>
Quote: "If the array and the argument array do not have the same length, the behavior is undefined",
<p/>
But this applies to computed assignment (<tt>*=</tt>, <tt>+=</tt>, etc), not to simple assignment. Here is the C++03 citation 
re simple assignment:
<p/>
26.3.2.2 valarray assignment [lib.valarray.assign]
</p>
<blockquote><pre>
valarray&lt;T&gt;&amp; operator=(const valarray&lt;T&gt;&amp;);
</pre><blockquote>
<p>
1 Each element of the <tt>*this</tt> array is assigned the value of the corresponding element of the argument array.
The resulting behavior is undefined if the length of the argument array is not equal to the length of the
<tt>*this</tt> array.
</p>
</blockquote></blockquote>
<p>
In the new C++11 (N3291), we find ...
<p/>
26.6.2.3 valarray assignment [valarray.assign]
</p>
<blockquote><pre>
valarray&lt;T&gt;&amp; operator=(const valarray&lt;T&gt;&amp; v);
</pre><blockquote>
<p>
1 Each element of the <tt>*this</tt> array is assigned the value of the corresponding element of the argument
array. If the length of <tt>v</tt> is not equal to the length of <tt>*this</tt>, resizes <tt>*this</tt> to make 
the two arrays the same length, as if by calling <tt>resize(v.size())</tt>, before performing the assignment.
</p>
</blockquote></blockquote>
<p>
So it looks like the testcase might be valid for C++11 but not for C++03; what do you think?
<p/>
[Client:]<br/>
I quite agree with you but the two problems I mentioned:
</p>
<blockquote><pre>
x[vmask] = vm5;      // ***** HERE....
[&hellip;]
x2 = x[vmask];       // ***** ....AND HERE
</pre></blockquote>
<p>
refer to <tt>mask_array</tt> assignment hence target the C++03 26.3.8 paragraph. Correct?
<p/>
[Plum Hall:]<br/>
I mentioned the contrast between C++03 26.3.2.2 para 1 versus C++11 26.6.2.3 para 1.
<p/>
But in C++03 26.3.8, I don't find any corresponding restriction. Could you quote the specific 
requirement you're writing about?
<p/>
[Client:]<br/>
I do notice the difference between c++03 26.3.2.2 and c++11 26.6.2.3 about assignments between 
different sized <tt>valarray</tt> and I perfectly agree with you.
<p/>
But, as already stated, this is not a simple <tt>valarray</tt> assignment but a
<tt>mask_array</tt> assignment (c++03 26.3.8 &#47; c++11 26.6.8). See c++11 quote below:
<p/>
26.6.8 Class template mask_array<br/>
26.6.8.1 Class template mask_array overview<br/>
[....]
</p>
<ol>
<li><p>This template is a helper template used by the mask subscript operator:
<tt>mask_array&lt;T&gt; valarray&lt;T&gt;::operator[](const valarray&lt;bool&gt;&amp;)</tt>.
</p></li>
<li><p>It has reference semantics to a subset of an array specified by a boolean mask. Thus, 
the expression <tt>a[mask] = b;</tt> has the effect of assigning <em>the elements of <tt>b</tt></em> 
to the masked elements in <tt>a</tt> (those for which the corresponding element in <tt>mask</tt> is true.)
</p></li>
</ol>
<p>
26.6.8.2 mask_array assignment
</p>
<blockquote><pre>
void operator=(const valarray&lt;T&gt;&amp;) const;
const mask_array&amp; operator=(const mask_array&amp;) const;
</pre><blockquote>
<p>
1 These assignment operators have reference semantics, assigning the values of the argument array 
elements to selected elements of the <tt>valarray&lt;T&gt;</tt> object to which it refers.
</p>
</blockquote></blockquote>
<p>
In particular, [one of the WG21 experts] insisted on the piece "the elements of <tt>b</tt>".
<p/>
That is why I reported the test t263.dir&#47;_26322Y31.cpp having an undefined behaviour.
<p/>
[Plum Hall:]<br/>
OK, I can see that I will have to ask WG21; I will file an appropriate issue 
with the Library subgroup. In the meantime, I will mark this testcase as "DISPUTED" 
so that it is not required for conformance testing, until we get a definitive opinion.
</p>
</blockquote>

<p><i>[2012, Kona]</i></p>

<p>
Moved to Open.
</p>
<p>
There appears to be a real need for clarification in the standard, and
implementations differ in their current interpretation.  This will need
some research by implementers and a proposed resolution before further
discussion is likely to be fruitful.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2116" href="2116">2116.</a> <tt>is_nothrow_constructible</tt> and destructors</h3>
<p><b>Section:</b> 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Dave Abrahams <b>Opened:</b> 2011-12-09 <b>Last modified:</b> 2018-10-11 01:45:28 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.unary.prop">active issues</a> in [meta.unary.prop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.unary.prop">issues</a> in [meta.unary.prop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
IMO if we specified <tt>is_[nothrow_]constructible</tt> in terms of a variable
declaration whose validity requires destructibility, it is clearly a bug
in our specification and a failure to realize the actual original
intent. The specification should have been in terms of placement-new.
<p/>
Daniel:<br/>
At the time of the specification this was intended and the solution is
<em>not</em> done by removing the destruction semantics of <tt>is_constructible</tt>.
<p/>
The design of <tt>is_constructible</tt> was also impacted by the previous
<tt>Constructible</tt> concept that <em>explicitly</em> contained destruction semantics,
because during conceptification of the library it turned out to simplify
the constraints  in the library because you did not need to add
<tt>Destructible</tt> all the time. It often was implied but never spoken out
in C++03.
<p/>
Pure construction semantics was considered as useful as well, so <tt>HasConstructor</tt>
did also exist and would surely be useful as trait as well.
<p/>
Another example that is often overlooked: This also affects wrapper types like <tt>pair</tt>,
<tt>tuple</tt>, <tt>array</tt> that contain potentially more than one type:
This is easy to understand if you think of <tt>T1</tt> having a deleted destructor
and <tt>T2</tt> having a constructor that may throw: Obviously the compiler has
potentially need to use the <tt>destructor</tt> of <tt>T1</tt> in the <em>constructor</em>
of <tt>std::pair&lt;T1, T2&gt;</tt> to ensure that the core language requirements
are satisfied (All previous fully constructed sub-objects must be destructed).
<p/>
The core language also honors this fact in  [class.copy] p11:
</p>
<blockquote><p>
A defaulted copy&#47;move constructor for a class <tt>X</tt> is defined as deleted (9.5.3 <a href="https://timsong-cpp.github.io/cppwp/dcl.fct.def.delete">[dcl.fct.def.delete]</a>)
if <tt>X</tt> has:<br/>
[&hellip;]<br/>
&mdash; any direct or virtual base class or non-static data member of a type with a destructor that is deleted
or inaccessible from the defaulted constructor,<br/>
[&hellip;]
</p></blockquote>
<p>
Dave:<br/>
This is about <tt>is_nothrow_constructible</tt> in particular. The fact that it is
foiled by not having a <tt>noexcept</tt> dtor is a defect.
</p>

<p><i>[2012, Kona]</i></p>

<p>
Move to Open.
</p>
<p>
<tt>is_nothrow_constructible</tt> is defined in terms of <tt>is_constructible</tt>, which is defined
by looking at a hypothetical variable and asking whether the variable definition is known not to
throw exceptions. The issue claims that this also examines the type's destructor, given the context,
and thus will return <tt>false</tt> if the destructor can potentially throw. At least one
implementation (Howard's) does return <tt>false</tt> if the constructor is <tt>noexcept(true)</tt>
and the destructor is <tt>noexcept(false)</tt>. So that's not a strained interpretation.
The issue is asking for this to be defined in terms of placement <tt>new</tt>, instead of in terms
of a temporary object, to make it clearer that <tt>is_nothrow_constructible</tt> looks at the
<tt>noexcept</tt> status of only the constructor, and not the destructor.
</p>
<p>
Sketch of what the wording would look like:
</p>
<p>
require <tt>is_constructible</tt>, and then also require that a placement <tt>new</tt> operation
does not throw. (Remembering the title of this issue... What does this imply for <tt>swap</tt>?
</p>
<p>
If we accept this resolution, do we need any changes to <tt>swap</tt>?
</p>
<p> STL argues: no, because you are already forbidden from passing anything with a throwing
destructor to <tt>swap</tt>.
</p>
<p>
Dietmar argues: no, not true. Maybe statically the destructor can conceivably throw for some
values, but maybe there are some values known not to throw. In that case, it's correct to
pass those values to <tt>swap</tt>.
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Gave the issue a better title</p>
<p>This issue interacts with <a href="2827">2827</a></p>
<p>Ville would like "an evolution group" to take a look at this issue.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2117" href="2117">2117.</a> <tt>ios_base</tt> manipulators should have <tt>showgrouping&#47;noshowgrouping</tt></h3>
<p><b>Section:</b> 28.4.2.2.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.put.virtuals">[facet.num.put.virtuals]</a>, 99 [ios::fmtflags], 29.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/fmtflags.manip">[fmtflags.manip]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Benjamin Kosnik <b>Opened:</b> 2011-12-15 <b>Last modified:</b> 2016-04-16 04:21:53 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#facet.num.put.virtuals">active issues</a> in [facet.num.put.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#facet.num.put.virtuals">issues</a> in [facet.num.put.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
Iostreams should include a manipulator to toggle grouping on&#47;off for
locales that support grouped digits. This has come up repeatedly and
been deferred. See LWG <a href="826">826</a> for the previous attempt.
<p/>
If one is using a locale that supports grouped digits, then output
will always include the generated grouping characters. However, very
plausible scenarios exist where one might want to output the number,
un-grouped. This is similar to existing manipulators that toggle
on&#47;off the decimal point, numeric base, or positive sign.
<p/>
See some user commentary <a href="http://www.tablix.org/~avian/blog/archives/2008/01/c_streams_suck/">here</a>.
</p>


<p><i>[21012, Kona]</i></p>

<p>
Move to Open.
</p>
<p>
This is a feature request.
</p>
<p>
Walter is slightly uncomfortable with processing feature requests through the issues lists.
</p>
<p>
Alisdair says this is far from the first feature request that has come in from the issues list.
</p>
<p>
STL: The fact that you can turn off grouping on hex output is compelling.
</p>
<p>
Marshall: if we add this flag, we'll need to update tables 87-91 as well.
</p>
<p>
STL: If it has been implemented somewhere, and it works, we'd be glad to add it.
</p>
<p>
Howard: We need to say what the default is.
</p>
<p>
Alisdair sumarizes:
</p>
<p>
(1) We want clear wording that says what the effect is of turning the flag off;
</p>
<p>
(2) what the default values are, and
</p>
<p>
(3) how this fits into tables 87-90. (and 128)
</p>

<p><i>[Issaquah 2014-02-10-12: Move to LEWG]</i></p>

<p>
Since this issue was filed, we have grown a new working group that is better placed to handle feature requests.
</p>
<p>
We will track such issues with an LEWG status until we get feedback from the Library Evolution Working Group.
</p>

<p><i>[Issaquah 2014-02-12: LEWG discussion]</i></p>


<table>
  <caption>Do we think this feature should exist?</caption>
  <tr><td>SF</td><td>F</td><td>N</td><td>A</td><td>SA</td></tr>
  <tr><td>2</td> <td>4</td><td>1</td><td>0</td><td>0</td></tr>
</table>

<p>Think about the ABI break for adding a flag. But this could be
mitigated by putting the data into an iword instead of a flag.</p>

<p>This needs to change Stage 2 in [facet.num.put.virtuals].</p>

<p>Previous resolution, which needs the above corrections:</p>
<blockquote class="note">
<p>This wording is relative to the FDIS.</p>

<ol>
<li>
<p>Insert in 28.4.2.2.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.put.virtuals">[facet.num.put.virtuals]</a> paragraph 5:</p>

<blockquote><p>
<strong>Stage 1</strong>: The first action of stage 1 is to determine a conversion specifier. The tables that describe
this determination use the following local variables
</p>
<pre>
fmtflags flags = str.flags() ;
fmtflags basefield = (flags &amp; (ios_base::basefield));
fmtflags uppercase = (flags &amp; (ios_base::uppercase));
fmtflags floatfield = (flags &amp; (ios_base::floatfield));
fmtflags showpos = (flags &amp; (ios_base::showpos));
fmtflags showbase = (flags &amp; (ios_base::showbase));
<ins>fmtflags showgrouping = (flags &amp; (ios_base::showgrouping));</ins>
</pre>
</blockquote>
</li>

<li><p>Change header <tt>&lt;ios&gt;</tt> synopsis,  [iostreams.base.overview] as indicated:</p>

<blockquote><pre>
#include &lt;iosfwd&gt;

namespace std {
  [&hellip;]
  <i>// 27.5.6, manipulators:</i>
  [&hellip;]
  ios_base&amp; showpoint     (ios_base&amp; str);
  ios_base&amp; noshowpoint   (ios_base&amp; str);
  <ins>ios_base&amp; showgrouping  (ios_base&amp; str);</ins>
  <ins>ios_base&amp; noshowgrouping(ios_base&amp; str);</ins>
  ios_base&amp; showpos       (ios_base&amp; str);
  ios_base&amp; noshowpos     (ios_base&amp; str);
  [&hellip;]
}
</pre></blockquote>
</li>

<li><p>Change class <tt>ios_base</tt> synopsis, 29.5.3 <a href="https://timsong-cpp.github.io/cppwp/ios.base">[ios.base]</a> as indicated:</p>

<blockquote><pre>
namespace std {
  class ios_base {
  public:
  class failure;
    <i>// 27.5.3.1.2 fmtflags</i>
    typedef <i>T1</i> fmtflags;
    [&hellip;]
    static constexpr fmtflags showpoint = <i>unspecified</i> ;
    <ins>static constexpr fmtflags showgrouping = <i>unspecified</i> ;</ins>
    static constexpr fmtflags showpos = <i>unspecified</i> ;
    [&hellip;]
  };
}
</pre></blockquote>
</li>

<li><p>Add a new entry to Table 122 &mdash; "<tt>fmtflags</tt> effects" as indicated:</p>

<table border="1">
<caption>Table 122 &mdash; <tt>fmtflags</tt> effects</caption>
<tr align="center">
<th>Element</th>
<th>Effect(s) if set</th>
</tr> 

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>showpoint</tt>
</td>
<td>
generates a decimal-point character unconditionally in generated floatingpoint output
</td>
</tr>

<tr>
<td>
<ins><tt>showgrouping</tt></ins>
</td>
<td>
<ins>generates grouping characters unconditionally in generated output</ins>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

</table>
 
</li>

<li><p>After 99 [ios::fmtflags] p12 insert the following:</p>
<blockquote><pre>
<ins>ios_base&amp; showgrouping(ios_base&amp; str);</ins>
</pre><blockquote>
<p>
<ins>-?- <i>Effects</i>: Calls <tt>str.setf(ios_base::showgrouping)</tt>.</ins>
<p/>
<ins>-?- <i>Returns</i>: <tt>str</tt>.</ins>
</p>
</blockquote>
<pre>
<ins>ios_base&amp; noshowgrouping(ios_base&amp; str);</ins>
</pre><blockquote>
<p>
<ins>-?- <i>Effects</i>: Calls <tt>str.unsetf(ios_base::showgrouping)</tt>.</ins>
<p/>
<ins>-?- <i>Returns</i>: <tt>str</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>

</ol>

</blockquote>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2136" href="2136">2136.</a> Postconditions vs. exceptions</h3>
<p><b>Section:</b> 16.4.1 <a href="https://timsong-cpp.github.io/cppwp/structure">[structure]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2012-03-08 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The front matter in clause 17 should clarify that postconditions will not hold if a 
standard library function exits via an exception. Postconditions or guarantees that 
apply when an exception is thrown (beyond the basic guarantee) are described in an 
"Exception safety" section.
</p>

<p><i>[
2012-10 Portland: Move to Open
]</i></p>


<p>
Consensus that we do not clearly say this, and that we probably should.  A likely
location to describe the guarantees of <i>postconditions</i> could well be a new
sub-clause following 16.5.4.11 <a href="https://timsong-cpp.github.io/cppwp/res.on.required">[res.on.required]</a> which serves the same purpose
for <i>requires</i> clauses.  However, we need such wording before we can make
progress.
</p>

<p>
Also, see <a href="2137">2137</a> for a suggestion that we want to see a paper resolving
both issues together.
</p>

<p><i>[2015-05-06 Lenexa: EirkWF to write paper addressing 2136 and 2137]</i></p>

<p>MC: Idea is to replace all such "If no exception" postconditions with "Exception safety" sections.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2137" href="2137">2137.</a> Misleadingly constrained post-condition in the presence of exceptions</h3>
<p><b>Section:</b> 30.8.2 <a href="https://timsong-cpp.github.io/cppwp/re.regex.assign">[re.regex.assign]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2012-03-08 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#re.regex.assign">issues</a> in [re.regex.assign].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The post-conditions of <tt>basic_regex&lt;&gt;::assign</tt> 30.8.2 <a href="https://timsong-cpp.github.io/cppwp/re.regex.assign">[re.regex.assign]</a> p16 say:
</p>
<blockquote><p>
<span style="color:#C80000;font-weight:bold">If no exception is thrown,</span> <tt>flags()</tt> returns 
<tt>f</tt> and <tt>mark_count()</tt> returns the number of marked sub-expressions within the expression.
</p></blockquote>
<p>
The default expectation in the library is that post-conditions only hold, if there is no failure 
(see also <a href="2136">2136</a>), therefore the initial condition should be removed to prevent any
misunderstanding.
</p>

<p><i>[
2012-10 Portland: Move to Open
]</i></p>


<p>
A favorable resolution clearly depends on a favorable resolution to <a href="2136">2136</a>.
There is also a concern that this is just one example of where we would want to apply
such a wording clean-up, and which is really needed to resolve both this issue and
<a href="2136">2136</a> is a paper providing the clause 17 wording that gives the guarantee
for <i>postcondition</i> paragaraphs, and then reviews clauses 18-30 to apply that
guarantee consistently.  We do not want to pick up these issues piecemeal, as we risk
openning many issues in an ongoing process.
</p>

<p><i>[2015-05-06 Lenexa: EirkWF to write paper addressing 2136 and 2137]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3376.</p>

<blockquote><pre>
template &lt;class string_traits, class A&gt;
  basic_regex&amp; assign(const basic_string&lt;charT, string_traits, A&gt;&amp; s,
    flag_type f = regex_constants::ECMAScript);
</pre><blockquote>
<p>
[&hellip;]
<p/>
-15- <i>Effects</i>: Assigns the regular expression contained in the string <tt>s</tt>, interpreted according 
the flags specified in <tt>f</tt>. If an exception is thrown, <tt>*this</tt> is unchanged.
<p/>
-16- <i>Postconditions</i>: <del>If no exception is thrown,</del> <tt>flags()</tt> returns <tt>f</tt> and 
<tt>mark_count()</tt> returns the number of marked sub-expressions within the expression.
</p>
</blockquote>
</blockquote>






<hr>
<h3><a name="2146" href="2146">2146.</a> Are reference types <tt>Copy</tt>&#47;<tt>Move-Constructible</tt>&#47;<tt>Assignable</tt> or <tt>Destructible</tt>?</h3>
<p><b>Section:</b> 16.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/utility.arg.requirements">[utility.arg.requirements]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Nikolay Ivchenkov <b>Opened:</b> 2012-03-23 <b>Last modified:</b> 2019-07-22 17:12:46 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#utility.arg.requirements">issues</a> in [utility.arg.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
According to 16.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/utility.arg.requirements">[utility.arg.requirements]</a> p1
</p>
<blockquote><p>
The template definitions in the C++ standard library refer to various named requirements whose details are set out in 
tables 17-24. In these tables, <tt>T</tt> is an object or reference type to be supplied by a C++ program instantiating 
a template; <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> are values of type (possibly <tt>const</tt>) <tt>T</tt>; <tt>s</tt> 
and <tt>t</tt> are modifiable lvalues of type <tt>T</tt>; <tt>u</tt> denotes an identifier; <tt>rv</tt> is an rvalue of 
type <tt>T</tt>; and <tt>v</tt> is an lvalue of type (possibly <tt>const</tt>) <tt>T</tt> or an rvalue of type <tt>const T</tt>.
</p></blockquote>
<p>
Is it really intended that <tt>T</tt> may be a reference type? If so, what should <tt>a</tt>, <tt>b</tt>, <tt>c</tt>, 
<tt>s</tt>, <tt>t</tt>, <tt>u</tt>, <tt>rv</tt>, and <tt>v</tt> mean? For example, are "<tt>int &amp;</tt>" and 
"<tt>int &amp;&amp;</tt>" <tt>MoveConstructible</tt>?
<p/>
As far as I understand, we can explicitly specify template arguments for <tt>std::swap</tt> and <tt>std::for_each</tt>. 
Can we use reference types there?
</p>
<ol>
<li>
<blockquote><pre>
#include &lt;iostream&gt;
#include &lt;utility&gt;

int main()
{
  int x = 1;
  int y = 2;
  std::swap&lt;<span style="color:#C80000;font-weight:bold">int &amp;&amp;</span>&gt;(x, y); // <em>undefined?</em>
  std::cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; std::endl;
}
</pre></blockquote>
</li>
<li>
<blockquote><pre>
#include &lt;algorithm&gt;
#include &lt;iostream&gt;
#include &lt;iterator&gt;
#include &lt;utility&gt;

struct F
{
  void operator()(int n)
  {
    std::cout &lt;&lt; n &lt;&lt; std::endl;
    ++count;
  }
  int count;
} f;

int main()
{
  int arr[] = { 1, 2, 3 };
  auto&amp;&amp; result = std::for_each&lt;int *, <span style="color:#C80000;font-weight:bold">F &amp;&amp;</span>&gt;( // <em>undefined?</em>
    std::begin(arr),
    std::end(arr),
    std::move(f));
  std::cout &lt;&lt; "count: " &lt;&lt; result.count &lt;&lt; std::endl;
}
</pre></blockquote>
</li>
</ol>
<p>
Are these forms of usage well-defined?
<p/>
Let's also consider the following constructor of <tt>std::thread</tt>:
</p>
<blockquote><pre>
template &lt;class F, class ...Args&gt;
explicit thread(F&amp;&amp; f, Args&amp;&amp;... args);
</pre><blockquote>
<p>
<i>Requires</i>: <tt>F</tt> and each <tt>Ti</tt> in <tt>Args</tt> shall satisfy the <tt>MoveConstructible</tt> requirements.
</p>
</blockquote></blockquote>
<p>
When the first argument of this constructor is an lvalue (e.g. a name of a global function), template argument for <tt>F</tt> 
is deduced to be lvalue reference type. What should "<tt>MoveConstructible</tt>" mean with regard to an lvalue reference 
type? Maybe the wording should say that <tt>std::decay&lt;F&gt;::type</tt> and each <tt>std::decay&lt;Ti&gt;::type</tt> (where 
<tt>Ti</tt> is an arbitrary item in <tt>Args</tt>) shall satisfy the <tt>MoveConstructible</tt> requirements?
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>Moved to Open.</p>
<p>The questions raised by the issue are real, and should have a clear answer.</p>

<p><i>[2015-10, Kona Saturday afternoon]</i></p>

<p>STL: std::thread needs to be fixed, and anything behaving like it needs to be fixed, rather than reference types. std::bind gets this right. We need to survey this. GR: That doesn't sound small to me. STL: Seach for CopyConstructible etc. It may be a long change, but not a hard one.</p>
<p>MC: It seems that we don't have a PR. Does anyone have one? Is anyone interested in doing a survey?</p>

<p><i>[2016-03, Jacksonville]</i></p>

<p>Casey volunteers to make a survey</p>

<p><i>[2016-06, Oulu]</i></p>

<p>
During an independent survey performed by Daniel as part of the analysis of LWG <a href="2716">2716</a>,
some overlap was found between these two issues. Daniel suggested to take responsibility for surveying
LWG <a href="2146">2146</a> and opined that the P/R of LWG <a href="2716">2716</a> should restrict to forwarding 
references, where the deduction to lvalue references can happen without providing an explicit template
argument just by providing an lvalue function argument.
</p>

<p><i>[2018-06, Rapperwsil]</i></p>

<p>Jonathan says that this will be covered by his Omnibus requirements paper.</p>

<p><i>[2019 Cologne Wednesday night]</i></p>

<p>Daniel will start working on this again; Marshall to provide rationale why some of the examples are not well-formed.</p>


<p><b>Proposed resolution:</b></p>






<hr>
<h3><a name="2152" href="2152">2152.</a> Instances of standard container types are not swappable</h3>
<p><b>Section:</b> 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>, 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Robert Shearer <b>Opened:</b> 2012-04-13 <b>Last modified:</b> 2018-06-23 00:00:44 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#swappable.requirements">issues</a> in [swappable.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Sub-clause 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a> defines two notions of swappability: a binary version defining
when two objects are <em>swappable with</em> one another, and a unary notion defining whether an object is 
<em>swappable</em> (without qualification), with the latter definition requiring that the object satisfy the 
former with respect to all values of the same type.
<p/>
Let <tt>T</tt> be a container type based on a non-propagating allocator whose instances do not necessarily 
compare equal. Then sub-clause 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> p7 implies that no object <tt>t</tt> 
of type <tt>T</tt> is swappable (by the unary definition).
<p/>
Throughout the standard it is the unary definition of "swappable" that is listed as a requirement (with the 
exceptions of 20.2.2 <a href="https://timsong-cpp.github.io/cppwp/utility.swap">[utility.swap]</a> p4, 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> p31, 20.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/tuple.swap">[tuple.swap]</a> p2, 
25.6.3 <a href="https://timsong-cpp.github.io/cppwp/alg.swap">[alg.swap]</a> p2, and 25.6.3 <a href="https://timsong-cpp.github.io/cppwp/alg.swap">[alg.swap]</a> p6, which use the binary definition). This renders 
many of the mutating sequence algorithms of sub-clause 25.6 <a href="https://timsong-cpp.github.io/cppwp/alg.modifying.operations">[alg.modifying.operations]</a>, for example, 
inapplicable to sequences of standard container types, even where every element of the sequence is swappable 
with every other.
<p/>
Note that this concern extends beyond standard containers to all future allocator-based types.
<p/>
Resolution proposal:
<p/>
I see two distinct straightforward solutions:
</p>
<ol style="list-style-type:lower-roman">
<li>Modify the requirements of algorithms from sub-clause 25.6 <a href="https://timsong-cpp.github.io/cppwp/alg.modifying.operations">[alg.modifying.operations]</a>, and all other
places that reference the unary "swappable" definition, to instead use the binary "swappable with" definition 
(over a domain appropriate to the context). The unary definition of "swappable" could then be removed from the 
standard.
</li>
<li>Modify sub-clause 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> such that objects of standard container types 
are "swappable" by the unary definition.
</li>
</ol>
<p>
I favor the latter solution, for reasons detailed in the following issue.
</p>

<p><i>[
2012-10 Portland: Move to Open 
]</i></p>


<p>
The issue is broader than containers with stateful allocotors, although they are the most obvious
example contained within the standard itself.  The basic problem is that once you have a stateful
allocator, that does not <tt>propagate_on_swap</tt>, then whether two objects of this type can be
swapped with well defined behavior is a run-time property (the allocators compare equal) rather
than a simple compile-time property that can be deduced from the type.  Strictly speaking, any
type where the nature of swap is a runtime property does not meet the <tt>swappable</tt>
requirements of C++11, although typical sequences of such types are going to have elements that
are all <tt>swappable with</tt> any other element in the sequence (using our other term of art
for specifying requirements) as the common case is a container of elements who all share the
same allocator.
</p>

<p>
The heart of the problem is that the <tt>swappable</tt> requirments demand that any two objects
of the same type be <tt>swappable with</tt> each other, so if any two such objects would not
be <tt>swappable with</tt> each other, then the whole type is never <tt>swappable</tt>.  Many
algorithms in clause 25 are specified in terms of <tt>swappable</tt> which is essentially an
overspecification as all they actually need is that any element in the sequence is <tt>swappable
with</tt> any other element in the sequence.
</p>

<p>
At this point Howard joins the discussion and points out that the intent of introducing the
two swap-related terms was to support <tt>vector&lt;bool&gt;::reference</tt> types, and we are
reading something into the wording that was never intended.  Consuses is that regardless of
the intent, that is what the words today say.
</p>

<p>
There is some support to see a paper reviewing the whole of clause 25 for this issue, and
other select clauses as may be necessary.
</p>

<p>
There was some consideration to introducing a note into the front of clause 25 to indicate
<tt>swappable</tt> requirements in the clause should be interpreted to allow such awkward
types, but ultimately no real enthusiasm for introducing a <tt>swappable for clause 25</tt>
requirement term, especially if it confusingly had the same name as a term used with a
subtly different meaning through the rest of the standard.
</p>

<p>
There was no enthusiasm for the alternate resolution of requiring containers with unequal
allocators that do not propagate provide a well-defined swap behavior, as it is not
believed to be possible without giving <tt>swap</tt> linear complexity for such values,
and even then would require adding the constraint that the container element types are
CopyConstructible.
</p>

<p>
Final conclusion: move to open pending a paper from a party with a strong interest in
stateful allocators.
</p>

<p><i>[2016-03 Jacksonville]</i></p>

<p>
Alisdair says that his paper <a href="http://wg21.link/P0178">P0178</a> addresses this.
</p>

<p><i>[2016-06 Oulu]</i></p>

<p><a href="http://wg21.link/P0178">P0178</a> reviewed, and sent back to LEWG for confirmation.</p>
<p>Thursday Morning: A joint LWG/LEWG meeting declined to adopt <a href="http://wg21.link/P0178">P0178</a>.</p>

<p><i>[2017-02 in Kona, LEWG responds]</i></p>

<p>Note in the issue that this is tracked <a href="https://issues.isocpp.org/show_bug.cgi?id=152">here</a></p>

<p><i>[2017-06-02 Issues Telecon]</i></p>

<p>Leave as LEWG; priority 3</p>


<p><b>Proposed resolution:</b></p>
<p>
Apply <a href="http://wg21.link/P0178">P0178</a>.
</p>





<hr>
<h3><a name="2153" href="2153">2153.</a> Narrowing of the non-member <tt>swap</tt> contract</h3>
<p><b>Section:</b> 20.2.2 <a href="https://timsong-cpp.github.io/cppwp/utility.swap">[utility.swap]</a>, 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>, 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Robert Shearer <b>Opened:</b> 2012-04-13 <b>Last modified:</b> 2018-06-23 00:00:44 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#utility.swap">issues</a> in [utility.swap].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Sub-clause 20.2.2 <a href="https://timsong-cpp.github.io/cppwp/utility.swap">[utility.swap]</a> defines a non-member 'swap' function with defined behavior for
all <tt>MoveConstructible</tt> and <tt>MoveAssignable</tt> types. It does not guarantee
constant-time complexity or <tt>noexcept</tt> in general, however this definition does
render all objects of <tt>MoveConstructible</tt> and <tt>MoveAssignable</tt> type swappable
(by the unary definition of sub-clause 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>) in the absence of 
specializations or overloads.
<p/>
The overload of the non-member <tt>swap</tt> function defined in Table 96, however,
defines semantics incompatible with the generic non-member <tt>swap</tt> function,
since it is defined to call a member <tt>swap</tt> function whose semantics are
undefined for some values of <tt>MoveConstructible</tt> and <tt>MoveAssignable</tt> types.
<p/>
The obvious (perhaps naive) interpretation of sub-clause 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a> is as a guide to
the "right" semantics to provide for a non-member <tt>swap</tt> function (called in
the context defined by 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a> p3) in order to provide interoperable
user-defined types for generic programming. The standard container types don't follow these guidelines.
<p/>
More generally, the design in the standard represents a classic example of "contract narrowing". It 
is entirely reasonable for the contract of a particular <tt>swap</tt> overload to provide <em>more</em> 
guarantees, such as constant-time execution and <tt>noexcept</tt>, than are provided by the <tt>swap</tt> 
that is provided for any <tt>MoveConstructible</tt> and <tt>MoveAssignable</tt> types, but it is <em>not</em> 
reasonable for such an overload to fail to live up to the guarantees it provides for general types when 
it is applied to more specific types. Such an overload or specialization in generic programming is akin 
to an override of an inherited virtual function in OO programming: violating a superclass contract in a
subclass may be legal from the point of view of the language, but it is poor design and can easily lead 
to errors. While we cannot prevent user code from providing overloads that violate the more general 
<tt>swap</tt> contract, we can avoid doing so within the library itself.
<p/>
My proposed resolution is to draw a sharp distinction between member <tt>swap</tt> functions, which provide 
optimal performance but idiosyncratic contracts, and non-member <tt>swap</tt> functions, which should always 
fulfill at least the contract of 20.2.2 <a href="https://timsong-cpp.github.io/cppwp/utility.swap">[utility.swap]</a> and thus render objects swappable. The member 
<tt>swap</tt> for containers with non-propagating allocators, for example, would offer constant-time
guarantees and <tt>noexcept</tt> but would only offer defined behavior for values with allocators that compare 
equal; non-member <tt>swap</tt> would test allocator equality and then dispatch to either member <tt>swap</tt> or 
<tt>std::swap</tt> depending on the result, providing defined behavior for all values (and rendering the type
"swappable"), but offering neither the constant-time nor the <tt>noexcept</tt> guarantees.
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Open.
</p>
<p>
This topic deserves more attention than can be given in the telocon, and there is no proposed resolution.
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Open.
</p>
<p>
This topic deserves more attention than can be given in the telocon, and there is no proposed resolution.
</p>

<p><i>[2016-03 Jacksonville]</i></p>

<p>
Alisdair says that his paper <a href="http://wg21.link/P0178">P0178</a> addresses this.
</p>

<p><i>[2016-08 Chicago]</i></p>

<p>Send to LEWG</p>

<p><i>[2016-06 Oulu]</i></p>

<p><a href="http://wg21.link/P0178">P0178</a> reviewed, and sent back to LEWG for confirmation.</p>
<p>Thursday Morning: A joint LWG/LEWG meeting declined to adopt <a href="http://wg21.link/P0178">P0178</a>.</p>


<p><b>Proposed resolution:</b></p>
Apply <a href="http://wg21.link/P0178">P0178</a>.





<hr>
<h3><a name="2154" href="2154">2154.</a> What exactly does compile-time complexity imply?</h3>
<p><b>Section:</b> 26.6.2.3 <a href="https://timsong-cpp.github.io/cppwp/rand.req.urng">[rand.req.urng]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> John Salmon <b>Opened:</b> 2012-04-26 <b>Last modified:</b> 2018-12-16 12:11:44 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#rand.req.urng">active issues</a> in [rand.req.urng].</p>
<p><b>View all other</b> <a href="lwg-index.html#rand.req.urng">issues</a> in [rand.req.urng].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The expressions <tt>G::min()</tt> and <tt>G::max()</tt> in Table 116 in 26.6.2.3 <a href="https://timsong-cpp.github.io/cppwp/rand.req.urng">[rand.req.urng]</a> are specified 
as having "compile-time" complexity.
<p/>
It is not clear what, exactly, this requirement implies.  If a URNG has a method:
</p>
<blockquote><pre>
static int min();
</pre></blockquote>
<p>
then is the method required to have a <tt>constexpr</tt> qualifier?  I believe the standard would benefit from 
clarification of this point.
</p>

<p><i>[2018-12-08; Tim Song comments]</i></p>

<p>
This issue was resolved by <a href="https://wg21.link/p0898r3#page=25">P0898R3</a> and the subsequent editorial rewrite of
this <a href="https://github.com/cplusplus/draft/commit/bfaea046b5176152a86514a886a5b7ab66e4dffe">subclause</a>.
</p>    


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2155" href="2155">2155.</a> Macro <tt>__bool_true_false_are_defined</tt> should be removed</h3>
<p><b>Section:</b> 17.13 <a href="https://timsong-cpp.github.io/cppwp/support.runtime">[support.runtime]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Thomas Plum <b>Opened:</b> 2012-04-30 <b>Last modified:</b> 2019-03-23 12:04:39 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#support.runtime">issues</a> in [support.runtime].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>

<p>
Since C99, the C standard describes a macro named  <tt>__bool_true_false_are_defined</tt>.
<p/>
In the process of harmonizing C++11 with C99, this name became part of the C++ standard.
<p/>
I propose that all mention of this name should be removed from the C and C++ standards.
<p/>
Here's the problem: The name was originally proposed as a transition tool, so that the headers for a 
project could contain lines like the following.
</p>
<blockquote><pre>
#if !defined(__bool_true_false_are_defined)
#define bool int /* or whatever */
#define true 1
#define false 0
#endif
</pre></blockquote>
<p>
Then when the project was compiled by a "new" compiler that implemented <tt>bool</tt> as defined by the 
evolving C++98 or C99 standards, those lines would be skipped; but when compiled by an "old" compiler that 
didn't yet provide <tt>bool</tt>, <tt>true</tt>, and <tt>false</tt>, then the <tt>#define</tt>'s would provide a
simulation that worked for most purposes.
<p/>
It turns out that there is an unfortunate ambiguity in the name.  One interpretation is as shown above, but 
a different reading says "bool, true, and false are #define'd", i.e. that the meaning of the macro is to
assert that these names are macros (not built-in) ... which is true in C, but not in C++.
<p/>
In C++11, the name appears in parentheses followed by a stray period, so
some editorial change is needed in any event:
<p/>
17.13 <a href="https://timsong-cpp.github.io/cppwp/support.runtime">[support.runtime]</a> para 1:
</p>
<blockquote><p>
Headers <tt>&lt;csetjmp&gt;</tt> (nonlocal jumps), <tt>&lt;csignal&gt;</tt> (signal handling), <tt>&lt;cstdalign&gt;</tt> 
(alignment), <tt>&lt;cstdarg&gt;</tt> (variable arguments), <tt>&lt;cstdbool&gt;</tt> (<tt>__bool_true_false_are_defined</tt>). 
<tt>&lt;cstdlib&gt;</tt> (runtime environment <tt>getenv()</tt>, <tt>system()</tt>), and <tt>&lt;ctime&gt;</tt> 
(system clock <tt>clock()</tt>, <tt>time()</tt>) provide further compatibility with C code.
</p></blockquote>
<p>
However, para 2 says
</p>
<blockquote><p>
"The contents of these headers are the same as the Standard C library headers <tt>&lt;setjmp.h&gt;</tt>, 
<tt>&lt;signal.h&gt;</tt>, <tt>&lt;stdalign.h&gt;</tt>, <tt>&lt;stdarg.h&gt;</tt>, <tt>&lt;stdbool.h&gt;</tt>, 
<tt>&lt;stdlib.h&gt;</tt>, and <tt>&lt;time.h&gt;</tt>, respectively, with the following 
changes:",
</p></blockquote>
<p>
and para 8 says 
</p>
<blockquote><p>
"The header <tt>&lt;cstdbool&gt;</tt> and the header <tt>&lt;stdbool.h&gt;</tt> shall 
not define macros named <tt>bool</tt>, <tt>true</tt>, or <tt>false</tt>."
</p></blockquote>
<p>
Thus para 8 doesn't exempt the C++ implementation from the arguably clear requirement of the C standard, to 
provide a macro named <tt>__bool_true_false_are_defined</tt> defined to be 1.
<p/>
Real implementations of the C++ library differ, so the user cannot count upon any consistency; furthermore, the 
usefulness of the transition tool has faded long ago.
<p/>
That's why my suggestion is that both C and C++ standards should eliminate any mention of 
<tt>__bool_true_false_are_defined</tt>.  In that case, the name belongs to implementers to provide, or not, as 
they choose.
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Open.
</p>
<p>
While not strictly necessary, the clean-up look good.
</p>
<p>
We would like to hear from our C liaison before moving on this issue though.
</p>

<p><i>[2015-05 Lenexa]</i></p>

<p>
LWG agrees. Jonathan provides wording.
</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>The reference to &lt;cstdbool&gt; in p2 needs to be struck as well. Continue the discussion on the reflector once the DIS is available.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to N4296.</p>

<ol>
<li>
<p>Edit the footnote on 16.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/headers">[headers]</a> p7:</p>
<blockquote>
<p>
176) In particular, including <ins>any of</ins> the standard header<ins>s <tt>&lt;stdbool.h&gt;</tt>, <tt>&lt;cstdbool&gt;</tt>,</ins> <tt>&lt;iso646.h&gt;</tt> or <tt>&lt;ciso646&gt;</tt> has no effect.
</p>
</blockquote>
</li>

<li>
<p>Edit 17.13 <a href="https://timsong-cpp.github.io/cppwp/support.runtime">[support.runtime]</a> p1 as indicated (and remove the index entry for <tt>__bool_true_false_are_defined</tt>):</p>

<blockquote>
<p>
-1- Headers <tt>&lt;csetjmp&gt;</tt> (nonlocal jumps), <tt>&lt;csignal&gt;</tt> (signal handling), <tt>&lt;cstdalign&gt;</tt> (alignment), <tt>&lt;cstdarg&gt;</tt> (variable arguments), <tt>&lt;cstdbool&gt;</tt><ins>,</ins><del> (<tt>__bool_true_false_are_defined</tt>).</del> <tt>&lt;cstdlib&gt;</tt> (runtime environment <tt>getenv()</tt>, <tt>system()</tt>), and <tt>&lt;ctime&gt;</tt> (system clock <tt>clock()</tt>, <tt>time()</tt>) provide further compatibility with C code.
</p>
</blockquote>
</li>

<li>
<p>Remove Table 38 &mdash; Header <tt>&lt;cstdbool&gt;</tt> synopsis [tab:support.hdr.cstdbool] from 17.13 <a href="https://timsong-cpp.github.io/cppwp/support.runtime">[support.runtime]</a> </p>
<blockquote>
<table border="1">
<caption> Table 38 &mdash; Header <tt>&lt;cstdbool&gt;</tt> synopsis </caption>
<tr><td><b>Type</b></td><td><b>Name(s)</b></td></tr>
<tr><td><b>Macro:</b></td><td><tt>__bool_true_false_are_defined</tt></td></tr>
</table>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-03-18; Daniel comments and eliminates previously proposed wording]</i></p>

<p>
With the approval of <a href="http://wg21.link/p0619r4">P0619R4</a> in Rapperswil, the offending wording has now been eliminated 
from the working draft. I suggest to close this issue as: Resolved by <a href="http://wg21.link/p0619r4">P0619R4</a>.
</p>


<p><b>Rationale:</b></p>
Resolved by <a href="http://wg21.link/p0619r4">P0619R4</a>.


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2157" href="2157">2157.</a> How does <tt>std::array&lt;T,0&gt;</tt> initialization work when <tt>T</tt> is not default-constructible?</h3>
<p><b>Section:</b> 22.3.7.5 <a href="https://timsong-cpp.github.io/cppwp/array.zero">[array.zero]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daryle Walker <b>Opened:</b> 2012-05-08 <b>Last modified:</b> 2018-12-03 20:40:45 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#array.zero">issues</a> in [array.zero].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
Objects of <tt>std::array&lt;T,N&gt;</tt> are supposed to be initialized with aggregate initialization (when 
not the destination of a copy or move). This clearly works when <tt>N</tt> is positive. What happens when <tt>N</tt> 
is zero?  To continue using an (inner) set of braces for initialization, a <tt>std::array&lt;T,0&gt;</tt> implementation 
must have an array member of at least one element, and let default initialization take care of those secret elements.  
This cannot work when <tt>T</tt> has a set of constructors and the default constructor is deleted from that set.
Solution: Add a new paragraph in 22.3.7.5 <a href="https://timsong-cpp.github.io/cppwp/array.zero">[array.zero]</a>:
</p>
<blockquote><p>
The unspecified internal structure of array for this case shall allow initializations like:
</p>
<blockquote><pre>
array&lt;T, 0&gt; a = { };
</pre></blockquote>
<p>
and said initializations must be valid even when <tt>T</tt> is not default-constructible.
</p></blockquote>

<p><i>[2012, Portland: Move to Open]</i></p>

<p>
Some discussion to understand the issue, which is that implementations currently have freedom to implement
an empty <tt>array</tt> by holding a dummy element, and so might not support value initialization, which is
surprising when trying to construct an empty container.  However, this is not mandated, it is an unspecified
implementation detail.
</p>

<p>
Jeffrey points out that the implication of 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> is that this initialization syntax
must be supported by empty <tt>array</tt> objects already.  This is a surprising inference that was not
obvious to the room, but consensus is that the reading is accurate, so the proposed resolution is not necessary,
although the increased clarity may be useful.
</p>

<p>
Further observation is that the same clause effectively implies that <tt>T</tt> must always be DefaultConstructible,
regardless of <tt>N</tt> for the same reasons - as an <i>initializer-list</i> may not supply enough values, and the
remaining elements must all be value initialized.
</p>

<p>
Concern that we are dancing angels on the head of pin, and that relying on such subtle implications in wording is
not helpful. We need a clarification of the text in this area, and await wording.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
DK: What was the outcome of Portland? AM: Initially we thought we already had the intended behaviour. 
We concluded that <tt>T</tt> must always be <tt>DefaultConstructible</tt>, but I'm not sure why. GR: It's p2 in 
<tt>std::array</tt>, "up to <tt>N</tt>". AM: That wording already implies that "<tt>{}</tt>" has to work when <tt>N</tt> 
is zero. But the wording of p2 needs to be fixed to make clear that it does <em>not</em> imply that <tt>T</tt> must be 
<tt>DefaultConstructible</tt>.
<p/>
Conclusion: Update wording, revisit later. 
</p>


<p><i>[2015-10, Kona Saturday afternoon]</i></p>

<p>MC: How important is this? Can you not just use default construction for empty arrays? </p>
<p>TK: It needs to degenerate properly from a pack. STL agrees.</p> 
<p>JW: Yes, this is important, and we have to make it work.</p>
<p>MC: I hate the words "initialization like". </p>
<p>JW: I'll reword this.</p>
<p>WEB: Can I ask that once JW has reworded this we move it to Review rather than Open? </p>
<p>MC: We'll try to review it in a telecon and hopefully get it to tentatively ready.</p>
<p>STL: Double braces must also work: <tt>array&lt;T, 0&gt; a = {{}};</tt>.</p>
<p>Jonathan to reword.</p>

<p><i>[2018-03-14 Wednesday evening issues processing]</i></p>

<p>Jens suggested that we remove the requirement that <tt>begin() == end() == </tt><i>unique-value</i>, 
specifically the unique value part.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n3376">N3376</a>.</p>

<p>Add the following new paragraph between the current 22.3.7.5 <a href="https://timsong-cpp.github.io/cppwp/array.zero">[array.zero]</a> p1 and p2:</p>

<blockquote><p>
-1- <tt>array</tt> shall provide support for the special case <tt>N == 0</tt>.
<p/>
<ins>-?- The unspecified internal structure of <tt>array</tt> for this case shall allow initializations like:</ins>
</p>
<blockquote><pre>
<ins>array&lt;T, 0&gt; a = { };</ins>
</pre></blockquote>
<p>
<ins>and said initializations must be valid even when <tt>T</tt> is not default-constructible.</ins>
<p/>
-2- In the case that <tt>N == 0</tt>, <tt>begin() == end() ==</tt> unique value. The return value of 
<tt>data()</tt> is unspecified.
<p/>
-3- The effect of calling <tt>front()</tt> or <tt>back()</tt> for a zero-sized array is undefined.
<p/>
-4- Member function <tt>swap()</tt> shall have a <em>noexcept-specification</em> which is equivalent to 
<tt>noexcept(true)</tt>.
</p></blockquote>
</blockquote>

<p><i>[2018-06-14, Jonathan Wakely comments and provides revised wording]</i></p>

<p>
The new wording does not address the 2018-03-14 suggestion from Jens to remove the unique value. It wasn't
clear to me that there was consensus to make that change, and it would be a change in behaviour not just a 
clarification of the existing wording.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.
</p>

<p>Modify 22.3.7.5 <a href="https://timsong-cpp.github.io/cppwp/array.zero">[array.zero]</a> as indicated:</p>

<blockquote><p>
-1- <tt>array</tt> <del>shall</del> provide<ins>s</ins> support for the special case <ins>of a zero-sized <tt>array</tt> 
that is always empty, i.e.</ins> <tt>N == 0</tt><ins>, with the properties described in this subclause</ins>.
<p/>
<ins>-?- A zero-sized <tt>array</tt> type is an aggregate that meets the <tt>DefaultConstructible</tt> (Table 22) and 
<tt>CopyConstructible</tt> (Table 24) requirements. There is a single element of the aggregate, of an unspecified 
<tt>DefaultConstructible</tt> type. [<i>Note:</i> This allows initialization of the form <tt>array&lt;T, 0&gt; a = {{}};</tt>. 
There is no requirement for <tt>T</tt> to be <tt>DefaultConstructible</tt>. &mdash; <i>end note</i>]</ins>
<p/>
-2- <del>In the case that <tt>N == 0</tt>, <tt>begin() == end() ==</tt> unique value</del><ins><tt>begin()</tt> and <tt>end()</tt> return
non-dereferenceable iterators such that <tt>begin() == end()</tt> and <tt>a.begin() != b.begin()</tt> where <tt>a</tt> and <tt>b</tt> 
are distinct objects of the same zero-sized <tt>array</tt> type</ins>. The return value of <tt>data()</tt> is unspecified.
<p/>
-3- The effect of calling <tt>front()</tt> or <tt>back()</tt> for a zero-sized array is undefined.
<p/>
-4- Member function <tt>swap()</tt> <del>shall have</del><ins>has constant complexity and</ins> a non-throwing exception specification.
</p></blockquote>
</blockquote>


<p><i>[2018-08-30, Jonathan revises wording following feedback from Daniel Kruegler and Tim Song.]</i></p>

<p>
Daniel noted that it's undefined to compare iterators from different containers,
so <tt>a.begin() != b.begin()</tt> can't be used. That means whether the iterators
from different containers are unique is unobservable anyway.
We can say they don't share the same underlying sequence, which tells users they can't compare them
and tells implementors they can't return value-initialized iterators.
<br/>
Tim noted that it's not sufficient to say the unspecified type in a zero-sized array is DefaultConstructible,
it also needs to be constructible from <tt>= {}</tt>. Also, a zero-sized array should be CopyAssignable.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4762">N4762</a>.
</p>

<p>Modify 22.3.7.5 <a href="https://timsong-cpp.github.io/cppwp/array.zero">[array.zero]</a> as indicated:</p>

<blockquote><p>
-1- <tt>array</tt> <del>shall</del> provide<ins>s</ins> support for the special case <ins>of a zero-sized <tt>array</tt> 
that is always empty, i.e.</ins> <tt>N == 0</tt><ins>, with the properties described in this subclause</ins>.
<p/>
<ins>-?- A zero-sized <tt>array</tt> type is an aggregate that meets the <i>Cpp17DefaultConstructible</i> (Table 24) and 
<i>Cpp17CopyConstructible</i> (Table 26) and <i>Cpp17CopyAssignable</i> (Table 28) requirements. There is a single element of the aggregate, of an unspecified 
<i>Cpp17DefaultConstructible</i> type that is copy-list-initializable from an empty list.
[<i>Note:</i> This allows initialization of the form <tt>array&lt;T, 0&gt; a = {{}};</tt>. 
There is no requirement for <tt>T</tt> to be <i>Cpp17DefaultConstructible</i>. &mdash; <i>end note</i>]</ins>
<p/>
-2- <del>In the case that <tt>N == 0</tt>, <tt>begin() == end() ==</tt> unique value</del><ins><tt>begin()</tt> and <tt>end()</tt> return
non-dereferenceable iterators such that <tt>begin() == end()</tt>.
When <tt>a</tt> and <tt>b</tt> are distinct objects of the same zero-sized <tt>array</tt> type,
<tt>a.begin()</tt> and <tt>b.begin()</tt> are not iterators over the same underlying sequence. <i>[Note:</i> Therefore <tt>begin()</tt> does not return a value-initialized iterator &mdash; <i>end note]</i></ins>. The return value of <tt>data()</tt> is unspecified.
<p/>
-3- The effect of calling <tt>front()</tt> or <tt>back()</tt> for a zero-sized array is undefined.
<p/>
-4- Member function <tt>swap()</tt> <del>shall have</del><ins>has constant complexity and</ins> a non-throwing exception specification.
</p></blockquote>





<hr>
<h3><a name="2158" href="2158">2158.</a> Conditional copy&#47;move in <tt>std::vector</tt></h3>
<p><b>Section:</b> 22.3.11.3 <a href="https://timsong-cpp.github.io/cppwp/vector.capacity">[vector.capacity]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Nikolay Ivchenkov <b>Opened:</b> 2012-05-08 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#vector.capacity">issues</a> in [vector.capacity].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
There are various operations on <tt>std::vector</tt> that can cause elements of the vector to be 
moved from one location to another. A move operation can use either rvalue or const lvalue as 
argument; the choice depends on the value of <tt>!is_nothrow_move_constructible&lt;T&gt;::value &amp;&amp;
is_copy_constructible&lt;T&gt;::value</tt>, where <tt>T</tt> is the element type. Thus, some operations 
on <tt>std::vector</tt> (e.g. 'resize' with single parameter, 'reserve', 'emplace_back') should have 
conditional requirements. For example, let's consider the requirement for 'reserve' in N3376 &ndash; 
22.3.11.3 <a href="https://timsong-cpp.github.io/cppwp/vector.capacity">[vector.capacity]</a>&#47;2:
</p>
<blockquote><p>
<i>Requires</i>: <tt>T</tt> shall be <tt>MoveInsertable</tt> into <tt>*this</tt>.
</p></blockquote>
<p>
This requirement is not sufficient if an implementation is free to select copy constructor when 
<tt>!is_nothrow_move_constructible&lt;T&gt;::value &amp;&amp; is_copy_constructible&lt;T&gt;::value</tt> 
evaluates to true. Unfortunately, <tt>is_copy_constructible</tt> cannot reliably determine whether 
<tt>T</tt> is really copy-constructible. A class may contain public non-deleted copy constructor whose 
definition does not exist or cannot be instantiated successfully (e.g., 
<tt>std::vector&lt;std::unique_ptr&lt;int&gt;&gt;</tt> has copy constructor, but this type is not 
copy-constructible). Thus, the actual requirements should be:
</p>
<ul>
<li><p>
if <tt>!is_nothrow_move_constructible&lt;T&gt;::value &amp;&amp; is_copy_constructible&lt;T&gt;::value</tt> 
then <tt>T</tt> shall be <tt>CopyInsertable</tt> into <tt>*this</tt>;
</p></li>
<li><p>
otherwise <tt>T</tt> shall be <tt>MoveInsertable</tt> into <tt>*this</tt>.
</p></li>
</ul>
<p>
Maybe it would be useful to introduce a new name for such conditional requirement (in addition to 
"<tt>CopyInsertable</tt>" and "<tt>MoveInsertable</tt>").
</p>

<p><i>[2016-08 Chicago]</i></p>

<p>
The problem does not appear to be as severe as described. The <tt>MoveInsertable</tt>
requirements are consistently correct, but an issue may arise on the
exception-safety guarantees when we check for
<tt>is_copy_constructible_v&lt;T&gt;</tt>.  The problem, as described, is
typically for templates that appear to have a copy constructor, but one that
fails to compile once instantiated, and so gives a misleading result for the
trait.
</p>
<p>
In general, users should not provide such types, and the standard would not
serve users well by trying to address support for such types.  However, the
standard should not be providing such types either, such as
<tt>vector&lt;unique_ptr&lt;T&gt;&gt;</tt>.  A possible resolution would be
to tighten the constraints in Table 80 &mdash; Container Requirements, so that if
the Requirements for the copy constructor/assingment operator of a container
are not satisfied, that operation shall be deleted.
</p>
<p>
A futher problem highlighted by this approach is that there are no constraints on
the copy-assignment operator, so that <tt>vector&lt;unique_ptr&lt;T&gt;&gt;</tt>
should be <tt>CopyAssignable</tt>! However, we can lift the equivalent constraints from
the Allocator-aware container requirements.
</p>

<p><i>[08-2016, Chicago]</i></p>

<p>Fri PM: Move to Open</p>

<p><i>[2017-11 Albuquerque Saturday issues processing]</i></p>

<p>There's a bunch of uses of "shall" here that are incorrect. Also, CopyInsertable contains some semantic requirements, 
which can't be checked at compile time, so 'ill-formed' is not possible for detecting that.</p>

<p><i>[2018-06 Rapperswil Wednesday issues processing]</i></p>

<p>Daniel to provide updated wording.</p>

<p><i>[2018-06-12, Daniel provides revised wording]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to <a href="http://wg21.link/n4606">N4606</a>.
</p>

<p>
<table border="1">
<caption> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> Table 80 &mdash; Container requirements </caption>
<tr>
  <td><b>Expression</b></td>
  <td><b>Return type</b></td>
  <td><b>Operational semantics</b></td>
  <td><b>Assertion/note/pre-/post-condition</b></td>
  <td><b>Complexity</b></td>
</tr>
<tr>
  <td><tt>X(a)</tt></td>
  <td></td>
  <td></td>
  <td>
    <i>Requires:</i> <tt>T</tt> is <tt>CopyInsertable</tt> into
    <tt>X</tt> (see below)<del>.</del><ins>, otherwise this expression shall be ill-formed.</ins><br/>
    post: <tt>a == X(a)</tt>.
  </td>
  <td>linear</td>
</tr>
<tr>
  <td><tt>X u(a)</tt><br/><tt>X u = a;</tt></td>
  <td></td>
  <td></td>
  <td>
    <i>Requires:</i> <tt>T</tt> is <tt>CopyInsertable</tt> into
    <tt>X</tt> (see below)<del>.</del><ins>, otherwise this expression shall be ill-formed.</ins><br/>
    post: <tt>u == a</tt>.
  </td>
  <td>linear</td>
</tr>
<tr>
  <td>...</td>
  <td>...</td>
  <td>...</td>
  <td>...</td>
  <td>...</td>
</tr>
<tr>
  <td><tt>r = a</tt></td>
  <td><tt>X&amp;</tt></td>
  <td></td>
  <td>
    <ins><i>Requires:</i> <tt>T</tt> is <tt>CopyInsertable</tt> into <tt>X</tt>
    and <tt>CopyAssignable</tt>, otherwise this expression shall be ill-formed.</ins><br/>
    post: <tt>r == a</tt>.</td>
  <td>linear</td>
</tr>
</table>
</p>

<p>
<table border="1">
<caption> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> Table 83 &mdash; Allocator-aware container requirements </caption>
<tr>
  <td><b>Expression</b></td>
  <td><b>Return type</b></td>
  <td><b>Operational semantics</b></td>
  <td><b>Assertion/note/pre-/post-condition</b></td>
  <td><b>Complexity</b></td>
</tr>
<tr>
  <td><tt>a = t</tt></td>
  <td><tt>X&amp;</tt></td>
  <td></td>
  <td>
    <i>Requires:</i> <tt>T</tt> is <tt>CopyInsertable</tt> into <tt>X</tt> and
    <tt>CopyAssignable</tt><del>.</del><ins>, otherwise this  expression shall
    be ill-formed</ins><br/>
    post: <tt>r == a</tt>.</td>
  <td>linear</td>
</tr>
</table>
</p>
</blockquote>

<p><i>[2018-08-23 Batavia Issues processing. Priority to 3]</i></p>

<p>Changed <tt>CopyInsertable</tt> -> <tt>Cpp17CopyInsertable</tt> in the resolution.</p>
<p>Tim says that the wording is not quite right - it imposes additional requirements.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.
</p>

<blockquote class="note">
<p>
The revised wording below uses the new <i>Mandates:</i> element introduced by
adopting <a href="http://wg21.link/p0788r3">P0788R3</a> at the Rapperswil meeting 2018 
and which will become a new term of art with Jonathan's omnibus paper throughout the
Standard Library.
</p>
</blockquote>

<p>
<table border="1">
<caption> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> Table 77 &mdash; Container requirements </caption>
<tr>
  <td><b>Expression</b></td>
  <td><b>Return type</b></td>
  <td><b>Operational semantics</b></td>
  <td><b>Assertion/note/pre-/post-condition</b></td>
  <td><b>Complexity</b></td>
</tr>
<tr>
  <td><tt>X(a)</tt></td>
  <td></td>
  <td></td>
  <td>
    <ins><i>Mandates:</i> Syntactic requirements of <tt>T</tt><br/> 
    is <tt>Cpp17CopyInsertable</tt> into <tt>X</tt> (see below).</ins><br/>
    <i>Requires:</i> <tt>T</tt> is <tt>Cpp17CopyInsertable</tt> into
    <tt>X</tt> <del>(see below)</del>.<br/>
    post: <tt>a == X(a)</tt>.
  </td>
  <td>linear</td>
</tr>
<tr>
  <td><tt>X u(a)</tt><br/><tt>X u = a;</tt></td>
  <td></td>
  <td></td>
  <td>
    <ins><i>Mandates:</i> Syntactic requirements of <tt>T</tt><br/> 
    is <tt>Cpp17CopyInsertable</tt> into <tt>X</tt> (see below).</ins><br/>
    <i>Requires:</i> <tt>T</tt> is <tt>Cpp17CopyInsertable</tt> into
    <tt>X</tt> <del>(see below)</del>.<br/>
    post: <tt>u == a</tt>.
  </td>
  <td>linear</td>
</tr>
<tr>
  <td>...</td>
  <td>...</td>
  <td>...</td>
  <td>...</td>
  <td>...</td>
</tr>
<tr>
  <td><tt>r = a</tt></td>
  <td><tt>X&amp;</tt></td>
  <td></td>
  <td>
    <ins><i>Mandates:</i> Syntactic requirements of <tt>T</tt><br/> 
    is <tt>Cpp17CopyInsertable</tt> into <tt>X</tt> (see below) and
    <tt>CopyAssignable</tt>.<br/></ins>
    <ins><i>Requires:</i> <tt>T</tt> is <tt>Cpp17CopyInsertable</tt> into <tt>X</tt>
    and <tt>CopyAssignable</tt>.</ins><br/>
    post: <tt>r == a</tt>.</td>
  <td>linear</td>
</tr>
</table>
</p>

<p>
<table border="1">
<caption> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> Table 80 &mdash; Allocator-aware container requirements </caption>
<tr>
  <td><b>Expression</b></td>
  <td><b>Return type</b></td>
  <td><b>Operational semantics</b></td>
  <td><b>Assertion/note/pre-/post-condition</b></td>
  <td><b>Complexity</b></td>
</tr>
<tr>
  <td><tt>a = t</tt></td>
  <td><tt>X&amp;</tt></td>
  <td></td>
  <td>
    <ins><i>Mandates:</i> Syntactic requirements of <tt>T</tt> is<br/> 
    <tt>Cpp17CopyInsertable</tt> into <tt>X</tt> and <tt>CopyAssignable</tt>.<br/></ins>
    <i>Requires:</i> <tt>T</tt> is <tt>Cpp17CopyInsertable</tt> into <tt>X</tt> and
    <tt>CopyAssignable</tt>.<br/>
    post: <tt>r == a</tt>.</td>
  <td>linear</td>
</tr>
</table>
</p>






<hr>
<h3><a name="2173" href="2173">2173.</a> The meaning of <code>operator +</code> in the description of the algorithms</h3>
<p><b>Section:</b> 25 <a href="https://timsong-cpp.github.io/cppwp/algorithms">[algorithms]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Nikolay Ivchenkov <b>Opened:</b> 2012-08-01 <b>Last modified:</b> 2018-06-12 02:06:47 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#algorithms">active issues</a> in [algorithms].</p>
<p><b>View all other</b> <a href="lwg-index.html#algorithms">issues</a> in [algorithms].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
According to 25.1 <a href="https://timsong-cpp.github.io/cppwp/algorithms.general">[algorithms.general]</a>/12,
</p>
<blockquote><p>
In the description of the algorithms operators <tt>+</tt> and <tt>-</tt> are used for some of the iterator categories 
for which they do not have to be defined. In these cases the semantics of <tt>a+n</tt> is the same as that of
</p>
<blockquote><pre>
X tmp = a;
advance(tmp, n);
return tmp;
</pre></blockquote>
</blockquote>
<p>
There are several places where such operator <tt>+</tt> is applied to an output iterator &mdash; for example, see the 
description of <tt>std::copy</tt>:
</p>
<blockquote><pre>
template&lt;class InputIterator, class OutputIterator&gt;
OutputIterator copy(InputIterator first, InputIterator last,
                    OutputIterator result);
</pre>
<blockquote><p>
-1- <i>Effects</i>: Copies elements in the range <tt>[first,last)</tt> into the range <tt>[result,result + (last -
first))</tt> starting from <tt>first</tt> and proceeding to <tt>last</tt>. For each non-negative integer 
<tt>n &lt; (last - first)</tt>, performs <tt>*(result + n) = *(first + n)</tt>.
</p></blockquote></blockquote>
<p>
<tt>std::advance</tt> is not supposed to be applicable to output iterators, so we need a different method of description.
<p/>
See also message <a href="http://listarchives.isocpp.org/cgi-bin/wg21/message?wg=lib&amp;msg=32908">c++std-lib-32908</a>.
</p>

<p><i>[2014-06-07 Daniel comments and provides wording]</i></p>

<p>
The specification for output iterators is somewhat tricky, because here a sequence of increments is required to
be combined with intervening <em>assignments</em> to the dereferenced iterator. I tried to respect this
fact by using a conceptual assignment operation as part of the specification.
<p/>
Another problem in the provided as-if-code is the question which requirements are imposed on <tt>n</tt>. Unfortunately,
the corresponding function <tt>advance</tt> is completely underspecified in this regard, so I couldn't borrow wording
from it. We cannot even assume here that <tt>n</tt> is the difference type of the iterator, because for output iterators there is
no requirements for this associated type to be defined. The presented wording attempts to minimize assumptions, but still
can be considered as controversial. 
</p>

<p><i>[2018-06 Rapperswil Wednesday issues processing]</i></p>

<p>Status to Open</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4606.</p>

<ol>
<li><p>Change 25.1 <a href="https://timsong-cpp.github.io/cppwp/algorithms.general">[algorithms.general]</a> around p12 as indicated:</p>

<blockquote>
<p>
-12- In the description of the algorithms operators <tt>+</tt> and <tt>-</tt> are used for some of the iterator categories for which
they do not have to be defined. In these cases the semantics of <tt>a+n</tt> is the same as that of
</p>
<blockquote>
<pre>
X tmp = a;
advance(tmp, n);
return tmp;
</pre>
</blockquote>
<p>
<ins>when <tt>X</tt> meets the input iterator requirements (23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>), otherwise it is the same as that of</ins>
</p>
<blockquote>
<pre>
<ins>X tmp = a;
for (auto i = n; i; ++tmp, (void) --i) 
  *tmp = <i>Expr</i>(i); 
return tmp;</ins>
</pre>
</blockquote>
<p>
<ins>where <tt><i>Expr</i>(i)</tt> denotes the <tt>(n-i)</tt><sup>th</sup> expression that is assigned to for the corresponding algorithm;</ins> and that of <tt>b-a</tt> is the same as of
</p>
<blockquote>
<pre>
return distance(a, b);
</pre>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2189" href="2189">2189.</a> Throwing <tt>swap</tt> breaks unordered containers' state</h3>
<p><b>Section:</b> 22.2.7.1 <a href="https://timsong-cpp.github.io/cppwp/unord.req.except">[unord.req.except]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2012-09-23 <b>Last modified:</b> 2019-07-22 17:12:46 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The hash functor and key-comparison functor of unordered containers are allowed to throw on <tt>swap</tt>.
</p>
<p>
22.2.7.1 <a href="https://timsong-cpp.github.io/cppwp/unord.req.except">[unord.req.except]</a>p3 "For unordered associative containers, no <tt>swap</tt> function throws
an exception unless that exception is thrown by the swap of the container's Hash or Pred object (if any)."
</p>
<p>
In such a case we must offer the basic exception safety guarantee, where both objects are left in valid
but unspecified states, and no resources are leaked.  This yields a corrupt, un-usable container if the
first <tt>swap</tt> succeeds, but the second fails by throwing, as the functors form a matched pair.
</p>
<p>
So our basic scenario is first, swap the allocators if the allocators propagate on swap, according to
<tt>allocator_traits</tt>.  Next we swap the pointers to our internal hash table data structures, so that
they match the allocators that allocated them.  (Typically, this operation cannot throw).  Now our containers
are back in a safely destructible state if an exception follows.
</p>
<p>
Next, let's say we swap the hash functor, and that throws.  We have a corrupt data structure, in that the
buckets are not correctly indexed by the correct functors, lookups will give unpredicatable results etc.
We can safely restore a usable state by forcibly clearing each container - which does not leak resources
and leaves us with two (empty but) usable containers.
</p>
<p>
Now let us assume that the hasher swap succeeds.  Next we swap the equality comparator functor, and this
too could throw. The important point to bear in mind is that these two functors form an important pairing
- two objects that compare equal by the equality functor must also hash to the same value.  If we swap
one without the other, we most likely leave the container in an unusable state, even if we clear out all
elements.
</p>
<p>
1. A colleague pointed out that the solution for this is to dynamically allocate the two functors, and then
we need only swap pointers, which is not a throwing operation.  And if we don't want to allocate on default
construction (a common QoI request), we might consider moving to a dynamically allocated functors whenever
<tt>swap</tt> is called, or on first insertion.  Of course, allocating memory in <tt>swap</tt> is a whole
new can of worms, but this does not really sound like the design we had intended.
</p>

<p>
2. The simplest option is to say that we do not support hasher or equality functors that throw on ADL
<tt>swap</tt>.  Note that the requirement is simply to not throw, rather than to be explicitly
marked as <tt>noexcept</tt>.  Throwing functors are allowed, so long as we never use values that
would actually manifest a throw when used in an unordered container.
</p>

<p>
Pablo went on to give me several more options, to be sure we have a full set to consider:
</p>
<p>
3. Disallow one or the other functor from throwing.  In that case, the 
possibly-throwing functor must be swapped first, then the other functor, 
the allocator, and the data pointer(s) afterwards (in any order -- there 
was a TC that allocator assignment and swap may not throw if the 
corresponding propagation trait is true.). Of course, the question 
becomes: which functor is allowed to throw and which one is not?
</p>
<p>
4. Require that any successful functor <tt>swap</tt> be reliably reversible.  
This is very inventive.  I know of no other place in the standard where 
such a requirement is stated, though I have occasionally wanted such a 
guarantee.
</p>
<p>
5. Allow a failed swap to leave the containers in a state where future 
insertions may fail for reasons other than is currently allowed.  
Specifically, if the hash and equality functors are out of sync, all 
insertions will fail.  Presumably some "incompletely swapped" exception 
would be thrown.  This is "slightly" inventive, although people have been 
discussing "radioactive" states for a while.
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Open.
</p>

<p><i>[2019 Cologne Wednesday night]</i></p>

<p>Billy to write resolution for option #2. This may require a paper.</p>


<p><b>Proposed resolution:</b></p>






<hr>
<h3><a name="2191" href="2191">2191.</a> Incorrect specification of <tt>match_results(match_results&amp;&amp;)</tt></h3>
<p><b>Section:</b> 30.10.1 <a href="https://timsong-cpp.github.io/cppwp/re.results.const">[re.results.const]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Pete Becker <b>Opened:</b> 2012-10-02 <b>Last modified:</b> 2019-03-26 18:50:54 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#re.results.const">issues</a> in [re.results.const].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>

<p>
30.10.1 <a href="https://timsong-cpp.github.io/cppwp/re.results.const">[re.results.const]</a>/3: "Move-constructs an object of class <tt>match_results</tt> satisfying the same 
postconditions as Table 141."
</p>
<p>
Table 141 lists various member functions and says that their results should be the results of the corresponding member 
function calls on <tt>m</tt>. But <tt>m</tt> has been moved from, so the actual requirement ought to be based on the 
value that <tt>m</tt> had <em>before</em> the move construction, not on <tt>m</tt> itself.
</p>
<p>
In addition to that, the requirements for the copy constructor should refer to Table 141.
<p/>
<u>Ganesh</u>:
<p/>
Also, the requirements for move-assignment should refer to Table 141. Further it seems as if in Table 141 all phrases of
"for all integers <tt>n &lt; m.size()</tt>" should be replaced by "for all <em>unsigned</em> integers 
<tt>n &lt; m.size()</tt>".
</p>

<p><i>[2019-03-26; Daniel comments and provides wording]</i></p>

<p>
The previous Table 141 (Now Table 128 in <a href="http://wg21.link/n4810">N4810</a>) has been modified to cover now
the effects of move/copy constructors and move/copy assignment operators. Newly added wording now clarifies that for
move operations the corresponding values refer to the values of the move source <em>before</em> the operation has started.
<p/>
Re Ganesh's proposal: Note that no further wording is needed for the move-assignment operator, because in the current 
working draft the move-assignment operator's <i>Effects:</i> element refers already to Table 128. The suggested clarification
of <em>unsigned</em> integers has been implemented by referring to <em>non-negative</em> integers instead.
<p/>
Upon suggestion from Casey, the wording also introduces <i>Ensures:</i> elements that refer to Table 128 and as drive-by fix
eliminates a "<i>Throws:</i> Nothing." element from a <tt>noexcept</tt> function.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Add a new paragraph at the beginning of 30.10.1 <a href="https://timsong-cpp.github.io/cppwp/re.results.const">[re.results.const]</a> as indicated:</p>

<blockquote><p>
<ins>-?- Table 128 lists the postconditions of <tt>match_results</tt> copy/move constructors and copy/move assignment
operators. For move operations, the results of the expressions depending on the parameter <tt>m</tt> denote the values
they had before the respective function calls.</ins>
</p></blockquote>

</li>

<li><p>Modify 30.10.1 <a href="https://timsong-cpp.github.io/cppwp/re.results.const">[re.results.const]</a> as indicated:</p>

<blockquote>
<pre>
match_results(const match_results&amp; m);
</pre>
<blockquote>
<p>
-3- <i>Effects:</i> Constructs <del>an object of class <tt>match_results</tt>, as</del> a copy of <tt>m</tt>.
<p/>
<ins>-?- <i>Ensures:</i> As indicated in Table 128.</ins>
</p>
</blockquote>
<pre>
match_results(match_results&amp;&amp; m) noexcept;
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> Move constructs <del>an object of class <tt>match_results</tt></del> from <tt>m</tt> 
<del>satisfying the same postconditions as Table 128. Additionally</del>, the stored <tt>Allocator</tt> value 
is move constructed from <tt>m.get_allocator()</tt>.
<p/>
<ins>-?- <i>Ensures:</i> As indicated in Table 128.</ins>
<p/>
<del>-5- <i>Throws:</i> Nothing.</del>
</p>
</blockquote>
<pre>
match_results&amp; operator=(const match_results&amp; m);
</pre>
<blockquote>
<p>
-6- <i>Effects:</i> Assigns <tt>m</tt> to <tt>*this</tt>. <del>The postconditions of this function are indicated 
in Table 128.</del>
<p/>
<ins>-?- <i>Ensures:</i> As indicated in Table 128.</ins>
</p>
</blockquote>
<pre>
match_results&amp; operator=(match_results&amp;&amp; m);
</pre>
<blockquote>
<p>
-7- <i>Effects:</i> Move<del>-</del><ins> </ins>assigns <tt>m</tt> to <tt>*this</tt>. <del>The postconditions of 
this function are indicated in Table 128.</del>
<p/>
<ins>-?- <i>Ensures:</i> As indicated in Table 128.</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Modify 30.10.1 <a href="https://timsong-cpp.github.io/cppwp/re.results.const">[re.results.const]</a>, Table 128 &mdash; "<tt>match_results</tt> assignment operator effects", as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 128 &mdash; <tt>match_results</tt> <del>assignment operator effects</del><ins>copy/move operation postconditions</ins></caption>
<tr style="text-align:center">
<th>Element</th>
<th>Value</th>
</tr>
<tr>
<td>
<tt>ready()</tt>
</td>
<td>
<tt>m.ready()</tt>
</td>
</tr>
<tr>
<td>
<tt>size()</tt>
</td>
<td>
<tt>m.size()</tt>
</td>
</tr>
<tr>
<td>
<tt>str(n)</tt>
</td>
<td>
<tt>m.str(n)</tt> for all <ins>non-negative</ins> integers <tt>n &lt; m.size()</tt>
</td>
</tr>
<tr>
<td>
<tt>prefix()</tt>
</td>
<td>
<tt>m.prefix()</tt>
</td>
</tr>
<tr>
<td>
<tt>suffix()</tt>
</td>
<td>
<tt>m.suffix()</tt>
</td>
</tr>
<tr>
<td>
<tt>(*this)[n]</tt>
</td>
<td>
<tt>m[n]</tt> for all <ins>non-negative</ins> integers <tt>n &lt; m.size()</tt>
</td>
</tr>
<tr>
<td>
<tt>length(n)</tt>
</td>
<td>
<tt>m.length(n)</tt> for all <ins>non-negative</ins> integers <tt>n &lt; m.size()</tt>
</td>
</tr>
<tr>
<td>
<tt>position(n)</tt>
</td>
<td>
<tt>m.position(n)</tt> for all <ins>non-negative</ins> integers <tt>n &lt; m.size()</tt>
</td>
</tr>
</table>
</blockquote>


</li>

</ol>





<hr>
<h3><a name="2195" href="2195">2195.</a> Missing constructors for <tt>match_results</tt></h3>
<p><b>Section:</b> 30.10 <a href="https://timsong-cpp.github.io/cppwp/re.results">[re.results]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2012-10-06 <b>Last modified:</b> 2019-03-27 18:08:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#re.results">issues</a> in [re.results].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The requirement expressed in 30.10 <a href="https://timsong-cpp.github.io/cppwp/re.results">[re.results]</a> p2
</p>
<blockquote><p>
The class template <tt>match_results</tt> shall satisfy the requirements of an allocator-aware container and of a
sequence container, as specified in 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>, except that only operations defined for 
const-qualified sequence containers are supported.
</p></blockquote>
<p>
can be read to require the existence of the described constructors from as well, but they do not exist in the
synopsis. 
<p/>
The missing sequence constructors are: 
</p>
<blockquote><pre>
match_results(initializer_list&lt;value_type&gt;);
match_results(size_type, const value_type&amp;);
template&lt;class InputIterator&gt; match_results(InputIterator, InputIterator);
</pre></blockquote>
<p>
The missing allocator-aware container constructors are:
</p>
<blockquote><pre>
match_results(const match_results&amp;, const Allocator&amp;);
match_results(match_results&amp;&amp;, const Allocator&amp;);
</pre></blockquote>
<p>
It should be clarified, whether (a) constructors are an exception of above mentioned operations or (b) whether
at least some of them (like those accepting a <tt>match_results</tt> value and an allocator) should be added.
<p/>
As visible in several places of the standard (including the core language), constructors seem usually to be considered 
as "operations" and they certainly can be invoked for const-qualified objects.
<p/>
The below given proposed resolution applies only the minimum necessary fix, i.e. it excludes constructors from
above requirement. 
</p>

<p><i>[2013-04-20, Bristol]</i></p>

<p>Check current implementations to see what they do and, possibly, write a paper.</p>

<p><i>[2013-09 Chicago]</i></p>

<p>Ask Daniel to update the proposed wording to include the allocator copy and move constructors.</p>

<p><i>[2014-01-18 Daniel changes proposed resolution]</i></p>

<p><strong>Previous resolution from Daniel [SUPERSEDED]:</strong></p>

<blockquote class="note">
<ol>
<li><p>Change 30.10 <a href="https://timsong-cpp.github.io/cppwp/re.results">[re.results]</a> p2 as indicated:</p>
<blockquote><p>
The class template <tt>match_results</tt> shall satisfy the requirements of an allocator-aware container and of a
sequence container, as specified in 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>, except that only operations defined for 
const-qualified sequence containers <ins>that are not constructors</ins> are supported.
</p></blockquote>
</li>
</ol>
</blockquote>

<p><i>[2015-05-06 Lenexa]</i></p>

<p>MC passes important knowledge to EF.</p>
<p>VV, RP: Looks good.</p>
<p>TK: Second form should be conditionally noexcept</p>
<p>JY: Sequence constructors are not here, but mentioned in the issue writeup. Why?</p>
<p>TK: That would have been fixed by the superseded wording.</p>
<p>JW: How does this interact with Mike Spertus' allocator-aware regexes? [...] Perhaps it doesn't.</p>
<p>JW: Can't create match_results, want both old and new resolution.</p>
<p>JY: It's problematic that users can't create these, but not this issue.</p>
<p>VV: Why conditional noexcept?</p>
<p>MC: Allocator move might throw.</p>
<p>JW: Update superseded wording to "only non-constructor operations that are"?</p>
<p>MC: Only keep superseded, but append "and the means of constructing match_results are limited to [...]"?</p>
<p>JY: Bullet 4 paragraph 2 needs to address the allocator constructor.</p>
<p>Assigned to JW for drafting.</p>

<p><i>[2015-10, Kona Saturday afternoon]</i></p>

<p>STL: I want Mike Spertus to be aware of this issue.</p>

<strong>Previous resolution from Daniel [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to N3936.</p>

<ol>
<li><p>Change 30.10 <a href="https://timsong-cpp.github.io/cppwp/re.results">[re.results]</a> p4, class template <tt>match_results</tt> synopsis, as indicated:</p>
<blockquote><pre>
[&hellip;]
// 28.10.1, construct/copy/destroy:
explicit match_results(const Allocator&amp; a = Allocator());
match_results(const match_results&amp; m);
<ins>match_results(const match_results&amp; m, const Allocator&amp; a);</ins>
match_results(match_results&amp;&amp; m) noexcept;
<ins>match_results(match_results&amp;&amp; m, const Allocator&amp; a) noexcept;</ins>
[&hellip;]
</pre></blockquote>
</li>

<li><p>Change 30.10.1 <a href="https://timsong-cpp.github.io/cppwp/re.results.const">[re.results.const]</a>  as indicated: [<i>Drafting note:</i> Paragraph 6 as currently written,
makes not much sense, because the <tt>noexcept</tt> does not allow any exception to propagate. Further-on, the allocator requirements
do not allow for throwing move constructors. Deleting it seems to be near to editorial &mdash; <i>end drafting note</i>]</p>
<blockquote>

<pre>
match_results(const match_results&amp; m);
<ins>match_results(const match_results&amp; m, const Allocator&amp; a);</ins>
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> Constructs an object of class <tt>match_results</tt>, as a copy of <tt>m</tt>.
</p>
</blockquote>

<pre>
match_results(match_results&amp;&amp; m) noexcept;
<ins>match_results(match_results&amp;&amp; m, const Allocator&amp; a) noexcept;</ins>
</pre>
<blockquote>
<p>
-5- <i>Effects:</i> Move-constructs an object of class <tt>match_results</tt> from <tt>m</tt> satisfying the same postconditions
as Table 142. <del>Additionally</del><ins>For the first form</ins>, the stored <tt>Allocator</tt> value is move constructed 
from <tt>m.get_allocator()</tt>.
<p/>
<del>-6- <i>Throws:</i> Nothing if the allocator's move constructor throws nothing.</del>
</p>
</blockquote>

</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-03-27 Jonathan updates proposed resolution]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<p>
These edits overlap with the proposed resolution of <a href="2191">2191</a>
but it should be obvious how to resolve the conflicts.
Both resolutions remove the word "Additionally" from p4.
Issue 2191 removes the entire <i>Throws:</i> element in p5 but this issue
replaces it with different text that applies to the new constructor only.
</p>

<ol>
<li><p>Change 30.10 <a href="https://timsong-cpp.github.io/cppwp/re.results">[re.results]</a> p4, class template <tt>match_results</tt> synopsis, as indicated:</p>
<blockquote><pre>
[&hellip;]
// 30.10.1, construct/copy/destroy:
explicit match_results(const Allocator&amp; a = Allocator());
match_results(const match_results&amp; m);
<ins>match_results(const match_results&amp; m, const Allocator&amp; a);</ins>
match_results(match_results&amp;&amp; m) noexcept;
<ins>match_results(match_results&amp;&amp; m, const Allocator&amp; a);</ins>
[&hellip;]
</pre></blockquote>
</li>

<li><p>Change 30.10.1 <a href="https://timsong-cpp.github.io/cppwp/re.results.const">[re.results.const]</a>  as indicated:</p>
<blockquote>

<pre>
match_results(const match_results&amp; m);
<ins>match_results(const match_results&amp; m, const Allocator&amp; a);</ins>
</pre>
<blockquote>
<p>
-3- <i>Effects:</i> Constructs an object of class <tt>match_results</tt>, as a copy of <tt>m</tt>.
<ins>For the second form, the stored <tt>Allocator</tt> value is constructed from <tt>a</tt>.</ins>
</p>
</blockquote>

<pre>
match_results(match_results&amp;&amp; m) noexcept;
<ins>match_results(match_results&amp;&amp; m, const Allocator&amp; a);</ins>
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> Move-constructs an object of class <tt>match_results</tt> from <tt>m</tt> satisfying the same postconditions
as Table 128. <del>Additionally</del><ins>For the first form</ins>, the stored <tt>Allocator</tt> value is move constructed
from <tt>m.get_allocator()</tt>.
<ins>For the second form, the stored <tt>Allocator</tt> value is constructed from <tt>a</tt>.</ins>
</p>
<p>
-6- <i>Throws:</i> <del>Nothing.</del>
<ins>The second form throws nothing if <tt>a == m.get_allocator()</tt>.</ins>
</p>
</blockquote>

</blockquote>
</li>
</ol>






<hr>
<h3><a name="2198" href="2198">2198.</a> <tt>max_load_factor(z)</tt> makes no strong guarantees, but bans useful behavior</h3>
<p><b>Section:</b> 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2012-10-09 <b>Last modified:</b> 2016-12-10 13:58:32 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#unord.req">active issues</a> in [unord.req].</p>
<p><b>View all other</b> <a href="lwg-index.html#unord.req">issues</a> in [unord.req].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The user cannot specify a <tt>max_load_factor</tt> for their unordered container
at construction, it must be supplied after the event, when the container is
potentially not empty.  The contract for this method is deliberately vague, not
guaranteeing to use the value supplied by the user, and any value actually used
will be used as a ceiling that the container will <i>attempt</i> to respect.
</p>
<p>
The only guarantee we have is that, if user requests a <tt>max_load_factor</tt>
that is less than the current <tt>load_factor</tt>, then the operation will take
constant time, thus outlawing an implementation that chooses to rehash and so
preserve as a class invariant that <tt>load_factor &lt; max_load_factor</tt>.
</p>
<p>
Reasonable options conforming to the standard include ignoring the user's request
if the requested value is too low, or deferring the rehash to the next <tt>insert</tt>
operation and allowing the container to have a strange state (wrt <tt>max_load_factor</tt>)
until then - and there is still the question of rehashing if the next <tt>insert</tt>
is for a duplicate key in a unique container.
</p>
<p>
Given the deliberate vagueness of the current wording, to support a range of reasonable
(but not <i>perfect</i>) behaviors, it is not clear why the equally reasonable rehash
to restore the constraint should be outlawed.  It is not thought that this is a performance
critical operation, where users will be repeatedly setting low load factors on populated
containers, in a tight or (less unlikely) an instant response scenario.
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Open.
</p>
<p>
Alisdair to provide wording.
</p>
<p><i>[2016-11-12, Issaquah]</i></p>

<p>Sat PM: Howard to provide wording</p>

<p><i>[2016-11-17 Howard provided wording.]</i></p>


<blockquote>
<p>
The provided wording is consistent with LWG discussion in Issaquah.  An implementation
of the proposed wording would be setting <tt>max_load_factor()</tt> to
<tt>max(z, load_factor())</tt>.  This preserves the container invariant:
</p>
<blockquote><pre>
load_factor() &lt;= max_load_factor()
</pre></blockquote>
<p>
And it preserves the existing behavior that no rehash is done by this operation.
</p>
<p>
If it is desired to change the <tt>max_load_factor()</tt> to something smaller than
the current <tt>load_factor()</tt> that can be done by <i>first reducing</i> the
current <tt>load_factor()</tt> by either increasing <tt>bucket_count()</tt> (via
<tt>rehash</tt> or <tt>reserve</tt>), or decreasing <tt>size()</tt> (e.g.
<tt>erase</tt>), <i>and then</i> changing <tt>max_load_factor()</tt>.
</p>

<p>
This resolution reaffirms that <tt>load_factor() &lt;= max_load_factor()</tt> is a
container invariant which can <i>never</i> be violated.
</p>
</blockquote>

<p><i>[2016-11-27, Nico comments]</i></p>

<p>
Current implementations behave differently. 
<p/>
In regard to the sentence
<blockquote>
"The only guarantee we have is that, if user requests a <tt>max_load_factor</tt>
that is less than the current <tt>load_factor</tt>, then the operation will take
constant time, thus outlawing an implementation that chooses to rehash
and so preserve as a class invariant that <tt>load_factor &lt; max_load_factor</tt>."
</blockquote>
Note that the current spec says that there is constant complexity
<em>without</em> any precondition. So, rehashing to keep the invariant would
violate the spec (which is probably not be the intention).
<p/>
This issue is related to LWG <a href="2199">2199</a>.
</p>


<p><b>Proposed resolution:</b></p>

<p>
Modify Table 87 as follows:
</p>

<table border="1">
<caption>Table 87 &mdash; Unordered associative container requirements</caption>

<tr>
<th>
Expression
</th>
<th>
Return type
</th>
<th>
Assertion/note pre-/post-condition
</th>
<th>
Complexity
</th>
</tr>

<tr>
<td>
<tt>a.max_load_factor(z)</tt>
</td>
<td>
<tt>void</tt>
</td>
<td>
<p>
Pre: <tt>z</tt> shall be positive.  May change the container's maximum
load factor, uing <tt>z</tt> as a hint.
</p>
<p>
<ins>Post: <tt>a.load_factor() &lt;= a.max_load_factor()</tt></ins>
</p>
<p>
<ins><i>Note:</i> <tt>a.load_factor()</tt> is not modified by this operation.</ins>
</p>
</td>
<td>
Constant
</td>
</tr>

</table>






<hr>
<h3><a name="2202" href="2202">2202.</a> Missing allocator support by <tt>async</tt></h3>
<p><b>Section:</b> 32.9.9 <a href="https://timsong-cpp.github.io/cppwp/futures.async">[futures.async]</a> <b>Status:</b> <a href="lwg-active.html#Deferred">Deferred</a>
 <b>Submitter:</b> Detlef Vollmann <b>Opened:</b> 2012-10-19 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#futures.async">issues</a> in [futures.async].</p>
<p><b>Discussion:</b></p>

<p>
<tt>promise</tt>, <tt>packaged_task</tt>, and <tt>async</tt> are the only
places where a shared state is actually supposed to be allocated. Accordingly,
<tt>promise</tt> and <tt>packaged_task</tt> are "allocator-aware". But
function template <tt>async</tt> provides no way to provide an allocator.
</p>

<p><i>[2013-09 Chicago]</i></p>

<p>
Matt: deprecate async 
<p/>
Nico: read my paper 
<p/>
Alisdair: defer issues to wait for polymorphic allocators 
<p/>
Alisdair: defer, active topic of research Deferred 
</p>

<p><i>[2014-02-20 Re-open Deferred issues as Priority 4]</i></p>


<p><i>[2015-05 Lenexa, SG1 response]</i></p>

<p>
We want whatever status approximates: "will not fix; we're working on a replacement facility and don't want to add features to a broken one"
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2206" href="2206">2206.</a> Inaccuracy in <tt>initializer_list</tt> constructor requirements</h3>
<p><b>Section:</b> 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>, 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a>, 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a>, 26.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/rand.req.seedseq">[rand.req.seedseq]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jeffrey Yasskin <b>Opened:</b> 2012-10-21 <b>Last modified:</b> 2019-03-26 20:08:31 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#sequence.reqmts">active issues</a> in [sequence.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#sequence.reqmts">issues</a> in [sequence.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
In 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> p3, we have "<tt>il</tt> designates an object of type
<tt>initializer_list&lt;value_type&gt;</tt>", and then several functions that take
'<tt>il</tt>' as an argument. However, an expression like <tt>{1, 2, 'a'}</tt> is <em>not</em>
an object of type <tt>initializer_list&lt;int&gt;</tt> unless it's used to initialize
an explicitly-typed variable of that type. I believe we want:
</p>
<blockquote><pre>
std::vector&lt;int&gt; v;
v = {1, 2, 'a'};
</pre></blockquote>
<p>
to compile portably, so we should say something different when defining '<tt>il</tt>'. The 
same phrasing happens in 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a>, 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a>, and 
26.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/rand.req.seedseq">[rand.req.seedseq]</a>.
<p/>
This may just be an editorial issue because the actual class synopses declare the functions 
to take <tt>initializer_list&lt;exact_type&gt;</tt>.
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Open.
</p>
<p>
This is definitely not NAD
</p>
<p>
Should copy the suggested wording as the proposed resolution.
</p>

<p><i>[2019-03-26; Daniel comments and provides wording]</i></p>

<p>
The 2013-03-15 comment is confusing, since it recommends to "copy the suggested wording as the proposed resolution". 
I couldn't find such wording in the issue nor in the associated wiki, so I provided that wording out of myself.
The tricky part is to define which kind of <i>braced-init-list</i> we want to allow. As Tim Song pointed out, we
still need the existing support for <tt>std::initializer_list&lt;value_type&gt;</tt> as well, because otherwise
existing semantics based on expressions such as <tt>li.begin()</tt> won't work anymore.
The below suggested wording restricts supported <i>braced-init-list</i>s to every initializer list that can be used 
to copy-list-initialize an object of type <tt>std::initializer_list&lt;value_type&gt;</tt> by saying:
</p>
<blockquote><p>
"<tt>bil</tt> designates any <i>braced-init-list</i> suitable to copy-list-initialize an object of type 
<tt>initializer_list&lt;value_type&gt;</tt> (9.4.4 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.list">[dcl.init.list]</a>)"
</p></blockquote>
<p>
As a drive-by fix, the provided wording adds another initialization "expression" that makes the construction 
of the form
</p>
<blockquote><pre>
std::vector&lt;int&gt; v = {1, 2, 'a'};
</pre></blockquote>
<p>
valid (We just miss a copy-initialization case).
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> We need to special-case the "expression" <tt>X u = bil;</tt> below,
because for empty <i>braced-init-list</i> the effects are those of calling the default 
constructor. &mdash; <i>end drafting note</i>]
</p>
</blockquote>

<ol>
<li><p>Modify 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> as indicated:</p>

<blockquote>
<p>
-3- In Tables 66 and 67, [&hellip;] <tt>il</tt> designates a<del>n object</del><ins>value</ins> of type 
<tt>initializer_list&lt;value_type&gt;</tt>, <ins><tt>bil</tt> designates any <i>braced-init-list</i> 
suitable to copy-list-initialize an object of type <tt>initializer_list&lt;value_type&gt;</tt> 
(9.4.4 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.list">[dcl.init.list]</a>),</ins> [&hellip;]
</p>
</blockquote>

</li>

<li><p>Modify Table 66 &mdash; "Sequence container requirements (in addition to container)" as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 66 &mdash; Sequence container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>X(il)</tt><br/>
<ins><tt>X u = il;</tt></ins>
</td>
<td><tt></tt></td>
<td>
Equivalent to <tt>X(il.begin(), il.end())</tt><br/>
<ins>or <tt>X u(il.begin(), il.end());</tt>, respectively</ins>
</td>
</tr>
<tr>
<td>
<ins><tt>X(bil)</tt></ins>
</td>
<td><tt></tt></td>
<td>
<ins>Equivalent to <tt>X(initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
</tr>
<tr>
<td>
<ins><tt>X u = bil;</tt></ins>
</td>
<td><tt></tt></td>
<td>
<ins>If <tt>bil</tt> is empty, equivalent to <tt>X u;</tt>, otherwise<br/>
equivalent to <tt>X u = initializer_list&lt;value_type&gt;(bil);</tt></ins>
</td>
</tr>
<tr>
<td>
<tt>a = il</tt>
</td>
<td><tt>X&amp;</tt></td>
<td>
[&hellip;]
</td>
</tr>
<tr>
<td>
<ins><tt>a = bil</tt></ins>
</td>
<td><ins><tt>X&amp;</tt></ins></td>
<td>
<ins>Equivalent to <tt>a = initializer_list&lt;value_type&gt;(bil)</tt></ins>
</td>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a.insert(p, il)</tt>
</td>
<td><tt>iterator</tt></td>
<td>
[&hellip;]
</td>
</tr>
<tr>
<td>
<ins><tt>a.insert(p, bil)</tt></ins>
</td>
<td><ins><tt>iterator</tt></ins></td>
<td>
<ins>Equivalent to <tt>a.insert(p, initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a.assign(il)</tt>
</td>
<td><tt>void</tt></td>
<td>
[&hellip;]
</td>
</tr>
<tr>
<td>
<ins><tt>a.assign(bil)</tt></ins>
</td>
<td><ins><tt>void</tt></ins></td>
<td>
<ins>Equivalent to <tt>a.assign(initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>
</blockquote>

</li>

<li><p>Modify 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a> as indicated:</p>

<blockquote>
<p>
-8- In Table 69, [&hellip;] <tt>il</tt> designates a<del>n object</del><ins>value</ins> of type 
<tt>initializer_list&lt;value_type&gt;</tt>, <ins><tt>bil</tt> designates any <i>braced-init-list</i> 
suitable to copy-list-initialize an object of type <tt>initializer_list&lt;value_type&gt;</tt> 
(9.4.4 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.list">[dcl.init.list]</a>),</ins> [&hellip;]
</p>
</blockquote>

</li>

<li><p>Modify Table 69 &mdash; "Associative container requirements (in addition to container)" as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 69 &mdash; Associative container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>X(il)</tt><br/>
<ins><tt>X u = il;</tt></ins>
</td>
<td><tt></tt></td>
<td>
same as <tt>X(il.begin(), il.end())</tt><br/>
<ins>or <tt>X u(il.begin(), il.end());</tt>, respectively</ins>
</td>
<td>
same as <tt>X(il.begin(), il.end())</tt><br/>
<ins>or <tt>X u(il.begin(), il.end());</tt>, respectively</ins>
</td>
</tr>
<tr>
<td>
<ins><tt>X(bil)</tt></ins>
</td>
<td><tt></tt></td>
<td>
<ins>Equivalent to <tt>X(initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<ins><tt>X u = bil;</tt></ins>
</td>
<td><tt></tt></td>
<td>
<ins>If <tt>bil</tt> is empty, equivalent to <tt>X u;</tt>, otherwise<br/>
equivalent to <tt>X u = initializer_list&lt;value_type&gt;(bil);</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<tt>X(il,c)</tt>
</td>
<td><tt></tt></td>
<td>
same as <tt>X(il.begin(), il.end(), c)</tt>
</td>
<td>
same as <tt>X(il.begin(), il.end(), c)</tt>
</td>
</tr>
<tr>
<td>
<ins><tt>X(bil, c)</tt></ins>
</td>
<td><tt></tt></td>
<td>
<ins>Equivalent to <tt>X(initializer_list&lt;value_type&gt;(bil), c)</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<tt>a = il</tt>
</td>
<td><tt>X&amp;</tt></td>
<td>
[&hellip;]
</td>
<td>
[&hellip;]
</td>
</tr>
<tr>
<td>
<ins><tt>a = bil</tt></ins>
</td>
<td><ins><tt>X&amp;</tt></ins></td>
<td>
<ins>Equivalent to <tt>a = initializer_list&lt;value_type&gt;(bil)</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a.insert(il)</tt>
</td>
<td><tt>void</tt></td>
<td>
equivalent to <tt>a.insert(il.begin(), il.end())</tt>
</td>
<td></td>
</tr>
<tr>
<td>
<ins><tt>a.insert(bil)</tt></ins>
</td>
<td><ins><tt>void</tt></ins></td>
<td>
<ins>Equivalent to <tt>a.insert(initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a.assign(il)</tt>
</td>
<td><tt>void</tt></td>
<td>
[&hellip;]
</td>
</tr>
<tr>
<td>
<ins><tt>a.assign(bil)</tt></ins>
</td>
<td><ins><tt>void</tt></ins></td>
<td>
<ins>Equivalent to <tt>a.assign(initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>
</blockquote>

</li>

<li><p>Modify 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> p11's bullet list as indicated:</p>

<blockquote>
<p>
-11- In Table 70:
</p>
<ol style="list-style-type: none">
<li><p>(11.1) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(11.14) &mdash; <tt>il</tt> denotes a value of type <tt>initializer_list&lt;value_type&gt;</tt>,</p></li>
<li><p><ins>(11.?) &mdash; <tt>bil</tt> denotes any <i>braced-init-list</i> suitable to copy-list-initialize 
an object of type <tt>initializer_list&lt;value_type&gt;</tt> (9.4.4 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.list">[dcl.init.list]</a>), </ins></p></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>

</li>

<li><p>Modify Table 70 &mdash; "Unordered associative container requirements (in addition to container)" as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> There is a preexisting issue with Table 70, that there is no symbol <tt>u</tt> specified
("<tt>u</tt> denotes the name of a variable being declared"), so existing initialization forms with a named
variable are currently always written as "<tt>X a[&hellip;]</tt>" where <tt>a</tt> is defined as "<tt>a</tt> denotes a 
value of type <tt>X</tt>", the wording below follows this existing practice but the author of this wording would 
like to kindly ask the Project Editor to introduce said symbol <tt>u</tt> and apply it to all existing and new such 
named initialization forms instead. &mdash; <i>end drafting note</i>]
</p>
</blockquote>

<blockquote>
<table border="1">
<caption>Table 70 &mdash; Unordered associative container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>X(il)</tt><br/>
<ins><tt>X a = il;</tt></ins>
</td>
<td><tt>X</tt></td>
<td>
Same as <tt>X(il.begin(), il.end())</tt><br/>
<ins>or <tt>X a(il.begin(), il.end());</tt>, respectively</ins>
</td>
<td>
Same as <tt>X(il.begin(), il.end())</tt><br/>
<ins>or <tt>X a(il.begin(), il.end());</tt>, respectively</ins>
</td>
</tr>
<tr>
<td>
<ins><tt>X(bil)</tt></ins>
</td>
<td><ins><tt>X</tt></ins></td>
<td>
<ins>Equivalent to <tt>X(initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<ins><tt>X a = bil;</tt></ins>
</td>
<td><ins><tt>X</tt></ins></td>
<td>
<ins>If <tt>bil</tt> is empty, equivalent to <tt>X a;</tt>, otherwise<br/>
equivalent to <tt>X a = initializer_list&lt;value_type&gt;(bil);</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<tt>X(il, n)</tt>
</td>
<td><tt>X</tt></td>
<td>
Same as <tt>X(il.begin(), il.end(), n)</tt>
</td>
<td>
Same as <tt>X(il.begin(), il.end(), n)</tt>
</td>
</tr>
<tr>
<td>
<ins><tt>X(bil, n)</tt></ins>
</td>
<td><ins><tt>X</tt></ins></td>
<td>
<ins>Equivalent to <tt>X(initializer_list&lt;value_type&gt;(bil), n)</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<tt>X(il, n, hf)</tt>
</td>
<td><tt>X</tt></td>
<td>
Same as <tt>X(il.begin(), il.end(), n, hf)</tt>
</td>
<td>
Same as <tt>X(il.begin(), il.end(), n, hf)</tt>
</td>
</tr>
<tr>
<td>
<ins><tt>X(bil, n, hf)</tt></ins>
</td>
<td><ins><tt>X</tt></ins></td>
<td>
<ins>Equivalent to <tt>X(initializer_list&lt;value_type&gt;(bil), n, hf)</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<tt>X(il, n, hf, eq)</tt>
</td>
<td><tt>X</tt></td>
<td>
Same as <tt>X(il.begin(), il.end(), n, hf, eq)</tt>
</td>
<td>
Same as <tt>X(il.begin(), il.end(), n, hf, eq)</tt>
</td>
</tr>
<tr>
<td>
<ins><tt>X(bil, n, hf, eq)</tt></ins>
</td>
<td><ins><tt>X</tt></ins></td>
<td>
<ins>Equivalent to <tt>X(initializer_list&lt;value_type&gt;(bil), n, hf, eq)</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a = il</tt>
</td>
<td><tt>X&amp;</tt></td>
<td>
[&hellip;]
</td>
<td>
[&hellip;]
</td>
</tr>
<tr>
<td>
<ins><tt>a = bil</tt></ins>
</td>
<td><ins><tt>X&amp;</tt></ins></td>
<td>
<ins>Equivalent to <tt>a = initializer_list&lt;value_type&gt;(bil)</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a.insert(il)</tt>
</td>
<td><tt>void</tt></td>
<td>
Same as <tt>a.insert(il.begin(), il.end())</tt>.
</td>
<td>
Same as <tt>a.insert(il.begin(), il.end())</tt>.
</td>
</tr>
<tr>
<td>
<ins><tt>a.insert(bil)</tt></ins>
</td>
<td><ins><tt>void</tt></ins></td>
<td>
<ins>Equivalent to <tt>a.insert(initializer_list&lt;value_type&gt;(bil))</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>
</blockquote>

</li>

<li><p>Modify 26.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/rand.req.seedseq">[rand.req.seedseq]</a> p2's bullet list as indicated:</p>

<blockquote>
<p>
-2- A class <tt>S</tt> satisfies the requirements of a seed sequence if the expressions shown in Table 82 are 
valid and have the indicated semantics, and [&hellip;] In that Table and throughout this subclause:
</p>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; [&hellip;]</p></li>
<li><p><ins>(2.?) &mdash; <tt>u</tt> denotes the name of a variable being declared,</ins></p></li>
<li><p>[&hellip;]</p></li>
<li><p>(2.6) &mdash; <tt>il</tt> is a value of <tt>initializer_list&lt;T&gt;</tt><del>.</del><ins>;</ins></p></li>
<li><p><ins>(2.?) &mdash; <tt>bil</tt> denotes any <i>braced-init-list</i> suitable to 
copy-list-initialize an object of type <tt>initializer_list&lt;T&gt;</tt> 
(9.4.4 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.list">[dcl.init.list]</a>).</ins></p></li>
</ol>
</blockquote>

</li>

<li><p>Modify Table 82 &mdash; "Seed sequence requirements" as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 82 &mdash; Seed sequence requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Pre&#47;post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>S(il)</tt><br/>
<ins><tt>S u = il;</tt></ins>
</td>
<td></td>
<td>
Same as <tt>S(il.begin(), il.end())</tt><br/>
<ins>or <tt>S u(il.begin(), il.end());</tt>, respectively</ins>
</td>
<td>
same as <tt>S(il.begin(), il.end())</tt><br/>
<ins>or <tt>S u(il.begin(), il.end());</tt>, respectively</ins>
</td>
</tr>
<tr>
<td>
<ins><tt>S(bil)</tt></ins>
</td>
<td></td>
<td>
<ins>Equivalent to <tt>S(initializer_list&lt;T&gt;(bil))</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td>
<ins><tt>S u = bil;</tt></ins>
</td>
<td></td>
<td>
<ins>If <tt>bil</tt> is empty, equivalent to <tt>S u;</tt>, otherwise<br/>
equivalent to <tt>S u = initializer_list&lt;T&gt;(bil);</tt></ins>
</td>
<td></td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>
</blockquote>

</li>

</ol>





<hr>
<h3><a name="2214" href="2214">2214.</a> Clarify <tt>basic_ios::init</tt> call restrictions</h3>
<p><b>Section:</b> 29.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.ios.cons">[basic.ios.cons]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Andrey Semashev <b>Opened:</b> 2012-11-09 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#basic.ios.cons">issues</a> in [basic.ios.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
There is an ambiguity in how <tt>std::basic_ios::init</tt> method (29.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.ios.cons">[basic.ios.cons]</a>) 
can be used in the derived class. The Standard only specify the state of the <tt>basic_ios</tt> 
object after the call completes. However, in <tt>basic_ios</tt> default constructor description 
(29.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.ios.cons">[basic.ios.cons]</a>) there is this sentence:
</p>
<blockquote><p>
<i>Effects</i>: Constructs an object of class <tt>basic_ios</tt> (29.5.3.7 <a href="https://timsong-cpp.github.io/cppwp/ios.base.cons">[ios.base.cons]</a>) 
leaving its member objects uninitialized. The object shall be initialized by calling <tt>basic_ios::init</tt> 
before its first use or before it is destroyed, whichever comes first; otherwise the behavior is undefined.
</p></blockquote>
<p>
This restriction hints that <tt>basic_ios::init</tt> should be called exactly
once before the object can be used or destroyed, because <tt>basic_ios::init</tt> 
may not know whether it was called before or not (i.e. whether its members are actually 
uninitialized or are initialized by the previous call to <tt>basic_ios::init</tt>). There 
is no such restriction in the <tt>basic_ios::init</tt> preconditions so it is not clear whether it is
allowed to call <tt>basic_ios::init</tt> multiple times or not.
<p/>
This problem has already affected publicly available implementations.
For example, Microsoft Visual C++ STL introduces a memory leak if
<tt>basic_ios::init</tt> is called multiple times, while GCC 4.7 and STLPort
reinitialize the <tt>basic_ios</tt> object correctly without memory leak or any
other undesired effects. There was a discussion of this issue on Boost
<a href="http://article.gmane.org/gmane.comp.lib.boost.devel/235659">developers mailing list</a>, 
and there is a <a href="https://sourceforge.net/apps/trac/boost-log/ticket/2#comment:4">test case 
that reproduces the problem</a>. The test case is actually a bug report for my Boost.Log library, 
which attempts to cache <tt>basic_ostream</tt>-derived objects internally to avoid expensive construction 
and destruction. My stream objects allowed resetting the stream buffer pointers the stream
is attached to, without requiring to destroy and construct the stream.
<p/>
My personal view of the problem and proposed resolution follows.
<p/>
While apparently the intent of <tt>basic_ios::init</tt> is to provide a way to
initialize <tt>basic_ios</tt> after default construction, I see no reason to
forbid it from being called multiple times to reinitialize the stream.
Furthermore, it is possible to implement a conforming <tt>basic_ios</tt> that
does not have this restriction.
<p/>
The quoted above section of the Standard that describes the effects of
the default constructor is misleading. The Standard does not mandate
any data members of <tt>basic_ios</tt> or <tt>ios_base</tt> (29.5.3 <a href="https://timsong-cpp.github.io/cppwp/ios.base">[ios.base]</a>), which
it derives from. This means that the implementation is allowed to use
non-POD data members with default constructors that initialize the
members with particular default values. For example, in the case of
Microsoft Visual C++ STL the leaked memory is an <tt>std::locale</tt> instance
that is dynamically allocated during <tt>basic_ios::init</tt>, a raw pointer to
which is stored within ios_base. It is possible to store e.g. an
<tt>unique_ptr</tt> instead of a raw pointer as a member of <tt>ios_base</tt>, the smart
pointer will default initialize the underlying raw pointer on default
construction and automatically destroy the allocated object upon being
reset or destroyed, which would eliminate the leak and allow
<tt>basic_ios::init</tt> to be called multiple times. This leads to conclusion
that the default constructor of <tt>basic_ios</tt> cannot leave "its member
objects uninitialized" but instead performs default initialization of
the member objects, which would mean the same thing in case of POD types.
<p/>
However, I feel that restricting <tt>ios_base</tt> and <tt>basic_ios</tt> members to
non-POD types is not acceptable. Since multiple calls to <tt>basic_ios::init</tt> are 
not forbidden by the Standard, I propose to correct the <tt>basic_ios</tt> default 
constructor description so that it is allowed to destroy <tt>basic_ios</tt> object 
without calling <tt>basic_ios::init</tt>. This would imply that any raw members of 
<tt>basic_ios</tt> and <tt>ios_base</tt> should be initialized to values suitable for 
destruction (essentially, this means only initializing raw pointers to NULL). The new 
wording could look like this:
</p>
<blockquote><p>
<i>Effects</i>: Constructs an object of class <tt>basic_ios</tt> (29.5.3.7 <a href="https://timsong-cpp.github.io/cppwp/ios.base.cons">[ios.base.cons]</a>)
initializing its member objects to unspecified state, only suitable for <tt>basic_ios</tt> destruction.
The object shall be initialized by calling <tt>basic_ios::init</tt> before its first use; otherwise 
the behavior is undefined.
</p></blockquote>
<p>
This would remove the hint that <tt>basic_ios::init</tt> must be called exactly
once. Also, this would remove the requirement for <tt>basic_ios::init</tt> to
be called at all before the destruction. This is also an important issue because 
the derived stream constructor may throw an exception before it manages to call 
<tt>basic_ios::init</tt> (for example, if the streambuf constructor throws), and 
in this case the <tt>basic_ios</tt> destructor has undefined behavior.
<p/>
To my mind, the described modification is sufficient to resolve the issue. But to 
emphasize the possibility to call <tt>basic_ios::init</tt> multiple times, a remark 
or a footnote for <tt>basic_ios::init</tt> postconditions could be added to explicitly 
state the semantics of calling it multiple times. The note could read as follows:
</p>
<blockquote><p>
The function can be called multiple times during the object lifetime. Each subsequent 
call reinitializes the object to the described in postconditions initial state.
</p></blockquote>

<p><i>[2013-04-20, Bristol]</i></p>


<p>
Alisdair: The current wording is unclear but the proposed resolution is wrong
<p/>
Solution: Clarify that <tt>init</tt> must be called once and only once. Move then to review. 
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3485.</p>

<ol>
<li><p>Edit 29.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.ios.cons">[basic.ios.cons]</a> as indicated:</p>
<blockquote><pre>
basic_ios();
</pre>
<blockquote>
<p>
-2- <i>Effects</i>: Constructs an object of class <tt>basic_ios</tt> (29.5.3.7 <a href="https://timsong-cpp.github.io/cppwp/ios.base.cons">[ios.base.cons]</a>) 
<del>leaving its member objects uninitialized</del><ins>initializing its member objects to unspecified state, 
only suitable for <tt>basic_ios</tt> destruction</ins>. The object shall be initialized by calling 
<tt>basic_ios::init</tt> before its first use <del>or before it is destroyed, whichever comes first</del>; 
otherwise the behavior is undefined.
</p>
</blockquote>
<pre>
void init(basic_streambuf&lt;charT,traits&gt;* sb);
</pre><blockquote>
<p>
<i>Postconditions</i>: The postconditions of this function are indicated in Table 128.
<p/>
<ins>-?- <i>Remarks</i>: The function can be called multiple times during the object lifetime. Each subsequent 
call reinitializes the object to the described in postconditions initial state.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2215" href="2215">2215.</a> (unordered) associative container functors should be <tt>CopyConstructible</tt></h3>
<p><b>Section:</b> 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a>, 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2012-11-14 <b>Last modified:</b> 2015-10-22 17:38:35 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#associative.reqmts">active issues</a> in [associative.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#associative.reqmts">issues</a> in [associative.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The requirements on the functors used to arrange elements in the various associative and
unordered containers are given by a set of expressions in tables 102 &mdash; Associative container
requirements, and 103 &mdash; Unordered associative container requirements.  In keeping with Library
convention these expressions make the minimal requirements necessary on their types.  For
example, we have the following 3 row extracts for the unordered containers:
</p>
<table>
<tr>
  <td>
    <b>Expression</b>
  </td>
  <td>
    <b>Assertion/note pre-/post-condition</b>
  </td>
</tr>

<tr>
  <td>
<pre>
<tt>X(n, hf, eq)</tt>
<tt>X a(n, hf, eq)</tt>
</pre>
  </td>
  <td>
    <i>Requires:</i> <tt>hasher</tt> and <tt>key_equal</tt> are <tt>CopyConstructible</tt>.
 </td>
</tr>

<tr>
  <td>
<pre>
<tt>X(n, hf)</tt>
<tt>X a(n, hf)</tt>
</pre>
  </td>
  <td>
    <i>Requires:</i> <tt>hasher</tt> is <tt>CopyConstructible</tt> and 
                  <tt>key_equal</tt> is <tt>DefaultConstructible</tt>.
 </td>
</tr>

<tr>
  <td>
<pre>
<tt>X(n)</tt>
<tt>X a(n)</tt>
</pre>
  </td>
  <td>
    <i>Requires:</i> <tt>hasher</tt> and <tt>key_equal</tt> are <tt>DefaultConstructible</tt>.
 </td>
</tr>
</table>

<p>
However, the signature for each class template requires that the functors must effectively be
<tt>CopyConstructible</tt> for each of these expressions:
</p>

<blockquote><pre>
template &lt;class Key,
          class T,
          class Hash  = hash&lt;Key>,
          class Pred  = std::equal_to&lt;Key>,
          class Allocator = std::allocator&lt;std::pair&lt;const Key, T> > >
class unordered_map
{
  <i>...</i>

  <i>// construct/destroy/copy</i>
  explicit unordered_map(size_type n = <i>see below</i>,
                         const hasher&amp; hf = hasher(),
                         const key_equal&amp; eql = key_equal(),
                         const allocator_type&amp; a = allocator_type());

  <i>...</i>
}
</pre></blockquote>

<p>
The letter of the standard can be honored as long as implementors recognize
their freedom to split this one signature into multiple overloads, so that
the documented default arguments (requiring a <tt>CopyConstructible</tt> functor)
are not actually passed as default arguments.
</p>
<p>
As we look into the requirements for the copy constructor and copy-assignment
operator, the requirements are even more vague, as the explicit requirements on
the functors are not called out, other than saying that the functors are copied.
</p>
<p>
Must the functors be <tt>CopyAssignable</tt>? Or is <tt>CopyConstructible</tt>
sufficient in this case?  Do we require that the functors be <tt>Swappable</tt>
so that the copy-swap idiom can be deployed here?  Note that a type that is both
<tt>CopyConstructible</tt> and <tt>CopyAssignable</tt> is still not guaranteed to
be <tt>Swappable</tt> as the user may delete the <tt>swap</tt> function for their
type in their own namespace, which would be found via ADL.
</p>
<p>
Some clean-up of the requirements table looks necessary, to at least document the
assignment behavior.  In addition, we should have clear guidance on whether these
functors should always be <tt>CopyConstructible</tt>, as suggested by the class
template definitions, or if the requirement tables are correct and we should
explicitly split up the constructors in the (unordered) associative containers
to no longer use default (function) arguments to obtain their defaulted functors.
</p>
<p>
I recommend the simplest solution would be to always require that the functors
for (unordered) associative containers be <tt>CopyConstructible</tt>, above the
requirements tables themselves, so that the issue need not be addressed within
the tables.  I suggest that the assignment operators for these containers add
the requirement that the functors be <tt>Swappable</tt>, rather than forwarding
the corresponding <tt>Assignable</tt> requirement.
</p>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Open.
</p>
<p>
Alisdair to propose wording.
</p>

<p><i>[2014-06-08, Daniel comments]</i></p>

<p>
The area of this issue partially overlaps what LWG <a href="2227">2227</a> addresses.
</p>

<p><i>[2015-10-20, Daniel comments]</i></p>

<p>
The revised resolution of LWG <a href="2227">2227</a> should resolve this issue as well. It follows the recommendations
of the submitter to require <tt>CopyConstructible</tt> requirements for the function objects owned by containers,
but it does not impose any further fundamental requirements.
</p>


<p><b>Proposed resolution:</b></p>
<p>
See the resolution of LWG <a href="2227">2227</a>.
</p>





<hr>
<h3><a name="2216" href="2216">2216.</a> <tt>regex_replace(basic_string)</tt> allocator handling</h3>
<p><b>Section:</b> 30.11.4 <a href="https://timsong-cpp.github.io/cppwp/re.alg.replace">[re.alg.replace]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jeffrey Yasskin <b>Opened:</b> 2012-11-26 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#re.alg.replace">issues</a> in [re.alg.replace].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>

<blockquote><pre>
template &lt;class traits, class charT, class ST, class SA&gt;
  basic_string&lt;charT, ST, SA&gt;
  regex_replace(const basic_string&lt;charT, ST, SA&gt;&amp; s,
      const basic_regex&lt;charT, traits&gt;&amp; e,
      const charT* fmt,
      regex_constants::match_flag_type flags = 
	    regex_constants::match_default);
</pre></blockquote>
<p>
and friends are documented as
</p>
<blockquote><p>
Constructs an empty string result of type <tt>basic_string&lt;charT, ST, SA&gt;</tt>
and calls <tt>regex_replace(back_inserter(result), s.begin(), s.end(), e, fmt, flags)</tt>.
</p></blockquote>
<p>
This appears to require the result to have a default-constructed
allocator, which isn't even possible for all allocator types. I
suspect the allocator should be copied from 's' instead. Possibly
there should be an additional defaulted argument to override the
allocator of the result.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2220" href="2220">2220.</a> Under-specification of <tt>operator==</tt> for <tt>regex_token_iterator</tt></h3>
<p><b>Section:</b> 30.12.2.2 <a href="https://timsong-cpp.github.io/cppwp/re.tokiter.comp">[re.tokiter.comp]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Pete Becker <b>Opened:</b> 2012-11-21 <b>Last modified:</b> 2018-08-23 14:35:23 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
Consider the following example:
</p>
<blockquote><pre>
std::string str0("x");
std::regex rg0("a");
std::regex_token_iterator it0(str0.begin(), str0.end(), rg0, -1); // points at "x" in str0
std::string str1("x");
std::regex rg1("b");
std::regex_token_iterator it1(str1.begin(), str1.end(), rg1, -1); // points at "x" in str1
</pre></blockquote>
<p>
30.12.2.2 <a href="https://timsong-cpp.github.io/cppwp/re.tokiter.comp">[re.tokiter.comp]</a> p1 says that <tt>it0.operator==(it1)</tt> returns true "if
<tt>*this</tt> and <tt>right</tt> are both suffix iterators and <tt>suffix == right.suffix</tt>"; both
conditions are satisfied in this example. It does not say that they must both be iterators
into the same sequence, nor does it say (as general iterator requirements do) that they must
both be in the domain of <tt>==</tt> in order for the comparison to be meaningful. It's a
simple statement: they're equal if the strings they point at compare equal. Given this being
a valid comparison, the obtained result of "true" looks odd.
<p/>
The problem is that for iterator values prior to the suffix iterator, equality means the same
regular expression and the same matched sequence (both uses of "same" refer to identity, not equality);
for the suffix iterator, equality means that the matched sequences compare equal.
</p>

<p><i>[2014-02-10]</i></p>

<p>Priority set to 2</p>

<p><i>[2018-08-20 Casey adds a proposed resolution]</i></p>

<p>Priority changed to 3.</p>
Marshall notes that iterator comparisons typically require the iterators to
denote elements of the same sequence.

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ul>
<li><p>Modify 30.12.2.2 <a href="https://timsong-cpp.github.io/cppwp/re.tokiter.comp">[re.tokiter.comp]</a> as follows:</p>
<blockquote>
<pre>
bool operator==(const regex_token_iterator&amp; right) const;
</pre>
<p>
<ins>-?- <i>Expects:</i> <tt>*this</tt> and <tt>right</tt> are both
end-of-sequence iterators or both have the same underlying sequence.</ins>
</p><p>
-1- <i>Returns:</i> <tt>true</tt> if <tt>*this</tt> and <tt>right</tt> are both
end-of-sequence iterators, or if [&hellip;]
</p>
<pre>
bool operator!=(const regex_token_iterator&amp; right) const;
</pre>
<p>
<ins>-?- <i>Expects:</i> <tt>*this</tt> and <tt>right</tt> are both
end-of-sequence iterators or both have the same underlying sequence.</ins>
</p><p>
-2- <i>Returns:</i> <tt>!(*this == right)</tt>.
</p>
</blockquote>
</li>
</ul>
</blockquote>

<p><i>[2018-08-23 Casey revises the P/R in response to LWG feedback]</i></p>




<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ul>
<li><p>Modify 30.12.2.2 <a href="https://timsong-cpp.github.io/cppwp/re.tokiter.comp">[re.tokiter.comp]</a> as follows:</p>
<blockquote>
<pre>
bool operator==(const regex_token_iterator&amp; right) const;
</pre>
<p>
<ins>-?- <i>Expects:</i> At least one of <tt>*this</tt> and <tt>right</tt> is an
end-of-sequence iterator, or both <tt>*this</tt> and <tt>right</tt> have the
same underlying sequence.</ins>
</p><p>
-1- <i>Returns:</i> <tt>true</tt> if <tt>*this</tt> and <tt>right</tt> are both
end-of-sequence iterators, or if [&hellip;]
</p>
<pre>
bool operator!=(const regex_token_iterator&amp; right) const;
</pre>
<p>
<ins>-?- <i>Expects:</i> At least one of <tt>*this</tt> and <tt>right</tt> is an
end-of-sequence iterator, or both <tt>*this</tt> and <tt>right</tt> have the
same underlying sequence.</ins>
</p><p>
-2- <i>Returns:</i> <tt>!(*this == right)</tt>.
</p>
</blockquote>
</li>
</ul>





<hr>
<h3><a name="2227" href="2227">2227.</a> Stateful comparison objects in associative containers</h3>
<p><b>Section:</b> 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Juan Soulie <b>Opened:</b> 2012-12-19 <b>Last modified:</b> 2019-04-23 17:33:48 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#associative.reqmts">active issues</a> in [associative.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#associative.reqmts">issues</a> in [associative.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>

<p>
Table 102 in 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a>/8 states on expression <tt>a.key_comp()</tt> that it 
"returns the comparison object out of which a was constructed". At the same time, 
22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>/8 states (starting in the third line) that 
"...Any <tt>Compare</tt>, <tt>Pred</tt>, or <tt>Hash</tt> objects belonging to <tt>a</tt> and <tt>b</tt> 
shall be swappable and <em>shall be exchanged</em> by unqualified calls to non-member swap...". This is 
problematic for any compliant implementation, since once swapped the container cannot return the comparison 
object out of which it was constructed unless incurring in storing an otherwise needless object.
<p/>
The simple solution is to correct that statement in Table 102, but I believe this is part of a larger problem 
of underspecified behavior: The new standard has made an effort in regards to allocators and now fully 
specifies what happens to stateful allocator objects. It has even specified what happens to stateful <tt>hasher</tt> 
and <tt>key_equal</tt> members of unordered containers (they propagate), but it says nothing about stateful 
comparison objects of (ordered) associative containers, except for the statement in 
22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>/8 referred above and only related to <tt>swap</tt>.
<p/>
For example, it is unclear to me what is specified to happen on an assignment: should the comparison object 
be copied/moved along with the elements, or should the left-hand side object keep its own?
Maybe this has been intentionally left unspecified with the purpose of compatibility with C++98, which I 
understand it specified that comparison objects were kept for the entire life of the container (like allocators) 
&mdash; an unfortunate choice. But anyway, the segment of 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> quoted 
above seems to break any possible backwards compatibility with C++98 in this regard.
<p/>
Therefore, taking into consideration consistency with how this is dealed with for unordered associative 
containers, I propose that Table 102 is modified as follows:
</p>
<ul>
<li>
<p>
The row for expression <tt>a.key_comp()</tt> is changed so that its "assertion/note pre-/post-condition" reads 
"Returns <tt>a</tt>'s comparison object."
</p>
</li>

<li>
<p>
A new row is added at the appropriate location (which I believe would be after "X(il)" row), with:
</p>

<blockquote>
<table border="1">
<caption>Table 102 &mdash; Associative container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td>
<tt>X(b)<br/>
X a(b)</tt>
</td>
<td>
<tt>X</tt>
</td>
<td>
Copy constructor. In addition to<br/>
the requirements of Table 96, copies<br/>
the comparison object.
</td>
<td>
Linear in <tt>b.size()</tt>
</td>
</tr>

<tr>
<td>
<tt>a = b</tt>
</td>
<td>
<tt>X&amp;</tt>
</td>
<td>
Copy assignment operator. In addition to<br/>
the requirements of Table 96, copies the<br/>
comparison object.
</td>
<td>
Linear in <tt>a.size()</tt> and <tt>b.size()</tt>
</td>
</tr>

</table>
</blockquote>

</li>
</ul>

<p><i>[2013-03-15 Issues Teleconference]</i></p>

<p>
Moved to Review.
</p>

<p><i>[2013-04-18, Bristol]</i></p>
 
<p>
STL: can't believe we don't specify this already. this is totally necessary
<p/>
Alisdair: how does it do this? copy construction? assignment?
<p/>
Also need it for move.
<p/>
STL: we already specify this for constructing from a comparator, not during copy construction though.
<p/>
Jonathan: don't like wording, should say "<tt>key_compare</tt> is <tt>CopyConstructible</tt>. Uses <tt>b.key_comp()</tt> 
as a comparison object."
<p/>
STL: we get it right for unordered!
<p/>
Jonathan: can't wordsmith this now, but I think implementations do the right thing.
<p/>
Alisdair: not sure what right thing is for moves. Also we say nothing about propagating allocators to functors.
</p>
<p>
Moved to Open.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
TK: There's no need for fine-grained propagate/not-propagate control. If you don't want to propagate the predicate, you can 
simply construct or insert from an iterator range.
<p/>
VV: libstdc++ already implements the resolution of this issue.
<p/>
GR: There are a couple of other problems. We don't specify move constructor and move assignment for maps. Those are just general.
<p/>
TK: General container requirements already describe the semantics for {copy,move}-{construction,assignment}, so it doesn't 
seem that there's room for choice in <tt>std::map</tt> assignments. <tt>unordered_map</tt> is different, though.
<p/>
[Note: Check what general container requirements say about container equality.]
<p/>
DK will draft wording. The decision is to unambiguously make all {copy,move}-{construction,assignment} operations endow the 
LHS with the exact state of the RHS, including all predicates and hash function states.
<p/>
Conclusion: Update wording, revisit later. 
</p>

<p><i>[2015-05-06 Lenexa: Waiting for updated wording]</i></p>


<p>
<strong>Previous resolution [SUPERSEDED]:</strong>
</p>
<blockquote class="note">
<p>This wording is relative to N3485.</p>

<ol>
<li><p>Change Table 102 as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 102 &mdash; Associative container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X(il)</tt>
</td>
<td>
<tt></tt>
</td>
<td>
Same as <tt>X(il.begin(), il.end())</tt>.
</td>
<td>
same as <tt>X(il.begin(), il.end())</tt>.
</td>
</tr>

<tr>
<td>
<ins><tt>X(b)<br/>
X a(b)</tt></ins>
</td>
<td>
<tt></tt>
</td>
<td>
<ins>Copy constructor. In addition to<br/>
the requirements of Table 96, copies<br/>
the comparison object.</ins>
</td>
<td>
<ins>Linear in <tt>b.size()</tt></ins>
</td>
</tr>

<tr>
<td>
<ins><tt>a = b</tt></ins>
</td>
<td>
<ins><tt>X&amp;</tt></ins>
</td>
<td>
<ins>Copy assignment operator. In addition to<br/>
the requirements of Table 96, copies the<br/>
comparison object.</ins>
</td>
<td>
<ins>Linear in <tt>a.size()</tt> and <tt>b.size()</tt></ins>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.key_comp()</tt>
</td>
<td>
<tt>X::key_compare</tt>
</td>
<td>
<del>r</del><ins>R</ins>eturns <del>the</del><ins><tt>a</tt>'s</ins> comparison object<br/>
<del>out of which a was constructed.</del>
</td>
<td>
constant
</td>
</tr>


</table>
</blockquote>

</li>

</ol>
</blockquote>

<p><i>[2015-10-19 Daniel comments and provides alternative wording]</i></p>

<p>
The current standard is especially unclear in regard to what effects move operations of unordered/associative
containers should have. We have one example that is standardized exactly in this way by looking at 
22.6.5.3 <a href="https://timsong-cpp.github.io/cppwp/priqueue.cons.alloc">[priqueue.cons.alloc]</a> p7:
</p>
<blockquote>
<pre>
template &lt;class Alloc&gt; priority_queue(priority_queue&amp;&amp; q, const Alloc&amp; a);
</pre>
<blockquote>
<p>
-7- <i>Effects</i>: Initializes <tt>c</tt> with <tt>std::move(q.c)</tt> as the first argument and <tt>a</tt> as 
the second argument, and initializes <tt>comp</tt> with <tt>std::move(q.comp)</tt>
</p>
</blockquote>
</blockquote>
<p>
A similarly comparable example are the move-operations of <tt>std::unique_ptr</tt> in regard to the deleter 
(when this is no a reference), which also respect move-capabilities of that function object.
<p/>
We have wording from C++98 for associative containers (but <em>not</em> for unordered containers!) that was never
adjusted to C++11 move-semantics in 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a> p12:
</p>
<blockquote><p>
When an associative container is constructed by passing a comparison object the container shall not store
a pointer or reference to the passed object, even if that object is passed by reference. When an associative
container is copied, either through a copy constructor or an assignment operator, the target container shall
then use the comparison object from the container being copied, as if that comparison object had been
passed to the target container in its constructor.
</p></blockquote>
<p>
The second sentence of this wording is problematic for several reasons:
</p>
<ol>
<li><p>It only talks about copy operations, not about move operations, except that the term "assignment" without
leading "copy" is a bit ambigious (albeit it seems clear in the complete context).</p></li>
<li><p>It is not really clear how to interpret "as if that comparison object had been
passed to the target container in its constructor" for an assignment operation. A possible but not conclusive
interpretation could be that this is wording supporting a "copy-via-swap" idiom.</p></li>
<li><p>There does not exist similar wording for unordered containers, except that Table 102 provides entries for
copy construction and copy assignment of the containers whose wording just talks of "copies" in either case.</p></li>
</ol>
<p>
Existing implementations differ already:
</p>
<ol>
<li><p>Visual Studio 2015 uses copy construction and copy assignment for the two copy operations but uses swap operations
for the move operations.</p></li>
<li><p>GCC's libstdc++ performs copy construction and copy assignment for the two copy operations and for the two
move operations, respectively</p></li>
<li><p>clang++'s libc++ performs copy/move construction and copy/move assignment for the corresponding
four copy/move operations</p></li>
</ol>
<p>
The alternative wording provided below attempts to clarify that container copy/move operations perform the corresponding
copy/move operations on the owned function objects.
<p/>
In addition the wording also resolves LWG <a href="2215">2215</a>: I believe that the current
wording should require that container function objects should meet the <tt>CopyConstructible</tt> requirements. Adding
this general requirement also fixes the underspecified requirements of the accessor functions <tt>key_comp()</tt> and
<tt>value_comp()</tt>.
<p/>
I don't think that a general requirement for <tt>Swappable</tt> is needed, only the member <tt>swap</tt> function currently requires this.
Nonetheless the wording below does <em>support</em> stateful functors that are <em>also</em> moveable or move-assignable,
therefore the specified semantics in terms of move operations.
<p/>
I should add the following warning, though: If this proposed wording would be accepted, there is a little chance of
code breakage, because the current wording <em>can</em> be read that in general there is no requirement that the
container functors are <tt>CopyConstructible</tt>. The following code example is accepted by gcc + libstd++:
</p>
<blockquote><pre>
#include &lt;map&gt;
#include &lt;utility&gt;
#include &lt;iostream&gt;

struct Cmp {
  Cmp() = default;
  Cmp(const Cmp&amp;) = delete;
  Cmp(Cmp&amp;&amp;) = delete;
  Cmp&amp; operator=(const Cmp&amp;) = delete;
  Cmp&amp; operator=(Cmp&amp;&amp;) = delete;
  template&lt;class T&gt;
  bool operator()(const T&amp; x, const T&amp; y) const
  {
    return x &lt; y;
  }
};

typedef std::map&lt;int, int, Cmp&gt; MyMap;

int main() {
  MyMap m;
  std::cout &lt;&lt; (m.find(12) == m.end()) &lt;&lt; std::endl;
}
</pre></blockquote>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to N4527.</p>

<ol>
<li><p>Change 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a> p8 as indicated:</p>

<blockquote><p>
-8- In Table 101, <tt>X</tt> denotes an associative container class, <tt>a</tt> denotes a value of type <tt>X</tt>, 
<ins><tt>b</tt> denotes a possibly <tt>const</tt> value of type <tt>X</tt>, <tt>rv</tt> denotes a non-<tt>const</tt> rvalue of 
type <tt>X</tt>,</ins> <tt>u</tt> denotes the name of a variable being declared, [&hellip;]
</p></blockquote>
</li>

<li><p>Change Table 101 as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 101 &mdash; Associative container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X::key_compare</tt>
</td>
<td>
<tt>Compare</tt>
</td>
<td>
<ins><i>Requires</i>: <tt>Compare</tt> is <tt>CopyConstructible</tt>.</ins><br/>
defaults to <tt>less&lt;key_type&gt;</tt>
</td>
<td>
compile time
</td>
</tr>

<tr>
<td>
<tt>X(c)<br/>
X u(c);</tt>
</td>
<td>
<tt></tt>
</td>
<td>
<del><i>Requires:</i> <tt>key_compare</tt> is <tt>CopyConstructible</tt>.<br/></del> 
<i>Effects</i>: Constructs an empty container.<br/> 
Uses a copy of <tt>c</tt> as a comparison object.
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X(i,j,c)<br/>
X u(i,j,c);</tt>
</td>
<td>
<tt></tt>
</td>
<td>
<i>Requires:</i> <del><tt>key_compare</tt> is <tt>CopyConstructible</tt>.<br/></del> 
<tt>value_type</tt> is <tt>EmplaceConstructible</tt> into <tt>X</tt> from <tt>*i</tt>.<br/>
<i>Effects</i>: Constructs an empty container and inserts elements<br/>
from the range <tt>[i, j)</tt> into it; uses <tt>c</tt> as a comparison object.
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X(il)</tt>
</td>
<td>
<tt></tt>
</td>
<td>
Same as <tt>X(il.begin(), il.end())</tt>.
</td>
<td>
same as <tt>X(il.begin(), il.end())</tt>.
</td>
</tr>

<tr>
<td>
<ins><tt>X(b)<br/>
X a(b)</tt></ins>
</td>
<td>
<tt></tt>
</td>
<td>
<ins>(In addition to the requirements of Table 95)<br/>
<i>Effects:</i> Copy constructs the comparison object of <tt>a</tt> from<br/> 
the comparison object of <tt>b</tt>.</ins>
</td>
<td>
<ins>Linear in <tt>b.size()</tt></ins>
</td>
</tr>

<tr>
<td>
<ins><tt>X(rv)<br/>
X a(rv)</tt></ins>
</td>
<td>
<tt></tt>
</td>
<td>
<ins>(In addition to the requirements of Table 95 and Table 98)<br/>
<i>Effects:</i> Move constructs the comparison object of <tt>a</tt> from<br/> 
the comparison object of <tt>rv</tt>.</ins>
</td>
<td>
<ins>constant</ins>
</td>
</tr>

<tr>
<td>
<ins><tt>a = b</tt></ins>
</td>
<td>
<ins><tt>X&amp;</tt></ins>
</td>
<td>
<ins>(In addition to the requirements of Table 95 and Table 98)<br/>
<i>Requires:</i> <tt>key_compare</tt> is <tt>CopyAssignable</tt>.<br/> 
<i>Effects:</i> Copy assigns the comparison object of <tt>b</tt><br/>
to the comparison object of <tt>a</tt>.</ins>
</td>
<td>
<ins>Linear in <tt>a.size()</tt> and <tt>b.size()</tt></ins>
</td>
</tr>

<tr>
<td>
<ins><tt>a = rv</tt></ins>
</td>
<td>
<ins><tt>X&amp;</tt></ins>
</td>
<td>
<ins>(In addition to the requirements of Table 95 and Table 98)<br/>
<i>Requires:</i> <tt>key_compare</tt> is <tt>MoveAssignable</tt>.<br/> 
<i>Effects:</i> Move assigns from the comparison object of <tt>rv</tt><br/>
to the comparison object of <tt>a</tt>.</ins>
</td>
<td>
<ins>Linear</ins>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.key_comp()</tt>
</td>
<td>
<tt>X::key_compare</tt>
</td>
<td>
<del>r</del><ins>R</ins>eturns <del>the</del><ins><tt>a</tt>'s</ins> comparison object<br/>
<del>out of which a was constructed.</del>
</td>
<td>
constant
</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Change 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a> p12 as indicated:</p>

<blockquote><p>
-12- When an associative container is constructed by passing a comparison object the container shall not store
a pointer or reference to the passed object, even if that object is passed by reference. <del>When an associative
container is copied, either through a copy constructor or an assignment operator, the target container shall
then use the comparison object from the container being copied, as if that comparison object had been
passed to the target container in its constructor.</del>
</p></blockquote>
</li>


<li><p>Change 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> p11 as indicated:</p>

<blockquote><p>
-11- In Table 102: <tt>X</tt> denotes an unordered associative container class, <tt>a</tt> denotes a value of type <tt>X</tt>, 
<tt>b</tt> denotes a possibly <tt>const</tt> value of type <tt>X</tt>, <ins><tt>rv</tt> denotes a non-<tt>const</tt> rvalue 
of type <tt>X</tt>,</ins> [&hellip;]
</p></blockquote>
</li>

<li><p>Change Table 102 as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 102 &mdash; Unordered associative container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X::hasher</tt>
</td>
<td>
<tt>Hash</tt>
</td>
<td>
<ins><i>Requires</i>: <tt>Hash</tt> is <tt>CopyConstructible</tt>.<br/></ins>
<tt>Hash</tt> shall be a unary function object type<br/> 
such that the expression <tt>hf(k)</tt> has type <tt>std::size_t</tt>.
</td>
<td>
compile time
</td>
</tr>

<tr>
<td>
<tt>X::key_equal</tt>
</td>
<td>
<tt>Pred</tt>
</td>
<td>
<ins><i>Requires</i>: <tt>Pred</tt> is <tt>CopyConstructible</tt>.<br/></ins>
<tt>Pred</tt> shall be a binary predicate that takes<br/> 
two arguments of type <tt>Key</tt>.<br/> 
<tt>Pred</tt> is an equivalence relation.
</td>
<td>
compile time
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X(n, hf, eq)<br/>
X a(n, hf, eq)</tt>
</td>
<td>
<tt>X</tt>
</td>
<td>
<del><i>Requires</i>: <tt>hasher</tt> and <tt>key_equal</tt> are <tt>CopyConstructible</tt>.<br/></del>
<i>Effects</i>: [&hellip;]
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>X(n, hf)<br/>
X a(n, hf)</tt>
</td>
<td>
<tt>X</tt>
</td>
<td>
<i>Requires</i>: <del><tt>hasher</tt> is <tt>CopyConstructible</tt> and<br/></del>
<tt>key_equal</tt> is <tt>DefaultConstructible</tt>.<br/>
<i>Effects</i>: [&hellip;]
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X(i, j, n, hf, eq)<br/>
X a(i, j, n, hf, eq)</tt>
</td>
<td>
<tt>X</tt>
</td>
<td>
<i>Requires</i>: <del><tt>hasher</tt> and <tt>key_equal</tt> are <tt>CopyConstructible</tt>.<br/></del>
<tt>value_type</tt> is <tt>EmplaceConstructible</tt> into <tt>X</tt> from <tt>*i</tt>.<br/>
<i>Effects</i>: [&hellip;]
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td>
<tt>X(i, j, n, hf)<br/>
X a(i, j, n, hf)</tt>
</td>
<td>
<tt>X</tt>
</td>
<td>
<i>Requires</i>: <del><tt>hasher</tt> is <tt>CopyConstructible</tt> and<br/></del>
<tt>key_equal</tt> is <tt>DefaultConstructible</tt>.<br/> 
<tt>value_type</tt> is <tt>EmplaceConstructible</tt> into <tt>X</tt> from <tt>*i</tt>.<br/>
<i>Effects</i>: [&hellip;]
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X(b)<br/>
X a(b)</tt>
</td>
<td>
<tt>X</tt>
</td>
<td>
<del>Copy constructor. In addition<br/>
to the requirements of Table 95,<br/>
copies the hash function,<br/>
predicate, and maximum load<br/>
factor.</del>
<ins>(In addition to the requirements of Table 95)<br/>
<i>Effects:</i> Copy constructs the hash function, predicate, and maximum load factor<br/> 
of <tt>a</tt> from the corresponding objects of <tt>b</tt>.</ins>
</td>
<td>
Average case linear in<br/> 
<tt>b.size()</tt>,<br/>
worst case quadratic.
</td>
</tr>

<tr>
<td>
<ins><tt>X(rv)<br/>
X a(rv)</tt></ins>
</td>
<td>
<ins><tt>X</tt></ins>
</td>
<td>
<ins>(In addition to the requirements of Table 95 and Table 98)<br/>
<i>Effects:</i> Move constructs the hash function, predicate, and maximum load factor<br/> 
of <tt>a</tt> from the corresponding objects of <tt>rv</tt>.</ins>
</td>
<td>
<ins>constant</ins>
</td>
</tr>

<tr>
<td>
<tt>a = b</tt>
</td>
<td>
<tt>X&amp;</tt>
</td>
<td>
<del>Copy assignment operator. In<br/>
addition to the requirements of<br/>
Table 95, copies the hash<br/>
function, predicate, and<br/>
maximum load factor.</del>
<ins>(In addition to the requirements of Table 95 and Table 98)<br/>
<i>Requires:</i> <tt>hasher</tt> and <tt>key_equal</tt> are <tt>CopyAssignable</tt>.<br/> 
<i>Effects:</i> Copy assigns the hash function, predicate, and maximum load factor<br/> 
of <tt>b</tt> to the corresponding objects of <tt>a</tt>.</ins>
</td>
<td>
Average case linear in<br/> 
<tt>b.size()</tt>,<br/>
worst case quadratic.
</td>
</tr>

<tr>
<td>
<ins><tt>a = rv</tt></ins>
</td>
<td>
<ins><tt>X&amp;</tt></ins>
</td>
<td>
<ins>(In addition to the requirements of Table 95 and Table 98)<br/>
<i>Requires:</i> <tt>hasher</tt> and <tt>key_equal</tt> are <tt>MoveAssignable</tt>.<br/> 
<i>Effects:</i> Move assigns the hash function, predicate, and maximum load factor<br/> 
from <tt>rv</tt> to the corresponding objects of <tt>a</tt>.</ins>
</td>
<td>
<ins>Linear</ins>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>
</ol>
</blockquote>

<p><i>[2016-08-07]</i></p>

<p>
Daniel removes the previously proposed wording to work on revised wording.
</p>

<p><i>[2019-04-22, Billy comments]</i></p>

<p>
In addition to the <i>Cpp17CopyConstructible</i> discussion going on there, I think we need to require that 
calling the comparison function when <tt>Compare</tt> itself is <tt>const</tt> needs to produce the same answer 
as if <tt>Compare</tt> is non-<tt>const</tt>.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2236" href="2236">2236.</a> <tt>kill_dependency</tt> unconditionally noexcept</h3>
<p><b>Section:</b> 31.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.syn">[atomics.syn]</a>, 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> <b>Status:</b> <a href="lwg-active.html#SG1">SG1</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2013-01-19 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#atomics.syn">active issues</a> in [atomics.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.syn">issues</a> in [atomics.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#SG1">SG1</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The "magic" <tt>kill_dependency</tt> function is a function without any constraints on the template parameter <tt>T</tt> 
and is specified as
</p>

<blockquote><pre>
template &lt;class T&gt;
T kill_dependency(T y) noexcept;
</pre><blockquote>
<p>
-14- <i>Effects</i>: The argument does not carry a dependency to the return value (1.10).
<p/>
-15- <i>Returns</i>: <tt>y</tt>.
</p>
</blockquote></blockquote>

<p>
I wonder whether the unconditional <tt>noexcept</tt> is really intended here:
Assume we have some type <tt>U</tt> that has a potentially throwing move
constructor (or it has a potentially throwing copy constructor and no
move constructor), for any "normal" function template with the same
signature and the same effects (modulo the dependency magic) this
would mean that it cannot safely be declared <tt>noexcept</tt> because of the
return statement being part of the complete function call affected by
<tt>noexcept</tt> (The by-value function argument is irrelevant in this
context). In other words it seems that a function call such as
</p>

<blockquote><pre>
struct S {
  ...
  S(const S&amp; r) { if(<em>some condition</em>) throw Something(); }
  ...
};

int main() {
  S s1 = ...;
  S s2 = std::kill_dependency(s1);
}
</pre></blockquote>

<p>
would be required to call <tt>std::terminate</tt> if the copy constructor of <tt>S</tt> throws during the return 
of <tt>std::kill_dependency</tt>.
<p/>
To require copy elision for this already magic function would look like a low-hanging fruit to solve this problem, 
but this case is not covered by current copy elision rules see 12.8 p31 b1:
<p/>
"&mdash; in a return statement in a function with a class return type, when the expression is the name of a non-volatile 
automatic object (other than a function or catch-clause parameter) with the same <em>cv</em>-unqualified type as the 
function return type, the copy/move operation can be omitted by constructing the automatic object directly into the
function's return value".
<p/>
Some options come into my mind:
</p>
<ol>
<li><p>
Make the exception-specification a constrained one in regard via <tt>std::is_nothrow_move_constructible</tt>:
</p>

<blockquote><pre>
template &lt;class T&gt;
T kill_dependency(T y) noexcept(<em>see below</em>);
</pre></blockquote>

<p>
This is similar to the approach taken for function templates such as <tt>std::swap</tt>.
</p>
</li>

<li><p>
Use perfect forwarding (This needs further wording to correct the effects):
</p>

<blockquote><pre>
template &lt;class T&gt;
T&amp;&amp; kill_dependency(T&amp;&amp; y) noexcept;
</pre></blockquote>
</li>

<li><p>
Impose constraints on the template arguments in regard to throwing exceptions while copying/moving.
</p></li>

<li><p>
Keep the state as it is but possibly add a note about a call of <tt>std::terminate</tt> in above scenario.
</p></li>
</ol>

<p>
A second problem is that the current wording is not clear whether it is well-defined to call the function with
types that are reference types, such as in the following example:
</p>

<blockquote><pre>
#include &lt;atomic&gt;

int main()
{
  int a = 12;
  int&amp; b = std::kill_dependency&lt;int&amp;&gt;(a);
}
</pre></blockquote>

<p>
It is unclear what kind of dependency is killed here. This is presumably a core language problem, but could
affect the possible resolutions of the problem.
</p>

<p><i>[2014-11 Urbana]</i></p>

<p>
Recommend using a revised example:
</p>
<blockquote><pre>
int lookup(class D* p) 
{
  class E* q = p-&gt;a.load(memory_order_consume);
  int y = std::kill_dependency(q-&gt;y);
}
</pre></blockquote>

<p><i>[2015-02 Cologne]</i></p>

<p>
Handed over to SG1.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2237" href="2237">2237.</a> <tt>&lt;cuchar&gt;</tt> macros</h3>
<p><b>Section:</b> 21.5 <a href="https://timsong-cpp.github.io/cppwp/c.strings">[c.strings]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jason Merrill <b>Opened:</b> 2013-01-29 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#c.strings">active issues</a> in [c.strings].</p>
<p><b>View all other</b> <a href="lwg-index.html#c.strings">issues</a> in [c.strings].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Apparently C1X changes <tt>__STDC_UTF_16__</tt> and <tt>__STDC_UTF_32__</tt> from macros
defined in <tt>uchar.h</tt> (and reflected in C++ by Table 79) to be predefined by the compiler. 
Do we want to do the same?
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2238" href="2238">2238.</a> Problematic iterator-pair constructor of containers</h3>
<p><b>Section:</b> 21.5 <a href="https://timsong-cpp.github.io/cppwp/c.strings">[c.strings]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Johannes Schaub <b>Opened:</b> 2013-02-02 <b>Last modified:</b> 2016-08-09 17:32:48 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#c.strings">active issues</a> in [c.strings].</p>
<p><b>View all other</b> <a href="lwg-index.html#c.strings">issues</a> in [c.strings].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The non-explicit nature of the iterator-pair constructor of containers, such a
</p>

<blockquote><pre>
template &lt;class InputIterator&gt;
vector(InputIterator first, InputIterator last, const Allocator&amp; = Allocator());
</pre></blockquote>

<p>
can be selected in unexpected situations, leading to a hard runtime error, as demonstrated by the following example:
</p>

<blockquote><pre>
#include &lt;vector&gt;

void f(std::vector&lt;char&gt; v){ /* ... */}

int main() {
  f({"A", "B"});
}
</pre></blockquote>

<p>
The actually intended initializer-list constructor isn't feasible here, so the best match is the constructor template
</p>

<blockquote><pre>
template &lt;class InputIterator&gt;
vector(InputIterator first, InputIterator last, const Allocator&amp; = Allocator());
</pre></blockquote>

<p>
This compiles, but will result in code running amok. The potential trap (that cannot be easily detected by the
library implementation) could be reduced by making this constructor explicit. It would still have the effect to 
be selected here, but the code would be ill-formed, so the programmer gets a clear message here.
</p>

<p><i>[2014-06 Rapperswil]</i></p>

<p>
JW: can't fix this, don't want to touch this, Do The Right Thing clause has been a source of tricky issues. 
only really happens with string literals, that's the only way to create an array that isn't obviously an array
<p/>
GR: want to see paper
<p/>
AM: is it only string literals, or also UDLs?
<p/>
STL: maybe, but we don't need to deal with that. This is only a problem in a very specific case 
<p/>
Leave as Open. 
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2248" href="2248">2248.</a> <tt>numeric_limits::is_iec559</tt> misnamed</h3>
<p><b>Section:</b> 17.3.5 <a href="https://timsong-cpp.github.io/cppwp/numeric.limits">[numeric.limits]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Pete Becker <b>Opened:</b> 2013-03-08 <b>Last modified:</b> 2018-11-08 23:01:28 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#numeric.limits">active issues</a> in [numeric.limits].</p>
<p><b>View all other</b> <a href="lwg-index.html#numeric.limits">issues</a> in [numeric.limits].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>

<p>
This member should probably be named "is_ieee754". Or at least the standard should explain that IEC-559 no longer exists, 
and that it's been superseded by IEEE-754.
</p>

<p><i>[2016-06, Oulu]</i></p>

<p>The ISO version of the standard is ISO/IEC/IEEE 60559:2011,
which C11 Annex F refers to as IEC 60559
(although C still refers to it as IEC 559 in the <code>__STDC_IEC_559__</code> macro).
</p>
  


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2262" href="2262">2262.</a> Requirement for <tt>unique_ptr&lt;T&gt;::get_deleter()(p)</tt> to be able to destroy the <tt>unique_ptr</tt></h3>
<p><b>Section:</b> 20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Rob Desbois <b>Opened:</b> 2013-05-15 <b>Last modified:</b> 2017-03-21 22:54:52 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#unique.ptr.single">active issues</a> in [unique.ptr.single].</p>
<p><b>View all other</b> <a href="lwg-index.html#unique.ptr.single">issues</a> in [unique.ptr.single].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
N3337 20.11.1.2.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.modifiers">[unique.ptr.single.modifiers]</a> contains 2 non-normative notes stating:
</p>

<blockquote>
<p>
[para 4]: &quot;The order of these operations is significant because the call to <tt>get_deleter()</tt> 
may destroy <tt>*this</tt>.&quot;
</p>
<p>
[para 5]: &quot;The postcondition does not hold if the call to <tt>get_deleter()</tt> destroys <tt>*this</tt> since 
<tt>this->get()</tt> is no longer a valid expression.&quot;
</p>
</blockquote>

<p>
It seems this wording was created to resolve <a href="998">998</a> due to the possibility that a <tt>unique_ptr</tt> may be 
destroyed through deletion of its stored pointer where that directly or indirectly refers to the same <tt>unique_ptr</tt>. 
If <tt>unique_ptr</tt> is required to support circular references then it seems this must be normative text: an implementation 
is currently allowed to operate on <tt>*this</tt> after the assignment and deletion specified in para 4, since this is only 
'disallowed' by the non-normative note.
</p>

<p>I propose the following draft rewording:</p>

<p>
[para 4]: <i>Effects</i>: assigns <tt>p</tt> to the stored pointer, and then if the old value of the stored pointer, <tt>old_p</tt>, was not
equal to <tt>nullptr</tt>, calls <tt>get_deleter()(old_p)</tt>. <ins>No operation shall be performed after the call to 
<tt>get_deleter()(old_p)</tt> that requires <tt>*this</tt> to be valid, because the deletion may destroy <tt>*this</tt> if it is 
referred to directly or indirectly by the stored pointer.</ins> <del>[<i>Note:</i> The order of these operations is significant
because the call to <tt>get_deleter()</tt> may destroy <tt>*this</tt>. &mdash; <i>end note</i>]</del>
<p/>
[para 5]: <i>Postconditions</i>: <ins>If the call <tt>get_deleter()(old_p)</tt> destroyed <tt>*this</tt>, none. Otherwise,</ins> 
<tt>get() == p</tt>. <del>[<i>Note:</i> The postcondition does not hold if the call to <tt>get_deleter()</tt>
destroys <tt>*this</tt> since <tt>this->get()</tt> is no longer a valid expression. &mdash; <i>end note</i>]</del>
</p>

<p>
I expect it will also be necessary to amend the requirements for a deleter, so in addition:
</p>

<p>
20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> [para 1]: The default type for the template parameter <tt>D</tt> is <tt>default_delete</tt>. 
A client-supplied template argument <tt>D</tt> shall be a function object type (20.10), lvalue-reference to function, or 
lvalue-reference to function object type for which, given a value <tt>d</tt> of type <tt>D</tt> and a value <tt>ptr</tt> of type 
<tt>unique_ptr&lt;T, D&gt;::pointer</tt>, the expression <tt>d(ptr)</tt> is valid and has the effect of disposing of the pointer 
as appropriate for that deleter. <ins>Where <tt>D</tt> is not an lvalue reference type, <tt>d(ptr)</tt> shall be valid if <tt>ptr</tt> 
refers directly or indirectly to the invoking <tt>unique_ptr</tt> object.</ins>
</p>

<p><i>[2013-10-05, Stephan T. Lavavej comments and provides alternative wording]</i></p>

<p>
In Chicago, we determined that the original proposed change to 20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a>/1 was insufficient, because 
<tt>d</tt> might be a reference to a deleter functor that's destroyed during self-destruction.
<p/>
We believed that 20.11.1.2.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.modifiers">[unique.ptr.single.modifiers]</a>/4 was already sufficiently clear. The Standard occasionally prevents 
implementations of <tt>X</tt> from doing various things, through the principle of "nothing allows <tt>X</tt> to fail in that situation".  
For example, <tt>v.push_back(v[0])</tt> is required to work for non-empty vectors because nothing allows that to fail. In this case, 
the intent to allow self-destruction is already clear.
<p/>
Additionally, we did not believe that 20.11.1.2.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.modifiers">[unique.ptr.single.modifiers]</a>/5 had to be changed. The current note is slightly 
squirrely but it does not lead to confusion for implementers or users.
</p>

<p>
Previous resolution from Rob Desbois:
</p>
<blockquote class="note">
<ol>
<li>
<p>
Edit 20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> p1 as indicated:
</p>
<blockquote><p>
The default type for the template parameter <tt>D</tt> is <tt>default_delete</tt>. 
A client-supplied template argument <tt>D</tt> shall be a function object type (20.10), lvalue-reference to function, or 
lvalue-reference to function object type for which, given a value <tt>d</tt> of type <tt>D</tt> and a value <tt>ptr</tt> of type 
<tt>unique_ptr&lt;T, D&gt;::pointer</tt>, the expression <tt>d(ptr)</tt> is valid and has the effect of disposing of the pointer 
as appropriate for that deleter. <ins>Where <tt>D</tt> is not an lvalue reference type, <tt>d(ptr)</tt> shall be valid if <tt>ptr</tt> 
refers directly or indirectly to the invoking <tt>unique_ptr</tt> object.</ins>
</p></blockquote>
</li>

<li>
<p>
Edit 20.11.1.2.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.modifiers">[unique.ptr.single.modifiers]</a> p4+5 as indicated:
</p>
<blockquote><pre>
void reset(pointer p = pointer()) noexcept;
</pre><blockquote>
<p>
-3- <i>Requires:</i> The expression <tt>get_deleter()(get())</tt> shall be well formed, shall have well-defined behavior,
and shall not throw exceptions.
<p/>
-4- <i>Effects:</i> assigns <tt>p</tt> to the stored pointer, and then if the old value of the stored pointer, <tt>old_p</tt>, was not
equal to <tt>nullptr</tt>, calls <tt>get_deleter()(old_p)</tt>. <ins>No operation shall be performed after the call to 
<tt>get_deleter()(old_p)</tt> that requires <tt>*this</tt> to be valid, because the deletion may destroy <tt>*this</tt> if it is 
referred to directly or indirectly by the stored pointer.</ins> <del>[<i>Note:</i> The order of these operations is significant
because the call to <tt>get_deleter()</tt> may destroy <tt>*this</tt>. &mdash; <i>end note</i>]</del>
<p/>
-5- <i>Postconditions:</i> <ins>If the call <tt>get_deleter()(old_p)</tt> destroyed <tt>*this</tt>, none. Otherwise,</ins> 
<tt>get() == p</tt>. <del>[<i>Note:</i> The postcondition does not hold if the call to <tt>get_deleter()</tt>
destroys <tt>*this</tt> since <tt>this->get()</tt> is no longer a valid expression. &mdash; <i>end note</i>]</del>
</p>
</blockquote></blockquote>
</li>
</ol>

</blockquote>

<p>
<strong>Previous resolution [SUPERSEDED]:</strong>
</p>
<blockquote class="note">
<p>This wording is relative to N3691.</p>

<ol>
<li>
<p>
Edit 20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> p1 as indicated:
</p>
<blockquote><p>
The default type for the template parameter <tt>D</tt> is <tt>default_delete</tt>. 
A client-supplied template argument <tt>D</tt> shall be a function object type (20.10), lvalue-reference to function, or 
lvalue-reference to function object type for which, given a value <tt>d</tt> of type <tt>D</tt> and a value <tt>ptr</tt> of type 
<tt>unique_ptr&lt;T, D&gt;::pointer</tt>, the expression <tt>d(ptr)</tt> is valid and has the effect of disposing of the pointer 
as appropriate for that deleter. <ins><tt>d(ptr)</tt> shall be valid even if it triggers the destruction of <tt>d</tt> or (if 
<tt>D</tt> is an lvalue reference to function object type) the function object that <tt>d</tt> refers to.</ins>
</p></blockquote>
</li>
</ol>
</blockquote>

<p><i>[2015-05, Lenexa]</i></p>

<p>
After some discussion in Lenexa there was some wavering on if the added sentence is necessary. Here is example code that 
demonstrates why the extra sentence is necessary. In this example the call to <tt>d(ptr)</tt> is valid, however the deleter 
references <tt>*this</tt> after destructing its element:
</p>
<blockquote><pre>
#include &lt;cassert&gt;
#include &lt;memory&gt;
#include &lt;iostream&gt;

class Deleter
{
    int state_ = 0;

    enum
    {
        destructed            = -4,
        self_move_assigned    = -3,
        move_assigned_from    = -2,
        move_constructed_from = -1
    };
public:
    ~Deleter() {state_ = destructed;}

    Deleter() = default;
    Deleter(Deleter const&amp;) = default;
    Deleter&amp; operator=(Deleter const&amp;) = default;

    Deleter(Deleter&amp;&amp; a) noexcept
        : state_(a.state_)
    {a.state_ = move_constructed_from;}

    Deleter&amp; operator=(Deleter&amp;&amp; a) noexcept
    {
        if (this == &amp;a)
            state_ = self_move_assigned;
        else
        {
            state_ = a.state_;
            a.state_ = move_assigned_from;
        }
        return *this;
    }

    Deleter(int state)
        : state_(state)
    {
        assert(state &gt;= 0);
    }

    template &lt;class T&gt;
    void
    operator()(T* t) const
    {
        std::cout &lt;&lt; "Deleter beginning operator()(T*)\n";
        std::cout &lt;&lt; "The deleter = " &lt;&lt; *this &lt;&lt; '\n';
        std::cout &lt;&lt; "Deleter about to destruct the X.\n";
        delete t;
        std::cout &lt;&lt; "Deleter has destructed the X.\n";
        std::cout &lt;&lt; "The deleter = " &lt;&lt; *this &lt;&lt; '\n';
        std::cout &lt;&lt; "Deleter ending operator()(T*)\n";
    }

    friend
    std::ostream&amp;
    operator&lt;&lt;(std::ostream&amp; os, const Deleter&amp; a)
    {
        switch (a.state_)
        {
        case destructed:
            os &lt;&lt; "**destructed**";
            break;
        case self_move_assigned:
            os &lt;&lt; "self_move_assigned";
            break;
        case move_assigned_from:
            os &lt;&lt; "move_assigned_from";
            break;
        case move_constructed_from:
            os &lt;&lt; "move_constructed_from";
            break;
        default:
            os &lt;&lt; a.state_;
            break;
        }
        return os;
    }
};

struct X
{
    Deleter deleter_{1};
};

int main()
{
    auto xp = new X;
    {
        std::unique_ptr&lt;X, Deleter&amp;&gt; p(xp, xp-&gt;deleter_);
        std::cout &lt;&lt; "unique_ptr is constructed.\n";
        std::cout &lt;&lt; "The deleter = " &lt;&lt; p.get_deleter() &lt;&lt; '\n';
        std::cout &lt;&lt; "Destructing unique_ptr...\n";
    }
    std::cout &lt;&lt; "unique_ptr is destructed.\n";
}
</pre></blockquote>
<p>
Which outputs:
</p>
<blockquote>
<pre>
unique_ptr is constructed.
The deleter = 1
Destructing unique_ptr...
Deleter beginning operator()(T*)
The deleter = 1
Deleter about to destruct the X.
Deleter has destructed the X.
The deleter = **destructed**
Deleter ending operator()(T*)
unique_ptr is destructed.
</pre>
</blockquote>
<p>
The line "<tt>The deleter = **destructed**</tt>" represents the deleter referencing itself after it has been destructed by the 
<tt>d(ptr)</tt> expression, but prior to that call returning.
<p/>
Suggested alternative to the current proposed wording:
</p>
<blockquote>
<p>
The expression <tt>d(ptr)</tt> shall not refer to the object <tt>d</tt> after it executes <tt>ptr-&gt;~T()</tt>.
</p>
</blockquote>

<p><i>[2015-07, Telecon]</i></p>

<p>
Geoffrey: Deleter may or may not execute ~T().<br/>
Alisdair: After the destructor after the element has run. Say it in words instead of code. <br/>
Howard will provide updated wording. Perhaps need both normative and non-normative wording.<br/>
</p>

<p><i>[2015-08-03, Howard updates P/R per telecon discussion.]</i></p>


<p><i>[2017-03-04, Kona]</i></p>

<p>This is related to <a href="2751">2751</a>, which has been suggested NAD.</p>
<p>STL wants "Effects equivalent to" here - say it in code.  Marshall to research.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4431.</p>

<ol>
<li>
<p>
Edit 20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> p1 as indicated:
</p>
<blockquote><p>
The default type for the template parameter <tt>D</tt> is <tt>default_delete</tt>. 
A client-supplied template argument <tt>D</tt> shall be a function object type (20.9), lvalue-reference to function, or 
lvalue-reference to function object type for which, given a value <tt>d</tt> of type <tt>D</tt> and a value <tt>ptr</tt> of type 
<tt>unique_ptr&lt;T, D&gt;::pointer</tt>, the expression <tt>d(ptr)</tt> is valid and has the effect of disposing of the pointer 
as appropriate for that deleter. <ins>The expression <tt>d(ptr)</tt>, if it destructs the object referred to by <tt>ptr</tt>,
shall not refer to the object <tt>d</tt> after it destructs <tt>*ptr</tt>.
[<i>Note:</i> The object being destructed may control the lifetime of <tt>d</tt>. &mdash; <i>end note</i>]</ins>
</p></blockquote>
</li>
</ol>






<hr>
<h3><a name="2265" href="2265">2265.</a> 29.3p9 appears to rule out some acceptable executions</h3>
<p><b>Section:</b> 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Brian Demsky <b>Opened:</b> 2013-06-17 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#atomics.order">active issues</a> in [atomics.order].</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.order">issues</a> in [atomics.order].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I believe that the following variation on IRIW should admit executions in
which <tt>c1 = d1 = 5</tt> and <tt>c2 = d2 = 0</tt>.  If this is allowed, then what is sequence of
program evaluations for 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p9 that justifies the store to <tt>z</tt>?  It seems that
31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p9 should not allow this execution because one of the stores to <tt>x</tt> or <tt>y</tt> has
to appear earlier in the sequence, each of the <tt>fetch_adds</tt> reads the previous load in the thread (and thus must 
appear later in the sequence), and 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p9 states that each load must read from the last prior 
assignment in the sequence.
</p>

<blockquote><pre>
atomic_int x;
atomic_int y;
atomic_int z;
int c1, c2, d1, d2;

static void a(void* obj)
{
  atomic_store_explicit(&amp;x, 5, memory_order_relaxed); 
}

static void b(void* obj)
{
  atomic_store_explicit(&amp;y, 5, memory_order_relaxed); 
}

static void c(void* obj)
{
  c1 = atomic_load_explicit(&amp;x, memory_order_relaxed);
  // this could also be an atomic load if the address depends on c1:
  c2 = atomic_fetch_add_explicit(&amp;y, c1, memory_order_relaxed);  
}

static void d(void* obj)
{
  d1 = atomic_load_explicit(&amp;y, memory_order_relaxed);
  d2 = atomic_fetch_add_explicit(&amp;x, d1, memory_order_relaxed); 
}

int user_main(int argc, char** argv)
{
  thrd_t t1, t2, t3, t4;

  atomic_init(&amp;x, 0);
  atomic_init(&amp;y, 0);

  printf("Main thread: creating 4 threads\n");
  thrd_create(&amp;t1, (thrd_start_t)&amp;a, NULL);
  thrd_create(&amp;t2, (thrd_start_t)&amp;b, NULL);
  thrd_create(&amp;t3, (thrd_start_t)&amp;c, NULL);
  thrd_create(&amp;t4, (thrd_start_t)&amp;d, NULL);

  thrd_join(t1);
  thrd_join(t2);
  thrd_join(t3);
  thrd_join(t4);
  printf("c1=%d c2=%d\n",c1,c2);
  printf("d1=%d d2=%d\n",d1,d2);

  // Can this store write 1000 (i.e., c1=d1=5, c2=d2=0)?
  atomic_store(&amp;z, (c1+d1)*100+c2+d2);

  printf("Main thread is finished\n");

  return 0;
}
</pre></blockquote>

<p>
It seems that the easiest fix is to allow a load in 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> p9 to read from any prior
store in the evaluation order.
<p/>
That said, I would personally advocate the following:
It seems to me that C/C++ atomics are in a bit of different situation than Java
because:
</p>
<ol>
<li><p>People are expected to use relaxed C++ atomics in potentially racy
situations, so it isn't clear that semantics as complicated as the JMM's
causality would be sane.
</p></li>
<li><p>People who use C/C++ atomics are likely to be experts and use them in a
very controlled fashion. I would be really surprised if compilers would find
any real wins by optimizing the use of atomics.
</p></li>
</ol>
<p>
Why not do something like:
<p/>
There is satisfaction DAG of all program evaluations. Each evaluation
observes the values of variables as computed by some prior assignment in
the DAG.
<p/>
There is an edge <tt>x-&gt;y</tt> between two evaluations <tt>x</tt> and <tt>y</tt> if:
</p>
<ol>
<li><p>the evaluation <tt>y</tt> observes a value computed by the evaluation <tt>x</tt> or
</p></li>
<li><p>the evaluation <tt>y</tt> is an atomic store, the evaluation <tt>x</tt> is an atomic load, and
there is a condition branch c that may depend (intrathread dependence) on <tt>x</tt>
and <tt>x-sb-&gt;c</tt> and <tt>c-sb-&gt;y</tt>.
</p></li>
</ol>
<p>
This seems to allow reordering of relaxed atomics that processors do without
extra fence instructions, allows most reorderings by the compiler, and gets
rid of satisfaction cycles.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
Handed over to SG1.
</p>


<p><i>[2015-05 Lenexa, SG1 response]</i></p>

<p>
This was partially addressed (weasel-worded) in C++14 (See <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3786.htm">N3786</a>).
The remainder is an open research problem.  <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3710.html">N3710</a> outlines a "solution" that doesn't have a consensus behind it because it costs performance.  We have no better solution at the moment.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2267" href="2267">2267.</a> <tt>partial_sort_copy</tt> underspecified for ranges of two different types</h3>
<p><b>Section:</b> 25.7.1.4 <a href="https://timsong-cpp.github.io/cppwp/partial.sort.copy">[partial.sort.copy]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Matt Austern  <b>Opened:</b> 2013-06-26 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The signature of this function is:
</p>

<blockquote><pre>
template&lt;class InputIterator, class RandomAccessIterator&gt;
RandomAccessIterator
partial_sort_copy(InputIterator first, InputIterator last,
                  RandomAccessIterator result_first,
                  RandomAccessIterator result_last);

</pre></blockquote>

<p>
(and the usual overload for an explicitly provided comparison function). The standard says nothing about requirements 
in the case where the input type (<tt>iterator_traits&lt;InputIterator&gt;::value_type</tt>) and the output type 
(<tt>iterator_traits&lt;RandomAccessIterator&gt;::value_type</tt>) are different.
<p/>
Presumably the input type must be convertible to the output type. What's less clear is what the requirements are on 
the comparison operator. Does the algorithm only perform comparisons on two values of the output type, or does it also 
perform comparisons on values of the input type, or might it even perform heterogeneous comparisons?
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2269" href="2269">2269.</a> Container iterators and argument-dependent lookup</h3>
<p><b>Section:</b> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Matt Austern <b>Opened:</b> 2013-06-26 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#container.requirements.general">active issues</a> in [container.requirements.general].</p>
<p><b>View all other</b> <a href="lwg-index.html#container.requirements.general">issues</a> in [container.requirements.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Consider the following code snippet:
</p>

<blockquote><pre>
#include &lt;vector&gt;
#include &lt;algorithm&gt;

int main() {
  std::vector&lt;int&gt; v1(100, 3);
  std::vector&lt;int&gt; v2(100);
  copy(v1.begin(), v1.end(), v2.begin());
}
</pre></blockquote>

<p>
It compiles without error on my desktop. Is it required to? I can't find evidence from the standard that it is. 
In my test <tt>std::copy</tt> was found by argument-dependent lookup because the implementation I used made 
<tt>std::vector&lt;int&gt;::iterator</tt> a user-defined type defined in namespace <tt>std</tt>. But the standard 
only requires <tt>std::vector&lt;int&gt;::iterator</tt> to be an implementation specified random access iterator 
type. I can't find anything requiring it to be a user-defined type at all (and in fact there are reasonable implementation 
where it isn't), let alone a user defined type defined in a specific namespace.
</p>

<p>
Since the defining namespace of container iterators is visible to users, should the standard say anything about what 
that namespace is?
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2286" href="2286">2286.</a> <tt>stringbuf::underflow()</tt> underspecified</h3>
<p><b>Section:</b> 29.8.2.4 <a href="https://timsong-cpp.github.io/cppwp/stringbuf.virtuals">[stringbuf.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Sergey Zubkov <b>Opened:</b> 2013-08-29 <b>Last modified:</b> 2018-06-12 02:06:47 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#stringbuf.virtuals">active issues</a> in [stringbuf.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#stringbuf.virtuals">issues</a> in [stringbuf.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In 29.8.2.4 <a href="https://timsong-cpp.github.io/cppwp/stringbuf.virtuals">[stringbuf.virtuals]</a>/1, <tt>basic_stringbuf::underflow()</tt> is specified to unconditionally 
return <tt>traits::eof()</tt> when a read position is not available.
<p/>
The semantics of <tt>basic_stringbuf</tt> require, and existing libraries implement it so that this function makes 
a read position available if possible to do so, e.g. if some characters were inserted into the stream since the 
last call to <tt>overflow()</tt>, resulting in <tt>pptr() &gt; egptr()</tt>. Compare to the conceptually similar 
D.10.2.3 <a href="https://timsong-cpp.github.io/cppwp/depr.strstreambuf.virtuals">[depr.strstreambuf.virtuals]</a>/15.
</p>

<p><i>[2018-06-06, Billy argues for NAD]</i></p>

<p>
The existing "Any character in the underlying buffer which has been initialized is considered to be part of the input sequence." 
sentence already describes what the <tt>stringbuf</tt> is supposed to do to the get area. The specific mechanism that the 
<tt>stringbuf</tt> uses to alter the get area is unspecified because the mechanism by which the <tt>stringbuf</tt> 
remembers the "high water mark" is unspecified.
<p/>
Consider the following:
</p>
<blockquote><pre>
stringstream s;
s &lt;&lt; "Hello";
s.seekp(0);
string x;
s &gt;&gt; x;
</pre></blockquote>
<p>
Before this P/R, this will store <tt>Hello</tt> in <tt>x</tt>, because the characters <tt>Hello</tt> are initialized. 
After this P/R, the "written put area" is empty, so it will store the empty string in <tt>x</tt>.
<p/>
Saying that the initialized part of the string is used already describes what needs to happen here.
</p>

<p><i>[2018-06 Rapperswil Wednesday issues processing]</i></p>

<p>Billy to provide rationale for closing as NAD.</p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3691.</p>

<ol>

<li><p>Change 29.8.2.4 <a href="https://timsong-cpp.github.io/cppwp/stringbuf.virtuals">[stringbuf.virtuals]</a> as indicated:</p>

<blockquote>
<pre>
int_type underflow();
</pre><blockquote>
<p>
-1- <i>Returns:</i> If the input sequence has a read position available <ins>or the function makes a read position available 
(as described below)</ins>, returns <tt>traits::to_int_type(*gptr())</tt>. Otherwise, returns <tt>traits::eof()</tt>. Any 
character in the underlying buffer which has been initialized is considered to be part of the input sequence.
<p/>
<ins>-?- The function can make a read position available only if <tt>(mode &amp; ios_base::in) != 0</tt> and if the write 
next pointer <tt>pptr()</tt> is not null and is greater than the current read end pointer <tt>egptr()</tt>. To make a read 
position available, the function alters the read end pointer <tt>egptr()</tt> to equal <tt>pptr()</tt>.</ins>
</p>
</blockquote></blockquote>
</li>

</ol>





<hr>
<h3><a name="2289" href="2289">2289.</a> <tt>constexpr</tt> guarantees of defaulted functions still insufficient</h3>
<p><b>Section:</b> 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a>, 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a>, 27.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration">[time.duration]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2013-09-09 <b>Last modified:</b> 2016-12-14 19:04:58 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#pairs.pair">active issues</a> in [pairs.pair].</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs.pair">issues</a> in [pairs.pair].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
During the acceptance of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3471.html">N3471</a> and
some similar <tt>constexpr</tt> papers, specific wording was added to <tt>pair</tt>, <tt>tuple</tt>, and other templates
that were intended to impose implementation constraints that ensure that the observable <tt>constexpr</tt> "character"
of a defaulted function template is solely determined by the required expressions of the user-provided types when instantiated,
for example:
</p>

<blockquote><p>
The defaulted move and copy constructor, respectively, of pair shall be a <tt>constexpr</tt> function if and only if
all required element-wise initializations for copy and move, respectively, would satisfy the requirements for
a <tt>constexpr</tt> function.
</p></blockquote>

<p>
This wording doesn't require enough, especially since the core language via CWG 1358 does now support <tt>constexpr</tt>
function template instantiations, even if such function cannot appear in a constant expression (as specified in 7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>) 
or as a constant initializer of that object (as specified in  [basic.start.init]). The wording should be 
improved and should require valid uses in constant expressions and as constant initializers instead.
</p>

<p><i>[Lenexa 2015-05-05]</i></p>

<p>STL : notice order of move/copy and copy/move with "respectively".</p>
<p>General word-smithing; ask for updated wording</p>
<p>Are we happy with this with changes we are suggesting?</p>
<p>unanimous</p>

<p><i>[2016-12-14, Daniel comments]</i></p>

<p>
LWG <a href="2833">2833</a> overlaps considerably and both should be resolved together.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3691.</p>

<ol>
<li><p>Change 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> p2 as indicated:</p>

<blockquote>
<p>
-2- <del>The defaulted move and copy constructor, respectively, of pair shall be a <tt>constexpr</tt> function if and only if
all required element-wise initializations for copy and move, respectively, would satisfy the requirements for
a <tt>constexpr</tt> function</del><ins>An invocation of the move or copy constructor of <tt>pair</tt> shall be a constant expression 
(7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>) if all required element-wise initializations would be constant expressions. An invocation of the 
move or copy constructor of <tt>pair</tt> shall be a constant initializer for that <tt>pair</tt> object ( [basic.start.init])
if all required element-wise initializations would be constant initializers for the respective subobjects</ins>.
</p>
</blockquote>
</li>

<li><p>Change 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> p2 as indicated:</p>

<blockquote>
<p>
-2- <del>The defaulted move and copy constructor, respectively, of <tt>tuple</tt> shall be a <tt>constexpr</tt> function if 
and only if all required element-wise initializations for copy and move, respectively, would satisfy the requirements for
a <tt>constexpr</tt> function. The defaulted move and copy constructor of <tt>tuple&lt;&gt;</tt> shall be <tt>constexpr</tt> 
functions</del><ins>An invocation of the move or copy constructor of <tt>tuple</tt> shall be a constant expression (7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>)
if all required element-wise initializations would be constant expressions. An invocation of the move or copy constructor of 
<tt>tuple</tt> shall be a constant initializer for that <tt>tuple</tt> object ( [basic.start.init]) if all 
required element-wise initializations would be constant initializers for the respective subobjects. An invocation of the 
move or copy constructor of <tt>tuple&lt;&gt;</tt> shall be a constant expression, or a constant initializer for that 
<tt>tuple&lt;&gt;</tt> object, respectively, if the function argument would be constant expression</ins>.
</p>
</blockquote>
</li>

<li><p>Change 27.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration">[time.duration]</a> p7 as indicated:</p>

<blockquote>
<p>
-7- <i>Remarks:</i> <del>The defaulted copy constructor of duration shall be a <tt>constexpr</tt> function if and only if
the required initialization of the member <tt>rep_</tt> for copy and move, respectively, would satisfy the
requirements for a <tt>constexpr</tt> function.</del><ins>An invocation of the copy constructor of <tt>duration</tt> shall 
be a constant expression (7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>) if the required initialization of the member <tt>rep_</tt> would be a constant expression.
An invocation of the copy constructor of <tt>duration</tt> shall be a constant initializer for that <tt>duration</tt> object 
( [basic.start.init]) if the required initialization of the member <tt>rep_</tt> would be constant initializers 
for this subobject</ins>.
</p>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="2290" href="2290">2290.</a> Top-level "SFINAE"-based constraints should get a separate definition in Clause 17</h3>
<p><b>Section:</b> 20.15 <a href="https://timsong-cpp.github.io/cppwp/meta">[meta]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2013-09-02 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta">active issues</a> in [meta].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta">issues</a> in [meta].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current library specification uses at several places wording that is intended to refer to
core language template deduction failure at the top-level of expressions (aka "SFINAE"), for example:
</p>

<blockquote><p>
The expression <tt>declval&lt;T&gt;() = declval&lt;U&gt;()</tt> is well-formed when treated as an unevaluated operand (Clause 5). 
Access checking is performed as if in a context unrelated to <tt>T</tt> and <tt>U</tt>. Only the validity of the immediate context 
of the assignment expression is considered. [<i>Note:</i> The compilation of the expression can result in side effects 
such as the instantiation of class template specializations and function template specializations, the generation of
implicitly-defined functions, and so on. Such side effects are not in the "immediate context" and can result in the program
being ill-formed. &mdash; <i>end note</i>]
</p></blockquote>

<p>
Similar wording can be found in the specification of <tt>result_of</tt>, <tt>is_constructible</tt>, and <tt>is_convertible</tt>,
being added to resolve an NB comment by LWG <a href="1390">1390</a> and <a href="1391">1391</a> through 
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3142.html">N3142</a>.
<p/>
This wording is necessary to limit speculative compilations needed to implement these traits, but it is also lengthy and repetitive.
</p>

<p><i>[2014-05-19, Daniel suggests a descriptive term]</i></p>

<p>
<b>constrictedly well-formed expression</b>:
<p/>
An expression <em>e</em> depending on a set of types <tt>A1</tt>, ..., <tt>An</tt> which is well-formed when treated as 
an unevaluated operand (Clause 5). Access checking is performed as if in a context unrelated to <tt>A1</tt>, ..., 
<tt>An</tt>. Only the validity of the immediate context of <em>e</em> is considered. [<i>Note:</i> The compilation of 
the expression can result in side effects such as the instantiation of class template specializations and function 
template specializations, the generation of implicitly-defined functions, and so on. Such side effects are not in the 
"immediate context" and can result in the program being ill-formed. &mdash; <i>end note</i>]
</p>

<p><i>[2014-05-20, Richard and Jonathan suggest better terms]</i></p>

<p>
Richard suggested "locally well-formed"
<p/>
Jonathan suggested "contextually well-formed" and then "The expression ... is valid in a contrived argument
deduction context"
</p>

<p><i>[2014-06-07, Daniel comments and improves wording]</i></p>

<p>
The 2014-05-19 suggestion did only apply to expressions, but there are two important examples that are not expressions, but instead
are involving an <em>object definition</em> (<tt>std::is_constructible</tt>) and a <em>function definition</em> 
(<tt>std::is_convertible</tt>), respectively, instead. Therefore I suggest to rephrase the usage of "expression" into "program 
construct" in the definition of Jonathan's suggestion of "valid in a contrived argument deduction context".
<p/>
I would like to point out that given the new definition of "valid in a contrived argument deduction context", there are several other 
places of the Library specification that could take advantage of this wording to improve the existing specification, such as 
20.14.16.2 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func">[func.wrap.func]</a> p2, most functions in 20.10.9.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.traits.members">[allocator.traits.members]</a>, and the <tt>**Insertable</tt>, 
<tt>EmplaceConstructible</tt>, and <tt>Erasable</tt> definitions in 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>, but given that
these are not fully described in terms of the aforementioned wording <em>yet</em>, I would recommend to fix them by a separate issue 
once the committee has agreed on following the suggestion presented by this issue.
</p>

<p><i>[2015-05-05 Lenexa: Move to Open]</i></p>

<p>...</p>
<p>MC: I think we like the direction but it isn't quite right: it needs some work</p>
<p>JW: I'm prepared to volunteer to move that further, hopefully with the help of Daniel</p>
<p>Roger Orr: should this be Core wording because it doesn't really have anything to do with libraries - the term could then just be used here</p>
<p>AM: Core has nothing to deal with that, though</p>
<p>HT: it seems there is nothing to imply that allows dropping out with an error - maybe that's a separate issue</p>
<p>MC: I'm not getting what you are getting at: could you write an issue? - any objection to move to Open?</p>
<p>...</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3936.</p>

<ol>
<li><p>Add the following new definition to 16.3 <a href="https://timsong-cpp.github.io/cppwp/definitions">[definitions]</a> as indicated:</p>

<p>
<ins><b>valid in a contrived argument deduction context</b> [defns.valid.contr.context]</ins>
<p/>
<ins>A program construct <em>c</em> depending on a set of types <tt>A1</tt>, ..., <tt>An</tt>, and treated as 
an unevaluated operand (Clause 5) when <em>c</em> is an expression, which is well-formed. 
Access checking is performed as if in a context unrelated to <tt>A1</tt>, ..., <tt>An</tt>. 
Only the validity of the immediate context (13.10.2 <a href="https://timsong-cpp.github.io/cppwp/temp.deduct">[temp.deduct]</a>) of <em>c</em> is considered. 
[<i>Note:</i> The compilation of <em>c</em> can result in side effects such as the instantiation of class template 
specializations and function template specializations, the generation of implicitly-defined functions, and so on. 
Such side effects are not in the "immediate context" and can result in the program being ill-formed. &mdash; 
<i>end note</i>].</ins>
</p>
</li>

<li><p>Change Table 49 ("Type property predicates") as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 49 &mdash; Type property predicates</caption>
<tr>
<th align="center">Template</th>
<th align="center">Condition</th>
<th align="center">Preconditions</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>template &lt;class T, class U&gt;<br/>
struct is_assignable;</tt>
</td>

<td>
The expression
<tt>declval&lt;T&gt;() =<br/>
declval&lt;U&gt;()</tt> is <ins>valid in a<br/>
contrived argument deduction context<br/>
([defns.valid.contr.context]) for types<br/>
<tt>T</tt> and <tt>U</tt>.</ins>
<del>well-formed when treated<br/>
as an unevaluated operand<br/>
(Clause 5). Access<br/>
checking is performed as if<br/>
in a context unrelated to <tt>T</tt><br/>
and <tt>U</tt>. Only the validity of<br/>
the immediate context of<br/>
the assignment expression<br/>
is considered. [<i>Note</i>: The<br/>
compilation of the<br/>
expression can result in<br/>
side effects such as the<br/>
instantiation of class<br/>
template specializations<br/>
and function template<br/>
specializations, the<br/>
generation of<br/>
implicitly-defined<br/>
functions, and so on. Such<br/>
side effects are not in the<br/>
"immediate context" and<br/>
can result in the program<br/>
being ill-formed. &mdash; end<br/>
note]</del>
</td>

<td align="center">
[&hellip;]
</td>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Change 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> p7 as indicated:</p>

<blockquote><p>
-7- Given the following function prototype:
</p>
<blockquote><pre>
template &lt;class T&gt;
  add_rvalue_reference_t&lt;T&gt; create() noexcept;
</pre></blockquote>
<p>
the predicate condition for a template specialization <tt>is_constructible&lt;T, Args...&gt;</tt> shall be satisfied
if and only if the following variable definition <del>would be well-formed</del> for some invented 
variable <tt>t</tt> <ins>would be valid in a contrived argument deduction context ([defns.valid.contr.context]) for 
types <tt>T</tt> and <tt>Args...</tt></ins>:
</p>
<blockquote><pre>
T t(create&lt;Args&gt;()...);
</pre></blockquote>
<p>
[<i>Note</i>: These tokens are never interpreted as a function declaration. &mdash; <i>end note</i>] <del>Access checking is
performed as if in a context unrelated to <tt>T</tt> and any of the <tt>Args</tt>. Only the validity of the immediate context
of the variable initialization is considered. [<i>Note</i>: The evaluation of the initialization can result in side
effects such as the instantiation of class template specializations and function template specializations, the
generation of implicitly-defined functions, and so on. Such side effects are not in the "immediate context"
and can result in the program being ill-formed. &mdash; <i>end note</i>]</del>
</p>
</blockquote>
</li>

<li><p>Change Table 57 ("Other transformations") as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 57 &mdash; Other transformations</caption>
<tr>
<th align="center">Template</th>
<th align="center">Condition</th>
<th align="center">Comments</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>template &lt;class Fn, class... ArgTypes&gt;<br/>
struct result_of&lt;Fn(ArgTypes...)&gt;;</tt>
</td>

<td align="center">
[&hellip;]
</td>

<td>
If the expression<br/>
<tt><i>INVOKE</i>(declval&lt;Fn&gt;(),<br/>
declval&lt;ArgTypes&gt;()...)</tt> is<br/>
<ins>valid in a contrived argument deduction<br/>
context ([defns.valid.contr.context]) for types<br/>
<tt>Fn</tt> and <tt>ArgTypes...</tt></ins>
<del>well<br/>
formed when treated as an<br/>
unevaluated operand (Clause 5)</del>, the<br/>
member typedef type shall name the<br/>
type<br/>
<tt>decltype(<i>INVOKE</i>(declval&lt;Fn&gt;(),<br/>
declval&lt;ArgTypes&gt;()...))</tt>;<br/>
otherwise, there shall be no member<br/>
type. <del>Access checking is performed as<br/>
if in a context unrelated to <tt>Fn</tt> and<br/>
<tt>ArgTypes</tt>. Only the validity of the<br/>
immediate context of the expression is<br/>
considered. [<i>Note</i>: The compilation of<br/>
the expression can result in side<br/>
effects such as the instantiation of<br/>
class template specializations and<br/>
function template specializations, the<br/>
generation of implicitly-defined<br/>
functions, and so on. Such side effects<br/>
are not in the "immediate context"<br/>
and can result in the program being<br/>
ill-formed. &mdash; <i>end note</i>]</del>
</td>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Change 20.15.6 <a href="https://timsong-cpp.github.io/cppwp/meta.rel">[meta.rel]</a> p4 as indicated:</p>

<blockquote><p>
-4- Given the following function prototype:
</p>
<blockquote><pre>
template &lt;class T&gt;
  add_rvalue_reference_t&lt;T&gt; create() noexcept;
</pre></blockquote>
<p>
the predicate condition for a template specialization <tt>is_convertible&lt;From, To&gt;</tt> shall be satisfied if and
only if the return expression in the following code would be <del>well-formed</del><ins>valid in a contrived argument 
deduction context ([defns.valid.contr.context]) for types <tt>To</tt> and <tt>From</tt></ins>, including any implicit conversions
to the return type of the function:
</p>
<blockquote><pre>
To test() {
  return create&lt;From&gt;();
}
</pre></blockquote>
<p>
[<i>Note</i>: This requirement gives well defined results for reference types, <tt>void</tt> types, array types, and
function types. &mdash; <i>end note</i>] <del>Access checking is performed as if in a context unrelated to <tt>To</tt> 
and <tt>From</tt>. Only the validity of the immediate context of the expression of the return-statement (including conversions to
the return type) is considered. [<i>Note</i>: The evaluation of the conversion can result in side effects such as
the instantiation of class template specializations and function template specializations, the generation of
implicitly-defined functions, and so on. Such side effects are not in the "immediate context" and can result
in the program being ill-formed. &mdash; <i>end note</i>]</del>
</p>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="2292" href="2292">2292.</a> Find a better phrasing for "shall not participate in overload resolution"</h3>
<p><b>Section:</b> 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Jeffrey Yasskin <b>Opened:</b> 2013-09-03 <b>Last modified:</b> 2019-03-22 17:52:05 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#structure.specifications">active issues</a> in [structure.specifications].</p>
<p><b>View all other</b> <a href="lwg-index.html#structure.specifications">issues</a> in [structure.specifications].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The C++14 CD has 25 sections including the phrase "X shall not
participate in overload resolution ...". Most of these uses are double
negatives, which are hard to interpret. "shall not ... unless" tends
to be the easiest to read, since the condition is true when the
function is available, but we also have a lot of "if X is not Y, then
Z shall not participate", which actually means "You can call Z if X is
Y." The current wording is also clumsy and long-winded. We should find
a better and more concise phrasing.
<p/>
As an initial proposal, I'd suggest using "X is enabled if and only if Y" in prose
and adding an "<i>Enabled If:</i> ..." element to 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a>.
<p/>
Daniel:
<p/>
I suggest to name this new specification element for 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a>
as "<i>Template Constraints:</i>" instead, because the mentioned wording form was intentionally provided 
starting with LWG <a href="1237">1237</a> to give implementations more freedom to realize the 
concrete constraints. Instead of the original <tt>std::enable_if</tt>-based specifications
we can use better forms of "SFINAE" constraints today and it eases the path to possible language-based
constraints in the future.
</p>

<p><i>[2019-03-21; Daniel comments ]</i></p>

<p>
Apparently the adoption of <a href="http://wg21.link/p0788r3">P0788R3</a> at the Rapperswil 2018 meeting 
has resolved this issue by introduction of the new <i>Constraints:</i> element.
</p>



<p><b>Rationale:</b></p>
Resolved by <a href="http://wg21.link/p0788r3">P0788R3</a>.


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2295" href="2295">2295.</a> Locale name when the provided <tt>Facet</tt> is a <tt>nullptr</tt></h3>
<p><b>Section:</b> 28.3.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.cons">[locale.cons]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Juan Soulie <b>Opened:</b> 2013-09-04 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
28.3.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.cons">[locale.cons]</a> p14 ends with:
</p>
<blockquote><p>
"[&hellip;] If <tt>f</tt> is null, the resulting object is a copy of <tt>other</tt>."
</p></blockquote>
<p>
but the next line p15 says: 
</p>
<blockquote><p>
"<i>Remarks:</i> The resulting locale has no name."
</p></blockquote>
<p>
But both can't be true when <tt>other</tt> has a name and <tt>f</tt> is null.
<p/>
I've tried it on two implementations (MSVC,GCC) and they are inconsistent with each other on this.
</p>
<p>
Daniel Kr&uuml;gler:
<p/>
As currently written, the <i>Remarks</i> element applies unconditionally for all cases and thus should
"win". The question arises whether the introduction of this element by LWG <a href="424">424</a> had actually intended
to change the previous <i>Note</i> to a <i>Remarks</i> element. In either case the wording should be improved
to clarify this special case.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2303" href="2303">2303.</a> Explicit instantiation of <tt>std::vector&lt;UserType&gt;</tt> broken?</h3>
<p><b>Section:</b> 17.6.2.3 <a href="https://timsong-cpp.github.io/cppwp/new.delete.placement">[new.delete.placement]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2013-09-18 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#new.delete.placement">issues</a> in [new.delete.placement].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The library gives explicit permission in 16.5.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/namespace.std">[namespace.std]</a> p2 that user code may explicitly instantiate
a library template provided that the instantiations depend on at least one user-defined type:
</p>

<blockquote><p>
A program may explicitly instantiate a template defined in the standard library only if the declaration
depends on the name of a user-defined type and the instantiation meets the standard library requirements
for the original template.
</p></blockquote>

<p>
But it seems that the C++11 library is not specified in a way that guarantees such an instantiation to be well-formed
if the minimum requirements of the library is not satisfied. 
<p/>
For example, in general, the first template parameter of <tt>std::vector</tt> is not required to be 
<tt>DefaultConstructible</tt> in general, but due to the split of the single C++03 member function
with default argument
</p>
<blockquote><pre>
void resize(size_type sz, T c = T());
</pre></blockquote>
<p>
into
</p>
<blockquote><pre>
void resize(size_type sz);
void resize(size_type sz, const T&amp; c);
</pre></blockquote>
<p>
the effect is now that for a type <tt>ND</tt> that is not <tt>DefaultConstructible</tt>, such as
</p>
<blockquote><pre>
struct NP { 
  NP(int); 
};
</pre></blockquote>
<p>
the explicit instantiation of <tt>std::vector&lt;ND&gt;</tt> is no longer well-formed, because the attempt to
instantiate the single-argument overload of <tt>resize</tt> cannot not succeed, because this function imposes
the <tt>DefaultInsertable</tt> requirements and given the default allocator this effectively requires
<tt>DefaultConstructible</tt>.
</p>
<p>
But <tt>DefaultConstructible</tt> is not the only point, what about <tt>CopyConstructible</tt> versus
<tt>MoveConstructible</tt> alone? It turns out that currently the second <tt>resize</tt> overload
would fail during an explicit instantiation for a type like
</p>
<blockquote><pre>
struct MO { 
  MO() = default; 
  MO(MO&amp;&amp;) = default; 
};
</pre></blockquote>
<p>
because it imposes <tt>CopyInsertable</tt> requirements that end up being equivalent to the <tt>CopyConstructible</tt>
requirements for the default allocator.
<p/>
Technically a library can solve these issues: For special member functions by defining them in some base class, for others
by transforming them effectively into a function template due to the great feature of default template arguments for
function templates (At the very moment the validity of the latter approach depends on a resolution of core language issue
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1635">CWG 1635</a>, though). E.g. the here mentioned 
<tt>resize</tt> functions of <tt>std::vector</tt> could be prevented from instantiation by defining them like this 
with an implementation:
</p>
<blockquote><pre>
template&lt;class = void&gt;
void resize(size_type sz) { [&hellip;] }
template&lt;class = void&gt;
void resize(size_type sz, const T&amp; c) { [&hellip;] }
</pre></blockquote>
<p>
In this case, these functions could also be defined in a base class, but the latter approach won't work in all cases.
<p/>
Basically such an implementation is required to constrain all member functions that are not covered by the general
requirements imposed on the actual library template parameters. I tested three different C++11 library implementations
and but none could instantiate for example <tt>std::list</tt>, <tt>std::vector</tt>, or <tt>std::deque</tt> with
value types that are not <tt>DefaultConstructible</tt> or only <tt>MoveConstructible</tt>. 
<p/>

<p/>
This issue is raised to clarify the current situation in regard to the actual requirements imposed on user-provided
types that are used to explicitly instantiate Library-provided templates. For example, the current Container requirements
impose very little requirements on the actual value type and it is unclear to which extend library implementations have
to respect that. 
<p/>
The minimum solution of this issue should be to at least realize that there is no fundamental requirement on 
<tt>DefaultConstructible</tt> for value types of library containers, because we have since C++03 the general
statement of 16.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/utility.arg.requirements">[utility.arg.requirements]</a> ("In general, a default constructor is not required.").
It is unclear whether <tt>CopyConstructible</tt> should be required for an explicit instantiation request, but
given the careful introduction of move operations in the library it would seem astonishing that a
<tt>MoveConstructible</tt> type wouldn't suffice for value types of the container types.
<p/>
In any case I can envision at least two approaches to solve this issue:
</p>
<ol>
<li>
<p>
As indicated in LWG <a href="2292">2292</a>, those function could get an explicit "<i>Template Constraints:</i>"
element, albeit this promises more than needed to solve this issue.
</p>
</li>
<li>
<p>
The library could introduce a completely new element form, such as "<i>Instantiation Constraints:</i>" that
would handle this situation for explicit instantiation situations. This would allow for simpler techniques
to solve the issue when explicit instantiation is required compared to the first bullet, because it would not 
(necessarily) guarantee SFINAE-friendly expression-wellformedness, such as inspecting the expression 
<tt>std::declval&lt;std::vector&lt;ND&gt;&amp;&gt;.resize(0)</tt> in an unevaluated context.
</p>
</li>
</ol>

<p>
It should be noted that the 2013-08-27 comment to LWG <a href="2193">2193</a> could be resolved by a similar solution
as indicated in this issue here.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2307" href="2307">2307.</a> Should the Standard Library use <tt>explicit</tt> only when necessary?</h3>
<p><b>Section:</b> 22 <a href="https://timsong-cpp.github.io/cppwp/containers">[containers]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Zhihao Yuan <b>Opened:</b> 2013-09-26 <b>Last modified:</b> 2018-11-12 05:21:03 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#containers">active issues</a> in [containers].</p>
<p><b>View all other</b> <a href="lwg-index.html#containers">issues</a> in [containers].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="2193">2193</a> yields <tt>explicit</tt> for default ctors to allow <tt>{}</tt>, but not for
all cases of uniform initialization. For example:
</p>
<blockquote><pre>
explicit vector(size_type count, const Allocator&amp; alloc = Allocator());
</pre></blockquote>
<p>
This prevents <tt>{n, alloc()}</tt>. Although this use is relatively rare,
but the behavior is inconsistent with that of
</p>
<blockquote><pre>
vector(size_type count, const T&amp; value, const Allocator&amp; alloc = Allocator());
</pre></blockquote>

<p><i>[Urbana 2014-11-07: Move to Open]</i></p>


<p><i>[2018-08 Batavia Monday issue discussion]</i></p>

<p>This really needs a paper; splitting a lot of constructors. Nevin to write paper.</p>

<p><i>[2018-11 San Diego Thursday night issue processing]</i></p>

<p>LEWG has rejected Nevin's paper, so they need to formulate a policy.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2321" href="2321">2321.</a> Moving containers should (usually) be required to preserve iterators</h3>
<p><b>Section:</b> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2013-09-21 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#container.requirements.general">active issues</a> in [container.requirements.general].</p>
<p><b>View all other</b> <a href="lwg-index.html#container.requirements.general">issues</a> in [container.requirements.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>/10 says that unless otherwise specified, "no <tt>swap()</tt> function invalidates 
any references, pointers, or iterators referring to the elements of the containers being swapped. [<i>Note:</i> The <tt>end()</tt> 
iterator does not refer to any element, so it may be invalidated. &mdash; <i>end note</i>]". However, move constructors and move 
assignment operators aren't given similar invalidation guarantees. The guarantees need several exceptions, so I do not believe 
that blanket language like /11 "Unless otherwise specified (either explicitly or by defining a function in terms of other functions), 
invoking a container member function or passing a container as an argument to a library function shall not invalidate iterators to, 
or change the values of, objects within that container." is applicable.
</p>

<p><i>[2014-02-13 Issaquah]</i></p>

<p>
General agreeement on intent, several wording nits and additional paragraphs to hit.
</p>
<p>
STL to provide updated wording.  Move to Open.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
AM: in the proposed wording, I'd like to mention that the iterators now refer to elements of a different container. 
I think we're saying something like this somewhere. JY: There's some wording like that for swap I think. TK: It's also in 
<tt>list::splice()</tt>. DK to JY: 23.2.1p9.
<p/>
VV: The issue says that STL was going to propose new wording. Has he done that? AM: I believe we're looking at that. 
GR: The request touches on multiple paragraphs, and this PR has only one new paragraph, so this looks like it's not up-to-date. 
MC: This was last updated a year ago in Issaquah.
<p/>
<b>Conclusion</b>: Skip, not up to date. 
</p>

<p><i>[2015-06, Telecon]</i></p>

<p>Still waiting for updated wording</p>

<p><i>[2015-08 Chicago]</i></p>

<p>Still waiting for updated wording</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3691.</p>

<ol>
<li><p>In 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>/10 change as indicated:</p>

<blockquote><p>
-10- Unless otherwise specified (see 23.2.4.1, 23.2.5.1, 23.3.3.4, and 23.3.7.5) all container types defined in this
Clause meet the following additional requirements:
</p>
<ul>
<li><p>
[&hellip;]
</p></li>
<li><p>
no copy constructor or assignment operator of a returned iterator throws an exception.
</p></li>
<li><p>
<ins>no move constructor (or move assignment operator when 
<tt>allocator_traits&lt;allocator_type&gt;::propagate_on_container_move_assignment::value</tt> is true) of a container 
(except for <tt>array</tt>) invalidates any references, pointers, or iterators referring to the elements of the source container. 
[<i>Note:</i> The <tt>end()</tt> iterator does not refer to any element, so it may be invalidated. &mdash; <i>end note</i>]</ins>
</p></li>
<li><p>
no <tt>swap()</tt> function throws an exception.
</p></li>
<li><p>
no <tt>swap()</tt> function invalidates any references, pointers, or iterators referring to the elements of the
containers being swapped. [<i>Note:</i> The <tt>end()</tt> iterator does not refer to any element, so it may be
invalidated. &mdash; <i>end note</i>]
</p></li>
</ul>
</blockquote>
</li>

</ol>






<hr>
<h3><a name="2331" href="2331">2331.</a> <tt>regex_constants::collate</tt>'s effects are inaccurately summarized</h3>
<p><b>Section:</b> 30.5.1 <a href="https://timsong-cpp.github.io/cppwp/re.synopt">[re.synopt]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2013-09-21 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#re.synopt">issues</a> in [re.synopt].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The table in 30.5.1 <a href="https://timsong-cpp.github.io/cppwp/re.synopt">[re.synopt]</a>/1 says that <tt>regex_constants::collate</tt> "Specifies that character ranges of the form 
"<tt>[a-b]</tt>" shall be locale sensitive.", but 30.13 <a href="https://timsong-cpp.github.io/cppwp/re.grammar">[re.grammar]</a>/14 says that it affects individual character comparisons 
too.
</p>

<p><i>[2012-02-12 Issaquah : recategorize as P3]</i></p>


<p>
Marshall Clow: 28.13/14 only applies to ECMAScript
</p>

<p>
All: we're unsure
</p>

<p>
Jonathan Wakely: we should ask John Maddock
</p>

<p>
Move to P3
</p>

<p><i>[2014-5-14, John Maddock response]</i></p>

<p>
The original intention was the original wording: namely that <tt>collate</tt> only made character ranges locale sensitive.  
To be frank it's a feature that's probably hardly ever used (though I have no real hard data on that), and is a leftover 
from early POSIX standards which <em>required</em> locale sensitive collation for character ranges, and then later changed 
to implementation defined if I remember correctly (basically nobody implemented locale-dependent collation).
<p/>
So I guess the question is do we gain anything by requiring all character-comparisons to go through the locale when this bit 
is set? Certainly it adds a great deal to the implementation effort (it's not what Boost.Regex has ever done). I guess the 
question is are differing code-points that collate identically an important use case? I guess there might be a few Unicode 
code points that do that, but I don't know how to go about verifying that.
<p/>
STL:
<p/>
If this was unintentional, then 30.5.1 <a href="https://timsong-cpp.github.io/cppwp/re.synopt">[re.synopt]</a>/1's table should be left alone, while 30.13 <a href="https://timsong-cpp.github.io/cppwp/re.grammar">[re.grammar]</a>/14 
should be changed instead.
<p/>
Jeffrey Yasskin:
<p/>
<a href="http://www.unicode.org/reports/tr18/tr18-13.html#Tailored_Loose_Matches">This page</a>
mentions that [V] in Swedish should match "W" in a perfect world.
<p/>
However, the most recent version of <a href="http://www.unicode.org/reports/tr18/#Tailored_Loose_Matches">TR18</a> retracts
both language-specific loose matches <em>and</em> language-specific ranges
because "for most full-featured regular expression engines, it is
quite difficult to match under code point equivalences that are not
1:1" and "tailored ranges can be quite difficult to implement
properly, and can have very unexpected results in practice. For
example, languages may also vary whether they consider lowercase below
uppercase or the reverse. This can have some surprising results: [a-Z]
may not match anything if <tt>Z &lt; a</tt> in that locale."
<p/>
<a href="http://www.ecma-international.org/ecma-262/5.1/#sec-15.10.2.15">ECMAScript</a> doesn't include collation at all.
<p/>
IMO, +1 to changing 28.13 instead of 28.5.1. It seems like we'd be on
fairly solid ground if we wanted to remove <tt>regex_constants::collate</tt>
entirely, in favor of named character classes, but of course that's
not for this issue.
</p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3691.</p>

<ol>
<li><p>In 30.5.1 <a href="https://timsong-cpp.github.io/cppwp/re.synopt">[re.synopt]</a>/1, Table 138 &mdash; "<tt>syntax_option_type</tt> effects", change as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 138 &mdash; <tt>syntax_option_type</tt> effects</caption>
<tr>
<th align="center">Element</th>
<th align="center">Effect(s) if set</th>
</tr>

<tr>
<td colspan="2" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>collate</tt>
</td>
<td>
Specifies that character <del>ranges of the form "<tt>[a-b]</tt>"</del><ins>comparisons and character range comparisons</ins> 
shall be locale sensitive.
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2335" href="2335">2335.</a> <tt>array&lt;array&lt;int, 3&gt;, 4&gt;</tt> should be layout-compatible with <tt>int[4][3]</tt></h3>
<p><b>Section:</b> 22.3.7 <a href="https://timsong-cpp.github.io/cppwp/array">[array]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jeffrey Yasskin <b>Opened:</b> 2013-10-04 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#array">issues</a> in [array].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In order to replace some uses of C arrays with <tt>std::array</tt>, we need it
to be possible to cast from a <tt>std::array&lt;&gt;</tt> to an equivalent C array.
Core wording doesn't appear to be in quite the right state to allow
casting, but if we specify that appropriate types are
layout-compatible, we can at least write:
</p>
<blockquote><pre>
union {
  array&lt;array&lt;array&lt;int, 2&gt;, 3&gt;, 4&gt; arr;
  int carr[4][3][2];
};
</pre></blockquote>
<p>
to view memory as the other type: C++14 CD [class.mem]p18.
</p>
I believe it's sufficient to add "<tt>array&lt;T, N&gt;</tt> shall be
layout-compatible (6.8 <a href="https://timsong-cpp.github.io/cppwp/basic.types">[basic.types]</a>) with <tt>T[N]</tt>." to 
22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a>, but we might also need some extension to 
11.4 <a href="https://timsong-cpp.github.io/cppwp/class.mem">[class.mem]</a> to address the possibility of layout-compatibility 
between struct and array types.
<p>
I checked that libc++ on MacOS already implements this, although it
would be good for someone else to double-check; I haven't checked any
other standard libraries.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2338" href="2338">2338.</a> &sect;[re.traits]/7 expects of locale facets something not guaranteed by [locale.facet]/4</h3>
<p><b>Section:</b> 30.7 <a href="https://timsong-cpp.github.io/cppwp/re.traits">[re.traits]</a>, 28.3.1.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.facet">[locale.facet]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Sergey Zubkov <b>Opened:</b> 2013-10-15 <b>Last modified:</b> 2016-02-01 11:19:56 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#re.traits">issues</a> in [re.traits].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
30.7 <a href="https://timsong-cpp.github.io/cppwp/re.traits">[re.traits]</a>/7, begins with "if <tt>typeid(use_facet&lt;collate&lt;charT&gt; &gt;) == typeid(collate_byname&lt;charT&gt;)</tt>", 
which appears to be pseudocode with the intention to convey that the collate facet has not been replaced by the user. Cf. the wording in 
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2003/n1429.htm">N1429</a> "there is no portable way to implement 
<tt>transform_primary</tt> in terms of <tt>std::locale</tt>, since even if the sort key format returned by 
<tt>std::collate_byname&lt;&gt;::transform</tt> is known and can be converted into a primary sort key, the user can still 
install their own custom <tt>std::collate</tt> implementation into the locale object used, and that can use any sort key 
format they see fit.".
<p/>
Taken literally, 30.7 <a href="https://timsong-cpp.github.io/cppwp/re.traits">[re.traits]</a>/7 appears to imply that named locales are required to hold their collate facets with 
dynamic type <tt>std::collate_byname&lt;charT&gt;</tt>, which is in fact true in some implementations (e.g libc++), but not others 
(e.g. libstdc++). This does not follow from the description of <tt>_byname</tt> in 28.3.1.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.facet">[locale.facet]</a>/4, which is only 
required to provide equivalent semantics, to the named locale's facet, not to actually be one.
</p>


<p><i>[2015-05-06 Lenexa: Move to Open]</i></p>


<p>MC, RP: Consequence of failing to follow the rule is UB.</p>
<p>MC: Tightening of requirements.</p>
<p>RP: It should be this way, we just didn't impose it before.</p>
<p>MC: Second change is a bug fix, original code didn't work.</p>
<p>TK: Doesn't seem to make things worse.</p>
<p>Bring up in larger group tomorrow.</p>
<p>JW arrives.</p>
<p>JW: libstdc++ violates this due to two std::string ABIs.</p>
<p>JW: This prevents installing a type derived from Facet_byname, constrains the implementor from using a smarter derived class version.</p>
<p>JW: Can't look at facet id to detect replacement, because replacements have the same id.</p>
<p>RP: Can you give it multiple ids through multiple inheritance?</p>
<p>JW: No, the facet mechanism wouldn't like that.</p>
<p>JW: We should also ask Martin Sebor, he's implemented this stuff recently.</p>
<p>MC: Sounds like this resolution doesn't work, need a better solution.</p>
<p>JW: Write in words "if the facet has not been replaced by the user", the implementation knows how to detect that, but not like this.</p>
<p>RP: User RE traits need to detect this too.</p>
<p>JW: =(</p>
<p>Move to Open, JW will invite Martin Sebor to join LWG for discussion.</p>
<p>Later ... </p>
<p>JW: This is not needed for user specializations after all.</p>
<p>MC: Agree, [re.traits]/7 only applies to the stdlib traits.</p>
<p>NM: Effects: doesn't make sense.</p>
<p>JW, NM, Martin Sebor to come up with new wording.</p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3691.</p>

<ol>
<li><p>Modify 28.3.1.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.facet">[locale.facet]</a>/4 as indicated:</p>

<blockquote><p>
For some standard facets a standard "...<tt>_byname</tt>" class, derived from it, implements the virtual function
semantics <del>equivalent to</del><ins>provided by</ins> that facet of the locale constructed by <tt>locale(const char*)</tt> 
with the same name.
Each such facet provides a constructor that takes a <tt>const char*</tt> argument, which names the locale, and a
<tt>refs</tt> argument, which is passed to the base class constructor. Each such facet also provides a constructor
that takes a string argument <tt>str</tt> and a <tt>refs</tt> argument, which has the same effect as calling the first
constructor with the two arguments <tt>str.c_str()</tt> and <tt>refs</tt>. If there is no "...<tt>_byname</tt>" 
version of a facet, the base class implements named locale semantics itself by reference to other facets. <ins>For any 
locale <tt>loc</tt> constructed by <tt>locale(const char*)</tt> and facet <tt>Facet</tt> that has a corresponding standard 
<tt>Facet_byname</tt> class, <tt>typeid(use_facet&lt;Facet&gt;(loc)) == typeid(Facet_byname)</tt>.</ins>
</p></blockquote>
</li>

<li><p>Modify 30.7 <a href="https://timsong-cpp.github.io/cppwp/re.traits">[re.traits]</a>/7 as indicated:</p>

<blockquote><pre>
template &lt;class ForwardIterator&gt;
  string_type transform_primary(ForwardIterator first, ForwardIterator last) const;
</pre><blockquote>
<p>
-7- <i>Effects:</i> if <tt>typeid(use_facet&lt;collate&lt;charT&gt; &gt;<ins>(getloc())</ins>) == typeid(collate_byname&lt;charT&gt;)</tt> 
and the form of the sort key returned by <tt>collate_byname&lt;charT&gt;::transform(first, last)</tt> is known and
can be converted into a primary sort key then returns that key, otherwise returns an empty string.
</p>
</blockquote></blockquote>
</li>

</ol>





<hr>
<h3><a name="2342" href="2342">2342.</a> User conversion to <tt>wchar_t const*</tt> or to <tt>wchar_t</tt> not invoked for <tt>operator&lt;&lt;</tt></h3>
<p><b>Section:</b> 29.7.5.1 <a href="https://timsong-cpp.github.io/cppwp/ostream">[ostream]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Alf P. Steinbach <b>Opened:</b> 2013-10-29 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#ostream">issues</a> in [ostream].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
For wide streams argument types <tt>wchar_t const*</tt> and <tt>wchar_t</tt> are supported only as template parameters. 
User defined conversions are not considered for template parameter matching. Hence inappropriate overloads of 
<tt>operator&lt;&lt;</tt> are selected when an implicit conversion is required for the argument, which is inconsistent 
with the behavior for <tt>char const*</tt> and <tt>char</tt>, is unexpected, and is a useless result.
<p/>
Demonstration:
</p>
<blockquote><pre>
#include &lt;iostream&gt;

struct Byte_string
{ 
  operator char const*() const { return "Hurray, it works!"; } 
};

struct Wide_string
{ 
  operator wchar_t const*() const { return L"Hurray, it works!"; } 
};

struct Byte_ch
{ 
  operator char() const { return 'X'; } 
};

struct Wide_ch
{ 
  operator wchar_t() const { return L'X'; } 
};

auto main() -> int
{
  using namespace std;
  wcout &lt;&lt; "'X' as char value   : " &lt;&lt; Byte_ch() &lt;&lt; endl;
  wcout &lt;&lt; "'X' as wchar_t value: " &lt;&lt; Wide_ch() &lt;&lt; endl;
  wcout &lt;&lt; "Byte string pointer : " &lt;&lt; Byte_string() &lt;&lt; endl;
  wcout &lt;&lt; "Wide string pointer : " &lt;&lt; Wide_string() &lt;&lt; endl;
}
</pre></blockquote>
<p>
Example output:
</p>
<blockquote><pre>
'X' as char value   : X
'X' as wchar_t value: 88
Byte string pointer : Hurray, it works!
Wide string pointer : 000803C8
</pre></blockquote>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3797.</p>

<ol>
<li><p>Modify 29.7.5.1 <a href="https://timsong-cpp.github.io/cppwp/ostream">[ostream]</a>, class template <tt>basic_ostream</tt> synopsis, as indicated:</p>

<blockquote><pre>
namespace std {
[&hellip;]

<i>// 27.7.3.6.4 character inserters</i>
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp;,
                                          charT);
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp;,
                                          char);
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp;,
                                         char);
<ins>template&lt;class traits&gt;
  basic_ostream&lt;wchar_t,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;wchar_t,traits&gt;&amp;,
                                            wchar_t);</ins>
[&hellip;]

template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp;,
                                          const charT*);
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp;,
                                          const char*);
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp;,
                                         const char*);
<ins>template&lt;class traits&gt;
  basic_ostream&lt;wchar_t,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;wchar_t,traits&gt;&amp;,
                                            const wchar_t*);</ins>
[&hellip;]
}

</pre></blockquote>
</li>

<li><p>Modify 29.7.5.2.4 <a href="https://timsong-cpp.github.io/cppwp/ostream.inserters.character">[ostream.inserters.character]</a> as indicated: <em>[Drafting note: 
The replacement of <tt>os</tt> by <tt>out</tt> in p1 and the insertion of "<tt>out.</tt>" in p4 
just fix two obvious typos &mdash; end drafting note]</em></p>

<blockquote><pre>
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp; out,
                                          charT c);
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp; out,
                                          char c);
<i>// specialization</i>
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp; out,
                                         char c);
<ins>template&lt;class traits&gt;
  basic_ostream&lt;wchar_t,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;wchar_t,traits&gt;&amp; out,
                                            wchar_t c);</ins>

<i>// signed and unsigned</i>
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp; out,
                                          signed char c);
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp; out,
                                          unsigned char c);
</pre><blockquote>
<p>
-1- <i>Effects:</i> Behaves as a formatted output function (29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a>) of <tt>out</tt>. 
Constructs a character sequence <tt>seq</tt>. If <tt>c</tt> has type <tt>char</tt> and the character type of the stream 
is not <tt>char</tt>, then <tt>seq</tt> consists of <tt>out.widen(c)</tt>; otherwise <tt>seq</tt> consists of <tt>c</tt>. 
Determines padding for <tt>seq</tt> as described in 29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a>. Inserts <tt>seq</tt> into 
<tt>out</tt>. Calls <tt><del>os</del><ins>out</ins>.width(0)</tt>.
<p/>
-2- <i>Returns:</i> <tt>out</tt>.
</p>
</blockquote>
<pre>
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp; out,
                                          const charT* s);
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;charT,traits&gt;&amp; out,
                                          const char* s);
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp; out,
                                         const char* s);
<ins>template&lt;class traits&gt;
  basic_ostream&lt;wchar_t,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;wchar_t,traits&gt;&amp; out,
                                            const wchar_t* s);</ins>
											
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp; out,
                                         const signed char* s);
template&lt;class traits&gt;
  basic_ostream&lt;char,traits&gt;&amp; operator&lt;&lt;(basic_ostream&lt;char,traits&gt;&amp; out,
                                         const unsigned char* s);
</pre><blockquote>
<p>
-3- <i>Requires:</i> <tt>s</tt> shall not be a null pointer.
<p/>
-4- <i>Effects:</i> Behaves like a formatted inserter (as described in 29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a>) of <tt>out</tt>. 
Creates a character sequence <tt>seq</tt> of <tt>n</tt> characters starting at <tt>s</tt>, each widened using <tt>out.widen()</tt> 
(27.5.5.3), where <tt>n</tt> is the number that would be computed as if by:
</p>
<ul>
<li><p>
<tt>traits::length(s)</tt> for the <ins>following</ins> overload<ins>s:</ins>
<ul>
<li><p>
where the first argument is of type <tt>basic_ostream&lt;charT, traits&gt;&amp;</tt> 
and the second is of type <tt>const charT*</tt>,
</p></li>
<li><p>
<del>and also for the overload</del> where the first argument is of type 
<tt>basic_ostream&lt;char, traits&gt;&amp;</tt> and the second is of type <tt>const char*</tt>,
</p></li>
<li><p>
<ins>where the first argument is of type 
<tt>basic_ostream&lt;wchar_t, traits&gt;&amp;</tt> and the second is of type <tt>const wchar_t*</tt>,</ins>
</p></li>
</ul> 
</p></li>
<li><p>
<tt>std::char_traits&lt;char&gt;::length(s)</tt> for the overload where the first argument is of type
<tt>basic_ostream&lt;charT, traits&gt;&amp;</tt> and the second is of type <tt>const char*</tt>,
</p></li>
<li><p>
<tt>traits::length(reinterpret_cast&lt;const char*&gt;(s))</tt> for the other two overloads.
</p></li>
</ul>
<p>
Determines padding for <tt>seq</tt> as described in 29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a>. Inserts <tt>seq</tt> into 
<tt>out</tt>. Calls <tt><ins>out.</ins>width(0)</tt>.
<p/>
-5- <i>Returns:</i> <tt>out</tt>.
</p>
</blockquote></blockquote>
</li>

</ol>





<hr>
<h3><a name="2348" href="2348">2348.</a> <tt>charT('1')</tt> is not the wide equivalent of <tt>'1'</tt></h3>
<p><b>Section:</b> 20.9.2 <a href="https://timsong-cpp.github.io/cppwp/template.bitset">[template.bitset]</a>, 29.7.8 <a href="https://timsong-cpp.github.io/cppwp/quoted.manip">[quoted.manip]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Zhihao Yuan <b>Opened:</b> 2013-12-02 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#template.bitset">issues</a> in [template.bitset].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Example: <tt>char16_t('1') != u'1'</tt> is possible.
<p/>
The numeric value of <tt>char16_t</tt> is defined to be Unicode
code point, which is same to the ASCII value and UTF-8 for
7-bit chars.  However, <tt>char</tt> is not guaranteed to have an
encoding which is compatible with ASCII. For example, <tt>'1'</tt> in EBCDIC is 241.
<p/>
I found three places in the standard casting narrow char
literals: <tt>bitset::bitset</tt>, <tt>bitset::to_string</tt> and <tt>quoted</tt>.
<p/>
PJ confirmed this issue and says he has a solution used
in their <tt>&lt;filesystem&gt;</tt> implementation, and he may want to
propose it to the standard.
<p/>
The solution in my mind, for now, is to make those default
arguments magical, where the "magic" can be implemented
with a C11 <tt>_Generic</tt> selection (works in clang):
</p>
<blockquote><pre>
#define _G(T, literal) _Generic(T{}, \
      char: literal, \
      wchar_t: L ## literal, \
      char16_t: u ## literal, \
      char32_t: U ## literal)

  _G(char16_t, '1') == u'1'
</pre></blockquote>

<p><i>[Lenexa 2015-05-05: Move to Open]</i></p>

<p>Ask for complete PR (need quoted, to string, et al.)</p>
<p>Will then take it up again</p>
<p>Expectation is that this is correct way to fix this</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3797.</p>

[<i>Drafting note:</i> This is a sample wording fixing only one case;
 I'm just too lazy to copy-paste it before we discussed whether
 the solution is worth and sufficient (for example, should the
 other `charT`s like `unsigned char` just don't compile without
 supplying those arguments?  I hope so). &mdash; <i>end drafting note</i>]

<ol>
<li><p>Modify 20.9.2 <a href="https://timsong-cpp.github.io/cppwp/template.bitset">[template.bitset]</a> p1, class template <tt>bitset</tt> synopsis, as indicated:</p>

<blockquote><pre>
namespace std {
  template &lt;size_t N&gt; class bitset {
  public:
    [&hellip;]
    template&lt;class charT, class traits, class Allocator&gt;
      explicit bitset(
        const basic_string&lt;charT,traits,Allocator&gt;&amp; str,
        typename basic_string&lt;charT,traits,Allocator&gt;::size_type pos = 0,
        typename basic_string&lt;charT,traits,Allocator&gt;::size_type n =
          basic_string&lt;charT,traits,Allocator&gt;::npos,
          charT zero = <del>charT('0')</del><ins><em>see below</em></ins>, charT one = <del>charT('1')</del><ins><em>see below</em></ins>);
     [&hellip;]
  };
  [&hellip;]
}
</pre></blockquote>
</li>

<li><p>Modify 20.9.2.1 <a href="https://timsong-cpp.github.io/cppwp/bitset.cons">[bitset.cons]</a> as indicated:</p>

<blockquote><pre>
template&lt;class charT, class traits, class Allocator&gt;
explicit 
bitset(const basic_string&lt;charT, traits, Allocator&gt;&amp; str,
       typename basic_string&lt;charT, traits, Allocator&gt;::size_type pos = 0,
       typename basic_string&lt;charT, traits, Allocator&gt;::size_type n =
         basic_string&lt;charT, traits, Allocator&gt;::npos,
         charT zero = <del>charT('0')</del><ins><em>see below</em></ins>, charT one = <del>charT('1')</del><ins><em>see below</em></ins>);
</pre><blockquote>
<p>
<ins>-?- The default values of <tt>zero</tt> and <tt>one</tt> compare equal to the
character literals <tt>0</tt> and <tt>1</tt> of type <tt>charT</tt>, respectively.</ins>
<p/>
-3- <i>Requires::</i> <tt>pos &lt;= str.size()</tt>.
<p/>
[&hellip;]
</p>
</blockquote></blockquote>
</li>

</ol>






<hr>
<h3><a name="2349" href="2349">2349.</a> Clarify input/output function rethrow behavior</h3>
<p><b>Section:</b> 29.7.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/istream.formatted.reqmts">[istream.formatted.reqmts]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Zhihao Yuan <b>Opened:</b> 2013-12-06 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#istream.formatted.reqmts">issues</a> in [istream.formatted.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The formatted input function requirement says in 29.7.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/istream.formatted.reqmts">[istream.formatted.reqmts]</a>:
</p>
<blockquote><p>
"If an exception is thrown during input then <tt>ios::badbit</tt> is turned on
in <tt>*this</tt>'s error state.  If <tt>(exceptions()&amp;badbit) != 0</tt> then the exception
is rethrown."
</p></blockquote>
<p>
while some formatted function may throw an exception from <tt>basic_ios::clear</tt>, for example
in 20.9.4 <a href="https://timsong-cpp.github.io/cppwp/bitset.operators">[bitset.operators]</a> p6:
</p>
<blockquote><p>
"If no characters are stored in <tt>str</tt>, calls <tt>is.setstate(ios_base::failbit)</tt> (which may 
throw <tt>ios_base::failure</tt>)"
</p></blockquote>
<p>
So should this exception be considered as "an exception [...] thrown
during input"?  And here is an implementation divergence (or you
can read the following as "a bug libc++ only has" :)
</p>
<blockquote><pre>
cin.exceptions(ios_base::failbit);
bitset&lt;N&gt; b;
try {
  cin &gt;&gt; b;  // type 'a' and return
} catch (...)
{}
</pre></blockquote>
<p>
Now <tt>cin.rdstate()</tt> is just <tt>failbit</tt> in libstdc++ (and Dinkumware, by
PJ), but <tt>failbit &amp; badbit</tt> libc++. Similar difference found in other
places, like <tt>eofbit &amp; badbid</tt> after <tt>std::getline</tt>.
<p/>
PJ and Matt both agree that the intention (of <tt>badbit</tt> + rethrow) is
"to signify an exception arising in user code, not the iostreams package".
<p/>
In addition, I found the following words in unformatted input
function's requirements (29.7.4.3 <a href="https://timsong-cpp.github.io/cppwp/istream.unformatted">[istream.unformatted]</a>):
</p>
<blockquote><p>
If an exception is thrown during input then <tt>ios::badbit</tt> is turned on
in <tt>*this</tt>'s error state. (Exceptions thrown from <tt>basic_ios&lt;&gt;::clear()</tt>
are not caught or rethrown.)  If <tt>(exceptions()&amp;badbit) != 0</tt> then the
exception is rethrown.
</p></blockquote>
<p>
The content within the parenthesis is added by LWG defect <a href="61">61</a>,
and does fix the ambiguity. However, it only fixed the 1 of 4
requirements, and it lost some context (the word "rethrown" is not
seen before this sentence within this section).
</p>

<p><i>[Lenexa 2015-05-07: Marshall to research and report]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3797.</p>

[<i>Drafting note:</i> The editor is kindly asked to introduce additional spaces at the following marked occurrences of
<tt>operator&amp;</tt> &mdash; <i>end drafting note</i>]

<ol>
<li><p>Modify 29.7.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/istream.formatted.reqmts">[istream.formatted.reqmts]</a> p1 as indicated:</p>

<blockquote><p>
-1- Each formatted input function begins execution by constructing an object of class <tt>sentry</tt> with the <tt>noskipws</tt>
(second) argument false. If the <tt>sentry</tt> object returns true, when converted to a value of type <tt>bool</tt>, the
function endeavors to obtain the requested input. If an exception<ins>, other than the ones thrown from <tt>clear()</tt>, if any,</ins> 
is thrown during input then <tt>ios::badbit</tt>
is turned on[Footnote 314] in <tt>*this</tt>'s error state. If <tt>(exceptions()<ins> </ins>&amp;<ins> </ins>badbit) != 0</tt> 
then the exception is rethrown.
In any case, the formatted input function destroys the <tt>sentry</tt> object. If no exception has been thrown, it returns <tt>*this</tt>.
</p></blockquote>
</li>

<li><p>Modify 29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a> p1 as indicated:</p>

<blockquote><p>
-1- Each formatted output function begins execution by constructing an object of class <tt>sentry</tt>. If this object
returns true when converted to a value of type <tt>bool</tt>, the function endeavors to generate the requested
output. If the generation fails, then the formatted output function does <tt>setstate(ios_base::failbit)</tt>,
which might throw an exception. If an exception<ins>, other than the ones thrown from <tt>clear()</tt>, if any,</ins> is thrown 
during output, then <tt>ios::badbit</tt> is turned on[Footnote 327]
in <tt>*this</tt>'s error state. If <tt>(exceptions()<ins> </ins>&amp;<ins> </ins>badbit) != 0</tt> then the exception is rethrown. 
Whether or not
an exception is thrown, the <tt>sentry</tt> object is destroyed before leaving the formatted output function. If no
exception is thrown, the result of the formatted output function is <tt>*this</tt>.
</p></blockquote>
</li>

<li><p>Modify 29.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/ostream.unformatted">[ostream.unformatted]</a> p1 as indicated:</p>

<blockquote><p>
-1- Each unformatted output function begins execution by constructing an object of class <tt>sentry</tt>. If this object
returns true, while converting to a value of type <tt>bool</tt>, the function endeavors to generate the requested
output. If an exception<ins>, other than the ones thrown from <tt>clear()</tt>, if any,</ins> is thrown during output, 
then ios::badbit is turned on[Footnote 330] in <tt>*this</tt>'s error state.
If <tt>(exceptions() &amp; badbit) != 0</tt> then the exception is rethrown. In any case, the unformatted output
function ends by destroying the <tt>sentry</tt> object, then, if no exception was thrown, returning the value specified
for the unformatted output function.
</p></blockquote>
</li>

<li><p>Modify 29.7.4.3 <a href="https://timsong-cpp.github.io/cppwp/istream.unformatted">[istream.unformatted]</a> p1 as indicated:</p>

<blockquote><p>
-1- Each unformatted input function begins execution by constructing an object of class <tt>sentry</tt> with the default
argument <tt>noskipws</tt> (second) argument true. If the <tt>sentry</tt> object returns true, when converted to a value
of type <tt>bool</tt>, the function endeavors to obtain the requested input. Otherwise, if the <tt>sentry</tt> constructor exits
by throwing an exception or if the sentry object returns false, when converted to a value of type <tt>bool</tt>, the
function returns without attempting to obtain any input. In either case the number of extracted characters
is set to <tt>0</tt>; unformatted input functions taking a character array of non-zero size as an argument shall also
store a null character (using <tt>charT()</tt>) in the first location of the array. If an exception<ins>, other than the 
ones thrown from <tt>clear()</tt>, if any,</ins> is thrown during input
then <tt>ios::badbit</tt> is turned on[Footnote 317] in <tt>*this</tt>'s error state. <del>(Exceptions thrown from 
<tt>basic_ios&lt;&gt;::clear()</tt> are not caught or rethrown.)</del> If <tt>(exceptions()<ins> </ins>&amp;<ins> </ins>badbit) != 0</tt> 
then the exception is rethrown. It also counts the number of characters extracted. If no exception has been thrown it ends 
by storing the count in a member object and returning the value specified. In any event the <tt>sentry</tt> object is destroyed 
before leaving the unformatted input function.
</p></blockquote>
</li>

</ol>






<hr>
<h3><a name="2352" href="2352">2352.</a> Is a default-constructed <tt>std::seed_seq</tt> intended to produce a predictable <tt>.generate()</tt>?</h3>
<p><b>Section:</b> 26.6.7.1 <a href="https://timsong-cpp.github.io/cppwp/rand.util.seedseq">[rand.util.seedseq]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Thomas Plum <b>Opened:</b> 2013-12-02 <b>Last modified:</b> 2018-01-22 19:10:31 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#rand.util.seedseq">issues</a> in [rand.util.seedseq].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
With respect to class <tt>seed_seq</tt> 26.6.7.1 <a href="https://timsong-cpp.github.io/cppwp/rand.util.seedseq">[rand.util.seedseq]</a>, is a default-constructed 
<tt>std::seed_seq</tt> intended to produce a predictable <tt>.generate()</tt> sequence?
<p/>
Implementations differ.
</p>

<p><i>[2014-02-10]</i></p>

<p>Priority set to 2</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2358" href="2358">2358.</a> Apparently-bogus definition of <tt>is_empty</tt> type trait</h3>
<p><b>Section:</b> 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2014-02-01 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.unary.prop">active issues</a> in [meta.unary.prop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.unary.prop">issues</a> in [meta.unary.prop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The 'Condition' for <tt>std::is_empty</tt> is listed as:
</p>
<blockquote><p>
"<tt>T</tt> is a class type, but not a union type, with no non-static data members other than bit-fields of length 0, 
no virtual member functions, no virtual base classes, and no base class <tt>B</tt> for which <tt>is_empty&lt;B&gt;::value</tt> 
is false."
</p></blockquote>
<p>
This is incorrect: there is no such thing as a non-static data member that is a bit-field of length 0, since bit-fields of 
length 0 must be unnamed, and unnamed bit-fields are not members (see 11.4.9 <a href="https://timsong-cpp.github.io/cppwp/class.bit">[class.bit]</a> p2).
<p/>
It also means that classes such as:
</p>
<blockquote><pre>
struct S {
 int : 3;
};
</pre></blockquote>
<p>
are empty (because they have no non-static data members). There's implementation divergence on the value of 
<tt>is_empty&lt;S&gt;::value</tt>.
<p/>
I'm not sure what the purpose of <tt>is_empty</tt> is (or how it could be useful), but if it's desirable for the above type to 
not be treated as empty, something like this could work:
</p>
<blockquote><p>
"<tt>T</tt> is a class type, but not a union type, with no non-static data members <del>other than</del><ins>, no unnamed</ins> 
bit-fields of <ins>non-zero</ins> length <del>0</del>, no virtual member functions, no virtual base classes, and no base class 
<tt>B</tt> for which <tt>is_empty&lt;B&gt;::value</tt> is false."
</p></blockquote>
<p>
and if the above type <em>should</em> be treated as empty, then this might be appropriate:
</p>
<blockquote><p>
"<tt>T</tt> is a class type, but not a union type, with no <ins>(named)</ins> non-static data members <del>other than bit-fields of 
length 0</del>, no virtual member functions, no virtual base classes, and no base class <tt>B</tt> for which 
<tt>is_empty&lt;B&gt;::value</tt> is false."
</p></blockquote>

<p><i>[2016-08 Chicago]</i></p>

<p>Walter says: We want <tt>is_empty_v&lt;S&gt;</tt> to produce false as a result.  Therefore, we recommend adoption of the first of the issue's suggestions.</p>
<p>Tuesday AM: Moved to Tentatively Ready</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<p><i>[2016-10 by Marshall - this PR incorrectly highlighted changed portions]</i></p>


<blockquote class="note">
<p>Modify Table 38  Type property predicates for <tt>is_empty</tt> as follows:</p>
<blockquote><p>
<tt>T</tt> is a non-union class type with no non-static data members <del>other than</del><ins>, no unnamed</ins> bit-fields of <ins>non-zero</ins> length <del>0</del>, no virtual member functions, no virtual base classes, and no base class <tt>B</tt> for which <tt>is_empty_v&lt;B&gt;</tt> is false.</p>
</blockquote>
</blockquote>

<p><i>[2016-10 Telecon]</i></p>

<p>Should probably point at section 1.8 for some of this. Status back to 'Open'</p>


<p><b>Proposed resolution:</b></p>
<p>Modify Table 38  Type property predicates for <tt>is_empty</tt> as follows:</p>
<blockquote><p>
<tt>T</tt> <del>is a class type, but not a union type,</del><ins>is a non-union class type</ins> with no non-static data members<del> other than</del><ins>, no unnamed</ins> bit-fields of <ins>non-zero</ins> length <del>0</del>, no virtual member functions, no virtual base classes, and no base class <tt>B</tt> for which <tt>is_empty_v&lt;B&gt;</tt> is false.</p>
</blockquote>





<hr>
<h3><a name="2362" href="2362">2362.</a> unique, associative <tt>emplace()</tt> should not move/copy the <tt>mapped_type</tt> constructor 
arguments when no insertion happens</h3>
<p><b>Section:</b> 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a>, 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jeffrey Yasskin <b>Opened:</b> 2014-02-15 <b>Last modified:</b> 2015-09-23 18:37:53 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#associative.reqmts">active issues</a> in [associative.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#associative.reqmts">issues</a> in [associative.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>a_uniq.emplace(args)</tt> is specified as:
</p>

<blockquote><p>
<i>Effects</i>: Inserts a value_type object <tt>t</tt> constructed with<br/>
<tt>std::forward&lt;Args&gt;(args)...</tt> if and only if there is no element in the<br/>
container with key equivalent to the key of <tt>t</tt>. The <tt>bool</tt> component of<br/>
the returned pair is true if and only if the insertion takes place,<br/>
and the iterator component of the pair points to the element with key<br/>
equivalent to the key of <tt>t</tt>. 
</p></blockquote>

<p>
However, we occasionally find code of the form:
</p>

<blockquote><pre>
std::unique_ptr&lt;Foo&gt; p(new Foo);
auto res = m.emplace("foo", std::move(p));
</pre></blockquote>

<p>
where we'd like to avoid destroying the <tt>Foo</tt> if the insertion doesn't
take place (if the container already had an element with the specified key).
<p/>
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3873">N3873</a> includes
a partial solution to this in the form of a new <tt>emplace_stable</tt> member function, but LEWG's 
discussion strongly agreed that we'd rather have <tt>emplace()</tt> Just Work:
<p/>
Should <tt>map::emplace()</tt> be guaranteed not to move/copy its arguments if the insertion doesn't happen?
<p/>
SF: 8 F: 3 N: 0 A: 0 SA: 0
<p/>
This poll was marred by the fact that we didn't notice or call out
that <tt>emplace()</tt> must construct the key before doing the lookup, and it
must not then move the key after it determines whether an insert is
going to happen, and the <tt>mapped_type</tt> instance must live next to the key.
<p/>
The very similar issue <a href="2006">2006</a> was previously marked NAD, with
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3178.htm">N3178</a> as
discussion. However, given LEWG's interest in the alternate behavior,
we should reopen the question in this issue.
<p/>
We will need a paper that describes how to implement this before we can make more progress.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2363" href="2363">2363.</a> Defect in 30.4.1.4.1 [thread.sharedtimedmutex.class]</h3>
<p><b>Section:</b> 32.5.3.5.1 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.class">[thread.sharedtimedmutex.class]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2014-02-16 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
32.5.3.5.1 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.class">[thread.sharedtimedmutex.class]</a> paragraph 2: 
</p>
<blockquote><p> The class <tt>shared_timed_mutex</tt> shall satisfy all of the 
<tt>SharedTimedMutex</tt> requirements (30.4.1.4). It shall be a standard layout class (Clause 9).
</p></blockquote> 
<p>
There's no <tt>SharedTimedMutex</tt> requirements; this name doesn't appear anywhere else in the standard. (Prior to N3891, 
this was <tt>SharedMutex</tt>, which was equally undefined.)
<p/>
I assume this concept should be defined somewhere?
<p/>
Also, n3891 changes 32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a> from defining "shared mutex type" to defining 
"shared timed mutex type", but its paragraph 2 still talks about "shared mutex type". Is that OK? I think you could argue 
that it's clear enough what it means, but presumably it should use the term that paragraph 1 defined.
<p/>
32.5.4.4 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.shared">[thread.lock.shared]</a> paragraph 1 talks about the "shared mutex requirements", which again is a term that isn't 
defined, and presumably means "the requirements on a shared timed mutex type" or similar (maybe if <tt>SharedMutex</tt> or 
<tt>SharedTimedMutex</tt> were defined it could be reused here).
</p>

<p><i>[2014-05-22, Daniel comments]</i></p>

<p>
As for <tt>SharedTimedMutex</tt>, there exists a similar problem in regard to <tt>TimedMutex</tt> referred to in
32.5.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.class">[thread.timedmutex.class]</a> p2 and in 32.5.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.recursive">[thread.timedmutex.recursive]</a> p2, but nowhere defined.
<p/>
Another problem is, that according to 32.5.3.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.class">[thread.mutex.class]</a> p3, "The class <tt>mutex</tt> shall satisfy all the 
<tt>Mutex</tt> requirements (32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a>).", but there are no concrete <tt>Mutex</tt> requirements,
32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> &mdash; titled as "Mutex requirements" &mdash; describes <em>mutex types</em>,
<em>timed mutex types</em>, and <em>shared timed mutex types</em>.
</p>

<p><i>[2014-06-08, Daniel comments and provides wording]</i></p>

<p>
The presented wording adds to the existing <em>mutex types</em>, <em>timed mutex types</em>, and <em>shared timed mutex types</em> 
terms a new set of corresponding <tt>MutexType</tt>, <tt>TimedMutexType</tt>, and <tt>SharedTimedMutexType</tt> requirements. 
<p/>
The reason for the change of requirement names is two-fold: First, the new name better matches the intention to have a concrete 
name for the requirements imposed on the corresponding <em>mutex types</em> (This kind of requirement deviate from the more general
<tt>Lockable</tt> requirements, which are not restricted to a explicitly enumerated set of library types). Second, using 
<tt>**MutexType</tt> over <tt>**Mutex</tt> provides the additional advantage that it reduces the chances of confusing named 
requirements from template parameters named <tt>Mutex</tt> (such as for <tt>unique_lock</tt> or <tt>shared_lock</tt>).
<p/>
Nonetheless the here presented wording has one unfortunate side-effect: Once applied it would have the effect that types
used to instantiate <tt>std::shared_lock</tt> cannot be user-defined shared mutex types due to 32.5.4.4 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.shared">[thread.lock.shared]</a>. 
The reason is based on the currently lack of an existing <tt>SharedLockable</tt> requirement set, which would complete the 
existing <tt>BasicLockable</tt> and <tt>Lockable</tt> requirements (which are "real" requirements). This restriction is not
actually a problem introduced by the provided resolution but instead one that existed before but becomes more obvious now.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
Handed over to SG1.
</p>

<p><i>[2015-05 Lenexa, SG1 response]</i></p>

<p>
Thanks to Daniel, and please put it in SG1-OK status. Perhaps open another issue for the remaining problem Daniel points out?
</p>

<p><i>[2015-10 pre-Kona]</i></p>

<p>
SG1 hands this over to LWG for wording review
</p>

<p><i>[2015-10-21 Kona, Daniel comments and adjusts wording to to untimed shared mutex types]</i></p>

<p>
The new wording reflects the addition of the new shared mutex types. The approach used for <tt>shared_lock</tt>
is similar to the one used for <tt>unique_lock</tt>: The template argument <tt>Mutex</tt> has a reduced requirement set that is not
sufficient for <em>all</em> operations. Only those members that require stronger requirements of <tt>SharedTimedMutexType</tt>
specify that additionally in the <i>Requires</i> element of the corresponding prototype specifications.
<p/>
The proposed wording could be more general if we would introduce more fundamental requirements set for <tt>SharedLockable</tt>
and <tt>SharedTimedLockable</tt> types which could be satisfied by user-provided types as well, because the 
<tt>SharedMutexType</tt> and <tt>SharedTimedMutexType</tt> requirements are essentially restricted to an enumerated set of
types provided by the Standard Library. But this extension seemed too large for this issue and can be easily fixed later
without any harm. 
</p>

<p><b>Previous resolution [SUPERSEDED]:</b></p>
<blockquote class="note">
<p>This wording is relative to N3936.</p>

<ol>
<li><p>Change 32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a> as indicated:</p>

<blockquote><p>
-1- The <em>mutex types</em> are the standard library types <tt>std::mutex</tt>, <tt>std::recursive_mutex</tt>, <tt>std::timed_mutex</tt>,
<tt>std::recursive_timed_mutex</tt>, and <tt>std::shared_timed_mutex</tt>. They shall meet the <ins><tt><em>MutexType</em></tt></ins> 
requirements set out in this section. In this description, <tt>m</tt> denotes an object of a mutex type.
</p></blockquote>
</li>

<li><p>Change 32.5.3.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.class">[thread.mutex.class]</a> as indicated:</p>

<blockquote><p>
-3- The class <tt>mutex</tt> shall satisfy all the <tt>Mutex<ins>Type</ins></tt> requirements 
(<ins>32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a></ins><del>32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a></del>). 
It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.2.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.recursive">[thread.mutex.recursive]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>recursive_mutex</tt> shall satisfy all the <del>Mutex</del><ins><tt>MutexType</tt></ins> requirements 
(<ins>32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a></ins><del>32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a></del>). 
It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a> as indicated:</p>

<blockquote><p>
-1- The <em>timed mutex types</em> are the standard library types <tt>std::timed_mutex</tt>, <tt>std::recursive_timed_mutex</tt>,
and <tt>std::shared_timed_mutex</tt>. They shall meet the <ins><tt><em>TimedMutexType</em></tt></ins> requirements set out below. 
In this description, <tt>m</tt> denotes an object of a mutex type, <tt>rel_time</tt> denotes an object of an instantiation of 
<tt>duration</tt> (20.12.5), and <tt>abs_time</tt> denotes an object of an instantiation of <tt>time_point</tt> (20.12.6).
</p></blockquote>
</li>

<li><p>Change 32.5.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.class">[thread.timedmutex.class]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>timed_mutex</tt> shall satisfy all of the <tt>TimedMutex<ins>Type</ins></tt> requirements 
(32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>). It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.recursive">[thread.timedmutex.recursive]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>recursive_timed_mutex</tt> shall satisfy all of the <tt>TimedMutex<ins>Type</ins></tt> requirements 
(32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>). It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a> as indicated: [<i>Drafting note</i>: The reference to the
timed mutex types requirements has been moved <em>after</em> introducing the new requirement set to ensure that 
<tt>SharedTimedMutexType</tt> <em>refine</em> <tt>TimedMutexType</tt>.]</p>

<blockquote>
<p>
-1- The standard library type <tt>std::shared_timed_mutex</tt> is a <em>shared timed mutex type</em>. Shared timed mutex
types shall meet the <ins><tt><em>SharedTimedMutexType</em></tt></ins> requirements <del>of timed mutex types 
(32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>), and additionally shall meet the requirements</del> set out below. In this 
description, <tt>m</tt> denotes an object of a mutex type, <tt>rel_type</tt> denotes
an object of an instantiation of <tt>duration</tt> (20.12.5), and <tt>abs_time</tt> denotes an object of an instantiation of
<tt>time_point</tt> (20.12.6).
<p/>
<ins>-?- The shared timed mutex types shall meet the <tt>TimedMutexType</tt> requirements (32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>).</ins>
</p>
</blockquote>
</li>

<li><p>Change 32.5.3.5.1 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.class">[thread.sharedtimedmutex.class]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>shared_timed_mutex</tt> shall satisfy all of the <tt>SharedTimedMutex<ins>Type</ins></tt> requirements 
(32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a>). It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.4.4 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.shared">[thread.lock.shared]</a> as indicated: [<i>Drafting note</i>: Once 
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3995.htm">N3995</a> has been applied, the following 
reference should be changed to the new <tt>SharedMutexType</tt> requirements ([thread.sharedmutex.requirements]) or 
even better to some new <tt>SharedLockable</tt> requirements (to be defined) &mdash; <i>end drafting note</i>]</p>

<blockquote><p>
-1- [&hellip;] The supplied <tt>Mutex</tt> type shall meet the <del>shared mutex</del><ins><tt>SharedTimedMutexType</tt></ins> requirements 
(32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a>).
<p/>
-2- [<i>Note</i>: <tt>shared_lock&lt;Mutex&gt;</tt> meets the <tt>TimedLockable</tt> requirements 
(30.2.5.4). &mdash; <i>end note</i>]
</p></blockquote>
</li>
</ol>

</blockquote>

<p><i>[2016-02 Jacksonville]</i></p>

<p>
Marshall to review wording.
</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Tim to redraft.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4527.</p>

<ol>
<li><p>Change 32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a> as indicated:</p>

<blockquote><p>
-1- The <em>mutex types</em> are the standard library types <tt>std::mutex</tt>, <tt>std::recursive_mutex</tt>, <tt>std::timed_mutex</tt>,
<tt>std::recursive_timed_mutex</tt>, <tt>std::shared_mutex</tt>, and <tt>std::shared_timed_mutex</tt>. They shall meet the 
<ins><tt><em>MutexType</em></tt></ins> requirements set out in this section. In this description, <tt>m</tt> denotes an object 
of a mutex type.
<p/>
-2- The mutex types shall meet the <tt>Lockable</tt> requirements (32.2.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.req.lockable.req">[thread.req.lockable.req]</a>).
</p></blockquote>
</li>

<li><p>Change 32.5.3.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.class">[thread.mutex.class]</a> as indicated:</p>

<blockquote><p>
-3- The class <tt>mutex</tt> shall satisfy all the <tt>Mutex<ins>Type</ins></tt> requirements 
(<ins>32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a></ins><del>32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a></del>). 
It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.2.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.recursive">[thread.mutex.recursive]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>recursive_mutex</tt> shall satisfy all the <del>Mutex</del><ins><tt>MutexType</tt></ins> requirements 
(<ins>32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a></ins><del>32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a></del>). 
It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a> as indicated:</p>

<blockquote><p>
-1- The <em>timed mutex types</em> are the standard library types <tt>std::timed_mutex</tt>, <tt>std::recursive_timed_mutex</tt>,
and <tt>std::shared_timed_mutex</tt>. They shall meet the <ins><tt><em>TimedMutexType</em></tt></ins> requirements set out below. 
In this description, <tt>m</tt> denotes an object of a mutex type, <tt>rel_time</tt> denotes an object of an instantiation of 
<tt>duration</tt> (20.12.5), and <tt>abs_time</tt> denotes an object of an instantiation of <tt>time_point</tt> (20.12.6).
<p/>
-2- The timed mutex types shall meet the <tt>TimedLockable</tt> requirements (32.2.5.4 <a href="https://timsong-cpp.github.io/cppwp/thread.req.lockable.timed">[thread.req.lockable.timed]</a>).
</p></blockquote>
</li>

<li><p>Change 32.5.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.class">[thread.timedmutex.class]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>timed_mutex</tt> shall satisfy all of the <tt>TimedMutex<ins>Type</ins></tt> requirements 
(32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>). It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.recursive">[thread.timedmutex.recursive]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>recursive_timed_mutex</tt> shall satisfy all of the <tt>TimedMutex<ins>Type</ins></tt> requirements 
(32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>). It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.4 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedmutex.requirements">[thread.sharedmutex.requirements]</a> as indicated:  [<i>Drafting note</i>: The reference to the
mutex types requirements has been moved <em>after</em> introducing the new requirement set to ensure that 
<tt>SharedMutexType</tt> <em>refines</em> <tt>MutexType</tt>.]</p>

<blockquote><p>
-1- The standard library types <tt>std::shared_mutex</tt> and <tt>std::shared_timed_mutex</tt> are <em>shared mutex types</em>.
Shared mutex types shall meet the <ins><tt><em>SharedMutexType</em></tt></ins> requirements <del>of mutex types 
(32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a>), and additionally shall meet the 
requirements</del> set out below. In this description, <tt>m</tt> denotes an object of a shared mutex type.
<p/>
<ins>-?- The shared mutex types shall meet the <tt>MutexType</tt> requirements (32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a>).</ins>
</p>
</blockquote>
</li>

<li><p>Change 32.5.3.4.1 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedmutex.class">[thread.sharedmutex.class]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>shared_mutex</tt> shall satisfy all of the <ins><tt>SharedMutexType</tt></ins> requirements 
<del>for shared mutexes</del> (32.5.3.4 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedmutex.requirements">[thread.sharedmutex.requirements]</a>). It shall be a standard-layout class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a> as indicated: [<i>Drafting note</i>: The reference to the
timed mutex types requirements has been moved <em>after</em> introducing the new requirement set to ensure that 
<tt>SharedTimedMutexType</tt> <em>refines</em> <tt>TimedMutexType</tt> and <tt>SharedMutexType</tt>.]</p>

<blockquote>
<p>
-1- The standard library type <tt>std::shared_timed_mutex</tt> is a <em>shared timed mutex type</em>. Shared timed mutex
types shall meet the <ins><tt><em>SharedTimedMutexType</em></tt></ins> requirements <del>of timed mutex types 
(32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>), shared mutex types (32.5.3.4 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedmutex.requirements">[thread.sharedmutex.requirements]</a>), 
and additionally shall meet the requirements</del> set out below. In this description, <tt>m</tt> denotes an object of 
a shared timed mutex type, <tt>rel_type</tt> denotes an object of an instantiation of <tt>duration</tt> (20.12.5), and 
<tt>abs_time</tt> denotes an object of an instantiation of <tt>time_point</tt> (20.12.6).
<p/>
<ins>-?- The shared timed mutex types shall meet the <tt>TimedMutexType</tt> requirements (32.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/thread.timedmutex.requirements">[thread.timedmutex.requirements]</a>)
and the <tt>SharedMutexType</tt> requirements (32.5.3.4 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedmutex.requirements">[thread.sharedmutex.requirements]</a>).</ins>
</p>
</blockquote>
</li>

<li><p>Change 32.5.3.5.1 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.class">[thread.sharedtimedmutex.class]</a> as indicated:</p>

<blockquote><p>
-2- The class <tt>shared_timed_mutex</tt> shall satisfy all of the <ins><tt>SharedTimedMutexType</tt></ins> requirements 
<del>for shared timed mutexes</del> (32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a>). It shall be a standard-layout 
class (Clause 9).
</p></blockquote>
</li>

<li><p>Change 32.5.4.4 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.shared">[thread.lock.shared]</a> as indicated:</p>

<blockquote><p>
-1- [&hellip;] The supplied <tt>Mutex</tt> type shall meet the <del>shared mutex</del><ins><tt>SharedMutexType</tt></ins> requirements 
(<del>32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a></del><ins>32.5.3.4 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedmutex.requirements">[thread.sharedmutex.requirements]</a></ins>).
<p/>
-2- [<i>Note</i>: <tt>shared_lock&lt;Mutex&gt;</tt> meets the <tt>TimedLockable</tt> requirements 
(30.2.5.4). &mdash; <i>end note</i>]
</p></blockquote>
</li>

<li><p>Change 32.5.4.4.1 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.shared.cons">[thread.lock.shared.cons]</a> as indicated:</p>

<blockquote>
<pre>
template &lt;class Clock, class Duration&gt;
  shared_lock(mutex_type&amp; m,
              const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</pre>
<blockquote>
<p>
-14- <i>Requires</i>: <ins>The supplied <tt>Mutex</tt> type shall meet the <tt>SharedTimedMutexType</tt> requirements 
(32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a>).</ins> 
The calling thread does not own the mutex for any ownership mode.
<p/>
-15- <i>Effects</i>: Constructs an object of type <tt>shared_lock</tt> and calls <tt>m.try_lock_shared_until(abs_time)</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template &lt;class Rep, class Period&gt;
  shared_lock(mutex_type&amp; m,
              const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</pre>
<blockquote>
<p>
-17- <i>Requires</i>: <ins>The supplied <tt>Mutex</tt> type shall meet the <tt>SharedTimedMutexType</tt> requirements 
(32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a>).</ins> 
The calling thread does not own the mutex for any ownership mode.
<p/>
-18- <i>Effects</i>: Constructs an object of type <tt>shared_lock</tt> and calls <tt>m.try_lock_shared_for(rel_time)</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>

</li>

<li><p>Change 32.5.4.4.2 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.shared.locking">[thread.lock.shared.locking]</a> as indicated:</p>

<blockquote>
<pre>
template &lt;class Clock, class Duration&gt;
  bool
  try_lock_until(const chrono::time_point&lt;Clock, Duration&gt;&amp; abs_time);
</pre>
<blockquote>
<p>
<ins>-?- <i>Requires</i>: The supplied <tt>Mutex</tt> type shall meet the <tt>SharedTimedMutexType</tt> requirements 
(32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a>).</ins>
<p/>
-8- <i>Effects</i>: <tt>pm-&gt;try_lock_shared_until(abs_time)</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template &lt;class Rep, class Period&gt;
  bool try_lock_for(const chrono::duration&lt;Rep, Period&gt;&amp; rel_time);
</pre>
<blockquote>
<p>
<ins>-?- <i>Requires</i>: The supplied <tt>Mutex</tt> type shall meet the <tt>SharedTimedMutexType</tt> requirements 
(32.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/thread.sharedtimedmutex.requirements">[thread.sharedtimedmutex.requirements]</a>).</ins>
<p/>
-12- <i>Effects</i>: <tt>pm-&gt;try_lock_shared_for(rel_time)</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

</ol>






<hr>
<h3><a name="2366" href="2366">2366.</a> <tt>istreambuf_iterator</tt> end-of-stream equality</h3>
<p><b>Section:</b> 23.6.3 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator">[istreambuf.iterator]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hyman Rosen <b>Opened:</b> 2014-02-19 <b>Last modified:</b> 2014-06-17 08:47:43 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#istreambuf.iterator">active issues</a> in [istreambuf.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#istreambuf.iterator">issues</a> in [istreambuf.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Given the following code,
</p>
<blockquote><pre>
#include &lt;sstream&gt;

std::stringbuf buf;
std::istreambuf_iterator&lt;char&gt; begin(&amp;buf);
std::istreambuf_iterator&lt;char&gt; end;
</pre></blockquote>
<p>
it is not clear from the wording of the Standard whether <tt>begin.equal(end)</tt>
must be true. In at least one implementation it is not (CC: Sun C++ 5.10 SunOS_sparc Patch 128228-25 2013/02/20) and in at least
one implementation it is (gcc version 4.3.2 x86_64-unknown-linux-gnu).
<p/>
23.6.3 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator">[istreambuf.iterator]</a> says that <tt>end</tt> is an end-of-stream iterator since it was default
constructed. It also says that an iterator becomes equal to an end-of-stream
iterator when end of stream is reached by <tt>sgetc()</tt> having returned <tt>eof()</tt>.
99 [istreambuf.iterator::equal] says that <tt>equal()</tt> returns true iff both iterators are end of stream
or not end of stream. But there seems to be no requirement that <tt>equal</tt> check for end-of-stream by calling <tt>sgetc()</tt>. 
<p/>
Jiahan Zi at BloombergLP discovered this issue through his code failing to
work correctly. Dietmar K&uuml;hl has opined in a private communication that
the iterators should compare equal.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2375" href="2375">2375.</a> Is [iterator.requirements.general]/9 too broadly applied?</h3>
<p><b>Section:</b> 23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2014-03-25 <b>Last modified:</b> 2014-06-17 08:47:43 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.requirements.general">active issues</a> in [iterator.requirements.general].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.requirements.general">issues</a> in [iterator.requirements.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a> p9 says:
</p>
<blockquote><p>
Destruction of an iterator may invalidate pointers and references previously obtained from that iterator.
</p></blockquote>
<p>
But the resolution of LWG issue <a href="2360">2360</a> specifically advocates returning <tt>*--temp;</tt> where <tt>temp</tt> is a 
local variable.
<p/>
And 23.3.5.4 <a href="https://timsong-cpp.github.io/cppwp/forward.iterators">[forward.iterators]</a> p6 says:
</p>
<blockquote><p>
If <tt>a</tt> and <tt>b</tt> are both dereferenceable, then <tt>a == b</tt> if and only if <tt>*a</tt> and <tt>*b</tt> are bound 
to the same object.
</p></blockquote>
<p>
which disallows "stashing" iterators (i.e, iterators that refer to data inside themselves).
<p/>
So, I suspect that the restriction in p9 should only apply to input iterators, and can probably be moved into 
23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a> instead of 23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>.
</p>

<p><i>[2014-05-22, Daniel comments]</i></p>


<p>
Given that forward iterators (and beyond) are refinements of input iterator, moving this constraint to input iterators won't help
much because it would still hold for all refined forms. 
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2381" href="2381">2381.</a> Inconsistency in parsing floating point numbers</h3>
<p><b>Section:</b> 28.4.2.1.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.get.virtuals">[facet.num.get.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2014-04-30 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#facet.num.get.virtuals">active issues</a> in [facet.num.get.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#facet.num.get.virtuals">issues</a> in [facet.num.get.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In 28.4.2.1.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.get.virtuals">[facet.num.get.virtuals]</a> we have:
</p>
<blockquote><p>
Stage 3: The sequence of chars accumulated in stage 2 (the field) is converted to a numeric value by the
rules of one of the functions declared in the header <tt>&lt;cstdlib&gt;</tt>:
</p>
<ul>
<li><p>For a signed integer value, the function <tt>strtoll</tt>.</p></li>
<li><p>For an unsigned integer value, the function <tt>strtoull</tt>.</p></li>
<li><p>For a floating-point value, the function <tt>strtold</tt>.</p></li>
</ul>
</blockquote>
<p>
This implies that for many cases, this routine should return true:
</p>
<blockquote><pre>
bool is_same(const char* p) 
{
  std::string str{p};
  double val1 = std::strtod(str.c_str(), nullptr);
  std::stringstream ss(str);
  double val2;
  ss &gt;&gt; val2;
  return std::isinf(val1) == std::isinf(val2) &amp;&amp;                 // either they're both infinity
         std::isnan(val1) == std::isnan(val2) &amp;&amp;                 // or they're both NaN
         (std::isinf(val1) || std::isnan(val1) || val1 == val2); // or they're equal
}
</pre></blockquote>
<p>
and this is indeed true, for many strings:
</p>
<blockquote><pre>
assert(is_same("0"));
assert(is_same("1.0"));
assert(is_same("-1.0"));
assert(is_same("100.123"));
assert(is_same("1234.456e89"));
</pre></blockquote>
<p>
but not for others
</p>
<blockquote><pre>
assert(is_same("0xABp-4")); // hex float
assert(is_same("inf"));
assert(is_same("+inf"));
assert(is_same("-inf"));
assert(is_same("nan"));
assert(is_same("+nan"));
assert(is_same("-nan"));

assert(is_same("infinity"));
assert(is_same("+infinity"));
assert(is_same("-infinity"));
</pre></blockquote>
<p>
These are all strings that are correctly parsed by <tt>std::strtod</tt>, but not by the stream extraction operators.
They contain characters that are deemed invalid in stage 2 of parsing.
<p/>
If we're going to say that we're converting by the rules of <tt>strtold</tt>, then we should accept all the things that 
<tt>strtold</tt> accepts.
</p>

<p><i>[2016-04, Issues Telecon]</i></p>

<p>
People are much more interested in round-tripping hex floats than handling <tt>inf</tt> and <tt>nan</tt>. Priority changed to P2.
</p>
<p>
Marshall says he'll try to write some wording, noting that this is a very closely specified part of the standard, and has remained unchanged for a long time. Also, there will need to be a sample implementation.
</p>

<p><i>[2016-08, Chicago]</i></p>

<p>Zhihao provides wording</p>
<p>The <tt>src</tt> array in Stage 2 does narrowing only.  The actual
input validation is delegated to <tt>strtold</tt> (independent from
the parsing in Stage 3 which is again being delegated
to <tt>strtold</tt>) by saying:</p>

<p>  [...] If it is not discarded, then a check is made to determine
  if c is allowed as the next character of an input field of the
  conversion specifier returned by Stage 1.</p>

<p>So a conforming C++11 <tt>num_get</tt> is supposed to magically
accept an hexfloat without an exponent</p>

<p>  0x3.AB</p>

<p>because we refers to C99, and the fix to this issue should be
just expanding the <tt>src</tt> array.</p>

<p>Support for Infs and NaNs are not proposed because of the
complexity of nan(n-chars).</p>

<p><i>[2016-08, Chicago]</i></p>

<p>Tues PM: Move to Open</p>

<p><i>[2016-09-08, Zhihao Yuan comments and updates proposed wording]</i></p>

<p>
Examples added.
</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Needs an Annex C entry. Tim to write Annex C.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4606.</p>

<ol> 
<li><p>Change 28.4.2.1.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.get.virtuals">[facet.num.get.virtuals]</a>/3 Stage 2 as indicated:</p>

<blockquote>
<p><tt>static const char src[] = "0123456789abcdef<ins>p</ins>xABCDEF<ins>P</ins>X+-";</tt></p>
</blockquote>
</li>

<li><p>Append the following examples to 28.4.2.1.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.get.virtuals">[facet.num.get.virtuals]</a>/3 Stage 2 as indicated:</p>
<blockquote>
<p>
<ins>[<i>Example:</i></ins>
</p>
<blockquote>
<p>
<ins>Given an input sequence of <tt>"0x1a.bp+07p"</tt>,</ins>
</p>
<ul>
<li><p><ins>if Stage 1 returns <tt>%d</tt>, <tt>"0"</tt> is accumulated;</ins></p></li>
<li><p><ins>if Stage 1 returns <tt>%i</tt>, <tt>"0x1a"</tt> are accumulated;</ins></p></li>
<li><p><ins>if Stage 1 returns <tt>%g</tt>, <tt>"0x1a.bp+07"</tt> are accumulated.</ins></p></li>
</ul>
<p>
<ins>In all cases, leaving the rest in the input.</ins>
</p>
</blockquote>
<p><ins>&mdash; end example]</ins></p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2383" href="2383">2383.</a> Overflow cannot be ill-formed for chrono::duration integer literals</h3>
<p><b>Section:</b> 27.5.8 <a href="https://timsong-cpp.github.io/cppwp/time.duration.literals">[time.duration.literals]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2014-05-16 <b>Last modified:</b> 2014-11-08 16:41:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
27.5.8 <a href="https://timsong-cpp.github.io/cppwp/time.duration.literals">[time.duration.literals]</a> p3 says:
</p>
<blockquote><p>
If any of these suffixes are applied to an integer literal and the
resulting <tt>chrono::duration</tt> value cannot be represented in the result
type because of overflow, the program is ill-formed.
</p></blockquote>
<p>
Ill-formed requires a diagnostic at compile-time, but there is no way
to  detect the overflow from <tt>unsigned long long</tt> to the <tt>signed
duration&lt;&gt;::rep</tt> type.
<p/>
Overflow could be detected if the duration integer literals were
literal operator templates, otherwise overflow can either be undefined
or a run-time error, not ill-formed.
</p>

<p><i>[Urbana 2014-11-07: Move to Open]</i></p>




<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2392" href="2392">2392.</a> "character type" is used but not defined</h3>
<p><b>Section:</b> 16.3.18 <a href="https://timsong-cpp.github.io/cppwp/defns.ntcts">[defns.ntcts]</a>, 28.3.1.1.1 <a href="https://timsong-cpp.github.io/cppwp/locale.category">[locale.category]</a>, 29.2.2 <a href="https://timsong-cpp.github.io/cppwp/iostreams.limits.pos">[iostreams.limits.pos]</a>, 29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a>, 29.7.5.2.4 <a href="https://timsong-cpp.github.io/cppwp/ostream.inserters.character">[ostream.inserters.character]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jeffrey Yasskin <b>Opened:</b> 2014-06-01 <b>Last modified:</b> 2017-04-22 20:23:31 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The term "character type" is used in 16.3.18 <a href="https://timsong-cpp.github.io/cppwp/defns.ntcts">[defns.ntcts]</a>, 28.3.1.1.1 <a href="https://timsong-cpp.github.io/cppwp/locale.category">[locale.category]</a>,
29.2.2 <a href="https://timsong-cpp.github.io/cppwp/iostreams.limits.pos">[iostreams.limits.pos]</a>, 29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a>, and
29.7.5.2.4 <a href="https://timsong-cpp.github.io/cppwp/ostream.inserters.character">[ostream.inserters.character]</a>, but the core language only defines
"narrow character types" (6.8.1 <a href="https://timsong-cpp.github.io/cppwp/basic.fundamental">[basic.fundamental]</a>).
<p/>
"wide-character type" is used in D.16 <a href="https://timsong-cpp.github.io/cppwp/depr.locale.stdcvt">[depr.locale.stdcvt]</a>, but the core
language only defines a "wide-character set" and "wide-character literal".
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2398" href="2398">2398.</a> <tt>type_info</tt>'s destructor shouldn't be required to be virtual</h3>
<p><b>Section:</b> 17.7.2 <a href="https://timsong-cpp.github.io/cppwp/type.info">[type.info]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2014-06-14 <b>Last modified:</b> 2016-08-06 21:29:52 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#type.info">issues</a> in [type.info].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>type_info</tt>'s destructor is depicted as being <tt>virtual</tt>, which is nearly unobservable to users (since they can't construct 
or copy this class, they can't usefully derive from it). However, it's technically observable (via <tt>is_polymorphic</tt> and 
<tt>has_virtual_destructor</tt>). It also imposes real costs on implementations, requiring them to store one vptr per 
<tt>type_info</tt> object, when RTTI space consumption is a significant concern.
<p/>
Making this implementation-defined wouldn't affect users (who can observe this only if they're specifically looking for it) and 
wouldn't affect implementations who need <tt>virtual</tt> here, but it would allow other implementations to drop <tt>virtual</tt> 
and improve their RTTI space consumption.
<p/>
Richard Smith:
<p/>
It's observable in a few other ways.
</p>
<blockquote><pre>
std::map&lt;void*, something&gt; m;
m[dynamic_cast&lt;void*&gt;(&amp;typeid(blah))] = stuff;
</pre></blockquote>
<p>
... is broken by this change, because you can't <tt>dynamic_cast</tt> a non-polymorphic class type to <tt>void*</tt>.
</p>
<blockquote><pre>
type_info&amp; f();
typeid(f());
</pre></blockquote>
<p>
... evaluates <tt>f()</tt> at runtime without this change, and might not do so with this change.
<p/>
These are probably rare things, but I can imagine at least some forms of the latter being used in SFINAE tricks.
</p>

<p><i>[Lenexa 2015-05-05: Move to Open]</i></p>

<p>Marshall to poll LEWG for their opinion</p>

<p><i>[2016-06]</i></p>
 
<p>
On the <a href="http://lists.isocpp.org/lib-ext/2016/06/2451.php">reflector</a>, STL wrote:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;"><p>We'll prototype this change and report back with data in the future.</p></blockquote>

<p><i>[2016-08 Chicago]</i></p>

<p>No update from STL. Set priority to P3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3936.</p>

<ol>
<li><p>Change 17.7.2 <a href="https://timsong-cpp.github.io/cppwp/type.info">[type.info]</a> as indicated:</p>

<blockquote>
<pre>
namespace std {
  class type_info {
  public:
    <del>virtual</del><ins><i>see below</i></ins> ~type_info();
    [&hellip;]
  };
}
</pre>
<p>
-1- The class <tt>type_info</tt> describes type information generated by the implementation. Objects of this class
effectively store a pointer to a name for the type, and an encoded value suitable for comparing two types for
equality or collating order. The names, encoding rule, and collating sequence for types are all unspecified
and may differ between programs. <ins>Whether <tt>~type_info()</tt> is <tt>virtual</tt> is implementation-defined.</ins>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2413" href="2413">2413.</a> <tt>assert</tt> macro is overconstrained</h3>
<p><b>Section:</b> 19.3 <a href="https://timsong-cpp.github.io/cppwp/assertions">[assertions]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> David Krauss <b>Opened:</b> 2014-06-25 <b>Last modified:</b> 2014-11-03 20:00:17 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#assertions">active issues</a> in [assertions].</p>
<p><b>View all other</b> <a href="lwg-index.html#assertions">issues</a> in [assertions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
When <tt>NDEBUG</tt> is defined, <tt>assert</tt> must expand exactly to the token sequence <tt>((void)0)</tt>, with no 
whitespace (C99 &sect;7.2/1 and also C11 &sect;7.2/1). This is a lost opportunity to pass the condition along to the optimizer.
<p/>
The user may observe the token sequence using the stringize operator or discriminate it by making a matching <tt>#define</tt> 
directive. There is little chance of practical code doing such things. It's reasonable to allow any expansion that is a <tt>void</tt> 
expression with no side effects or semantic requirements, for example, an extension keyword or an attribute-specifier finagled 
into the context.
<p/>
Conforming optimizations would still be limited to treating the condition as hint, not a requirement. Nonconformance on this 
point is quite reasonable though, given user preferences. Anyway, it shouldn't depend on preprocessor quirks.
<p/>
As for current practice, Darwin OS <tt>&lt;assert.h&gt;</tt> provides a GCC-style compiler hint <tt>__builtin_expect</tt> but only in 
debug mode. Shouldn't release mode preserve hints?
<p/>
Daniel:
<p/>
The corresponding resolution should take care not to conflict with the intention behind LWG <a href="2234">2234</a>.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2414" href="2414">2414.</a> Member function reentrancy should be implementation-defined</h3>
<p><b>Section:</b> 16.5.5.9 <a href="https://timsong-cpp.github.io/cppwp/reentrancy">[reentrancy]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2014-07-01 <b>Last modified:</b> 2017-11-05 05:11:26 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#reentrancy">issues</a> in [reentrancy].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
N3936 16.5.5.9 <a href="https://timsong-cpp.github.io/cppwp/reentrancy">[reentrancy]</a>/1 talks about "functions", but that doesn't address the scenario of calling different member 
functions of a single object. Member functions often have to violate and then re-establish invariants. For example, vectors 
often have "holes" during insertion, and element constructors/destructors/etc. shouldn't be allowed to observe the vector 
while it's in this invariant-violating state. The [reentrancy] Standardese should be extended to cover member functions, 
so that implementers can either say that member function reentrancy is universally prohibited, or selectively allowed for 
very specific scenarios.
<p/>
(For clarity, this issue has been split off from LWG <a href="2382">2382</a>.)
</p>

<p><i>[2014-11-03 Urbana]</i></p>

<p>
AJM confirmed with SG1 that they had no special concerns with this issue, and LWG should retain ownership.
<p/>
AM: this is too overly broad as it also covers calling the exact same member function on a different object<br/>
STL: so you insert into a map, and copying the value triggers another insertion into a different map of the same type<br/>
GR: reentrancy seems to imply the single-threaded case, but needs to consider the multi-threaded case
<p/>
Needs more wording.
</p>
<p>
Move to Open
</p>

<p><i>[2015-07 Telecon Urbana]</i></p>

<p>Marshall to ping STL for updated wording.<br/></p>

<p><i>[2016-05 email from STL]</i></p>

<p>I don't have any better suggestions than my original PR at the moment.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N3936.</p>

<ol>
<li><p>Change 16.5.5.9 <a href="https://timsong-cpp.github.io/cppwp/reentrancy">[reentrancy]</a> p1 as indicated:</p>
<blockquote>
<p>
-1- Except where explicitly specified in this standard, it is implementation-defined which functions <ins>(including different 
member functions called on a single object)</ins> in the Standard C++ library may be recursively reentered.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2421" href="2421">2421.</a> Non-specification of handling zero size in <tt>std::align</tt> [ptr.align]</h3>
<p><b>Section:</b> 20.10.6 <a href="https://timsong-cpp.github.io/cppwp/ptr.align">[ptr.align]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Melissa Mears <b>Opened:</b> 2014-08-06 <b>Last modified:</b> 2014-11-03 20:00:17 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#ptr.align">issues</a> in [ptr.align].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The specification of <tt>std::align</tt> does not appear to specify what happens when the value of the <tt>size</tt> 
parameter is 0. (The question of what happens when <tt>alignment</tt> is 0 is mentioned in another Defect Report, <a href="2377">2377</a>; 
it would change the behavior to be undefined rather than potentially implementation-defined.)
<p/>
The case of <tt>size</tt> being 0 is interesting because the result is ambiguous. Consider the following code's output:
</p>
<blockquote>
<pre>
#include &lt;cstdio&gt;
#include &lt;memory&gt;

int main()
{
  alignas(8) char buffer[8];
  void *ptr = &amp;buffer[1];
  std::size_t space = sizeof(buffer) - sizeof(char[1]);

  void *result = std::align(8, 0, ptr, space);

  std::printf("%d %td\n", !!result, result ? (static_cast&lt;char*&gt;(result) - buffer) : std::ptrdiff_t(-1));
}
</pre>
</blockquote>
<p>
There are four straightforward answers as to what the behavior of <tt>std::align</tt> with size 0 should be:
</p>
<ol>
<li><p>The behavior is undefined because the size is invalid.</p></li>
<li><p>The behavior is implementation-defined. This seems to be the status quo, with current implementations using #3.</p></li>
<li><p>Act the same as <tt>size == 1</tt>, except that if <tt>size == 1</tt> would fail but would be defined and succeed 
if space were exactly 1 larger, the result is a pointer to the byte past the end of the <tt>ptr</tt> buffer. That is, the 
"aligned" version of a 0-byte object can be one past the end of an allocation. Such pointers are, of course, valid when not 
dereferenced (and a "0-byte object" shouldn't be), but whether that is desired is not specified in the Standard's definition 
of <tt>std::align</tt>, it appears. The output of the code sample is "<tt>1 8</tt>" in this case.</p></li>
<li><p>Act the same as <tt>size == 1</tt>; this means that returning "one past the end" is not a possible result. In this case, 
the code sample's output is "<tt>0 -1</tt>".</p></li>
</ol>
<p>
The two compilers I could get working with <tt>std::align</tt>, Visual Studio 2013 and Clang 3.4, implement #3. (Change <tt>%td</tt> to 
<tt>%Id</tt> on Visual Studio 2013 and earlier. 2014 and later will have <tt>%td</tt>.)
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2423" href="2423">2423.</a> Missing specification <tt>slice_array</tt>, <tt>gslice_array</tt>, <tt>mask_array</tt>, <tt>indirect_array</tt> copy constructor</h3>
<p><b>Section:</b> 26.7.5 <a href="https://timsong-cpp.github.io/cppwp/template.slice.array">[template.slice.array]</a>, 26.7.7 <a href="https://timsong-cpp.github.io/cppwp/template.gslice.array">[template.gslice.array]</a>, 26.7.8 <a href="https://timsong-cpp.github.io/cppwp/template.mask.array">[template.mask.array]</a>, 26.7.9 <a href="https://timsong-cpp.github.io/cppwp/template.indirect.array">[template.indirect.array]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Akira Takahashi <b>Opened:</b> 2014-08-12 <b>Last modified:</b> 2014-11-03 20:00:17 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#template.slice.array">issues</a> in [template.slice.array].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I found a missing specification of the copy constructor of the following class templates:
</p>
<ul>
<li><p><tt>slice_array</tt> (26.7.5 <a href="https://timsong-cpp.github.io/cppwp/template.slice.array">[template.slice.array]</a>)</p></li>
<li><p><tt>gslice_array</tt> (26.7.7 <a href="https://timsong-cpp.github.io/cppwp/template.gslice.array">[template.gslice.array]</a>)</p></li>
<li><p><tt>mask_array</tt> (26.7.8 <a href="https://timsong-cpp.github.io/cppwp/template.mask.array">[template.mask.array]</a>)</p></li>
<li><p><tt>indirect_array</tt> (26.7.9 <a href="https://timsong-cpp.github.io/cppwp/template.indirect.array">[template.indirect.array]</a>)</p></li>
</ul>


<p><b>Proposed resolution:</b></p>
<ol>
<li><p>Before 26.7.5.2 <a href="https://timsong-cpp.github.io/cppwp/slice.arr.assign">[slice.arr.assign]</a> insert a new sub-clause as indicated:</p>

<p>
<ins><b>-?- <tt>slice_array</tt> constructors [slice.arr.cons]</b></ins>
</p>
<blockquote>
<pre>
<ins>slice_array(const slice_array&amp;);</ins>
</pre>
<p>
<ins>-?- <i>Effects</i>: The constructed slice refers to the same <tt>valarray&lt;T&gt;</tt> object to which
the argument slice refers.</ins>
</p>
</blockquote>
</li>

<li><p>Before 26.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/gslice.array.assign">[gslice.array.assign]</a> insert a new sub-clause as indicated:</p>

<p>
<ins><b>-?- <tt>gslice_array</tt> constructors [gslice.array.cons]</b></ins>
</p>
<blockquote>
<pre>
<ins>gslice_array(const gslice_array&amp;);</ins>
</pre>
<p>
<ins>-?- <i>Effects</i>: The constructed slice refers to the same <tt>valarray&lt;T&gt;</tt> object to which
the argument slice refers.</ins>
</p>
</blockquote>
</li>

<li><p>Before 26.7.8.2 <a href="https://timsong-cpp.github.io/cppwp/mask.array.assign">[mask.array.assign]</a> insert a new sub-clause as indicated:</p>

<p>
<ins><b>-?- <tt>mask_array</tt> constructors [mask.array.cons]</b></ins>
</p>
<blockquote>
<pre>
<ins>mask_array(const mask_array&amp;);</ins>
</pre>
<p>
<ins>-?- <i>Effects</i>: The constructed slice refers to the same <tt>valarray&lt;T&gt;</tt> object to which
the argument slice refers.</ins>
</p>
</blockquote>
</li>

<li><p>Before 26.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/indirect.array.assign">[indirect.array.assign]</a> insert a new sub-clause as indicated:</p>

<p>
<ins><b>-?- <tt>indirect_array</tt> constructors [indirect.array.cons]</b></ins>
</p>
<blockquote>
<pre>
<ins>indirect_array(const indirect_array&amp;);</ins>
</pre>
<p>
<ins>-?- <i>Effects</i>: The constructed slice refers to the same <tt>valarray&lt;T&gt;</tt> object to which
the argument slice refers.</ins>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2431" href="2431">2431.</a> Missing regular expression traits requirements</h3>
<p><b>Section:</b> 30.3 <a href="https://timsong-cpp.github.io/cppwp/re.req">[re.req]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2014-09-30 <b>Last modified:</b> 2014-11-04 10:07:55 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The requirements on the traits class in 30.3 <a href="https://timsong-cpp.github.io/cppwp/re.req">[re.req]</a> do not say whether a
regular expression traits class is required to be <tt>DefaultConstructible</tt>, 
<tt>CopyConstructible</tt>, <tt>CopyAssignable</tt> etc.
<p/>
The <tt>std::regex_traits</tt> class appears to be all of the above, but can
<tt>basic_regex</tt> assume that for user-defined traits classes?
<p/>
Should the following statements all leave <tt>u</tt> in equivalent states?
</p>
<blockquote><pre>
X u{v};
X u; u = v;
X u; u.imbue(v.getloc();
</pre></blockquote>
<p>
Whether they are equivalent has implications for <tt>basic_regex</tt> copy construction and 
assignment.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2432" href="2432">2432.</a> <tt>initializer_list</tt> assignability</h3>
<p><b>Section:</b> 17.10 <a href="https://timsong-cpp.github.io/cppwp/support.initlist">[support.initlist]</a> <b>Status:</b> <a href="lwg-active.html#EWG">EWG</a>
 <b>Submitter:</b> David Krauss <b>Opened:</b> 2014-09-30 <b>Last modified:</b> 2015-05-22 19:58:39 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#support.initlist">active issues</a> in [support.initlist].</p>
<p><b>View all other</b> <a href="lwg-index.html#support.initlist">issues</a> in [support.initlist].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#EWG">EWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>std::initializer_list::operator=</tt> 17.10 <a href="https://timsong-cpp.github.io/cppwp/support.initlist">[support.initlist]</a> is horribly broken and it needs deprecation:
</p>
<blockquote><pre>
std::initializer_list&lt;foo&gt; a = {{1}, {2}, {3}};
a = {{4}, {5}, {6}};
// New sequence is already destroyed.
</pre></blockquote>
<p>
Assignability of <tt>initializer_list</tt> isn't explicitly specified, but most implementations supply a default assignment 
operator. I'm not sure what 16.4 <a href="https://timsong-cpp.github.io/cppwp/description">[description]</a> says, but it probably doesn't matter.
</p>

<p><i>[Lenexa 2015-05-05: Send to EWG as discussed in Telecon]</i></p>



<p><b>Proposed resolution:</b></p>

<ol>
<li><p>Edit 17.10 <a href="https://timsong-cpp.github.io/cppwp/support.initlist">[support.initlist]</a> p1, class template <tt>initializer_list</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;class E&gt; class initializer_list {
  public:
    [&hellip;]
    constexpr initializer_list() noexcept;
  
    <ins>initializer_list(const initializer_list&amp;) = default;</ins>
    <ins>initializer_list(initializer_list&amp;&amp;) = default;</ins>
    <ins>initializer_list&amp; operator=(const initializer_list&amp;) = delete;</ins>
    <ins>initializer_list&amp; operator=(initializer_list&amp;&amp;) = delete;</ins>
    
    constexpr size_t size() const noexcept;
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>

</li>
</ol>






<hr>
<h3><a name="2452" href="2452">2452.</a> <tt>is_constructible</tt>, etc. and default arguments</h3>
<p><b>Section:</b> 20.15 <a href="https://timsong-cpp.github.io/cppwp/meta">[meta]</a> <b>Status:</b> <a href="lwg-active.html#Core">Core</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2014-11-04 <b>Last modified:</b> 2015-10-21 05:22:23 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta">active issues</a> in [meta].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta">issues</a> in [meta].</p>
<p><b>Discussion:</b></p>
<p>
The <tt>BaseCharacteristic</tt> for <tt>is_constructible</tt> is defined in terms of the well-formedness 
of a declaration for an invented variable. The well-formedness of the described declaration itself may 
change for the same set of arguments because of the introduction of default arguments.
<p/>
In the following program, there appears to be conflicting definitions of a specialization of 
<tt>std::is_constructible</tt>; however, it seems that this situation is caused without a user violation 
of the library requirements or the ODR. There is a similar issue with <tt>is_convertible</tt>, <tt>result_of</tt>
and others.
<p/>
a.cc:
</p>
<blockquote><pre>
#include &lt;type_traits&gt;
struct A { A(int, int); };
const std::false_type&amp; x1 = std::is_constructible&lt;A, int&gt;();

int main() { }
</pre></blockquote>
<p>
b.cc:
</p>
<blockquote><pre>
#include &lt;type_traits&gt;
struct A { A(int, int); };

inline A::A(int, int = 0) { }

const std::true_type&amp; x2 = std::is_constructible&lt;A, int&gt;();
</pre></blockquote>
<p>
Presumably this program should invoke undefined behaviour, but the Library specification doesn't
say that.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
Core wording should say "this kind of thing is ill-formed, no diagnostic required"
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2453" href="2453">2453.</a> &sect;[iterator.range] and now [iterator.container] aren't available via <tt>&lt;initializer_list&gt;</tt></h3>
<p><b>Section:</b> 17.10 <a href="https://timsong-cpp.github.io/cppwp/support.initlist">[support.initlist]</a>, 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a>, 99 [iterator.container] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2014-11-11 <b>Last modified:</b> 2016-02-01 11:19:56 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#support.initlist">active issues</a> in [support.initlist].</p>
<p><b>View all other</b> <a href="lwg-index.html#support.initlist">issues</a> in [support.initlist].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
These sections define helper functions, some of which apply to <tt>initializer_list&lt;T&gt;</tt>. And they're 
available if you include one of a long list of header files, many of which include <tt>&lt;initializer_list&gt;</tt>. 
But they are not available if you include <tt>&lt;initializer_list&gt;</tt>. This seems very odd.
</p>
<blockquote><pre>
#include &lt;initializer_list&gt;
auto x = {1, 2, 3};
const int *p = data(x); // error, undeclared
#include &lt;vector&gt;
const int *q = data(x); // ok
</pre></blockquote>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2457" href="2457">2457.</a> <tt>std::begin()</tt> and <tt>std::end()</tt> do not support multi-dimensional arrays correctly</h3>
<p><b>Section:</b> 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Janez &#x17d;emva <b>Opened:</b> 2014-11-16 <b>Last modified:</b> 2015-02-23 23:58:50 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.range">active issues</a> in [iterator.range].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.range">issues</a> in [iterator.range].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The following code:
</p>
<blockquote><pre>
#include &lt;algorithm&gt;
#include &lt;iterator&gt;
#include &lt;iostream&gt;
#include &lt;cassert&gt;

int main() 
{
  int a[2][3][4] = { { { 1,  2,  3,  4}, { 5,  6,  7,  8}, { 9, 10, 11, 12} },
                     { {13, 14, 15, 16}, {17, 18, 19, 20}, {21, 22, 23, 24} } };
  int b[2][3][4];

  assert(std::distance(std::begin(a), std::end(a)) == 2 * 3 * 4);
  std::copy(std::begin(a), std::end(a), std::begin(b));
  std::copy(std::begin(b), std::end(b), std::ostream_iterator&lt;int&gt;(std::cout, ","));
}
</pre></blockquote>
<p>
does not compile. 
<p/>
A possible way to remedy this would be to add the following overloads of
<tt>begin</tt>, <tt>end</tt>, <tt>rbegin</tt>, and <tt>rend</tt> to 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a>, 
relying on recursive evaluation:
</p>
<blockquote><pre>
namespace std {

  template &lt;typename T, size_t M, size_t N&gt;
  constexpr remove_all_extents_t&lt;T&gt;*
  begin(T (&amp;array)[M][N])
  {
    return begin(*array);
  }
  
  template &lt;typename T, size_t M, size_t N&gt;
  constexpr remove_all_extents_t&lt;T&gt;*
  end(T (&amp;array)[M][N])
  {
    return end(array[M - 1]);
  }

  template &lt;typename T, size_t M, size_t N&gt;
  reverse_iterator&lt;remove_all_extents_t&lt;T&gt;*&gt;
  rbegin(T (&amp;array)[M][N])
  {
    return decltype(rbegin(array))(end(array[M - 1]));
  }
  
  template &lt;typename T, size_t M, size_t N&gt;
  reverse_iterator&lt;remove_all_extents_t&lt;T&gt;*&gt;
  rend(T (&amp;array)[M][N])
  {
    return decltype(rend(array))(begin(*array));
  }

}
</pre></blockquote>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2461" href="2461">2461.</a> Interaction between allocators and container exception safety guarantees</h3>
<p><b>Section:</b> 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, 22.3.11.3 <a href="https://timsong-cpp.github.io/cppwp/vector.capacity">[vector.capacity]</a>, 22.3.11.5 <a href="https://timsong-cpp.github.io/cppwp/vector.modifiers">[vector.modifiers]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> dyp <b>Opened:</b> 2014-12-06 <b>Last modified:</b> 2015-06-10 17:42:20 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.requirements">active issues</a> in [allocator.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.requirements">issues</a> in [allocator.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
When resizing a <tt>vector</tt>, the accessibility and exception specification of the value type's 
constructors determines whether the elements are copied or moved to the new buffer.
However, the copy/move is performed via the allocator's <tt>construct</tt> member function, which is 
assumed, but not required, to call the copy/move constructor and propagate only exceptions 
from the value type's copy/move constructor. The issue might also affect other classes. 
<p/>
The current wording in N4296 relevant here is from Table 28 &mdash; "Allocator requirements" in 
16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>: 
</p>
<blockquote>
<table border="1">
<caption>Table 28 &mdash; Allocator requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.construct(c, args)</tt>
</td>
<td>
(not used)
</td>
<td>
<i>Effect</i>: Constructs an object of type <tt>C</tt> at <tt>c</tt>
</td>
<td>
<tt>::new ((void*)c) C(forward&lt;Args&gt;(args)...)</tt>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
<p>
and from 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> p9:
</p>
<blockquote><p>
An allocator may constrain the types on which it can be instantiated and the arguments for which its
<tt>construct</tt> member may be called. If a type cannot be used with a particular allocator, the allocator class
or the call to <tt>construct</tt> may fail to instantiate.
</p></blockquote>
<p>
I conclude the following from the wording:
</p>
<ol>
<li><p>The allocator is not required to call the copy constructor if the
arguments (args) is a single (potentially const) lvalue of the value
type. Similarly for a non-const rvalue + move constructor. See also
22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> p15 which seems to try to require
this, but is not sufficient:
That paragraph specifies the semantics of the allocator's operations,
but not which constructors of the value type are used, if any.
</p></li>
<li>
<p>The allocator may throw exceptions in addition to the exceptions propagated by
the constructors of the value type; it can also propagate exceptions from constructors
other than a copy/move constructor.
</p>
</li>
</ol>
<p>
This leads to an issue with the wording of the exception safety guarantees for vector modifiers in
22.3.11.5 <a href="https://timsong-cpp.github.io/cppwp/vector.modifiers">[vector.modifiers]</a> p1:
</p>
<blockquote>
<p>
[&hellip;]
</p>
<pre>
void push_back(const T&amp; x);
void push_back(T&amp;&amp; x);
</pre>
<blockquote>
<p>
<i>Remarks</i>: Causes reallocation if the new size is greater than the old capacity. If no 
reallocation happens, all the iterators and references before the insertion point remain valid. 
If an exception is thrown other than by the copy constructor, move constructor, assignment 
operator, or move assignment operator of <tt>T</tt> or by any InputIterator operation there are 
no effects.
<span  style="color:#C80000;font-weight:bold">
If an exception is thrown while inserting a single element at the end and <tt>T</tt> 
is <tt>CopyInsertable</tt> or <tt>is_nothrow_move_constructible&lt;T&gt;::value</tt>
is true, there are no effects. Otherwise, if an exception is thrown by the move constructor of a
non-<tt>CopyInsertable</tt> <tt>T</tt>, the effects are unspecified.
</span>
</p>
</blockquote>
</blockquote>
<p>
The wording leads to the following problem:
Copy and move assignment are invoked directly from <tt>vector</tt>.
For intermediary objects (see <a href="2164">2164</a>),
<tt>vector</tt> also directly invokes the copy and move constructor of the value type.
However, construction of the actual element within the buffer is invoked via the allocator abstraction.
As discussed above, the allocator currently is not required to call a copy/move constructor.
If <tt>is_nothrow_move_constructible&lt;T&gt;::value</tt> is <tt>true</tt> for some value type <tt>T</tt>,
but the allocator uses modifying operations for <tt>MoveInsertion</tt> that do throw,
the implementation is required to ensure that "there are no effects",
even if the source buffer has been modified.
<p/>
Similarly, the <tt>vector</tt> capacity functions specify exception safety guarantees
referring to the move constructor of the value type. For example, <tt>vector::resize</tt> in 22.3.11.3 <a href="https://timsong-cpp.github.io/cppwp/vector.capacity">[vector.capacity]</a> p14:
</p>
<blockquote>
<i>Remarks</i>: If an exception is thrown other than by the move constructor of a
non-<tt>CopyInsertable</tt> <tt>T</tt> there are no effects.
</blockquote>
<p>
The wording leads to the same issue as described above.
<p/>
Code example:
</p>
<blockquote>
<pre>
template&lt;class T&gt;
class allocator;

class pot_reg_type // a type which creates
                   // potentially registered instances
{
private:
  friend class allocator&lt;pot_reg_type&gt;;
  struct register_t {};

  static std::set&lt;pot_reg_type*&gt;&amp; get_registry()
  {
    static std::set&lt;pot_reg_type*&gt; registry;
    return registry;
  }
  void enregister() noexcept(false)
  {
    get_registry().insert(this);
  }
  void deregister()
  {
    get_registry().erase(this);
  }

public:
  pot_reg_type(void               ) noexcept(true) {}
  pot_reg_type(pot_reg_type const&amp;) noexcept(true) {}
  pot_reg_type(pot_reg_type&amp;&amp;     ) noexcept(true) {}

private:
  pot_reg_type(register_t                     ) noexcept(false)
  { enregister(); }
  pot_reg_type(register_t, pot_reg_type const&amp;) noexcept(false)
  { enregister(); }
  pot_reg_type(register_t, pot_reg_type&amp;&amp;     ) noexcept(false)
  { enregister(); }
};

template&lt;class T&gt;
class allocator
{
public:
  using value_type = T;

  value_type* allocate(std::size_t p)
  { return (value_type*) ::operator new(p); }

  void deallocate(value_type* p, std::size_t)
  { ::operator delete(p); }

  void construct(pot_reg_type* pos)
  {
    new((void*)pos) pot_reg_type((pot_reg_type::register_t()));
  }
  void construct(pot_reg_type* pos, pot_reg_type const&amp; source)
  {
    new((void*)pos) pot_reg_type(pot_reg_type::register_t(), source);
  }

  template&lt;class... Args&gt;
  void construct(T* p, Args&amp;&amp;... args)
  {
    new((void*)p) T(std::forward&lt;Args&gt;(args)...);
  }
}; 
</pre>
</blockquote>
<p>
The <tt>construct</tt> member function template is only required for rebinding,
which can be required e.g. to store additional debug information in
the allocated memory (e.g. VS2013).
<p/>
Even though the value type has an accessible and <tt>noexcept(true)</tt> move
constructor, this allocator won't call that constructor for rvalue arguments.
In any case, it does not call a constructor for which vector has formulated its 
requirements. An exception thrown by a constructor called by this allocator is not
covered by the specification in 22.3.11.5 <a href="https://timsong-cpp.github.io/cppwp/vector.modifiers">[vector.modifiers]</a> and therefore is
guaranteed not to have any effect on the vector object when resizing.
<p/>
For an example how this might invalidate the exception safety
guarantees, see <a href="https://groups.google.com/a/isocpp.org/d/topic/std-discussion/BcM7ya8JeqY/discussion">this post on the std-discussion mailing list</a>.
<p/>
Another problem arises for value types whose constructors are private,
but may be called by the allocator e.g. via friendship.
Those value types are not <tt>MoveConstructible</tt> 
(<tt>is_move_constructible</tt> is false), yet they can be <tt>MoveInsertable</tt>.
It is not possible for <tt>vector</tt> to create intermediary objects (see <a href="2164">2164</a>) of such a type
by directly using the move constructor.
Current implementations of the single-element forms of <tt>vector::insert</tt> and <tt>vector::emplace</tt>
do create intermediary objects by directly calling one of the value type's constructors,
probably to allow inserting objects from references that alias other elements of the container.
As far as I can see, Table 100 &mdash; "Sequence container requirements" in 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>
does not require that the creation of such intermediare objects can be performed
by containers using the value type's constructor directly.
It is unclear to me if the allocator's construct function could be used to create those
intermediary objects, given that they have not been allocated by the allocator.
<p/>
Two possible solutions:
</p>
<ol>
<li><p>
Add the following requirement to the <tt>allocator_traits::construct</tt> function:
If the parameter pack <tt>args</tt> consists of a single parameter of the type
<tt>value_type&amp;&amp;</tt>,
the function may only propagate exceptions if <tt>is_nothrow_move_constructible&lt;value_type&gt;::value</tt>
is <tt>false</tt>.
<p/>
Requiring <tt>alloctor_traits::construct</tt> to call a true copy/move constructor
of the value type breaks <tt>std::scoped_allocator_adapter</tt>,
as pointed out by <a href="https://groups.google.com/a/isocpp.org/d/msg/std-discussion/0yxikZInp-E/Lxj-msFT22cJ">Casey Carter in a post on the std-discussion mailing list</a>.
</p></li>
<li>
<p>
Change vector's criterion whether to move or copy when resizing:
<p/>
Instead of testing the value type's constructors via
<tt>is_move_constructible</tt>, check the value of
<tt>noexcept( allocator_traits&lt;Allocator&gt;::construct(alloc, ptr, rval) )</tt>
where
<tt>alloc</tt> is an lvalue of type <tt>Allocator</tt>,
<tt>ptr</tt> is an expression of type <tt>allocator_traits&lt;Allocator&gt;::pointer</tt>
and
<tt>rval</tt> is a non-const rvalue of type <tt>value_type</tt>.
</p>
</li>
</ol>
<p>
A short discussion of the two solutions:
<p/>
Solution 1 allows keeping <tt>is_nothrow_move_constructible&lt;value_type&gt;</tt>
as the criterion for <tt>vector</tt> to decide between copying and moving when resizing.
It restricts what can be done inside the <tt>construct</tt> member function of allocators,
and requires implementers of allocators to pay attention to the value types used.
One could conceive allocators checking the following with a <tt>static_assert</tt>:
If the value type <tt>is_nothrow_move_constructible</tt>,
then the constructor actually called for <tt>MoveInsertion</tt> within the <tt>construct</tt>
member function is also declared as noexcept.
<p/>
Solution 2 requires changing both the implementation of the default
allocator (add a conditional <tt>noexcept</tt>) and <tt>vector</tt> (replace
<tt>is_move_constructible</tt> with an allocator-targeted check).
It does not impose additional restrictions on the allocator (other than
22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> p15),
and works nicely even if the move constructor of a <tt>MoveInsertable</tt> type is private or deleted
(the allocator might be a friend of the value type).
<p/>
In both cases, an addition might be required to provide the basic exception safety guarantee.
A short discussion on this topic can be found
<a href="https://groups.google.com/a/isocpp.org/d/topic/std-discussion/yZLnYy_y2z0/discussion">
in the std-discussion mailing list</a>.
Essentially, if <tt>allocator_traits&lt;Allocator&gt;::construct</tt> throws an exception,
the object may or may not have been constructed.
Two solutions are mentioned in that discussion:
</p>
<ol>
<li><p>
<tt>allocator_traits&lt;Allocator&gt;::construct</tt> needs to tell its caller
whether or not the construction was successful, in case of an exception.
</p></li>
<li><p>
If <tt>allocator_traits&lt;Allocator&gt;::construct</tt> propagates an exception,
it shall either not have constructed an object at the specified location,
or that object shall have been destroyed
(or it shall ensure otherwise that no resources are leaked).
</p></li>
</ol>

<p><i>[2015-05-23, Tomasz Kami&nacute;ski comments]</i></p>

<p>
Solution 1 discussed in this issue also breaks support for the <tt>polymorphic_allocator</tt> proposed in the part 
of the Library Fundamentals TS v1, in addition to already mentioned <tt>std::scoped_allocator_adapter</tt>. Furthermore 
there is unknown impact on the other user-defined state-full allocators code written in the C++11.
<p/>
In addition the library resolution proposed in the LWG issues <a href="2089">2089</a> and 
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4462.html">N4462</a>, 
will break the relation between the <tt>std::allocator_trait::construct</tt> method and 
copy/move constructor even for the standard <tt>std::allocator</tt>. As example please consider following class:
</p>
<blockquote><pre>
struct NonCopyable
{
  NonCopyable() = default;
  NonCopyable(NonCopyable const&amp;) = delete;
  NonCopyable(NonCopyable&amp;&amp;) = delete;
};

struct InitListConstructor : NonCopyable
{
  InitListConstructor() = default;
  InitListConstructor(std::initializer_list&lt;int&gt;);
  operator int() const;
};
</pre></blockquote>
<p>
For the above declarations following expression are ill-formed:
</p>
<blockquote><pre>
InitListConstructor copy(std::declval&lt;InitListConstructor const&amp;&gt;());
InitListConstructor move(std::declval&lt;InitListConstructor&amp;&amp;&gt;());
</pre></blockquote>
<p>
So the class is not <tt>CopyConstructible</tt> nor <tt>MoveConstructible</tt>. However the following are well formed:
</p>
<blockquote><pre>
InitListConstructor copy{std::declval&lt;InitListConstructor const&amp;&gt;()};
InitListConstructor move{std::declval&lt;InitListConstructor&amp;&amp;&gt;()};
</pre></blockquote>
<p>
And will be used by <tt>std::allocator&lt;InitListConstructor&gt;::construct</tt> in case of move-insertion 
and copy-insertion, after appliance of the resolution proposed in mentioned papers:
</p>
<blockquote>
<p>
The gist of the proposed library fix is simple:
</p>
<ul>
<li><p>if <tt>is_constructible_v&lt;TargetType, Args...&gt;</tt>, use direct-nonlist-initialization</p></li>
<li><p>otherwise, use brace-initialization.</p></li>
</ul>
</blockquote>
<p>
As consequence the requirement proposed in the Solution 1:
</p>
<blockquote><p>
If the parameter pack <tt>args</tt> consists of a single parameter of the type <tt>value_type&amp;&amp;</tt>, 
the function may only propagate exceptions if <tt>is_nothrow_move_constructible&lt;value_type&gt;::value</tt> is false. 
</p></blockquote>
<p>
Will no longer hold for the <tt>std::allocator</tt>.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2471" href="2471">2471.</a> <tt>copy_n</tt>'s number of <tt>InputIterator</tt> increments unspecified</h3>
<p><b>Section:</b> 25.6.1 <a href="https://timsong-cpp.github.io/cppwp/alg.copy">[alg.copy]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-01-28 <b>Last modified:</b> 2018-06-22 06:38:21 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#alg.copy">active issues</a> in [alg.copy].</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.copy">issues</a> in [alg.copy].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It's unspecified how many times <tt>copy_n</tt> increments the <tt>InputIterator</tt>.
<tt>uninitialized_copy_n</tt> is specified to increment it exactly <tt>n</tt> times,
which means if an <tt>istream_iterator</tt> is used then the next character
after those copied is read from the stream and then discarded, losing data.
<p/>
I believe all three of Dinkumware, libc++ and libstdc++ implement
<tt>copy_n</tt> with <tt>n - 1</tt> increments of the <tt>InputIterator</tt>, which avoids reading
and discarding a character when used with <tt>istream_iterator</tt>, but is
inconsistent with <tt>uninitialized_copy_n</tt> and causes surprising behaviour
with <tt>istreambuf_iterator</tt> instead, because <tt>copy_n(in, 2, copy_n(in, 2,
out))</tt> is not equivalent to <tt>copy_n(in, 4, out)</tt>
</p>

<p><i>[2016-08 Chicago]</i></p>

<p>Tues PM: refer to LEWG</p>

<p><i>[LEWG Kona 2017]</i></p>

<p>This is a mess. Append to Effects: If the InputIterator is not a forward iterator, increments n-1 times. Otherwise the number of increments is not more than n. (ncm) The preceding proposition is unsatisfactory, because it is wrong for istreambuf_iterator, which is much more useful than istream_iterator. Proposing instead: Append to Effects: If InputIterator is istream_iterator for some T, increments n-1 times. Otherwise, increments n times. Want a paper exploring what the implementations actually do, and what non-uniformity is "right".</p>
<p>Status to Open</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2472" href="2472">2472.</a> Heterogeneous comparisons in the standard library can result in ambiguities</h3>
<p><b>Section:</b> 20.5.8 <a href="https://timsong-cpp.github.io/cppwp/tuple.rel">[tuple.rel]</a>, 20.10.10.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.globals">[allocator.globals]</a>, 20.11.1.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.special">[unique.ptr.special]</a>, 20.11.3.7 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.cmp">[util.smartptr.shared.cmp]</a>, 27.5.6 <a href="https://timsong-cpp.github.io/cppwp/time.duration.comparisons">[time.duration.comparisons]</a>, 27.6.6 <a href="https://timsong-cpp.github.io/cppwp/time.point.comparisons">[time.point.comparisons]</a>, 20.13.5 <a href="https://timsong-cpp.github.io/cppwp/scoped.adaptor.operators">[scoped.adaptor.operators]</a>, 99 [reverse.iter.op==], 23.5.3.7 <a href="https://timsong-cpp.github.io/cppwp/move.iter.op.comp">[move.iter.op.comp]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2015-02-07 <b>Last modified:</b> 2015-05-05 12:24:28 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#tuple.rel">active issues</a> in [tuple.rel].</p>
<p><b>View all other</b> <a href="lwg-index.html#tuple.rel">issues</a> in [tuple.rel].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The standard library specifies a lot of heterogeneous comparison operators. For instance:
</p>
<blockquote>
<pre>
template&lt;class... TTypes, class... UTypes&gt;
constexpr bool operator!=(const tuple&lt;TTypes...&gt;&amp;, const tuple&lt;UTypes...&gt;&amp;);
</pre>
</blockquote>
<p>
This has an unfortunate consequence:
</p>
<blockquote>
<pre>
#include &lt;tuple&gt;
#include &lt;utility&gt;

using namespace std::rel_ops;
std::tuple&lt;int&gt; a(0);
bool b = a != a;
</pre>
</blockquote>
<p>
The last line here is ill-formed due to ambiguity: it might be <tt>rel_ops::operator!=</tt>, and it might be the 
heterogeneous tuple <tt>operator!=</tt>. These are not partially ordered, because they have different constraints: 
<tt>rel_ops</tt> requires the types to match, whereas the tuple comparison requires both types to be tuples (but not 
to match). The same thing happens for user code that defines its own unconstrained 
'<tt>template&lt;typename T&gt; operator!=(const T&amp;, const T&amp;)</tt>' rather than using <tt>rel_ops</tt>.
<p/>
One straightforward fix would be to add a homogeneous overload for each heterogeneous comparison:
</p>
<blockquote>
<pre>
template&lt;class... TTypes&gt;
constexpr bool operator!=(const tuple&lt;TTypes...&gt;&amp;, const tuple&lt;TTypes...&gt;&amp;);
</pre>
<p>
This is then unambiguously chosen over the other options in the preceding case. FWIW, libstdc++ already does this 
<a href="https://gcc.gnu.org/onlinedocs/gcc-4.6.4/libstdc++/api/a01065_source.html#l00788">in some cases</a>.
</p>
</blockquote>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2478" href="2478">2478.</a> Unclear how <tt>wstring_convert</tt> uses <tt>cvtstate</tt></h3>
<p><b>Section:</b> D.17.1 <a href="https://timsong-cpp.github.io/cppwp/depr.conversions.string">[depr.conversions.string]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-03-04 <b>Last modified:</b> 2017-04-22 20:23:31 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#depr.conversions.string">active issues</a> in [depr.conversions.string].</p>
<p><b>View all other</b> <a href="lwg-index.html#depr.conversions.string">issues</a> in [depr.conversions.string].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
How do <tt>wstring_convert::from_bytes</tt> and <tt>wstring_convert::to_bytes</tt> use
the <tt>cvtstate</tt> member?
<p/>
Is it passed to the <tt>codecvt</tt> member functions? Is a copy of it passed
to the member functions? "Otherwise it shall be left unchanged"
implies a copy is used, but if that's really what's intended there are
simpler ways to say so.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2479" href="2479">2479.</a> Unclear how <tt>wbuffer_convert</tt> uses <tt>cvtstate</tt></h3>
<p><b>Section:</b> D.17.2 <a href="https://timsong-cpp.github.io/cppwp/depr.conversions.buffer">[depr.conversions.buffer]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-03-04 <b>Last modified:</b> 2017-04-22 20:23:31 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#depr.conversions.buffer">active issues</a> in [depr.conversions.buffer].</p>
<p><b>View all other</b> <a href="lwg-index.html#depr.conversions.buffer">issues</a> in [depr.conversions.buffer].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
How does <tt>wbuffer_convert</tt> use the <tt>cvtstate</tt> member?
<p/>
Is the same conversion state object used for converting both the get
and put areas? That means a read which runs out of bytes halfway 
through a multibyte character will leave some shift state in cvtstate, 
which would then be used by a following write, even though the shift 
state of the get area is unrelated to the put area.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2480" href="2480">2480.</a> Error handling of <tt>wbuffer_convert</tt> unclear</h3>
<p><b>Section:</b> D.17.2 <a href="https://timsong-cpp.github.io/cppwp/depr.conversions.buffer">[depr.conversions.buffer]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-03-04 <b>Last modified:</b> 2017-04-22 20:23:31 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#depr.conversions.buffer">active issues</a> in [depr.conversions.buffer].</p>
<p><b>View all other</b> <a href="lwg-index.html#depr.conversions.buffer">issues</a> in [depr.conversions.buffer].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
If a <tt>codecvt</tt> conversion returns <tt>codecvt_base::error</tt> should that be
treated as <tt>EOF</tt>? An exception? Should all the successfully converted
characters before a conversion error be available to the users of the
<tt>wbuffer_convert</tt> and/or the internal <tt>streambuf</tt>, or does a conversion
error lose information?
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2481" href="2481">2481.</a> <tt>wstring_convert</tt> should be more precise regarding "byte-error string" etc.</h3>
<p><b>Section:</b> D.17.1 <a href="https://timsong-cpp.github.io/cppwp/depr.conversions.string">[depr.conversions.string]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-03-04 <b>Last modified:</b> 2017-04-22 20:23:31 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#depr.conversions.string">active issues</a> in [depr.conversions.string].</p>
<p><b>View all other</b> <a href="lwg-index.html#depr.conversions.string">issues</a> in [depr.conversions.string].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Paragraph 4 of D.17.1 <a href="https://timsong-cpp.github.io/cppwp/depr.conversions.string">[depr.conversions.string]</a> introduces <tt>byte_err_string</tt> 
as "a byte string to display on errors". What does display mean? The string is returned 
on error, it's not displayed anywhere.
<p/>
Paragraph 14 says "Otherwise, if the object was constructed with a
byte-error string, the member function shall return the byte-error
string." The term byte-error string is not used anywhere else.
<p/>
Paragraph 17 talks about storing "default values in <tt>byte_err_string</tt>".
What default value? Is "Hello, world!" allowed? If it means
default-construction it should say so. If paragraph 14 says it won't
be used what does it matter how it's initialized? The end of the
paragraph refers to storing "<tt>byte_err</tt> in <tt>byte_err_string</tt>". This should
be more clearly related to the wording in paragraph 14.
<p/>
It might help if the constructor (and destructor) was specified before
the other member functions, so it can more formally define the
difference between being "constructed with a byte-error string" and
not.
<p/>
All the same issues apply to the <tt>wide_err_string</tt> member.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2490" href="2490">2490.</a> <tt>&lt;regex&gt;</tt> needs lots of <tt>noexcept</tt></h3>
<p><b>Section:</b> 30 <a href="https://timsong-cpp.github.io/cppwp/re">[re]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2015-03-27 <b>Last modified:</b> 2015-05-05 12:24:28 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re">active issues</a> in [re].</p>
<p><b>View all other</b> <a href="lwg-index.html#re">issues</a> in [re].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Only 4 functions are marked <tt>noexcept</tt> in all of Clause 28. Many more need to be marked &mdash; for example, 
<tt>regex_error::code()</tt>, <tt>basic_regex::swap()</tt>, and <tt>sub_match::length()</tt>.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2491" href="2491">2491.</a> <tt>std::less&lt;T*&gt;</tt> in constant expression</h3>
<p><b>Section:</b> 20.14.7 <a href="https://timsong-cpp.github.io/cppwp/comparisons">[comparisons]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2015-04-01 <b>Last modified:</b> 2017-01-23 18:51:23 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#comparisons">active issues</a> in [comparisons].</p>
<p><b>View all other</b> <a href="lwg-index.html#comparisons">issues</a> in [comparisons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It is not entirely clear if and when the specializations of <tt>std::less</tt> (and friends) for pointer types 
can be used in a constant expression. Consider the following code:
</p>
<blockquote><pre>
#include &lt;functional&gt;

struct foo {};
foo x, y;
constexpr bool b = std::less&lt;foo*&gt;{}(&amp;x, &amp;y); // [1]

foo z[] = {{}, {}};
constexpr bool ba = std::less&lt;foo*&gt;{}(&amp;z[0], &amp;z[1]); // [2]
</pre></blockquote>
<p>
Comparing the address of unrelated objects is not a constant expression since the result is unspecified, so 
it could be expected for [1] to fail and [2] to succeed. However, <tt>std::less</tt> specialization for pointer 
types is well-defined and yields a total order, so it could just as well be expected for [1] to succeed. Finally, 
since the implementation of such specializations is not mandated, [2] could fail as well (This could happen, if
an implementation would provide such a specialization and if that would use built-in functions that would not be
allowed in constant expressions, for example). In any case, the standard should be clear so as to avoid 
implementation-defined <tt>constexpr</tt>-ness.
</p>

<p><i>[2017-01-22, Jens provides rationale and proposed wording]</i></p>

<p>
<tt>std::less&lt;T*&gt;</tt> is required to deliver a total order on pointers.
However, the layout of global objects is typically determined
by the linker, not the compiler, so requiring <tt>std::less&lt;T*&gt;</tt> to
provide an ordering at compile-time that is consistent with
run-time would need results from linking to feed back to
the compiler, something that C++ has traditionally not required.
</p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4618">N4618</a>.</p>

<ol>
<li><p>Add at the end of 20.14.7 <a href="https://timsong-cpp.github.io/cppwp/comparisons">[comparisons]</a>:</p>
<blockquote>
<p>
-2- For templates <tt>less</tt>, <tt>greater</tt>, <tt>less_equal</tt>, and <tt>greater_equal</tt>, [&hellip;], 
if the call operator calls a built-in operator comparing pointers, the call operator yields a strict total order 
that is consistent among those specializations and is also consistent with the partial order imposed by those 
built-in operators. <ins>Relational comparisons of pointer values are not required to be usable as constant expressions.</ins>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2493" href="2493">2493.</a> <tt>initializer_list</tt> supports incomplete classes</h3>
<p><b>Section:</b> 17.10 <a href="https://timsong-cpp.github.io/cppwp/support.initlist">[support.initlist]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> David Krauss <b>Opened:</b> 2015-04-27 <b>Last modified:</b> 2015-05-05 12:24:28 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#support.initlist">active issues</a> in [support.initlist].</p>
<p><b>View all other</b> <a href="lwg-index.html#support.initlist">issues</a> in [support.initlist].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The typical use-case of <tt>std::initializer_list&lt;T&gt;</tt> is for a pass-by-value parameter of <tt>T</tt>'s constructor. 
However, this contravenes 16.5.4.8 <a href="https://timsong-cpp.github.io/cppwp/res.on.functions">[res.on.functions]</a>/2.5 because <tt>initializer_list</tt> doesn't specifically allow 
incomplete types (as do for example <tt>std::unique_ptr</tt> (20.11.1 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr">[unique.ptr]</a>/5) and 
<tt>std::enable_shared_from_this</tt> (20.11.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.enab">[util.smartptr.enab]</a>/2)).
<p/>
A resolution would be to copy-paste the relevant text from such a paragraph.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2496" href="2496">2496.</a> Certain hard-to-avoid errors not in the immediate context are not allowed to be triggered by 
the evaluation of type traits</h3>
<p><b>Section:</b> 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2015-05-07 <b>Last modified:</b> 2015-08-03 14:47:06 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.unary.prop">active issues</a> in [meta.unary.prop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.unary.prop">issues</a> in [meta.unary.prop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I do not believe that the wording in 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> paragraph 3 allows for the following program to be ill-formed:
</p>
<blockquote>
<pre>
#include &lt;type_traits&gt;

template &lt;typename T&gt; struct B : T { };
template &lt;typename T&gt; struct A { A&amp; operator=(const B&lt;T&gt;&amp;); };

std::is_assignable&lt;A&lt;int&gt;, int&gt; q;
</pre>
</blockquote>
<p>
In particular, I do not see where the wording allows for the "compilation of the expression" 
<tt>declval&lt;T&gt;() = declval&lt;U&gt;()</tt> to occur as a consequence of instantiating <tt>std::is_assignable&lt;T, U&gt;</tt> 
(where <tt>T</tt> and <tt>U</tt> are, respectively, <tt>A&lt;int&gt;</tt> and <tt>int</tt> in the example code).
<p/>
Instantiating <tt>A&lt;int&gt;</tt> as a result of requiring it to be a complete type does not trigger the instantiation of 
<tt>B&lt;int&gt;</tt>; however, the "compilation of the expression" in question does.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2497" href="2497">2497.</a> Use of <tt>uncaught_exception()</tt></h3>
<p><b>Section:</b> 29.7.5.1.3 <a href="https://timsong-cpp.github.io/cppwp/ostream.sentry">[ostream.sentry]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Roger Orr <b>Opened:</b> 2015-05-08 <b>Last modified:</b> 2019-03-26 18:05:13 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In the current 29.7.5.1.3 <a href="https://timsong-cpp.github.io/cppwp/ostream.sentry">[ostream.sentry]</a>, p4 refers to the now deprecated <tt>std::uncaught_exception()</tt>: 
D.9 [depr.uncaught].
</p>
<blockquote>
<p>
If <tt>((os.flags() &amp; ios_base::unitbuf) &amp;&amp; !uncaught_exception() &amp;&amp; os.good())</tt> is true, calls
<tt>os.rdbuf()->pubsync()</tt>.
</p>
</blockquote>
<p>
This needs to be changed, for example to use <tt>std::uncaught_exceptions()</tt> and to capture the value on entry and 
compare with the saved value on exit.
</p>

<p><i>[2015-06, Telecon]</i></p>

<p>
JW: I already added an 's' here to make it use the new function, but that doesn't resolve Roger's suggestion to capture the value on entry and check it.
</p>

<p><i>[2019-03-21; Daniel comments and provides wording]</i></p>

<p>
The wording below implements Roger's suggestion.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 29.7.5.1.3 <a href="https://timsong-cpp.github.io/cppwp/ostream.sentry">[ostream.sentry]</a>, class <tt>basic_ostream::sentry</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;class charT, class traits = char_traits&lt;charT&gt;&gt;
  class basic_ostream&lt;charT, traits&gt;::sentry {
    bool ok_; <i>// exposition only</i>
    <ins>int uncaught_ = uncaught_exceptions(); <i>// exposition only</i></ins>
  public:
    explicit sentry(basic_ostream&lt;charT, traits&gt;&amp; os);
    ~sentry();
    explicit operator bool() const { return ok_; }
    sentry(const sentry&amp;) = delete;
    sentry&amp; operator=(const sentry&amp;) = delete;
  };
}
</pre>
<p>
[&hellip;]
</p>
<pre>
~sentry();
</pre>
<blockquote>
<p>
-4- If <tt>(os.flags() &amp; ios_base::unitbuf) &amp;&amp; <del>!</del>uncaught_exceptions() <ins>&lt;= uncaught_</ins> 
&amp;&amp; os.good()</tt> is <tt>true</tt>, calls <tt>os.rdbuf()-&gt;pubsync()</tt>. If that function returns <tt>-1</tt>, 
sets <tt>badbit</tt> in <tt>os.rdstate()</tt> without propagating an exception.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2498" href="2498">2498.</a> <tt>operator&gt;&gt;(basic_istream&amp;&amp;, T&amp;&amp;)</tt> returns <tt>basic_istream&amp;</tt>, but should probably return 
<tt>basic_istream&amp;&amp;</tt></h3>
<p><b>Section:</b> 29.7.4.5 <a href="https://timsong-cpp.github.io/cppwp/istream.rvalue">[istream.rvalue]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2015-05-08 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#istream.rvalue">issues</a> in [istream.rvalue].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Consider:
</p>
<blockquote>
<pre>
auto&amp; is = make_istream() &gt;&gt; x; // oops, istream object is already gone
</pre>
</blockquote>
<p>
With a <tt>basic_istream&amp;&amp;</tt> return type, the above would be ill-formed, and generally we'd 
preserve the value category properly.
</p>

<p><i>[2015-06, Telecon]</i></p>

<p>
JW: think this needs proper consideration, it would make <pre>stream() &gt;&gt; x &gt;&gt; y &gt;&gt; z</pre> go from 3 operator&gt;&gt; calls to 6 operator&gt;&gt; calls, and wouldn't prevent dangling references (change the example to auto&amp;&amp;) <br/>
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2504" href="2504">2504.</a> <tt>basic_streambuf</tt> is not an abstract class</h3>
<p><b>Section:</b> 29.6.3 <a href="https://timsong-cpp.github.io/cppwp/streambuf">[streambuf]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-05-28 <b>Last modified:</b> 2015-08-03 14:47:06 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#streambuf">issues</a> in [streambuf].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
29.6.3 <a href="https://timsong-cpp.github.io/cppwp/streambuf">[streambuf]</a> p1 says:
</p>
<blockquote><p>
The class template <tt>basic_streambuf&lt;charT, traits&gt;</tt> serves as an abstract base class for deriving various
stream buffers whose objects each control two character sequences: [&hellip;]
</p></blockquote>
<p>
The term "abstract base class" is not defined in the standard, but "abstract class" is (11.7.3 <a href="https://timsong-cpp.github.io/cppwp/class.abstract">[class.abstract]</a>).
<p/>
According to the synopsis <tt>basic_streambuf</tt> has no pure virtual
functions so is not an abstract class and none of libstdc++, libc++, or
dinkumware implement it as an abstract class. I don't believe the wording was
ever intended to require it to be an abstract class, but it could be
read that way.
<p/>
I suggest the wording be changed to "polymorphic base class" or
something else that can't be seen to imply a normative requirement to
make it an abstract class.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2506" href="2506">2506.</a> Underspecification of atomics</h3>
<p><b>Section:</b> 6.9.2 <a href="https://timsong-cpp.github.io/cppwp/intro.multithread">[intro.multithread]</a>, 31.8 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.generic">[atomics.types.generic]</a>, 17.13 <a href="https://timsong-cpp.github.io/cppwp/support.runtime">[support.runtime]</a> <b>Status:</b> <a href="lwg-active.html#SG1">SG1</a>
 <b>Submitter:</b> Geoffrey Romer <b>Opened:</b> 2015-05-29 <b>Last modified:</b> 2018-03-15 18:21:02 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#intro.multithread">issues</a> in [intro.multithread].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#SG1">SG1</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The concurrency libraries specified in clauses 29 and 30 do not adequately specify how they relate to the concurrency model 
specified in 6.9.2 <a href="https://timsong-cpp.github.io/cppwp/intro.multithread">[intro.multithread]</a>. In particular:
<p/>
6.9.2 <a href="https://timsong-cpp.github.io/cppwp/intro.multithread">[intro.multithread]</a> specifies "atomic objects" as having certain properties. I can only assume that instances 
of the classes defined in Clause 29 are intended to be "atomic objects" in this sense, but I can't find any wording to 
specify that, and it's genuinely unclear whether Clause 30 objects are atomic objects. In fact, on a literal reading the 
C++ Standard doesn't appear to provide <em>any</em> portable way to create an atomic object, or even determine whether an 
object is an atomic object.
<p/>
(It's not clear if the term "atomic object" is actually needed, given that atomic objects can have non-atomic operations, 
and non-atomic objects can have atomic operations. But even if the term itself goes away, there still needs to be some 
indication that Clause 29 objects have the properties currently attributed to atomic objects).
<p/>
Similarly, 6.9.2 <a href="https://timsong-cpp.github.io/cppwp/intro.multithread">[intro.multithread]</a> uses "atomic operation" as a term of art, but the standard never unambiguously 
identifies any operation as an "atomic operation" (although in one case it unambiguously identifies an operation that is 
<em>not</em> atomic). It does come close in a few cases, but not close enough:
</p>
<ul>
<li><p>6.9.2 <a href="https://timsong-cpp.github.io/cppwp/intro.multithread">[intro.multithread]</a>/p7 could be read to imply that "synchronization operations" in Clauses 29 and 30 
are also atomic operations. However, that's vague and indirect, and somewhat belied by 32.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements.mutex">[thread.mutex.requirements.mutex]</a>/p5, 
which specifies that mutex lock and unlock operations "behave as atomic operations", but only "for purposes of determining 
the existence of a data race". Furthermore, not a single operation in Clause 29 explicitly identifies itself as a 
"synchronization operation".</p></li>
<li><p>31.8 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.generic">[atomics.types.generic]</a>/p4 states in part that "There shall be a specialization <tt>atomic&lt;bool&gt;</tt> 
which provides the general atomic operations as specified in 29.6.1", but read in context, "general atomic operations" 
appears to be a loose synonym for "general operations on atomic types" as defined in  [atomics.types.operations.general], 
rather than a use of "atomic object" as Words of Power. Incidentally, "atomic type" is never satisfactorily defined either 
(although the <tt>&lt;atomic&gt;</tt> synopsis comes close).</p></li>
<li><p>17.13 <a href="https://timsong-cpp.github.io/cppwp/support.runtime">[support.runtime]</a>/p10 specifies exactly which operations are "plain lock-free atomic operations", but 
in a standard where an "integral constant expression" isn't necessarily a "constant expression", I do not feel safe assuming 
that a "plain lock-free atomic operation" is an "atomic operation".</p></li>
<li><p>Hans Boehm tells me the operations with "atomically" in the Effects element are intended to be atomic operations, 
but since "atomic operation" is a term of art (e.g. in 6.9.2 <a href="https://timsong-cpp.github.io/cppwp/intro.multithread">[intro.multithread]</a>/p27.4), I think this needs to be 
spelled out rather than assumed. Furthermore, this does not help with 31.11 <a href="https://timsong-cpp.github.io/cppwp/atomics.fences">[atomics.fences]</a>, or anything in Clause 30.</p></li>
</ul>

<p><i>[2018-03 JAX; Geoffrey comments in behalf of SG1]</i></p>

<p>
SG1 consensus is that operations outside clause 32 are not "atomic operations", and objects of types defined outside clause 32 are not "atomic objects". "Synchronization operations" are operations which act as endpoints of primitive edges of partial orders other than sequenced-before, but it may make more sense to just drop that term and inline the definition, so to speak.
<p/>
We would welcome a paper to make those definitions more explicit, and revise the wording as needed to be consistent with those definitions.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2507" href="2507">2507.</a> <tt>codecvt_mode</tt> should be a bitmask type</h3>
<p><b>Section:</b> D.16 <a href="https://timsong-cpp.github.io/cppwp/depr.locale.stdcvt">[depr.locale.stdcvt]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-06-08 <b>Last modified:</b> 2017-04-22 20:23:31 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#depr.locale.stdcvt">issues</a> in [depr.locale.stdcvt].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The enumeration type <tt>codecvt_mode</tt> is effectively a bitmask type
(16.4.2.2.4 <a href="https://timsong-cpp.github.io/cppwp/bitmask.types">[bitmask.types]</a>) with three elements, but isn't defined as
such.
<p/>
This harms usability because bitmask types are required to work well
with bitwise operators, but <tt>codecvt_mode</tt> doesn't have overloaded
operators, making it very inconvenient to combine values:
</p>
<blockquote><pre>
std::codecvt_utf16&lt;char32_t, 0x10FFFF,
  static_cast&lt;std::codecvt_mode&gt;(std::little_endian|std::generate_header)&gt;
cvt;
</pre></blockquote>
<p>
The <tt>static_cast</tt> harms readability and should not be necessary.
<p/>
I suggest that either <tt>codecvt_mode</tt> is specified to be a bitmask type,
or as a minimal fix we provide an overloaded <tt>operator|</tt> that returns
the right type.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2508" href="2508">2508.</a> &sect;[new.delete.dataraces] wording needs to be updated</h3>
<p><b>Section:</b> 17.6.2.4 <a href="https://timsong-cpp.github.io/cppwp/new.delete.dataraces">[new.delete.dataraces]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hans Boehm <b>Opened:</b> 2015-06-09 <b>Last modified:</b> 2016-02-01 11:19:56 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#new.delete.dataraces">issues</a> in [new.delete.dataraces].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
17.6.2.4 <a href="https://timsong-cpp.github.io/cppwp/new.delete.dataraces">[new.delete.dataraces]</a> uses obsolete wording.
<p/>
It should introduce a "synchronizes with" relationship. "Happens before" is too weak, since that may not composes 
with sequenced before.
<p/>
The "shall not introduce a data race" wording is probably not technically correct either. These may race with other 
(non-allocation/deallocation) concurrent accesses to the object being allocated or deallocated.
</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2512" href="2512">2512.</a> Y2K bites; what is an "unambiguous year identifier"?</h3>
<p><b>Section:</b> 28.4.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get.virtuals">[locale.time.get.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2015-06-19 <b>Last modified:</b> 2017-09-07 13:59:44 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#locale.time.get.virtuals">active issues</a> in [locale.time.get.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#locale.time.get.virtuals">issues</a> in [locale.time.get.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I recently encountered a failure related to questionable use of <tt>do_get_year</tt>. The platform where the code happened 
to work had an implementation which handled certain three-digit "year identifiers" as the number of years since 
1900 (<a href="http://www.drdobbs.com/cpp/remembering-y2k/228701726">this article</a> describes such an implementation).
<p/>
28.4.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get.virtuals">[locale.time.get.virtuals]</a> makes it implementation defined whether two-digit years are accepted, etc., but does not 
say anything specifically about three-digit years.
<p/>
The implementation freedom to not report errors in 28.4.5.1 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get">[locale.time.get]</a> paragraph 1 also seems to be too broad.
<p/>
See also the discussion following <a href="http://listarchives.isocpp.org/cgi-bin/wg21/message?wg=lib&amp;msg=38042">c++std-lib-38042</a>.
</p>

<p><i>[2016-08 Chicago]</i></p>

<p>Wed PM: This has been this way since C++98. Don't think it's a P2.</p>
<p>Change to P4, and move to Open.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2513" href="2513">2513.</a> Missing requirements for <tt>basic_string::value_type</tt></h3>
<p><b>Section:</b> 21.1 <a href="https://timsong-cpp.github.io/cppwp/strings.general">[strings.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2015-06-26 <b>Last modified:</b> 2016-06-28 20:06:06 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#strings.general">issues</a> in [strings.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The allocator-aware container requirements in Table 98 impose no
<tt>MoveAssignable</tt> requirements on the <tt>value_type</tt> when
<tt>propagate_on_container_move_assignment</tt> is true, because typically the
container's storage would be moved by just exchanging some pointers.
<p/>
However for a <tt>basic_string</tt> using the small string optimization move
assignment may need to assign individual characters into the small
string buffer, even when the allocator propagates.
<p/>
The only requirement on the char-like objects stored in a <tt>basic_string</tt>
are that they are non-array POD types and <tt>Destructible</tt>, which means
that a POD type with a deleted move assignment operator should be
usable in a <tt>basic_string</tt>, despite it being impossible to move assign:
</p>
<blockquote><pre>
#include &lt;string&gt;

struct odd_pod 
{
  odd_pod() = default;
  odd_pod&amp; operator=(odd_pod&amp;&amp;) = delete;
};

static_assert(std::is_pod&lt;odd_pod&gt;::value, "POD");

int main()
{
  using S = std::basic_string&lt;odd_pod&gt;;
  S s;
  s = S{};       // fails
}
</pre></blockquote>
<p>
Using libstdc++ <tt>basic_string&lt;odd_pod&gt;</tt> cannot even be
default-constructed because the constructor attempts to assign the
null terminator to the first element of the small string buffer.
<p/>
Similar problems exist with POD types with a deleted default constructor.
<p/>
I believe that <tt>basic_string</tt> should require its <tt>value_type</tt> to be at
least <tt>DefaultConstructible</tt> and <tt>MoveAssignable</tt>.
</p>

<p><i>[2016-06, Oulu]</i></p>

<p>This should be resolved by <a href="http://wg21.link/P0178">P0178</a></p>
<p>Note: P0178 was sent back to LEWG in Oulu.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2524" href="2524">2524.</a> <tt>generate_canonical</tt> can occasionally return 1.0</h3>
<p><b>Section:</b> 26.6.8.4.2 <a href="https://timsong-cpp.github.io/cppwp/rand.dist.pois.exp">[rand.dist.pois.exp]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Michael Pr&auml;hofer <b>Opened:</b> 2015-08-20 <b>Last modified:</b> 2018-08-22 12:55:05 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>Original title was: <tt>exponential_distribution&lt;float&gt;</tt> sometimes returns inf.</p>

<p>
The random number distribution class template <tt>exponential_distribution&lt;float&gt;</tt> may return "inf" as can be seen from the following example program:
</p>
<blockquote>
<pre>
// compiled with
// g++ -std=c++11 Error_exp_distr.cpp

#include &lt;iostream&gt;
#include &lt;random&gt;
#include &lt;bitset&gt;

int main(){
  unsigned long long h;
  std::mt19937_64 mt1(1);
  std::mt19937_64 mt2(1);
  mt1.discard(517517);
  mt2.discard(517517);
  std::exponential_distribution&lt;float&gt; dis(1.0);
  h = mt2();
  std::cout &lt;&lt; std::bitset&lt;64&gt;(h) &lt;&lt; " " &lt;&lt; (float) -log(1 - h/pow(2, 64)) &lt;&lt; " " 
            &lt;&lt; -log(1 - (float) h/pow(2, 64)) &lt;&lt; " " &lt;&lt; dis(mt1) &lt;&lt; std::endl;
  h = mt2();
  std::cout &lt;&lt; std::bitset&lt;64&gt;(h) &lt;&lt; " " &lt;&lt; (float) -log(1 - h/pow(2, 64)) &lt;&lt; " " 
            &lt;&lt; -log(1 - (float) h/pow(2, 64)) &lt;&lt; " " &lt;&lt; dis(mt1) &lt;&lt; std::endl;
}
</pre>
</blockquote>
<p>
output:
</p>
<blockquote>
<pre>
0110010110001001010011000111000101001100111110100001110011100001 0.505218 0.505218 0.505218
1111111111111111111111111101010011000110011110011000110101100110 18.4143 inf inf
</pre>
</blockquote>
<p>
The reason seems to be that converting a <tt>double x</tt> in the range <tt>[0, 1)</tt> to <tt>float</tt> may result in <tt>1.0f</tt> 
if <tt>x</tt> is close enough to <tt>1</tt>. I see two possibilities to fix that:
</p>
<ol>
<li><p>use internally <tt>double</tt> (or <tt>long double</tt>?) and then convert the result at the very end to <tt>float</tt>.</p></li>
<li><p>take only 24 random bits and convert them to a <tt>float x</tt> in the range <tt>[0, 1)</tt> and then return <tt>-log(1 - x)</tt>.</p></li>
</ol>

<p>
I have not checked if <tt>std::exponential_distribution&lt;double&gt;</tt> has the same problem:
For <tt>float</tt> on the average 1 out of 2<sup>24</sup> (~10<sup>7</sup>) draws returns "inf", which is easily confirmed.
For <tt>double</tt> on the average 1 out of 2<sup>53</sup> (~10<sup>16</sup>) draws might return "inf", which I have not tested.
</p>

<p><b>Marshall:</b><br/>
I don't think the problem is in <tt>std::exponential_distribution</tt>; but rather in <tt>generate_canonical</tt>.
</p>

<p>Consider:
<blockquote><pre>
std::mt19937_64 mt2(1);
mt2.discard(517517);
std::cout &lt;&lt; std::hexfloat &lt;&lt; std::generate_canonical&lt;float, std::numeric_limits&lt;float&gt;::digits&gt;(mt2) &lt;&lt; std::endl;
std::cout &lt;&lt; std::hexfloat &lt;&lt; std::generate_canonical&lt;float, std::numeric_limits&lt;float&gt;::digits&gt;(mt2) &lt;&lt; std::endl;
std::cout &lt;&lt; std::hexfloat &lt;&lt; std::generate_canonical&lt;float, std::numeric_limits&lt;float&gt;::digits&gt;(mt2) &lt;&lt; std::endl;
</pre></blockquote>
<p/>
which outputs:
<p/>
<blockquote><pre>
0x1.962532p-2
0x1p+0
0x1.20d0cap-3
</pre></blockquote>

but <tt>generate_canonical</tt> is defined to return a result in the range [0, 1).
</p>

<p><i>[2015-10, Kona Saturday afternoon]</i></p>

<p>Options: </p>
<ul>
<li>1) NAD, make it work. E.g. nudge slightly, making the hightest result return the highest allowable value (next_after). This might change the distribution slightly.</li>
<li>2) Re-run the algorithm when you get a 1. This changes the specification in that it makes extra calls to the random engine.</li>
<li>3) Something else</li>
</ul>

<p>WEB: The one thing we cannot tolerate is any output range other than [0, 1).</p>
<p>WEB: I believe there may be a documented algorithm for the generator, and perhaps it's possible to discover en-route that the algorithm produces the wrong result and fix it.</p>
<p>MC: No. I analyzed this once, and here it is: the algorithm is in [rand.util.canonical], and it's all fine until p5. The expression <tt>S/R^k</tt> is mathematically less than one, but it may round to one.</p>
<p>GR: Could we change the rounding mode for the computation? </p>
<p>HH: No, because the rounding mode is global, not thread-local.</p>
<p>AM: SG1 wants to get rid of the floating point environment. </p>
<p>STL: The problem is that the standard specifies the implementation, and the implementation doesn't work.</p>
<p>MC: I'm not sure if nudging it down will introduce a subtle bias.</p>
<p>EF: I worry about how the user's choice of floating point environment affects the behaviour.</p>
<p>MS offers to run the topic past colleagues.</p>
<p>MC: Will set the status to open. STL wants to rename the issue. WEB wants to be able to find the issue by its original name still.</p>

<p>Mike Spertus to run the options past his mathematical colleagues, and report back.</p>

<p><i>[2017-11 Albuquerque Wednesday issue processing]</i></p>

<p>Choice: Rerun the algorithm if it gets 1.0.</p>
<p>Thomas K to provide wording; Marshall and STL to review.</p>

<p><i>[2018-08 Batavia Monday issue discussion]</i></p>

<p>Davis has a paper <a href="https://wg21.link/P0952">P0952</a> which resolves this.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2528" href="2528">2528.</a> Order of <tt>std::tuple</tt> construction unspecified</h3>
<p><b>Section:</b> 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Brian Rodriguez <b>Opened:</b> 2015-08-25 <b>Last modified:</b> 2017-02-19 15:08:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#tuple.cnstr">active issues</a> in [tuple.cnstr].</p>
<p><b>View all other</b> <a href="lwg-index.html#tuple.cnstr">issues</a> in [tuple.cnstr].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The <tt>std::tuple</tt> order of element construction is unspecified. It is either in the same order of the type list or in reverse. 
<p/>
Consider the following program:
</p>
<blockquote><pre>
#include &lt;iostream&gt;
#include &lt;tuple&gt;

struct X 
{
  X(int) { std::cout &lt;&lt; "X constructor\n"; }
};

struct Y 
{
  Y(int) { std::cout &lt;&lt; "Y constructor\n"; }
};

int main()
{
  std::tuple&lt;X, Y&gt; t(1, 2);
}
</pre></blockquote>
<p>
Here is a <a href="http://coliru.stacked-crooked.com/a/764d0477523ba249">link</a> to two sample compilations. The first uses 
libstdc++ and constructs in reverse order, and the second uses libc++ and constructs in in-order. 
<p/>
A <tt>std::tuple</tt> mimics both a struct and type-generic container and should thus follow their standards. Construction is 
fundamentally different from a function call, and it has been historically important for a specific order to be guaranteed; 
namely: whichever the developer may decide. Mandating construction order will allow developers to reference younger elements 
later on in the chain as well, much like a struct allows you to do with its members.
<p/>
There are implementation issues as well. Reversed lists will require unnecessary overhead for braced-initializer-list initialization.  
Since lists are evaluated from left to right, the initializers must be placed onto the stack to respect the construction order. 
This issue could be significant for large tuples, deeply nested tuples, or tuples with elements that require 
many constructor arguments.
<p/>
I propose that the <tt>std::tuple&lt;A, B, ..., Y, Z&gt;</tt>'s constructor implementation be standardized, and made to construct 
in the same order as its type list e.g. <tt>A{}, B{}, ..., Y{}, Z{}</tt>.
</p>

<p>
<b>Daniel:</b>
<p/>
When <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3140.html">N3140</a> became accepted, wording had been
added that gives at least an indication of requiring element initialization in the order of the declaration of the template
parameters. This argumentation can be based on 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> p3 (emphasize mine):
</p>
<blockquote><p>
-3- In the constructor descriptions that follow, let <tt><i>i</i></tt> be in the range <tt>[0,sizeof...(Types))</tt> 
<span style="color:#C80000;font-weight:bold">in order</span>, 
<tt><i>Ti</i></tt> be the <tt><i>i<sup>th</sup></i></tt> type in <tt>Types</tt>, and <tt><i>Ui</i></tt> be the 
<tt><i>i<sup>th</sup></i></tt> type in a template parameter pack named <tt>UTypes</tt>, where indexing is
zero-based.
</p></blockquote>
<p>
But the current wording needs to be improved to make that intention clearer and an issue like this one is necessary to be sure that
the committee is agreeing (or disagreeing) with that intention, especially because N3140 didn't really point out the relevance of the element
construction order in the discussion, and because not all constructors explicitly refer to the ordered sequence of numbers generated
by the variable <tt><i>i</i></tt> (The move constructor does it right, but most other don't do that). 
</p>

<p><i>[2017-02-12, Alisdair comments]</i></p>

<p>
Note that this issue should not be extended to cover the assignment operators,
as implementations may want the freedom to re-order member-wise assignment
so that, for example, all potentially-throwing assignments are performed before
non-throwing assignments (as indicated by the <tt>noexcept</tt> operator).
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2530" href="2530">2530.</a> Clarify observable side effects of releasing a shared state</h3>
<p><b>Section:</b> 32.9.5 <a href="https://timsong-cpp.github.io/cppwp/futures.state">[futures.state]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2015-09-03 <b>Last modified:</b> 2016-08-06 20:44:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#futures.state">issues</a> in [futures.state].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
When a shared-state is released, it may be necessary to execute user defined code for the destructor of a 
stored value or exception. It is unclear whether the execution of said destructor constitutes an observable side effect.
</p>
<p>
While discussing N4445 in Lenexa, Nat Goodspeed pointed out that 32.9.5 <a href="https://timsong-cpp.github.io/cppwp/futures.state">[futures.state]</a>/5.1 does not explicitly 
mention the destruction of the result, so implementations should be allowed to release (or reuse) a shared state ahead 
of time under the "as-if" rule.
<p/>
The standard should clarify whether the execution of destructors is a visible side effect of releasing a shared state.
</p>

<p><i>[2016-08-03 Chicago]</i></p>

<p>This is related to <a href="2532">2532</a></p>
<p>Fri AM: Moved to Open</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2532" href="2532">2532.</a> Satisfying a <tt>promise</tt> at thread exit</h3>
<p><b>Section:</b> 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2015-09-03 <b>Last modified:</b> 2016-08-06 20:44:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#futures.promise">active issues</a> in [futures.promise].</p>
<p><b>View all other</b> <a href="lwg-index.html#futures.promise">issues</a> in [futures.promise].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>promise::set_value_at_thread_exit</tt> and <tt>promise::set_exception_at_thread_exit</tt> operate on a shared state 
at thread exit, without making the thread participate in the ownership of such shared state.
<p/>
Consider the following snippet:
</p>
<blockquote><pre>
std::promise&lt;int&gt;{}.set_value_at_thread_exit(42);
</pre></blockquote>
<p>
Arguably, since the <tt>promise</tt> abandons its shared state without actually making it ready, a <tt>broken_promise</tt> 
error condition should be stored in the shared state. Implementations diverge, they either crash at thread exit by 
dereferencing an invalid pointer, or keep the shared state around until thread exit.
</p>

<p><i>[2016-08-03 Chicago]</i></p>

<p>This is related to <a href="2530">2530</a></p>
<p><i>[2016-08-03, Billy O'Neal suggests concrete wording]</i></p>

<p>Fri AM: Moved to Open</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4606.
</p>

<ol>
<li><p>Change 32.9.5 <a href="https://timsong-cpp.github.io/cppwp/futures.state">[futures.state]</a> p7 as indicated:</p>

<blockquote>
<p>
-7- When an asynchronous provider is said to abandon its shared state, it means:
</p>
<ol style="list-style-type: none">
<li><p>(7.1) &mdash; first, if that state is not ready <ins>or scheduled to be made ready at thread exit</ins>, the provider</p>
<ol style="list-style-type: none">
<li><p>(7.1.1) &mdash; stores an exception object of type <tt>future_error</tt> with an error condition of 
<tt>broken_promise</tt> within its shared state; and then</p></li>
<li><p>(7.1.2) &mdash; makes its shared state ready;</p></li>
</ol>
</li>
</ol>
</blockquote>
</li>

<li><p>Change 32.9.5 <a href="https://timsong-cpp.github.io/cppwp/futures.state">[futures.state]</a> p10 as indicated:</p>

<blockquote>
<p>
-10- Some functions (e.g., <tt>promise::set_value_at_thread_exit</tt>) <del>delay making the shared state ready 
until</del><ins>schedule the shared state to be made ready when</ins> the
calling thread exits. <ins>This associates a reference to the shared state with the calling thread.</ins> The 
destruction of each of that thread's objects with thread storage duration 
(6.7.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.stc.thread">[basic.stc.thread]</a>) is sequenced before making that shared state ready. <ins>When the calling 
thread makes the shared state ready, if the thread holds the last reference to the shared state, the shared state 
is destroyed. [<i>Note:</i> This means that the shared state may not become ready until after the <em>asynchronous 
provider</em> has been destroyed. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2533" href="2533">2533.</a> [concurr.ts] Constrain threads where <tt>future::then</tt> can run a continuation</h3>
<p><b>Section:</b> 99 [concurr.ts::futures.unique_future] <b>Status:</b> <a href="lwg-active.html#SG1">SG1</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2015-09-03 <b>Last modified:</b> 2017-03-01 18:09:34 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#concurr.ts::futures.unique_future">issues</a> in [concurr.ts::futures.unique_future].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#SG1">SG1</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: concurr.ts</b></p>
<p>
In <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4538.pdf">N4538</a>, the continuation given to 
<tt>future::then</tt> can be run "on an unspecified thread of execution". This is too broad, as it allows the 
continuation to be run on the main thread, a UI thread, or any other thread. In comparison, functions given to 
<tt>async</tt> run "as if in a new thread of execution", while the Parallelism TS gives less guarantees by running 
"in either the invoking thread or in a thread implicitly created by the library to support parallel algorithm execution". 
The threads on which the continuation given to <tt>future::then</tt> can run should be similarly constrained.
</p>

<p><i>[2017-03-01, Kona, SG1]</i></p>

<p>
Agreement that this is a problem. Suggested addition to the issue is below. We have no immediate delivery vehicle 
for a fix at the moment, but we would like to make the intended direction clear.
<p/>
There is SG1 consensus that <tt>.then</tt> continuations should, by default, and in the absence of executors, be run 
only in the following ways:
</p>
<ol>
<li><p>If the future is not ready when <tt>.then()</tt> is called, the <tt>.then</tt> argument may be run on the execution 
agent that fulfills the promise.</p></li>
<li><p>In all cases, the <tt>.then</tt> argument may be run on an implementation-provided thread, i.e. a thread that is 
neither the main thread nor explicitly created by the user.</p></li>
</ol>
<p>
In the absence of an executor argument (which currently cannot be supplied), running of the <tt>.then()</tt> continuation 
will not block the thread calling <tt>.then()</tt>, even if the future is ready at the time.
<p/>
Straw polls:
<p/>
SF | F | N | A | SA
<p/>
For the default behaviour:
<p/>
"1. Run on completed task or new execution agent"
<p/>
0 | 7 | 5 | 1 | 0
<p/>
"2. Run on completed task or <tt>.then</tt> caller"
<p/>
0 | 0 | 5 | 5 | 3
<p/>
"3. Leave as implementation defined"
<p/>
1 | 2 | 4 | 3 | 3
<p/>
"4. Always new execution agent"
<p/>
2 | 3 | 6 | 2 | 0
<p/>
The actual conclusion was to allow either (1) or (4) for now, since they are quite close, but present a very different 
programming mode from (2).
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2546" href="2546">2546.</a> Implementability of locale-sensitive <em>UnicodeEscapeSequence</em> matching</h3>
<p><b>Section:</b> 30.13 <a href="https://timsong-cpp.github.io/cppwp/re.grammar">[re.grammar]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2015-10-08 <b>Last modified:</b> 2015-10-21 05:22:23 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.grammar">active issues</a> in [re.grammar].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.grammar">issues</a> in [re.grammar].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In 30.13 <a href="https://timsong-cpp.github.io/cppwp/re.grammar">[re.grammar]</a> paragraph 2:
</p>
<blockquote><p>
<tt>basic_regex</tt> member functions shall not call any locale dependent C or C++ API, including the formatted 
string input functions. Instead they shall call the appropriate traits member function to achieve the required effect.
</p></blockquote>
<p>
Yet, the required interface for a regular expression traits class (30.3 <a href="https://timsong-cpp.github.io/cppwp/re.req">[re.req]</a>) does not appear to have 
any reliable method for determining whether a character as encoded for the locale associated with the traits 
instance is the same as a character represented by a <em>UnicodeEscapeSequence</em>, e.g., assuming a sane 
<tt>ru_RU.koi8r</tt> locale:
</p>
<blockquote><pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;regex&gt;

const char data[] = "\xB3";
const char matchCyrillicCaptialLetterYo[] = R"(\u0401)";

int main(void) 
{
  try {
    std::regex myRegex;
    myRegex.imbue(std::locale("ru_RU.koi8r"));

    myRegex.assign(matchCyrillicCaptialLetterYo, std::regex_constants::ECMAScript);
    printf("(%s)\n", std::regex_replace(std::string(data), myRegex, std::string("E")).c_str());

    myRegex.assign("[[:alpha:]]", std::regex_constants::ECMAScript);
    printf("(%s)\n", std::regex_replace(std::string(data), myRegex, std::string("E")).c_str());
  } catch (std::regex_error&amp; e) {
    abort();
  }
  return 0;
}
</pre></blockquote>
<p>
The implementation I tried prints:
</p>
<blockquote><pre>
(&#x401;)
(E)
</pre></blockquote>
<p>
Which means that the character class matching worked, but not the matching to the <em>UnicodeEscapeSequence</em>.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2547" href="2547">2547.</a> Container requirements (and other library text) should say "strict total order", not just "total order"</h3>
<p><b>Section:</b> 20.14.7 <a href="https://timsong-cpp.github.io/cppwp/comparisons">[comparisons]</a>, 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>, 32.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.thread.id">[thread.thread.id]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Matt Austern <b>Opened:</b> 2015-10-08 <b>Last modified:</b> 2015-10-21 05:22:23 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#comparisons">active issues</a> in [comparisons].</p>
<p><b>View all other</b> <a href="lwg-index.html#comparisons">issues</a> in [comparisons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
A number of places in the library, including 20.14.7 <a href="https://timsong-cpp.github.io/cppwp/comparisons">[comparisons]</a>/14, the Optional container requirements in 
22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>, and 32.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/thread.thread.id">[thread.thread.id]</a>/8, use the phrase "total order". 
Unfortunately, that phrase is ambiguous. In mathematics, the most common definition is that a relation <tt>&le;</tt> is 
a total order if it's total, transitive, and antisymmetric in the sense that <tt>x&le;y &#x2227; y&le;x &rArr; x=y</tt>. 
What we really want is a strict total order: a relation <tt>&lt;</tt> is a strict total order if it's total, transitive, and 
antisymmetric in the sense that exactly one of <tt>x&lt;y</tt>, <tt>y&lt;x</tt>, and <tt>x=y</tt> holds.
</p>
<p>
The non-normative note in 25.7 <a href="https://timsong-cpp.github.io/cppwp/alg.sorting">[alg.sorting]</a>/4 correctly uses the phrase "strict total ordering" rather than 
simply "total ordering".
</p>
<p>
We could address this issue by replacing "total order" with "strict total order" everywhere it appears, since I 
think there are no cases where we actually want a non-strict total order, or we could add something in Clause 17 saying 
that we always mean strict total order whenever we say total order.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2561" href="2561">2561.</a> [fund.ts.v2] Incorrect exception specifications for 'swap' in C++ Extensions for Library Fundamentals</h3>
<p><b>Section:</b> 5.3.4 [fund.ts.v2::optional.object.swap], 3.7.8 [fund.ts.v2::propagate_const.modifiers] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2015-11-14 <b>Last modified:</b> 2016-11-20 18:58:35 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v2</b></p>
<p>
As pointed out in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4511.html#Related_Issues">N4511</a>,
the Library fundamentals are affected by a similar problem as described in LWG <a href="2456">2456</a>. First, it is caused
by <tt>optional</tt>'s member <tt>swap</tt> (5.3.4 [fund.ts.v2::optional.object.swap]):
</p>
<blockquote><pre>
void swap(optional&lt;T&gt;&amp; rhs) noexcept(<i>see below</i>);
</pre></blockquote>
<p>
with 
</p>
<blockquote>
<p>
The expression inside <tt>noexcept</tt> is equivalent to: 
</p>
<blockquote><pre>
is_nothrow_move_constructible_v&lt;T&gt; &amp;&amp; noexcept(swap(declval&lt;T&amp;&gt;(), declval&lt;T&amp;&gt;()))
</pre></blockquote>
</blockquote>
<p>
Again, the unqualified lookup for <tt>swap</tt> finds the member <tt>swap</tt> instead of the result of a normal argument-depending 
lookup, making this ill-formed.
<p/>
A second example of such a problem recently entered the arena with the addition of the <tt>propagate_const</tt> template
with another member <tt>swap</tt> (3.7.8 [fund.ts.v2::propagate_const.modifiers]):
</p>
<blockquote>
<pre>
constexpr void swap(propagate_const&amp; pt) noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-2- The constant-expression in the exception-specification is <tt>noexcept(swap(t_, pt.t_))</tt>.
</p>
</blockquote>
</blockquote>
<p>
A working approach is presented in 
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4511.html#Proposed_resolution">N4511</a>. By adding a new
trait to the standard library and referencing this by the library fundamentals (A similar approach had been applied in the
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3940.html#path-inserter-extractor">file system specification</a>
where the <tt>quoted</tt> manipulator from C++14 had been referred to, albeit the file system specification is generally based on the
C++11 standard), <tt>optional</tt>'s member <tt>swap</tt> exception specification could be rephrased as follows:
</p>
<blockquote>
<p>
The expression inside <tt>noexcept</tt> is equivalent to: 
</p>
<blockquote><pre>
is_nothrow_move_constructible_v&lt;T&gt; &amp;&amp; <ins>is_nothrow_swappable_v&lt;T&gt;</ins><del>noexcept(swap(declval&lt;T&amp;&gt;(), declval&lt;T&amp;&gt;()))</del>
</pre></blockquote>
</blockquote>
<p>
and <tt>propagate_const</tt>'s member <tt>swap</tt> exception specification could be rephrased as follows:
</p>
<blockquote>
<pre>
constexpr void swap(propagate_const&amp; pt) noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-2- The constant-expression in the exception-specification is <tt><ins>is_nothrow_swappable_v&lt;T&gt;</ins><del>noexcept(swap(t_, pt.t_))</del></tt>.
</p>
</blockquote>
</blockquote>

<p><i>[2016-02-20, Ville comments]</i></p>

<p>
Feedback from an implementation:
<p/>
libstdc++ already applies the proposed resolution for <tt>propagate_const</tt>,
but not for <tt>optional</tt>.
</p>

<p><i>[2016-02-20, Daniel comments]</i></p>

<p>
A recent paper update has been provided: <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0185r0.html#Proposed_resolution">P0185R0</a>.
</p>

<p><i>[2016-03, Jacksonville]</i></p>

Add a link to <a href="2456">2456</a>

<p><i>[2016-11-08, Issaquah]</i></p>

<p>Not adopted during NB comment resolution</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2564" href="2564">2564.</a> [fund.ts.v2] <tt>std::experimental::function</tt> constructors taking allocator arguments may throw exceptions</h3>
<p><b>Section:</b> 4.2 [fund.ts.v2::func.wrap.func] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song  <b>Opened:</b> 2015-12-05 <b>Last modified:</b> 2016-11-20 18:58:35 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#fund.ts.v2::func.wrap.func">issues</a> in [fund.ts.v2::func.wrap.func].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v2</b></p>
<p>
[This is essentially LWG <a href="2370">2370</a>, but deals with the fundamentals TS version rather than the one in the standard]
<p/>
In 4.2 [fund.ts.v2::func.wrap.func] of library fundamentals TS, the constructors
</p>
<blockquote><pre>
template&lt;class A&gt; function(allocator_arg_t, const A&amp;) noexcept;
template&lt;class A&gt; function(allocator_arg_t, const A&amp;, nullptr_t) noexcept;
</pre></blockquote>
<p>
must type-erase and store the provided allocator, since the <tt>operator=</tt> specification requires using the "allocator 
specified in the construction of" the <tt>std::experimental::function</tt> object. This may require a dynamic allocation 
and so cannot be noexcept. Similarly, the following constructors
</p>
<blockquote><pre>
template&lt;class A&gt; function(allocator_arg_t, const A&amp;, const function&amp;); 
template&lt;class A&gt; function(allocator_arg_t, const A&amp;, function&amp;&amp;);
template&lt;class F, class A&gt; function(allocator_arg_t, const A&amp;, F);
</pre></blockquote>
<p>
cannot satisfy the C++14 requirement that they "shall not throw exceptions if [the <tt>function</tt> object to be stored] 
is a callable object passed via <tt>reference_wrapper</tt> or a function pointer" if they need to type-erase and store the 
allocator.
</p>
<p><i>[2016-11-08, Issaquah]</i></p>

<p>Not adopted during NB comment resolution</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4562.html">N4562</a>.
</p>

<ol>
<li><p> Edit 4.2 [fund.ts.v2::func.wrap.func], class template <tt>function</tt> synopsis, as follows:</p>

<blockquote>
<pre>
namespace std {
  namespace experimental {
  inline namespace fundamentals_v2 {

    [&hellip;]

    template&lt;class R, class... ArgTypes&gt;
    class function&lt;R(ArgTypes...)> {
    public:    
      [&hellip;]
      template&lt;class A> function(allocator_arg_t, const A&amp;) <del>noexcept</del>;
      template&lt;class A> function(allocator_arg_t, const A&amp;,
        nullptr_t) <del>noexcept</del>;
      [&hellip;]
    };

    [&hellip;]

  } // namespace fundamentals_v2
  } // namespace experimental

  [&hellip;]

} // namespace std
</pre>
</blockquote>
</li>

<li><p>Insert the following paragraphs after 4.2.1 [fund.ts.v2::func.wrap.func.con]/1:</p>
<blockquote class="note">
<p>
[<i>Drafting note</i>: This just reproduces the wording from C++14 with the "shall not throw exceptions for 
<tt>reference_wrapper</tt>/function pointer" provision deleted. &mdash; <i>end drafting note</i>]
</p>
</blockquote>

<blockquote>
<p>
-1- When a <tt>function</tt> constructor that takes a first argument of type <tt>allocator_arg_t</tt> is invoked, 
the second argument is treated as a <em>type-erased allocator</em> (8.3). If the constructor moves or makes a copy 
of a function object (C++14 &sect;20.9), including an instance of the <tt>experimental::function</tt> class template, 
then that move or copy is performed by <em>using-allocator construction</em> with allocator <tt>get_memory_resource()</tt>. 
</p>
<blockquote>
<pre>
<ins>template &lt;class A&gt; function(allocator_arg_t, const A&amp; a);
template &lt;class A&gt; function(allocator_arg_t, const A&amp; a, nullptr_t);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Postconditions</i>: <tt>!*this</tt>.</ins>
</p>
</blockquote>
<pre>
<ins>template &lt;class A&gt; function(allocator_arg_t, const A&amp; a, const function&amp; f);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Postconditions</i>: <tt>!*this if !f</tt>; otherwise, <tt>*this</tt> targets a copy of <tt>f.target()</tt>.</ins>
<p/>
<ins>-?- <i>Throws</i>: May throw <tt>bad_alloc</tt> or any exception thrown by the copy constructor of the stored callable object. 
[<i>Note</i>: Implementations are encouraged to avoid the use of dynamically allocated memory for small callable objects, 
for example, where <tt>f</tt>'s target is an object holding only a pointer or reference to an object and a member function pointer. 
&mdash; <i>end note</i>]</ins>
</p>
</blockquote>
<pre>
<ins>template &lt;class A&gt; function(allocator_arg_t, const A&amp; a, function&amp;&amp; f);</ins>
</pre>
<blockquote>
<p>
<ins>-?- Effects: If <tt>!f</tt>, <tt>*this</tt> has no target; otherwise, move-constructs the target of <tt>f</tt> into the 
target of <tt>*this</tt>, leaving <tt>f</tt> in a valid state with an unspecified value.</ins>
</p>
</blockquote>
<pre>
<ins>template &lt;class F, class A&gt; function(allocator_arg_t, const A&amp; a, F f);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Requires</i>: <tt>F</tt> shall be <tt>CopyConstructible</tt>.</ins>
<p/>
<ins>-?- <i>Remarks</i>: This constructor shall not participate in overload resolution unless <tt>f</tt> is Callable 
(C++14 &sect;20.9.11.2) for argument types <tt>ArgTypes...</tt> and return type <tt>R</tt>.</ins>
<p/>
<ins>-?- <i>Postconditions</i>: <tt>!*this</tt> if any of the following hold:</ins>
<ul>
<li><p><ins><tt>f</tt> is a null function pointer value.</ins></p></li>
<li><p><ins><tt>f</tt> is a null member pointer value.</ins></p></li>
<li><p><ins><tt>F</tt> is an instance of the <tt>function</tt> class template, and <tt>!f</tt>.</ins></p></li>
</ul>
<p/>
<ins>-?- Otherwise, <tt>*this</tt> targets a copy of <tt>f</tt> initialized with <tt>std::move(f)</tt>. [<i>Note</i>: 
Implementations are encouraged to avoid the use of dynamically allocated memory for small callable objects, for example, 
where <tt>f</tt>'s target is an object holding only a pointer or reference to an object and a member function pointer. &mdash; 
<i>end note</i>]</ins>
<p/>
<ins>-?- <i>Throws</i>: May throw <tt>bad_alloc</tt> or any exception thrown by <tt>F</tt>'s copy or move constructor.</ins>
</p>
</blockquote>
</blockquote>
<p>
-2- In the following descriptions, let <tt><i>ALLOCATOR_OF</i>(f)</tt> be the allocator specified in the construction 
of <tt>function f</tt>, or <tt>allocator&lt;char&gt;()</tt> if no allocator was specified.
<p/>
[&hellip;]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2592" href="2592">2592.</a> Require that <tt>chrono::duration_cast</tt>s from smaller durations to larger durations do not overflow</h3>
<p><b>Section:</b> 27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Andy Giese <b>Opened:</b> 2016-02-05 <b>Last modified:</b> 2016-05-08 21:12:54 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#time.syn">issues</a> in [time.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Currently 27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a> states
</p>
<blockquote><pre>
<i>// convenience typedefs</i>
typedef duration&lt;<i>signed integer type of at least 64 bits</i>,        nano&gt; nanoseconds;
typedef duration&lt;<i>signed integer type of at least 55 bits</i>,       micro&gt; microseconds;
typedef duration&lt;<i>signed integer type of at least 45 bits</i>,       milli&gt; milliseconds;
typedef duration&lt;<i>signed integer type of at least 35 bits</i>             &gt; seconds;
typedef duration&lt;<i>signed integer type of at least 29 bits</i>, ratio&lt;  60&gt;&gt; minutes;
typedef duration&lt;<i>signed integer type of at least 23 bits</i>, ratio&lt;3600&gt;&gt; hours;
</pre></blockquote>
<p>
However, a <tt>duration_cast&lt;minutes&gt;(seconds::max())</tt> would cause overflow if the underlying signed integers 
only met the minimums specified.
<p/>
The standard should specify that implementations guarantee that a <tt>duration_cast</tt> from any smaller duration in 
these "convenience typedefs" will not overflow any larger duration. That is, <tt>hours</tt> should be able to hold 
the maximum of <tt>minutes</tt>, which should be able to hold the maximum of <tt>seconds</tt> and so on.
<p/>
More formally, if the ratio <tt>typedef A</tt> and <tt>typedef B</tt> is <tt>1:Y</tt> where <tt>Y &gt; 1</tt> (e.g., 
1 : 60 in case of <tt>minutes</tt> : <tt>seconds</tt>), then <tt>#bits<sub>A</sub>-1</tt> must be at least 
<tt>ceil(log<sub>2</sub>(2<sup>#bits<sub>B</sub>-1)/Y)</sup>)</tt>.
<p/>
In the case of <tt>minutes</tt> : <tt>seconds</tt>, <tt>X = 1</tt>, <tt>Y = 60</tt>. Let 
<tt>#bits<sub>seconds</sub> = 32</tt>. Therefore:
</p>
<ul>
<li><p><tt>2<sup>(#bits<sub>seconds</sub> - 1)</sup> = 2<sup>31</sup> = 2147483648</tt></p></li>
<li><p><tt>ceil(log<sub>2</sub>(2<sup>31</sup> / 60) = 26</tt></p></li>
<li><p><tt>#bits<sub>minutes</sub> - 1 = 26</tt></p></li>
<li><p><tt>#bits<sub>minutes</sub> = 27</tt></p></li>
</ul>
<p>
Therefore, a minimum of 27 bits would be needed to store <tt>minutes</tt> if 32 were used to store <tt>seconds</tt>.
<p/>
I propose to change the definitions of the convenience typedefs as follows:
</p>
<blockquote><pre>
<i>// convenience typedefs</i>
typedef duration&lt;<i>signed integer type of at least 64 bits</i>,        nano&gt; nanoseconds;
typedef duration&lt;<i>signed integer type of at least 55 bits</i>,       micro&gt; microseconds;
typedef duration&lt;<i>signed integer type of at least 46 bits</i>,       milli&gt; milliseconds;
typedef duration&lt;<i>signed integer type of at least 37 bits</i>             &gt; seconds;
typedef duration&lt;<i>signed integer type of at least 32 bits</i>, ratio&lt;  60&gt;&gt; minutes;
typedef duration&lt;<i>signed integer type of at least 27 bits</i>, ratio&lt;3600&gt;&gt; hours;
</pre></blockquote>
<p>
These bits were chosen to satisfy the above formula. Note that
minimums only increased, so larger ranges could be held. A nice
outcome of this choice is that <tt>minutes</tt> does not go above 32 bits.
</p>

<p><i>[2016-04-23, Tim Song comments]</i></p>

<p>
The P/R of LWG 2592 doesn't fix the issue it wants to solve, because the actual underlying type will likely 
have more bits than the specified minimum.
<p/>
Consider <tt>seconds</tt>, which the P/R requires to have at least 37 bits. On a typical system this implies 
using a 64-bit integer. To ensure that casting from <tt>seconds::max()</tt> to <tt>minutes</tt> doesn't overflow 
in such a system, it is necessary for the latter to have at least 59 bits (which means, in practice, 64 bits too), 
not just 32 bits. Thus, just changing the minimum number of bits will not be able to provide the desired guarantee 
that casting from a smaller unit to a larger one never overflow.
<p/>
If such a guarantee is to be provided, it needs to be spelled out directly. Note that the difference here is 9 bits 
(for the 1000-fold case) and 5 bits (for the 60-fold case), which is less than the size difference between integer 
types on common systems, so such a requirement would effectively require those convenience typedefs to use the 
same underlying integer type.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4567.</p>

<ol>
<li><p>Change 27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a>, header <tt>&lt;chrono&gt;</tt> synopsis, as indicated</p>

<blockquote><pre>
[&hellip;]

<i>// convenience typedefs</i>
typedef duration&lt;<i>signed integer type of at least 64 bits</i>,        nano&gt; nanoseconds;
typedef duration&lt;<i>signed integer type of at least 55 bits</i>,       micro&gt; microseconds;
typedef duration&lt;<i>signed integer type of at least <ins>46</ins><del>45</del> bits</i>,       milli&gt; milliseconds;
typedef duration&lt;<i>signed integer type of at least <ins>37</ins><del>35</del> bits</i>             &gt; seconds;
typedef duration&lt;<i>signed integer type of at least <ins>32</ins><del>29</del> bits</i>, ratio&lt;  60&gt;&gt; minutes;
typedef duration&lt;<i>signed integer type of at least <ins>27</ins><del>23</del> bits</i>, ratio&lt;3600&gt;&gt; hours;

[&hellip;]
</pre></blockquote>

</li>
</ol>





<hr>
<h3><a name="2594" href="2594">2594.</a> Contradicting definition of empty <tt>shared_ptr</tt> on <tt>shared_ptr(nullptr, d)</tt></h3>
<p><b>Section:</b> 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Kazutoshi Satoda <b>Opened:</b> 2016-02-20 <b>Last modified:</b> 2016-06-20 06:33:43 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#util.smartptr.shared">active issues</a> in [util.smartptr.shared].</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared">issues</a> in [util.smartptr.shared].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Latest draft (N4567) 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> p1 says:
</p>
<blockquote>
<p>
A <tt>shared_ptr</tt> object is <em>empty</em> if it does not own a pointer.
</p>
</blockquote>
<p>
Please note that it says "own a pointer". This definition was added as
the resolution for LWG defect <a href="813">813</a>.
<p/>
20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a> p8 says about the effect of
<tt>shared_ptr(nullptr_t p, D d)</tt>:
</p>
<blockquote>
<p>
<i>Effects</i>: Constructs a <tt>shared_ptr</tt> object that <em>owns</em> the object <tt>p</tt> and the deleter <tt>d</tt>.
</p>
</blockquote>
<p>
Please note that it says "<em>owns</em> the object". This was intentionally
changed from "the pointer" as a part of resolution for LWG defect <a href="758">758</a>,
to cover <tt>nullptr_t</tt> case.
<p/>
Since <tt>shared_ptr(nullptr, d)</tt> owns an object of type <tt>nullptr_t</tt>, but does
not own a pointer, it is said as "empty" by a strict reading of the
above mentioned definition in 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> p1.
<p/>
These cause a contradiction:
<p/>
20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a> p9 sets a postcondition
<tt>use_count() == 1</tt> on <tt>shared_ptr(nullptr, d)</tt>. But 
20.11.3.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.obs">[util.smartptr.shared.obs]</a> p7 says that the return value of <tt>use_count()</tt>
is "<tt>0</tt> when <tt>*this</tt> is <em>empty</em>".
</p>
<p>
Proposed wording changes:
<p/>
Replace the last 2 words in 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> p1 from
</p>
<blockquote><p>
[&hellip;] <em>empty</em> if it does not own a pointer.
</p></blockquote>
<p>
to
</p>
<blockquote><p>
[&hellip;] <em>empty</em> if it does not own an object.
</p></blockquote>
<p>
Note that <tt>shared_ptr(nullptr_t)</tt> is defined to be empty in synopsis in
20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a>.
</p>
<blockquote><pre>
constexpr shared_ptr(nullptr_t) noexcept : shared_ptr() { }
</pre></blockquote>
<p>
It could be less confusing if <tt>shared_ptr(nullptr, d)</tt> could be defined to
be empty. But it seems too late to change that (which means changing
whether the deleter is called or not, see 
<a href="https://stackoverflow.com/questions/11164354/">this Stackoverflow article</a>). 
Then I'm proposing just fix the contradiction.
</p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4594.
</p>

<ol>
<li><p>Change 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> p1 as indicated:</p>

<blockquote>
<p>-1- The <tt>shared_ptr</tt> class template stores a pointer, usually obtained via <tt>new</tt>. <tt>shared_ptr</tt> 
implements semantics of shared ownership; the last remaining owner of the pointer is responsible for destroying the 
object, or otherwise releasing the resources associated with the stored pointer. A <tt>shared_ptr</tt> object is 
<em>empty</em> if it does not own <ins>an object</ins><del>a pointer</del>.
</p>
</blockquote>

</li>
</ol>






<hr>
<h3><a name="2595" href="2595">2595.</a> <tt>reverse_iterator::operator[]</tt>'s return type revisited</h3>
<p><b>Section:</b> 23.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/reverse.iterator">[reverse.iterator]</a>, 99 [reverse.iter.opindex] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Robert Haberlach <b>Opened:</b> 2016-02-28 <b>Last modified:</b> 2016-04-16 04:21:53 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#reverse.iterator">issues</a> in [reverse.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Issue <a href="386">386</a> changed the return type of <tt>reverse_iterator::operator[]</tt> to unspecified. However, 
as of N3066, the return type of a random access iterator's <tt>operator[]</tt> shall be convertible to <tt>reference</tt>; 
thus the return type of <tt>reverse_iterator::operator[]</tt> should be <tt>reference</tt> (and it is in all common
implementations).
<p/>
Suggested resolution: Adjust 23.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/reverse.iterator">[reverse.iterator]</a>'s synopsis and 99 [reverse.iter.opindex] to 
use <tt>reference</tt> instead of <tt><i>unspecified</i></tt>.
</p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4582.
</p>

<ol>
<li><p>Edit 23.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/reverse.iterator">[reverse.iterator]</a>, class template <tt></tt> synopsis, as indicated:</p>

<blockquote><pre>
namespace std {
  template &lt;class Iterator&gt;
  class reverse_iterator {
  public:
    [&hellip;]
    typedef typename iterator_traits&lt;Iterator&gt;::reference reference;
    [&hellip;]
    constexpr <ins>reference</ins><del><i>unspecified</i></del> operator[](difference_type n) const;
    [&hellip;]
  };
}
</pre></blockquote>

</li>

<li><p>Change 99 [reverse.iter.opindex] before p1 as indicated:</p>

<blockquote>
<pre>
constexpr <ins>reference</ins><del><i>unspecified</i></del> operator[](
  typename reverse_iterator&lt;Iterator&gt;::difference_type n) const;
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2599" href="2599">2599.</a> Library incomplete type permission phrase is unclear</h3>
<p><b>Section:</b> 20.2.6 <a href="https://timsong-cpp.github.io/cppwp/declval">[declval]</a>, 20.11.1 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr">[unique.ptr]</a>, 20.11.1.1.1 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.dltr.general">[unique.ptr.dltr.general]</a>, 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a>, 20.11.4 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak">[util.smartptr.weak]</a>, 20.11.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.enab">[util.smartptr.enab]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Zhihao Yuan <b>Opened:</b> 2016-03-08 <b>Last modified:</b> 2016-04-16 04:21:53 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Currently the phrase to grant this permission is:
</p>
<blockquote><p>
The template parameter <tt>T</tt> of <tt><i>LibraryTemplate</i></tt> may be an incomplete type.
</p></blockquote>
<p>
Two problems:
</p>
<ol>
<li><p>The timing is unclear.  We always allow specializations like <tt><i>LibraryTemplate</i>&lt;Incomp&gt;* p;</tt></p></li>
<li><p>To the users of a template, the correct terminology should be "argument" rather than "parameter".</p></li>
</ol>
<p>
Suggested resolution:
</p>
<blockquote><p>
In an instantiation of <tt><i>LibraryTemplate</i></tt>, an incomplete type
may be used as the template argument for the template parameter <tt>T</tt>.
</p></blockquote>
<p>
as shown <a href="https://github.com/cplusplus/draft/pull/304/files">here</a>.
<p/>
Or, to copy <a href=" http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2015/n4510.html">N4510's wording</a>:
</p>
<blockquote><p>
An incomplete type <tt>T</tt> may be used when instantiating <tt><i>LibraryTemplate</i></tt>.
</p></blockquote>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2675" href="2675">2675.</a> <tt>register_callback</tt> can fail</h3>
<p><b>Section:</b> 29.5.3.6 <a href="https://timsong-cpp.github.io/cppwp/ios.base.callback">[ios.base.callback]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> David Krauss <b>Opened:</b> 2016-03-14 <b>Last modified:</b> 2019-06-15 18:12:03 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>register_callback</tt> allocates memory and so it can fail, but the case is unspecified. libc++ sets
<tt>badbit</tt>, which is consistent with <tt>iword</tt> and <tt>pword</tt>. libstdc++ throws <tt>std::bad_alloc</tt>.
</p>

<p><i>[2019-06-13; Billy comments]</i></p>

<p>
Just as an additional data point: MSVC++ agrees with libstdc++ and also throws <tt>std::bad_alloc</tt>.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2690" href="2690">2690.</a> <tt>invoke&lt;R&gt;</tt></h3>
<p><b>Section:</b> 20.14.4 <a href="https://timsong-cpp.github.io/cppwp/func.invoke">[func.invoke]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Zhihao Yuan <b>Opened:</b> 2016-03-25 <b>Last modified:</b> 2020-02-13 20:58:51 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#func.invoke">issues</a> in [func.invoke].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In <a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2014/n4169.html">N4169</a>
the author dropped the <tt>invoke&lt;R&gt;</tt> support by claiming
that it's an unnecessary cruft in TR1, obsoleted by C++11
type inference.  But now we have some new business went
to *<tt><i>INVOKE</i></tt>*<tt>(f, t1, t2, ..., tN, R)</tt>, that is to discard the
return type when <tt>R</tt> is <tt>void</tt>. This form is very useful, or
possible even more useful than the basic form when
implementing a call wrapper. Also note that the optional
<tt>R</tt> support is already in <tt>std::is_callable</tt> and
<tt>std::is_nothrow_callable</tt>.
</p>

<p><i>[2016-07-31, Tomasz Kami&nacute;ski comments]</i></p>

<p>
The lack of <tt>invoke&lt;R&gt;</tt> was basically a result of the concurrent publication of the never revision 
of the paper and additional special semantics of <tt><i>INVOKE</i>(f, args..., void)</tt>.
<p/>
In contrast to existing <tt>std::invoke</tt> function, the proposed <tt>invoke&lt;R&gt;</tt> version is not 
SFINAE friendly, as elimination of the standard version of invoke is guaranteed by <tt>std::result_of_t</tt> 
in the result type that is missing for proposed <tt>invoke&lt;R&gt;</tt> version. To provide this guarantee, 
following remarks shall be added to the specification:
</p>
<blockquote>
<p>
<i>Remarks:</i> This function shall not participate in overload resolution unless 
<tt>is_callable_v&lt;F(Args...), R&gt;</tt> is <tt>true</tt>.
</p>
</blockquote>

<p><i>[2016-08-01, Tomasz Kami&nacute;ski and Zhihao Yuan update the proposed wording]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to N4606.
</p>
<ol>
<li><p>Modify 20.14 <a href="https://timsong-cpp.github.io/cppwp/function.objects">[function.objects]</a>/2, header <tt>&lt;functional&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  <i>// 20.12.3, invoke:</i>
  template &lt;class F, class... Args&gt; result_of_t&lt;F&amp;&amp;(Args&amp;&amp;...)&gt; invoke(F&amp;&amp; f, Args&amp;&amp;... args);
  <ins>template &lt;class R, class F, class... Args&gt; R invoke(F&amp;&amp; f, Args&amp;&amp;... args);</ins>
</pre>
</blockquote>
</li>

<li><p>Add the following sequence of paragraphs after 20.14.4 <a href="https://timsong-cpp.github.io/cppwp/func.invoke">[func.invoke]</a>/1 as indicated:</p>

<blockquote>
<pre>
<ins>template &lt;class R, class F, class... Args&gt; R invoke(F&amp;&amp; f, Args&amp;&amp;... args);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Returns</i>: <tt><i>INVOKE</i>(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)..., R)</tt> 
(20.14.3 <a href="https://timsong-cpp.github.io/cppwp/func.require">[func.require]</a>).</ins>
<p/>
<ins>-?- <i>Remarks:</i> This function shall not participate in overload resolution unless 
<tt>is_callable_v&lt;F(Args...), R&gt;</tt> is <tt>true</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2016-09-04, Tomasz Kami&nacute;ski comments and improves wording]</i></p>

<p>
The usage of <tt>is_callable_v&lt;F(Args...), R&gt;</tt> causes problem in situation when either <tt>F</tt> or <tt>Args</tt> 
is an abstract type and the function type <tt>F(Args...)</tt> cannot be formed or when one of the args is <i>cv</i>-qualified, 
as top-level <i>cv</i>-qualification for function parameters is dropped by language rules. It should use 
<tt>is_callable_v&lt;F&amp;&amp;(Args&amp;&amp;...), R&gt;</tt> instead.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to N4606.
</p>
<ol>
<li><p>Modify 20.14 <a href="https://timsong-cpp.github.io/cppwp/function.objects">[function.objects]</a>/2, header <tt>&lt;functional&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  <i>// 20.12.3, invoke:</i>
  template &lt;class F, class... Args&gt; result_of_t&lt;F&amp;&amp;(Args&amp;&amp;...)&gt; invoke(F&amp;&amp; f, Args&amp;&amp;... args);
  <ins>template &lt;class R, class F, class... Args&gt; R invoke(F&amp;&amp; f, Args&amp;&amp;... args);</ins>
</pre>
</blockquote>
</li>

<li><p>Add the following sequence of paragraphs after 20.14.4 <a href="https://timsong-cpp.github.io/cppwp/func.invoke">[func.invoke]</a>/1 as indicated:</p>

<blockquote>
<pre>
<ins>template &lt;class R, class F, class... Args&gt; R invoke(F&amp;&amp; f, Args&amp;&amp;... args);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Returns</i>: <tt><i>INVOKE</i>(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)..., R)</tt> 
(20.14.3 <a href="https://timsong-cpp.github.io/cppwp/func.require">[func.require]</a>).</ins>
<p/>
<ins>-?- <i>Remarks:</i> This function shall not participate in overload resolution unless 
<tt>is_callable_v&lt;F&amp;&amp;(Args&amp;&amp;...), R&gt;</tt> is <tt>true</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-08-22, Zhihao Yuan provides improved wording]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>
</p>

<ol>
<li><p>Modify 20.14.1 <a href="https://timsong-cpp.github.io/cppwp/functional.syn">[functional.syn]</a>, header <tt>&lt;functional&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  <i>// 20.14.4 <a href="https://timsong-cpp.github.io/cppwp/func.invoke">[func.invoke]</a>, invoke</i>
  template&lt;class F, class... Args&gt;
    invoke_result_t&lt;F, Args...&gt; invoke(F&amp;&amp; f, Args&amp;&amp;... args)
      noexcept(is_nothrow_invocable_v&lt;F, Args...&gt;);
  <ins>template &lt;class R, class F, class... Args&gt;
    R invoke(F&amp;&amp; f, Args&amp;&amp;... args)
      noexcept(is_nothrow_invocable_r_v&lt;R, F, Args...&gt;);</ins>
</pre>
</blockquote>
</li>

<li><p>Add the following sequence of paragraphs after 20.14.4 <a href="https://timsong-cpp.github.io/cppwp/func.invoke">[func.invoke]</a>/1 as indicated:</p>

<blockquote>
<pre>
<ins>template &lt;class R, class F, class... Args&gt;
  R invoke(F&amp;&amp; f, Args&amp;&amp;... args)
    noexcept(is_nothrow_invocable_r_v&lt;R, F, Args...&gt;);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints</i>: <tt>is_invocable_r_v&lt;R, F, Args...&gt;</tt>.</ins>
<p/>
<ins>-?- <i>Returns:</i> <tt><i>INVOKE</i>&lt;R&gt;(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...)</tt> 
(20.14.3 <a href="https://timsong-cpp.github.io/cppwp/func.require">[func.require]</a>).</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>
</p>

<ol>
<li><p>Modify 20.14.1 <a href="https://timsong-cpp.github.io/cppwp/functional.syn">[functional.syn]</a>, header <tt>&lt;functional&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  <i>// 20.14.4 <a href="https://timsong-cpp.github.io/cppwp/func.invoke">[func.invoke]</a>, invoke</i>
  template&lt;class F, class... Args&gt;
    constexpr invoke_result_t&lt;F, Args...&gt; invoke(F&amp;&amp; f, Args&amp;&amp;... args)
      noexcept(is_nothrow_invocable_v&lt;F, Args...&gt;);
  <ins>template &lt;class R, class F, class... Args&gt;
    constexpr R invoke(F&amp;&amp; f, Args&amp;&amp;... args)
      noexcept(is_nothrow_invocable_r_v&lt;R, F, Args...&gt;);</ins>
</pre>
</blockquote>
</li>

<li><p>Add the following sequence of paragraphs after 20.14.4 <a href="https://timsong-cpp.github.io/cppwp/func.invoke">[func.invoke]</a>/1 as indicated:</p>

<blockquote>
<pre>
<ins>template &lt;class R, class F, class... Args&gt;
  constexpr R invoke(F&amp;&amp; f, Args&amp;&amp;... args)
    noexcept(is_nothrow_invocable_r_v&lt;R, F, Args...&gt;);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints</i>: <tt>is_invocable_r_v&lt;R, F, Args...&gt;</tt>.</ins>
<p/>
<ins>-?- <i>Returns:</i> <tt><i>INVOKE</i>&lt;R&gt;(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...)</tt> 
(20.14.3 <a href="https://timsong-cpp.github.io/cppwp/func.require">[func.require]</a>).</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2691" href="2691">2691.</a> <tt>money_base::space</tt> and <tt>do_put</tt>: U+0020 versus <tt>fill</tt></h3>
<p><b>Section:</b> 28.4.6.3 <a href="https://timsong-cpp.github.io/cppwp/locale.moneypunct">[locale.moneypunct]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2016-04-12 <b>Last modified:</b> 2016-05-22 15:38:38 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#locale.moneypunct">issues</a> in [locale.moneypunct].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The description of <tt>money_base::space</tt> is that "at least one space is required at that position." 
(N4582 subclause 22.4.6.3 [locale.moneypunct] paragraph 2)
<p/>
When formatting for output (28.4.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/locale.money.put.virtuals">[locale.money.put.virtuals]</a>), it is not clear that
</p>
<ol style="list-style-type:lower-alpha">
<li><p>
"the number of characters generated for the specified format" (excluding fill padding) includes exactly 
one character for <tt>money_base::space</tt> (if present), and
</p></li>
<li><p>
all characters corresponding to <tt>money_base::space</tt> (excluding fill padding) are copies of <tt>fill</tt>.
</p></li>
</ol>
<p>
In particular, there is implementation divergence over point (b) as to whether U+0020 or <tt>fill</tt> should be used.
Further, should a character other than <tt>fill</tt> be used, it is unclear when "the fill characters are 
placed where <tt>none</tt> or <tt>space</tt> appears in the formatting pattern", whether the fill characters are placed 
at the beginning or the end of the "space field".
<p/>
I believe that a strict interpretation of the current wording supports U+0020; however, <tt>fill</tt> is more likely 
to be the pragmatic choice.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4582.
</p>
<ol>
<li><p>Change 28.4.6.3 <a href="https://timsong-cpp.github.io/cppwp/locale.moneypunct">[locale.moneypunct]</a> paragraph 2 as indicated:</p>

<blockquote>
<p>
-2- Where <tt>none</tt> or <tt>space</tt> appears, white space is permitted in the format, except where <tt>none</tt> 
appears at the end, in which case no white space is permitted. <ins>For input, the value <tt>space</tt> indicates that 
at least one space is required at that position. For output, the value <tt>space</tt> indicates one instance of the 
fill character (28.4.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/locale.money.put.virtuals">[locale.money.put.virtuals]</a>).</ins><del>The value <tt>space</tt> indicates that at least one 
space is required at that position</del>. Where <tt>symbol</tt> appears, the sequence of characters returned by 
<tt>curr_symbol()</tt> is permitted, and can be required. Where <tt>sign</tt> appears, the first (if any) of the 
sequence of characters returned by <tt>positive_sign()</tt> or <tt>negative_sign()</tt> (respectively as the monetary 
value is non-negative or negative) is required. Any remaining characters of the sign sequence are required after all 
other format components. Where <tt>value</tt> appears, the absolute numeric monetary value is required.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2695" href="2695">2695.</a> "As if" unclear in [member.functions]</h3>
<p><b>Section:</b> 16.5.5.5 <a href="https://timsong-cpp.github.io/cppwp/member.functions">[member.functions]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2016-04-15 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#member.functions">issues</a> in [member.functions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In N4582 subclause 17.6.5.5 [member.functions], the requirement that:
</p>
<blockquote><p>
any call to the member function that would select an overload from the set of declarations described in this 
standard behaves as if that overload were selected
</p></blockquote>
<p>
is unclear in the extent of the "as if". For example, in providing:
</p>
<blockquote><pre>
basic_string(const charT* s);
</pre></blockquote>
<p>
for a one-argument call to:
</p>
<blockquote><pre>
basic_string(const charT* s, const Allocator&amp; a = Allocator());
</pre></blockquote>
<p>
it can be read that an implementation may be required to call the copy constructor for the allocator since 
the core language rules for copy elision would not allow the "a" argument to be constructed directly into 
the member used to store the allocator.
<p/>
Clarification (even if just a note) would be appreciated.
</p>

<p><i>[2016-05 Issues Telecon]</i></p>

<p>
This is related to issue <a href="2563">2563</a>.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2702" href="2702">2702.</a> <tt>num_put::do_put(..., bool)</tt> performs ill-formed <tt>do_put</tt> call</h3>
<p><b>Section:</b> 28.4.2.2.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.put.virtuals">[facet.num.put.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2016-05-07 <b>Last modified:</b> 2016-05-22 15:38:38 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#facet.num.put.virtuals">active issues</a> in [facet.num.put.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#facet.num.put.virtuals">issues</a> in [facet.num.put.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The call to <tt>do_put(out, str, fill, (int)val)</tt> in N4582 subclause 28.4.2.2.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.put.virtuals">[facet.num.put.virtuals]</a> 
paragraph 6 cannot select a best viable function in overload resolution given the overloads listed for 
<tt>do_put</tt> in 28.4.2.2 <a href="https://timsong-cpp.github.io/cppwp/locale.nm.put">[locale.nm.put]</a>.
<p/>
There is implementation divergence:
</p>
<ul>
<li><p>Some implementations call the <tt>long</tt> overload (as overriden);</p></li>
<li><p>some implementations call the <tt>unsigned long</tt> overload (as overriden);</p></li>
<li><p>some implementations call something else.</p></li>
</ul>
<p>
It appears that the resolution to DR <a href="359">359</a> attempted a fix; however, the relevant portion of the 
change was not applied to the WP.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2703" href="2703">2703.</a> No provision for fill-padding when <tt>boolalpha</tt> is set</h3>
<p><b>Section:</b> 28.4.2.2.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.put.virtuals">[facet.num.put.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2016-05-07 <b>Last modified:</b> 2018-02-11 22:53:53 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#facet.num.put.virtuals">active issues</a> in [facet.num.put.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#facet.num.put.virtuals">issues</a> in [facet.num.put.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
N4582 subclause 28.4.2.2.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.put.virtuals">[facet.num.put.virtuals]</a> paragraph 6 makes no provision for fill-padding in its 
specification of the behaviour when <tt>(str.flags() &amp; ios_base::boolalpha) != 0</tt>.
</p>

<p><i>[2017-07-06, Marshall comments]</i></p>

<p>
All the other cases from <tt>num_put</tt> &mdash; <tt>int</tt>, <tt>long</tt>, etc all are covered in 
28.4.2.2.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.put.virtuals">[facet.num.put.virtuals]</a> p1 .. p5, which describe how to align and pad the output. (Specifically, 
stage 3) p6 does not.
<p/>
With this description:
</p>
<blockquote><pre>
cout &lt;&lt; std::setw(15) &lt;&lt; false;
</pre></blockquote>
<p>
outputs:
</p>
<pre>
&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;&#x2001;0
&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;&#xFE4E;// Column counter
</pre>
<p>
but
</p>
<blockquote><pre>
cout &lt;&lt; std::setw(15) &lt;&lt; boolalpha &lt;&lt; false;
</pre></blockquote>
<p>
outputs:
</p>
<pre>
false
</pre>
<p>
libc++ implements this exactly.<br/>
Dinkumware, libstdc++ and MSVC apply padding and alignment.
<p/>
I think that applying padding and alignment is more appropriate.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2705" href="2705">2705.</a> Questionable precondition on Sequence containers <tt>a.assign(n, t)</tt></h3>
<p><b>Section:</b> 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Kazutoshi Satoda <b>Opened:</b> 2016-05-08 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#sequence.reqmts">active issues</a> in [sequence.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#sequence.reqmts">issues</a> in [sequence.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Please look through the following modifications on a value <tt>v</tt> of type <tt>vector&lt;T&gt;</tt>:
</p>
<blockquote><pre>
assert(v.size() &gt; 0);
v.push_back(v[0]);
v.insert(v.begin(), v[0]);
v.resize(v.size() * 2, v[0]);
v.assign(v.size() * 2, v[0]);
</pre></blockquote>
<p>
All of these use an element of itself which may be moved or destroyed by
the modification.
<p/>
From what I see so far, the first three are required to work. Please
see library issue <a href="526">526</a> for validity of them.
<p/>
But only the last one is undefined because it violates a precondition of
a sequence container operation. I think this is too subtle.
<p/>
Should it be like that, really?
<p/>
The precondition is in Table 107 "Sequence container requirements" at the next 
of 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> p3.
</p>
<blockquote>
<p>
In Tables 107 and 108, <tt>X</tt> denotes a sequence container class,
<tt>a</tt> denotes a value of <tt>X</tt> containing elements of type <tt>T</tt>,
[&hellip;] <tt>n</tt> denotes a value of <tt>X::size_type</tt>,
[&hellip;] <tt>t</tt> denotes an lvalue or a <tt>const</tt> rvalue of <tt>X::value_type</tt>,
[&hellip;]
</p>
<p>[&hellip;]</p>
<table border="1">
<caption>Table 107 &mdash; Sequence container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a.assign(n, t)</tt>
</td>
<td><tt>void</tt></td>
<td>
<i>Requires</i>: <tt>T</tt> shall be <tt>CopyInsertable</tt> into <tt>X</tt> and <tt>CopyAssignable</tt>.<br/>
pre: <tt>t</tt> is not a reference into <tt>a</tt>.<br/>
Replaces elements in <tt>a</tt> with <tt>n</tt> copies of <tt>t</tt>.
</td>
</tr>
</table>
</blockquote>
<p>
I looked into the following implementations:
</p>
<ul>
<li><p>
libc++ relies on the precondition.
<p/>
It deallocates first on <tt>n &gt; capacity()</tt> case,
see <a href="https://github.com/llvm-mirror/libcxx/blob/release_38/include/vector#L1415">here</a>.
</p></li>
<li><p>
libstdc++ doesn't rely on the precondition.
<p/>
It creates temporary <tt>vector(n, t)</tt> and <tt>swap()</tt>
on <tt>n &gt; capacity()</tt> case, see
<a href="https://github.com/gcc-mirror/gcc/blob/gcc_5_3_0_release/libstdc%2B%2B-v3/include/bits/vector.tcc#L223">here</a>.
</p></li>
<li><p>
MSVC relies on the precondition.
<p/>
It unconditionally does <tt>clear()</tt> and then <tt>insert(begin(), n, t)</tt>.
I looked into my local "%PROGRAMFILES(X86)%/Microsoft Visual Studio 14.0/VC/include/vector".
</p></li>
</ul>
<p>
One drawback of libstdc++ implementation, I could find so far, is
possibly increased peek memory usage (both old and new buffer exist at
the same time). But, because the same can happen on the most other
modifications, it seems a reasonable trade-off to remove the
precondition to fill the subtle gap. Users who really needs less memory
usage can do <tt>clear()</tt> and <tt>insert()</tt> by themselves.
<p/>
I also found that <tt>basic_string::assign(n, c)</tt> is safe on this point.
At 21.3.2.6.3 <a href="https://timsong-cpp.github.io/cppwp/string.assign">[string.assign]</a> p17:
</p>
<blockquote>
<pre>
basic_string&amp; assign(size_type n, charT c);
</pre>
<blockquote>
<p>
<i>Effects</i>: Equivalent to <tt>assign(basic_string(n, c))</tt>.
<p/>
<i>Returns</i>: <tt>*this</tt>.
</p>
</blockquote>
</blockquote>
<p>
This can be seen as another gap.
<p/>
Looking back on the history, I found that the definition of <tt>assign(n, t)</tt>
was changed at C++14 for library issue <a href="2209">2209</a>. There were more restricting 
definitions like this:
</p>
<blockquote>
<pre>
void assign(size_type n, const T&amp; t);
</pre>
<blockquote>
<p>
<i>Effects</i>:
</p>
<blockquote><pre>
erase(begin(), end());
insert(begin(), n, t);
</pre></blockquote>
</blockquote>
</blockquote>
<p>
I think the precondition was probably set to accept this old definition
and is not required inherently. And if the less memory usage was really
intended, the standard is now underspecifying about that.
</p>

<p><i>[2016-05 Issues Telecon]</i></p>

<p>
Howard believes this should be NAD, but we tabled the discussion.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4582.
</p>

<ol>
<li><p>In 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>, edit Table 107 (Sequence container requirements) as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 107 &mdash; Sequence container requirements (in addition to container)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>a.assign(n, t)</tt>
</td>
<td><tt>void</tt></td>
<td>
<i>Requires</i>: <tt>T</tt> shall be <tt>CopyInsertable</tt> into <tt>X</tt> and <tt>CopyAssignable</tt>.<br/>
<del>pre: <tt>t</tt> is not a reference into <tt>a</tt>.</del><br/> 
Replaces elements in <tt>a</tt> with <tt>n</tt> copies of <tt>t</tt>.
</td>
</tr>
</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2708" href="2708">2708.</a> <tt>recursive_directory_iterator::recursion_pending()</tt> is incorrectly specified</h3>
<p><b>Section:</b> 29.11.13.1 <a href="https://timsong-cpp.github.io/cppwp/fs.rec.dir.itr.members">[fs.rec.dir.itr.members]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Eric Fiselier <b>Opened:</b> 2016-05-09 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#fs.rec.dir.itr.members">issues</a> in [fs.rec.dir.itr.members].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current specification of <tt>recursion_pending()</tt> says (29.11.13.1 <a href="https://timsong-cpp.github.io/cppwp/fs.rec.dir.itr.members">[fs.rec.dir.itr.members]</a>/24):
</p>
<blockquote><p>
<i>Returns</i>: <tt>true</tt> if <tt>disable_recursion_pending()</tt> has not been called subsequent to the prior construction
or increment operation, otherwise <tt>false</tt>.
</p></blockquote>
<p>
This language does not take into account cases where the prior construction was a copy construction from a iterator,
<tt>it</tt>, where <tt>it.recursion_pending() == false</tt>.
</p>

<p><i>[2016-08 Chicago]</i></p>

<p>Wed AM: Move to Open</p>

<p><i>[2018-1-26 issues processing telecon]</i></p>

<p>Status to 'Tentatively Ready'; Casey will explore whether making <tt>recursion_pending</tt> an exposition-only member makes this clearer.</p>

<strong>Previous resolution from Eric [SUPERSEDED]:</strong>
<blockquote class="note">
<p>
This wording is relative to N4582.
</p>

<ol>
<li><p>Change 29.11.13.1 <a href="https://timsong-cpp.github.io/cppwp/fs.rec.dir.itr.members">[fs.rec.dir.itr.members]</a> as indicated:</p>

<blockquote>
<pre>
explicit recursive_directory_iterator(const path&amp; p);
recursive_directory_iterator(const path&amp; p, directory_options options);
recursive_directory_iterator(const path&amp; p, directory_options options, error_code&amp; ec) noexcept;
recursive_directory_iterator(const path&amp; p, error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-3- <i>Postcondition</i>: <del><tt>options() == options</tt> for the signatures with a <tt>directory_options</tt> argument,
otherwise <tt>options() == directory_options::none</tt>.</del>
</p>
<ul>
<li><p><ins><tt>options() == options</tt> for the signatures with a <tt>directory_options</tt> argument, otherwise
<tt>options() == directory_options::none</tt>.</ins></p></li>
<li><p><ins><tt>recursion_pending() == true</tt>.</ins></p></li>
</ul>
<p>
[&hellip;]
</p>
</blockquote>
<blockquote class="note">
<p>
[<i>Drafting note</i>: The following changes the specification of <tt>recursion_pending()</tt> seemingly recursive.
Perhaps it would be easier to specify <tt>recursion_pending()</tt> in terms of a exposition only member in
<tt>recursive_directory_iterator</tt>.]
</p>
</blockquote>
<pre>
bool recursion_pending() const;
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-24- <i>Returns</i>: <del><tt>true</tt> if <tt>disable_recursion_pending()</tt> has not been called subsequent to the
prior construction or increment operation, otherwise <tt>false</tt></del><ins><tt>false</tt> if
<tt>disable_recursion_pending()</tt> has been called subsequent to the prior construction or increment operation,
otherwise the value of <tt>recursion_pending()</tt> set by that operation</ins>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
recursive_directory_iterator&amp; operator++();
recursive_directory_iterator&amp; increment(error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-27- <i>Effects</i>: As specified by Input iterators (24.2.3), except that: [&hellip;]
<p/>
<ins>-?- <i>Postcondition</i>: <tt>recursion_pending() == true</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-01-29: Casey provides a PR with an exposition-only member]</i></p>

<p>Status to 'Review'.</p>
<strong>Previous resolution from Casey [SUPERSEDED]:</strong>
<blockquote class="note">
<p>
This wording is relative to N4713.
</p>

<ol>
<li><p>Change  [fs.rec.dir.itr] as indicated:</p>
<blockquote>
<pre>
    [&hellip;]

    // other members as required by 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>, input iterators

  <ins>private:</ins>
    <ins>bool recurse_; // exposition-only</ins>
  };
}
</pre>
</blockquote>
</li>

<li><p>Change 29.11.13.1 <a href="https://timsong-cpp.github.io/cppwp/fs.rec.dir.itr.members">[fs.rec.dir.itr.members]</a> as indicated:</p>

<blockquote>
<pre>
explicit recursive_directory_iterator(const path&amp; p);
recursive_directory_iterator(const path&amp; p, directory_options options);
recursive_directory_iterator(const path&amp; p, directory_options options, error_code&amp; ec) noexcept;
recursive_directory_iterator(const path&amp; p, error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
[&hellip;]
</p><p>
-3- <i>Postconditions</i>: <del><tt>options() == options</tt> for the signatures with a <tt>directory_options</tt> argument,
otherwise <tt>options() == directory_options::none</tt>.</del>
</p>
<ul>
<li><p><ins><tt>options() == options</tt> for the signatures with a <tt>directory_options</tt> argument, otherwise
<tt>options() == directory_options::none</tt>.</ins></p></li>
<li><p><ins><tt>recurse_ == true</tt>.</ins></p></li>
</ul>
<p>
[&hellip;]
</p>
</blockquote>

<pre>
recursive_directory_iterator(const recursive_directory_iterator&amp; rhs);
</pre>
<blockquote>
<p>
[&hellip;]
</p><p>
-8- <i>Postconditions:</i>
</p><p>
[&hellip;]
</p><p>
(8.3) &mdash; <del><tt>recursion_pending() == rhs.recursion_pending()</tt></del><ins><tt>recurse_ == rhs.recurse_</tt></ins>
</p>
</blockquote>

<pre>
recursive_directory_iterator(recursive_directory_iterator&amp;&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
[&hellip;]
</p><p>
-10- <i>Postconditions:</i> <tt>options()</tt>, <tt>depth()</tt>, and
<del><tt>recursion_pending()</tt></del><ins><tt>recurse_</tt></ins> have the values that <tt>rhs.options()</tt>,
<tt>rhs.depth()</tt>, and <del><tt>rhs.recursion_pending()</tt></del><ins><tt>rhs.recurse_</tt></ins>, respectively,
had before the function call.
</p>
</blockquote>

<pre>
recursive_directory_iterator&amp; operator=(const recursive_directory_iterator&amp; rhs);
</pre>
<blockquote>
<p>
[&hellip;]
</p><p>
-12- <i>Postconditions:</i>
</p><p>
[&hellip;]
</p><p>
(12.3) &mdash; <del><tt>recursion_pending() == rhs.recursion_pending()</tt></del><ins><tt>recurse_ == rhs.recurse_</tt></ins>
</p><p>
[&hellip;]
</p>
</blockquote>

<pre>
recursive_directory_iterator&amp; operator=(recursive_directory_iterator&amp;&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
[&hellip;]
</p><p>
-15- <i>Postconditions:</i> <tt>options()</tt>, <tt>depth()</tt>, and
<del><tt>recursion_pending()</tt></del><ins><tt>recurse_</tt></ins> have the values that <tt>rhs.options()</tt>,
<tt>rhs.depth()</tt>, and <del><tt>rhs.recursion_pending()</tt></del><ins><tt>rhs.recurse_</tt></ins>, respectively,
had before the function call.
</p><p>
[&hellip;]
</p>
</blockquote>

<pre>
bool recursion_pending() const;
</pre>
<blockquote>
<p>
-21- <i>Returns</i>: <del><tt>true</tt> if <tt>disable_recursion_pending()</tt> has not been called subsequent to the
prior construction or increment operation, otherwise <tt>false</tt></del><ins>recurse_</ins>.
</p><p>
[&hellip;]
</p>
</blockquote>

<pre>
recursive_directory_iterator&amp; operator++();
recursive_directory_iterator&amp; increment(error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
-23- <i>Effects</i>: As specified for the prefix increment operation of Input iterators
( [iterators.input]), except that:
</p><p>
[&hellip;]
</p><p>
<ins>-?- <i>Postcondition</i>: <tt>recurse_ == true</tt>.</ins>
</p>
</blockquote>

<pre>
void disable_recursion_pending();
</pre>
<blockquote>
<p>
-28- <i>Postcondition<del>s</del>:</i> <tt><del>recursion_pending()</del><ins>recurse_</ins> == false</tt>.
</p><p>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-05-23: Casey restores the intended design with an expansion of the original PR]</i></p>

<p>
The intended design is that all copies of a single <tt>recursive_directory_iterator</tt> share a
common block of state which includes the values returned by <tt>options</tt>, <tt>depth</tt>, and
<tt>recursion_pending</tt> - hence the mandate that those functions not be called on a
non-dereferenceable iterator in 29.11.13 <a href="https://timsong-cpp.github.io/cppwp/fs.class.rec.dir.itr">[fs.class.rec.dir.itr]</a> para 2. To allow an
implementation with such shared state, it's necessary to make changes to the value returned by
<tt>recursion_pending()</tt> visible to <em>all copies</em> of the same dereferenceable iterator.
</p><p>
Also:
</p>
<ul>
<li><p><tt>pop</tt> notionally calls <tt>increment</tt> repeatedly until the current directory is
exhausted, <tt>pop</tt> should affect the value of <tt>recursion_pending</tt> similarly to
<tt>increment</tt>.</p></li>
<li><p><tt>options</tt> is not valid for all constructor signatures described by
29.11.13.1 <a href="https://timsong-cpp.github.io/cppwp/fs.rec.dir.itr.members">[fs.rec.dir.itr.members]</a> para 2.</p></li>
<li><p>the copies and moves don't specify what they actually <i>do</i></p></li>
<li><p>it's not quite kosher for the copies and moves to have postconditions on the value of
expressions that have UB if the iterator copied/moved from is not dereferenceable.</p></li>
</ul>

<p><i>[2018-06, Rapperswil, Wednesday evening]</i></p>

<p>
JW: p21 currently can just say "unspecified"<br/>
BO: if we are OK with only remote implementations we can remove the unspecifiedness<br/>
BO: the problematic business is the "recursion pending" bit<br/>
JW: I want time to work on this
<p/>
Move to open and note that Jonathan is reviewing and making recommendations.
</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>General agreement that flag should be shared; Casey to reword.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4750.
</p>

<ol>
<li><p>Change 29.11.13.1 <a href="https://timsong-cpp.github.io/cppwp/fs.rec.dir.itr.members">[fs.rec.dir.itr.members]</a> as indicated:</p>

<blockquote>
<pre>
explicit recursive_directory_iterator(const path&amp; p);
recursive_directory_iterator(const path&amp; p, directory_options options);
recursive_directory_iterator(const path&amp; p, directory_options options, error_code&amp; ec) noexcept;
recursive_directory_iterator(const path&amp; p, error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- For the signatures with no parameter <tt>options</tt>, let <tt>options</tt> be
<tt>directory_options::none</tt>.</ins>
</p><p>
-2- <i>Effects</i>: [&hellip;]
</p><p>
-3- <i>Postconditions</i>: <del><tt>options() == options</tt> for the signatures with a
<tt>directory_options</tt> argument, otherwise <tt>options() == directory_options::none</tt>.</del>
</p>
<ul>
<li><p><ins><tt>this->options() == options</tt></ins></p></li>
<li><p><ins><tt>recursion_pending() == true</tt></ins></p></li>
</ul>
<p>
[&hellip;]
</p>
</blockquote>
<pre>
recursive_directory_iterator(const recursive_directory_iterator&amp; rhs);
</pre>
<blockquote>
<p>
-7- <i>Effects</i>: Constructs an <del>object of class <tt>recursive_directory_iterator</tt></del>
<ins>iterator that denotes the same directory entry as <tt>rhs</tt>, if any.</ins>.
</p><p>
-8- <i>Postconditions</i>: <ins>If <tt>rhs</tt> is dereferenceable,</ins>
</p><p>
[&hellip;]
</p>
</blockquote>
<pre>
recursive_directory_iterator(recursive_directory_iterator&amp;&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
-9- <i>Effects</i>: Constructs an <del>object of class <tt>recursive_directory_iterator</tt></del>
<ins>iterator that denotes the directory entry denoted by <tt>rhs</tt> before the function call, if
any.</ins>.
</p><p>
-10- <i>Postconditions</i>: <ins>If <tt>rhs</tt> is dereferenceable,</ins>  [&hellip;]
</p>
</blockquote>
<pre>
recursive_directory_iterator&amp; operator=(const recursive_directory_iterator&amp; rhs);
</pre>
<blockquote>
<p>
-11- <i>Effects</i>: <del>If <tt>*this</tt> and <tt>rhs</tt> are the same object, the member has no
effect.</del> <ins>Causes <tt>*this</tt> to denote the same directory entry denoted by <tt>rhs</tt>,
if any.</ins>
</p><p>
-12- <i>Postconditions</i>: <ins>If <tt>rhs</tt> is dereferenceable,</ins>
</p><p>
[&hellip;]
</p>
</blockquote>
<pre>
recursive_directory_iterator&amp; operator=(recursive_directory_iterator&amp;&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
-14- <i>Effects</i>: <del>If <tt>*this</tt> and <tt>rhs</tt> are the same object, the member has no
effect.</del> <ins>Causes <tt>*this</tt> to denote the directory entry denoted by <tt>rhs</tt>
before the function call, if any.</ins>
</p><p>
-15- <i>Postconditions</i>: <ins>If <tt>rhs</tt> was dereferenceable before the function call,</ins>
[&hellip;]
</p><p>
-16- <i>Returns</i>: <tt>*this</tt>.
</p><p>
<ins>-x- <i>Remarks</i>: If <tt>*this</tt> and <tt>rhs</tt> do not refer to the same object, the
resulting state of <tt>rhs</tt> is unspecified (16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>).</ins>
</p>
</blockquote>
<pre>
directory_options options() const;
</pre>
<blockquote>
<p>
-17- <i>Returns</i>: The value <del>of the argument passed to the constructor for the <tt>options</tt>
parameter, if present, otherwise <tt>directory_options::none</tt></del> <ins>established by the most
recently called member that has a postcondition for <tt>options()</tt></ins>.
</p><p>
[&hellip;]
</p>
</blockquote>
<pre>
bool recursion_pending() const;
</pre>
<blockquote>
<p>
-21- <i>Returns</i>: <del><tt>true</tt> if <tt>disable_recursion_pending()</tt> has not been called
subsequent to the prior construction or increment operation, otherwise <tt>false</tt>.</del> <ins>If
<tt>disable_recursion_pending()</tt> has been called on a copy of <tt>*this</tt>, an unspecified
value. Otherwise, the value established for <tt>recursion_pending()</tt> by the postcondition of the
most recent construction, assignment, increment, or <tt>disable_recursion_pending</tt> operation.</ins>
</p><p>
[&hellip;]
</p>
</blockquote>
<pre>
recursive_directory_iterator&amp; operator++();
recursive_directory_iterator&amp; increment(error_code&amp; ec);
</pre>
<blockquote>
<p>
-23- <i>Effects</i>: As specified for the prefix increment operation of Input iterators
(23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>), except that: [&hellip;]
</p><p>
<ins>-?- <i>Postconditions</i>: If <tt>*this</tt> is dereferenceable,
<tt>recursion_pending() == true</tt>.</ins>
</p><p>
[&hellip;]
</p>
</blockquote>
<pre>
void pop();
void pop(error_code&amp; ec);
</pre>
<blockquote>
<p>
-26- <i>Effects</i>: If <tt>depth() == 0</tt>, set <tt>*this</tt> to
<tt>recursive_directory_iterator()</tt>. [&hellip;]
</p><p>
<ins>-?- <i>Postconditions</i>: If <tt>*this</tt> is dereferenceable,
<tt>recursion_pending() == true</tt>.</ins>
</p><p>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2713" href="2713">2713.</a> More missing allocator-extended constructors for unordered containers</h3>
<p><b>Section:</b> 22.5 <a href="https://timsong-cpp.github.io/cppwp/unord">[unord]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy Robert O'Neal III <b>Opened:</b> 2016-05-20 <b>Last modified:</b> 2017-08-04 19:19:38 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#unord">issues</a> in [unord].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The resolution of LWG <a href="2210">2210</a> missed constructors accepting a range or initializer list and allocator.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to N4582.</p>
<ol>
<li><p>Add to the synopsis in 22.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/unord.map.overview">[unord.map.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key, class T,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;std::pair&lt;const Key, T&gt; &gt; &gt; {
  class unordered_map {
  public:
    [&hellip;]
    unordered_map(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_map(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, const allocator_type&amp; a)
      : unordered_map(f, l, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_map(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_map(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_map(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
      : unordered_map(il, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    unordered_map(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_map(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Add to the synopsis in 22.5.5.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.overview">[unord.multimap.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key, class T,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;std::pair&lt;const Key, T&gt; &gt; &gt; {
  class unordered_multimap {
  public:
    [&hellip;]
    unordered_multimap(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_multimap(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, const allocator_type&amp; a)
      : unordered_multimap(f, l, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_multimap(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_multimap(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_multimap(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
      : unordered_multimap(il, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    unordered_multimap(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_multimap(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Add to the synopsis in 22.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/unord.set.overview">[unord.set.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;Key&gt; &gt; {
  class unordered_set {
  public:
    [&hellip;]
    unordered_set(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_set(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, const allocator_type&amp; a)
      : unordered_set(f, l, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_set(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_set(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_set(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
      : unordered_set(il, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    unordered_set(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_set(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Add to the synopsis in 22.5.7.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.overview">[unord.multiset.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;Key&gt; &gt; {
  class unordered_multiset {
  public:
    [&hellip;]
    unordered_multiset(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_multiset(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, const allocator_type&amp; a)
      : unordered_multiset(f, l, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_multiset(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_multiset(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_multiset(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
      : unordered_multiset(il, <em>see below</em>, hasher(), key_equal(), a) { }</ins>
    unordered_multiset(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_multiset(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>
</ol>

</blockquote>

<p><i>[2016-06, Oulu &mdash; Daniel comments and provides new wording]</i></p>

<p>
During the LWG discussion of this issue it has been observed, that the interpretation of the embedded <i>see below</i>
is not really clear and that we should split declaration and definition of the new overloads, so that we have a place
that allows us to specify what "<i>see below</i>" stands for. In addition, the new wording wraps the "<i>see below</i>"
as "<tt>size_type(<i>see below</i>)</tt>" to clarify the provided expression type, similar as we did for the default
constructor of <tt>unordered_map</tt>.
</p>

<p><i>[Oulu, 2016-06]</i></p>

<p>Alisdair to review wording.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to N4594.</p>
<ol>
<li><p>Add to the synopsis in 22.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/unord.map.overview">[unord.map.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key, class T,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;std::pair&lt;const Key, T&gt; &gt; &gt; {
  class unordered_map {
  public:
    [&hellip;]
    unordered_map(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_map(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_map(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_map(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_map(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_map(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_map(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/unord.map.cnstr">[unord.map.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_map(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_map(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_map(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_map(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The number of buckets is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Add to the synopsis in 22.5.5.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.overview">[unord.multimap.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key, class T,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;std::pair&lt;const Key, T&gt; &gt; &gt; {
  class unordered_multimap {
  public:
    [&hellip;]
    unordered_multimap(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_multimap(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_multimap(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_multimap(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_multimap(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_multimap(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_multimap(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.cnstr">[unord.multimap.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_multimap(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_multimap(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_multimap(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_multimap(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The number of buckets is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Add to the synopsis in 22.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/unord.set.overview">[unord.set.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;Key&gt; &gt; {
  class unordered_set {
  public:
    [&hellip;]
    unordered_set(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_set(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_set(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_set(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_set(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_set(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_set(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/unord.set.cnstr">[unord.set.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_set(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_set(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_set(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_set(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The number of buckets is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Add to the synopsis in 22.5.7.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.overview">[unord.multiset.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;Key&gt; &gt; {
  class unordered_multiset {
  public:
    [&hellip;]
    unordered_multiset(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_multiset(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_multiset(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_multiset(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_multiset(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_multiset(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_multiset(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.7.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.cnstr">[unord.multiset.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_multiset(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_multiset(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_multiset(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_multiset(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The number of buckets is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

</ol>
</blockquote>

<p><i>[2017-08-04, Daniel and Alisdair finetune wording]</i></p>

<p>
We decided to improve the added <i>Remarks:</i> elements by changing from the previous form:
</p>
<blockquote>
<p>
<i>Remarks:</i> The number of buckets is implementation-defined.
</p>
</blockquote>
<p>
to the more elaborate form:
</p>
<blockquote>
<p>
<i>Remarks:</i> The initial number of buckets supplied by the <tt>size_type</tt> argument is implementation-defined.
</p>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>This resolution is relative to <a href="http://wg21.link/n4687">N4687</a>.</p>

<ol>
<li><p>Add to the synopsis in 22.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/unord.map.overview">[unord.map.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key, class T,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;std::pair&lt;const Key, T&gt; &gt; &gt; {
  class unordered_map {
  public:
    [&hellip;]
    unordered_map(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_map(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_map(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_map(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_map(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_map(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_map(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_map(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/unord.map.cnstr">[unord.map.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_map(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_map(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_map(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_map(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The initial number of buckets supplied by the <tt>size_type</tt> argument is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Add to the synopsis in 22.5.5.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.overview">[unord.multimap.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key, class T,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;std::pair&lt;const Key, T&gt; &gt; &gt; {
  class unordered_multimap {
  public:
    [&hellip;]
    unordered_multimap(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_multimap(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_multimap(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_multimap(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_multimap(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_multimap(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_multimap(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_multimap(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.5.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.cnstr">[unord.multimap.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_multimap(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_multimap(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_multimap(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_multimap(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The initial number of buckets supplied by the <tt>size_type</tt> argument is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Add to the synopsis in 22.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/unord.set.overview">[unord.set.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;Key&gt; &gt; {
  class unordered_set {
  public:
    [&hellip;]
    unordered_set(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_set(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_set(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_set(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_set(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_set(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_set(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_set(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/unord.set.cnstr">[unord.set.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_set(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_set(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_set(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_set(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The initial number of buckets supplied by the <tt>size_type</tt> argument is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

<li><p>Add to the synopsis in 22.5.7.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.overview">[unord.multiset.overview]</a> p3:</p>

<blockquote>
<pre>
namespace std {
  template &lt;class Key,
    class Hash = hash&lt;Key&gt;,
    class Pred = std::equal_to&lt;Key&gt;,
    class Allocator = std::allocator&lt;Key&gt; &gt; {
  class unordered_multiset {
  public:
    [&hellip;]
    unordered_multiset(size_type n, const hasher&amp; hf, const allocator_type&amp; a)
      : unordered_multiset(n, hf, key_equal(), a) { }
    <ins>template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, const allocator_type&amp; a);</ins>
    template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, size_type n, const allocator_type&amp; a)
      : unordered_multiset(f, l, n, hasher(), key_equal(), a) { }
    template &lt;class InputIterator&gt;
      unordered_multiset(InputIterator f, InputIterator l, size_type n, const hasher&amp; hf,
            const allocator_type&amp; a)
      : unordered_multiset(f, l, n, hf, key_equal(), a) { }
    <ins>unordered_multiset(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a);</ins>
    unordered_multiset(initializer_list&lt;value_type&gt; il, size_type n, const allocator_type&amp; a)
      : unordered_multiset(il, n, hasher(), key_equal(), a) { }
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Insert the following new prototype specification just after 22.5.7.2 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.cnstr">[unord.multiset.cnstr]</a> p2</p>

<blockquote>
<pre>
<ins>template &lt;class InputIterator&gt;
  unordered_multiset(InputIterator f, InputIterator l, const allocator_type&amp; a)
    : unordered_multiset(f, l, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>

<ins>unordered_multiset(initializer_list&lt;value_type&gt; il, const allocator_type&amp; a)
  : unordered_multiset(il, size_type(<em>see below</em>), hasher(), key_equal(), a) { }</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> The initial number of buckets supplied by the <tt>size_type</tt> argument is implementation-defined.</ins>
</p>
</blockquote>
</blockquote>

</li>

</ol>






<hr>
<h3><a name="2714" href="2714">2714.</a> <tt>complex</tt> stream extraction underspecified</h3>
<p><b>Section:</b> 26.4.6 <a href="https://timsong-cpp.github.io/cppwp/complex.ops">[complex.ops]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2016-05-23 <b>Last modified:</b> 2018-10-16 20:43:45 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#complex.ops">issues</a> in [complex.ops].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The specification of <tt>operator&gt;&gt;(istream&amp;, complex&lt;T&gt;&amp;)</tt> is extremely short on details. 
It currently reads, in its entirety (26.4.6 <a href="https://timsong-cpp.github.io/cppwp/complex.ops">[complex.ops]</a>/12-15):
</p>
<blockquote class="note">
<pre>
template&lt;class T, class charT, class traits&gt;
basic_istream&lt;charT, traits&gt;&amp; operator&gt;&gt;(basic_istream&lt;charT, traits&gt;&amp; is, complex&lt;T&gt;&amp; x);
</pre>
<blockquote>
<p>
<i>Effects:</i> Extracts a complex number <tt>x</tt> of the form: <tt>u</tt>, <tt>(u)</tt>, or <tt>(u,v)</tt>, 
where <tt>u</tt> is the real part and <tt>v</tt> is the imaginary part (29.7.4.2 <a href="https://timsong-cpp.github.io/cppwp/istream.formatted">[istream.formatted]</a>).
<p/>
<i>Requires:</i> The input values shall be convertible to <tt>T</tt>.
<p/>
If bad input is encountered, calls <tt>is.setstate(ios_base::failbit)</tt> (which may throw <tt>ios::failure</tt> 
(29.5.5.4 <a href="https://timsong-cpp.github.io/cppwp/iostate.flags">[iostate.flags]</a>)).
<p/>
<i>Returns:</i> <tt>is</tt>.
<p/>
<i>Remarks:</i> This extraction is performed as a series of simpler extractions. Therefore, the skipping of whitespace 
is specified to be the same for each of the simpler extractions.
</p>
</blockquote>
</blockquote>
<p>
It is completely unclear:
</p>
<ul>
<li>which "simpler extractions" are performed,</li>
<li>how the extracted characters are matched to the special characters <tt>'('</tt>, <tt>')'</tt> and <tt>','</tt> 
(by <tt>==</tt>, or by <tt>traits::eq</tt>),</li>
<li>what is left in the stream on failure. (For example, with <tt>"(0, 0]"</tt>, libstdc++ extracts the <tt>]</tt> 
while libc++ leaves it in the stream.)</li>
</ul>
<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<blockquote class="note">
<i>Drafting note:</i> the following wording is based on:
<ul>
<li>Characters are extracted using <tt>operator&gt;&gt;</tt> and compared using <tt>traits::eq</tt>.</li>
<li>Mismatched characters are returned to the stream. </li>
</ul>
</blockquote>
<p>This wording is relative to N4582.</p>
<ol>
<li><p>Replace 26.4.6 <a href="https://timsong-cpp.github.io/cppwp/complex.ops">[complex.ops]</a>/12-15 with the following paragraphs:</p>

<blockquote>
<pre>
template&lt;class T, class charT, class traits&gt;
basic_istream&lt;charT, traits&gt;&amp;
operator&gt;&gt;(basic_istream&lt;charT, traits&gt;&amp; is, complex&lt;T&gt;&amp; x);
</pre>
<blockquote>
<p>
-?- <i>Effects:</i> First, extracts a character from <tt>is</tt>.
<ul>
<li>If the character extracted is equal to <tt>is.widen('(')</tt>, extracts an object <tt>u</tt> of type <tt>T</tt> from <tt>is</tt>, 
then extracts a character from <tt>is</tt>.
<ul>
    <li>
    If this character is equal to <tt>is.widen(')')</tt>, then assigns <tt>complex&lt;T&gt;(u)</tt> to <tt>x</tt>.
    </li>
    <li>
      Otherwise, if this character is equal to <tt>is.widen(',')</tt>, extracts an object <tt>v</tt> of type <tt>T</tt> 
      from <tt>is</tt>, then extracts a character from <tt>is</tt>.
      If this character is equal to <tt>is.widen(')')</tt>, then assigns <tt>complex&lt;T&gt;(u, v)</tt> to <tt>x</tt>;
      otherwise returns the character to <tt>is</tt> and the extraction fails.
    </li>
    <li>
      Otherwise, returns the character to <tt>is</tt> and the extraction fails.
    </li>
  </ul>
</li>
<li> Otherwise, returns the character to <tt>is</tt>, extracts an object <tt>u</tt> of type <tt>T</tt> from <tt>is</tt>, and 
assigns <tt>complex&lt;T&gt;(u)</tt> to <tt>x</tt>.
</li>
</ul>
In the description above, characters are extracted from <tt>is</tt> as if by <tt>operator&gt;&gt;</tt> 
(29.7.4.2.3 <a href="https://timsong-cpp.github.io/cppwp/istream.extractors">[istream.extractors]</a>), and returned to the stream as if by <tt>basic_istream::putback</tt> 
(29.7.4.3 <a href="https://timsong-cpp.github.io/cppwp/istream.unformatted">[istream.unformatted]</a>). Character equality is determined using <tt>traits::eq</tt>.
An object <tt>t</tt> of type <tt>T</tt> is extracted from <tt>is</tt> as if by <tt> is &gt;&gt; t</tt>.
<p/>
If any extraction operation fails, no further operation is performed and the whole extraction fails.
<p/>
On failure, calls <tt>is.setstate(ios_base::failbit)</tt> (which may throw <tt>ios::failure</tt>
(29.5.5.4 <a href="https://timsong-cpp.github.io/cppwp/iostate.flags">[iostate.flags]</a>)).
<p/>
-?- <i>Returns:</i> <tt>is</tt>.
<p/>
-?- [<i>Note</i>: This extraction is performed as a series of simpler extractions. Therefore, the skipping of whitespace
is specified to be the same for each of the simpler extractions. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>
<p><i>[2017-12-13 Tim Song adjusts the P/R to avoid relying on <tt>putback</tt>.]</i></p>



<p><b>Proposed resolution:</b></p>
<blockquote class="note">
<i>Drafting note:</i> the following wording assumes that:
<ul>
<li>Characters are extracted using <tt>operator&gt;&gt;</tt> and compared using <tt>traits::eq</tt>.</li>
<li>Mismatched characters are not extracted. </li>
<li><tt>x</tt> is assigned a value-initialized <tt>complex</tt> on failure for consistency with the arithmetic 
extractors (compare LWG <a href="696">696</a>). </li>
</ul>
</blockquote>
<p>This wording is relative to <a href="https://wg21.link/N4778">N4778</a>.</p>
<ol>
<li><p>Replace 26.4.6 <a href="https://timsong-cpp.github.io/cppwp/complex.ops">[complex.ops]</a>/12-16 with the following paragraphs:</p>

<blockquote>
<pre>
template&lt;class T, class charT, class traits&gt;
basic_istream&lt;charT, traits&gt;&amp;
operator&gt;&gt;(basic_istream&lt;charT, traits&gt;&amp; is, complex&lt;T&gt;&amp; x);
</pre>
<blockquote>
<p>
-?- <i>Effects:</i> Let <tt><i>PEEK</i>(is)</tt> be a formatted input function (29.7.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/istream.formatted.reqmts">[istream.formatted.reqmts]</a>) of 
<tt>is</tt> that returns the next character that 
would be extracted from <tt>is</tt> by <tt>operator&gt;&gt;</tt>. [<i>Note</i>: The <tt>sentry</tt> object is constructed 
and destroyed,
 but the returned character is not extracted from the stream. &mdash; <i>end note</i>] 
<ul>
<li>If <tt><i>PEEK</i>(is)</tt> is not equal to <tt>is.widen('(')</tt>, extracts an object <tt>u</tt> of type <tt>T</tt> 
from <tt>is</tt>, and assigns <tt>complex&lt;T&gt;(u)</tt> to <tt>x</tt>.</li>
<li>Otherwise, extracts that character from <tt>is</tt>, then extracts an object <tt>u</tt> of type <tt>T</tt> from <tt>is</tt>, then:
<ul>
   <li>If <tt><i>PEEK</i>(is)</tt> is equal to <tt>is.widen(')')</tt>, then extracts that character from <tt>is</tt> and 
   assigns <tt>complex&lt;T&gt;(u)</tt> to <tt>x</tt>. </li>
   <li>Otherwise, if it is equal to <tt>is.widen(',')</tt>, then extracts that character from <tt>is</tt> and then extracts 
   an object <tt>v</tt> of type <tt>T</tt> from <tt>is</tt>, then:
    <ul>
       <li>If <tt><i>PEEK</i>(is)</tt> is equal to <tt>is.widen(')')</tt>, then extracts that character from <tt>is</tt> and 
       assigns <tt>complex&lt;T&gt;(u, v)</tt> to <tt>x</tt>.</li>
       <li> Otherwise, the extraction fails.</li>
    </ul>
   </li>
   <li>Otherwise, the extraction fails.</li>
</ul>
</li>
</ul>
In the description above, characters are extracted from <tt>is</tt> as if by <tt>operator&gt;&gt;</tt> (29.7.4.2.3 <a href="https://timsong-cpp.github.io/cppwp/istream.extractors">[istream.extractors]</a>), character equality is determined using <tt>traits::eq</tt>, and an object <tt>t</tt> of type <tt>T</tt> is extracted from <tt>is</tt> 
as if by <tt> is &gt;&gt; t</tt>.
<p/>
If any extraction operation fails, no further operation is performed and the whole extraction fails.
<p/>
On failure, assigns <tt>complex&lt;T&gt;()</tt> to <tt>x</tt> and calls <tt>is.setstate(ios_base::failbit)</tt> (which may throw 
<tt>ios::failure</tt> (29.5.5.4 <a href="https://timsong-cpp.github.io/cppwp/iostate.flags">[iostate.flags]</a>)).
<p/>
-?- <i>Returns:</i> <tt>is</tt>.
<p/>
-?- [<i>Note</i>: This extraction is performed as a series of simpler extractions. Therefore, the skipping of whitespace
is specified to be the same for each of the simpler extractions. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2730" href="2730">2730.</a> <tt>numeric_limits</tt> primary template definition</h3>
<p><b>Section:</b> 17.3.5 <a href="https://timsong-cpp.github.io/cppwp/numeric.limits">[numeric.limits]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2016-06-09 <b>Last modified:</b> 2018-11-12 05:21:03 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#numeric.limits">active issues</a> in [numeric.limits].</p>
<p><b>View all other</b> <a href="lwg-index.html#numeric.limits">issues</a> in [numeric.limits].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I've received this report at the <a href="mailto:cxxeditor@gmail.com">project editor mail alias</a>, and it seems like it may be worthy of a LWG issue:
</p>
<blockquote class="note">
<p>
I recently had this problem: 
</p>
<ul>
<li>I was storing data in a vector of <tt>__uint128_t</tt>s</li>
<li>I used a sorting library which used <tt>numeric_limits&lt;T&gt;::max()</tt> as a sentinel value</li>
<li>GCC's libstdc++ provides a <tt>numeric_limits</tt> specialisation for that type, but</li>
<li>Clang's libc++ does not.</li>
</ul>
<p>
This broke the sorting for me on different platforms, and it was quite difficult to determine why. If the default 
<tt>numeric_limits</tt> didn't default to <tt>0</tt>s and <tt>false</tt> values (18.3.2.4 of N4582), and instead 
<tt>static_assert</tt>ed, causing my code to not compile, I would have found the solution immediately.
<p/>
I know that <tt>__uint128_t</tt> is non-standard, so neither GCC nor Clang is doing the wrong thing nor the right thing 
here. I could just submit a patch to libc++ providing the specialisations, but it doesn't fix the problem at its core.
<p/>
I am wondering, what is the rationale behind the defaults being <tt>0</tt> and <tt>false</tt>? It seems like it is 
inviting a problem for any future numeric types, whether part of a library, compiler extension, and possibly even 
future updates to C++'s numeric types. I think it would be much better to prevent code that tries to use 
unspecified <tt>numeric_limits</tt> from compiling.
</p>
</blockquote>
<p>
An alternative to this suggestion would be to still define the primary template, but not provide any of the members 
except <tt>is_specialized</tt>. Either way, this would make <tt>numeric_limits</tt> members SFINAEable.
<p/>
Along the same lines, one might wonder why the members that only make sense for floating-point types are required to 
be defined to nonsense values for integer types.
</p>

<p><i>[2016-11-12, Issaquah]</i></p>

<p>Sat PM: This looks like a good idea. Jonathan and Marshall will do post C++17 implementations and report back.</p>

<p><i>[2018-11 San Diego Thursday night issue processing]</i></p>

<p>See Walter's paper P0437 for ideas and/or future directions.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2731" href="2731">2731.</a> Existence of <tt>lock_guard&lt;MutexTypes...&gt;::mutex_type</tt> typedef unclear</h3>
<p><b>Section:</b> 32.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.guard">[thread.lock.guard]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Eric Fiselier <b>Opened:</b> 2016-06-13 <b>Last modified:</b> 2018-03-19 00:12:24 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#thread.lock.guard">issues</a> in [thread.lock.guard].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In the synopsis of 32.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.scoped">[thread.lock.scoped]</a> the <tt>mutex_type</tt> typedef is specified as follows:
</p>
<blockquote>
<pre>
template &lt;class... MutexTypes&gt;
class scoped_lock {
public:
  typedef Mutex mutex_type; <i>// If</i> MutexTypes... <i>consists of the single type</i> Mutex
  [&hellip;]
};
</pre>
</blockquote>
<p>
The comment seems ambiguous as it could mean either:
</p>
<ol>
<li><tt>sizeof...(MutexTypes) == 1</tt>.</li>
<li><tt>sizeof...(MutexTypes) &gt;= 1</tt> and every type in <tt>MutexTypes...</tt> is the same type.</li>
</ol>
<p>
I originally took the language to mean (2), but upon further review it seems that (1) is the intended interpretation, 
as suggested in the LEWG discussion in <a href="http://wiki.edg.com/bin/view/Wg21lenexa/N4470">Lenexa</a>.
<p/>
I think the language should be clarified to prevent implementation divergence.
</p>

<p><i>[2016-07, Toronto Saturday afternoon issues processing]</i></p>

<p>General feeling that <tt>sizeof(MutexTypes...) == 1</tt> is a better way to state the requirement.</p>
<p>Reworked the text to refer to <tt>scoped_lock</tt> instead of <tt>lock_guard</tt></p>
<p>Marshall and Eric to reword and discuss on reflector. Status to Open</p>

<p><i>[2018-3-14 Wednesday evening issues processing; general agreement to adopt once the wording is updated.]</i></p>

<p>2018-03-18 Marshall provides updated wording.</p>

<strong>Previous resolution: [SUPERSEDED]</strong>
<blockquote class="note">
<p>This wording is relative to N4594.</p>
<ol>
<li><p>Edit 32.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.guard">[thread.lock.guard]</a>/1, class template <tt>lock_guard</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template &lt;class... MutexTypes&gt;
class lock_guard {
public:
  typedef Mutex mutex_type; <i>// <ins>Only i</ins><del>I</del>f</i> MutexTypes... <i><del>consists of the</del><ins>expands to a</ins> single type</i> <tt>Mutex</tt>
  [&hellip;]
};
</pre>
</blockquote>
</li>
</ol>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4727.</p>
<ol>
<li><p>Edit 32.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/thread.lock.guard">[thread.lock.guard]</a>/1, class template <tt>lock_guard</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template &lt;class... MutexTypes&gt;
class scoped_lock {
public:
  using mutex_type = Mutex; <i>// <ins>Only i</ins><del>I</del>f</i> <ins><tt>sizeof(MutexTypes...) == 1</tt></ins> <del><tt>MutexTypes...</tt> <i>consists of the single type</i> <tt>Mutex</tt></del>
  [&hellip;]
};
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2737" href="2737">2737.</a> Consider relaxing object size restrictions for single-object allocation functions</h3>
<p><b>Section:</b> 17.6.2.1 <a href="https://timsong-cpp.github.io/cppwp/new.delete.single">[new.delete.single]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Clark Nelson <b>Opened:</b> 2016-06-21 <b>Last modified:</b> 2016-08-01 18:34:48 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#new.delete.single">active issues</a> in [new.delete.single].</p>
<p><b>View all other</b> <a href="lwg-index.html#new.delete.single">issues</a> in [new.delete.single].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It should be considered whether the description of the
single-object allocation functions should say "or smaller", like
the array allocation functions. For example, according to 17.6.2.1 <a href="https://timsong-cpp.github.io/cppwp/new.delete.single">[new.delete.single]</a> p1 (emphasis mine):
</p>
<blockquote>
<p>
The allocation function (3.7.4.1) called by a new-expression (5.3.4) to allocate <tt>size</tt> bytes of
storage suitably aligned to represent any object <em>of that size</em>.
</p>
</blockquote>
<p>
In contrast to this, 17.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/new.delete.array">[new.delete.array]</a> p1 says (emphasis mine):
</p>
<blockquote>
<p>
The allocation function (3.7.4.1) called by the array form of a new-expression (5.3.4) to allocate
<tt>size</tt> bytes of storage suitably aligned to represent any array object <em>of that size or smaller</em>. 
(footnote: It is not the direct responsibility of <tt>operator new[](std::size_t)</tt> or <tt>operator delete[](void*)</tt> 
to note the repetition count or element size of the array. Those operations are performed elsewhere in the array 
<tt>new</tt> and <tt>delete</tt> expressions. The array <tt>new</tt> expression, may, however, increase the size 
argument to operator <tt>new[](std::size_t)</tt> to obtain space to store supplemental information.)
</p>
</blockquote>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2741" href="2741">2741.</a> <tt>is_partitioned</tt> requirements need updating</h3>
<p><b>Section:</b> 25.7.4 <a href="https://timsong-cpp.github.io/cppwp/alg.partitions">[alg.partitions]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2016-07-06 <b>Last modified:</b> 2019-03-17 18:41:40 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.partitions">issues</a> in [alg.partitions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<blockquote class="note">
<p>
<i>Requires:</i> <tt>InputIterator</tt>'s value type shall be convertible to <tt>Predicate</tt>'s argument type.
</p>
</blockquote>
<p>
This seems to date from the days of adaptable function objects with an <tt>argument_type</tt> typedef, but in 
modern C++ the predicate might not have an argument type. It could have a function template that accepts various 
arguments, so it doesn't make sense to state requirements in terms of a type that isn't well defined.
</p>

<p><i>[2016-07, Toronto Saturday afternoon issues processing]</i></p>

<p>The proposed resolution needs to be updated because the underlying wording has changed. 
Also, since the sequence is homogeneous, we shouldn't have to say that the expression is well-formed
for all elements in the range; that implies that it need not be well-formed if the range is empty.</p>
<p>Marshall and JW to reword. Status to Open</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to N4594.</p>

<ol>
<li><p>Edit 25.7.4 <a href="https://timsong-cpp.github.io/cppwp/alg.partitions">[alg.partitions]</a> as indicated:</p>

<blockquote>
<pre>
template &lt;class InputIterator, class Predicate&gt;
bool is_partitioned(InputIterator first, InputIterator last, Predicate pred);
</pre>
<blockquote>
<p>
-1- <i>Requires:</i> <del><tt>InputIterator</tt>'s value type shall be convertible to <tt>Predicate</tt>'s argument 
type</del><ins>The expression <tt>pred(*i)</tt> shall be well-formed for all <tt>i</tt> in <tt>[first, last)</tt></ins>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template &lt;class InputIterator, class OutputIterator1,
          class OutputIterator2, class Predicate&gt;
  pair&lt;OutputIterator1, OutputIterator2&gt;
  partition_copy(InputIterator first, InputIterator last,
                 OutputIterator1 out_true, OutputIterator2 out_false,
                 Predicate pred);
</pre>
<blockquote>
<p>
-12- <i>Requires:</i> <tt>InputIterator</tt>'s value type shall be <tt>CopyAssignable</tt>, and shall be writable 
(23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>) to the <tt>out_true</tt> and <tt>out_false</tt> 
<tt>OutputIterator</tt>s, and <del>shall be convertible to <tt>Predicate</tt>'s argument type</del><ins>the
expression <tt>pred(*i)</tt> shall be well-formed for all <tt>i</tt> in <tt>[first, last)</tt></ins>. 
The input range shall not overlap with either of the output ranges.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class ForwardIterator, class Predicate&gt;
  ForwardIterator partition_point(ForwardIterator first,
                                  ForwardIterator last,
                                  Predicate pred);
</pre>
<blockquote>
<p>
-16- <i>Requires:</i> <del><tt>ForwardIterator</tt>'s value type shall be convertible to <tt>Predicate</tt>'s argument 
type</del><ins>The expression <tt>pred(*i)</tt> shall be well-formed for all <tt>i</tt> in <tt>[first, last)</tt></ins>. 
<tt>[first, last)</tt> shall be partitioned by <tt>pred</tt>, i.e. all elements that satisfy <tt>pred</tt> shall appear 
before those that do not.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-03-17; Daniel comments and removes previous wording]</i></p>

<p>
In the recent working draft <a href="https://wg21.link/n4810">N4810</a> all the "shall be convertible to <tt>Predicate</tt>'s 
argument type" are gone - they were cleaned up when "The One Range" proposal <a href="https://wg21.link/p0896r4">P0896R4</a> 
had been accepted in San Diego 2018.
<p/>
I also believe that we don't need the extra wording that was suggested in the previous P/R (effectively the need to say 
that the expression <tt>pred(*i)</tt> is well-formed), because this follows (in a more general way) by the expression 
<tt>invoke(pred, invoke(proj, e))</tt> that is applied to the elements <tt>e</tt> of <tt>[first, last)</tt>.
<p/>
Therefore I'm suggesting that the resolution for this issue should be: Resolved by <a href="https://wg21.link/p0896r4">P0896R4</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="2743" href="2743">2743.</a> p0083r3 <tt>node_handle</tt> private members missing "exposition only" comment</h3>
<p><b>Section:</b> 22.2.4.1 <a href="https://timsong-cpp.github.io/cppwp/container.node.overview">[container.node.overview]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2016-07-08 <b>Last modified:</b> 2019-03-17 21:21:39 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The private members of <tt>node_handle</tt> are missing the usual "exposition only" comment. As a consequence, 
<tt>ptr_</tt> and <tt>alloc_</tt> now appear to be names defined by the library (so programs defining these names 
as macros before including a library header have undefined behavior).
<p/>
Presumably this is unintentional and these members should be considered to be for exposition only.
<p/>
It's also not clear whether the name <tt>node_handle</tt> is reserved for library usage or not; 
22.2.4.1 <a href="https://timsong-cpp.github.io/cppwp/container.node.overview">[container.node.overview]</a>/3 says the implementation need not provide a type with this name, but 
doesn't seem to rule out the possibility that an implementation will choose to do so regardless.
</p>
<p>
<b>Daniel:</b>
<p/>
A similar problem seems to exist for the exposition-only type <tt><i>call_wrapper</i></tt> from 
<a href="http://wg21.link/p0358r1">p0358r1</a>, which exposes a private data member named <tt>fd</tt> and 
a typedef <tt>FD</tt>.
</p>
<p><i>[2016-07 Chicago]</i></p>

<p>Jonathan says that we need to make clear that the name <tt>node_handle</tt> is not reserved</p>

<p><i>[2019-03-17; Daniel comments and provides wording]</i></p>

<p>
Due to an editorial step, the previous name <tt>node_handle</tt>/<tt><i>node_handle</i></tt> has been replaced 
by the artificial <tt><i>node-handle</i></tt> name, so I see no longer any reason to talk about a
name <tt>node_handle</tt> reservation. The provided wording therefore only takes care of the private
members.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Change 22.2.4.1 <a href="https://timsong-cpp.github.io/cppwp/container.node.overview">[container.node.overview]</a>, exposition-only class template 
<tt><i>node-handle</i></tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template&lt;<i>unspecified</i>&gt;
class <i>node-handle</i> {
public:
  [&hellip;]
private:
  using container_node_type = <i>unspecified</i>; <ins><i>// exposition only</i></ins>
  using ator_traits = allocator_traits&lt;allocator_type&gt;; <ins><i>// exposition only</i></ins>
  typename ator_traits::template rebind_traits&lt;container_node_type&gt;::pointer ptr_; <ins><i>// exposition only</i></ins>
  optional&lt;allocator_type&gt; alloc_; <ins><i>// exposition only</i></ins>

public:
  [&hellip;]
};
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2746" href="2746">2746.</a> Inconsistency between requirements for <tt>emplace</tt> between <tt>optional</tt> and <tt>variant</tt></h3>
<p><b>Section:</b> 20.6.3 <a href="https://timsong-cpp.github.io/cppwp/optional.optional">[optional.optional]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2016-07-13 <b>Last modified:</b> 2016-11-26 14:34:13 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#optional.optional">active issues</a> in [optional.optional].</p>
<p><b>View all other</b> <a href="lwg-index.html#optional.optional">issues</a> in [optional.optional].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Referring to N4604:
</p>
<p>
In  [optional.object.assign]: <tt>emplace</tt> (normal form) has a Requires that the construction works.
</p>
<blockquote>
<p>
<i>Requires:</i> <tt>is_constructible_v&lt;T, Args&amp;&amp;...&gt;</tt> is <tt>true</tt>.
</p>
</blockquote>
<p>
<tt>emplace</tt> (<tt>initializer_list</tt> form) has a SFINAE condition:
</p>
<blockquote>
<p>
<i>Remarks:</i> [&hellip;] unless <tt>is_constructible_v&lt;T, initializer_list&lt;U&gt;&amp;, Args&amp;&amp;...&gt;</tt> 
is <tt>true</tt>.
</p>
</blockquote>
<p>
In 20.8.3.3 <a href="https://timsong-cpp.github.io/cppwp/any.modifiers">[any.modifiers]</a>: <tt>emplace</tt> (normal form) has a Requires that the construction works:
</p>
<blockquote>
<p>
<i>Requires:</i> <tt>is_constructible_v&lt;T, Args...&gt;</tt> is <tt>true</tt>.
</p>
</blockquote>
<p>
<tt>emplace</tt> (<tt>initializer_list</tt> form) has a SFINAE condition:
</p>
<blockquote>
<p>
<i>Remarks:</i> [&hellip;] unless <tt>is_constructible_v&lt;T, initializer_list&lt;U&gt;&amp;, Args...&gt;</tt> is <tt>true</tt>.
</p>
</blockquote>
<p>
In 20.7.3.4 <a href="https://timsong-cpp.github.io/cppwp/variant.mod">[variant.mod]</a>: <tt>emplace</tt> (<tt>T</tt>, normal form) has a SFINAE condition:
</p>
<blockquote>
<p>
<i>Remarks:</i> [&hellip;] unless <tt>is_constructible_v&lt;T, Args...&gt;</tt> is <tt>true</tt>, and <tt>T</tt> occurs exactly 
once in <tt>Types...</tt>.
</p>
</blockquote>
<p>
<tt>emplace</tt> (Idx, normal form) has a <em>both</em> a Requires and a SFINAE condition:
</p>
<blockquote>
<p>
<i>Requires:</i> <tt>I &lt; sizeof...(Types)</tt>
<p/>
<i>Remarks:</i> [&hellip;] unless <tt>is_constructible_v&lt;T, Args...&gt;</tt> is <tt>true</tt>, and <tt>T</tt> 
occurs exactly once in <tt>Types...</tt>.
</p>
</blockquote>
<p>
<tt>emplace</tt> (<tt>T</tt>, <tt>initializer_list</tt> form) has a SFINAE condition:
</p>
<blockquote>
<p>
<i>Remarks:</i> [&hellip;] unless <tt>is_constructible_v&lt;T, initializer_list&lt;U&gt;&amp;, Args...&gt;</tt> is 
<tt>true</tt>, and <tt>T</tt> occurs exactly once in <tt>Types...</tt>.
</p>
</blockquote>
<p>
<tt>emplace</tt> (Idx, <tt>initializer_list</tt> form) has a both a Requires and a SFINAE condition:
</p>
<blockquote>
<p>
<i>Requires:</i> <tt>I &lt; sizeof...(Types)</tt>
<p/>
<i>Remarks:</i> [&hellip;] unless <tt>is_constructible_v&lt;T, Args...&gt;</tt> is true, and <tt>T</tt> occurs exactly 
once in <tt>Types...</tt>.
</p>
</blockquote>
<p>
Why the inconsistency? Should all the cases have a SFINAE requirement?
<p/>
I see that variant has an additional requirement (<tt>T</tt> occurs exactly once in <tt>Types...</tt>), but that 
only agues that it must be a SFINAE condition &mdash; doesn't say that the other cases (any/variant) should not.
<p/>
<tt>map</tt>/<tt>multimap</tt>/<tt>unordered_map</tt>/<tt>unordered_multimap</tt> have SFINAE'd versions of 
<tt>emplace</tt> that don't take <tt>initializer_list</tt>s, but they don't have any <tt>emplace</tt> versions 
that take ILs.
<p/>
Suggested resolution:
<p/>
Add SFINAE requirements to <tt>optional::emplace(Args&amp;&amp;... args)</tt> and 
<tt>any::emplace(Args&amp;&amp;... args);</tt>
</p>

<p><i>[2016-08 Chicago]</i></p>

<p>During issue prioritization, people suggested that this might apply to <tt>any</tt> as well.</p>
<p>Ville notes that <a href="2746">2746</a>, <a href="2754">2754</a> and <a href="2756">2756</a> all go together.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2751" href="2751">2751.</a> <tt>shared_ptr</tt> deleter not specified to observe expired <tt>weak_ptr</tt> instances</h3>
<p><b>Section:</b> 20.11.3.2 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.dest">[util.smartptr.shared.dest]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Aaron Jacobs <b>Opened:</b> 2016-07-21 <b>Last modified:</b> 2017-10-08 13:57:04 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared.dest">issues</a> in [util.smartptr.shared.dest].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The C++14 standard contains no language that guarantees the deleter run by a
<tt>shared_ptr</tt> will see all associated <tt>weak_ptr</tt> instances as expired. For example,
the standard doesn't appear to guarantee that the assertion in the following
snippet won't fire:
</p>
<blockquote><pre>
std::weak_ptr&lt;Foo&gt; weak;
std::shared_ptr&lt;Foo&gt; strong{
  new Foo,
  [&amp;weak] (Foo* f) {
    assert(weak.expired());
    delete f;
  },
};

weak = strong;
strong.reset();
</pre></blockquote>
<p>
It seems clear that the intent is that associated <tt>weak_ptr</tt>s are expired,
because otherwise <tt>shared_ptr</tt> deleters could resurrect a reference to an object
that is being deleted.
<p/>
Suggested fix: 20.11.3.2 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.dest">[util.smartptr.shared.dest]</a> should specify that the decrease in
<tt>use_count()</tt> caused by the destructor is sequenced before the call to the
deleter or the call to <tt>delete p</tt>.
</p>

<p><i>[2016-11-08, Jonathan and STL suggest NAD]</i></p>

<p>
STL and Jonathan feel that the example has unspecified behaviour, and the
assertion is allowed to fire, and that's OK (the program's expectation
is not reasonable). Otherwise it's necessary to move-construct a copy
of the deleter and use that copy to destroy the owned pointer. We do
not want to be required to do that.
</p>
<p>See also <a href="2262">2262</a>.</p>

<p><i>[2017-09-20, Jonathan comments]</i></p>

<p>
I'd like to withdraw my NAD suggestion. The value of <tt>use_count()</tt> is already observable during the destructor via 
<tt>shared_ptr</tt> and <tt>weak_ptr</tt> objects that share ownership, so specifying when it changes ensures correct 
behaviour.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2762" href="2762">2762.</a> <tt>unique_ptr operator*()</tt> should be <tt>noexcept</tt></h3>
<p><b>Section:</b> 20.11.1.2.4 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.observers">[unique.ptr.single.observers]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Ville Voutilainen <b>Opened:</b> 2016-08-04 <b>Last modified:</b> 2018-06-23 21:17:35 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#unique.ptr.single.observers">issues</a> in [unique.ptr.single.observers].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
See LWG <a href="2337">2337</a>. Since we aren't removing <tt>noexcept</tt> from <tt>shared_ptr</tt>'s 
<tt>operator*</tt>, we should consider adding <tt>noexcept</tt> to <tt>unique_ptr</tt>'s <tt>operator*</tt>.
</p>

<p><i>[2016-08 &mdash; Chicago]</i></p>

<p>Thurs PM: P3, and status to 'LEWG'</p>

<p><i>[2016-08-05 Chicago]</i></p>

<p>
Ville provides an initial proposed wording.
</p>

<p><i>[LEWG Kona 2017]</i></p>

<p>-&gt;Open: Believe these should be <tt>noexcept</tt> for consistency. We like these. We agree with the proposed resolution. 
<tt>operator-&gt;()</tt> already has <tt>noexcept</tt>.</p>
<p>Also adds <tt>optional::operator*</tt></p>
<p>Alisdair points out that fancy pointers might intentionally throw from <tt>operator*</tt>, and we don't want to prohibit that.</p>
<p>Go forward with conditional <tt>noexcept(noexcept(*decltype()))</tt>.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to N4606.</p>

<blockquote class="note">
<p>
[Drafting note: since this issue is all about consistency, <tt>optional</tt>'s pointer-like operators 
are additionally included.]
</p>
</blockquote>

<ol>
<li><p>In 20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> synopsis, edit as follows:</p>

<blockquote>
<pre>
add_lvalue_reference_t&lt;T&gt; operator*() const <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

<li><p>Before 20.11.1.2.4 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.observers">[unique.ptr.single.observers]</a>/1, edit as follows:</p>

<blockquote>
<pre>
add_lvalue_reference_t&lt;T&gt; operator*() const <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

<li><p>In 20.6.3 <a href="https://timsong-cpp.github.io/cppwp/optional.optional">[optional.optional]</a> synopsis, edit as follows:</p>

<blockquote>
<pre>
constexpr T const *operator-&gt;() const <ins>noexcept</ins>;
constexpr T *operator-&gt;() <ins>noexcept</ins>;
constexpr T const &amp;operator*() const &amp; <ins>noexcept</ins>;
constexpr T &amp;operator*() &amp; <ins>noexcept</ins>;
constexpr T &amp;&amp;operator*() &amp;&amp; <ins>noexcept</ins>;
constexpr const T &amp;&amp;operator*() const &amp;&amp; <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

<li><p>Before  [optional.object.observe]/1, edit as follows:</p>

<blockquote>
<pre>
constexpr T const* operator-&gt;() const <ins>noexcept</ins>;
constexpr T* operator-&gt;() <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

<li><p>Before  [optional.object.observe]/5, edit as follows:</p>

<blockquote>
<pre>
constexpr T const&amp; operator*() const &amp; <ins>noexcept</ins>;
constexpr T&amp; operator*() &amp; <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

<li><p>Before  [optional.object.observe]/9, edit as follows:</p>

<blockquote>
<pre>
constexpr T&amp;&amp; operator*() &amp;&amp; <ins>noexcept</ins>;
constexpr const T&amp;&amp; operator*() const &amp;&amp; <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="2766" href="2766">2766.</a> Swapping non-swappable types</h3>
<p><b>Section:</b> 20.4.3 <a href="https://timsong-cpp.github.io/cppwp/pairs.spec">[pairs.spec]</a>, 20.5.10 <a href="https://timsong-cpp.github.io/cppwp/tuple.special">[tuple.special]</a>, 20.6.9 <a href="https://timsong-cpp.github.io/cppwp/optional.specalg">[optional.specalg]</a>, 20.7.10 <a href="https://timsong-cpp.github.io/cppwp/variant.specalg">[variant.specalg]</a>, 20.11.1.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.special">[unique.ptr.special]</a>, 22.3.7.4 <a href="https://timsong-cpp.github.io/cppwp/array.special">[array.special]</a>, 22.6.4.5 <a href="https://timsong-cpp.github.io/cppwp/queue.special">[queue.special]</a>, 22.6.5.5 <a href="https://timsong-cpp.github.io/cppwp/priqueue.special">[priqueue.special]</a>, 22.6.6.5 <a href="https://timsong-cpp.github.io/cppwp/stack.special">[stack.special]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2016-08-15 <b>Last modified:</b> 2019-04-17 15:56:47 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#pairs.spec">active issues</a> in [pairs.spec].</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs.spec">issues</a> in [pairs.spec].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Related: <a href="2748">2748</a> swappable traits for optionals, <a href="2749">2749</a> swappable traits for variants.
</p>
<p>
The adoption of <a href="http://wg21.link/p0185r1">P0185R1</a> "Adding [nothrow-]swappable traits" makes certain 
non-swappable types indirectly swappable. Consider a type defined as follows:
</p>
<blockquote><pre>
struct non_swappable {
  friend void swap(non_swappable&amp;, non_swappable&amp;) = delete;
};

non_swappable ns1, ns2;
using std::swap;
swap(ns1, ns2); // ill-formed

static_assert(std::is_swappable_v&lt;non_swappable&gt; == false); // holds
</pre></blockquote>
<p>
Lvalues of type <tt>non_swappable</tt> are not swappable, as defined by 16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>, 
overload resolution selects the deleted function. Consistently, <tt>is_swappable_v&lt;non_swappable&gt;</tt> yields 
false. It should be noted that since <tt>non_swappable</tt> is move constructible and move assignable, a qualified 
call to <tt>std::swap</tt> would be well-formed, even under P0185. Now consider the following snippet:
</p>
<blockquote><pre>
std::tuple&lt;non_swappable&gt; tns1, tns2;
using std::swap;
swap(tns1, tns2); // previously ill-formed, now well-formed

static_assert(std::is_swappable_v&lt;std::tuple&lt;non_swappable&gt;&gt; == false); // fires
</pre></blockquote>
<p>
Before P0185, this snippet would violate the implicit requirement of specialized swap for tuples that each tuple 
element be swappable. After P0185, this specialized swap overload for tuples would be SFINAEd away, resulting 
in overload resolution selecting the base swap overload, and performing the exchange via move construction and 
move assignment of tuples.
<p/>
This issue affects all of <tt>pair</tt>, <tt>tuple</tt>, <tt>unique_ptr</tt>, <tt>array</tt>, <tt>queue</tt>, 
<tt>priority_queue</tt>, <tt>stack</tt>, and should eventually also apply to <tt>optional</tt> and <tt>variant</tt>.
</p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4606">N4606</a>, except when otherwise noted.</p>

<ol>
<li><p>Modify 20.4.3 <a href="https://timsong-cpp.github.io/cppwp/pairs.spec">[pairs.spec]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class T1, class T2&gt; void swap(pair&lt;T1, T2&gt;&amp; x, pair&lt;T1, T2&gt;&amp; y)
  noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-7- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
<p/>
-8- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as 
deleted</ins> unless <tt>is_swappable_v&lt;T1&gt;</tt> is <tt>true</tt> and <tt>is_swappable_v&lt;T2&gt;</tt> 
is <tt>true</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.5.10 <a href="https://timsong-cpp.github.io/cppwp/tuple.special">[tuple.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class... Types&gt;
  void swap(tuple&lt;Types...&gt;&amp; x, tuple&lt;Types...&gt;&amp; y) noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>is_swappable_v&lt;<tt>T<sub>i</sub></tt>&gt;</tt> is <tt>true</tt> for all <tt><i>i</i></tt>, where 
<tt>0 &lt;= <i>i</i></tt> and <tt><i>i</i> &lt; sizeof...(Types)</tt>. The expression inside <tt>noexcept</tt> 
is equivalent to:
</p>
<blockquote><pre>
noexcept(x.swap(y))
</pre></blockquote>
<p>
-2- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.11.1.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.special">[unique.ptr.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T, class D&gt; void swap(unique_ptr&lt;T, D&gt;&amp; x, unique_ptr&lt;T, D&gt;&amp; y) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>is_swappable_v&lt;D&gt;</tt> is <tt>true</tt>.
<p/>
-2- <i>Effects:</i> Calls <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.3.7.4 <a href="https://timsong-cpp.github.io/cppwp/array.special">[array.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T, size_t N&gt;
  void swap(array&lt;T, N&gt;&amp; x, array&lt;T, N&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>N == 0</tt> or <tt>is_swappable_v&lt;T&gt;</tt> is <tt>true</tt>.
<p/>
-2- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.6.4.5 <a href="https://timsong-cpp.github.io/cppwp/queue.special">[queue.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T, class Container&gt;
  void swap(queue&lt;T, Container&gt;&amp; x, queue&lt;T, Container&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>is_swappable_v&lt;Container&gt;</tt> is <tt>true</tt>.
<p/>
-2- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.6.5.5 <a href="https://timsong-cpp.github.io/cppwp/priqueue.special">[priqueue.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T, class Container, class Compare&gt;
  void swap(priority_queue&lt;T, Container, Compare&gt;&amp; x,
            priority_queue&lt;T, Container, Compare&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-1- <tt>Remarks:</tt> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>is_swappable_v&lt;Container&gt;</tt> is <tt>true</tt> and <tt>is_swappable_v&lt;Compare&gt;</tt> is <tt>true</tt>.
<p/>
-2- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.6.6.5 <a href="https://timsong-cpp.github.io/cppwp/stack.special">[stack.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T, class Container&gt;
  void swap(stack&lt;T, Container&gt;&amp; x, stack&lt;T, Container&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>is_swappable_v&lt;Container&gt;</tt> is <tt>true</tt>.
<p/>
-2- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.6.9 <a href="https://timsong-cpp.github.io/cppwp/optional.specalg">[optional.specalg]</a> as indicated:</p>
<blockquote class="note">
<p>
This change should be performed if and only if LWG <a href="2748">2748</a> is accepted and is against the wording of <a href="2748">2748</a>:
</p>
</blockquote>
<blockquote>
<pre>
template &lt;class T&gt; void swap(optional&lt;T&gt;&amp; x, optional&lt;T&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Calls <tt>x.swap(y)</tt>.
<p/>
-2- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>is_move_constructible_v&lt;T&gt;</tt> is <tt>true</tt> and <tt>is_swappable_v&lt;T&gt;</tt> is <tt>true</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.7.10 <a href="https://timsong-cpp.github.io/cppwp/variant.specalg">[variant.specalg]</a> as indicated:</p>
<blockquote class="note">
<p>
This change should be performed if and only if LWG <a href="2749">2749</a> is accepted and is against the wording of <a href="2749">2749</a>:
</p>
</blockquote>
<blockquote>
<pre>
template &lt;class... Types&gt; void swap(variant&lt;Types...&gt;&amp; v, variant&lt;Types...&gt;&amp; w) noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to <tt>v.swap(w)</tt>.
<p/>
-2- <i>Remarks:</i> This function shall <del>not participate in overload resolution</del><ins>be defined as deleted</ins> 
unless <tt>is_move_constructible_v&lt;<i>T<sub>i</sub></i>&gt; &amp;&amp; is_swappable_v&lt;<i>T<sub>i</sub></i>&gt;</tt> 
is <tt>true</tt> for all <tt><i>i</i></tt>. The expression inside <tt>noexcept</tt> is equivalent to <tt>noexcept(v.swap(w))</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-04-17 Jonathan updates proposed resolution based on Ville's 2016-11-17 observation that the container adaptors always require swappable sequences anyway. The new proposed resolution is based on the latest WP, "de-shalled", and <i>Remarks</i> elements are repositioned after the <i>Effects</i>.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 20.4.3 <a href="https://timsong-cpp.github.io/cppwp/pairs.spec">[pairs.spec]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class T1, class T2&gt;
  constexpr void swap(pair&lt;T1, T2&gt;&amp; x, pair&lt;T1, T2&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-7- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
<p/>
-8- <i>Remarks:</i> This function <del>shall not participate in overload resolution</del><ins>is defined as
deleted</ins> unless <tt>is_swappable_v&lt;T1&gt;</tt> is <tt>true</tt> and <tt>is_swappable_v&lt;T2&gt;</tt>
is <tt>true</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.5.10 <a href="https://timsong-cpp.github.io/cppwp/tuple.special">[tuple.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class... Types&gt;
  constexpr void swap(tuple&lt;Types...&gt;&amp; x, tuple&lt;Types...&gt;&amp; y) noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-?- <ins><i>Effects:</i> As if by <tt>x.swap(y)</tt>.</ins>
</p>
<p>
-1- <i>Remarks:</i> This function <del>shall not participate in overload resolution</del><ins>is defined as deleted</ins>
unless <tt>is_swappable_v&lt;<tt>T<sub>i</sub></tt>&gt;</tt> is <tt>true</tt> for all <tt><i>i</i></tt>, where
<tt>0 &lt;= <i>i</i></tt> and <tt><i>i</i> &lt; sizeof...(Types)</tt>. The expression inside <tt>noexcept</tt>
is equivalent to:
</p>
<blockquote><pre>
noexcept(x.swap(y))
</pre></blockquote>
<p>
-2- <del><i>Effects:</i> As if by <tt>x.swap(y)</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.6.9 <a href="https://timsong-cpp.github.io/cppwp/optional.specalg">[optional.specalg]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T&gt; void swap(optional&lt;T&gt;&amp; x, optional&lt;T&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Calls <tt>x.swap(y)</tt>.
<p/>
-2- <i>Remarks:</i> This function <del>shall not participate in overload resolution</del><ins>is defined as deleted</ins>
unless <tt>is_move_constructible_v&lt;T&gt;</tt> is <tt>true</tt> and <tt>is_swappable_v&lt;T&gt;</tt> is <tt>true</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.7.10 <a href="https://timsong-cpp.github.io/cppwp/variant.specalg">[variant.specalg]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class... Types&gt; void swap(variant&lt;Types...&gt;&amp; v, variant&lt;Types...&gt;&amp; w) noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to <tt>v.swap(w)</tt>.
<p/>
-2- <i>Remarks:</i> This function <del>shall not participate in overload resolution</del><ins>is defined as deleted</ins>
unless <tt>is_move_constructible_v&lt;<i>T<sub>i</sub></i>&gt; &amp;&amp; is_swappable_v&lt;<i>T<sub>i</sub></i>&gt;</tt>
is <tt>true</tt> for all <tt><i>i</i></tt>. The expression inside <tt>noexcept</tt> is equivalent to <tt>noexcept(v.swap(w))</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.11.1.5 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.special">[unique.ptr.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T, class D&gt; void swap(unique_ptr&lt;T, D&gt;&amp; x, unique_ptr&lt;T, D&gt;&amp; y) noexcept;
</pre>
<blockquote>
<p>
-?- <ins><i>Effects:</i> Calls <tt>x.swap(y)</tt>.</ins>
</p>
<p>
-1- <i>Remarks:</i> This function <del>shall not participate in overload resolution</del><ins>is defined as deleted</ins>
unless <tt>is_swappable_v&lt;D&gt;</tt> is <tt>true</tt>.
</p>
<p>
-2- <del><i>Effects:</i> Calls <tt>x.swap(y)</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.3.7.4 <a href="https://timsong-cpp.github.io/cppwp/array.special">[array.special]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T, size_t N&gt;
  void swap(array&lt;T, N&gt;&amp; x, array&lt;T, N&gt;&amp; y) noexcept(noexcept(x.swap(y)));
</pre>
<blockquote>
<p>
-1- <del><i>Constraints:</i> <tt>N == 0</tt> or <tt>is_swappable_v&lt;T&gt;</tt> is <tt>true</tt>.</del>
<p/>
-2- <i>Effects:</i> As if by <tt>x.swap(y)</tt>.
<p/>
-3- <i>Complexity:</i> Linear in <tt>N</tt>.
<p/>
-?- <ins><i>Remarks:</i> This function is defined as deleted
unless <tt>N == 0</tt> or <tt>is_swappable_v&lt;T&gt;</tt> is <tt>true</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2774" href="2774">2774.</a> <tt>std::function</tt> construction vs assignment</h3>
<p><b>Section:</b> 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2016-09-14 <b>Last modified:</b> 2019-07-27 14:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#func.wrap.func.con">active issues</a> in [func.wrap.func.con].</p>
<p><b>View all other</b> <a href="lwg-index.html#func.wrap.func.con">issues</a> in [func.wrap.func.con].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I think there's a minor defect in the <tt>std::function</tt> interface. The constructor template is:
</p>
<blockquote><pre>
template &lt;class F&gt; function(F f);
</pre></blockquote>
<p>
while the assignment operator template is 
</p>
<blockquote><pre>
template &lt;class F&gt; function&amp; operator=(F&amp;&amp; f);
</pre></blockquote>
<p>
The latter came about as a result of LWG <a href="1288">1288</a>, but that one was dealing with a specific issue that 
wouldn't have affected the constructor. I think the constructor should also take <tt>f</tt> by forwarding reference, 
this saves a move in the lvalue/xvalue cases and is also just generally more consistent. Should just make sure 
that it's stored as <tt>std::decay_t&lt;F&gt;</tt> instead of <tt>F</tt>. 
<p/>
Is there any reason to favor a by-value constructor over a forwarding-reference constructor?
</p>

<p><i>[2019-07-26 Tim provides PR.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/N4820">N4820</a>.</p>
<ol>
<li><p>Edit 20.14.16.2 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func">[func.wrap.func]</a>, class template <tt>function</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
namespace std {
  template&lt;class&gt; class function; // not defined
  template&lt;class R, class... ArgTypes&gt; {
  public:
    using result_type = R;

    // 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a>, construct/copy/destroy
    function() noexcept;
    function(nullptr_t) noexcept;
    function(const function&amp;);
    function(function&amp;&amp;) noexcept;
    template&lt;class F&gt; function(F<ins>&amp;&amp;</ins>);

    [&hellip;]
  };

  [&hellip;]
}
</pre>
</blockquote>
</li>
<li><p>Edit 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a> p7-11 as indicated:</p>
<blockquote>
<pre>
template&lt;class F&gt; function(F<ins>&amp;&amp;</ins> f);
</pre>
<blockquote>
<p><del>-7- <i>Requires:</i> <tt>F</tt> shall be <i>Cpp17CopyConstructible</i></del><ins>Let
<tt>FD</tt> be <tt>decay_t&lt;F&gt;</tt></ins>.</p>
<p>-8- <del><i>Remarks:</i> This constructor template shall not participate in overload resolution unless
<tt>F</tt></del> <ins><i>Constraints:</i></ins></p>
<ol style="list-style-type:none">
<li><p><ins>(8.1) &mdash; <tt>is_same_v&lt;FD, function&gt;</tt> is <tt>false</tt>; and</ins></p></li>
<li><p><ins>(8.2) &mdash; <tt>FD</tt></ins> is Lvalue-Callable 
(20.14.16.2 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func">[func.wrap.func]</a>) for argument types <tt>ArgTypes...</tt>
and return type <tt>R</tt>.</p>
</li>
</ol>
<p><ins>-?- <i>Expects:</i> <tt>FD</tt> meets the
<i>Cpp17CopyConstructible</i> requirements.</ins></p>
<p> -9- <i>Ensures:</i> <tt>!*this</tt> if any of the following hold:</p>
<ol style="list-style-type:none">
<li><p>(9.1) &mdash; <tt>f</tt> is a null function pointer value.</p></li>
<li><p>(9.2) &mdash; <tt>f</tt> is a null member pointer value.</p></li>
<li><p>(9.3) &mdash; <del><tt>F</tt> is an instance</del> <ins><tt>remove_cvref_t&lt;F&gt;</tt> is 
a specialization</ins> of the <tt>function</tt> class template, and <tt>!f</tt> <ins>is <tt>true</tt></ins>.
</p></li>
</ol>
<p> -10- Otherwise, <tt>*this</tt> targets
<del>a copy of <tt>f</tt></del><ins>an object of type <tt>FD</tt>
direct-non-list-</ins>initialized with <del><tt>std::move(f)</tt></del>
<ins><tt>std::forward&lt;F&gt;(f)</tt></ins>. [<i>Note:</i> Implementations should
avoid the use of dynamically allocated memory for small callable objects, for example, where <tt>f</tt> 
<del>is</del> <ins>refers to</ins> an object holding only a pointer or reference to an object 
and a member function pointer. &mdash; <i>end note</i>]</p>
<p> -11- <i>Throws:</i> <del>Shall</del> <ins>Does</ins> not throw exceptions when <del><tt>f</tt></del>
<ins><tt>FD</tt></ins> is a function pointer <ins>type</ins> or 
a <ins>specialization of</ins> <tt>reference_wrapper</tt><del><tt>&lt;T&gt;</tt> for some <tt>T</tt></del>.
Otherwise, may throw <tt>bad_alloc</tt> or any exception thrown by <del><tt>F</tt>s copy or move constructor</del>
<ins>the initialization of the target object</ins>.</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2808" href="2808">2808.</a> Requirements for <tt>fpos</tt> and <tt>stateT</tt></h3>
<p><b>Section:</b> 29.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/fpos.operations">[fpos.operations]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Great Britain <b>Opened:</b> 2016-11-09 <b>Last modified:</b> 2019-03-22 17:53:09 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#fpos.operations">active issues</a> in [fpos.operations].</p>
<p><b>View all other</b> <a href="lwg-index.html#fpos.operations">issues</a> in [fpos.operations].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<b>Addresses GB 60</b>
</p>
<p>
The requirements on the <tt>stateT</tt> type used 
to instantiate class template <tt>fpos</tt> are not 
clear, and the following Table 108 &mdash; "Position 
type requirements" is a bit of a mess. This is 
old wording, and should be cleaned up with better
terminology from the Clause 17 Requirements. For example, 
<tt>stateT</tt> might be require <tt>CopyConstructible</tt>?, 
<tt>CopyAssignable</tt>?, and <tt>Destructible</tt>. Several 
entries in the final column of the table appear to be 
post-conditions, but without the <tt>post</tt> markup to 
clarify they are not assertions or preconditions. They 
frequently refer to identifiers that do not apply to all 
entries in their corresponding <tt>Expression</tt> 
column, leaving some expressions without a clearly defined semantic.
If <tt>stateT</tt> is a trivial type, is <tt>fpos</tt> also a 
trivial type, or is a default constructor not required/supported?
</p>
<p>
Proposed change:
<p/>
Clarify the requirements and the table.
</p>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Priority 4; no consensus for any concrete change</p>

<p><i>[2019-03-17; Daniel comments]</i></p>

<p>
With the acceptance of <a href="http://wg21.link/p0759r1">P0759R1</a> at the Rapperswil 2018 meeting
this issue should be closed as <b>Resolved</b> (Please note that this paper resolves a historic
NB comment that was originally written against C++17 but was at that time responded: "invite a paper 
if anybody wants to change it - no concensus for change").
</p>


<p><b>Rationale:</b></p>
Resolved by <a href="http://wg21.link/p0759r1">P0759R1</a>.


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2811" href="2811">2811.</a> "Selected constructor" wording is incorrect for <tt>optional</tt>/<tt>variant</tt>/<tt>any</tt></h3>
<p><b>Section:</b> 20.6.3.1 <a href="https://timsong-cpp.github.io/cppwp/optional.ctor">[optional.ctor]</a>, 20.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/optional.assign">[optional.assign]</a>, 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a>, 20.8.3.1 <a href="https://timsong-cpp.github.io/cppwp/any.cons">[any.cons]</a>, 20.8.3.3 <a href="https://timsong-cpp.github.io/cppwp/any.modifiers">[any.modifiers]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2016-10-29 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#optional.ctor">issues</a> in [optional.ctor].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Throughout <tt>optional</tt>/<tt>variant</tt>/<tt>any</tt>'s specification references are made to "the selected constructor 
of <tt>T</tt>". For example, 20.6.3.1 <a href="https://timsong-cpp.github.io/cppwp/optional.ctor">[optional.ctor]</a>/16 says of the constructor from <tt>const T&amp;</tt>:
</p>
<blockquote><p>
-16- <i>Remarks:</i> If <tt>T</tt>'s selected constructor is a <tt>constexpr</tt> constructor, this constructor shall be a 
<tt>constexpr</tt> constructor.
</p></blockquote>
<p>
Similarly, the in-place constructor has this wording (20.6.3.1 <a href="https://timsong-cpp.github.io/cppwp/optional.ctor">[optional.ctor]</a>/25-26):
</p>
<blockquote><p>
-25- <i>Throws:</i> Any exception thrown by the selected constructor of <tt>T</tt>.
<p/>
-26- <i>Remarks:</i> If <tt>T</tt>'s constructor selected for the initialization is a <tt>constexpr</tt> constructor, 
this constructor shall be a <tt>constexpr</tt> constructor.
</p></blockquote>
<p>
If <tt>T</tt> is a scalar type, it has no constructor at all. Moreover, even for 
class types, the in-place constructor wording ignores any implicit conversion done on the argument before the selected 
constructor is called, which 1) may not be valid in constant expressions and 2) may throw an exception; such exceptions 
aren't thrown "by the selected constructor of <tt>T</tt>" but outside it.
<p/>
The wording should probably be recast to refer to the entire initialization.
</p>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Priority 3; Jonathan to provide wording.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2813" href="2813">2813.</a> <tt>std::function</tt> should not return dangling references</h3>
<p><b>Section:</b> 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a> <b>Status:</b> <a href="lwg-active.html#EWG">EWG</a>
 <b>Submitter:</b> Brian Bi <b>Opened:</b> 2016-11-03 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#func.wrap.func.con">active issues</a> in [func.wrap.func.con].</p>
<p><b>View all other</b> <a href="lwg-index.html#func.wrap.func.con">issues</a> in [func.wrap.func.con].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#EWG">EWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
If a <tt>std::function</tt> has a reference as a return type, and that reference binds to a prvalue 
returned by the callable that it wraps, then the reference is always dangling. Because any use of such 
a reference results in undefined behaviour, the <tt>std::function</tt> should not be allowed to be 
initialized with such a callable. Instead, the program should be ill-formed.
<p/>
A minimal example of well-formed code under the current standard that exhibits this issue:
</p>
<blockquote><pre>
#include &lt;functional&gt;

int main() 
{
  std::function&lt;const int&amp;()&gt; F([]{ return 42; });
  int x = F(); // oops!
}
</pre></blockquote>

<p><i>[2016-11-22, David Krauss comments and suggests wording]</i></p>

<p>
Indirect bindings may also introduce temporaries inside <tt>std::function</tt>, e.g.:
</p>
<blockquote><pre>
void f(std::function&lt;long const&amp;()&gt;); // Retains an observer to a long.

void g() {
  int v;
  f([&amp;]()-&gt;int&amp; { return v; } ); // int lvalue binds to long const&amp; through a temporary.
}
</pre></blockquote>
<p>
A fix has been implemented. Conversions that may be conversion operators are allowed, though, because those can 
produce legitimate glvalues. Before adopting this, it need to be considered considered whether there should be 
SFINAE or a hard error.
</p>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Priority 2</p>

<p><i>[2016-07, Toronto Saturday afternoon issues processing]</i></p>

<p>Billy to work with Brian to rework PR. Status to Open</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Really needs a language change to fix this. Status to EWG.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4618">N4618</a>.
</p>
<ol>
<li><p>Add a second paragraph to the remarks section of 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a>:</p>
<blockquote>
<pre>
template&lt;class F&gt; function(F f);
</pre>
<blockquote>
<p>
-7- <i>Requires:</i> <tt>F</tt> shall be <tt>CopyConstructible</tt>.
<p/>
-8- <i>Remarks:</i> This constructor template shall not participate in overload resolution unless 
</p>
<ul>
<li><p><tt>F</tt> is Lvalue-Callable (20.14.16.2 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func">[func.wrap.func]</a>) for argument types <tt>ArgTypes...</tt> and 
return type <tt>R</tt><ins>, and</ins></p></li>
<li><p><ins>If <tt>R</tt> is type "reference to <tt>T</tt>" and <tt><i>INVOKE</i>(ArgTypes...)</tt> has value category 
<tt><i>V</i></tt> and type <tt>U</tt>:</ins></p>
<ul>
<li><p><ins><tt><i>V</i></tt> is a prvalue, <tt>U</tt> is a class type, and <tt>T</tt> is not reference-related 
(9.4.3 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.ref">[dcl.init.ref]</a>) to <tt>U</tt>, and</ins></p></li>
<li><p><ins><tt><i>V</i></tt> is an lvalue or xvalue, and either <tt>U</tt> is a class type or <tt>T</tt> is 
reference-related to <tt>U</tt></ins>.</p></li>
</ul>
</li>
</ul>
<p>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2814" href="2814">2814.</a> [fund.ts.v2] <tt>to_array</tt> should take rvalue reference as well</h3>
<p><b>Section:</b> 4.2.1 [fund.ts.v2::func.wrap.func.con] <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Zhihao Yuan <b>Opened:</b> 2016-11-07 <b>Last modified:</b> 2017-06-05 20:39:07 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#fund.ts.v2::func.wrap.func.con">issues</a> in [fund.ts.v2::func.wrap.func.con].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v2</b></p>
<p>
C++ doesn't have a prvalue expression of array type, but
rvalue arrays can still come from different kinds of sources:
</p>
<ol>
<li><p>C99 compound literals <tt>(int[]) {2, 4}</tt>,</p></li>
<li><p><tt>std::move(arr)</tt>,</p></li>
<li><p>Deduction <tt>to_array&lt;int const&gt;({ 2, 4 })</tt>.</p>
<blockquote class="note">
<p>
See also <a href="http://wg21.link/cwg1591">CWG 1591</a>: Deducing array bound and element type from initializer list.
</p>
</blockquote>
</li>
</ol>
<p>
For 3), users are "abusing" <tt>to_array</tt> to get access to uniform
initialization to benefit from initializing elements through
braced-init-list and/or better narrowing conversion support.
<p/>
We should just add rvalue reference support to <tt>to_array</tt>.
</p>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Status to LEWG</p>

<p><i>[2017-02 in Kona, LEWG responds]</i></p>

<p>Would like a small paper; see examples before and after. How does this affect overload resolution?</p>

<p><i>[2017-06-02 Issues Telecon]</i></p>

<p>Leave status as LEWG; priority 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4600">N4600</a>.</p>

<ol>
<li>
<p>Add the following signature to 9.2.1 [fund.ts.v2::header.array.synop]:</p>

<blockquote>
<pre>
// 9.2.2, Array creation functions
template &lt;class D = void, class... Types&gt;
  constexpr array&lt;VT, sizeof...(Types)&gt; make_array(Types&amp;&amp;... t);
template &lt;class T, size_t N&gt;
  constexpr array&lt;remove_cv_t&lt;T&gt;, N&gt; to_array(T (&amp;a)[N]);
<ins>template &lt;class T, size_t N&gt;
  constexpr array&lt;remove_cv_t&lt;T&gt;, N&gt; to_array(T (&amp;&amp;a)[N]);</ins>
</pre>
</blockquote>
</li>

<li>
<p>Modify 9.2.2 [fund.ts.v2::container.array.creation] as follows:</p>

<blockquote>
<pre>
template &lt;class T, size_t N&gt;
  constexpr array&lt;remove_cv_t&lt;T&gt;, N&gt; to_array(T (&amp;a)[N]);
<ins>template &lt;class T, size_t N&gt;
  constexpr array&lt;remove_cv_t&lt;T&gt;, N&gt; to_array(T (&amp;&amp;a)[N]);</ins>
</pre>
<blockquote>
<p>
-6- <i>Returns:</i> <ins>For all <tt><i>i</i></tt>, <tt>0 &le; <i>i</i> &lt; N</tt>, a</ins><del>A</del>n 
<tt>array&lt;remove_cv_t&lt;T&gt;, N&gt;</tt> <del>such that each element is copy-initialized 
with the corresponding element of <tt>a</tt></del><ins>initialized with <tt>{ a[<i>i</i>]... }</tt> for 
the first form, or <tt>{ std::move(a[<i>i</i>])... }</tt> for the second form.</ins>.
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2815" href="2815">2815.</a> <tt>quick_exit</tt> can deadlock</h3>
<p><b>Section:</b> 17.5 <a href="https://timsong-cpp.github.io/cppwp/support.start.term">[support.start.term]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jean-Fran&ccedil;ois Bastien <b>Opened:</b> 2016-11-07 <b>Last modified:</b> 2017-03-21 22:54:52 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#support.start.term">active issues</a> in [support.start.term].</p>
<p><b>View all other</b> <a href="lwg-index.html#support.start.term">issues</a> in [support.start.term].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
While SG1 was processing NB comments CA1 and LATE2 regarding <a href="http://wg21.link/p0270r1">P0270R1</a>, 
we decided to remove the proposed guarantee that <tt>quick_exit</tt> be made signal safe.
<p/>
Our reasoning is that functions registered with <tt>at_quick_exit</tt> aren't forbidden from calling 
<tt>quick_exit</tt>, but <tt>quick_exit</tt> implementations likely acquire some form of a lock before 
processing all registered functions (because a note forbids the implementation from introducing data races).
<p/>
The following code can therefore deadlock:
</p>
<blockquote><pre>
#include &lt;cstdlib&gt;

int main() 
{
  std::at_quick_exit([] () { std::quick_exit(0); });
  std::quick_exit(1);
  return 0;
}
</pre></blockquote>
<p>
The same applies if a function registered in <tt>at_quick_exit</tt> handles a signal, and that signal calls 
<tt>quick_exit</tt>. SG1 believes that both issues (same thread deadlock, and signal deadlock) can be resolved 
in the same manner. Either:
</p>
<ol>
<li>Specify that calling <tt>quick_exit</tt> while servicing <tt>quick_exit</tt> is undefined; or</li>
<li>Specifying that calling <tt>quick_exit</tt> while servicing <tt>quick_exit</tt> is defined to not deadlock, 
and instead calls <tt>_Exit</tt> without calling further registered functions.</li>
</ol>
<p>
Option 2. seems preferable, and can be implemented along the lines of:
</p>
<blockquote><pre>
#include &lt;array&gt;
#include &lt;atomic&gt;
#include &lt;cstddef&gt;

namespace {

  typedef void (*func)();
  
  std::array&lt;func, 32&gt; quick_exit_functions;
  
  const auto* quick_exit_functions_ptr = &amp;quick_exit_functions;
  
  std::atomic_flag lock = ATOMIC_FLAG_INIT;
  
  struct scope 
  {
    scope() { while (lock.test_and_set(std::memory_order_acquire)) ; }
    ~scope() { lock.clear(std::memory_order_release); }
  };
  
}

namespace std {

  extern "C" void quick_exit(int status) noexcept
  {
    decltype(quick_exit_functions_ptr) f;
    {
      scope s;
      f = quick_exit_functions_ptr;
      quick_exit_functions_ptr = nullptr;
    }
    if (f) {
      size_t pos = f-&gt;size();
      while (pos &gt; 0)
        (*f)[--pos]();
    }
    _Exit(status);
  }
  
  extern "C++" int at_quick_exit(func f) noexcept
  {
    scope s;
    if (!quick_exit_functions_ptr || quick_exit_functions.size() == quick_exit_functions.max_size())
      return -1;
    quick_exit_functions[quick_exit_functions.size()] = f;
    return 0;
  }

}
</pre></blockquote>
<p>
Ideally, the resolution would also add back the wording which SG1 dropped from <a href="http://wg21.link/p0270r1">P0270R1</a>:
</p>
<blockquote><p>Add at new element to the end of 17.5 <a href="https://timsong-cpp.github.io/cppwp/support.start.term">[support.start.term]</a> p13 (<tt>quick_exit()</tt>):</p>
<blockquote>
<p>
<ins><i>Remarks:</i> The function <tt>quick_exit()</tt> is signal-safe (17.13.3 <a href="https://timsong-cpp.github.io/cppwp/csignal.syn">[csignal.syn]</a>). [<i>Note:</i> It might 
still be unsafe to call <tt>quick_exit()</tt> from a handler, because the functions registered with <tt>at_quick_exit()</tt> 
might not be signal-safe. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</blockquote>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Priority 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4606">N4606</a>.</p>

<ol>
<li>
<p>Add at new element to the end of 17.5 <a href="https://timsong-cpp.github.io/cppwp/support.start.term">[support.start.term]</a> p13 (<tt>quick_exit()</tt>):</p>

<blockquote>
<pre>
[[noreturn]] void quick_exit(int status) noexcept;
</pre>
<blockquote>
<p>
-13- <i>Effects:</i> Functions registered by calls to <tt>at_quick_exit</tt> are called in the reverse order of their
registration, except that a function shall be called after any previously registered functions that had
already been called at the time it was registered. Objects shall not be destroyed as a result of calling
<tt>quick_exit</tt>. If control leaves a registered function called by <tt>quick_exit</tt> because the function does not
provide a handler for a thrown exception, <tt>std::terminate()</tt> shall be called. [<i>Note:</i> <tt>at_quick_exit</tt>
may call a registered function from a different thread than the one that registered it, so registered
functions should not rely on the identity of objects with thread storage duration. &mdash; <i>end note</i>] After
calling registered functions, <tt>quick_exit</tt> shall call <tt>_Exit(status)</tt>. [<i>Note:</i> The standard file 
buffers are not flushed. See: ISO C 7.22.4.5. &mdash; <i>end note</i>]
<p/>
<ins>-?- <i>Remarks:</i> The function <tt>quick_exit()</tt> is signal-safe (17.13.3 <a href="https://timsong-cpp.github.io/cppwp/csignal.syn">[csignal.syn]</a>). [<i>Note:</i> 
It might still be unsafe to call <tt>quick_exit()</tt> from a handler, because the functions registered with 
<tt>at_quick_exit()</tt> might not be signal-safe. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</blockquote>
</li>

</ol>






<hr>
<h3><a name="2818" href="2818">2818.</a> <tt>"::std::"</tt> everywhere rule needs tweaking</h3>
<p><b>Section:</b> 16.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/contents">[contents]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2016-11-11 <b>Last modified:</b> 2020-02-14 08:12:08 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#contents">issues</a> in [contents].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[contents]/3 says
</p>
<blockquote><p>
Whenever a name <tt>x</tt> defined in the standard library is mentioned, the name <tt>x</tt> is assumed to be fully 
qualified as <tt>::std::x</tt>, unless explicitly described otherwise. For example, if the <i>Effects</i> section 
for library function <tt>F</tt> is described as calling library function <tt>G</tt>, the function <tt>::std::G</tt> is meant.
</p></blockquote>
<p>
With the introduction of nested namespaces inside <tt>std</tt>, this rule needs tweaking. For instance, 
<tt>time_point_cast</tt>'s <i>Returns</i> clause says "<tt>time_point&lt;Clock, 
ToDuration&gt;(duration_cast&lt;ToDuration&gt;(t.time_since_epoch()))</tt>"; that reference to <tt>duration_cast</tt> 
obviously means <tt>::std::chrono::duration_cast</tt>, not <tt>::std::duration_cast</tt>, which doesn't exist.
</p>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Priority 2; Jonathan to provide wording</p>

<p><i>[2019 Cologne Wednesday night]</i></p>

<p>Geoffrey suggested editing 16.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/contents">[contents]</a>/2 to mention the case when we're defining things in a sub-namespace.</p>
<p>Jonathan to word this.</p>

<p><i>[2020-02-14, Prague; Walter provides wording]</i></p>

<p>
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 16.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/contents">[contents]</a> as indicated:</p>

<blockquote>
<p>
-3- <del>Whenever a name <tt>x</tt> defined in the standard library is mentioned, the name <tt>x</tt> is assumed to be fully qualified
as <tt>::std::x</tt>, unless explicitly described otherwise. For example, if the <i>Effects:</i> element for library function <tt>F</tt>
is described as calling library function <tt>G</tt>, the function <tt>::std::G</tt> is meant.</del><ins>Let <tt>x</tt> be a name
specified by the standard library via a declaration in namespace <tt>std</tt> or in a subnamespace of namespace <tt>std</tt>.
Whenever <tt>x</tt> is used as an unqualified name in a further specification, it is assumed to correspond
to the same <tt>x</tt> that would be found via unqualified name lookup (6.5.1 <a href="https://timsong-cpp.github.io/cppwp/basic.lookup.unqual">[basic.lookup.unqual]</a>) performed at that point 
of use. Similarly, whenever <tt>x</tt> is used as a qualified name in a further specification, it is assumed to correspond
to the same <tt>x</tt> that would be found via qualified name lookup (6.5.3 <a href="https://timsong-cpp.github.io/cppwp/basic.lookup.qual">[basic.lookup.qual]</a>) performed at that point 
of use. [<i>Note:</i> Such lookups can never fail in a well-formed program. &mdash; <i>end note</i>] 
[<i>Example:</i> If an <i>Effects:</i> element for a library function <tt>F</tt> specifies that library function <tt>G</tt>
is to be used, the function <tt>::std::G</tt> is intended. &mdash; <i>end example</i>]</ins>
</p>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2819" href="2819">2819.</a> Unspecified <i>Return type:</i> elements</h3>
<p><b>Section:</b> 32.2.5 <a href="https://timsong-cpp.github.io/cppwp/thread.req.lockable">[thread.req.lockable]</a>, 32.5.3 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex.requirements">[thread.mutex.requirements]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2016-11-12 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current draft contains 14 occurrences of a <i>Return type:</i> clause.
That clause is not covered by 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> p3.
This was reported as editorial request <a href="https://github.com/cplusplus/draft/issues/266">#266</a>.
</p>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Priority 3; Jonathan to provide wording.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2820" href="2820">2820.</a> Clarify <tt>&lt;cstdint&gt;</tt> macros</h3>
<p><b>Section:</b> 17.4 <a href="https://timsong-cpp.github.io/cppwp/cstdint">[cstdint]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Thomas K&ouml;ppe <b>Opened:</b> 2016-11-12 <b>Last modified:</b> 2019-03-26 20:35:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#cstdint">issues</a> in [cstdint].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I would like clarification from LWG regarding the various limit macros like <tt>INT_8_MIN</tt> in <tt>&lt;cstdint&gt;</tt>, 
in pursuit of editorial cleanup of this header's synopsis. I have two questions:
</p>
<ol>
<li><p>At present, macros like <tt>INT_8_MIN</tt> that correspond to the optional type <tt>int8_t</tt> are required 
(unconditionally), whereas the underlying type to which they appertain is only optional. Is this deliberate? 
Should the macros also be optional?</p></li>
<li><p>Is it deliberate that C++ only specifies sized aliases for the sizes 8, 16, 32 and 64, whereas the corresponding 
C header allows type aliases and macros for arbitrary sizes for implementations that choose to provide extended integer 
types? Is the C++ wording more restrictive by accident?</p></li>
</ol>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>C11 ties the macro names to the existence of the types. Marshall to research the second question.</p>
<p>Close <a href="2764">2764</a> as a duplicate of this issue.</p>

<p><i>[2017-03-18, Thomas comments and provides wording]</i></p>

<p>
This is as close as I can get to the C wording without resolving part (a) of the issue (whether we deliberately don't 
allow sized type aliases for sizes other than 8, 16, 32, 64, a departure from C). Once we resolve part (a), we need 
to revisit <tt>&lt;cinttypes&gt;</tt> and fix up the synopsis (perhaps to get rid of <tt>N</tt>) and add similar 
wording as the one below to make the formatting macros for the fixed-width types optional. For historical interest,
this issue is related to LWG <a href="553">553</a> and LWG <a href="841">841</a>.
</p>

<p><i>[2016-07, Toronto Saturday afternoon issues processing]</i></p>

<p>Status to Open</p>

<strong>Previous resolution: [SUPERSEDED]</strong>

<blockquote class="note">
<p>
This wording is relative to <a href="http://wg21.link/n4640">N4640</a>.
</p>

<ol>
<li><p>Append the following content to 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a> p2:</p>

<blockquote>
<p>
-2- The header defines all types and macros the same as the C standard library header <tt>&lt;stdint.h&gt;</tt>.
<ins>In particular, for each of the fixed-width types (<tt>int8_t</tt>, <tt>int16_t</tt>, <tt>int32_t</tt>, 
<tt>int64_t</tt>, <tt>uint8_t</tt>, <tt>uint16_t</tt>, <tt>uint32_t</tt>, <tt>uint64_t</tt>) the type alias and 
the corresponding limit macros are defined if and only if the implementation provides the corresponding type.</ins>
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2017-10-21, Thomas K&ouml;ppe provides improved wording]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
<p>This wording is relative to <a href="http://wg21.link/n4687">N4687</a>.</p>
</p>

<ol>
<li><p>Change 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>, header <tt>&lt;cstdint&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
using int64_t = <i>signed integer type</i>; <i>// optional</i>
<ins>using int<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using int_fast64_t = <i>signed integer type</i>;
<ins>using int_fast<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using int_least64_t = <i>signed integer type</i>;
<ins>using int_least<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint64_t = <i>unsigned integer type</i>; <i>// optional</i>
<ins>using uint<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint_fast64_t = <i>unsigned integer type</i>;
<ins>using uint_fast<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint_least64_t = <i>unsigned integer type</i>;
<ins>using uint_least<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>

using uintmax_t = <i>unsigned integer type</i>;
using uintptr_t = <i>unsigned integer type</i>; <i>// optional</i>

<ins>#define INT_<i>N</i>_MIN  <i>see below</i>;
#define INT_<i>N</i>_MAX  <i>see below</i>;
#define UINT_<i>N</i>_MAX  <i>see below</i>;

#define INT_FAST<i>N</i>_MIN  <i>see below</i>;
#define INT_FAST<i>N</i>_MAX  <i>see below</i>;
#define UINT_FAST<i>N</i>_MAX  <i>see below</i>;

#define INT_LEAST<i>N</i>_MIN  <i>see below</i>;
#define INT_LEAST<i>N</i>_MAX  <i>see below</i>;
#define UINT_LEAST<i>N</i>_MAX  <i>see below</i>;

#define INTMAX_MIN  <i>see below</i>;
#define INTMAX_MAX  <i>see below</i>;
#define UINTMAX_MAX  <i>see below</i>;

#define INTPTR_MIN  <i>see below</i>;
#define INTPTR_MAX  <i>see below</i>;
#define UINTPTR_MAX  <i>see below</i>;

#define PTRDIFF_MIN  <i>see below</i>;
#define PTRDIFF_MAX  <i>see below</i>;
#define SIZE_MAX  <i>see below</i>;

#define SIGATOMIC_MIN  <i>see below</i>;
#define SIGATOMIC_MAX  <i>see below</i>;

#define WCHAR_MIN  <i>see below</i>;
#define WCHAR_MAX  <i>see below</i>;

#define WINT_MIN  <i>see below</i>;
#define WINT_MAX  <i>see below</i>;

#define INT<i>N</i>_C(value)  <i>see below</i>;
#define UINT<i>N</i>_C(value)  <i>see below</i>;
#define INTMAX_C(value)  <i>see below</i>;
#define UINTMAX_C(value)  <i>see below</i>;</ins>
</pre>
<p>
<del>-1- The header also defines numerous macros of the form:</del>
</p>
<blockquote><pre>
<del>INT_[FAST LEAST]{8 16 32 64}_MIN
[U]INT_[FAST LEAST]{8 16 32 64}_MAX
INT{MAX PTR}_MIN
[U]INT{MAX PTR}_MAX
{PTRDIFF SIG_ATOMIC WCHAR WINT}{_MAX _MIN}
SIZE_MAX</del>
</pre></blockquote>
<p>
<del>plus function macros of the form:</del>
</p>
<blockquote><pre>
<del>[U]INT{8 16 32 64 MAX}_C</del>
</pre></blockquote>
<p>
-2- The header defines all types and macros the same as the C standard library header <tt>&lt;stdint.h&gt;</tt>.
<span style="font-variant: small-caps;">See also</span>: ISO C 7.20
<p/>
<ins>-?- In particular, all types that use the placeholder <tt><i>N</i></tt> are optional when <tt><i>N</i></tt> is not 8, 
16, 32 or 64. The exact-width types <tt>int<i>N</i>_t</tt> and <tt>uint<i>N</i>_t</tt> for <tt><i>N</i></tt> = 8, 16, 32, 64 
are also optional; however, if an implementation provides integer types with the corresponding width, no padding bits, and 
(for the signed types) that have a two's complement representation, it defines the corresponding typedef names. Only 
those macros are defined that correspond to typedef names that the implementation actually provides. [<i>Note:</i> The macros 
<tt>INT<i>N</i>_C</tt> and <tt>UINT<i>N</i>_C</tt> correspond to the typedef names <tt>int_least<i>N</i>_t</tt> and 
<tt>uint_least<i>N</i>_t</tt>, respectively. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</li>

<li><p>Change 29.12.2 <a href="https://timsong-cpp.github.io/cppwp/cinttypes.syn">[cinttypes.syn]</a> as indicated:</p>

<blockquote><pre>
#define PRId<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIi<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIo<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIu<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIx<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIX<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNd<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNi<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNo<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNu<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNx<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIdLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIiLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIoLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIuLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIxLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIXLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNdLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNiLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNoLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNuLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNxLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIdFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIiFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIoFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIuFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIxFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIXFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNdFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNiFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNoFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNuFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNxFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
[&hellip;]
</pre>
<p>
-1- The contents and meaning of the header <tt>&lt;cinttypes&gt;</tt> [&hellip;]
<p/>
<ins>-?- In particular, macros that use the placeholder <tt><i>N</i></tt> are defined if and only if the implementation 
actually provides the corresponding typedef name in 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>, and moreover, the <tt>fscanf</tt> macros 
are provided unless the implementation does not have a suitable <tt>fscanf</tt> length modifier for the type.</ins>
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-04-03; Geoffrey Romer suggests improved wording]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li><p>Change 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>, header <tt>&lt;cstdint&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
using int64_t = <i>signed integer type</i>; <i>// optional</i>
<ins>using int<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using int_fast64_t = <i>signed integer type</i>;
<ins>using int_fast<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using int_least64_t = <i>signed integer type</i>;
<ins>using int_least<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint64_t = <i>unsigned integer type</i>; <i>// optional</i>
<ins>using uint<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint_fast64_t = <i>unsigned integer type</i>;
<ins>using uint_fast<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint_least64_t = <i>unsigned integer type</i>;
<ins>using uint_least<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>

using uintmax_t = <i>unsigned integer type</i>;
using uintptr_t = <i>unsigned integer type</i>; <i>// optional</i>

<ins>#define INT_<i>N</i>_MIN  <i>see below</i>;
#define INT_<i>N</i>_MAX  <i>see below</i>;
#define UINT_<i>N</i>_MAX  <i>see below</i>;

#define INT_FAST<i>N</i>_MIN  <i>see below</i>;
#define INT_FAST<i>N</i>_MAX  <i>see below</i>;
#define UINT_FAST<i>N</i>_MAX  <i>see below</i>;

#define INT_LEAST<i>N</i>_MIN  <i>see below</i>;
#define INT_LEAST<i>N</i>_MAX  <i>see below</i>;
#define UINT_LEAST<i>N</i>_MAX  <i>see below</i>;

#define INTMAX_MIN  <i>see below</i>;
#define INTMAX_MAX  <i>see below</i>;
#define UINTMAX_MAX  <i>see below</i>;

#define INTPTR_MIN  <i>see below</i>;
#define INTPTR_MAX  <i>see below</i>;
#define UINTPTR_MAX  <i>see below</i>;

#define PTRDIFF_MIN  <i>see below</i>;
#define PTRDIFF_MAX  <i>see below</i>;
#define SIZE_MAX  <i>see below</i>;

#define SIGATOMIC_MIN  <i>see below</i>;
#define SIGATOMIC_MAX  <i>see below</i>;

#define WCHAR_MIN  <i>see below</i>;
#define WCHAR_MAX  <i>see below</i>;

#define WINT_MIN  <i>see below</i>;
#define WINT_MAX  <i>see below</i>;

#define INT<i>N</i>_C(value)  <i>see below</i>;
#define UINT<i>N</i>_C(value)  <i>see below</i>;
#define INTMAX_C(value)  <i>see below</i>;
#define UINTMAX_C(value)  <i>see below</i>;</ins>
</pre>
<p>
<del>-1- The header also defines numerous macros of the form:</del>
</p>
<blockquote><pre>
<del>INT_[FAST LEAST]{8 16 32 64}_MIN
[U]INT_[FAST LEAST]{8 16 32 64}_MAX
INT{MAX PTR}_MIN
[U]INT{MAX PTR}_MAX
{PTRDIFF SIG_ATOMIC WCHAR WINT}{_MAX _MIN}
SIZE_MAX</del>
</pre></blockquote>
<p>
<del>plus function macros of the form:</del>
</p>
<blockquote><pre>
<del>[U]INT{8 16 32 64 MAX}_C</del>
</pre></blockquote>
<p>
-2- The header defines all types and macros the same as the C standard library header <tt>&lt;stdint.h&gt;</tt>.
<span style="font-variant: small-caps;">See also</span>: ISO C 7.20
<p/>
<ins>-?- In particular, all types that use the placeholder <tt><i>N</i></tt> are optional when <tt><i>N</i></tt> is not 8, 
16, 32 or 64. The exact-width types <tt>int<i>N</i>_t</tt> and <tt>uint<i>N</i>_t</tt> for <tt><i>N</i></tt> = 8, 16, 32, 64 
are also optional; however, if an implementation provides integer types with the corresponding width, no padding bits, and 
(for the signed types) that have a two's complement representation, it defines the corresponding typedef names. Only 
those macros are defined that correspond to typedef names that the implementation actually provides. [<i>Note:</i> The macros 
<tt>INT<i>N</i>_C</tt> and <tt>UINT<i>N</i>_C</tt> correspond to the typedef names <tt>int_least<i>N</i>_t</tt> and 
<tt>uint_least<i>N</i>_t</tt>, respectively. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</li>

<li><p>Change 29.12.2 <a href="https://timsong-cpp.github.io/cppwp/cinttypes.syn">[cinttypes.syn]</a> as indicated:</p>

<blockquote><pre>
#define PRId<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIi<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIo<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIu<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIx<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIX<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNd<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNi<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNo<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNu<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNx<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIdLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIiLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIoLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIuLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIxLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIXLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNdLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNiLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNoLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNuLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNxLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIdFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIiFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIoFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIuFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIxFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIXFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNdFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNiFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNoFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNuFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNxFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
[&hellip;]
</pre>
<p>
-1- The contents and meaning of the header <tt>&lt;cinttypes&gt;</tt> [&hellip;]
<p/>
<ins>-?- <tt>PRI</tt> macros that use the placeholder <tt><i>N</i></tt> are defined if and only if the implementation actually 
provides the corresponding typedef name in 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>. <tt>SCN</tt> macros that use the placeholder 
<tt><i>N</i></tt> are defined if and only if the implementation actually provides the corresponding typedef name 
and the implementation has a suitable <tt>fscanf</tt> length modifier for the type.</ins>
</p>
</blockquote>
</li>
</ol></blockquote>

<p><i>[2019-03-11; Reflector review and improved wording]</i></p>

<p>
Wording simplifications due to new general two's complement requirements of integer types; removal of wording
redundancies and applying some typo fixes in macro names.
</p>

<p><i>[2019-03-16; Daniel comments and updates wording]</i></p>

<p>
Hubert Tong pointed out that we do not have a statement about <tt>[U]INTPTR_{MIN|MAX}</tt> being optional.
Interestingly, the C11 Standard does not say directly that the <tt>[U]INTPTR_{MIN|MAX}</tt> macros are optional,
but this follows indirectly from the fact that <tt>intptr_t</tt> and <tt>uintptr_t</tt> are indeed optional. 
The updated wording therefore realizes Hubert's suggestion.
<p/>
In addition, the reference document has been rebased to <a href="http://wg21.link/n4810">N4810</a>, because
that draft version contains an <a href="https://github.com/cplusplus/draft/pull/2638">editorial change</a>, 
which renames the term "range exponent" of integer types to "width", which is the vocabulary used below and
also matches C's use.
<p/>
Finally, Hubert Tong suggested the following rewording replacements of
</p>
<blockquote><p>
If and only if the implementation defines such a typedef name, it also defines the corresponding macros.
</p></blockquote>
<p>
to:
</p>
<blockquote><p>
Each of the macros listed in this subclause is defined if and only if the implementation defines the corresponding typedef name.
</p></blockquote>
<p>
and of
</p>
<blockquote><p>
<tt>PRI</tt> macros that use the placeholder N are defined if and only if the implementation actually defines the 
corresponding typedef name in 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>. <tt>SCN</tt> macros that use the placeholder <tt><i>N</i></tt> 
are defined if and only if the implementation actually defines the corresponding typedef name and the implementation 
has a suitable <tt>fscanf</tt> length modifier for the type.
</p></blockquote>
<p>
to:
</p>
<blockquote><p>
Each of the macros listed in this subclause is defined if and only if the implementation actually defines the corresponding 
typedef name in 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>.
</p></blockquote>
<p>
Those changes have been applied as well.
</p>

<p><i>[2019-03-26; Reflector discussion and minor wording update]</i></p>

<p>
Geoffrey pointed out that the revised wording has the effect that it requires an implementation to define <tt>SCN</tt>
macros for all mentioned typedefs, but the C11 standard says "the corresponding <tt>fscanf</tt> macros shall be
defined unless the implementation does not have a suitable <tt>fscanf</tt> length modifier for the type.". An additional 
wording update repairs this problem below.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.
</p>

<ol>
<li><p>Change 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>, header <tt>&lt;cstdint&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
using int64_t = <i>signed integer type</i>; <i>// optional</i>
<ins>using int<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using int_fast64_t = <i>signed integer type</i>;
<ins>using int_fast<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using int_least64_t = <i>signed integer type</i>;
<ins>using int_least<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint64_t = <i>unsigned integer type</i>; <i>// optional</i>
<ins>using uint<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint_fast64_t = <i>unsigned integer type</i>;
<ins>using uint_fast<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>
[&hellip;]
using uint_least64_t = <i>unsigned integer type</i>;
<ins>using uint_least<i>N</i>_t = <i>see below</i>; <i>// optional, see below</i></ins>

using uintmax_t = <i>unsigned integer type</i>;
using uintptr_t = <i>unsigned integer type</i>; <i>// optional</i>

<ins>#define INT<i>N</i>_MIN  <i>see below</i>
#define INT<i>N</i>_MAX  <i>see below</i>
#define UINT<i>N</i>_MAX  <i>see below</i>

#define INT_FAST<i>N</i>_MIN  <i>see below</i>
#define INT_FAST<i>N</i>_MAX  <i>see below</i>
#define UINT_FAST<i>N</i>_MAX  <i>see below</i>

#define INT_LEAST<i>N</i>_MIN  <i>see below</i>
#define INT_LEAST<i>N</i>_MAX  <i>see below</i>
#define UINT_LEAST<i>N</i>_MAX  <i>see below</i>

#define INTMAX_MIN  <i>see below</i>
#define INTMAX_MAX  <i>see below</i>
#define UINTMAX_MAX  <i>see below</i>

#define INTPTR_MIN  <i>optional, see below</i>
#define INTPTR_MAX  <i>optional, see below</i>
#define UINTPTR_MAX  <i>optional, see below</i>

#define PTRDIFF_MIN  <i>see below</i>
#define PTRDIFF_MAX  <i>see below</i>
#define SIZE_MAX  <i>see below</i>

#define SIG_ATOMIC_MIN  <i>see below</i>
#define SIG_ATOMIC_MAX  <i>see below</i>

#define WCHAR_MIN  <i>see below</i>
#define WCHAR_MAX  <i>see below</i>

#define WINT_MIN  <i>see below</i>
#define WINT_MAX  <i>see below</i>

#define INT<i>N</i>_C(value)  <i>see below</i>
#define UINT<i>N</i>_C(value)  <i>see below</i>
#define INTMAX_C(value)  <i>see below</i>
#define UINTMAX_C(value)  <i>see below</i></ins>
</pre>
<p>
<del>-1- The header also defines numerous macros of the form:</del>
</p>
<blockquote><pre>
<del>INT_[FAST LEAST]{8 16 32 64}_MIN
[U]INT_[FAST LEAST]{8 16 32 64}_MAX
INT{MAX PTR}_MIN
[U]INT{MAX PTR}_MAX
{PTRDIFF SIG_ATOMIC WCHAR WINT}{_MAX _MIN}
SIZE_MAX</del>
</pre></blockquote>
<p>
<del>plus function macros of the form:</del>
</p>
<blockquote><pre>
<del>[U]INT{8 16 32 64 MAX}_C</del>
</pre></blockquote>
<p>
-2- The header defines all types and macros the same as the C standard library header <tt>&lt;stdint.h&gt;</tt>.
<span style="font-variant: small-caps;">See also</span>: ISO C 7.20
<p/>
<ins>-?- All types that use the placeholder <tt><i>N</i></tt> are optional when <tt><i>N</i></tt> is not 8, 
16, 32 or 64. The exact-width types <tt>int<i>N</i>_t</tt> and <tt>uint<i>N</i>_t</tt> for <tt><i>N</i></tt> = 8, 16, 32, 64 
are also optional; however, if an implementation defines integer types with the corresponding width and no padding bits, 
it defines the corresponding typedef names. Each of the macros listed in this subclause is defined if and only if 
the implementation defines the corresponding typedef name. [<i>Note:</i> The macros <tt>INT<i>N</i>_C</tt> and 
<tt>UINT<i>N</i>_C</tt> correspond to the typedef names <tt>int_least<i>N</i>_t</tt> and <tt>uint_least<i>N</i>_t</tt>, 
respectively. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</li>

<li><p>Change 29.12.2 <a href="https://timsong-cpp.github.io/cppwp/cinttypes.syn">[cinttypes.syn]</a> as indicated:</p>

<blockquote><pre>
#define PRId<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIi<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIo<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIu<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIx<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIX<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNd<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNi<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNo<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNu<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNx<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIdLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIiLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIoLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIuLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIxLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIXLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNdLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNiLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNoLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNuLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNxLEAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIdFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIiFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIoFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIuFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIxFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define PRIXFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNdFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNiFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNoFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNuFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
#define SCNxFAST<del>N</del><ins><i>N</i></ins> <i>see below</i>
[&hellip;]
</pre>
<p>
-1- The contents and meaning of the header <tt>&lt;cinttypes&gt;</tt> [&hellip;]
<p/>
<ins>-?- Each of the <tt>PRI</tt> macros listed in this subclause is defined if and only if the implementation defines the 
corresponding typedef name in 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>. Each of the <tt>SCN</tt> macros listed in this subclause is 
defined if and only if the implementation defines the corresponding typedef name in 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a> and
has a suitable <tt>fscanf</tt> length modifier for the type.</ins>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2823" href="2823">2823.</a> <tt>std::array</tt> initialization is still not permissive enough</h3>
<p><b>Section:</b> 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Robert Haberlach <b>Opened:</b> 2016-11-16 <b>Last modified:</b> 2018-03-19 00:12:24 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#array.overview">active issues</a> in [array.overview].</p>
<p><b>View all other</b> <a href="lwg-index.html#array.overview">issues</a> in [array.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="2590">2590</a>'s resolution is incomplete:
</p>
<blockquote><pre>
std::array&lt;int, 1&gt; arr{{0}};
</pre></blockquote>
<p>
should be fine, but isn't guaranteed, since <tt>{0}</tt> has no type. We should rather go for implicit conversion:
</p>
<blockquote><p>
An array is an aggregate (9.4.1 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.aggr">[dcl.init.aggr]</a>) that can be list-initialized with up to <tt>N</tt> elements 
<del>whose types are convertible to <tt>T</tt></del><ins>that can be implicitly converted to <tt>T</tt></ins>.
</p></blockquote>

<p><i>[2016-11-26, Tim Song comments]</i></p>

<p> 
This is not possible as written, because due to the brace elision rules for aggregate initialization,
<tt>std::array&lt;int, 2&gt; arr{{0}, {1}};</tt> will never work: the <tt>{0}</tt> 
is taken as initializing the inner array, and the <tt>{1}</tt> causes an error.
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 2; consensus is that the P/R is not quite right.</p>

<p><i>[2018-3-14 Wednesday evening issues processing; priority to 3; move to Open]</i></p>

<p>Jens: There's nothing you can do about the double braces in std::array. That's a core thing.</p>
<p>STL to write paper to resolve this.</p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4606.
</p>
<ol>
<li><p>Change 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> p2 as indicated:</p>

<blockquote>
<p>
-2- An <tt>array</tt> is an aggregate (9.4.1 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.aggr">[dcl.init.aggr]</a>) that can be list-initialized with up to <tt>N</tt> 
elements <del>whose types are convertible</del><ins>that can be implicitly converted</ins> to <tt>T</tt>.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2825" href="2825">2825.</a> LWG 2756 breaks class template argument deduction for <tt>optional</tt></h3>
<p><b>Section:</b> 20.6.3 <a href="https://timsong-cpp.github.io/cppwp/optional.optional">[optional.optional]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2016-11-24 <b>Last modified:</b> 2017-02-01 20:37:54 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#optional.optional">active issues</a> in [optional.optional].</p>
<p><b>View all other</b> <a href="lwg-index.html#optional.optional">issues</a> in [optional.optional].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="2756">2756</a> applies these changes:
</p>
<blockquote><pre>
<del>constexpr optional(const T&amp;);
constexpr optional(T&amp;&amp;);</del>
template &lt;class... Args&gt; constexpr explicit optional(in_place_t, Args&amp;&amp;...);
template &lt;class U, class... Args&gt;
  constexpr explicit optional(in_place_t, initializer_list&lt;U&gt;, Args&amp;&amp;...);
<ins>template &lt;class U = T&gt; <i>EXPLICIT</i> constexpr optional(U&amp;&amp;);
template &lt;class U&gt; <i>EXPLICIT</i> optional(const optional&lt;U&gt;&amp;);
template &lt;class U&gt; <i>EXPLICIT</i> optional(optional&lt;U&gt;&amp;&amp;);</ins>
</pre></blockquote> 
<p>
These break the ability for <tt>optional</tt> to perform class template argument deduction, as there 
is now no way to map from <tt>optional</tt>'s argument to the template parameter <tt>T</tt>.
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 2</p>

<p><i>[2017-01-30  Ville comments:]</i></p>

<p>Seems like the problem is resolved by a simple deduction guide:</p>
<pre>template &lt;class T&gt; optional(T) -&gt; optional&lt;T&gt;;</pre>
<p>The paper <a href="https://wg21.link/p0433r0">p0433r0</a> seems to suggest a different guide,</p>
<pre>template&lt;class T&gt; optional(T&amp;&amp; t) -&gt; optional&lt;remove_reference_t&lt;T&gt;&gt;;</pre>
<p>but I don't think the paper is up to speed with LWG <a href="2756">2756</a>. There's no reason
to use such an universal reference in the guide and <tt>remove_reference</tt> in its
target, just guide with <tt>T</tt>, with the target <tt>optional&lt;T&gt;</tt>, <tt>optional</tt>'s constructors
do the right thing once the type has been deduced.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2827" href="2827">2827.</a> <tt>is_trivially_constructible</tt> and non-trivial destructors</h3>
<p><b>Section:</b> 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2016-11-17 <b>Last modified:</b> 2020-01-25 15:17:35 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.unary.prop">active issues</a> in [meta.unary.prop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.unary.prop">issues</a> in [meta.unary.prop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<blockquote><pre>
struct S 
{
  ~S(); // non-trivial
};

static_assert(std::is_trivially_constructible&lt;S&gt;::value, "");
</pre></blockquote>
<p>
Should the assert pass? Implementations disagree.
<p/>
Per 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a>'s Table 38, this trait looks at whether the following variable definition is 
known to call no operation that is not trivial:
</p>
<blockquote><pre>
S t(create&lt;Args&gt;()...);
</pre></blockquote>
<p>
... where <tt>Args</tt> is an empty pack in this case. That variable definition results in a call to the <tt>S</tt> destructor. 
Should that call be considered by the trait?
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3</p>
<p>This issue interacts with <a href="2116">2116</a></p>

<p><i>[2020-01-24; Peter Dimov comments]</i></p>

<p>
<tt>std::is_trivially_copy_constructible_v&lt;D&gt;</tt>, where <tt>D</tt> is
</p>
<blockquote><pre>
struct D
{
  ~D() {}
};
</pre></blockquote>
<p>
reports <tt>false</tt>. This is because the definition of
<tt>is_trivially_copy_constructible</tt> requires the invented variable 
definition <tt>T t(declval&lt;Args&gt;()...);</tt>, which in our case is 
<tt>D t(declval&lt;D&gt;());</tt>, to not call any nontrivial operations.
<p/>
This is interpreted by implementations to include the destructor call,
presumably for consistency with <tt>is_nothrow_copy_constructible</tt>. 
But that's wrong; the copy constructor <em>is</em> trivial.
<p/>
As a consequence, <tt>variant&lt;D&gt;</tt> also doesn't have a trivial 
copy constructor, which causes (completely unnecessary) inefficiencies 
when said <tt>variant</tt> is copied.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2829" href="2829">2829.</a> LWG 2740 leaves behind vacuous words</h3>
<p><b>Section:</b> 20.6.3.5 <a href="https://timsong-cpp.github.io/cppwp/optional.observe">[optional.observe]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2016-11-24 <b>Last modified:</b> 2018-06-12 04:35:59 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#optional.observe">issues</a> in [optional.observe].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
After applying LWG <a href="2740">2740</a>, we have:
</p>
<blockquote>
<pre>
constexpr const T* operator-&gt;() const;
constexpr T* operator-&gt;();
</pre>
<blockquote>
<p>
-1- <i>Requires:</i> <tt>*this</tt> contains a value.
<p/>
-2- <i>Returns:</i> <tt>val</tt>.
<p/>
-3- <i>Throws:</i> Nothing.
<p/>
-4- <i>Remarks:</i> These functions shall be <tt>constexpr</tt> functions.
</p>
</blockquote>
</blockquote>
<p>
Paragraph 4 is completely superfluous. We already said these functions were <tt>constexpr</tt> in the synopsis. Can it be removed?
</p>

<p><i>[Issues Telecon 16-Dec-2016]</i></p>

<p>Priority 2</p>
<p>Jonathan notes: Although Richard is correct, I suggest we don't strike the paragraph, so that we 
remember to fix it as part of <a href="2833">2833</a>, when we know how to say
this properly.</p>

<p><i>[2018-06 Rapperswil Thursday issues processing]</i></p>

<p>Status to Open; also see 7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>/6 and <a href="2289">2289</a>.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2832" href="2832">2832.</a> &sect;[fpos.operations] strange requirement for <tt>P(i)</tt></h3>
<p><b>Section:</b> 29.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/fpos.operations">[fpos.operations]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2016-11-24 <b>Last modified:</b> 2019-03-22 17:53:09 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#fpos.operations">active issues</a> in [fpos.operations].</p>
<p><b>View all other</b> <a href="lwg-index.html#fpos.operations">issues</a> in [fpos.operations].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This is from editorial issue <a href="https://github.com/cplusplus/draft/issues/1031">#1031</a>.
<p/>
The first row in Table 112 "Position type requirements"
talks about the expression <tt>P(i)</tt> and then has an assertion
<tt>p == P(i)</tt>.  However, there are no constraints on <tt>p</tt>
other than being of type <tt>P</tt>, so (on the face of it) this
seems to require that <tt>operator==</tt> on <tt>P</tt> always returns
true, which is non-sensical.
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3</p>

<p><i>[2019-03-17; Daniel comments]</i></p>

<p>
With the acceptance of <a href="http://wg21.link/p0759r1">P0759R1</a> at the Rapperswil 2018 meeting
this issue should be closed as <b>Resolved</b>.
</p>


<p><b>Rationale:</b></p>
Resolved by <a href="http://wg21.link/p0759r1">P0759R1</a>.


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2833" href="2833">2833.</a> Library needs to specify what it means when it declares a function <tt>constexpr</tt></h3>
<p><b>Section:</b> 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2016-11-28 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#variant.ctor">active issues</a> in [variant.ctor].</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.ctor">issues</a> in [variant.ctor].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The library has lots of functions declared <tt>constexpr</tt>, but it's not clear what that means. The <tt>constexpr</tt> 
keyword implies that there needs to be <em>some</em> invocation of the function, for <em>some</em> set of template 
arguments and function arguments, that is valid in a constant expression (otherwise the program would be ill-formed, 
with no diagnostic required), along with a few side conditions. I suspect the library intends to require something a 
lot stronger than that from implementations (something along the lines of "all calls that could reasonably be constant 
subexpressions are in fact constant subexpressions, unless otherwise stated").
<p/>
[variant.ctor]/1 contains this, which should also be fixed:
</p>
<blockquote><p>
"This function shall be <tt>constexpr</tt> if and only if the value-initialization of the alternative type <tt>T0</tt> 
would satisfy the requirements for a <tt>constexpr</tt> function."
</p></blockquote>
<p>
This is the wrong constraint: instead of constraining whether the function is <tt>constexpr</tt>, we should constrain 
whether a call to it is a constant subexpression.
</p>
<p>
<b>Daniel:</b>
<p/>
This is has some considerable overlap with LWG <a href="2289">2289</a> but is phrased in a more general way.
</p>

<p><i>[2016-12-16, Issues Telecon]</i></p>

<p>Priority 2; this is also the general case of <a href="2829">2829</a>.</p>

<p><i>[2017-02-20, Alisdair comments and suggests concrete wording]</i></p>

<p>
Below is is draft wording I was working on at Issaquah to try to address both issues.
</p>

<p><i>[2017-11 Albuquerque Wednesday issue processing]</i></p>

<p>Status to Open; really needs a paper.</p>
<p>STL says "What about <tt>plus&lt;T&gt;</tt>?"  <tt>plus&lt;int&gt;</tt> needs to be usable in a constexpr context, but <tt>plus&lt;string&gt;</tt> can't be.</p>

<p><i>[2017-11 Albuquerque Saturday issues processing]</i></p>

<p>Geoffrey to write a paper resolving this.</p>

<p><i>[2018-06 Rapperswil Thursday issues processing]</i></p>

<p>Geoffrey has been unable to write this paper due to time constraints. He wrote up his progress
<a href="http://lists.isocpp.org/lib/2018/04/6587.php">here</a>. Daniel has offered to help someone
to write this paper; he's willing to be a co-author.</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Michael Wong to investigate.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4640">N4640</a>.
</p>

<ol>
<li>
<p>
Modify 16.5.5.7 <a href="https://timsong-cpp.github.io/cppwp/constexpr.functions">[constexpr.functions]</a> as indicated:
</p>
<blockquote>
<h3>17.6.5.6 <tt>constexpr</tt> functions and constructors [constexpr.functions]</h3>
<p>
-1- This International Standard explicitly requires that certain standard library functions are
<tt>constexpr</tt> (9.2.5 <a href="https://timsong-cpp.github.io/cppwp/dcl.constexpr">[dcl.constexpr]</a>).  <ins>If the specification for a templated entity
requires that it shall be a <tt>constexpr</tt> templated entity, then that
templated entity shall be usable in a constant expression.</ins>.  An
implementation <del>shall not</del><ins>may</ins> declare
<del>any</del><ins>additional</ins> standard library function signature as
<tt>constexpr</tt> <del>except for those where it is explicitly required</del>.
Within any header that provides any non-defining declarations of
<tt>constexpr</tt> functions or constructors an implementation shall provide
corresponding definitions.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2839" href="2839">2839.</a> Self-move-assignment of library types, again</h3>
<p><b>Section:</b> 16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>, 16.5.4.9 <a href="https://timsong-cpp.github.io/cppwp/res.on.arguments">[res.on.arguments]</a>, 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2016-12-09 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="2468">2468</a>'s resolution added to <tt>MoveAssignable</tt> the requirement to tolerate self-move-assignment, 
but that does nothing for library types that aren't explicitly specified to meet <tt>MoveAssignable</tt> other than make 
those types not meet <tt>MoveAssignable</tt> any longer.
<p/>
To realize the intent here, we need to carve out an exception to 16.5.4.9 <a href="https://timsong-cpp.github.io/cppwp/res.on.arguments">[res.on.arguments]</a>'s restriction for 
move assignment operators and specify that self-move-assignment results in valid but unspecified state unless otherwise 
specified. The proposed wording below adds that to 16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a> since it seems to fit well with the
theme of the current paragraph in that section. 
<p/> In addition, to address the issue with 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> noted in LWG 
<a href="2468">2468</a>'s discussion, the requirement tables in that subclause will need to be edited in a way similar to 
LWG <a href="2468">2468</a>.
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 2</p>

<p><i>[2018-1-26 issues processing telecon]</i></p>

<p>Status to 'Open'; Howard to reword using 'MoveAssignable'.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4618">N4618</a>.</p>

<ol>
<li><p>Add a new paragraph at the end of 16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>:</p>
<blockquote>
<p>
-1- Objects of types defined in the C++ standard library may be moved from (12.8). Move operations may be
explicitly specified or implicitly generated. Unless otherwise specified, such moved-from objects shall be
placed in a valid but unspecified state.
<p/>
<ins>-?- An object of a type defined in the C++ standard library may be move-assigned (11.4.5 <a href="https://timsong-cpp.github.io/cppwp/class.copy.assign">[class.copy.assign]</a>) 
to itself. Such an assignment places the object in a valid but unspecified state unless otherwise specified.</ins>
</p>
</blockquote>
</li>

<li><p>Add a note at the end of 16.5.4.9 <a href="https://timsong-cpp.github.io/cppwp/res.on.arguments">[res.on.arguments]</a>/1, bullet 3, as indicated:</p>
<blockquote>
<p>
-1- Each of the following applies to all arguments to functions defined in the C++ standard library, unless
explicitly stated otherwise.
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; [&hellip;]</p></li>
<li><p>(1.2) &mdash; [&hellip;]</p></li>
<li><p>(1.3) &mdash; If a function argument binds to an rvalue reference parameter, the implementation may 
assume that this parameter is a unique reference to this argument. [<i>Note:</i> If the parameter is a generic parameter
of the form <tt>T&amp;&amp;</tt> and an lvalue of type <tt>A</tt> is bound, the argument binds to an lvalue reference 
(14.8.2.1) and thus is not covered by the previous sentence. &mdash; <i>end note</i>] [<i>Note:</i> If a program 
casts an lvalue to an xvalue while passing that lvalue to a library function (e.g. by calling the function with the argument
<tt>std::move(x)</tt>), the program is effectively asking that function to treat that lvalue as a temporary.
The implementation is free to optimize away aliasing checks which might be needed if the argument
was an lvalue. &mdash; <i>end note</i>] <ins>[<i>Note:</i> This does not apply to the argument passed to a 
move assignment operator (16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>). &mdash; <i>end note</i>]</ins></p></li>
</ol>
</blockquote>
</li>

<li><p>Edit Table 83 "Container requirements" in 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> as indicated:</p>
<blockquote>
<table border="1">
<caption>Table 83 &mdash; Container requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational<br/>semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="5" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td><tt>a = rv</tt></td>
<td><tt>T&amp;</tt></td>
<td>All existing elements of <tt>a</tt><br/> 
are either move<br/> 
assigned to or<br/>  
destroyed</td>
<td><ins>post: If <tt>a</tt> and <tt>rv</tt> do not refer to the same object,</ins><br/> 
<tt>a</tt> shall be equal to the value that<br/>  
<tt>rv</tt> had before this assignment</td>
<td>linear</td>
</tr>

<tr>
<td colspan="5" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Edit Table 86 "Allocator-aware container requirements" in 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> as indicated:</p>
<blockquote>
<table border="1">
<caption>Table 86 &mdash;  Allocator-aware container requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>
<tr>
<td><tt>a = rv</tt></td>
<td><tt>T&amp;</tt></td>
<td>
<i>Requires</i>: If <tt>allocator_traits&lt;allocator_type<br/> 
&gt;::propagate_on_container_move_assignment::value</tt><br/>
is <tt>false</tt>, <tt>T</tt> is <tt>MoveInsertable</tt><br/>  
into <tt>X</tt> and <tt>MoveAssignable</tt>.<br/>  
All existing elements of <tt>a</tt> are either<br/>  
move assigned to or destroyed.<br/>
post: <ins>If <tt>a</tt> and <tt>rv</tt> do not refer<br/>  
to the same object,</ins> <tt>a</tt> shall be equal<br/> 
to the value that <tt>rv</tt> had before this assignment</td>
<td>linear</td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>
</table>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-08-16, Howard comments and provides updated wording]</i></p>

<p>
I agreed to provide proposed wording for LWG 2839 that was reworded to use <tt>MoveAssignable</tt>. The advantage of 
this is that <tt>MoveAssignable</tt> specifies the self-assignment case, thus we do not need to repeat ourselves.
</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Howard and Tim to discuss a revised P/R.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Add a new subsection to 16.5.5 <a href="https://timsong-cpp.github.io/cppwp/conforming">[conforming]</a> after 16.5.5.5 <a href="https://timsong-cpp.github.io/cppwp/member.functions">[member.functions]</a>:</p>
<blockquote>
<p>
<ins><b>Special members [conforming.special]</b></ins>
<p/>
<ins>Class types defined by the C++ standard library and specified to be default constructible, move constructible, 
copy constructible, move assignable, copy assignable, or destructible, shall meet the associated requirements  
<i>Cpp17DefaultConstructible</i>, <i>Cpp17MoveConstructible</i>, <i>Cpp17CopyConstructible</i>, 
<i>Cpp17MoveAssignable</i>, <i>Cpp17CopyAssignable</i>, and <i>Cpp17Destructible</i>, respectively 
(16.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/utility.arg.requirements">[utility.arg.requirements]</a>).</ins>
</p>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2844" href="2844">2844.</a> Stability of <tt>a_uniq.insert(i, j)</tt></h3>
<p><b>Section:</b> 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a>, 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Matt Austern <b>Opened:</b> 2016-12-14 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#associative.reqmts">active issues</a> in [associative.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#associative.reqmts">issues</a> in [associative.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
If we write <tt>a_uniq.insert(i, j)</tt> and <tt>[i, j)</tt> has multiple elements with keys that compare equivalent, 
which ones get inserted? Consider, for example, inserting into a <tt>map&lt;string, int&gt;</tt> with
</p>
<blockquote><pre>
m.insert({{"red", 5}, {"green", 3}, {"red", 7}, {"blue", 2}, {"pink", 6}});
</pre></blockquote>
<p>
Which value for <tt>"red"</tt> will the map have?
<p/>
On my implementation we got <tt>"red" -&gt; 5</tt>, and I suspect that's true on most or all implementations, but I don't believe 
that's guaranteed by anything in the requirements. The wording in Table 90 just says that it "inserts each element from 
the range <tt>[i, j)</tt> if and only if there is no element with key equivalent to the key of that element", but that 
doesn't tell us what happens if <tt>[i, j)</tt> contains duplicate keys because it doesn't say what order the insertions 
are performed in. The standard should either guarantee that the first value is the one that gets inserted, or explicitly 
say that this is unspecified.
<p/>
The same issue applies to the range constructor, and to the unordered associative containers.
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3; Nico to provide wording.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2845" href="2845">2845.</a> <tt>enable_if</tt>, <tt>result_of</tt>, <tt>common_type</tt> and <tt>aligned_storage</tt> do not meet the definition 
of <tt>TransformationTrait</tt></h3>
<p><b>Section:</b> 20.15.1 <a href="https://timsong-cpp.github.io/cppwp/meta.rqmts">[meta.rqmts]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2016-12-14 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.rqmts">issues</a> in [meta.rqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[meta.rqmts]/3 defines <tt>TransformationTrait</tt> as follows:
</p>
<blockquote><p>
A <tt><i>TransformationTrait</i></tt> modifies a property of a type. It shall be a class template that takes 
one template type argument and, optionally, additional arguments that help define the modification. It shall 
define a publicly accessible nested type named <tt>type</tt>, which shall be a synonym for the modified type.
</p></blockquote>
<p>
<tt>enable_if</tt>, <tt>result_of</tt> and <tt>common_type</tt> do not necessarily "define a publicly accessible nested type named <tt>type</tt>". 
<tt>aligned_storage</tt> takes no template type argument (it only has two non-type parameters). Yet [meta.trans]/2 
says that they are all <tt>TransformationTraits</tt>.
<p/>
Incidentally, with the exception of <tt>decay</tt>, it's not clear that any of the traits in [meta.trans.other] 
could really be described as "modify[ing] a property of a type".
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2846" href="2846">2846.</a> Undefined phrase "effectively cast"</h3>
<p><b>Section:</b> 26.4.9 <a href="https://timsong-cpp.github.io/cppwp/cmplx.over">[cmplx.over]</a>, 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2016-12-15 <b>Last modified:</b> 2019-03-18 17:20:55 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#cmplx.over">issues</a> in [cmplx.over].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In [cmplx.over] and [cmath.syn], when talking about "sufficient additional overloads", we use the phrase
"effectively cast", but that is not a defined term.
<p/>
A hostile interpretation could read "<tt>reinterpret_cast</tt>" here.
<p/>
Likely we mean "apply floating-point promotions, floating-integral
conversions, and floating-point conversions", but that should be
spelled out somewhere, e.g. in the library definitions section.
<p/>
(Source: <a href="https://github.com/cplusplus/draft/issues/1248">Editorial issue #1248</a>)
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3</p>

<p><i>[2019-03-16; Daniel comments and provides wording]</i></p>

<p>
I decided to use the form "implicitly converted" and to refer to 7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a> for 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> and
26.4.9 <a href="https://timsong-cpp.github.io/cppwp/cmplx.over">[cmplx.over]</a>, because those conversions can all be done implicitly. This also holds for the 
<tt>pow</tt> specification 26.4.9 <a href="https://timsong-cpp.github.io/cppwp/cmplx.over">[cmplx.over]</a> p3, because the described conversions of
<tt>complex&lt;T&gt;</tt> to <tt>complex&lt;U&gt;</tt> involve only the need of non-explicit constructors.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Change 26.4.9 <a href="https://timsong-cpp.github.io/cppwp/cmplx.over">[cmplx.over]</a>, as indicated:</p>

<blockquote>
<p>
-2- The additional overloads shall be sufficient to ensure:
<blockquote>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; If the argument has type <tt>long double</tt>, then it is 
<del>effectively cast</del><ins>implicitly converted (7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>)</ins> to <tt>complex&lt;long double&gt;</tt>.</p></li>
<li><p>(2.2) &mdash; Otherwise, if the argument has type <tt>double</tt> or an integer type, then it is 
<del>effectively cast</del><ins>implicitly converted</ins> to <tt>complex&lt;double&gt;</tt>.</p></li>
<li><p>(2.3) &mdash; Otherwise, if the argument has type <tt>float</tt>, then it is 
<del>effectively cast</del><ins>implicitly converted</ins> to <tt>complex&lt;float&gt;</tt>.</p></li>
</ol>
</blockquote>
<p/>
-3 Function template <tt>pow</tt> shall have additional overloads sufficient to ensure, for a call with at least one argument
of type <tt>complex&lt;T&gt;</tt>:
<blockquote>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; If either argument has type <tt>complex&lt;long double&gt;</tt> or type <tt>long double</tt>, 
then both arguments are <del>effectively cast</del><ins>implicitly converted (7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>)</ins> to 
<tt>complex&lt;long double&gt;</tt>.</p></li>
<li><p>(3.2) &mdash; Otherwise, if either argument has type <tt>complex&lt;double&gt;</tt>, <tt>double</tt>, 
or an integer type, then both arguments are <del>effectively cast</del><ins>implicitly converted</ins> 
to <tt>complex&lt;double&gt;</tt>.</p></li>
<li><p>(3.3) &mdash; Otherwise, if either argument has type <tt>complex&lt;float&gt;</tt> or <tt>float</tt>, 
then both arguments are <del>effectively cast</del><ins>implicitly converted</ins> to 
<tt>complex&lt;float&gt;</tt>.</p></li>
</ol>
</blockquote>
</p>
</blockquote>

</li>

<li><p>Change 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a>, as indicated:</p>

<blockquote>
<p>
-2- For each set of overloaded functions within <tt>&lt;cmath&gt;</tt>, with the exception of <tt>abs</tt>, there 
shall be additional overloads sufficient to ensure:
<blockquote>
<ol>
<li><p>If any argument of arithmetic type corresponding to a <tt>double</tt> parameter has type <tt>long double</tt>, then
all arguments of arithmetic type (6.8.1 <a href="https://timsong-cpp.github.io/cppwp/basic.fundamental">[basic.fundamental]</a>) corresponding to <tt>double</tt> parameters are 
<del>effectively cast</del><ins>implicitly converted (7.3 <a href="https://timsong-cpp.github.io/cppwp/conv">[conv]</a>)</ins> to <tt>long double</tt>.</p></li>
<li><p>Otherwise, if any argument of arithmetic type corresponding to a <tt>double</tt> parameter has type <tt>double</tt>
or an integer type, then all arguments of arithmetic type corresponding to <tt>double</tt> parameters are
<del>effectively cast</del><ins>implicitly converted</ins> to <tt>double</tt>.</p></li>
<li><p>Otherwise, all arguments of arithmetic type corresponding to <tt>double</tt> parameters have type <tt>float</tt>.</p></li>
</ol>
</blockquote>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2847" href="2847">2847.</a> <tt>sin(float)</tt> should call <tt>sinf(float)</tt></h3>
<p><b>Section:</b> 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2016-12-15 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#cmath.syn">active issues</a> in [cmath.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#cmath.syn">issues</a> in [cmath.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
With <a href="http://wg21.link/p0175r1">P0175R1</a>, we now show in [cmath.syn] three overloads for
the <tt>sin</tt> function: One taking a <tt>float</tt>, one taking a <tt>double</tt>,
and one taking a <tt>long double</tt>. However, there is no statement that <tt>sin(long double)</tt> 
should actually invoke <tt>sinl</tt>, presumably delivering extra precision.
<p/>
An implementation like
</p>
<blockquote><pre>
inline long double sin(long double x)
{ return sinf(x); }
</pre></blockquote>
<p>
seems to satisfy the "effectively cast" requirement, but is certainly unintentional.
<p/>
The same issue arises for all math functions inherited from C.
<p/>
(Source: <a href="https://github.com/cplusplus/draft/issues/1247">Editorial issue #1247</a>)
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2848" href="2848">2848.</a> Pass-through threshold for pool allocator</h3>
<p><b>Section:</b> 20.12.5.2 <a href="https://timsong-cpp.github.io/cppwp/mem.res.pool.options">[mem.res.pool.options]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2016-12-15 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.12.5.2 <a href="https://timsong-cpp.github.io/cppwp/mem.res.pool.options">[mem.res.pool.options]</a> p3 talks about a "pass-through-threshold".
<p/>
First, the phrase is not defined and it seems it could be easily avoided given the context.
<p/>
Second, given the phrasing here, it seems the implementation is essentially allowed to 
ignore the value <tt>largest_required_pool_block</tt> as it sees fit. It is unclear whether 
that is the intention.
</p>

<p><i>[2017-01-27 Telecon]</i></p>

<p>Priority 3; Jonathan will ask Alisdair for wording.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2858" href="2858">2858.</a> LWG 2472: actually an incompatibility with C++03</h3>
<p><b>Section:</b> 23.5.1 <a href="https://timsong-cpp.github.io/cppwp/reverse.iterators">[reverse.iterators]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2017-01-28 <b>Last modified:</b> 2017-03-14 03:14:09 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#reverse.iterators">issues</a> in [reverse.iterators].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Further to LWG <a href="2472">2472</a>, the case of <tt>reverse_iterator</tt> comparisons is a regression introduced 
by LWG <a href="280">280</a>.
<p/>
Consider the following program:
</p>
<blockquote><pre>
#include &lt;utility&gt;
#include &lt;iterator&gt;

using namespace std::rel_ops;

bool f(std::reverse_iterator&lt;int *&gt; it) { return it != it; }
</pre></blockquote>
<p>
Under C++03, the <tt>operator!=</tt> in lib.reverse.iterator is more specialized than the <tt>operator!=</tt> in <tt>std::rel_ops</tt>.
<p/>
Following LWG <a href="280">280</a>, neither <tt>operator!=</tt> candidate is more specialized than the other. The program is 
observed to fail with libc++.
<p/>
Online compiler example, see <a href="http://melpon.org/wandbox/permlink/aeOn1wiOi2CRKwwc">here</a>.
<p/>
Suggested resolution:
<p/>
Reintroduce the homogeneous comparison operators from C++03 alongside the new ones.
</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Set priority to 4. STL to write a paper deprecating <tt>relops</tt> Alisdair to provide an example for Annex C.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4618">N4618</a>.</p>

<ol>
<li><p>Modify 23.5.1 <a href="https://timsong-cpp.github.io/cppwp/reverse.iterators">[reverse.iterators]</a>, class template <tt>reverse_iterator</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator==(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&lt;(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator!=(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&gt;(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&gt;=(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&lt;=(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
<ins>template &lt;class Iterator&gt;
  constexpr bool operator==(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);
template &lt;class Iterator&gt;
  constexpr bool operator&lt;(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);
template &lt;class Iterator&gt;
  constexpr bool operator!=(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);
template &lt;class Iterator&gt;
  constexpr bool operator&gt;(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);
template &lt;class Iterator&gt;
  constexpr bool operator&gt;=(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);
template &lt;class Iterator&gt;
  constexpr bool operator&lt;=(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);</ins>
</pre>
</blockquote>
</li>

<li><p>Modify 99 [reverse.iter.op==] as indicated:</p>
<blockquote>
<pre>
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator==(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
<ins>template &lt;class Iterator&gt;
  constexpr bool operator==(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);</ins>
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>x.current == y.current</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify  [reverse.iter.op&lt;] as indicated:</p>
<blockquote>
<pre>
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&lt;(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
<ins>template &lt;class Iterator&gt;
  constexpr bool operator&lt;(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);</ins>
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>x.current &gt; y.current</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify  [reverse.iter.op!=] as indicated:</p>
<blockquote>
<pre>
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator!=(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
<ins>template &lt;class Iterator&gt;
  constexpr bool operator!=(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);</ins>
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>x.current != y.current</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify  [reverse.iter.op&gt;] as indicated:</p>
<blockquote>
<pre>
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&gt;(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
<ins>template &lt;class Iterator&gt;
  constexpr bool operator&gt;(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);</ins>
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>x.current &lt; y.current</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify  [reverse.iter.op&gt;=] as indicated:</p>
<blockquote>
<pre>
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&gt;=(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
<ins>template &lt;class Iterator&gt;
  constexpr bool operator&gt;=(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);</ins>
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>x.current &lt;= y.current</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify  [reverse.iter.op&lt;=] as indicated:</p>
<blockquote>
<pre>
template &lt;class Iterator1, class Iterator2&gt;
  constexpr bool operator&lt;=(
    const reverse_iterator&lt;Iterator1&gt;&amp; x,
    const reverse_iterator&lt;Iterator2&gt;&amp; y);
<ins>template &lt;class Iterator&gt;
  constexpr bool operator&lt;=(
    const reverse_iterator&lt;Iterator&gt;&amp; x,
    const reverse_iterator&lt;Iterator&gt;&amp; y);</ins>
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>x.current &gt;= y.current</tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="2859" href="2859">2859.</a> Definition of <em>reachable</em> in [ptr.launder] misses pointer arithmetic from pointer-interconvertible object</h3>
<p><b>Section:</b> 17.6.4 <a href="https://timsong-cpp.github.io/cppwp/ptr.launder">[ptr.launder]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2017-01-31 <b>Last modified:</b> 2020-02-14 09:37:04 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#ptr.launder">issues</a> in [ptr.launder].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Given:
</p>
<blockquote><pre>
struct A { int x, y; };
A a[100];
</pre></blockquote>
<p>
The bytes which compose <tt>a[3]</tt> can be reached from <tt>&amp;a[2].x</tt>:
<tt>reinterpret_cast&lt;A *&gt;(&amp;a[2].x) + 1</tt> points to <tt>a[3]</tt>,
however, the definition of "reachable" in [ptr.launder] does not encompass this case.
</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Set priority to 2. Assign this (and <a href="2860">2860</a>) to Core.</p>

<p><i>[2017-08-14, CWG telecon note]</i></p>

<p>
CWG is fine with the proposed resolution.  
</p>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>




<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4618">N4618</a>.</p>

<ol>
<li><p>Modify 17.6.4 <a href="https://timsong-cpp.github.io/cppwp/ptr.launder">[ptr.launder]</a> as indicated:</p>
<blockquote>
<pre>
template &lt;class T&gt; constexpr T* launder(T* p) noexcept;
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-3- <i>Remarks:</i> An invocation of this function may be used in a core constant expression whenever the value
of its argument may be used in a core constant expression. A byte of storage <ins><tt><i>b</i></tt></ins> is 
reachable through a pointer value that points to an object <tt><i>Y</i></tt> if <ins>there is an object 
<tt><i>Z</i></tt>, pointer-interconvertible with <tt><i>Y</i></tt>, such that <tt><i>b</i></tt></ins> <del>it</del> 
is within the storage occupied by <tt><i><ins>Z</ins><del>Y</del></i></tt>, <del>an object that is 
pointer-interconvertible with <tt><i>Y</i></tt>,</del> or the immediately-enclosing array object if 
<tt><i><ins>Z</ins><del>Y</del></i></tt> is an array element. The program is ill-formed if <tt>T</tt> is a function type or 
(possibly <i>cv</i>-qualified) <tt>void</tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="2881" href="2881">2881.</a> Adopt section III of P0308R0</h3>
<p><b>Section:</b> 20.7.3 <a href="https://timsong-cpp.github.io/cppwp/variant.variant">[variant.variant]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Switzerland <b>Opened:</b> 2017-02-03 <b>Last modified:</b> 2017-07-15 23:15:19 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.variant">issues</a> in [variant.variant].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses CH 7</b>

<p>Consider making the variant statically <tt>!valueless_by_exception()</tt> for cases where <tt>is_nothrow_move_constructible_v&lt;T_i&gt;</tt> for all alternative types <tt>T<sub><i>i</i></sub></tt></p>
<p>Proposed change: Adopt section III of <a href="http://wg21.link/p0308r0">P0308R0</a>.</p>

<p><i>[2017-07 Toronto Thurs Issue Prioritization]</i></p>

<p>Priority 3. This is similar to <a href="2904">2904</a>, Casey to investigate</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="2883" href="2883">2883.</a> The standard library should provide <tt>string_view</tt> parameters instead or in addition for functions 
      defined with <tt>char const *</tt> or <tt>string const &amp;</tt> as parameter types.</h3>
<p><b>Section:</b> 21.4 <a href="https://timsong-cpp.github.io/cppwp/string.view">[string.view]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Switzerland <b>Opened:</b> 2017-02-03 <b>Last modified:</b> 2017-07-15 23:15:19 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#string.view">issues</a> in [string.view].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses CH 9</b>

<p>
The standard library should provide <tt>string_view</tt> parameters instead or in addition for functions defined with 
<tt>char const *</tt> or <tt>string const &amp;</tt> as parameter types. Most notably in cases where both such 
overloads exist or where an internal copy is expected anyway.
</p>
<p>
It might be doubted that the non-null termination of <tt>string_view</tt> could be an issue with functions that pass 
the <tt>char *</tt> down to OS functions, such as <tt>fstream_buf::open()</tt> etc. and those shouldn't provide it 
and favour generating a <tt>std::string</tt> temporary instead in that case. However, <tt>std::path</tt> demonstrates 
it is usable to have <tt>string_view</tt> overloads and there might be many places where it can be handy, or even better.
</p>

<p>Proposed change: Provide the overloads for <tt>std::regex</tt>, the exception classes, <tt>std::bitset</tt>, 
<tt>std::locale</tt> and more.</p>

<p><i>[Post-Kona 2017]</i></p>

<p>Most (all?) of these changes were proposed in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0506r0.pdf">P0506r1</a>, which was discussed by LEWG in Kona.</p>

<p><i>[2017-07 Toronto Thurs Issue Prioritization]</i></p>

<p>Status LEWG - they're already looking at this.</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="2884" href="2884">2884.</a> Relational operators for containers should sfinae; if the underlying type is not comparable, neither should the container be</h3>
<p><b>Section:</b> 22 <a href="https://timsong-cpp.github.io/cppwp/containers">[containers]</a>, 20 <a href="https://timsong-cpp.github.io/cppwp/utilities">[utilities]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Finland <b>Opened:</b> 2017-02-03 <b>Last modified:</b> 2017-06-27 21:09:58 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#containers">active issues</a> in [containers].</p>
<p><b>View all other</b> <a href="lwg-index.html#containers">issues</a> in [containers].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses FI 16</b>

<p>Relational operators for containers should sfinae; if the underlying type is not comparable, neither should the container be. Same applies to <tt>tuple</tt> and <tt>pair</tt>.</p>

<p>Proposed change: Make the relational operators of containers and utility components reflect the validity of the underlying 
element types.</p>

<p><i>[
2017-06-27 Moved to LEWG after 5 positive votes on c++std-lib.
]</i></p>



<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="2885" href="2885">2885.</a> The relational operators of <tt>optional</tt> and <tt>variant</tt> completely reflect the semantics of the element 
types &mdash; this is inconsistent with other types in the library</h3>
<p><b>Section:</b> 22 <a href="https://timsong-cpp.github.io/cppwp/containers">[containers]</a>, 20 <a href="https://timsong-cpp.github.io/cppwp/utilities">[utilities]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Finland <b>Opened:</b> 2017-02-03 <b>Last modified:</b> 2017-07-15 23:15:19 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#containers">active issues</a> in [containers].</p>
<p><b>View all other</b> <a href="lwg-index.html#containers">issues</a> in [containers].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses FI 17</b>

<p>The relational operators of optional and variant completely reflect the semantics of the element types; this is inconsistent 
with other types in the library, like <tt>pair</tt>, <tt>tuple</tt> and containers. If we believe it's important that we don't 
synthesize relational operators for wrapper types, we should believe it's important for other types as well. Otherwise comparing 
containers of floating-point types and tuples/pairs etc. of floating point types will give incorrect answers.</p>
<p>Proposed change: Make the relational operators of containers and utility components reflect the semantics of the operators for the underlying element types.</p>

<p><i>[2017-07 Toronto Thurs Issue Prioritization]</i></p>

<p>Move to LEWG</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="2906" href="2906">2906.</a> There is no ability to supply an allocator for the control block when constructing a <tt>shared_ptr</tt> from a 
<tt>unique_ptr</tt></h3>
<p><b>Section:</b> 20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2017-02-03 <b>Last modified:</b> 2017-07-15 23:15:19 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#util.smartptr.shared.const">active issues</a> in [util.smartptr.shared.const].</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared.const">issues</a> in [util.smartptr.shared.const].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses US 130</b>

<p>There is no ability to supply an allocator for the control block when constructing a <tt>shared_ptr</tt> from a <tt>unique_ptr</tt>. 
Note that no further <tt>shared_ptr</tt> constructors need an allocator, as they all have pre-existing control blocks that are shared, 
or already have the allocator overload.</p>
<p>Proposed change: Add an additional <tt>shared_ptr</tt> constructor, 
<tt>template &lt;class Y, class D, class A&gt; shared_ptr(unique_ptr&lt;Y, D&gt;&amp;&amp; r, A alloc)</tt>, with the same semantics 
as the existing constructor taking a <tt>unique_ptr</tt>, but using the <tt>alloc</tt> argument to supply memory as required.</p>

<p><i>[2017-07 Toronto Thurs Issue Prioritization]</i></p>

<p>Priority 3; Alisdair to provide wording</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>






<hr>
<h3><a name="2922" href="2922">2922.</a> The <tt>*_constant&lt;&gt;</tt> templates do not make use of <tt>template&lt;auto&gt;</tt></h3>
<p><b>Section:</b> 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2017-02-03 <b>Last modified:</b> 2017-07-15 23:15:19 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.type.synop">active issues</a> in [meta.type.synop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.type.synop">issues</a> in [meta.type.synop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses US 171</b>

<p>The <tt>*_constant&lt;&gt;</tt> templates (including the proposed addition, <tt>bool_constant&lt;&gt;</tt>) do 
not make use of the new <tt>template&lt;auto&gt;</tt> feature.</p>

<p>Proposed change: Add a <tt>constant&lt;&gt;</tt> (subject to bikeshedding) template which uses <tt>template&lt;auto&gt;</tt>. </p>
<p>Define <tt>integral_constant&lt;&gt;</tt> as <tt>using integral_constant&lt;T, V&gt; = constant&lt;T(V)&gt;</tt> or <tt>integral_constant&lt;T, V&gt; = constant&lt;V&gt;</tt>.</p>
<p>Either remove <tt>bool_constant</tt>, define it as using <tt>bool_constant = constant&lt;bool(B)&gt;</tt> or 
<tt>using bool_constant = constant&lt;B&gt;</tt>.</p>

<p><i>[2017-03-03, Kona, LEWG]</i></p>

<p>
Straw polls:
</p>
<table border="1">
<caption>Name:</caption>
<tr style="text-align: left">
<td style="width:70%"><tt>constant</tt></td><td style="width:10%">3</td></tr>
<tr style="text-align: left">
<td><tt>numeric_constant</tt></td><td>8</td></tr>
<tr style="text-align: left">
<td><tt>static_constant</tt></td><td>1</td></tr>
<tr style="text-align: left">
<td><tt>scalar_constant</tt></td><td>7</td></tr>
<tr style="text-align: left">
<td><tt>integer_constant</tt> (Over LWG's dead body)</td><td>1</td></tr>
<tr style="text-align: left">
<td><tt>auto_constant</tt></td><td>4</td></tr>
<tr style="text-align: left">
<td><tt>integral_c</tt></td><td>7</td></tr>
<tr style="text-align: left">
<td><tt>int_</tt></td><td>0</td></tr>
<tr style="text-align: left">
<td colspan="2"><tt>&#x200b;</tt></td></tr>
<tr style="text-align: left">
<td><tt>scalar_constant</tt></td><td>6</td></tr>
<tr style="text-align: left">
<td><tt>numeric_constant</tt></td><td>3</td></tr>
<tr style="text-align: left">
<td><tt>integral_c</tt></td><td>5</td></tr>
</table>

<p>
Accept P0377 with "<tt>scalar_constant</tt>" for C++17 to address LWG 2922 and US 171:
<p/>
SF | F | N | A | SA
<p/>
0  | 1 | 3 | 7 | 5
</p>

<p><i>[2017-07 Toronto Thurs Issue Prioritization]</i></p>

<p>Status LEWG with P0377</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>








<hr>
<h3><a name="2923" href="2923">2923.</a> <tt>noexcept</tt> is inconsistently applied across headers which import components of the C standard library</h3>
<p><b>Section:</b> 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2017-02-03 <b>Last modified:</b> 2017-07-15 23:15:19 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#cmath.syn">active issues</a> in [cmath.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#cmath.syn">issues</a> in [cmath.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses US 172</b>

<p><tt>noexcept</tt> is inconsistently applied across headers which import components of the C standard library into the C++ library; 
some functions (<tt>std::abort()</tt>, <tt>std::_Exit()</tt>, etc) are defined as <tt>noexcept</tt> in some places, but not in others. 
Some functions which seem like they should be <tt>noexcept</tt> (<tt>std::abs()</tt>, <tt>std::div()</tt>, etc) are not defined as 
<tt>noexcept</tt>.</p>

<p>Proposed change: Make the majority of the C library functions (with exceptions such as <tt>std::qsort()</tt> and 
<tt>std::bsearch()</tt>, which can call user code) <tt>noexcept</tt>.</p>

<p><i>[2017-07 Toronto Thurs Issue Prioritization]</i></p>

<p>Priority 4</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>







<hr>
<h3><a name="2931" href="2931">2931.</a> Missed optimization opportunity with single-argument <tt>std::next</tt></h3>
<p><b>Section:</b> 23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Morwenn <b>Opened:</b> 2017-02-04 <b>Last modified:</b> 2018-12-03 11:11:36 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.operations">active issues</a> in [iterator.operations].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.operations">issues</a> in [iterator.operations].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It seems that <tt>std::next</tt> is missing an optimization opportunity when taking a single parameter. The standard 
mandates that <tt>std::next</tt> shall call <tt>std::advance</tt> on the passed iterator and return it. For random-access 
iterators, it means that <tt>operator+=</tt> will be called on the iterator. However, if a single-argument overload was 
added to <tt>std::next</tt>, it could call <tt>++it</tt> directly instead of <tt>std::advance(it, 1)</tt>, which means 
that <tt>operator++</tt> would be called instead of <tt>operator+=</tt>. This might make a small performance difference 
for complicated iterators such as <tt>std::deque</tt>'s ones, where <tt>operator++</tt> has a simpler logic than 
<tt>operator+=</tt>.
<p/>
An equivalent optimization could be allowed by adding a single-argument overload to <tt>std::prev</tt> too.
</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Set priority to 3. Alisdair to provide wording.</p>

<p><i>[2018-11-30, Jonathan comments, recommending NAD]</i></p>

<p>
Jonathan suggested NAD, because the proposed "just use increment when <tt>n==1</tt>" optimization can be done in 
<tt>std::next</tt> (and/or <tt>std::advance</tt>, and/or complicated iterators like <tt>deque::iterator</tt>) without 
adding an overload. Billy said the overload would avoid metaprogramming costs for dispatching to the right 
<tt>std::advance</tt>, and help in non-optimized builds. Zhihao said the overload would make it clear to users that 
the <tt>n==1</tt> case is optimized (Jonathan thinks this is irrelevant as there's no requirement that we tell users 
what we optimize).
</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>






<hr>
<h3><a name="2933" href="2933">2933.</a> PR for LWG 2773 could be clearer</h3>
<p><b>Section:</b> 20.5.4 <a href="https://timsong-cpp.github.io/cppwp/tuple.creation">[tuple.creation]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Eric Fiselier <b>Opened:</b> 2017-02-06 <b>Last modified:</b> 2017-06-02 05:40:10 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#tuple.creation">issues</a> in [tuple.creation].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current PR for LWG <a href="2773">2773</a> changes <tt>std::ignore</tt> to be a <tt>constexpr</tt> variable. However it says 
nothing about whether using <tt>std::ignore</tt> in <tt>std::tie</tt> is a constant expression. I think the intent was clearly 
to allow this. Therefore I suggest we update the resolution to explicitly call this out in a note. (I don't think new normative 
wording is needed).
<p/>
I propose we update the current PR as follows:
</p>
<ol>
<li><p>Keep the current changes proposed by the PR.</p></li>
<li><p>Add a note after [tuple.creation]/p7 (<tt>std::tie</tt>):</p>
<blockquote><p>
<ins>[<i>Note:</i> The constructors and assignment operators provided by <tt>ignore</tt> shall be <tt>constexpr</tt>]</ins>
</p></blockquote>
</li>
</ol>
<p>
Perhaps LWG feels the existing wording is clear enough, but if not I think the above changes sufficiently clarify it.
<p/>
The ability to <tt>constexpr</tt> assign to <tt>std::ignore</tt> can be important: Here is an extremely contrived example:
</p>
<blockquote><pre>
constexpr bool foo() {
  auto res = std::tie(std::ignore);
  std::get&lt;0&gt;(res) =42; 
  return true;
}
static_assert(foo());
</pre></blockquote>
<p><i>[2017-03-04, Kona]</i></p>

<p>Set priority to 3. P/R is incorrect; it should NOT be a note. Marshall to work with Eric to get better wording. STL says "use an exposition-only class".</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4640">N4640</a>.</p>

<ol>
<li><p>Modify 20.5.4 <a href="https://timsong-cpp.github.io/cppwp/tuple.creation">[tuple.creation]</a> as indicated:</p>
<blockquote><pre>
template&lt;class... TTypes&gt;
  constexpr tuple&lt;TTypes&amp;...> tie(TTypes&amp;... t) noexcept;
</pre>
<blockquote>
<p>
-7- <i>Returns:</i> [&hellip;]
<p/>
<ins>-?- [<i>Note:</i> The constructors and assignment operators provided by <tt>ignore</tt> shall be <tt>constexpr</tt>. &mdash; <i>end note</i>]</ins>
<p/>
-8- [<i>Example:</i> [&hellip;] &mdash; <i>end example</i>]
</p>
</blockquote>
</blockquote>
</li>

</ol>






<hr>
<h3><a name="2939" href="2939">2939.</a> Some type-completeness constraints of traits are overspecified</h3>
<p><b>Section:</b> 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2017-03-02 <b>Last modified:</b> 2020-02-13 15:35:37 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.type.synop">active issues</a> in [meta.type.synop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.type.synop">issues</a> in [meta.type.synop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="2797">2797</a> (RU 2) suggests that certain type-traits should be required to
diagnose violations of their pre-conditions. The basic idea is founded and I see no problems for
requiring this for the mentioned traits <tt>alignment_of</tt> or <tt>is_base_of</tt>,
for example. But if we want to require this diagnostics for some other traits, such as <tt>is_convertible</tt>,
<tt>is_constructible</tt> (and friends), or <tt>is_callable</tt> (and possibly some others), we really should
be sure that our current requirements are OK. 
<p/>
Unfortunately, there exists some cases, where we currently overspecify imposing complete type requirements where they
are not actually required. For example, for the following situation the answer of the trait could 
be given without ever needing the complete type of <tt>X</tt>:
</p>
<blockquote><pre>
struct X; // Never defined

static_assert(std::is_convertible_v&lt;X, const X&amp;&gt;);
</pre></blockquote>
<p>
Unfortunately we cannot <em>always</em> allow incomplete types, because most type constructions or conversions indeed
require a complete type, so <em>generally</em> relaxing the current restrictions is also not an option.
<p/>
The core language has a solution for this "small" gap of situations, where the response of the compiler <em>might</em>
depend on type completeness: Undefined behaviour. So, I believe we need a somewhat more detailled form to express the
intend here. Informally, I would suggest that the program should only be ill-formed in the situation described by 
LWG <a href="2797">2797</a>, if there exists the <em>possibility</em> that the compiler would require complete types for the
considered operation. The example shown above, <tt>std::is_convertible_v&lt;X, const X&amp;&gt;</tt>, would <b>never</b>
require the need to complete <tt>X</tt>, so here no violation should exist.
<p/>
The presented example might seem a tiny one, but the Standard Library type traits are extreme fundamental tools and we should
try to not give the impression that an approximate rule of the current type constraints breaks reasonable code.
<p/>
It is correct, that above example has currently undefined behaviour due to the breakage of pre-conditions, therefore
this issue suggests to fix the current situation <em>before</em> enforcing a diagnostic for such valid situations.
</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Set priority to 2. Is related to <a href="2797">2797</a>, but really needs an audit of the type traits.</p>

<p><i>[2018-08 Batavia Monday issue discussion]</i></p>

<p>Issues <a href="2797">2797</a>, <a href="2939">2939</a>, <a href="3022">3022</a>, and <a href="3099">3099</a> are all closely related. Walter to write a paper resolving them.</p>

<p><i>[2020-02 Prague Thursday issue discussion]</i></p>

<p>
Two of the issues (<a href="2797">2797</a> and <a href="3022">3022</a>) had been resolved by the
acceptance of <a href="https://wg21.link/p1285r0">P1285R0</a>.
</p>


<p><b>Proposed resolution:</b></p>






<hr>
<h3><a name="2947" href="2947">2947.</a> Clarify several filesystem terms</h3>
<p><b>Section:</b> 29.11.9.1 <a href="https://timsong-cpp.github.io/cppwp/fs.enum.path.format">[fs.enum.path.format]</a>, 99 [fs.class.directory_iterator], 29.11.14.3 <a href="https://timsong-cpp.github.io/cppwp/fs.op.copy">[fs.op.copy]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Thomas K&ouml;ppe <b>Opened:</b> 2017-03-14 <b>Last modified:</b> 2018-01-20 14:47:15 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
During the application of <a href="http://wg21.link/p0430r2">P0430R2</a>, we came across several terms that seem insufficiently 
clear and lacking proper definitions.
<p/>
We would like clarification on what those terms mean, and we would welcome wording suggestions, or alternatively a verbose explanation and dispensation to change the presentation editorially.
<p/>
The items in question are:
</p>
<ul>
<li><p>What does it mean to 'always interpret [the character sequence] in the same way'? ([fs.enum.path.format], which is 
[path.format] in the paper)</p></li>
<li><p>What is a "directory-like" file type? ([fs.class.directory_iterator])</p></li>
<li><p>What is an "implementation-defined file type"? (e.g. [fs.op.copy])</p></li>
</ul>

<p><i>[2017-07 Toronto Wed Issue Prioritization]</i></p>

<p>Priority 3</p>

<p><i>[2018-01-16, Jonathan comments]</i></p>

<p>
In 29.11.9.1 <a href="https://timsong-cpp.github.io/cppwp/fs.enum.path.format">[fs.enum.path.format]</a> "always interpreted in the same way" means
irrespective of the <tt>path::format</tt> value, or the content of the string.
Maybe add ", rather than depending on the <tt>path::format</tt> value or the
content of the character sequence".
<p/>
In 99 [fs.class.directory_iterator] an "implementation-defined
directory-like file type" is an implementation-defined file type (see
99 [fs.enum.file_type] and Table 115) that is treated like a directory by
the special rules that the OS has for non-regular files (see 29.11.7.1 <a href="https://timsong-cpp.github.io/cppwp/fs.path.generic">[fs.path.generic]</a>).
<p/>
In 29.11.14.3 <a href="https://timsong-cpp.github.io/cppwp/fs.op.copy">[fs.op.copy]</a>, an "implementation-defined file type" is exactly
that, see 99 [fs.enum.file_type] and Table 115 again. I don't see what
isn't clear about that. Maybe add a cross-reference to 99 [fs.enum.file_type].
</p>


<p><b>Proposed resolution:</b></p>






<hr>
<h3><a name="2949" href="2949">2949.</a> Unclear complexity requirements: space vs. time</h3>
<p><b>Section:</b> 16 <a href="https://timsong-cpp.github.io/cppwp/library">[library]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2017-03-20 <b>Last modified:</b> 2017-07-15 22:58:07 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#library">active issues</a> in [library].</p>
<p><b>View all other</b> <a href="lwg-index.html#library">issues</a> in [library].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This is from editorial issue <a href="https://github.com/cplusplus/draft/issues/1088">#1088</a>:
<p/>
It is not always made explicit whether the requirement is referring to time or space complexity, or both.
</p>
<blockquote>
<p>
"Linear time." vs. "Linear."<br/>
"Constant time." vs. "Constant."
</p>
</blockquote>
<p>
16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> says that the <i>Complexity</i> element specifies "the time and/or space
complexity of the function", so being explicit about this would be good.
<p/>
Examples:
</p>
<ul>
<li><p>[sequence.reqmts] <tt>a.clear()</tt></p></li>
<li><p>[deque.cons]</p></li>
<li><p>[vector.cons]</p></li>
<li><p>[map.cons]</p></li>
<li><p>[multimap.cons]</p></li>
<li><p>[set.cons]</p></li>
<li><p>[multiset.cons]</p></li>
<li><p>[unord.map.cnstr]</p></li>
<li><p>[unord.multimap.cnstr]</p></li>
</ul>
<p>
etc.
</p>

<p><i>[2017-07 Toronto Wed Issue Prioritization]</i></p>

<p>Priority 4; Robert to look at</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2959" href="2959">2959.</a> <tt>char_traits&lt;char16_t&gt;::eof</tt> is a valid UTF-16 code unit</h3>
<p><b>Section:</b> 21.2.3.3 <a href="https://timsong-cpp.github.io/cppwp/char.traits.specializations.char16.t">[char.traits.specializations.char16.t]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2017-05-05 <b>Last modified:</b> 2019-04-02 17:52:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The standard requires that <tt>char_traits&lt;char16_t&gt;::int_type</tt> is
<tt>uint_least16_t</tt>, so when that has the same representation as <tt>char16_t</tt>
there are no bits left to represent the <tt>eof</tt> value.
<p/>
21.2.3.3 <a href="https://timsong-cpp.github.io/cppwp/char.traits.specializations.char16.t">[char.traits.specializations.char16.t]</a> says:
</p>
<blockquote>
<p>
&mdash; The member <tt>eof()</tt> shall return an implementation-defined constant
that cannot appear as a valid UTF-16 code unit.
</p>
</blockquote>
<p>
Existing practice is to use the "noncharacter" <tt>u'\uffff'</tt> for this
value, but the Unicode spec is clear that <tt>U+FFFF</tt> and other
noncharacters are valid, and their appearance in a UTF-16 string does
not make it ill-formed. See <a href="http://www.unicode.org/faq/private_use.html#nonchar7">here</a> and
<a href="http://www.unicode.org/faq/private_use.html#nonchar8">here</a>:
</p>
<blockquote>
<p>
<i>The fact that they are called "noncharacters" and are not intended for open interchange does not mean 
that they are somehow illegal or invalid code points which make strings containing them invalid.</i>
</p>
</blockquote>
<p>
In practice this means there's no way to tell if
<tt>basic_streambuf&lt;char16_t&gt;::sputc(u'\uffff')</tt> succeeded or not. If it
can insert the character it returns <tt>to_int_type(u'\uffff')</tt> and
otherwise it returns <tt>eof()</tt>, which is the same value.
<p/>
I believe that <tt>char_traits&lt;char16_t&gt;::to_int_type(char_type c)</tt> can be
defined to transform <tt>U+FFFF</tt> into <tt>U+FFFD</tt>, so that the invariant
<tt>eq_int_type(eof(), to_int_type(c)) == false</tt> holds for any <tt>c</tt> (and the
return value of <tt>sputc</tt> will be distinct from <tt>eof</tt>). I don't think any
implementation currently meets that invariant.
<p/>
I think at the very least we need to correct the statement "The member
<tt>eof()</tt> shall return an implementation-defined constant that cannot
appear as a valid UTF-16 code unit", because there are no such
constants if <tt>sizeof(uint_least16_t) == sizeof(char16_t)</tt>.
<p/>
This issue is closely related to LWG <a href="1200">1200</a>, but there it's a
slightly different statement of the problem, and neither the
submitter's recommendation nor the proposed resolution solves this
issue here. It seems that was closed as NAD before the Unicode corrigendum
existed, so at the time our standard just gave "surprising results"
but wasn't strictly wrong. Now it makes a normative statement that
conflicts with Unicode.
</p>

<p><i>[2017-07 Toronto Wed Issue Prioritization]</i></p>

<p>Priority 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2962" href="2962">2962.</a> Iterators of Containers of move-only types do not model <tt>InputIterator</tt></h3>
<p><b>Section:</b> 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Ga&scaron;per A&zcaron;man <b>Opened:</b> 2017-05-10 <b>Last modified:</b> 2018-11-12 05:21:03 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#input.iterators">active issues</a> in [input.iterators].</p>
<p><b>View all other</b> <a href="lwg-index.html#input.iterators">issues</a> in [input.iterators].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In Table 95 in 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>, it is specified that the expression <tt>*a</tt> returns <tt>reference</tt>, 
which must be convertible to <tt>value_type</tt>. This is not true for move-only types, which incidentally means that
<tt>std::vector&lt;std::unique_ptr&lt;int&gt;&gt;</tt> does not possess even a lowly <tt>InputIterator</tt>, which is, of 
course, absurd.
<p/>
With the advent of concepts as first-class citizens in the language, getting this right as soon as possible is a priority.
<p/>
This issue seems to be similar to both LWG <a href="448">448</a> and LWG <a href="484">484</a>, but not the same.
<p/>
The proposed resolution stems from two considerations outlined below:
</p>
<blockquote>
<p>
<b>Convertibility is too strong for all algorithms</b>
<p/>
No algorithm in the standard library requires convertibility to <tt>value_type</tt>. If algorithms require things that smell 
of that, they specify the assignment or constructibility flavor they need directly. I checked this by going through the 
specification of each and every one of them in <tt>&lt;algorithm&gt;</tt> and <tt>&lt;numeric&gt;</tt>, which highlighted 
several issues unrelated to this one. These issues are presented in <em>Algorithms with underspecified iterator requirements</em>
(LWG <a href="2963">2963</a>).
<p/>
<b><tt>reference</tt> needs to be related to <tt>value_type</tt></b>
<p/>
Algorithms need this for the following reasons:
</p>
<ul>
<li><p>lifetime-extension: served as adequately by <tt>T const&amp;</tt> as by <tt>T</tt>. Also works for iterators that 
return by value. <tt>T&amp;&amp;</tt> also correctly binds to <tt>T const&amp;</tt>.</p></li>
<li><p>passing to predicates: again, served adequately by <tt>T const&amp;</tt></p></li>
<li><p>writing to <tt>*result</tt>: not provided by the requirement anyway.</p></li>
<li><p>capture-by-copy: currently implicitly guaranteed, but unused in the standard library (always specified separately). 
A separate specification can always be made for algorithms that need to capture-by-copy.</p></li>
</ul>
<p>
We must give due consideration to code that so far required its inputs to be <tt>CopyConstructible</tt> implicitly by 
requiring convertibility to <tt>T</tt>. This is done in the issue LWG <a href="2963">2963</a>, 
which presents the results of a comb-through of <tt>&lt;algorithm&gt;</tt> and <tt>&lt;numeric&gt;</tt> to find algorithms 
that have this requirement, but where it is not specified. While related issues have been identified, no algorithms seems 
to require more than <tt>T const&amp;</tt> convertibility without separately requiring convertibility to <tt>T</tt>.
<p/>
Since such code is already compiling today, relaxing this requirement does not break code.
<p/>
The only code this could possibly break is if, in a concept checking library, the <tt>InputIterator</tt> concept requirement 
on <tt>reference</tt> being convertible to <tt>value_type</tt> gets relaxed. Such a library, if it offered overloading based 
on most-specific modeled concept, could now, once fixed, resolve the call to a different algorithm, which could break user 
code that uses a hypothetical algorithm with a move-only container and was relying to select some other overload for move-only 
types based on the implicit <tt>CopyConstructible</tt> assertion provided by the iterator.
<p/>
In our internal concepts-checking library, we have had this issue "fixed" since the very beginning &mdash; move-only types 
were too important for our internal algorithms library, and also no algorithm in it seems to require something like 
<tt>Iterator::value_type x = *first</tt> without also requiring copy-constructibility anyway.
</p>
</blockquote>

<p><i>[2017-07 Toronto Monday issue prioritization]</i></p>

<p>Priority 2; also could affect the ranges TS</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li>
<p>Change Table 95 &mdash; "Input iterator requirements", 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 107 &mdash; Input iterator requirements (in addition to Iterator)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational<br/>semantics</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>*a</tt>
</td>
<td>
<tt>reference</tt>,<br/>
<del>convertible to <tt>T</tt></del><br/>
<ins>that binds to <tt>const T&amp;</tt></ins>
</td>
<td>
<tt></tt>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>*r++</tt>
</td>
<td>
<del>convertible to <tt>T</tt></del><br/>
<ins>that binds to <tt>const T&amp;</tt></ins>
</td>
<td>
<tt>
{ <del>T</del><ins>auto&amp;&amp;</ins> tmp = *r;<br/>
++r;<br/>
return tmp; }
</tt>
</td>
<td>
</td>
</tr>

</table>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-04-20; Eric Niebler provides improved wording]</i></p>

<p>
The revised wording makes it clear that you can only rely on those operational semantics when 
the value type is constructible from the reference type and is movable. When those conditions 
aren't met, we can make no guarantees about the operational semantics of <tt>*r++</tt> (which 
is why <tt>*r++</tt> is no longer a required expression of the <tt>InputIterator</tt> concept 
in the Ranges TS).
<p/>
Really, <em>no</em> generic code should be doing <tt>*r++</tt> on input iterators. Another 
option would be to simply deprecate this requirement for input iterators, but that might need 
a paper. (For forward iterators, <tt>*r++</tt> is already required to return <tt>reference</tt> 
exactly, and the multi-pass guarantee gives it the proper semantics.)
<p/>
I also now have a question about the proposed return type of <tt>*a</tt> and <tt>*r++</tt>, 
which says they must be something that "binds to <tt>const T&amp;</tt>". Does this mean that an 
iterator with a reference type reference-to-[<tt>const</tt>?]-<tt>volatile</tt>-<tt>T</tt> is no longer 
considered an iterator? I don't think that's what we want to say. Perhaps these should read 
"binds to <tt>const volatile T&amp;</tt> instead, except that has the problem for InputIterators 
that return prvalues that a prvalue is not bindable to a volatile reference.
</p>

<p><i>[2018-11 San Diego Thursday night issue processing]</i></p>

<p>Look at Ranges; EricWF to investigate. Status to Open</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4741">N4741</a>.</p>

<ol>
<li>
<p>Change Table 89 &mdash; "Input iterator requirements", 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 89 &mdash; Input iterator requirements (in addition to Iterator)</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Operational<br/>semantics</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>*a</tt>
</td>
<td>
<tt>reference</tt>,<br/>
<del>convertible to <tt>T</tt></del><br/>
<ins>that binds to <tt>const T&amp;</tt></ins>
</td>
<td>
<tt></tt>
</td>
<td>
[&hellip;]
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>*r++</tt>
</td>
<td>
<del>convertible to <tt>T</tt></del><br/>
<ins>that binds to <tt>const T&amp;</tt></ins>
</td>
<td>
<ins>When <tt>T tmp = *r</tt> is well-formed and<br/> 
<tt>T</tt> is <tt>MoveConstructible</tt>, then<br/></ins>
<tt>
{ T tmp = *r;<br/>
++r;<br/>
return tmp; }
</tt>
</td>
<td>
</td>
</tr>

</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2963" href="2963">2963.</a> Algorithms with underspecified iterator requirements</h3>
<p><b>Section:</b> 25 <a href="https://timsong-cpp.github.io/cppwp/algorithms">[algorithms]</a>, 26 <a href="https://timsong-cpp.github.io/cppwp/numerics">[numerics]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Ga&scaron;per A&zcaron;man <b>Opened:</b> 2017-05-10 <b>Last modified:</b> 2017-07-12 01:30:31 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#algorithms">active issues</a> in [algorithms].</p>
<p><b>View all other</b> <a href="lwg-index.html#algorithms">issues</a> in [algorithms].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
While researching whether the proposed resolution of Iterators of Containers of move-only types do not model <tt>InputIterator</tt>
(LWG <a href="2962">2962</a>), I came across several algorithms that underspecify their requirements, mostly with regard to some associated type of the iterator type they operate on. A list can be found below.
<p/>
The list of algorithms with underspecified requirements from <tt>&lt;algorithm&gt;</tt> and <tt>&lt;numeric&gt;</tt> follows.
<p/>
With the advent of concepts, these algorithms will need better specifications if we are ever hoping to be allowed to overload based on them. I want this issue to bring the standard algorithms closer to having their concept requirements directly transcribable to library annotations.
<p/>
Suggested resolution:
</p>
<ol>
<li>
<p><tt>copy</tt>, <tt>copy_if</tt>, <tt>copy_n</tt>, <tt>copy_backward</tt></p>
<p>Add to description: <ins><tt>*result</tt> shall be assignable from <tt>*first</tt>.</ins></p>
</li>
<li>
<p><tt>move</tt>, <tt>move_backward</tt></p>
<p>Add to description: <ins><tt>*result</tt> shall be move-assignable from <tt>*first</tt>.</ins></p>
</li>
<li>
<p><tt>transform</tt></p>
<p>Add to description: <ins>The result of the expression <tt>op(*first)</tt> or <tt>binary_op(*first1, *first2)</tt> 
shall be writable to <tt>result</tt>.</ins></p>
</li>
<li>
<p><tt>rotate_copy</tt></p>
<p>Add to description: <ins><tt>*first</tt> shall be writable to <tt>result</tt>.</ins></p>
</li>
<li>
<p><tt>merge</tt></p>
<p>Add to description: <ins><tt>*first1</tt> and <tt>*first2</tt> shall be writable to <tt>result</tt>.</ins>.</p>
</li>
<li>
<p><tt>set_union</tt>, <tt>set_intersection</tt>, <tt>set_difference</tt>, <tt>set_symmetric_difference</tt></p>
<p>Add to description: <ins><tt>*first1</tt> and <tt>*first2</tt> shall be writable to <tt>result</tt>.</ins></p>
</li>
<li>
<p><tt>partial_sum</tt></p>
<p>
<tt>acc</tt> is not defined.
<p/>
Change description: <tt>acc</tt>, a variable of <tt>InputIterator</tt>'s value type, shall be constructible
</p>
</li>
<li>
<p><tt>adjacent_difference</tt></p>
<p>
<tt>acc</tt> is not defined.
<p/>
Change description: <tt>acc</tt>, a variable of <tt>InputIterator</tt>'s value type, shall be <tt>MoveAssignable</tt> and shall be 
<tt>constructible</tt> from the type of <tt>*first</tt>.
</p>
</li>
<li>
<p><tt>iota</tt></p>
<p>
<tt>iota</tt> is mis-specified. Since the expression we need to support is <tt>*first = value</tt>: <tt>*first</tt> 
is required to be of type <tt>InputIterator::reference</tt>, and value is an lvalue of type <tt>T</tt>. The current 
specification allows calling <tt>iota</tt> with a <tt>const</tt> output iterator!
<p/>
<del><tt>T</tt> shall be convertible to <tt>ForwardIterator</tt>'s value type</del><ins><tt>value</tt> shall be writable to 
<tt>first</tt>. The expression <tt>*first = value</tt> shall not modify <tt>value</tt></ins>.
</p>
</li>
</ol>

<p><i>[2017-07 Toronto Monday issue prioritization]</i></p>

<p>Priority 3; Marshall to work with Gaspar to improve wording.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2973" href="2973">2973.</a> <tt>inplace_merge</tt> exact comparison count complexity prohibits useful real-world optimizations</h3>
<p><b>Section:</b> 25.7.5 <a href="https://timsong-cpp.github.io/cppwp/alg.merge">[alg.merge]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Billy Robert O'Neal III <b>Opened:</b> 2017-06-08 <b>Last modified:</b> 2017-07-12 01:30:31 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.merge">issues</a> in [alg.merge].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
At the moment, <tt>inplace_merge</tt> requires exactly <tt><i>N</i> - 1</tt> comparisons, if enough additional memory is 
available (and in practice enough additional memory is always available). However, this prohibits implementing the 
merge operation using forms of binary search, as in Timsort's 
<a href="https://hg.python.org/cpython/file/tip/Objects/listsort.txt#l451">'Galloping Mode'</a>, a useful optimization 
for non-uniform input data. It's not really useful to prohibit standard libraries from trying a few extra speculative 
compares like this, given that users must be prepared for the fallback "not enough memory" 
&#x1d4aa;(<tt><i>N</i> lg <i>N</i></tt>) algorithm.
</p>

<p><i>[2017-07 Toronto Monday issue prioritization]</i></p>

<p>Status to LEWG</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li>
<p>Edit 25.7.5 <a href="https://timsong-cpp.github.io/cppwp/alg.merge">[alg.merge]</a> as indicated:</p>

<blockquote>
<pre>template&lt;class BidirectionalIterator&gt;
void inplace_merge(BidirectionalIterator first,
    BidirectionalIterator middle,
    BidirectionalIterator last);
template&lt;class ExecutionPolicy, class BidirectionalIterator&gt;
void inplace_merge(ExecutionPolicy&amp;&amp; exec,
    BidirectionalIterator first,
    BidirectionalIterator middle,
    BidirectionalIterator last);
template&lt;class BidirectionalIterator, class Compare&gt;
void inplace_merge(BidirectionalIterator first,
    BidirectionalIterator middle,
    BidirectionalIterator last, Compare comp);
template&lt;class ExecutionPolicy, class BidirectionalIterator, class Compare&gt;
void inplace_merge(ExecutionPolicy&amp;&amp; exec,
    BidirectionalIterator first,
    BidirectionalIterator middle,
    BidirectionalIterator last, Compare comp);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-8- <i>Complexity:</i> Let <tt><i>N</i> = last - first</tt>:
</p>
<ol style="list-style-type: none">
<li><p>(8.1) &mdash; For the overloads with no <tt>ExecutionPolicy</tt>, if enough additional memory is available, 
<del>exactly</del> <tt><i>N</i> - 1</tt> comparisons <ins>on average, &#x1d4aa;(<tt><i>N</i></tt>) comparisons in 
the worst case</ins>.</p></li>
<li><p>(8.2) &mdash; For the overloads with no <tt>ExecutionPolicy</tt> if no additional memory is available, 
&#x1d4aa;(<tt><i>N</i> log <i>N</i></tt>) comparisons.</p></li>
<li><p>(8.3) &mdash; For the overloads with an <tt>ExecutionPolicy</tt>, &#x1d4aa;(<tt><i>N</i> log <i>N</i></tt>)
comparisons.</p></li>
</ol>
<p>
-9- <i>Remarks:</i> Stable (16.5.5.8 <a href="https://timsong-cpp.github.io/cppwp/algorithm.stable">[algorithm.stable]</a>).
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2983" href="2983">2983.</a> <tt>money_put::do_put</tt> underspecified</h3>
<p><b>Section:</b> 28.4.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/locale.money.put.virtuals">[locale.money.put.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2017-06-21 <b>Last modified:</b> 2017-06-27 18:12:29 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#locale.money.put.virtuals">issues</a> in [locale.money.put.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Whether you get "<tt>.99</tt>" or "<tt>0.99</tt>" for the following depends on the implementation:
</p>
<blockquote><pre>
std::cout.imbue(std::locale("en_US"));
std::cout &lt;&lt; std::put_money(99.L);
</pre></blockquote>
<p>
I don't see any justification in [locale.money.put.virtuals] for the leading <tt>0</tt>, although that seems more useful.
<p/>
If we want the leading zero, we should say so.
</p>

<p><i>[2017-06-27, Jonathan comments and provides wording]</i></p>

<p>
I suggest that we require a leading zero. The wording below is similar
to how C specifies the <tt>%f</tt> format specifier for <tt>fprintf</tt>.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 28.4.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/locale.money.put.virtuals">[locale.money.put.virtuals]</a> as indicated:</p>

<blockquote>
<pre>
iter_type do_put(iter_type s, bool intl, ios_base&amp; str,
                 char_type fill, long double units) const;
iter_type do_put(iter_type s, bool intl, ios_base&amp; str,
                 char_type fill, const string_type&amp; digits) const;
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-2- <i>Remarks:</i> The currency symbol is generated if and only if <tt>(str.flags() &amp; str.showbase)</tt> is nonzero.
<ins>If the format specifies a decimal point, at least one digit character appears before it.</ins>
If the number of characters generated for the specified format is less than the value returned by
<tt>str.width()</tt> on entry to the function, then copies of <tt>fill</tt> are inserted as necessary to pad to the 
specified width. For the value <tt>af</tt> equal to <tt>(str.flags() &amp; str.adjustfield)</tt>, if 
<tt>(af == str.internal)</tt> is <tt>true</tt>, the fill characters are placed where <tt>none</tt> or <tt>space</tt> 
appears in the formatting pattern; otherwise if <tt>(af == str.left)</tt> is <tt>true</tt>, they are placed after the 
other characters; otherwise, they are placed before the other characters.
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="2984" href="2984">2984.</a> <tt>put_money(99)</tt> is unnecessarily undefined</h3>
<p><b>Section:</b> 29.7.7 <a href="https://timsong-cpp.github.io/cppwp/ext.manip">[ext.manip]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2017-06-22 <b>Last modified:</b> 2017-06-26 18:19:51 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#ext.manip">issues</a> in [ext.manip].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[ext.manip] p5 says:
</p>
<blockquote><p>
<i>Requires:</i> The type <tt>moneyT</tt> shall be either <tt>long double</tt> or a specialization of the 
<tt>basic_string</tt> template (Clause 24).
</p></blockquote>
<p>
This means that <tt>put_money(99)</tt>, <tt>put_money(99.)</tt>, <tt>put_money("99")</tt>, and 
<tt>put_money(string_view{"99"})</tt> are all undefined, when in practice they will compile fine and 
do the right thing, converting the argument to <tt>long double</tt> or <tt>std::string</tt> as needed.
<p/>
We could change it to be "otherwise the program is ill-formed", or to remove the function templates from overload 
resolution when the argument is not <tt>long double</tt> or a <tt>std::basic_string</tt>, but that will unnecessarily 
break code that works fine today. We should accept types convertible to <tt>long double</tt> or the relevant 
<tt>money_put</tt> facet's <tt>string_type</tt> (which is not known until we attempt to write the unspecified 
type to an ostream).
<p/>
The requirement is also insufficient, because <tt>cout &lt;&lt; put_money(wstring(L"99"))</tt> won't compile on any 
implementation, despite the argument type being a specialization of <tt>basic_string</tt>. This same problem exists 
for <tt>std::get_money</tt>.
</p>

<p><i>[2017-06-24, Daniel comments and provides wording]</i></p>

<p>
The wording changes below are supposed to support all <tt>moneyT</tt> types that are convertible to either 
<tt>long double</tt> or to <tt>money_put/get&lt;Ch, o/istreambuf_iterator&lt;Ch, Tr&gt;&gt;::string_type</tt> 
(but not to both), where <tt>Ch</tt> and <tt>Tr</tt> are determined by the concrete instantiated specialization of the 
exposition-only function template <tt>f</tt> that is used to specify the semantics of <tt>put_money</tt> and 
<tt>get_money</tt>, respectively. XOR-ing the requirements outlaws types that are convertible to both, which 
would cause an ambiguity unless we would provide wording that would introduce an ordered application of these 
convertibility constraints. This is the rationale for the seemingly odd new <i>Remarks</i> formulation. Note also,
that the wording provided below intentionally attempts to distinguish between the statically testable
conditions based on the <tt>is_convertible_v</tt> expressions within the <i>Remarks:</i> element and the well-defined 
runtime behaviour requirement of the actually provided argument of deduced type <tt>moneyT</tt> within the 
pre-existing <i>Requires:</i> element. Another point worth pointing out is that the wording attempts to fix an
currently existing ambiguity of the meaning of the type <tt>moneyT</tt> (and to a lesser extend for <tt>charT</tt> and
<tt>traits</tt>) as either the template parameter of <tt>put/get_money</tt> or that of the corresponding template
argument of the exposition-only <tt>f</tt> templates. The revised form makes it clearer that it refers to the latter.
<p/>
It should be emphasized that this extension of the current wording would provide support for <tt>put_money(99)</tt>, 
<tt>put_money(99.)</tt>, and <tt>put_money("99")</tt>, but <em>not</em> yet for <tt>put_money(string_view{"99"})</tt>, 
because <tt>string_view</tt> is not convertible to <tt>string</tt>. To realize support for the latter, this wording 
approach could be extended by referring to <tt>is_constructible</tt> instead of <tt>is_convertible</tt>, though.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 29.7.7 <a href="https://timsong-cpp.github.io/cppwp/ext.manip">[ext.manip]</a> as indicated:</p>

<blockquote>
<pre>
template &lt;class moneyT&gt; <i>unspecified</i> get_money(moneyT&amp; mon, bool intl = false);
</pre>
<blockquote>
<p>
<ins>-?- For an expression <tt>in &gt;&gt; get_money(mon, intl)</tt> described below, let <tt><i>Mo</i></tt>, 
<tt><i>Ch</i></tt>, and <tt><i>Tr</i></tt> be the deduced template argument types of the template parameters 
<tt>moneyT</tt>, <tt>charT</tt>, and <tt>traits</tt>, respectively, of the instantiated specialization of the 
template <tt>f</tt>.</ins>
<p/>
-2- <i>Requires:</i> <del>The type <tt>moneyT</tt> shall be either <tt>long double</tt> or a specialization of the 
<tt>basic_string</tt> template (Clause 21 <a href="https://timsong-cpp.github.io/cppwp/strings">[strings]</a>)</del><ins><tt><i>Mo</i></tt>
shall be either convertible to <tt>long double</tt> or shall be convertible to 
<tt>money_get&lt;<i>Ch</i>, istreambuf_iterator&lt;<i>Ch</i>, <i>Tr</i>&gt;&gt;::string_type</tt></ins>.
<p/>
<ins>-?- <i>Remarks:</i> If <tt>is_convertible_v&lt;<i>Mo</i>, long double&gt; == is_convertible_v&lt;<i>Mo</i>, 
money_get&lt;<i>Ch</i>, istreambuf_iterator&lt;<i>Ch</i>, <i>Tr</i>&gt;&gt;::string_type&gt;</tt>,
the program is ill-formed.</ins>
<p/>
-3- <i>Effects:</i> The expression <tt>in &gt;&gt; get_money(mon, intl)</tt> described below behaves as 
a formatted input function (29.7.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/istream.formatted.reqmts">[istream.formatted.reqmts]</a>).
<p/>
-4- <i>Returns:</i> An object of unspecified type such that if <tt>in</tt> is an object of type 
<tt>basic_istream&lt;<del>charT</del><ins><i>Ch</i></ins>, <del>traits</del><ins><i>Tr</i></ins>&gt;</tt> then 
the expression <tt>in &gt;&gt; get_money(mon, intl)</tt> behaves as if it called <tt>f(in, mon, intl)</tt>, where 
the function <tt>f</tt> is defined as:
</p>
<blockquote><pre>
template &lt;class charT, class traits, class moneyT&gt;
void f(basic_ios&lt;charT, traits>&amp; str, moneyT&amp; mon, bool intl) {
  using Iter = istreambuf_iterator&lt;charT, traits&gt;;
  using MoneyGet = money_get&lt;charT, Iter&gt;;
  ios_base::iostate err = ios_base::goodbit;
  const MoneyGet&amp; mg = use_facet&lt;MoneyGet>(str.getloc());
  mg.get(Iter(str.rdbuf()), Iter(), intl, str, err, mon);
  if (ios_base::goodbit != err)
    str.setstate(err);
}
</pre></blockquote>
<p>
The expression <tt>in &gt;&gt; get_money(mon, intl)</tt> shall have type 
<tt>basic_istream&lt;<del>charT</del><ins><i>Ch</i></ins>, <del>traits</del><ins><i>Tr</i></ins>&gt;&amp;</tt> 
and value <tt>in</tt>.
</p>
</blockquote>
<pre>
template &lt;class moneyT&gt; <i>unspecified</i> put_money(const moneyT&amp; mon, bool intl = false);
</pre>
<blockquote>
<p>
<ins>-?- For an expression <tt>out &lt;&lt; put_money(mon, intl)</tt> described below, let <tt><i>Mo</i></tt>, 
<tt><i>Ch</i></tt>, and <tt><i>Tr</i></tt> be the deduced template argument types of the template parameters 
<tt>moneyT</tt>, <tt>charT</tt>, and <tt>traits</tt>, respectively, of the instantiated specialization of the 
template <tt>f</tt>.</ins>
<p/>
-5- <i>Requires:</i> <del>The type <tt>moneyT</tt> shall be either <tt>long double</tt> or a specialization of the 
<tt>basic_string</tt> template (Clause 21 <a href="https://timsong-cpp.github.io/cppwp/strings">[strings]</a>)</del><ins><tt><i>Mo</i></tt>
shall be either convertible to <tt>long double</tt> or shall be convertible to 
<tt>money_put&lt;<i>Ch</i>, ostreambuf_iterator&lt;<i>Ch</i>, <i>Tr</i>&gt;&gt;::string_type</tt></ins>.
<p/>
<ins>-?- <i>Remarks:</i> If <tt>is_convertible_v&lt;<i>Mo</i>, long double&gt; == is_convertible_v&lt;<i>Mo</i>, 
money_put&lt;<i>Ch</i>, ostreambuf_iterator&lt;<i>Ch</i>, <i>Tr</i>&gt;&gt;::string_type&gt;</tt>,
the program is ill-formed.</ins>
<p/>
-6- <i>Returns:</i> An object of unspecified type such that if <tt>out</tt> is an object of type 
<tt>basic_ostream&lt;<del>charT</del><ins><i>Ch</i></ins>, <del>traits</del><ins><i>Tr</i></ins>&gt;</tt> then 
the expression <tt>out &lt;&lt; put_money(mon, intl)</tt> behaves as a formatted output function
(29.7.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/ostream.formatted.reqmts">[ostream.formatted.reqmts]</a>) that calls <tt>f(out, mon, intl)</tt>, where the function <tt>f</tt> 
is defined as:
</p>
<blockquote><pre>
template &lt;class charT, class traits, class moneyT&gt;
void f(basic_ios&lt;charT, traits&gt;&amp; str, const moneyT&amp; mon, bool intl) {
  using Iter = ostreambuf_iterator&lt;charT, traits&gt;;
  using MoneyPut = money_put&lt;charT, Iter&gt;;
  const MoneyPut&amp; mp = use_facet&lt;MoneyPut>(str.getloc());
  const Iter end = mp.put(Iter(str.rdbuf()), intl, str, str.fill(), mon);
  if (end.failed())
    str.setstate(ios::badbit);
}
</pre></blockquote>
<p>
The expression <tt>out &lt;&lt; put_money(mon, intl)</tt> shall have type 
<tt>basic_ostream&lt;<del>charT</del><ins><i>Ch</i></ins>, <del>traits</del><ins><i>Tr</i></ins>&gt;&amp;</tt>
and value <tt>out</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="2985" href="2985">2985.</a> <tt>std::reverse</tt> should be permitted to be vectorized</h3>
<p><b>Section:</b> 25.6.10 <a href="https://timsong-cpp.github.io/cppwp/alg.reverse">[alg.reverse]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2017-06-24 <b>Last modified:</b> 2018-04-03 18:48:52 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.reverse">issues</a> in [alg.reverse].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The fine folks on our backend team suggested that we special case <tt>std::reverse</tt> of 1/2/4/8 to take 
advantage of vector units. Unfortunately, at present <tt>std::reverse</tt> says it does <tt>N/2 iter_swap</tt>s, 
which doesn't permit our vector implementation even if the iterator inputs are pointers to trivially copyable <tt>T</tt>s.
<p/>
The vectorized version for pointers to <tt>short</tt>s is 
<a href="https://twitter.com/MalwareMinigun/status/878150939512717312">~8x faster on Skylake</a> than the serial version, 
and about 7x faster for <tt>unsigned long long</tt>s; and users don't actually care whether or not we call <tt>swap</tt> here.
</p>

<p><i>[2017-07 Toronto Monday issue prioritization]</i></p>

<p>Status to LEWG; this is similar to <a href="2973">2973</a></p>

<p><i>[2018-04-02, Billy comments]</i></p>

<p>
This issue should be resolved by <a href="https://wg21.link/p0551">P0551</a>, because it prohibits user specialization of  
<tt>std::swap</tt> and <tt>std::iter_swap</tt>, which means the proposed vectorization optimization for 
pointers-to-trivially-copyable is now implementable without changes to <tt>reverse</tt>'s specification (We can detect 
if the user has provided an alternate <tt>swap</tt> in their own namespace, but not if they explicitly specialized 
<tt>swap</tt> or <tt>iter_swap</tt>).
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 25.6.10 <a href="https://timsong-cpp.github.io/cppwp/alg.reverse">[alg.reverse]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class BidirectionalIterator&gt;
  void reverse(BidirectionalIterator first, BidirectionalIterator last);
template&lt;class ExecutionPolicy, class BidirectionalIterator>
  void reverse(ExecutionPolicy&amp;&amp; exec,
               BidirectionalIterator first, BidirectionalIterator last);
</pre>
<blockquote>
<p>
-1- <i>Requires:</i> <tt>*first</tt> shall be swappable (16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>).
<p/>
-2- <i>Effects:</i> For each non-negative integer <tt>i &lt; (last - first) / 2</tt>, applies <tt>iter_swap</tt> 
to all pairs of iterators <tt>first + i, (last - i) - 1</tt>. <ins>If 
<tt>is_trivially_copyable_v&lt;typename iterator_traits&lt;BidirectionalIterator&gt;::value_type&gt;</tt> is 
<tt>true</tt>, an implementation may permute the elements by making temporary copies, rather than by calling 
<tt>iter_swap</tt>. [<i>Note:</i> this allows the implementation to be vectorized. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="2986" href="2986">2986.</a> Handling of multi-character collating elements by the <tt>regex</tt> FSM is underspecified</h3>
<p><b>Section:</b> 30.13 <a href="https://timsong-cpp.github.io/cppwp/re.grammar">[re.grammar]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2017-06-25 <b>Last modified:</b> 2017-07-12 01:35:02 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.grammar">active issues</a> in [re.grammar].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.grammar">issues</a> in [re.grammar].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In <a href="https://wg21.link/n4660">N4660</a> subclause 31.13 [re.grammar] paragraph 5:
</p>
<blockquote><p>
The productions <tt>ClassAtomExClass</tt>, <tt>ClassAtomCollatingElement</tt> and <tt>ClassAtomEquivalence</tt> provide
functionality equivalent to that of the same features in regular expressions in POSIX.
</p></blockquote>
<p>
The broadness of the above statement makes it sound like it is merely a statement of intent; however, this appears to 
be a necessary normative statement insofar as identifying the general semantics to be associated with the syntactic 
forms identified. In any case, if it is meant for <tt>ClassAtomCollatingElement</tt> to provide functionality equivalent 
to a collating symbol in a POSIX bracket expression, multi-character collating elements need to be considered.
<p/>
In [re.grammar] paragraph 14:
</p>
<blockquote><p>
The behavior of the internal finite state machine representation when used to match a sequence of characters is 
as described in ECMA-262. The behavior is modified according to any <tt>match_flag_type</tt> flags specified when 
using the regular expression object in one of the regular expression algorithms. The behavior is also localized 
by interaction with the traits class template parameter as follows: [bullets 14.1 to 14.4]
</p></blockquote>
<p>
In none of the bullets does the wording handle multi-character collating elements in a clear manner:
</p>
<ul>
<li><p>14.1 deals in characters.</p></li>
<li><p>14.2 deals in characters (<tt>traits_inst.translate</tt> accepts only a single character).</p></li>
<li><p>14.3 might handle a multi-character collating element; however, there is no specification of how 
such a collating element is to be identified from the sequence of characters. Additionally, the definition 
of primary equivalence class specifies that it is a set of characters (not of collating elements).</p></li>
<li><p>14.4 deals in characters.</p></li>
</ul>
<p>
The ECMA-262 specification for <em>ClassRanges</em> also deals in characters.
</p>

<p><i>[2017-07 Toronto Monday issue prioritization]</i></p>

<p>Priority 4</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="2987" href="2987">2987.</a> Relationship between <tt>traits_inst.lookup_collatename</tt> and the <tt>regex</tt> FSM is underspecified with 
regards to <tt>ClassAtomCollatingElement</tt></h3>
<p><b>Section:</b> 30.13 <a href="https://timsong-cpp.github.io/cppwp/re.grammar">[re.grammar]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2017-06-25 <b>Last modified:</b> 2017-07-12 01:35:02 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.grammar">active issues</a> in [re.grammar].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.grammar">issues</a> in [re.grammar].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
For a user to implement a regular expression traits class meaningfully, the relationship between the return value of <tt>traits_inst.lookup_collatename</tt> to the behaviour of the finite state machine corresponding to a regular expression 
needs to be better specified.
<p/>
From <a href="https://wg21.link/n4660">N4660</a> subclause 31.13 [re.grammar], <tt>traits_inst.lookup_collatename</tt> 
only feeds clearly into two operations:
</p>
<ol>
<li><p>a test if the returned string is empty ([re.grammar]/8), and</p></li>
<li><p>a test if the result of <tt>traits_inst.transform_primary</tt>, with the returned string, 
is empty ([re.grammar]/10).</p></li>
</ol>
<p>
Note: It is unclear if bullet 14.3 in [re.grammar]/14 refers to the result of <tt>traits_inst.lookup_collatename</tt> when 
it refers to a "collating element"; and if it does, it is unclear what input is to be used.
<p/>
It is therefore unclear what the effect is if <tt>traits_inst.lookup_collatename</tt> substitutes another member of the 
equivalence class as its output.
<p/>
For example, when processing <tt>"[[.AA.]]"</tt> as a pattern under a locale <tt>da_DK.utf8</tt>, what is the expected 
behaviour difference (if any) should <tt>traits_inst.lookup_collatename</tt> return, for <tt>"AA"</tt>, <tt>"\u00C5"</tt> 
(where <tt>U+00C5</tt> is A with ring, which sorts the same as <tt>"AA"</tt>)?
</p>

<p><i>[2017-07 Toronto Monday issue prioritization]</i></p>

<p>Priority 3</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="2990" href="2990">2990.</a> <tt>optional::value_type</tt> is not always a value type</h3>
<p><b>Section:</b> 20.6.3 <a href="https://timsong-cpp.github.io/cppwp/optional.optional">[optional.optional]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2017-06-27 <b>Last modified:</b> 2018-01-28 19:43:07 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#optional.optional">active issues</a> in [optional.optional].</p>
<p><b>View all other</b> <a href="lwg-index.html#optional.optional">issues</a> in [optional.optional].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>optional&lt;T&gt;::value_type</tt> is <tt>T</tt>, which can be a <i>cv</i>-qualified object type. This is 
inconsistent with the uses of the name <tt>value_type</tt> elsewhere in the standard. We should either require 
<tt>optional&lt;T&gt;::value_type</tt> to be <tt>remove_cv_t&lt;T&gt;</tt> &mdash; a true value type &mdash; 
or rename the type alias to <tt>element_type</tt>.
</p>

<p><i>[2017-07 Toronto Tuesday PM issue prioritization]</i></p>

<p>Priority 3; may also affect <tt>array</tt></p>

<p><i>[2018-1-26 issues processing telecon]</i></p>

<p>Status to 'Open'</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 20.6.3 <a href="https://timsong-cpp.github.io/cppwp/optional.optional">[optional.optional]</a>, class template <tt>optional</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template &lt;class T&gt;
  class optional {
  public:
    using value_type = <ins>remove_cv_t&lt;</ins>T<ins>&gt;</ins>;
    [&hellip;]
  };
</pre>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="2991" href="2991">2991.</a> <tt>variant</tt> copy constructor missing <tt>noexcept(<i>see below</i>)</tt></h3>
<p><b>Section:</b> 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Peter Dimov <b>Opened:</b> 2017-06-27 <b>Last modified:</b> 2017-07-12 01:58:24 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#variant.ctor">active issues</a> in [variant.ctor].</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.ctor">issues</a> in [variant.ctor].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The copy constructor of <tt>std::variant</tt> is not conditionally <tt>noexcept</tt> (I think
it was in the original proposal.)
<p/>
It should be, for two reasons: first, this would be consistent with the other three constructors
</p>
<blockquote><pre>
constexpr variant() noexcept(<i>see below</i>);

variant(variant&amp;&amp;) noexcept(<i>see below</i>);

template &lt;class T&gt;
constexpr variant(T&amp;&amp;) noexcept(<i>see below</i>);
</pre></blockquote>
<p>
and second, <tt>variant</tt> itself makes use of <tt>is_nothrow_copy_constructible</tt>, so
it's inconsistent for it to take a stance against it.
</p>

<p><i>[2017-07 Toronto Tuesday PM issue prioritization]</i></p>

<p>Status to LEWG</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 20.7.3 <a href="https://timsong-cpp.github.io/cppwp/variant.variant">[variant.variant]</a>, class template <tt>variant</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template &lt;class... Types&gt;
  class variant {
  public:
    // 23.7.3.1, constructors
    constexpr variant() noexcept(<i>see below</i>);
    variant(const variant&amp;) <ins>noexcept(<i>see below</i>)</ins>;
    variant(variant&amp;&amp;) noexcept(<i>see below</i>);
    [&hellip;]
  };
</pre>
</blockquote>
</li>

<li><p>Edit 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a> as indicated:</p>

<blockquote>
<pre>
variant(const variant&amp; w) <ins>noexcept(<i>see below</i>)</ins>;
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-8- <i>Remarks:</i> This function shall not participate in overload resolution unless 
<tt>is_copy_constructible_v&lt;T<sub><i>i</i></sub>&gt;</tt> is <tt>true</tt> for all <tt><i>i</i></tt>.
<ins>The expression inside <tt>noexcept</tt> is equivalent to the logical AND of
<tt>is_nothrow_copy_constructible_v&lt;T<sub><i>i</i></sub>&gt;</tt> for all <tt><i>i</i></tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="2994" href="2994">2994.</a> Needless UB for <tt>basic_string</tt> and <tt>basic_string_view</tt></h3>
<p><b>Section:</b> 21.2 <a href="https://timsong-cpp.github.io/cppwp/char.traits">[char.traits]</a>, 21.3.2.1 <a href="https://timsong-cpp.github.io/cppwp/string.require">[string.require]</a>, 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Gennaro Prota <b>Opened:</b> 2017-07-03 <b>Last modified:</b> 2018-11-25 18:34:32 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#char.traits">issues</a> in [char.traits].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>basic_string</tt> and <tt>basic_string_view</tt> involve undefined behavior in a few cases where it's 
simple for the implementation to add a <tt>static_assert</tt> and make the program ill-formed.
<p/>
With regards to basic_string, 21.2 <a href="https://timsong-cpp.github.io/cppwp/char.traits">[char.traits]</a>/3 states:
</p>
<blockquote><p>
<tt>Traits::char_type</tt> shall be the same as <tt>CharT</tt>.
</p></blockquote>
<p>
Here, the implementation can add a <tt>static_assert</tt> using the <tt>is_same</tt>
type trait. Similar issues exist in 21.3.2.1 <a href="https://timsong-cpp.github.io/cppwp/string.require">[string.require]</a> and, for
<tt>basic_string_view</tt>, in 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a>/1. 
</p>

<p><i>[2017-07 Toronto Tuesday PM issue prioritization]</i></p>

<p>Priority 3; need to check general container requirements</p>

<p>Partially by the adoption of <a href="https://wg21.link/P1148">P1148</a> in San Diego.</p>
<p>Tim opines: "the remainder deals with allocator value type mismatch, which I think is NAD."</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 21.2 <a href="https://timsong-cpp.github.io/cppwp/char.traits">[char.traits]</a> as indicated:</p>

<blockquote>
<p>
-3- To specialize those templates to generate a string or iostream class to handle a particular character container
type <tt>CharT</tt>, that and its related character traits class <tt>Traits</tt> are passed as a pair of parameters to 
the string or iostream template as parameters <tt>charT</tt> and <tt>traits</tt>. <ins>If</ins> <tt>Traits::char_type</tt> 
<del>shall be the same</del> <ins>is not the same type</ins> as <tt>CharT</tt><ins>, the program is ill-formed</ins>.
</p>
</blockquote>
</li>

<li><p>Edit 21.3.2.1 <a href="https://timsong-cpp.github.io/cppwp/string.require">[string.require]</a> as indicated:</p>

<blockquote>
<p>
-3- In every specialization <tt>basic_string&lt;charT, traits, Allocator&gt;</tt>, <ins>if</ins> <del>the type</del> 
<tt>allocator_traits&lt;Allocator&gt;::value_type</tt> <del>shall name the same type</del> <ins>is not the 
same type</ins> as <tt>charT</tt><ins>, the program is ill-formed</ins>. 
Every object of type <tt>basic_string&lt;charT, traits, Allocator&gt;</tt> shall use an object of type 
<tt>Allocator</tt> to allocate and free storage for the contained <tt>charT</tt> objects as needed. The 
<tt>Allocator</tt> object used shall be obtained as described in 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>. 
In every specialization <tt>basic_string&lt;charT, traits, Allocator&gt;</tt>, the type <tt>traits</tt> 
shall satisfy the character traits requirements (21.2 <a href="https://timsong-cpp.github.io/cppwp/char.traits">[char.traits]</a>)<ins>. If</ins><del>, and the type</del> 
<tt>traits::char_type</tt> <del>shall name the same type</del> <ins>is not the same type</ins> as <tt>charT</tt><ins>, 
the program is ill-formed</ins>.
</p>
</blockquote>
</li>

<li><p>Edit 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a> as indicated:</p>

<blockquote>
<p>
-1- In every specialization <tt>basic_string_view&lt;charT, traits&gt;</tt>, the type <tt>traits</tt> shall satisfy the character
traits requirements (21.2 <a href="https://timsong-cpp.github.io/cppwp/char.traits">[char.traits]</a>)<ins>. If</ins><del>, and the type</del> <tt>traits::char_type</tt> <del>shall 
name the same type</del> <ins>is not the same type</ins> as <tt>charT</tt><ins>, the program is ill-formed</ins>.
</p>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="2997" href="2997">2997.</a> LWG 491 and the specification of <tt>{forward_,}list::unique</tt></h3>
<p><b>Section:</b> 22.3.10.5 <a href="https://timsong-cpp.github.io/cppwp/list.ops">[list.ops]</a>, 22.3.9.6 <a href="https://timsong-cpp.github.io/cppwp/forwardlist.ops">[forwardlist.ops]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2017-07-07 <b>Last modified:</b> 2017-07-12 03:44:21 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#list.ops">issues</a> in [list.ops].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
There are various problems with the specification of <tt>list::unique</tt> and its <tt>forward_list</tt> counterpart, some of which are obvious even on cursory inspection:
<ul>
<li>It refers to the identifiers <tt>first</tt> and <tt>last</tt>, which aren't even defined.</li>
<li>It uses <tt>i - 1</tt> on non-random-access iterators - in the case of <tt>forward_list</tt>, on forward-only iterators.</li>
<li>The resolution of LWG <a href="202">202</a>, changing the specification of <tt>std::unique</tt> to require an equivalence relation 
    and adjusting the order of comparison, weren't applied to these member functions.</li>
</ul>
<p/>
LWG <a href="491">491</a>, which pointed out many of those problems with the specification of <tt>list::unique</tt>, was closed as NAD with the rationale that
<blockquote>
"All implementations known to the author of this Defect Report comply with these assumption", and "no impact on current code is expected", i.e. there is no evidence of real-world confusion or harm.
</blockquote>
That implementations somehow managed to do the right thing in spite of obviously defective standardese doesn't seem like a good reason to not fix the defects.
</p>

<p><i>[2017-07 Toronto Tuesday PM issue prioritization]</i></p>

<p>Priority 3; by the way, there's general wording in 25.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.requirements">[algorithms.requirements]</a> p10 that lets us specify iterator arithmetic as if we were using random access iterators.</p>
    
<p><i>[2017-07-11 Tim comments]</i></p>

<p>I drafted the P/R fully aware of the general wording in 25.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.requirements">[algorithms.requirements]</a> p10. However, that general wording is limited to Clause 28, so to make use of the shorthand permitted
by that wording, we would need additional wording importing it to these subclauses.
<p/>
Moreover, that general wording only defines <tt>a+n</tt> and <tt>b-a</tt>; it notably doesn't define <tt>a-n</tt>, which is needed here. And one cannot merely define <tt>a-n</tt> as
<tt>a+(-n)</tt> since that has undefined behavior for forward iterators.
</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 22.3.10.5 <a href="https://timsong-cpp.github.io/cppwp/list.ops">[list.ops]</a> as indicated:</p>
<blockquote>
<pre>
void unique();
template &lt;class BinaryPredicate&gt; void unique(BinaryPredicate binary_pred);
</pre>
<blockquote><p>
<ins>-?- <i>Requires:</i> The comparison function shall be an equivalence relation. </ins>
<p/>
-19- <i>Effects:</i> <ins>If <tt>empty()</tt>, has no effects. Otherwise, e</ins><del>E</del>rases all but the first element from every consecutive 
group of <del>equal</del><ins>equivalent</ins> elements referred to by the iterator <tt>i</tt> in the range <tt><del>[first + 1, last)</del><ins>[next(begin()), end())</ins></tt>
for which <tt><del>*i == *(i-1)</del><ins>*j == *i</ins></tt> (for the version of <tt>unique</tt> with no arguments) or
<tt><del>pred(*i, *(i - 1))</del><ins>pred(*j, *i)</ins></tt> (for the version of <tt>unique</tt> with a predicate argument) holds<ins>,
where <tt>j</tt> is an iterator in <tt>[begin(), end())</tt> such that <tt>next(j) == i</tt></ins>. Invalidates only the iterators and references to the erased elements.
<p/>
-20- <i>Throws:</i> Nothing unless an exception is thrown by <del><tt>*i == *(i-1)</tt> or <tt>pred(*i, *(i - 1))</tt></del><ins> the equality comparison or the predicate</ins>.
<p/>
-21- <i>Complexity:</i> If <del>the range <tt>[first, last)</tt> is not empty</del><ins><tt>!empty()</tt></ins>, exactly <tt><del>(last - first) - 1</del><ins>size() - 1</ins></tt>
applications of the corresponding predicate, otherwise no applications of the predicate.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 22.3.9.6 <a href="https://timsong-cpp.github.io/cppwp/forwardlist.ops">[forwardlist.ops]</a> as indicated:</p>
<blockquote>
<pre>
void unique();
template &lt;class BinaryPredicate&gt; void unique(BinaryPredicate binary_pred);
</pre>
<blockquote><p>
<ins>-?- <i>Requires:</i> The comparison function shall be an equivalence relation. </ins>
<p/>
-16- <i>Effects:</i> <ins>If <tt>empty()</tt>, has no effects. Otherwise, e</ins><del>E</del>rases all but the first element from every consecutive 
group of <del>equal</del><ins>equivalent</ins> elements referred to by the iterator <tt>i</tt> in the range <tt><del>[first + 1, last)</del><ins>[next(begin()), end())</ins></tt>
for which <tt><del>*i == *(i-1)</del><ins>*j == *i</ins></tt> (for the version with no arguments) or 
<tt><del>pred(*i, *(i - 1))</del><ins>pred(*j, *i)</ins></tt> (for the version with a predicate argument) holds<ins>,
where <tt>j</tt> is an iterator in <tt>[begin(), end())</tt> such that <tt>next(j) == i</tt></ins>. Invalidates only the iterators and references to the erased elements.
<p/>
-17- <i>Throws:</i> Nothing unless an exception is thrown by the equality comparison or the predicate.
<p/>
-18- <i>Complexity:</i> If <del>the range <tt>[first, last)</tt> is not empty</del><ins><tt>!empty()</tt></ins>, exactly 
<tt><del>(last - first) - 1</del><ins>distance(begin(), end()) - 1</ins></tt> applications of the corresponding predicate,
 otherwise no applications of the predicate.
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="2999" href="2999">2999.</a> &sect;[thread.decaycopy] issue</h3>
<p><b>Section:</b> 16.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/expos.only.func">[expos.only.func]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2017-07-11 <b>Last modified:</b> 2019-06-18 01:53:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[thread.decaycopy] says:
</p>
<blockquote><p>
In several places in this Clause the operation <tt><i>DECAY_COPY</i>(x)</tt> is used. All such uses mean call the function 
<tt>decay_copy(x)</tt> and use the result, where <tt>decay_copy</tt> is defined as follows:
</p></blockquote>
<p>
but <tt>decay_copy</tt> is not defined in any synopsis.
<p/>
The Ranges TS has a similar use of <tt><i>DECAY_COPY</i></tt>, except that theirs is also <tt>constexpr</tt> and <tt>noexcept</tt>.
<p/>
We should mark the function <tt>decay_copy</tt> as "exposition only" and <tt>constexpr</tt> and <tt>noexcept</tt>.
</p>

<p><i>[2017-07-16, Daniel comments]</i></p>

<p>
Currently there exists no proper way to mark <tt>decay_copy</tt> as conditionally <tt>noexcept</tt> as explained in
<a href="http://wg21.link/n3255#Adding">N3255 section "Adding to the Standard"</a>. This is also slighly related to 
the request to add an <tt>is_nothrow_convertible</tt> trait, as requested by LWG <a href="2040">2040</a>.
</p>

<p><i>[
2017-11-01 P3 as result of c++std-lib online vote.
]</i></p>


<p><i>[2019-03-22; Daniel comments]</i></p>

<p>
Starting with <a href="http://wg21.link/n4800">N4800</a> have now a <tt>constexpr</tt> and conditionally <tt>noexcept</tt> 
<tt><i>decay-copy</i></tt> in the working draft (16.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/expos.only.func">[expos.only.func]</a>). The pre-condition for that specification 
helper became possible by adoption of <a href="http://wg21.link/p0758r1">P0758R1</a>, which introduced the missing
<tt>is_nothrow_convertible</tt> trait.
</p>


<p><b>Rationale:</b></p>
Resolved by editorial creation of <tt><i>decay-copy</i></tt> after acceptance of <a href="http://wg21.link/p0758r1">P0758R1</a>.


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3003" href="3003">3003.</a> <tt>&lt;future&gt;</tt> still has type-erased allocators in <tt>promise</tt></h3>
<p><b>Section:</b> 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2017-07-16 <b>Last modified:</b> 2019-06-03 09:53:27 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#futures.promise">active issues</a> in [futures.promise].</p>
<p><b>View all other</b> <a href="lwg-index.html#futures.promise">issues</a> in [futures.promise].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In Toronto Saturday afternoon LWG discussed LWG <a href="2976">2976</a> which finishes the job of removing allocator 
support from <tt>packaged_task</tt>. LWG confirmed that, despite the removal of <tt>packaged_task</tt> allocators 
"because it looks like <tt>std::function</tt>" was incorrect, they wanted to keep the allocator removals anyway, 
in large part due to this resolution being a response to an NB comment.
<p/>
If we don't want the type erased allocator situation at all, then we should remove them from the remaining place 
they exist in <tt>&lt;future&gt;</tt>, namely, in <tt>promise</tt>.
<p/>
This change also resolves potential implementation divergence on whether <tt>allocator::construct</tt> is intended 
to be used on elements constructed in the shared state, and allows the emplace-construction-in-<tt>future</tt> paper, 
<a href="http://wg21.link/p0319">P0319</a>, to be implemented without potential problems there.
</p>

<p><i>[28-Nov-2017 Mailing list discussion - set priority to P2]</i></p>

<p>Lots of people on the ML feel strongly about this; the suggestion was made that a paper would be welcomed laying out the rationale for removing allocator support here (and in other places).</p>

<p><i>[2018-1-26 issues processing telecon]</i></p>

<p>Status to 'Open'; Billy to write a paper.</p>

<p><i>[2019-06-03]</i></p>

<p>Jonathan observes that this resolution conflicts with <a href="2095">2095</a>.</p>


<p><b>Proposed resolution:</b></p>
<p>This resolution is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li><p>Edit 32.9.6 <a href="https://timsong-cpp.github.io/cppwp/futures.promise">[futures.promise]</a>, class template <tt>promise</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template&lt;class R&gt; 
class promise {
public:
  promise();
  <del>template &lt;class Allocator&gt;
    promise(allocator_arg_t, const Allocator&amp; a);</del>
  [&hellip;]
};
template &lt;class R&gt;
  void swap(promise&lt;R&gt;&amp; x, promise&lt;R&gt;&amp; y) noexcept;
<del>template &lt;class R, class Alloc&gt;
  struct uses_allocator&lt;promise&lt;R&gt;, Alloc&gt;;</del>
</pre>
[&hellip;]
<pre>
<del>template &lt;class R, class Alloc&gt;
  struct uses_allocator&lt;promise&lt;R&gt;, Alloc&gt;
    : true_type { };</del>
</pre>
<blockquote>
<p>
<del>-3- <i>Requires:</i> <tt>Alloc</tt> shall be an Allocator (16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>).</del>
</p>
</blockquote>
<pre>
promise();
<del>template &lt;class Allocator&gt;
  promise(allocator_arg_t, const Allocator&amp; a);</del>
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> constructs a <tt>promise</tt> object and a shared state. <del>The second constructor uses the allocator a
to allocate memory for the shared state.</del>
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3006" href="3006">3006.</a> Constructing a <tt>basic_stringbuf</tt> from a <tt>string</tt> &mdash; where does the allocator come from?</h3>
<p><b>Section:</b> 29.8.2.1 <a href="https://timsong-cpp.github.io/cppwp/stringbuf.cons">[stringbuf.cons]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2017-08-02 <b>Last modified:</b> 2017-11-09 15:13:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#stringbuf.cons">issues</a> in [stringbuf.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Consider the following constructor from 29.8.2.1 <a href="https://timsong-cpp.github.io/cppwp/stringbuf.cons">[stringbuf.cons]</a> before p3:
</p>
<blockquote><pre>
explicit basic_stringbuf(
  const basic_string&lt;charT, traits, Allocator&gt;&amp; s,
  ios_base::openmode which = ios_base::in | ios_base::out);
</pre></blockquote>
<p>
In [stringbuf.cons]/3, it says:
</p>
<blockquote><p>
<i>Effects:</i> Constructs an object of class <tt>basic_stringbuf</tt>, initializing the base class with 
<tt>basic_streambuf()</tt> (30.6.3.1), and initializing <tt>mode</tt> with <tt>which</tt>. Then calls <tt>str(s)</tt>.
</p></blockquote>
<p>
But that doesn't mention where the allocator for the <tt>basic_stringbuf</tt> comes from.
Until recently, most implementations just default constructed the allocator.
But that requires that the allocator be default constructible.
<p/>
<a href="https://bugs.llvm.org/show_bug.cgi?id=33727">This bug</a> was filed against libc++ for this case.
<p/>
I think that the <tt>basic_stringbuf</tt> should be constructed with a copy of the allocator from the string.
</p>

<p><i>[2017-11-01, Marshall comments]</i></p>

<p>
There exist two related proposals, namely <a href="http://wg21.link/p0407r1">P0407R1</a> and 
<a href="http://wg21.link/p0408r2">P0408R2</a>.
</p>

<p><i>[2017-11 Albuquerque Wednesday night issues processing]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3011" href="3011">3011.</a> Requirements for <tt>assert(<em>E</em>)</tt> inconsistent with C</h3>
<p><b>Section:</b> 19.3 <a href="https://timsong-cpp.github.io/cppwp/assertions">[assertions]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2017-08-18 <b>Last modified:</b> 2018-08-20 16:38:12 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#assertions">active issues</a> in [assertions].</p>
<p><b>View all other</b> <a href="lwg-index.html#assertions">issues</a> in [assertions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The C standard says that the expression in an <tt>assert</tt> must have a scalar type, and implies (or at least allows) 
that the condition is tested by comparison to zero. C++ says that the expression is a constant subexpression if it can 
be contextually converted to <tt>bool</tt>. Those ways to test the condition are not equivalent.
<p/>
It's possible to have expressions that meet the C++ requirements for a constant subexpression, but fail to meet the C 
requirements, and so don't compile.
</p>
<blockquote><pre>
#include &lt;stdlib.h&gt;

// A toy implementation of assert:
#define assert(E) (void)(((E) != 0) || (abort(), 0))

struct X {
  constexpr explicit operator bool() const { return true; }
};

constexpr bool f(const X&amp; x) {
  assert(x);
  return true;
}
</pre></blockquote>
<p>
C++ says that <tt>assert(x)</tt> is a constant subexpression, but as it doesn't have scalar type it's not even a valid expression.
<p/>
I think either 19.3.1 <a href="https://timsong-cpp.github.io/cppwp/cassert.syn">[cassert.syn]</a> or 19.3.2 <a href="https://timsong-cpp.github.io/cppwp/assertions.assert">[assertions.assert]</a> should repeat the requirement from C that 
<em>E</em> has scalar type, either normatively or in a note. We should also consider whether "contextually converted to <tt>bool</tt>" 
is the right condition, or if we should use comparison to zero instead.
</p>

<p><i>[2017-11 Albuquerque Wednesday night issues processing]</i></p>

<p>Priority set to 2; status to Open</p>
<p>Jonathan is discussing this with WG14</p>

<p><i>[2018-08-20, Jonathan comments]</i></p>

<p>
This was reported to WG14 as <a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2207.htm">N2207</a>.
</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3018" href="3018">3018.</a> <tt>shared_ptr</tt> of function type</h3>
<p><b>Section:</b> 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2017-09-13 <b>Last modified:</b> 2020-02-13 21:50:15 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#util.smartptr.shared">active issues</a> in [util.smartptr.shared].</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared">issues</a> in [util.smartptr.shared].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>shared_ptr</tt> has been designed to support use cases where it owns a pointer to function, and whose deleter 
does something with it. This can be used, for example, to keep a dynamic library loaded for as long as their exported 
functions are referenced.
<p/>
Implementations have overlooked that the <tt>T</tt> in <tt>shared_ptr&lt;T&gt;</tt> can be a function type. It isn't 
immediately obvious from the standard, and it's not possible to tell from the wording that this is intentional.
</p>

<p><i>[2017-11 Albuquerque Wednesday night issues processing]</i></p>

<p>Priority set to 3</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4687">N4687</a>.</p>

<ol>
<li><p>Edit 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> as indicated:</p>
<blockquote>
<p>
[&hellip;]
<p/>
-2- Specializations of <tt>shared_ptr</tt> shall be <tt>CopyConstructible</tt>, <tt>CopyAssignable</tt>, and 
<tt>LessThanComparable</tt>, allowing their use in standard containers. Specializations of <tt>shared_ptr</tt> shall be 
contextually convertible to <tt>bool</tt>, allowing their use in boolean expressions and declarations in conditions. 
<del>The template parameter <tt>T</tt> of <tt>shared_ptr</tt> may be an incomplete type.</del>
<p/>
<ins>-?- The template parameter <tt>T</tt> of <tt>shared_ptr</tt> may be an incomplete type. <tt>T*</tt> shall be an object 
pointer type or a function pointer type.</ins>
<p/>
[&hellip;]
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13; Prague]</i></p>

<p>
LWG would prefer to make the new constraint a Mandates-like thing.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Edit 20.11.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a> as indicated:</p>
<blockquote>
<p>
[&hellip;]
<p/>
-2- Specializations of <tt>shared_ptr</tt> shall be <i>Cpp17CopyConstructible</i>, <i>Cpp17CopyAssignable</i>, and 
<i>Cpp17LessThanComparable</i>, allowing their use in standard containers. Specializations of <tt>shared_ptr</tt> shall be 
contextually convertible to <tt>bool</tt>, allowing their use in boolean expressions and declarations in conditions. 
<del>The template parameter <tt>T</tt> of <tt>shared_ptr</tt> may be an incomplete type.</del>
<p/>
<ins>-?- The template parameter <tt>T</tt> of <tt>shared_ptr</tt> may be an incomplete type. The program is ill-formed
unless <tt>T*</tt> is an object pointer type or a function pointer type.</ins>
<p/>
[&hellip;]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3019" href="3019">3019.</a> Presentation of "program defined classes derived from <tt>error_category</tt>" [syserr.errcat.derived] unclear and contains mistakes</h3>
<p><b>Section:</b> 19.5.2.4 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcat.derived">[syserr.errcat.derived]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Thomas K&ouml;ppe <b>Opened:</b> 2017-09-20 <b>Last modified:</b> 2017-11-09 15:13:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The presentation of section [syserr.errcat.derived] is currently somewhat problematic:
</p>
<ul>
<li><p>
It is not clear why this section exists and what it is specifying. Presumably, it is the subject of the phrase 
"in this subclause" of the sibling section [syserr.errcat.overview], but that's confusing (because this would require the 
interpretation of "this subclause" as the containing superclause). It would be an improvement to say "shall behave 
as specified in [syserr.errcat.derived]" in the introduction.
</p></li>
<li><p>
The current wording of [syserr.errcat.derived] requires that derived classes keep the <tt>name</tt> member function pure-virtual, 
making it impossible to have non-abstract derived classes. This appears to be an editorial error. Surely <tt>name</tt> should 
just not be required to be pure-virtual.
</p></li>
<li><p>
There seems to be no requirement concerning the <tt>message</tt> virtual member function.
</p></li>
<li><p>
We should use <tt>override</tt> rather than <tt>virtual</tt>.
</p></li>
<li><p>
I would welcome a short, introductory paragraph in [syserr.errcat.derived] that states (non-redundantly) that the following 
are requirements on users' derived classes.
</p></li>
</ul>
<p>
Partial wording proposal:
</p>
<ol>
<li><p>In 19.5.2.1 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcat.overview">[syserr.errcat.overview]</a> p1, change:</p>
<blockquote>
<p>
-1- The class <tt>error_category</tt> serves as a base class for types used to identify the source and encoding of a
particular category of error code. Classes may be derived from <tt>error_category</tt> to support categories of
errors in addition to those defined in this International Standard. Such classes shall behave as specified in
<del>this subclause</del><ins>19.5.2.4 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcat.derived">[syserr.errcat.derived]</a></ins>. [<i>Note:</i> <tt>error_category</tt> objects 
are passed by reference, and two such objects are equal if they have the same address. This means that applications 
using custom <tt>error_category</tt> types should create a single object of each such type. &mdash; <i>end note</i>]
</p>
</blockquote>
</li>

<li><p>In 19.5.2.4 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcat.derived">[syserr.errcat.derived]</a>, change:</p>
<blockquote>
<pre>
<del>virtual</del> const char* name() const noexcept <ins>override</ins> <del> = 0</del>;
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> A string naming the error category.
</p>
</blockquote>
<pre>
<del>virtual</del> error_condition default_error_condition(int ev) const noexcept <ins>override</ins>;
</pre>
<blockquote>
<p>
-2- <i>Returns:</i> An object of type <tt>error_condition</tt> that corresponds to <tt>ev</tt>.
</p>
</blockquote>
<pre>
<del>virtual</del> bool equivalent(int code, const error_condition&amp; condition) const noexcept <ins>override</ins>;
</pre>
<blockquote>
<p>
-3- <i>Returns:</i> <tt>true</tt> if, for the category of error represented by <tt>*this</tt>, <tt>code</tt> is considered 
equivalent to <tt>condition</tt>; otherwise, <tt>false</tt>.
</p>
</blockquote>
<pre>
<del>virtual</del> bool equivalent(const error_code&amp; code, int condition) const noexcept <ins>override</ins>;
</pre>
<blockquote>
<p>
-4- <i>Returns:</i> <tt>true</tt> if, for the category of error represented by <tt>*this</tt>, <tt>code</tt> is considered 
equivalent to condition; otherwise, <tt>false</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>

<p><i>[2017-11 Albuquerque Wednesday night issues processing]</i></p>

<p>Priority set to 3.</p>
<p>Jonathan to talk to Chris K and Walter about writing a paper describing the use of <tt>error_code</tt>, <tt>error_condition</tt> and defining your own.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3021" href="3021">3021.</a> [networking.ts] Relax pointer equivalence requirement for <tt>ConstBufferSequence</tt></h3>
<p><b>Section:</b> 16.2.2 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.reqmts.constbuffersequence">[networking.ts::buffer.reqmts.constbuffersequence]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Vinnie Falco <b>Opened:</b> 2017-09-20 <b>Last modified:</b> 2017-11-03 19:00:24 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: networking.ts</b></p>
<p>
The post-condition buffer sequence requirements mandate pointer equivalence. This means that a copies of buffer sequences must 
point to the same pieces of underlying memory. While this is appropriate for <tt>MutableBufferSequence</tt>, it is unnecessary 
for <tt>ConstBufferSequence</tt> and can actually prevent useful implementation strategies such as the following constant buffer 
sequence which avoids dynamic allocations:  
</p>
<blockquote>
<pre>
/// A buffer sequence containing a chunk-encoding header
class chunk_size
{
public:
    // Storage for the longest hex string we might need
    class value_type
    {
        friend class chunk_size;

        // First byte holds the length
        char buf_[1 + 2 * sizeof(std::size_t)];

        template&lt;class = void&gt;
        void prepare(std::size_t n);

        template&lt;class OutIter&gt;
        static OutIter to_hex(OutIter last, std::size_t n)
        {
            if (n == 0)
            {
                *--last = '0';
                return last;
            }
            while (n)
            {
                *--last = "0123456789abcdef"[n &amp; 0xf];
                n >>= 4;
            }
            return last;
        }
    public:
        operator boost::asio::const_buffer() const
        {
            return {
                buf_ + sizeof(buf_) - buf_[0],
                static_cast(buf_[0])
            };
        }
    };

    using const_iterator = value_type const*;

    chunk_size(chunk_size const&amp; other) = default;

    /** Construct a chunk header

        @param n The number of octets in this chunk.
    */
    chunk_size(std::size_t n)
    {
        value_.prepare(n);
    }

    const_iterator begin() const
    {
        return &amp;value_;
    }

    const_iterator end() const
    {
        return begin() + 1;
    }

private:
    value_type value_;
};
</pre>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4588">N4588</a>.
</p>

<ol>
<li>
<p>
Modify 16.2.2 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.reqmts.constbuffersequence">[networking.ts::buffer.reqmts.constbuffersequence]</a> Table 13 "<tt>ConstBufferSequence</tt> requirements" as indicated:
</p>
<blockquote>
<table border="1">
<caption>Table 13 &mdash; <tt>ConstBufferSequence</tt> requirements</caption>
<tr>
<th>expression</th>
<th>return type</th>
<th>assertion/note<br/>pre/post-condition</th>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>X u(x);</tt>
</td>
<td>
</td>
<td>
post:<br/>
<pre>
equal(
  net::buffer_sequence_begin(x),
  net::buffer_sequence_end(x),
  net::buffer_sequence_begin(u),
  net::buffer_sequence_end(u),
  [](const typename X::value_type&amp; v1,
     const typename X::value_type&amp; v2)
    {
      const_buffer b1(v1);
      const_buffer b2(v2);
      <del>return b1.data() == b2.data()
          &amp;&amp; b1.size() == b2.size()</del>
      <ins>return b1.size() == b2.size()
          &amp;&amp; memcmp(b1.data(), b2.data(), b1.size()) == 0</ins>;
    })
</pre>
</td>
</tr>
</table>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="3027" href="3027">3027.</a> [networking.ts] <tt>DynamicBuffer</tt> <tt>prepare</tt> exception specification</h3>
<p><b>Section:</b> 16.2.4 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.reqmts.dynamicbuffer">[networking.ts::buffer.reqmts.dynamicbuffer]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Vinnie Falco <b>Opened:</b> 2017-10-16 <b>Last modified:</b> 2017-11-09 15:13:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#networking.ts::buffer.reqmts.dynamicbuffer">active issues</a> in [networking.ts::buffer.reqmts.dynamicbuffer].</p>
<p><b>View all other</b> <a href="lwg-index.html#networking.ts::buffer.reqmts.dynamicbuffer">issues</a> in [networking.ts::buffer.reqmts.dynamicbuffer].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: networking.ts</b></p>
<p>
The current wording for the <tt>DynamicBuffer</tt> <tt>prepare</tt>
member function implies that <tt>std::length_error</tt> is the
only allowable thrown exception. This should be changed to reflect that
any exception may be thrown, with <tt>std::length_error</tt> thrown
in particular when <tt>size() + n</tt> exceeds <tt>max_size()</tt>.
</p>

<p><i>[2017-11-08]</i></p>

<p>Priority set to 3 after five votes on mailing list</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4588">N4588</a>.</p>

<ol>
<li><p>Change 16.2.4 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.reqmts.dynamicbuffer">[networking.ts::buffer.reqmts.dynamicbuffer]</a>, Table 14 "DynamicBuffer requirements", as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 14 &mdash; <tt>DynamicBuffer</tt> requirements</caption>
<tr>
<th>expression</th>
<th>return type</th>
<th>assertion/note pre/post-condition</th>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>x.prepare(n)</tt>
</td>
<td>
<tt>X::mutable_buffers_type</tt>
</td>
<td>
Returns a mutable buffer sequence <tt>u</tt><br/>
representing the writable bytes, and where<br/>
<tt>buffer_size(u) == n</tt> . The dynamic buffer<br/>
reallocates memory as required. All constant or<br/> 
mutable buffer sequences previously obtained using<br/>
<tt>data()</tt> or <tt>prepare()</tt> are invalidated.<br/>
<i>Throws:</i> <tt>length_error</tt> if <tt>size() + n</tt><br/>
exceeds <tt>max_size()</tt> <ins>or any other exception<br/> 
if the request cannot otherwise be satisfied</ins>.
</td>
</tr>
</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3028" href="3028">3028.</a> Container requirements tables should distinguish <tt>const</tt> and non-<tt>const</tt> variables</h3>
<p><b>Section:</b> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2017-10-17 <b>Last modified:</b> 2017-11-21 19:11:51 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#container.requirements.general">active issues</a> in [container.requirements.general].</p>
<p><b>View all other</b> <a href="lwg-index.html#container.requirements.general">issues</a> in [container.requirements.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[container.requirements.general] p4 says:
</p>
<blockquote>
<p>
In Tables 83, 84, and 85 <tt>X</tt> denotes a container class containing
objects of type <tt>T</tt>, <tt>a</tt> and <tt>b</tt> denote values of type <tt>X</tt>, <tt>u</tt> denotes an
identifier, <tt>r</tt> denotes a non-<tt>const</tt> value of type <tt>X</tt>, and <tt>rv</tt> denotes a
non-<tt>const</tt> rvalue of type <tt>X</tt>.
</p>
</blockquote>
<p>
This doesn't say anything about whether <tt>a</tt> and <tt>b</tt> are allowed to be
<tt>const</tt>, or must be non-<tt>const</tt>. In fact Table 83 uses them
inconsistently, e.g. the rows for "<tt>a = rv</tt>" and "<tt>a.swap(b)</tt>" most
certainly require them to be non-<tt>const</tt>, but all other uses are valid
for either <tt>const</tt> or non-<tt>const X</tt>.
</p>

<p><i>[2017-11 Albuquerque Wednesday night issues processing]</i></p>

<p>Priority set to 3; Jonathan to provide updated wording.</p>
<p>Wording needs adjustment - could use "possibly const values of type X"</p>
<p>Will distinguish between lvalue/rvalue </p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4687">N4687</a>.</p>

<ol>
<li><p>Change 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> p4 as indicated:</p>

<blockquote>
<p>
-4- In Tables 83, 84, and 85 <tt>X</tt> denotes a container class containing objects of type <tt>T</tt>, 
<tt>a</tt> and <tt>b</tt> denote values of type <tt>X</tt>, <tt>u</tt> denotes an identifier, <tt>r</tt> 
<ins>and s</ins> denote<del>s a</del> non-<tt>const</tt> value<ins>s</ins> of type <tt>X</tt>, and 
<tt>rv</tt> denotes a non-<tt>const</tt> rvalue of type <tt>X</tt>.
</p>
</blockquote>
</li>

<li><p>Change 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>, Table 83 "Container requirements", as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 83 &mdash; Container requirements</caption>
<tr style="text-align:center">
<th>Expression</th>
<th>Return type</th>
<th>Operational<br/>semantics</th>
<th>Assertion/note<br/>pre/post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="5" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt><del>a</del><ins>r</ins> = rv</tt>
</td>
<td>
<tt>X&amp;</tt>
</td>
<td>
All existing elements<br/>
of <tt><del>a</del><ins>r</ins></tt> are either move<br/>
assigned to or<br/>
destroyed
</td>
<td>
<tt><del>a</del><ins>r</ins></tt> shall be equal to<br/>
the value that <tt>rv</tt> had<br/>
before this<br/>
assignment
</td>
<td>
linear
</td>
</tr>
<tr>
<td colspan="5" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt><del>a</del><ins>r</ins>.swap(<del>b</del><ins>s</ins>)</tt>
</td>
<td>
<tt>void</tt>
</td>
<td>
</td>
<td>
exchanges the<br/>
contents of <tt><del>a</del><ins>r</ins></tt> and <tt><del>b</del><ins>s</ins></tt>
</td>
<td>
(Note A)
</td>
</tr>
<tr>
<td colspan="5" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>swap(<del>a</del><ins>r</ins>, <del>b</del><ins>s</ins>)</tt>
</td>
<td>
<tt>void</tt>
</td>
<td>
<tt><del>a</del><ins>r</ins>.swap(<del>b</del><ins>s</ins>)</tt>
</td>
<td>
</td>
<td>
(Note A)
</td>
</tr>
</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3029" href="3029">3029.</a> <tt>pop_heap</tt> over-constrains input</h3>
<p><b>Section:</b> 25.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/pop.heap">[pop.heap]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Mathias Stearn <b>Opened:</b> 2017-11-04 <b>Last modified:</b> 2017-11-13 19:00:40 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The spec for <tt>&lt;algorithms&gt;</tt> <tt>pop_heap</tt> includes
</p>
<blockquote><p>
-1- <i>Requires:</i> The range <tt>[first, last)</tt> shall be a valid non-empty heap.
</p></blockquote>
<p>
This has the unfortunate consequence that to pop a value and push a new value is substantially less efficient than necessary. 
The popped value must be extracted by <tt>pop_heap</tt> (using up to 2 log <tt><i>N</i></tt> compares and swaps), and then, in 
<tt>push_heap</tt>, the new value must be inserted (for up to <tt><i>N</i></tt> compares and swaps, but more usually something 
like log <tt><i>N</i></tt>).
<p/>
Simply relaxing the requirement to
</p>
<blockquote><p>
-1- <i>Requires:</i> The range <tt>[first, last - 1)</tt> shall be a valid heap.
</p></blockquote>
<p>
enables use of <tt>pop_heap</tt> in an integrated push-and-pop operation, with less than half the number of expected compare 
and swap operations. Furthermore, if, as is often the case, the newly pushed value would have ended up at position <tt>first</tt>, 
the push/pop operation could complete in time <tt>&#x1d4aa;(1)</tt>, instead of (3 log <tt><i>N</i></tt>).
<p/>
The effect of the proposed relaxation on existing library implementations would be minimal in the extreme, and on existing user 
code nil. The base algorithm code remains exactly identical. The only changes needed would be to any instrumentation in a 
debugging version of the library, which would just need to relax its check, and to test suites that should exercise the newly 
tolerated input.
<p/>
Users today are tempted to get the improved performance by relying on existing implementations' tacit tolerance of input that 
only satisfies the proposed, relaxed requirements. In fact, the 
<a href="http://en.cppreference.com/w/cpp/algorithm/pop_heap">cppreference.com page on <tt>pop_heap</tt></a> offers no hint 
that this usage is not already allowed. This change would bless such reliance as formally permitted.
<p/>
After this change, minor extensions to <tt>std::priority_queue</tt> would enable it to take advantage of the newly efficient operation, 
perhaps:
</p>
<blockquote><pre>
void pop_push(const Type&amp;);
void pop_push(Type&amp;&amp;);
template &lt;class... Args&gt; void pop_emplace(Args&amp;&amp;... args);
</pre></blockquote>
<p>
These will appear in a formal proposal if the resolution is accepted.
</p>

<p><i>[2017-11 Albuquerque Wednesday night issues processing]</i></p>

<p>Priority set to 3</p>

<p><i>[2017-11 Albuquerque Saturday issues processing]</i></p>

<p>status to Open; Marshall to review</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4700">N4700</a>.</p>

<ol>
<li><p>Change 25.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/pop.heap">[pop.heap]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class RandomAccessIterator&gt;
  void pop_heap(RandomAccessIterator first, RandomAccessIterator last);
template&lt;class RandomAccessIterator, class Compare&gt;
  void pop_heap(RandomAccessIterator first, RandomAccessIterator last,
                Compare comp);
</pre>
<blockquote>
<p>
-1- <i>Requires:</i> The range <tt>[first, last <ins>- 1</ins>)</tt> shall be a valid <del>non-empty</del> heap. 
<tt>RandomAccessIterator</tt> shall satisfy the requirements of <tt>ValueSwappable</tt> (16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>). 
The type of <tt>*first</tt> shall satisfy the requirements of <tt>MoveConstructible</tt> (Table 23) and of <tt>MoveAssignable</tt> 
(Table 25).
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3032" href="3032">3032.</a> <tt>ValueSwappable</tt> requirement missing for <tt>push_heap</tt> and <tt>make_heap</tt></h3>
<p><b>Section:</b> 25.7.7 <a href="https://timsong-cpp.github.io/cppwp/alg.heap.operations">[alg.heap.operations]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Robert Douglas <b>Opened:</b> 2017-11-08 <b>Last modified:</b> 2017-11-09 15:13:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.heap.operations">issues</a> in [alg.heap.operations].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In discussion of D0202R3 in Albuquerque, it was observed that <tt>pop_heap</tt> and <tt>sort_heap</tt> had 
<tt>constexpr</tt> removed for their requirement of <tt>ValueSwappable</tt>. It was then observed that 
<tt>push_heap</tt> and <tt>make_heap</tt> were not similarly marked as having the <tt>ValueSwappable</tt> requirement. 
The room believed this was likely a specification error, and asked to open an issue to track it.
</p>

<p><i>[2017-11 Albuquerque Wednesday night issues processing]</i></p>

<p>Priority set to 3; Marshall to investigate</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4700">N4700</a>.</p>

<ol>
<li><p>Change 25.7.7.1 <a href="https://timsong-cpp.github.io/cppwp/push.heap">[push.heap]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class RandomAccessIterator&gt;
  void push_heap(RandomAccessIterator first, RandomAccessIterator last);
template&lt;class RandomAccessIterator, class Compare&gt;
  void push_heap(RandomAccessIterator first, RandomAccessIterator last,
                 Compare comp);
</pre>
<blockquote>
<p>
-1- <i>Requires:</i> The range <tt>[first, last - 1)</tt> shall be a valid heap. <ins><tt>RandomAccessIterator</tt> shall satisfy 
the requirements of <tt>ValueSwappable</tt> (16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>).</ins> The type of <tt>*first</tt> 
shall satisfy the <tt>MoveConstructible</tt> requirements (Table 23) and the <tt>MoveAssignable</tt> requirements (Table 25).
</p>
</blockquote>
</blockquote>
</li>

<li><p>Change 25.7.7.3 <a href="https://timsong-cpp.github.io/cppwp/make.heap">[make.heap]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class RandomAccessIterator&gt;
  void make_heap(RandomAccessIterator first, RandomAccessIterator last);
template&lt;class RandomAccessIterator, class Compare&gt;
  void make_heap(RandomAccessIterator first, RandomAccessIterator last,
                 Compare comp);
</pre>
<blockquote>
<p>
-1- <i>Requires:</i> <ins><tt>RandomAccessIterator</tt> shall satisfy the requirements of <tt>ValueSwappable</tt> 
(16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>).</ins> The type of <tt>*first</tt> shall satisfy the <tt>MoveConstructible</tt> 
requirements (Table 23) and the <tt>MoveAssignable</tt> requirements (Table 25).
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3036" href="3036">3036.</a> <tt>polymorphic_allocator::destroy</tt> is extraneous</h3>
<p><b>Section:</b> 20.12.3 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.class">[mem.poly.allocator.class]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2017-11-15 <b>Last modified:</b> 2019-02-21 17:23:36 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#mem.poly.allocator.class">active issues</a> in [mem.poly.allocator.class].</p>
<p><b>View all other</b> <a href="lwg-index.html#mem.poly.allocator.class">issues</a> in [mem.poly.allocator.class].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>polymorphic_allocator</tt>'s member function <tt>destroy</tt> is exactly
equivalent to the default implementation of <tt>destroy</tt> in
<tt>allocator_traits</tt> (20.10.9.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.traits.members">[allocator.traits.members]</a> para 6). It
should be struck from <tt>polymorphic_allocator</tt> as it provides no value.
</p>

<p><i>[28-Nov-2017 Mailing list discussion - set priority to P3]</i></p>

<p>PJ says that Dinkumware is shipping an implementation of <tt>polymorphic_allocator</tt> with <tt>destroy</tt>, so removing it would be a breaking change for him.</p>

<p><i>[2019-02; Kona Wednesday night issue processing]</i></p>

<p>Status to Open; revisit once <a href="https://wg21.link/P0339">P0339</a> lands. Poll taken was 5-3-2 in favor of removal.</p>


<p><b>Proposed resolution:</b></p>
<p>
Wording relative to <a href="http://wg21.link/n4700">N4700</a>.
</p>

<ol>
<li>
<p>
Strike the declaration of <tt>destroy</tt> from the synopsis of class
<tt>polymorphic_allocator</tt> in 20.12.3 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.class">[mem.poly.allocator.class]</a>:
</p>
<blockquote>
<pre>
template &lt;class T1, class T2, class U, class V&gt;
  void construct(pair&lt;T1,T2&gt;* p, pair&lt;U, V&gt;&amp;&amp; pr);

<del>template &lt;class T&gt;</del>
  <del>void destroy(T* p);</del>

polymorphic_allocator select_on_container_copy_construction() const;
</pre>
</blockquote>
</li>

<li>
<p>
Strike the specification of <tt>destroy</tt> in 20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a>:
</p>
<blockquote>
[&hellip;]

<pre>
<del>template &lt;class T&gt;</del>
  <del>void destroy(T* p);</del>
</pre>

<p><del>14 Effects: As if by <tt>p->~T()</tt>.</del></p>

[&hellip;]
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3044" href="3044">3044.</a> Strange specification of <tt>max_size()</tt> for an allocator</h3>
<p><b>Section:</b> 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jon Cohen <b>Opened:</b> 2017-12-06 <b>Last modified:</b> 2018-08-21 19:57:40 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.requirements">active issues</a> in [allocator.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.requirements">issues</a> in [allocator.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Table 31 in the C++17 standard specifies <tt>X::max_size()</tt> (where <tt>X</tt> is an allocator type) as "The largest value 
that can meaningfully be passed to <tt>X::allocate()</tt>". Noticeably missing is the statement "<i>Throws:</i> Nothing".
<p/>
As an example of why this is an issue, note that <tt>vector::max_size()</tt> and <tt>allocator_traits::max_size()</tt> are 
both marked <tt>noexcept</tt>. We must then interpret <tt>max_size()</tt> as being allowed to sometimes call 
<tt>std::terminate</tt>, or else <tt>{vector, allocator_traits, ...}::max_size()</tt> must be allowed to directly calculate 
<tt>numeric_limits&lt;size_type&gt;::max() / sizeof(value_type)</tt> instead of querying the allocator, even if 
<tt>Alloc::max_size()</tt> exists. This seems like a bug in the wording for the requirements of <tt>max_size()</tt> in an 
allocator type. I think an issue should be opened on this subject to add <i>Throws:</i> Nothing or similar to the requirements 
of <tt>max_size()</tt> for an allocator.
<p/>
As an example consider writing up a framework to test the exception-safety of types in a given framework, since they were all 
written in an exception-free environment. One of the types in the framework is an allocator which, in a controlled way, 
can throw an exception at any point where it is allowed by the standard. It's important that the test framework be as pedantic 
as possible, so the allocator type throws on <tt>max_size()</tt>, since it is currently allowed to by the standard. When a 
reasonable <tt>vector</tt> implementation (at least those in libstdc++ and msvc) is, for example, asked to construct a 
<tt>vector</tt> from an <tt>initializer_list</tt>, it will call <tt>allocator_traits&lt;Alloc&gt;::max_size()</tt>, which will 
terminate the program because the exception thrown in <tt>Alloc::max_size()</tt> propagated through the <tt>noexcept</tt> 
traits function. Although this is conformant behavior, I think it's a bug in the standard that a function as benign as 
<tt>max_size()</tt> can terminate the program in this manner, and I think the fix is that a conformant allocator should be 
required to supply a non-throwing <tt>max_size()</tt> member function.
<p/>
Daniel:
<p/>
This problem was shortly discussed during review of LWG <a href="2162">2162</a> (see comment 2012-08-05). At that time
the more drastic but also more consistent requirement that an allocator's <tt>max_size</tt> function shall not throw
exceptions has not been added. IMO this position should be reconsidered to follow the spirit of the new issue LWG 
<a href="3044">3044</a>.
</p>

<p><i>[2018-01; Priority set to 3 after mailing list discussion]</i></p>


<p><i>[2018-08-21, Jonathan comments and provides wording]</i></p>

<p>
The phrase "the largest value that can meaningfully be passed to <tt>X::allocate()</tt>" is meaningless. Is it a 
requirement on the caller, so that larger values must not be passed? Or a hint from the allocator implementor that larger 
values will produce a <tt>bad_alloc exception</tt>? Can the return value change dynamically, based on the free memory 
available to the allocator?! &mdash; LWG <a href="197">197</a> says it can't change.
<p/>
As noted in the LWG <a href="2162">2162</a> comments, we don't currently guarantee it can be called on a <tt>const</tt> object 
(so <tt>allocator_traits</tt> will not use the allocator's <tt>max_size()</tt> if it's non-<tt>const</tt>, although that was 
unclear before DR <a href="2284">2284</a>). In addition to adding "<i>Throws:</i> nothing" we should ensure it's callable 
on <tt>const</tt> lvalues, and clarify what "meaningfully" means and who is supposed to care about it. My proposed 
resolution doesn't achieve all of this, but is a start.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Change 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 32 &mdash; "Descriptive variable definitions", as indicated:</p>
<blockquote>
<table border="1">
<caption>Table 32 &mdash; Descriptive variable definitions</caption>
<tr>
<th>Variable</th>
<th>Definition</th>
</tr>

<tr>
<td>
<tt>T, U, C</tt>
</td>
<td>
any <i>cv</i>-unqualified object type (3.9)
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a, a1, a2</tt>
</td>
<td>
lvalues of type <tt>X</tt>
</td>
</tr>

<tr>
<td>
<ins><tt>a3</tt></ins>
</td>
<td>
<ins>an lvalue of type <tt>const X</tt></ins>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Change 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 33 &mdash; "<i>Cpp17Allocator</i> requirements", as indicated:</p>
<blockquote>
<table border="1">
<caption>Table 33 &mdash; <i>Cpp17Allocator</i> requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a<ins>3</ins>.max_size()</tt>
</td>
<td>
<tt>X::size_type</tt>
</td>
<td>
the largest value that can<br/>
meaningfully be passed to<br/>
<tt>X::allocate()</tt><ins>.<br/> 
[<i>Note:</i> Larger values might cause<br/> 
an exception to be thrown. &mdash; <i>end note</i>]<br/> 
<i>Throws:</i> Nothing.</ins>
</td>
<td>
<tt>numeric_limits&lt;size_type&gt;::max()<br/>
/ sizeof(value_type)</tt>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3046" href="3046">3046.</a> Do not require <tt>reference_wrapper</tt> to support non-referenceable function types</h3>
<p><b>Section:</b> 20.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2017-12-14 <b>Last modified:</b> 2019-03-16 13:34:20 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#refwrap">issues</a> in [refwrap].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[refwrap] says that <tt>reference_wrapper&lt;T&gt;</tt> is a "wrapper around a reference to an object or function of type <tt>T</tt>" 
but this doesn't actually constrain it, and doesn't forbid non-referenceable function types like <tt>int() const</tt>.
<p/>
There is no way to construct a <tt>reference_wrapper&lt;int() const&gt;</tt> but implementations are required to provide partial 
specializations for functions with <i>cv</i>-qualifiers and ref-qualifiers in order to define a nested <tt>result_type</tt>. 
It should be undefined to instantiate <tt>reference_wrapper&lt;T&gt;</tt> with a non-referenceable type, or with a reference type 
(since references to references are not possible). Making it undefined (rather than ill-formed or unspecified) means implementations 
are not required to diagnose such invalid specializations, but also don't have to go to the effort of supporting weak result types etc.
</p>
<p><i>[2018-01; Priority set to 3 after mailing list discussion]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4713">N4713</a>.</p>

<ol>
<li><p>Modify 20.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a> as indicated:</p>

<blockquote>
<p>
-1- <tt>reference_wrapper&lt;T&gt;</tt> is a <tt>CopyConstructible</tt> and <tt>CopyAssignable</tt> wrapper around a reference 
to an object or function of type <tt>T</tt>. <ins><tt>T</tt> shall be a referenceable type (16.3.23 <a href="https://timsong-cpp.github.io/cppwp/defns.referenceable">[defns.referenceable]</a>) that 
is not a reference type.</ins>
<p/>
-2- <tt>reference_wrapper&lt;T&gt;</tt> shall be a trivially copyable type (6.8 <a href="https://timsong-cpp.github.io/cppwp/basic.types">[basic.types]</a>).
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-03-15; Daniel comments and provides revised wording]</i></p>

<p>
The current wording is now far behind the working draft and a synchronization is therefore recommended. In particular, with the
acceptance of <a href="http://wg21.link/p0357r1">P0357R1</a>, the specification of <tt>reference_wrapper</tt> has no longer any
<i>weak result type</i>. Second, I would like to concur with a <a href="http://lists.isocpp.org/lib/2017/12/5023.php">remark 
from Tomasz</a> to change the wording to replace the undefined behavior by an ill-formed program instead, because <em>every</em>
attempt to instantiate the definition of <tt>reference_wrapper</tt> will instantiate its member declarations, and this would
cause the program to become ill-formed anyway because of the illegal formation of references to non-referenceable function 
types for member functions such as <tt>T&amp; get() const noexcept</tt>.
<p/>
As concrete wording suggestion I would recommend wording that ensures that an ill-formed program is only required when a
specialization of <tt>reference_wrapper</tt> is instantiated, because in the absence of a constrained template parameter
we shouldn't require implementations to diagnose even forming the name of a <tt>reference_wrapper</tt> specialization such 
as in the following example:
</p>
<blockquote><pre>
using X = reference_wrapper&lt;int() const&gt;;
</pre></blockquote>
<p>
The wording below does not take advantage of a <i>Mandates:</i> element to prevent a dependency on LWG <a href="3193">3193</a>
and because such an element is rarely used to specify class templates. If the committee wishes to use such an element, 
the equivalent wording would be:
</p>
<blockquote><p>
<i>Mandates:</i> <tt>reference_wrapper</tt> is instantiated with a referenceable type (16.3.23 <a href="https://timsong-cpp.github.io/cppwp/defns.referenceable">[defns.referenceable]</a>) 
as the argument for the template parameter <tt>T</tt>.
</p></blockquote>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4800">N4800</a>.</p>

<ol>
<li><p>Modify 20.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a> as indicated:</p>

<blockquote>
<p>
-1- <tt>reference_wrapper&lt;T&gt;</tt> is a <i>Cpp17CopyConstructible</i> and <i>Cpp17CopyAssignable</i> wrapper around a reference
to an object or function of type <tt>T</tt>. <ins>If <tt>reference_wrapper</tt> is instantiated with a non-referenceable type 
(16.3.23 <a href="https://timsong-cpp.github.io/cppwp/defns.referenceable">[defns.referenceable]</a>) as the argument for the template parameter <tt>T</tt>, the program is ill-formed.</ins>
<p/>
-2- <tt>reference_wrapper&lt;T&gt;</tt> is a trivially copyable type (6.8 <a href="https://timsong-cpp.github.io/cppwp/basic.types">[basic.types]</a>).
<p/>
-3- The template parameter <tt>T</tt> of <tt>reference_wrapper</tt> may be an incomplete type.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3047" href="3047">3047.</a> <tt>atomic</tt> compound assignment operators can cause undefined behavior when corresponding 
<tt>fetch_<i>meow</i></tt> members don't</h3>
<p><b>Section:</b> 31.8.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.int">[atomics.types.int]</a>, 31.8.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.pointer">[atomics.types.pointer]</a>, 31.8.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.memop">[atomics.types.memop]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2017-12-15 <b>Last modified:</b> 2019-04-20 13:44:43 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Given <tt>atomic&lt;int&gt; meow{INT_MAX};</tt>, <tt>meow.fetch_add(1)</tt> has well-defined behavior because 31.8.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.int">[atomics.types.int]</a> p7 says that
<blockquote>
<p>
<i>Remarks:</i> For signed integer types, arithmetic is defined to use two's complement representation. There are no undefined results.
</p>
</blockquote>
but <tt>meow += 1</tt> and <tt>++meow</tt> have undefined behavior, because these operator functions are defined (by, respectively, 
31.8.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.int">[atomics.types.int]</a> p8 and 31.8.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.memop">[atomics.types.memop]</a>) to be equivalent to <tt>return fetch_add(1) + 1;</tt>, 
and so the addition of 1 to the result of <tt>fetch_add</tt> &mdash; which causes an integer overflow in this case &mdash; occurs 
outside the protection of <tt>fetch_add</tt> magic. Additionally, the return value might differ from what <tt>fetch_add</tt> actually
wrote since that addition isn't required to use two's complement. This seems like a trap for the unwary. Is it intended?
<p/>
A similar issue affects the <tt>atomic&lt;T*&gt;</tt> partial specialization for pointers.
</p>
<p><i>[2018-01; Priority set to 3 after mailing list discussion]</i></p>


<p><i>[2019-04-15; JF Bastien comments and provides wording]</i></p>

<p>
As discussed by LWG during the <a href="http://wiki.edg.com/bin/view/Wg21sandiego2018/LWGD1236Review">San 
Diego 2018 meeting</a>, Jens removed LWG 3047 from <a href="http://wg21.link/p1236r1">"P1236R1: Alternative Wording for P
0907R4 Signed Integers are Two's Complement"</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 31.7.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.ref.int">[atomics.ref.int]</a> as indicated:</p>

<blockquote>
<pre>
<i>integral</i> operator <i>op</i>=(<i>integral</i> operand) const noexcept;
</pre>
<blockquote>
<p>
-7- <i>Effects:</i> Equivalent to: <tt>return 
<ins>static_cast&lt;<i>integral</i>&gt;(static_cast&lt;make_unsigned_t&lt;<i>integral</i>&gt;&gt;(</ins>fetch_<i>key</i>(operand)<ins>)</ins> 
<i>op</i> <ins>static_cast&lt;make_unsigned_t&lt;<i>integral</i>&gt;&gt;(</ins>operand<ins>))</ins>;</tt>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 31.7.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.ref.memop">[atomics.ref.memop]</a> as indicated:</p>

<blockquote>
<pre>
T* operator++() const noexcept;
</pre>
<blockquote>
<p>
-3- <i>Effects:</i> Equivalent to: <tt>return 
<ins>static_cast&lt;T&gt;(static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>fetch_add(1)<ins>)</ins> + 
<ins>static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>1<ins>))</ins>;</tt>
</p>
</blockquote>
<pre>
T* operator--(<del>int</del>) const noexcept;
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> Equivalent to: <tt>return 
<ins>static_cast&lt;T&gt;(static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>fetch_sub(1)<ins>)</ins> - 
<ins>static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>1<ins>))</ins>;</tt>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 31.8.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.int">[atomics.types.int]</a> as indicated:</p>

<blockquote>
<pre>
T operator <i>op</i>=(T operand) volatile noexcept;
T operator <i>op</i>=(T operand) noexcept;
</pre>
<blockquote>
<p>
-8- <i>Effects:</i> Equivalent to: <tt>return 
<ins>static_cast&lt;T&gt;(static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>fetch_<i>key</i>(operand)<ins>)</ins> 
<i>op</i> <ins>static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>operand<ins>))</ins>;</tt>
</p>
</blockquote>
</blockquote>

<blockquote class="note">
<p>
[<i>Drafting note:</i> <tt>atomic&lt;<i>integral</i>&gt;</tt>'s working for <tt>operator++/operator--</tt> 
is shared with <tt>atomic&lt;T*&gt;</tt>. &mdash; <i>end drafting note</i>]
<p/>
[<i>Drafting note:</i> <tt>atomic&lt;<i>floating-point</i>&gt;</tt> seems to be correct, LWG should confirm 
that it is. &mdash; <i>end drafting note</i>]
</p>
</blockquote>
</li>

<li><p>Modify 31.8.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.pointer">[atomics.types.pointer]</a> as indicated:</p>

<blockquote>
<pre>
T* operator <i>op</i>=(ptrdiff_t operand) volatile noexcept;
T* operator <i>op</i>=(ptrdiff_t operand) noexcept;
</pre>
<blockquote>
<p>
-8- <i>Effects:</i> Equivalent to: <tt>return 
<ins>reinterpret_cast&lt;T*&gt;(reinterpret_cast&lt;ptrdiff_t&gt;(</ins>fetch_<i>key</i>(operand)<ins>)</ins> 
<i>op</i> operand<ins>)</ins>;</tt>
<p/>
<ins><i>Remarks:</i> The result may be an undefined address, but the operations otherwise have no undefined behavior.</ins>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 31.8.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.memop">[atomics.types.memop]</a> as indicated:</p>

<blockquote>
<pre>
T operator++() volatile noexcept;
T operator++() noexcept;
</pre>
<blockquote>
<p>
-3- <i>Effects:</i> Equivalent to: <tt>return 
<ins>static_cast&lt;T&gt;(static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>fetch_add(1)<ins>)</ins> + 
<ins>static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>1<ins>))</ins>;</tt>
</p>
</blockquote>
<pre>
T operator--() volatile noexcept;
T operator--() noexcept;
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> Equivalent to: <tt>return 
<ins>static_cast&lt;T&gt;(static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>fetch_sub(1)<ins>)</ins> - 
<ins>static_cast&lt;make_unsigned_t&lt;T&gt;&gt;(</ins>1<ins>))</ins>;</tt>
</p>
</blockquote>
</blockquote>

<blockquote class="note">
<p>
[<i>Drafting note:</i> Alternatively, LWG may want to separate the integral overload of <tt>operator++/operator--</tt> 
from that of <tt>atomic&lt;T*&gt;</tt>. <i>end drafting note</i>]
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3049" href="3049">3049.</a> Missing wording allowing algorithms to use copies of function objects as substitutes for their parameters</h3>
<p><b>Section:</b> 25.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.requirements">[algorithms.requirements]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jared Hoberock <b>Opened:</b> 2017-12-04 <b>Last modified:</b> 2018-03-19 00:12:24 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
When designing the parallel algorithms library, we intended for parallel algorithms to copy their function objects parameters 
when it is possible and useful to do so, but there doesn't appear to be any wording to enable that latitude. To the contrary, 
algorithm specifications refer to their function object parameters by name, implying that a copy of the parameter may not 
be used as a substitute.
<p/>
This was noticed when Billy O'Neal observed that parallel <tt>generate()</tt> did not share parallel <tt>for_each()</tt> and 
<tt>for_each_n()</tt>'s special requirement for a <tt>CopyConstructible</tt> user-provided function object.
<p/>
This <tt>CopyConstructible Function</tt> requirement was added to relax legacy <tt>for_each()</tt>'s <tt>MoveConstructible Function</tt>
requirement to allow parallel implementations to make copies as necessary. All parallel algorithms need similar permissions, 
but a strong requirement for <tt>CopyConstructible</tt> in all algorithms is too restrictive.
<p/>
What we require is to allow algorithm implementations to use copies of function objects as substitutes for their original parameters, 
while not requiring that all function object parameters be copyable.
<p/>
Casey Carter noted that 25.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.requirements">[algorithms.requirements]</a> p8 grants permission to all algorithms to copy their function 
object parameters. However, this paragraph is not normative and does not indicate how the algorithm is allowed to use such copies. 
Additionally, it does not specify which algorithm parameters are the ones called out as function objects. For example, 
25.6.7 <a href="https://timsong-cpp.github.io/cppwp/alg.generate">[alg.generate]</a> refers to <tt>gen</tt> as a function object, but 25.5.4 <a href="https://timsong-cpp.github.io/cppwp/alg.foreach">[alg.foreach]</a> does not refer to <tt>f</tt> 
as a function object. All the other types of callable algorithm parameters (i.e. <tt>Predicate</tt>, <tt>BinaryPredicate</tt>, 
<tt>Compare</tt>, <tt>UnaryOperation</tt>, <tt>BinaryOperation</tt>, <tt>BinaryOperation1</tt>, and <tt>BinaryOperation2</tt>) 
are defined to be function objects in 25.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.requirements">[algorithms.requirements]</a> and 25.3.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.user">[algorithms.parallel.user]</a>. This 
list intentionally omits <tt>Function</tt> and <tt>Generator</tt> by design.
<p/>
A potential resolution would introduce normative wording to explicitly allow algorithms to use copies of function object parameters 
as substitutes for their function object parameters, and remove ambiguity in algorithm specifications about which parameters are 
function objects.
</p>
<p><i>[2018-01; Priority set to 3 after mailing list discussion]</i></p>


<p><i>[2018-3-14 Wednesday evening issues processing; move to Open]</i></p>

<p>We thought that the notes in [alg.foreach]/1 and /11 should be unwrapped as well. Bryce to work with Jared on updated wording.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4713">N4713</a>.</p>

<ol>
<li><p>Modify 25.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.requirements">[algorithms.requirements]</a> as indicated:</p>

<blockquote>
<p>
-8- <del>[<i>Note:</i></del> Unless otherwise specified, algorithms that take function objects as arguments are permitted to copy
those function objects freely. <ins>When an algorithm's specification requires the invocation of a function object parameter, 
such a copy may be invoked as a substitute for the original function object parameter.</ins> <ins>[<i>Note:</i> This implies 
that copyable user-supplied function objects should not rely on their identity.</ins> Programmers for whom object identity is 
important should consider using a wrapper class that points to a noncopied implementation object such as 
<tt>reference_wrapper&lt;T&gt;</tt> (20.14.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap">[refwrap]</a>), or some equivalent solution. &mdash; <i>end note</i>]
</p>
</blockquote>

</li>

<li><p>Modify 25.5.4 <a href="https://timsong-cpp.github.io/cppwp/alg.foreach">[alg.foreach]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class InputIterator, class Function&gt;
  constexpr Function for_each(InputIterator first, InputIterator last, Function f);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-2- <i>Effects:</i> Applies <ins>the function object</ins> <tt>f</tt> to the result of dereferencing every iterator in the range 
<tt>[first, last)</tt>, [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class ExecutionPolicy, class ForwardIterator, class Function&gt;
  void for_each(ExecutionPolicy&amp;&amp; exec,
                ForwardIterator first, ForwardIterator last,
                Function f);
</pre>
<blockquote>
<p>
<del>-6- <i>Requires:</i> <tt>Function</tt> shall meet the requirements of <tt>CopyConstructible</tt>.</del>
<p/>
-7- <i>Effects:</i> Applies <ins>the function object</ins> <tt>f</tt> to the result of dereferencing every iterator in the range 
<tt>[first, last)</tt>. [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class InputIterator, class Size, class Function&gt;
constexpr InputIterator for_each_n(InputIterator first, Size n, Function f);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-13- <i>Effects:</i> Applies <ins>the function object</ins> <tt>f</tt> to the result of dereferencing every iterator in the range 
<tt>[first, first + n)</tt> in order. [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class ExecutionPolicy, class ForwardIterator, class Size, class Function&gt;
  ForwardIterator for_each_n(ExecutionPolicy&amp;&amp; exec, ForwardIterator first, Size n,
                             Function f);
</pre>
<blockquote>
<p>
<del>-16- <i>Requires:</i> <tt>Function</tt> shall meet the requirements of <tt>CopyConstructible</tt>.</del>
<p/>
[&hellip;]
<p/>
-18- <i>Effects:</i> Applies <ins>the function object</ins> <tt>f</tt> to the result of dereferencing every iterator in the range 
<tt>[first, first + n).</tt> [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3050" href="3050">3050.</a> Conversion specification problem in <tt>chrono::duration</tt> constructor</h3>
<p><b>Section:</b> 27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a>, 27.5.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration.nonmember">[time.duration.nonmember]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2018-01-22 <b>Last modified:</b> 2020-02-14 09:37:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.duration.cons">active issues</a> in [time.duration.cons].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.duration.cons">issues</a> in [time.duration.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The converting constructor in <tt>std::chrono::duration</tt> is currently specified as
(27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> p1):
</p>
<blockquote>
<pre>
template&lt;class Rep2&gt;
  constexpr explicit duration(const Rep2&amp; r);
</pre>
<blockquote>
<p>
<i>Remarks:</i> This constructor shall not participate in overload resolution unless <tt>Rep2</tt> is
implicitly convertible to <tt>rep</tt> and [&hellip;]
</p>
</blockquote>
</blockquote>
<p>
But the parameter is of type <tt>Rep2 const</tt>, so we should check that <tt>Rep2 const</tt> is
implicitly convertible to <tt>rep</tt>, not just <tt>Rep2</tt>. This means that for a type like:
</p>
<blockquote>
<pre>
struct X { operator int64_t() /* not const */; };
</pre>
</blockquote>
<p>
<tt>std::is_constructible_v&lt;std::chrono::seconds, X&gt;</tt> is <tt>true</tt>, but actual
construction will fail to compile.
<p/>
Further analysis of sub-clause 27.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration">[time.duration]</a> revealed similar specification problems in
some other functions.
</p>

<p><i>[2018-06 Rapperswil Thursday issues processing]</i></p>

<p>P3; Status to Open</p>

<p><i>[2018-11 San Diego Thursday night issue processing]</i></p>

<p>Jonathan to provide updated wording; the underlying text has changed.</p>

<p><i>[2018-12-05 Jonathan provides new wording]</i></p>

<p>In San Diego Geoff noticed that the current WP does not use <tt>CR</tt>.
Jonathan provides new wording consistent with the
<a href="https://github.com/cplusplus/draft/pull/1985">editorial changes</a>
that removed <tt>CR</tt>.</p>

<strong>Previous resolution [SUPERSEDED]:</strong>

<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4713">N4713</a>.</p>

<ol>
<li><p>Modify 27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep2&gt;
  constexpr explicit duration(const Rep2&amp; r);
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This constructor shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, rep&gt;</tt> is <tt>true</tt></ins><del><tt>Rep2</tt>
is implicitly convertible to <tt>rep</tt></del> and
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>treat_as_floating_point_v&lt;rep&gt;</tt> is <tt>true</tt> or</p></li>
<li><p>(1.2) &mdash; <tt>treat_as_floating_point_v&lt;Rep2&gt;</tt> is <tt>false</tt>.</p></li>
</ol>
[&hellip;]
<p/>
-2- <i>Effects:</i> Constructs an object of type <tt>duration</tt>.
<p/>
-3- <i>Postconditions:</i> <tt>count() == static_cast&lt;rep&gt;(r)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.5.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration.nonmember">[time.duration.nonmember]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator*(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-4- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, CR(Rep1, Rep2)&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep2</tt> is implicitly convertible to <tt>CR(Rep1, Rep2)</tt></del>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class Rep1, class Rep2, class Period&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator*(const Rep1&amp; s, const duration&lt;Rep2, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
-6- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep1&amp;, CR(Rep1, Rep2)&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep1</tt> is implicitly convertible to <tt>CR(Rep1, Rep2)</tt></del>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator/(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-8- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, CR(Rep1, Rep2)&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep2</tt> is implicitly convertible to <tt>CR(Rep1, Rep2)</tt></del>
and <tt>Rep2</tt> is not a specialization of <tt>duration</tt>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator%(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-11- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, CR(Rep1, Rep2)&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep2</tt> is implicitly convertible to <tt>CR(Rep1, Rep2)</tt></del>
and <tt>Rep2</tt> is not a specialization of <tt>duration</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4791">N4791</a>.</p>

<ol>
<li><p>Modify 27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep2&gt;
  constexpr explicit duration(const Rep2&amp; r);
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This constructor shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, rep&gt;</tt> is <tt>true</tt></ins><del><tt>Rep2</tt>
is implicitly convertible to <tt>rep</tt></del> and
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>treat_as_floating_point_v&lt;rep&gt;</tt> is <tt>true</tt> or</p></li>
<li><p>(1.2) &mdash; <tt>treat_as_floating_point_v&lt;Rep2&gt;</tt> is <tt>false</tt>.</p></li>
</ol>
[&hellip;]
<p/>
-2- <i>Effects:</i> Constructs an object of type <tt>duration</tt>.
<p/>
-3- <i>Postconditions:</i> <tt>count() == static_cast&lt;rep&gt;(r)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.5.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration.nonmember">[time.duration.nonmember]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator*(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-4- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep2</tt> is implicitly convertible to <tt>common_type_t&lt;Rep1, Rep2&gt;</tt></del>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class Rep1, class Rep2, class Period&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator*(const Rep1&amp; s, const duration&lt;Rep2, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
-6- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep1&amp;, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep1</tt> is implicitly convertible to <tt>common_type_t&lt;Rep1, Rep2&gt;</tt></del>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator/(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-8- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep2</tt> is implicitly convertible to <tt>common_type_t&lt;Rep1, Rep2&gt;</tt></del>
and <tt>Rep2</tt> is not a specialization of <tt>duration</tt>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator%(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-11- <i>Remarks:</i> This operator shall not participate in overload resolution unless
<ins><tt>is_convertible_v&lt;const Rep2&amp;, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> is
<tt>true</tt></ins><del><tt>Rep2</tt> is implicitly convertible to <tt>common_type_t&lt;Rep1, Rep2&gt;</tt></del>
and <tt>Rep2</tt> is not a specialization of <tt>duration</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Rebase to most recent working draft
</p>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep2&gt;
  constexpr explicit duration(const Rep2&amp; r);
</pre>
<blockquote>
<p>
-1- <i>Constraints:</i> <tt>is_convertible_v&lt;<ins>const</ins> Rep2<ins>&amp;</ins>, rep&gt;</tt> is <tt>true</tt> and
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>treat_as_floating_point_v&lt;rep&gt;</tt> is <tt>true</tt> or</p></li>
<li><p>(1.2) &mdash; <tt>treat_as_floating_point_v&lt;Rep2&gt;</tt> is <tt>false</tt>.</p></li>
</ol>
[&hellip;]
<p/>
-2- <i>Postconditions:</i> <tt>count() == static_cast&lt;rep&gt;(r)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.5.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration.nonmember">[time.duration.nonmember]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator*(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-4- <i>Constraints:</i> <tt>is_convertible_v&lt;<ins>const</ins> Rep2<ins>&amp;</ins>, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> is <tt>true</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class Rep1, class Rep2, class Period&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator*(const Rep1&amp; s, const duration&lt;Rep2, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
-6- <i>Constraints:</i> <tt>is_convertible_v&lt;<ins>const</ins> Rep1<ins>&amp;</ins>, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> is <tt>true</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator/(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-8- <i>Constraints:</i> <tt>is_convertible_v&lt;<ins>const</ins> Rep2<ins>&amp;</ins>, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> 
is <tt>true</tt> and <tt>Rep2</tt> is not a specialization of <tt>duration</tt>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Rep1, class Period, class Rep2&gt;
  constexpr duration&lt;common_type_t&lt;Rep1, Rep2&gt;, Period&gt;
    operator%(const duration&lt;Rep1, Period&gt;&amp; d, const Rep2&amp; s);
</pre>
<blockquote>
<p>
-12- <i>Constraints:</i> <tt>is_convertible_v&lt;<ins>const</ins> Rep2<ins>&amp;</ins>, common_type_t&lt;Rep1, Rep2&gt;&gt;</tt> 
is <tt>true</tt> and <tt>Rep2</tt> is not a specialization of <tt>duration</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3052" href="3052">3052.</a> <tt>visit</tt> is underconstrained</h3>
<p><b>Section:</b> 20.7.7 <a href="https://timsong-cpp.github.io/cppwp/variant.visit">[variant.visit]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-01-23 <b>Last modified:</b> 2019-12-11 19:36:21 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.visit">issues</a> in [variant.visit].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>std::visit</tt> accepts a parameter pack of forwarding references named
<tt>vars</tt> whose types are the parameter pack <tt>Variants</tt>. Despite that:
<ol>
<li>the names of both packs are variants of "variant",</li>
<li>para 1 passes the types in <tt>Variants</tt> (modified) to <tt>variant_size_v</tt>,</li>
<li>para 3 uses the expression <tt>vars<sub><i>i</i></sub>.index()</tt>,</li>
<li>para 4 says "...if any <tt>variant</tt> in <tt>vars</tt> is <tt>valueless_by_exception</tt>,
and</li>
<li>para 5 mentions "..the number of alternative types of <tt>Variants<sub>0</sub></tt>"</li>
</ol>
the <i>Requires</i> element imposes no explicit requirements on the types in <tt>Variants</tt>.
Notably, the <tt>Variants</tt> are not required to be <tt>variant</tt>s. This lack of constraints
appears to be simply an oversight.
</p>

<p><i>[2018-01-24, Daniel comments]</i></p>

<p>
This issue should be reviewed in common with LWG <a href="2970">2970</a>.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 2; status to LEWG</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.</p>

<ol>
<li><p>Modify 20.7.7 <a href="https://timsong-cpp.github.io/cppwp/variant.visit">[variant.visit]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Visitor, class... Variants&gt;
  constexpr <i>see below</i> visit(Visitor&amp;&amp; vis, Variants&amp;&amp;... vars);
</pre>
<blockquote>
<p>[&hellip;]</p>
<p>
-4- <i>Throws:</i> <tt>bad_variant_access</tt> if <del>any <tt>variant</tt> in <tt>vars</tt> is
<tt>valueless_by_exception()</tt></del><ins><tt>(vars.valueless_by_exception() || ...)</tt> is
<tt>true</tt></ins>.
</p>
<p>-5- <i>Complexity:</i> [&hellip;]</p>
<p>
<ins>-?- <i>Remarks:</i> This function shall not participate in overload resolution unless
<tt>remove_cvref_t&lt;Variants<sub><i>i</i></sub>&gt;</tt> is a specialization of <tt>variant</tt>
for all <tt>0 &lt;= i &lt; n</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3053" href="3053">3053.</a> Prohibit <tt>error_code</tt> construction from rvalues of <tt>error_category</tt></h3>
<p><b>Section:</b> 19.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcode.overview">[syserr.errcode.overview]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Antony Polukhin <b>Opened:</b> 2018-01-24 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#syserr.errcode.overview">issues</a> in [syserr.errcode.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Constructor <tt>error_code(int val, const error_category&amp; cat)</tt> and
member function <tt>void assign(int val, const error_category&amp; cat)</tt>
could be misused if a custom <tt>error_category</tt> is provided:
</p>
<blockquote><pre>
error_code ec{1, test_category{}}; // ec holds a pointer/reference to a temporary
</pre></blockquote>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4713">N4713</a>.</p>

<ol>
<li><p>Modify 19.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcode.overview">[syserr.errcode.overview]</a> as indicated:</p>

<blockquote>
<pre>
namespace std {
  class error_code {
  public:
    <i>// 19.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcode.constructors">[syserr.errcode.constructors]</a>, constructors</i>
    [&hellip;]
    error_code(int val, const error_category&amp; cat) noexcept;
    <ins>error_code(int val, const error_category&amp;&amp; cat) = delete;</ins>
    [&hellip;]
    // 19.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/syserr.errcode.modifiers">[syserr.errcode.modifiers]</a>, modifiers
    void assign(int val, const error_category&amp; cat) noexcept;
    <ins>void assign(int val, const error_category&amp;&amp; cat) = delete;</ins>
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3056" href="3056">3056.</a> <tt>copy_file()</tt> copies which attributes?</h3>
<p><b>Section:</b> 29.11.14.4 <a href="https://timsong-cpp.github.io/cppwp/fs.op.copy.file">[fs.op.copy.file]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Davis Herring <b>Opened:</b> 2018-01-26 <b>Last modified:</b> 2019-04-02 17:52:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
(To resolve <a href="http://wg21.link/p0489r0#page=5">C++17 CD comment Late 25</a>.) 
It is not stated which attributes are copied by <tt>copy_file()</tt>.
</p>

<p><i>[2018-1-26 issues processing telecon]</i></p>

<p>Priority 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4713">N4713</a>.</p>
<ol>
<li><p>Modify 29.11.14.4 <a href="https://timsong-cpp.github.io/cppwp/fs.op.copy.file">[fs.op.copy.file]</a> as indicated:</p>

<blockquote class="note">
<p>
<b>Rationale:</b>
<p/>
The attributes specified are the useful subset of the attributes that can be queried in C++17.  
Existing practice is complicated: POSIX "cp -p" attempts to preserve user/group IDs, for instance, 
but cannot in general do so, and <tt>setuid/setgid</tt> permissions may be stripped.
</p>
</blockquote>

<blockquote>
<pre>
bool copy_file(const path&amp; from, const path&amp; to, copy_options options);
bool copy_file(const path&amp; from, const path&amp; to, copy_options options,
               error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
[&hellip;]
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p>(4.2) &mdash; Otherwise, copy the contents<ins>, permissions, and data modification time</ins> 
<del>and attributes</del> of the file <tt>from</tt> resolves to, to the file <tt>to</tt> resolves to, if:</p></li>
<li><p>[&hellip;]</p></li>
<li>
<ol style="list-style-type: none">
<li><p>(4.2.3) &mdash; <tt>(options &amp; copy_options::update_existing) != copy_options::none</tt> 
and <tt>from</tt> is more recent than <tt>to</tt>, determined as if by use of the <tt>last_write_time</tt> 
function (29.11.14.25 <a href="https://timsong-cpp.github.io/cppwp/fs.op.last.write.time">[fs.op.last.write.time]</a>).</p></li>
</ol>
<p>
<ins>Other implementation-defined attributes may be copied. Failure (or partial failure) to copy attributes 
is not an error.</ins>
</p>
</li>
<li><p>[&hellip;]</p></li>
</ol>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3057" href="3057">3057.</a> Correct <tt>copy_options</tt> handling</h3>
<p><b>Section:</b> 29.11.14.3 <a href="https://timsong-cpp.github.io/cppwp/fs.op.copy">[fs.op.copy]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Davis Herring <b>Opened:</b> 2018-01-29 <b>Last modified:</b> 2018-11-14 19:07:53 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#fs.op.copy">issues</a> in [fs.op.copy].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
(The resolution of #3 resolves part of <a href="http://wg21.link/p0488r0#page=10">C++17 NB comment US 36</a>.) 
<p/>
The handling of several options for <tt>filesystem::copy()</tt> is wrong:
</p>
<ol>
<li><p>Single-level directory copying is silently suppressed by any flag other than 
<tt>copy_options::recursive</tt> (even <tt>copy_options::directories_only</tt>). Single-level 
directory copying operates via using some unspecified flag to trigger this misfeature.</p></li>
<li><p><tt>copy_options::create_symlinks</tt> and <tt>copy_options::skip_symlinks</tt> affect 
the interpretation of the destination name; the latter shouldn't ever, and the former should 
affect only broken symlinks (since it would want to replace them).</p></li>
<li><p>The <tt>copy_options</tt> groups for existing target files and the form of copying are 
consulted only for creating regular files.</p></li>
<li><p><tt>copy("file", "dir")</tt> creates dir/file, but <tt>copy("symlink", "dir", 
copy_options::copy_symlinks)</tt> fails.</p></li>
<li><p>If a symlink is encountered with <tt>copy_options::copy_symlinks</tt> and 
<tt>copy_options::create_symlinks</tt>, the latter flag is ignored (but its otherwise sensible 
restriction to absolute paths applies) rather than the former.</p></li>
<li><p><tt>copy_options::create_symlinks</tt> without <tt>copy_options::copy_symlinks</tt> 
fails if it encounters a symlink. (This is particularly damaging for recursive operation.)</p></li>
</ol>
<p>
This issue, since it replaces so much text, also addresses two error-handling concerns in passing:
</p>
<ol>
<li><p>The significance of <tt>equivalent(from, to)</tt> failing is unspecified. (Ignoring such 
failures entirely would make dangerous those operations that replace the target with a link.)</p></li>
<li><p>Copying a directory involves several operations. When an <tt>error_code</tt> is being used, 
the process continues past errors and (because successful functions call <tt>ec.clear()</tt>) 
may suppress them.</p></li>
</ol>
<p>
This expands on the resolution for LWG <a href="2681">2681</a>.
<p/>
This also addresses the same issue as LWG <a href="2682">2682</a>, but has a different result 
(based on the fact that the Example successfully copies directories to new, non-existent names).
</p>

<p><i>[2018-06; Rapperswil Wednesday evening, discussing LWG <a href="2682">2682</a>]</i></p>

<p>
JW: can we use the words we are shipping already since two years?<br/>
BO: what we got is better than what we had before<br/>
no objection to moving to Ready<br/>
ACTION move to Ready<br/>
ACTION link LWG <a href="2682">2682</a> and LWG 3057 and set a priority 2 and look at 3057 in San Diego 
</p>

<p><i>[2018-11 San Diego Thursday night issue processing]</i></p>

<p>Need to gather implementation experience; revisit in Kona. Status to Open.</p>

<p><i>[2018-11-13; Billy O'Neal comments]</i></p>

<p>
I (Billy O'Neal) prefer Davis' solution to LWG 3057, as I think the wording follows the meaning of the individual 
enum values more closely, and enables more scenarios to function correctly instead of reporting such cases as errors.
<p/>
However, I don't want to adopt that wording as is because it requires my implementation to detect errors in places 
that force us to do a bunch of extra system calls, and I don't believe those specific ways error handling happens 
is relevant to what the copy API wants to do.
<p/>
Ideally, the wording would be structured such that it said "here's a list of error conditions, if they happen we 
aren't going to tell you when exactly they are detected" and then listed the behavior irrespective of when errors 
happen. That way implementations can do the error checks when it makes sense according to what their system APIs 
report. For example, anything that requires symlink resolution is very expensive on my platform so I'd want to 
be able to defer anything related to status (rather than <tt>symlink_status</tt>) to after I've detected that 
there's actually a symlink (or junction) involved.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.</p>

<ol>
<li><p>Modify Table 115 &mdash; "Enum class <tt>copy_options</tt>" as indicated:</p>

<blockquote>
 <table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse">
  <tr>
    <th colspan="2">Option group controlling <ins><tt>copy</tt> and</ins> <tt>copy_file</tt> 
    function effects for existing target files</th>
  </tr>
    <tr>
      <td><b>Constant</b></td>
      <td><b>Meaning</b></td>
    </tr>
    <tr>
      <td>[&hellip;]</td>
      <td>[&hellip;]</td>
    </tr>
  </table>
</blockquote>

</li>

<li><p>Modify 29.11.14.3 <a href="https://timsong-cpp.github.io/cppwp/fs.op.copy">[fs.op.copy]</a> as indicated:</p>

<blockquote class="note">
<p>
<b>Rationale:</b>
<p/>
POSIX.1-2008 allows the implementation to create hard links "to" symbolic links, and provides 
<tt>linkat()</tt> to choose between the symlink and its target.
<p/>
29.11.14.3 <a href="https://timsong-cpp.github.io/cppwp/fs.op.copy">[fs.op.copy]</a>/4.9 is redundant given 29.11.6 <a href="https://timsong-cpp.github.io/cppwp/fs.err.report">[fs.err.report]</a>/3.1.
</p>
</blockquote>

<blockquote>
<pre>
void copy(const path&amp; from, const path&amp; to, copy_options options);
void copy(const path&amp; from, const path&amp; to, copy_options options,
          error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
-3- <i>Requires:</i> At most one element from each option group (29.11.9.3 <a href="https://timsong-cpp.github.io/cppwp/fs.enum.copy.opts">[fs.enum.copy.opts]</a>) 
is set in <tt>options</tt>.
<p/>
-4- <i>Effects:</i> <del>Before the first use of <tt>f</tt> and <tt>t</tt>:</del>
<ol style="list-style-type: none">
<li><p><del>(4.1) &mdash; If [&hellip;]</del></p></li>
<li><p><del>[&hellip;]</del></p></li>
<li><p><del>(4.10) &mdash; Otherwise, no effects.</del></p></li>
</ol>
<ins>If each is needed below,</ins>
<blockquote><pre>
<ins>auto linkf = (options &amp; (copy_options::copy_symlinks |
                         copy_options::skip_symlinks)) != copy_options::none;
auto f = linkf ? symlink_status(from) : status(from), t = status(to);
auto to2 = !is_directory(f) &amp;&amp; is_directory(t) ? to/from.filename() : to.
bool linkt = (options &amp; (copy_options::create_symlinks |
                         copy_options::create_hard_links)) != copy_options::none ||
            is_symlink(f);
auto t2 = linkt ? symlink_status(to2) : status(to2);</ins>
</pre></blockquote>

<blockquote class="note">
<p>
[<i>Drafting note:</i> <tt>copy_options::create_symlinks</tt> is intentionally omitted for linkf; 
it may simply have been a typo for <tt>copy_options::copy_symlinks</tt> (which was added by LWG 
<a href="2681">2681</a>) since at least <a href="http://wg21.link/n3940">N3940</a>.]
</p>
</blockquote>

<ins>Effects are then as follows:</ins>
<ol style="list-style-type: none">
<li><p><ins>(?.?) &mdash; If <tt>f.type()</tt> or <tt>t.type()</tt> is an implementation-defined 
file type 99 [fs.enum.file_type], then the effects are implementation-defined.</ins></p>
<blockquote class="note">
<p>
[<i>Drafting note:</i> the text between the previous drafting note and this one is the only unchanged 
text under /4.]
</p>
</blockquote>
</li>
<li><p><ins>(?.?) &mdash; Otherwise, if <tt>exists(f)</tt> is <tt>false</tt>, report an error as 
specified in 29.11.6 <a href="https://timsong-cpp.github.io/cppwp/fs.err.report">[fs.err.report]</a>.</ins></p></li>
<li><p><ins>(?.?) &mdash; Otherwise, do nothing if</ins></p>
<ol style="list-style-type: none">
<li><p><ins>(?.?.?) &mdash; <tt>(options &amp; copy_options::directories_only) != copy_options::none</tt> 
and <tt>is_directory(f)</tt> is <tt>false</tt>, or</ins></p></li>
<li><p><ins>(?.?.?) &mdash; <tt>(options &amp; copy_options::skip_symlinks) != copy_options::none</tt> 
and <tt>is_symlink(f)</tt> is <tt>true</tt>, or</ins></p></li>
<li><p><ins>(?.?.?) &mdash; <tt>(options &amp; copy_options::skip_existing) != copy_options::none</tt> 
and <tt>exists(t2)</tt> is <tt>true</tt>.</ins></p></li>
</ol>
</li>
<li><p><ins>(?.?) &mdash; Otherwise, report an error as specified in 29.11.6 <a href="https://timsong-cpp.github.io/cppwp/fs.err.report">[fs.err.report]</a> 
if:</ins></p>
<ol style="list-style-type: none">
<li><p><ins>(?.?.?) &mdash; <tt>is_other(f) || is_other(t2)</tt> is <tt>true</tt>, or</ins></p></li>
<li><p><ins>(?.?.?) &mdash; <tt>exists(t2) &amp;&amp; exists(from) == exists(to2) &amp;&amp; 
equivalent(from, to)</tt> is <tt>true</tt>.</ins></p></li>
</ol>
</li>
<li><p><ins>(?.?) &mdash; Otherwise, if <tt>is_directory(f)</tt> is <tt>true</tt>, then:</ins></p>
<ol style="list-style-type: none">
<li><p><ins>(?.?.?) &mdash; <tt>create_directory(to, from)</tt>.</ins></p></li>
<li><p><ins>(?.?.?) &mdash; If <tt>(options &amp; copy_options::recursive) != copy_options::none</tt> 
or if <tt>(options &amp; copy_options::directories_only) == copy_options::none</tt>, iterate over 
the files in <tt>from</tt>, as if by</ins></p>
<blockquote><pre>
<ins>for (const directory_entry&amp; x : directory_iterator(from))
  if ((options &amp; copy_options::recursive) != copy_options::none ||
     !is_directory(linkf ? symlink_status(x.path()) : status(x.path())))
       copy(x.path(), to/x.path().filename(), options);</ins>
</pre></blockquote>
</li>
</ol>
</li>
<li><p><ins>(?.?) &mdash; Otherwise, do nothing if <tt>(options &amp; copy_options::update_existing) 
!= copy_options::none, exists(to2)</tt> is <tt>true</tt>, and <tt>from</tt> is not more recent than 
<tt>to2</tt>, determined as if by use of the <tt>last_write_time</tt> function 
( [fs.op.last_write_time]).</ins></p></li>
<li><p><ins>(?.?) &mdash; Otherwise, report an error as specified in 29.11.6 <a href="https://timsong-cpp.github.io/cppwp/fs.err.report">[fs.err.report]</a> 
if:</ins></p>
<ol style="list-style-type: none">
<li><p><ins>(?.?.?) &mdash; <tt>is_directory(t2)</tt> is <tt>true</tt>, or</ins></p></li>
<li><p><ins>(?.?.?) &mdash; <tt>(options &amp; (copy_options::overwrite_existing |
copy_options::update_existing)) == copy_options::none</tt> and <tt>exists(t2)</tt> is <tt>true</tt>.</ins></p></li>
</ol>
</li>
<li><p><ins>(?.?) &mdash; Otherwise, if <tt>linkt</tt> is <tt>true</tt>, then:</ins></p>
<ol style="list-style-type: none">
<li><p><ins>(?.?.?) &mdash; <tt>remove(to2)</tt> if an existing <tt>to2</tt> would prevent the 
following link creation.</ins></p></li>
<li><p><ins>(?.?.?) &mdash; If <tt>(options &amp; copy_options::create_symlinks) 
!= copy_options::none</tt>, <tt>create_symlink(from, to2)</tt>. [<i>Note:</i> If <tt>from</tt> 
is a symbolic link, it is not followed. &mdash; <i>end note</i>]</ins></p></li>
<li><p><ins>(?.?.?) &mdash; Otherwise, if <tt>(options &amp; copy_options::create_hard_links) 
!= copy_options::none</tt>, then create a hard link to <tt>from</tt>, if <tt>linkf</tt> is <tt>true</tt>, 
or else to the file that <tt>from</tt> resolves to. [<i>Note:</i> Not all file systems that support 
hard links and symbolic links support creating hard links to symbolic links. &mdash; <i>end note</i>]</ins></p></li>
<li><p><ins>(?.?.?) &mdash; Otherwise, <tt>copy_symlink(from, to2)</tt>.</ins></p></li>
</ol>
</li>
<li><p><ins>(?.?) &mdash; Otherwise, <tt>copy_file(from, to2, options)</tt>.</ins></p></li>
</ol>
<p/>
-5- <i>Throws:</i> As specified in 29.11.6 <a href="https://timsong-cpp.github.io/cppwp/fs.err.report">[fs.err.report]</a>.
<p/>
-6- <i>Remarks:</i> For the signature with argument <tt>ec</tt>, any library functions called by the 
implementation shall have an <tt>error_code</tt> argument if applicable. <ins>If any such function fails, 
<tt>copy</tt> returns immediately without (further) modifying <tt>ec</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3059" href="3059">3059.</a> Wrong requirements for map-like associative container assignment?</h3>
<p><b>Section:</b> 22.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2018-02-05 <b>Last modified:</b> 2018-02-14 19:34:02 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#container.requirements">issues</a> in [container.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
What are the requirements for
</p>
<blockquote><pre>
a = b;
</pre></blockquote>
<p>
... where <tt>a</tt> and <tt>b</tt> are of map-like associative container type (<tt>map</tt>, 
<tt>multimap</tt>, <tt>unordered_map</tt>, <tt>unordered_multimap</tt>)?
<p/>
The general container requirements say just:
</p>
<blockquote><pre>
r = a  <i>// Postconditions: r == a</i>
</pre></blockquote>
<p>
(Incidentally, earlier in the table, there is a clear error: the general container requirements permit 
"<tt>a = rv</tt>" for assignment from an rvalue, but "<tt>a</tt>" here is a potentially-const container. 
Oops.) Oddly. there are no requirements at all on <tt>T</tt> here.
<p/>
The allocator-aware container requirements add:
</p>
<blockquote><pre>
a = t  <i>// Requires: T is CopyInsertable into X and CopyAssignable.</i>
</pre></blockquote>
<p>
... where <tt>T</tt> is the container's <tt>value_type</tt>, that is, <tt>pair&lt;const key_type, 
mapped_type&gt;</tt>. Note that such a pair is not <tt>CopyAssignable</tt> for "normal" key types 
that disallow assignment to <tt>const</tt> objects. They also add:
</p>
<blockquote><pre>
a = rv  <i>// Requires: if !POCMA, T is MoveInsertable into X and MoveAssignable.</i>
</pre></blockquote>
<p>
... which has the same problem in the !POCMA case.
<p/>
The associative container requirements and unordered associative container requirements have a similar problem for assignment from an initializer list:
</p>
<blockquote><pre>
a = il  <i>// Requires: value_type is CopyInsertable into X and CopyAssignable.</i>
</pre></blockquote>
<p>
Presumably these assignments are intended to actually work, but what are the intended constraints? 
Do we wish to allow implementations to perform node reuse for these map-like containers? 
Presumably yes, and if so, the <tt>key_type</tt> portion of the node must be assigned as well as the 
<tt>value_type</tt> portion (for instance, with whatever implementation technique is used to power 
<tt>node_handle</tt>) as we cannot assume that key equivalence (or, for <tt>unordered_*map</tt>, 
even key equality) implies substitutability.
<p/>
I think, then, that the associative container requirements and unordered associative container requirements should specify different requirements for the "<tt>a = t</tt>", "<tt>a = rv</tt>", and "<tt>a = il</tt>" for the map-like containers; specifically:
</p>
<ul>
<li><p>for "<tt>a = t</tt>" and "<tt>a = il</tt>", we should require that <tt>value_type</tt> is 
<tt>CopyInsertable</tt> into <tt>X</tt>, and <tt>key_type</tt> and <tt>mapped_type</tt> are 
<tt>CopyAssignable</tt></p></li>
<li><p>for "<tt>a = rv</tt>", if !POCMA, we should require that <tt>value_type</tt> is 
<tt>MoveInsertable</tt> into <tt>X</tt> and <tt>key_type</tt> and <tt>mapped_type</tt> are 
<tt>MoveAssignable</tt></p></li>
</ul>
<p>
(And we should fix the general container requirements to constrain "<tt>r = rv</tt>", not "<tt>a = rv</tt>".)
<p/>
<b>Daniel:</b>
<p/>
The "<tt>a = rv</tt>" problematic is already handled by LWG <a href="3028">3028</a>.
</p>

<p><i>[2018-02-13, Priority set to 3 after mailing list discussion]</i></p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3060" href="3060">3060.</a> <tt>XXX_scan</tt> algorithms are specified to work with move-only <tt>T</tt>, but are 
specified to make <tt><i>N</i></tt> copies of <tt>T</tt> into the destination range</h3>
<p><b>Section:</b> 25.9.7 <a href="https://timsong-cpp.github.io/cppwp/exclusive.scan">[exclusive.scan]</a>, 25.9.8 <a href="https://timsong-cpp.github.io/cppwp/inclusive.scan">[inclusive.scan]</a>, 25.9.9 <a href="https://timsong-cpp.github.io/cppwp/transform.exclusive.scan">[transform.exclusive.scan]</a>, 25.9.10 <a href="https://timsong-cpp.github.io/cppwp/transform.inclusive.scan">[transform.inclusive.scan]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-02-06 <b>Last modified:</b> 2019-01-20 16:20:00 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#exclusive.scan">issues</a> in [exclusive.scan].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
All of the scan algorithms ([exclusive.scan], [inclusive.scan], [transform.exclusive.scan], [transform.inclusive.scan]) have language like "If <tt>init</tt> is provided, <tt>T</tt> shall be 
<tt>MoveConstructible</tt> (Table 23); otherwise, <tt>ForwardIterator1</tt>'s value type shall be
<tt>MoveConstructible</tt>.". However, the algorithms operational semantics require that that type 
be written "by copy" to the destination range, making support for move only types impossible.
<p/>
We probably need to examine real implementations of these things and see what requirements are actually 
necessary, as in general <tt><i>GENERALIZED_SUM</i></tt> and <tt><i>GENERALIZED_NONCOMMUTATIVE_SUM</i></tt> 
need to specify the type used to store intermediate calculations.
</p>

<p><i>[2019-01-20 Reflector prioritization]</i></p>

<p>Set Priority to 2</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3063" href="3063">3063.</a> Parallel algorithms in <tt>&lt;memory&gt;</tt> are underspecified</h3>
<p><b>Section:</b> 20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2018-02-12 <b>Last modified:</b> 2018-03-03 15:15:50 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#specialized.algorithms">active issues</a> in [specialized.algorithms].</p>
<p><b>View all other</b> <a href="lwg-index.html#specialized.algorithms">issues</a> in [specialized.algorithms].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The parallel forms of the uninitialized memory algorithms in <tt>&lt;memory&gt;</tt> are
underspecified in two ways. First, they missed the change that all parallel
algorithms require at least Forward Iterators, even for input ranges. See
<a href="http://wg21.link/p0467r2">P0467R2</a> for more details.
<p/>
The second problem is that they do not have a separate specification to
the serial forms. This is a problem in two ways. First, there is no more
blanket wording saying a parallel policy algorithm has the same semantics
as the serial form unless otherwise specified, so in principle these algorithms
are totally unspecified. However, assuming that intent, all of the existing
specifications use an as-if formulation with code that is explicitly serial in
nature, so need a new specification that talks about the effects on each
element without including the iteration order.
</p>

<p><i>[2018-02-20, Priority set to 3 after mailing list discussion]</i></p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3064" href="3064">3064.</a> How do uninitialized memory algorithms obtain pointer without undefined behavior?</h3>
<p><b>Section:</b> 20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2018-02-12 <b>Last modified:</b> 2018-03-03 15:21:00 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#specialized.algorithms">active issues</a> in [specialized.algorithms].</p>
<p><b>View all other</b> <a href="lwg-index.html#specialized.algorithms">issues</a> in [specialized.algorithms].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
A typical specification of the algorithms for initializing raw memory in <tt>&lt;memory&gt;</tt> looks like:
</p>
<blockquote>
<p>
<i>Effects:</i> Equivalent to:
</p>
<blockquote><pre>
for (; first != last; ++first)
  ::new (static_cast&lt;void*&gt;(addressof(*first)))
    typename iterator_traits&lt;ForwardIterator&gt;::value_type;
</pre></blockquote>
</blockquote>
<p>
However, this hides a nasty question:
<p/>
How do we bind a reference to an uninitialized object when dereferencing our iterator,
so that <tt>static_cast&lt;void*&gt;(addressor(*first))</tt> does not trigger undefined behavior on
the call to <tt>*first</tt>?
<p/>
When pointers are the only iterators we cared about, we could simply cast the iterator
value to <tt>void*</tt> without dereferencing. I don't see how to implement this spec safely
without introducing another customization point for iterators that performs the same
function as casting a pointer to <tt>void*</tt> in order to get the address of the element.
</p>

<p><i>[2018-02-20, Priority set to 3 after mailing list discussion]</i></p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3066" href="3066">3066.</a> "report a domain error" in [sf.cmath]/1 is underspecified</h3>
<p><b>Section:</b> 26.8.6 <a href="https://timsong-cpp.github.io/cppwp/sf.cmath">[sf.cmath]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-02-17 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
26.8.6 <a href="https://timsong-cpp.github.io/cppwp/sf.cmath">[sf.cmath]</a>/1 uses the phrase "report a domain error" (emphasis mine):
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
<p>
If any argument value to any of the functions specified in this subclause is a NaN (Not a Number), the
function shall return a NaN but it shall not <b>report a domain error</b>. Otherwise, the function shall 
<b>report a domain error</b> for just those argument values for which:
</p>
<ul>
<li><p>the function description's <i>Returns:</i> clause explicitly specifies a domain and those argument 
values fall outside the specified domain, or</p></li>
<li><p>the corresponding mathematical function value has a nonzero imaginary component, or</p></li>
<li><p>the corresponding mathematical function is not mathematically defined.</p></li>
</ul>
</blockquote>
<p>
The behavior this phrase is attempting to convey is unclear. A quick search through the text of the 
standard for "domain error" finds only the <tt>domain_error</tt> exception type defined in 
19.2.3 <a href="https://timsong-cpp.github.io/cppwp/domain.error">[domain.error]</a>. Is the intent of "report a domain error" that the special math functions 
throw an exception of type <tt>domain_error</tt>, or is it that they behave as specified in C11 
7.12.1 "Treatment of error conditions" para 2 which defines the term "domain error"?
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3068" href="3068">3068.</a> Forbid assigning an rvalue <tt>basic_string</tt> to <tt>basic_string_view</tt></h3>
<p><b>Section:</b> 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Antony Polukhin <b>Opened:</b> 2018-02-19 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#string.view.template">issues</a> in [string.view.template].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It is known that we cannot disable move construction of
<tt>basic_string_view</tt> from rvalues of <tt>basic_string</tt>, because it breaks a
valid use case:
</p>
<blockquote><pre>
string foo();
void bar(string_view );
bar(foo());
</pre></blockquote>
<p>
Though it is still possible to disable an absolutely wrong case of
assigning an rvalue <tt>basic_string</tt> to <tt>basic_string_view</tt>:
</p>
<blockquote><pre>
string_view sw = "Hello";
sw = foo();
</pre></blockquote>
<p>
Some tests that make sure that other use cases are not affected are available 
<a href="https://raw.githubusercontent.com/apolukhin/apolukhin.github.io/master/papers/misc/safer_string_view_tests.cpp">here</a>
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 2; status to LEWG</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li><p>Change 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a>, class template <tt>basic_string_view</tt> synopsis, 
as indicated:</p>
<blockquote>
<pre>
[&hellip;]
<i>// 21.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/string.view.cons">[string.view.cons]</a>, construction and assignment</i>
constexpr basic_string_view() noexcept;
constexpr basic_string_view(const basic_string_view&amp;) noexcept = default;
constexpr basic_string_view&amp; operator=(const basic_string_view&amp;) noexcept = default;
<ins>template &lt;class A&gt;
basic_string_view&amp; operator=(const basic_string&lt;charT, traits, A&gt;&amp;&amp;) = delete;</ins>
constexpr basic_string_view(const charT* str);
constexpr basic_string_view(const charT* str, size_type len);
[&hellip;]
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3069" href="3069">3069.</a> Move assigning <tt>variant</tt>'s subobject corrupts data</h3>
<p><b>Section:</b> 20.7.3.3 <a href="https://timsong-cpp.github.io/cppwp/variant.assign">[variant.assign]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Antony Polukhin <b>Opened:</b> 2018-02-20 <b>Last modified:</b> 2018-06-19 13:02:31 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.assign">issues</a> in [variant.assign].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>variant::emplace</tt> functions in 20.7.3.4 <a href="https://timsong-cpp.github.io/cppwp/variant.mod">[variant.mod]</a> destroy the currently
contained value before initializing it to a new value. Assignments in 
20.7.3.3 <a href="https://timsong-cpp.github.io/cppwp/variant.assign">[variant.assign]</a> are described in terms on <tt>emplace</tt>.
<p/>
This leads to situation, when move/copy assigning subobject from <tt>variant</tt> into the same 
<tt>variant</tt> corrupts data:
</p>
<blockquote><pre>
#include &lt;variant&gt;
#include &lt;memory&gt;
#include &lt;iostream&gt;

using str_t = std::string;
using str_ptr_t = std::unique_ptr&lt;str_t&gt;;
using var_t = std::variant&lt;str_t, str_ptr_t&gt;;

int main() 
{
  var_t v = str_ptr_t{
    new str_t{"Long string that does not fit into SS buffer and forces dynamic allocation"}
  };

  // Any of the following lines corrupt the variant's content:
  v = *std::get&lt;str_ptr_t&gt;(v);
  //v = std::move(*std::get&lt;str_ptr_t&gt;(v));

  std::cout &lt;&lt; std::get&lt;str_t&gt;(v) &lt;&lt; std::endl; // SEGV - 'str_t' inside 'v' is invalid
}
</pre></blockquote>
<p>
Such behavior confuses users, especially those users who are used to
<tt>boost::variant</tt>'s behavior. Consider making <tt>variant</tt> assignments safer
by defining them close to copy-and-swap.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3; Antony volunteered to write a paper for Rapperswil.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li><p>Change 20.7.3.3 <a href="https://timsong-cpp.github.io/cppwp/variant.assign">[variant.assign]</a> as indicated:</p>
<blockquote>
<pre>
variant&amp; operator=(const variant&amp; rhs);
</pre>
<blockquote>
<p>
-1- Let <tt><i>j</i></tt> be <tt>rhs.index()</tt>.
<p/>
-2- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; If neither <tt>*this</tt> nor <tt>rhs</tt> holds a value, there is no effect.</p></li>
<li><p>(2.2) &mdash; Otherwise, if <tt>*this</tt> holds a value but <tt>rhs</tt> does not, 
destroys the value contained in <tt>*this</tt> and sets <tt>*this</tt> to not hold a value.</p></li>
<li><p>(2.3) &mdash; Otherwise, if <tt>index() == <i>j</i></tt>, assigns the value contained in <tt>rhs</tt> 
to the value contained in <tt>*this</tt>.</p></li>
<li><p><del>(2.4) &mdash; Otherwise, if either <tt>is_nothrow_copy_constructible_v&lt;T<sub><i>j</i></sub>&gt;</tt> 
is <tt>true</tt> or <tt>is_nothrow_move_constructible_v&lt;T<sub><i>j</i></sub>&gt;</tt> is 
<tt>false</tt>, equivalent to <tt>emplace&lt;<i>j</i>&gt;(get&lt;<i>j</i>&gt;(rhs))</tt>.</del></p></li>
<li><p>(2.5) &mdash; Otherwise, equivalent to <ins><tt>emplace&lt;<i>j</i>&gt;(T<sub><i>j</i></sub>{get&lt;<i>j</i>&gt;(rhs)})</tt></ins><del><tt>operator=(variant(rhs))</tt></del>.</p></li>
</ol>
[&hellip;]
</p>
</blockquote>
<pre>
variant&amp; operator=(variant&amp;&amp; rhs) noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-6- Let <tt><i>j</i></tt> be <tt>rhs.index()</tt>.
<p/>
-7- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(7.1) &mdash; If neither <tt>*this</tt> nor <tt>rhs</tt> holds a value, there is no effect.</p></li>
<li><p>(7.2) &mdash; Otherwise, if <tt>*this</tt> holds a value but <tt>rhs</tt> does not, 
destroys the value contained in <tt>*this</tt> and sets <tt>*this</tt> to not hold a value.</p></li>
<li><p>(7.3) &mdash; Otherwise, if <tt>index() == <i>j</i></tt>, assigns 
<tt>get&lt;<i>j</i>&gt;(std::move(rhs))</tt> to the value contained in <tt>*this</tt>.</p></li>
<li><p>(7.4) &mdash; Otherwise, equivalent to 
<tt>emplace&lt;<i>j</i>&gt;(<ins>T<sub><i>j</i></sub>{</ins>get&lt;<i>j</i>&gt;(std::move(rhs))<ins>}</ins>)</tt>.</p></li>
</ol>
[&hellip;]
</p>
</blockquote>
<pre>
</pre>
<blockquote>
<p>
-10- Let <tt>T<sub><i>j</i></sub></tt> be a type that is determined as follows: build an imaginary function 
<tt><i>FUN</i>(T<sub><i>i</i></sub>)</tt> for each alternative type <tt>T<sub><i>i</i></sub></tt>. The overload 
<tt><i>FUN</i>(T<sub><i>j</i></sub>)</tt> selected by overload resolution for the expression 
<tt><i>FUN</i>(std::forward&lt;T&gt;(t))</tt> defines the alternative <tt>T<sub><i>j</i></sub></tt> which is the 
type of the contained value after assignment.
<p/>
-11- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(11.1) &mdash; If <tt>*this</tt> holds a <tt>T<sub><i>j</i></sub></tt>, assigns 
<tt>std::forward&lt;T&gt;(t)</tt> to the value contained in <tt>*this</tt>.</p></li>
<li><p><del>(11.2) &mdash; Otherwise, if <tt>is_nothrow_constructible_v&lt;T<sub><i>j</i></sub>, T&gt; || !is_nothrow_move_constructible_v&lt;T<sub><i>j</i></sub>&gt;</tt> is <tt>true</tt>, equivalent to 
<tt>emplace&lt;<i>j</i>&gt;(std::forward&lt;T&gt;(t))</tt>.</del></p></li>
<li><p>(11.3) &mdash; Otherwise, equivalent to 
<tt><ins>emplace&lt;<i>j</i>&gt;(T<sub><i>j</i></sub>{std::forward&lt;T&gt;(t)})</ins><del>operator=(variant(std::forward&lt;T&gt;(t)))</del></tt>.</p></li>
</ol>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3072" href="3072">3072.</a> [networking.ts] <tt>DynamicBuffer</tt> object lifetimes underspecified</h3>
<p><b>Section:</b> 16.2.4 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.reqmts.dynamicbuffer">[networking.ts::buffer.reqmts.dynamicbuffer]</a>, 17.6 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read">[networking.ts::buffer.async.read]</a>, 17.8 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.write">[networking.ts::buffer.async.write]</a>, 17.10 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read.until">[networking.ts::buffer.async.read.until]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Christopher Kohlhoff <b>Opened:</b> 2018-02-26 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#networking.ts::buffer.reqmts.dynamicbuffer">active issues</a> in [networking.ts::buffer.reqmts.dynamicbuffer].</p>
<p><b>View all other</b> <a href="lwg-index.html#networking.ts::buffer.reqmts.dynamicbuffer">issues</a> in [networking.ts::buffer.reqmts.dynamicbuffer].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses: networking.ts</b>
<p>The <tt>DynamicBuffer</tt> overloads of <code>async_read</code> and <code>async_write</code>, and 
<code>async_read_until</code>, are underspecified with respect to the lifetime of the dynamic 
buffer argument <code>b</code>.</p>

<p>Asio's implementation (and the intended specification) performs <code><em>DECAY_COPY</em>(b)</code> 
in the <code>async_read</code>, <code>async_write</code>, and <code>async_read_until</code> 
initiating functions. All operations performed on <code>b</code> are actually performed on that 
decay-copy, or on a move-constructed descendant of it. The copy is intended to refer to the same 
underlying storage and be otherwise interchangeable with the original in every way.</p>

<p>Most initiating functions' argument lifetimes are covered by [async.reqmts.async.lifetime]. As 
an rvalue reference it falls under the second bullet, which specifies that the object is copied 
(but doesn't say decay-copied).</p>

<p>The proposed resolution adds a postcondition for <tt>DynamicBuffer</tt> move construction, and 
specifies that <code><em>DECAY_COPY</em>(b)</code> be used for each of these functions. The following 
two alternative resolutions may also be considered:</p>

<ul>
<li><p>Add an extra bullet to [async.reqmts.async.lifetime] to cover rvalue parameters (but specifically exclude CompletionTokens).</p></li>
<li><p>Change the <tt>DynamicBuffer</tt> arguments to be by-value. (And also change the corresponding synchronous operations to be consistent.)</p></li>
</ul>

<p>However, the proposed resolution below is presented as a change that minimizes the scope of the impact.</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4711">N4711</a>.
</p>

<ol>
<li>
<p>Edit 16.2.4 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.reqmts.dynamicbuffer">[networking.ts::buffer.reqmts.dynamicbuffer]</a> as indicated:</p>
<blockquote>
<p>-3- In Table 14, <code>x</code> denotes a value of type <code>X</code>, <code>x1</code> denotes a 
(possibly const) value of type <code>X</code>, <del>and</del><ins><code>mx1</code> denotes an 
xvalue of type <code>X</code>,</ins> <code>n</code> denotes a (possibly const) value of type 
<code>size_t</code><ins>, and <code>u</code> denotes an identifier</ins>.</p>

<table border="1">
<caption>Table 14 &mdash; DynamicBuffer requirements</caption>
<tr style="text-align:center">
<th>expression</th>
<th>type</th>
<th>assertion/note pre/post-conditions</th>
</tr>
<tr>
<td>
<ins><code>X u(mx1);</code></ins>
</td>
<td></td>
<td><ins><em>post:</em></ins>
<ul>
<li><ins><code>u.size()</code> is equal to the prior value of <code>mx1.size()</code>.</ins></li>
<li><ins><code>u.max_size()</code> is equal to the prior value of <code>mx1.max_size()</code>.</ins></li>
<li><ins><code>u.capacity()</code> is equal to the prior value of <code>mx1.capacity()</code>.</ins></li>
<li><ins><code>u.data()</code> satisfies the ConstBufferSequence requirements (16.2.2 [buffer.reqmts.constbuffersequence]) as if copy constructed from the prior value of <code>mx1.data()</code>.</ins></li>
<li><ins>All valid const or mutable buffer sequences that were previously obtained using <code>mx1.data()</code> or <code>mx1.prepare()</code> remain valid.</ins></li>
</ul>
</td>
</tr>
</table>
</blockquote>
</li>

<li>
<p>Edit 17.6 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read">[networking.ts::buffer.async.read]</a> as indicated:</p>
<blockquote>
<p>-11- <ins>Let <code>bd</code> be the result of <code><em>DECAY_COPY</em>(b)</code>.</ins> Data is placed into the dynamic buffer (16.2.4 [buffer.reqmts.dynamicbuffer]) object <code><del>b</del><ins>bd</ins></code>. A mutable buffer sequence (16.2.1 [buffer.reqmts.mutablebuffersequence]) is obtained prior to each <code>read_some</code> call using <code>b<ins>d</ins>.prepare(N)</code>, where <code>N</code> is an unspecified value less than or equal to <code>b<ins>d</ins>.max_size() - b<ins>d</ins>.size()</code>. [<em>Note:</em> Implementations are encouraged to use <code>b<ins>d</ins>.capacity()</code> when determining <code>N</code>, to minimize the number of <code>read_some</code> calls performed on the stream. <em>-- end note</em>] After each <code>read_some</code> call, the implementation performs <code>b<ins>d</ins>.commit(n)</code>, where <code>n</code> is the return value from <code>read_some</code>.</p>

<p><em>[&hellip;]</em></p>

<p>-13- The synchronous read operation continues until:</p>
<ul>
<li><p><code>b<ins>d</ins>.size() == b<ins>d</ins>.max_size()</code>; or</p></li>
<li><p>the completion condition returns <code>0</code>.</p></li>
</ul>
</blockquote>
</li>

<li>
<p>Edit 17.8 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.write">[networking.ts::buffer.async.write]</a> as indicated:</p>
<blockquote>
<p>-11- <ins>Let <code>bd</code> be the result of <code><em>DECAY_COPY</em>(b)</code>.</ins> Data is 
written from the dynamic buffer (16.2.4 [buffer.reqmts.dynamicbuffer]) object 
<code>b<ins>d</ins></code>. A constant buffer sequence (16.2.2 [buffer.reqmts.constbuffersequence]) 
is obtained using <code>b<ins>d</ins>.data()</code>. After the data has been written to the stream, 
the implementation performs <code>b<ins>d</ins>.consume(n)</code>, where <code>n</code> is the number 
of bytes successfully written.</p>

<p><em>[&hellip;]</em></p>

<p>-13- The asynchronous write operation continues until:</p>
<ul>
<li><p><code>b<ins>d</ins>.size() == 0</code>; or</p></li>
<li><p>the completion condition returns <code>0</code>.</p></li>
</ul>
</blockquote>
</li>

<li>
<p>Edit 17.10 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read.until">[networking.ts::buffer.async.read.until]</a> as indicated:</p>
<blockquote>
<p>-3- <em>Effects:</em> <ins>Let <code>bd</code> be the result of 
<code><em>DECAY_COPY</em>(b)</code>.</ins> Initiates an asynchronous operation to read data from 
the buffer-oriented asynchronous read stream (17.1.2 [buffer.stream.reqmts.asyncreadstream]) object 
<code>stream</code> by performing zero or more asynchronous read_some operations on the stream, until 
the readable bytes of the dynamic buffer (16.2.4 [buffer.reqmts.dynamicbuffer]) object 
<code>b<ins>d</ins></code> contain the specified delimiter <code>delim</code>.</p>

<p>-4- Data is placed into the dynamic buffer object <code>b<ins>d</ins></code>. A mutable buffer 
sequence (16.2.1 [buffer.reqmts.mutablebuffersequence]) is obtained prior to each 
<code>async_read_some</code> call using <code>b<ins>d</ins>.prepare(N)</code>, where <code>N</code> 
is an unspecified value such that <code>N &lt;= max_size() - size()</code>. [<em>Note:</em> 
Implementations are encouraged to use <code>b<ins>d</ins>.capacity()</code> when determining 
<code>N</code>, to minimize the number of asynchronous read_some operations performed on the 
stream. &mdash; <em>end note</em>] After the completion of each asynchronous <tt>read_some</tt> 
operation, the implementation performs <code>b<ins>d</ins>.commit(n)</code>, where <code>n</code> 
is the value passed to the asynchronous <tt>read_some</tt> operation's completion handler.</p>

<p>-5- The asynchronous <tt>read_until</tt> operation continues until:</p>
<ul>
<li><p>the readable bytes of <code>b<ins>d</ins></code> contain the delimiter <code>delim</code>; or</p></li>
<li><p><code>b<ins>d</ins>.size() == b<ins>d</ins>.max_size()</code>; or</p></li>
<li><p>an asynchronous <tt>read_some</tt> operation fails.</p></li>
</ul>

<p><em>[&hellip;]</em></p>

<p>-8- On completion of the asynchronous operation, if the readable bytes of <code>b<ins>d</ins></code> 
contain the delimiter, <code>ec</code> is set such that <code>!ec</code> is <code>true</code>. 
Otherwise, if <code>b<ins>d</ins>.size() == b<ins>d</ins>.max_size()</code>, <code>ec</code> is set such 
that <code>ec == stream_errc::not_found</code>. If <code>b<ins>d</ins>.size() &lt; 
b<ins>d</ins>.max_size()</code>, <code>ec</code> is the <code>error_code</code> from the most recent 
asynchronous <tt>read_some</tt> operation. <code>n</code> is the number of readable bytes in 
<code>b<ins>d</ins></code> up to and including the delimiter, if present, otherwise <code>0</code>.</p>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3073" href="3073">3073.</a> [networking.ts] (<tt>async_</tt>)<tt>read</tt> and (<tt>async_</tt>)<tt>write</tt> 
don't support <tt>DynamicBuffer</tt> lvalues</h3>
<p><b>Section:</b> 17 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.stream">[networking.ts::buffer.stream]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Christopher Kohlhoff <b>Opened:</b> 2018-02-27 <b>Last modified:</b> 2019-01-20 16:20:00 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses: networking.ts</b>
<p>Suppose that we have a user-defined class <code>dyn_buf</code> that satisfies the DynamicBuffer 
requirements ([buffer.reqmts.dynamicbuffer]), and is additionally copy-constructible. The following snippet compiles, as expected:</p>
<blockquote><pre>
dyn_buf b;
net::read_until(my_socket, b, "\n");
</pre></blockquote>
<p>However, this next snippet will not compile, when it should:</p>
<blockquote><pre>
dyn_buf b;
net::read(my_socket, b);
</pre></blockquote>

<p>This is due to:</p>
<ul>
<li>the <code>DynamicBuffer</code> template parameter being deduced as <code>dyn_buf&amp;</code>, and</li>
<li>the <code>read</code> overload being specified to not participate in overload resolution unless <code>is_dynamic_buffer_v&lt;DynamicBuffer&gt;</code> is <code>true</code>.</li>
</ul>

<p>This can fixed by changing the test to <code>is_dynamic_buffer_v&lt;decay_t&lt;DynamicBuffer&gt;&gt;</code>.</p>

<p><i>[2019-01-20 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4711">N4711</a>.
</p>

<ol>

<li>
<p>Edit 17.5 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.read">[networking.ts::buffer.read]</a> as indicated:</p>
<blockquote>
<p>-14- <em>Remarks:</em> This function shall not participate in overload resolution unless 
<code>is_dynamic_buffer_v&lt;<ins>decay_t&lt;</ins>DynamicBuffer<ins>&gt;</ins>&gt;</code> is 
<code>true</code>.</p>
</blockquote>
</li>

<li>
<p>Edit 17.6 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read">[networking.ts::buffer.async.read]</a> as indicated:</p>
<blockquote>
<p>-16- <em>Remarks:</em> This function shall not participate in overload resolution unless 
<code>is_dynamic_buffer_v&lt;<ins>decay_t&lt;</ins>DynamicBuffer<ins>&gt;</ins>&gt;</code> is 
<code>true</code>.</p>
</blockquote>
</li>

<li>
<p>Edit 17.7 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.write">[networking.ts::buffer.write]</a> as indicated:</p>
<blockquote>
<p>-14- <em>Remarks:</em> This function shall not participate in overload resolution unless 
<code>is_dynamic_buffer_v&lt;<ins>decay_t&lt;</ins>DynamicBuffer<ins>&gt;</ins>&gt;</code> is 
<code>true</code>.</p>
</blockquote>
</li>

<li>
<p>Edit 17.8 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.write">[networking.ts::buffer.async.write]</a> as indicated:</p>
<blockquote>
<p>-16- <em>Remarks:</em> This function shall not participate in overload resolution unless 
<code>is_dynamic_buffer_v&lt;<ins>decay_t&lt;</ins>DynamicBuffer<ins>&gt;</ins>&gt;</code> is 
<code>true</code>.</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3078" href="3078">3078.</a> <tt>directory_entry</tt>, <tt>directory_iterator</tt> and <tt>recursive_directory_iterator</tt> perform needless path copies</h3>
<p><b>Section:</b> 29.11.11 <a href="https://timsong-cpp.github.io/cppwp/fs.class.directory.entry">[fs.class.directory.entry]</a>, 29.11.12 <a href="https://timsong-cpp.github.io/cppwp/fs.class.directory.iterator">[fs.class.directory.iterator]</a>, 29.11.13 <a href="https://timsong-cpp.github.io/cppwp/fs.class.rec.dir.itr">[fs.class.rec.dir.itr]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Gor Nishanov <b>Opened:</b> 2018-03-05 <b>Last modified:</b> 2019-04-02 17:52:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#fs.class.directory.entry">active issues</a> in [fs.class.directory.entry].</p>
<p><b>View all other</b> <a href="lwg-index.html#fs.class.directory.entry">issues</a> in [fs.class.directory.entry].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
An implementation of <tt>directory_entry</tt> class is likely to store a <tt>filesystem::path</tt> as a member.
Constructors and assign member functions take <tt>filesystem::path</tt> by <tt>const&amp;</tt> thus forcing 
creation of a copy.
<p/>
An implementation of <tt>directory_iterator</tt> class is likely to store a <tt>directory_entry</tt> or a 
<tt>path</tt> as a part of its state. Constructors take <tt>filesystem::path</tt> by <tt>const&amp;</tt> 
thus forcing creation of a copy.
<p/>
An implementation of <tt>recursive_directory_iterator</tt> class is likely to store a <tt>directory_entry</tt> 
or a <tt>path</tt> as a part of its state. Constructors take <tt>filesystem::path</tt> by <tt>const&amp;</tt> 
thus forcing creation of a copy. 
<p/>
Suggested resolution:
<p/>
Add overloads to <tt>directory_entry</tt>, <tt>directory_iterator</tt>, and <tt>recursive_directory_iterator</tt>
that take <tt>filesystem::path</tt> by <tt>&amp;&amp;</tt>.
<p/>
Make it unspecified in case an exception is thrown from those new members where an argument was moved from or not.
</p>
<blockquote><pre>
explicit directory_entry(const filesystem::path&amp; p);
<ins>explicit directory_entry(filesystem::path&amp;&amp; p);</ins>
directory_entry(const filesystem::path&amp; p, error_code&amp; ec);
<ins>directory_entry(filesystem::path&amp;&amp; p, error_code&amp; ec);</ins>

void directory_entry::assign(const filesystem::path&amp; p);
<ins>void directory_entry::assign(filesystem::path&amp;&amp; p);</ins>
void directory_entry::assign(const filesystem::path&amp; p, error_code&amp; ec);
<ins>void directory_entry::assign(filesystem::path&amp;&amp; p, error_code&amp; ec);</ins>

explicit directory_iterator(const path&amp; p);
<ins>explicit directory_iterator(path&amp;&amp; p);</ins>
directory_iterator(const path&amp; p, directory_options options);
<ins>directory_iterator(path&amp;&amp; p, directory_options options);</ins>
directory_iterator(const path&amp; p, error_code&amp; ec) noexcept;
<ins>directory_iterator(path&amp;&amp; p, error_code&amp; ec) noexcept;</ins>
directory_iterator(const path&amp; p, directory_options options, error_code&amp; ec) noexcept;
<ins>directory_iterator(path&amp;&amp; p, directory_options options, error_code&amp; ec) noexcept;</ins>

explicit recursive_directory_iterator(const path&amp; p);
<ins>explicit recursive_directory_iterator(path&amp;&amp; p);</ins>
recursive_directory_iterator(const path&amp; p, directory_options options);
<ins>recursive_directory_iterator(path&amp;&amp; p, directory_options options);</ins>
recursive_directory_iterator(const path&amp; p, directory_options options, error_code&amp; ec) noexcept;
<ins>recursive_directory_iterator(path&amp;&amp; p, directory_options options, error_code&amp; ec) noexcept;</ins>
recursive_directory_iterator(const path&amp; p, error_code&amp; ec) noexcept;
<ins>recursive_directory_iterator(path&amp;&amp; p, error_code&amp; ec) noexcept;</ins>
</pre></blockquote>

<p><i>[2018-03-20 Priority set to 3 after discussion on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3081" href="3081">3081.</a> Floating point <tt>from_chars</tt> API does not distinguish between overflow and underflow</h3>
<p><b>Section:</b> 20.19.3 <a href="https://timsong-cpp.github.io/cppwp/charconv.from.chars">[charconv.from.chars]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Greg Falcon <b>Opened:</b> 2018-03-12 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#charconv.from.chars">active issues</a> in [charconv.from.chars].</p>
<p><b>View all other</b> <a href="lwg-index.html#charconv.from.chars">issues</a> in [charconv.from.chars].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>strtod()</tt> distinguishes between overflow and underflow by returning a value that is either 
very large or very small. Floating point <tt>from_chars</tt> does not currently offer any way for 
callers to distinguish these two cases.
<p/>
It would be beneficial if users could migrate from <tt>strtod()</tt> to <tt>from_chars</tt> without 
loss of functionality.
<p/>
I recommend that floating point <tt>from_chars</tt> use <tt>value</tt> as an overflow-vs-underflow 
reporting channel, in the same manner as <tt>strtod()</tt>.
<p/>
My proposed wording gives <tt>from_chars</tt> the same wide latitude that <tt>strtod()</tt> enjoys 
for handling underflow. A high-quality implementation would likely set <tt>ec == result_out_of_range</tt> 
for underflow only when the nearest representable <tt>float</tt> to the parsed value is a zero and 
the parsed mantissa was nonzero. In this case <tt>value</tt> would be set to (an appropriately-signed) zero. 
It is worth considering giving <tt>from_chars</tt> this more predictable behavior, if library writers 
feel they can provide this guarantee for all platforms. (I have a proof-of-concept integer-based 
implementation for IEEE doubles with this property.)
</p>

<p><i>[2018-06 Rapperswil Wednesday issues processing]</i></p>

<p>Marshall to provide updated wording and propose Tentatively Ready on the reflector.</p>
<p>Priority set to 2</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Status to Open; Marshall to reword</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li>
<p>Edit 20.19.3 <a href="https://timsong-cpp.github.io/cppwp/charconv.from.chars">[charconv.from.chars]</a> as indicated:</p>
<blockquote>
<p>
[&hellip;] Otherwise, the characters matching the pattern are interpreted as a representation
of a value of the type of <tt>value</tt>. The member <tt>ptr</tt> of the return value points 
to the first character not matching the pattern, or has the value <tt>last</tt> if all characters 
match. If the parsed value is not in the range representable by the type of <tt>value</tt>, 
<del><tt>value</tt> is unmodified and</del> the member <tt>ec</tt> of the return value is equal
to <tt>errc::result_out_of_range</tt>. Otherwise, <tt>value</tt> is set to the parsed value, 
after rounding according to <tt>round_to_nearest</tt> (17.3.4.1 <a href="https://timsong-cpp.github.io/cppwp/round.style">[round.style]</a>), and the member 
<tt>ec</tt> is value-initialized.
</p>
<pre>
from_chars_result from_chars(const char* first, const char* last,
                             <i>see below</i>&amp; value, int base = 10);
</pre>
<blockquote>
<p>
-2- <i>Requires:</i> <tt>base</tt> has a value between 2 and 36 (inclusive).
<p/>
-3- <i>Effects:</i> The pattern is the expected form of the subject sequence in the <tt>"C"</tt> 
locale for the given nonzero base, as described for <tt>strtol</tt>, except that no <tt>"0x"</tt> 
or <tt>"0X"</tt> prefix shall appear if the value of <tt>base</tt> is 16, and except that <tt>'-'</tt> is 
the only sign that may appear, and only if <tt>value</tt> has a signed type. <ins>On overflow, 
<tt>value</tt> is unmodified.</ins>
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
from_chars_result from_chars(const char* first, const char* last, float&amp; value,
                             chars_format fmt = chars_format::general);
from_chars_result from_chars(const char* first, const char* last, double&amp; value,
                             chars_format fmt = chars_format::general);
from_chars_result from_chars(const char* first, const char* last, long double&amp; value,
                             chars_format fmt = chars_format::general);
</pre>
<blockquote>
<p>
-6- <i>Requires:</i> <tt>fmt</tt> has the value of one of the enumerators of <tt>chars_format</tt>.
<p/>
-7- <i>Effects:</i> The pattern is the expected form of the subject sequence in the <tt>"C"</tt> 
locale, as described for <tt>strtod</tt>, except that
</p>
<ol style="list-style-type: none">
<li><p>(7.1) [&hellip;]</p></li>
<li><p>(7.2) [&hellip;]</p></li>
<li><p>(7.3) [&hellip;]</p></li>
<li><p>(7.4) [&hellip;]</p></li>
</ol>
<p>
In any case, the resulting value is one of at most two floating-point values closest to the value of the
string matching the pattern. <ins>On overflow, <tt>value</tt> is set to plus or minus 
<tt>std::numeric_limits&lt;T&gt;::max()</tt> of the appropriate type. On underflow, <tt>value</tt> 
is set to a value with magnitude no greater than <tt>std::numeric_limits&lt;T&gt;::min()</tt>.</ins>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3082" href="3082">3082.</a> <tt>from_chars</tt> specification regarding floating point rounding is inconsistent</h3>
<p><b>Section:</b> 20.19.3 <a href="https://timsong-cpp.github.io/cppwp/charconv.from.chars">[charconv.from.chars]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Greg Falcon <b>Opened:</b> 2018-03-12 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#charconv.from.chars">active issues</a> in [charconv.from.chars].</p>
<p><b>View all other</b> <a href="lwg-index.html#charconv.from.chars">issues</a> in [charconv.from.chars].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/p0682r1">P0682R1</a> added the requirement that <tt>from_chars</tt> use 
<tt>round_to_nearest</tt> when converting from string, but later text in the section suggests that 
the implementation has latitude in its choice of rounding logic.
<p/>
If the intent is merely that the floating point environment should not affect <tt>from_chars</tt> behavior, 
the rounding-mode text should be weakened. If the intent is to always require <tt>round_to_nearest</tt>, 
the text suggesting a latitude in rounding logic should be removed.
</p>

<p><i>[2018-03-27 Priority set to 2 after discussion on the reflector.]</i></p>


<p><i>[2018-06 Rapperswil Wednesday issues processing]</i></p>

<p>Status to open; also this needs to say that the intent is to be independent of the floating point environment.</p>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Marshall to talk to Jens about this</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li>
<p>Edit 20.19.3 <a href="https://timsong-cpp.github.io/cppwp/charconv.from.chars">[charconv.from.chars]</a> as indicated:</p>
<blockquote>
<pre>
from_chars_result from_chars(const char* first, const char* last, float&amp; value,
                             chars_format fmt = chars_format::general);
from_chars_result from_chars(const char* first, const char* last, double&amp; value,
                             chars_format fmt = chars_format::general);
from_chars_result from_chars(const char* first, const char* last, long double&amp; value,
                             chars_format fmt = chars_format::general);
</pre>
<blockquote>
<p>
-6- <i>Requires:</i> <tt>fmt</tt> has the value of one of the enumerators of <tt>chars_format</tt>.
<p/>
-7- <i>Effects:</i> The pattern is the expected form of the subject sequence in the <tt>"C"</tt> 
locale, as described for <tt>strtod</tt>, except that
</p>
<ol style="list-style-type: none">
<li><p>(7.1) [&hellip;]</p></li>
<li><p>(7.2) [&hellip;]</p></li>
<li><p>(7.3) [&hellip;]</p></li>
<li><p>(7.4) [&hellip;]</p></li>
</ol>
<p>
In any case, the resulting value is <del>one of at most two</del><ins>the</ins> floating-point 
value<del>s</del> closest to the value of the string matching the pattern<ins>, with ties broken 
according to <tt>round_to_nearest</tt></ins>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3084" href="3084">3084.</a> Termination in C++ is unclear</h3>
<p><b>Section:</b> 17.5 <a href="https://timsong-cpp.github.io/cppwp/support.start.term">[support.start.term]</a>, 17.9.4 <a href="https://timsong-cpp.github.io/cppwp/exception.terminate">[exception.terminate]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> JF Bastien  <b>Opened:</b> 2018-03-15 <b>Last modified:</b> 2018-04-03 18:56:45 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#support.start.term">active issues</a> in [support.start.term].</p>
<p><b>View all other</b> <a href="lwg-index.html#support.start.term">issues</a> in [support.start.term].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It's unclear how different termination facilities in C++ interact (and how they interact with the C 
termination facilities). Individually some of these functions try to handle corner cases, but hilarity 
ensues when combined with each other. As a simple example, can an <tt>atexit</tt> handler call <tt>exit</tt>? 
If not, can it call <tt>quick_exit</tt>, and can then <tt>at_quick_exit</tt> handler call <tt>exit</tt>? 
Is it possible to install an <tt>atexit</tt> handler from an <tt>at_quick_exit</tt>, without strongly 
happens before, while handling a separate <tt>atexit</tt> handler (and what happens then)?
<p/>
The termination handlers and termination conditions I collected:
</p>
<ul>
<li><p>returning from <tt>main</tt> calls <tt>atexit</tt> handlers.</p></li>
<li><p><tt>atexit</tt> / <tt>exit</tt></p></li>
<li><p><tt>at_quick_exit</tt> / <tt>quick_exit</tt></p></li>
<li><p><tt>set_terminate</tt></p></li>
<li><p>violating <tt>noexcept</tt> and other things that call <tt>std::terminate</tt> (see 
<tt>[except.terminate]</tt>)</p></li>
<li><p>violating exception specification</p></li>
<li><p>parallel algorithms leaving with uncaught exception</p></li>
<li><p>some <tt>std::signal</tt> such as <tt>SIGTERM</tt>, <tt>SIGSEGV</tt>, <tt>SIGINT</tt>, 
<tt>SIGILL</tt>, <tt>SIGABRT</tt>, and (maybe?) <tt>SIGFPE</tt>.</p></li>
<li><p><tt>set_unexpected</tt> (now a zombie)</p></li>
<li><p><tt>unexpected_handler</tt> (now a zombie)</p></li>
</ul>
<p>
What's unclear is:
</p>
<ul>
<li><p>Is termination handling a DAG?</p></li>
<li><p>Which thread(s) are termination handlers called on?</p></li>
<li><p>Is program termination Turing complete?</p></li>
</ul>
<p>
I've written a sample program which exercises some of this, see 
<a href="https://github.com/jfbastien/terminator/blob/master/terminator.cc">here</a>.
</p>

<p><i>[2018-04-02, Jens comments]</i></p>

<p>
Any potential wording should carefully take [basic.start] into account, and maybe should actually be integrated 
into the core wording, not the library wording.
</p>

<p><i>[2018-04-02 Priority set to 3 after discussion on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3085" href="3085">3085.</a> <tt>char_traits::copy</tt> precondition too weak</h3>
<p><b>Section:</b> 21.2.1 <a href="https://timsong-cpp.github.io/cppwp/char.traits.require">[char.traits.require]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-03-16 <b>Last modified:</b> 2018-08-24 13:31:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#char.traits.require">issues</a> in [char.traits.require].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Table 54, Character traits requirements, says that <tt>char_traits::move</tt> allows the ranges to overlap, 
but <tt>char_traits::copy</tt> requires that <tt>p</tt> is not in the range <tt>[s, s + n)</tt>. This 
appears to be an attempt to map to the requirements of <tt>memmove</tt> and <tt>memcpy</tt> respectively,
allowing those to be used to implement the functions, however the requirements for <tt>copy</tt> are 
weaker than those for <tt>memcpy</tt>. The C standard says for <tt>memcpy</tt> "If copying takes place 
between objects that overlap, the behavior is undefined" which is a stronger requirement than the start 
of the source range not being in the destination range.
<p/>
All of libstdc++, libc++ and VC++ simply use <tt>memcpy</tt> for <tt>char_traits&lt;char&gt;::copy</tt>, 
resulting in undefined behaviour in this example:
</p>
<blockquote><pre>
char p[] = "abc";
char* s = p + 1;
std::char_traits&lt;char&gt;::copy(s, p, 2);
assert(std::char_traits&lt;char&gt;::compare(p, "aab", 3) == 0);
</pre></blockquote>
<p>
If the intention is to allow <tt>memcpy</tt> as a valid implementation then the precondition is 
wrong (unfortunately nobody realized this when fixing <tt>char_traits::move</tt> in LWG DR <a href="7">7</a>). 
If the intention is to require <tt>memmove</tt> then it is strange to have separate <tt>copy</tt> and 
<tt>move</tt> functions that both use <tt>memmove</tt>.
<p/>
N.B. <tt>std::copy</tt> and <tt>std::copy_backward</tt> are not valid implementations of 
<tt>char_traits::copy</tt> either, due to different preconditions.
<p/>
Changing the precondition implicitly applies to <tt>basic_string::copy</tt> (21.3.2.6.7 <a href="https://timsong-cpp.github.io/cppwp/string.copy">[string.copy]</a>), 
and <tt>basic_string_view::copy</tt> (21.4.2.6 <a href="https://timsong-cpp.github.io/cppwp/string.view.ops">[string.view.ops]</a>), which are currently required 
to support partially overlapping ranges:
</p>
<blockquote><pre>
std::string s = "abc";
s.copy(s.data() + 1, s.length() - 1);
assert(s == "aab");
</pre></blockquote>

<p><i>[2018-04-03 Priority set to 2 after discussion on the reflector.]</i></p>


<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>No consensus for direction; revisit in San Diego. Status to Open.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<p>
Option A:
</p>
<blockquote>
<ol>
<li>
<p>Edit 21.2.1 <a href="https://timsong-cpp.github.io/cppwp/char.traits.require">[char.traits.require]</a>, Table 54 &mdash; "Character traits requirements", as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 54 &mdash; Character traits requirements</caption>
<tr style="text-align:center">
<th>Expression</th>
<th>Return type</th>
<th>Assertion/note<br/>pre/post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>X::copy(s,p,n)</tt>
</td>
<td>
<tt>X::char_type*</tt>
</td>
<td>
<i>Requires:</i> <del><tt>p</tt> not in <tt>[s,s+n)</tt></del><ins>The ranges <tt>[p,p+n)</tt><br/>
and <tt>[s,s+n)</tt> do not overlap</ins>.<br/>
<i>Returns:</i> <tt>s</tt>.<br/>
for each <tt>i</tt> in <tt>[0,n)</tt>, performs<br/>
<tt>X::assign(s[i],p[i])</tt>.
</td>
<td>
linear
</td>
</tr>
<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>

</blockquote>
</li>
</ol>
</blockquote>

<p>
Option B:
</p>
<blockquote>
<p>NAD (i.e. implementations need to be fixed, in practice <tt>char_traits::copy</tt> and 
<tt>char_traits::move</tt> might be equivalent).
</p>
</blockquote>





<hr>
<h3><a name="3086" href="3086">3086.</a> Possible problem in &sect;[new.delete.single]</h3>
<p><b>Section:</b> 17.6.2.1 <a href="https://timsong-cpp.github.io/cppwp/new.delete.single">[new.delete.single]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> William M. Miller <b>Opened:</b> 2018-03-16 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#new.delete.single">active issues</a> in [new.delete.single].</p>
<p><b>View all other</b> <a href="lwg-index.html#new.delete.single">issues</a> in [new.delete.single].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In general requirements on a whole program, as opposed to a single translation unit, generally specify 
"no diagnostic required", since we don't want to require implementations to do multi-translation-unit 
analysis. However, 17.6.2.1 <a href="https://timsong-cpp.github.io/cppwp/new.delete.single">[new.delete.single]</a> paragraph 11 says,
</p>
<blockquote><p>
If a function with a <tt>size</tt> parameter is defined, the program shall also define the corresponding 
version without the <tt>size</tt> parameter.
</p></blockquote>
<p>
This is clearly not restricted to a single translation unit; should "no diagnostic required" be added?
</p>

<p><i>[2018-04-03; Thomas K&ouml;ppe and Tim Song suggest wording]</i></p>


<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li><p>Edit 17.6.2.1 <a href="https://timsong-cpp.github.io/cppwp/new.delete.single">[new.delete.single]</a> as indicated:</p>
<blockquote>
<pre>
void operator delete(void* ptr) noexcept;
void operator delete(void* ptr, std::size_t size) noexcept;
void operator delete(void* ptr, std::align_val_t alignment) noexcept;
void operator delete(void* ptr, std::size_t size, std::align_val_t alignment) noexcept;
</pre>
<blockquote>
<p>
-10- <i>Effects:</i> [&hellip;]
<p/>
-11- <i>Replaceable:</i> A C++ program may define functions with any of these function signatures, and thereby
displace the default versions defined by the C++ standard library. If a function without a <tt>size</tt> parameter
is defined, the program should also define the corresponding function with a <tt>size</tt> parameter. If a
function with a <tt>size</tt> parameter is defined, the program shall also define the corresponding version
without the <tt>size</tt> parameter<ins>; no diagnostic is required</ins>. [<i>Note:</i> The default behavior 
below may change in the future, which will require replacing both deallocation functions when replacing the 
allocation function. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Edit 17.6.2.2 <a href="https://timsong-cpp.github.io/cppwp/new.delete.array">[new.delete.array]</a> as indicated:</p>
<blockquote>
<pre>
void operator delete[](void* ptr) noexcept;
void operator delete[](void* ptr, std::size_t size) noexcept;
void operator delete[](void* ptr, std::align_val_t alignment) noexcept;
void operator delete[](void* ptr, std::size_t size, std::align_val_t alignment) noexcept;
</pre>
<blockquote>
<p>
-9- <i>Effects:</i> [&hellip;]
<p/>
-10- <i>Replaceable:</i> A C++ program may define functions with any of these function signatures, and thereby
displace the default versions defined by the C++ standard library. If a function without a <tt>size</tt> parameter
is defined, the program should also define the corresponding function with a <tt>size</tt> parameter. If a
function with a <tt>size</tt> parameter is defined, the program shall also define the corresponding version
without the <tt>size</tt> parameter<ins>; no diagnostic is required</ins>. [<i>Note:</i> The default behavior 
below may change in the future, which will require replacing both deallocation functions when replacing the 
allocation function. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3088" href="3088">3088.</a> <tt>forward_list::merge</tt> behavior unclear when passed <tt>*this</tt></h3>
<p><b>Section:</b> 22.3.9.6 <a href="https://timsong-cpp.github.io/cppwp/forwardlist.ops">[forwardlist.ops]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2018-03-19 <b>Last modified:</b> 2019-07-30 12:00:34 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#forwardlist.ops">issues</a> in [forwardlist.ops].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="300">300</a> changed <tt>list::merge</tt> to be a no-op when passed <tt>*this</tt>, but there's
no equivalent rule for <tt>forward_list::merge</tt>.
Presumably the <tt>forward_list</tt> proposal predated the adoption of LWG 300's PR and was never updated 
for the change. Everything in the discussion of that issue applies mutatis mutandis to the current 
specification of <tt>forward_list::merge</tt>.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>

<p><i>[2019-07-30 Tim provides updated PR]</i></p>

<p>Per the comments during issue prioritization, the new PR tries to synchronize the wording
between <tt>list::merge</tt> and <tt>forward_list::merge</tt>.</p>
<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.</p>

<ol>
<li><p>Edit 22.3.9.6 <a href="https://timsong-cpp.github.io/cppwp/forwardlist.ops">[forwardlist.ops]</a> as indicated:</p>
<blockquote>
<pre>
void merge(forward_list&amp; x);
void merge(forward_list&amp;&amp; x);
template&lt;class Compare&gt; void merge(forward_list&amp; x, Compare comp);
template&lt;class Compare&gt; void merge(forward_list&amp;&amp; x, Compare comp);
</pre>
<blockquote>
<p>
-20- <i>Requires:</i> <tt>*this</tt> and <tt>x</tt> are both sorted with respect to the comparator 
<tt>operator&lt;</tt> (for the first two overloads) or <tt>comp</tt> (for the last two overloads), 
and <tt>get_allocator() == x.get_allocator()</tt> is <tt>true</tt>.
<p/>
-21- <i>Effects:</i> <ins>If <tt>addressof(x) == this</tt>, does nothing. Otherwise, 
m</ins><del>M</del>erges the two sorted ranges <tt>[begin(), end())</tt> and <tt>[x.begin(), x.end())</tt>. 
<ins>The result is a range that is sorted with respect to the comparator <tt>operator&lt;</tt> 
(for the first two overloads) or <tt>comp</tt> (for the last two overloads).</ins> <tt>x</tt> is 
empty after the merge. If an exception is thrown other than by a comparison there are no effects.
Pointers and references to the moved elements of <tt>x</tt> now refer to those same elements but 
as members of <tt>*this</tt>. Iterators referring to the moved elements will continue to refer to 
their elements, but they now behave as iterators into <tt>*this</tt>, not into <tt>x</tt>.
<p/>
-22- <i>Remarks:</i> Stable (16.5.5.8 <a href="https://timsong-cpp.github.io/cppwp/algorithm.stable">[algorithm.stable]</a>). The behavior is undefined if 
<tt>get_allocator() != x.get_allocator()</tt>.
<p/>
-23- <i>Complexity:</i> At most <tt>distance(begin(), end()) + distance(x.begin(), x.end()) - 1</tt> 
comparisons <ins>if <tt>addressof(x) != this</tt>; otherwise, no comparisons are performed</ins>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4727">N4820</a>.</p>

<ol>
<li><p>Edit 22.3.9.6 <a href="https://timsong-cpp.github.io/cppwp/forwardlist.ops">[forwardlist.ops]</a> as indicated:</p>
<blockquote>
<pre>
void merge(forward_list&amp; x);
void merge(forward_list&amp;&amp; x);
template&lt;class Compare&gt; void merge(forward_list&amp; x, Compare comp);
template&lt;class Compare&gt; void merge(forward_list&amp;&amp; x, Compare comp);
</pre>
<blockquote>
<p>
<ins>-?- Let <tt>comp</tt> be <tt>less&lt;&gt;{}</tt> for the first two overloads.</ins>
<p/>
-22- <i>Expects:</i> <tt>*this</tt> and <tt>x</tt> are both sorted with respect to the comparator 
<del><tt>operator&lt;</tt> (for the first two overloads) or</del> <tt>comp</tt>
<del> (for the last two overloads)</del>, 
and <tt>get_allocator() == x.get_allocator()</tt> is <tt>true</tt>.
<p/>
-23- <i>Effects:</i> <ins>If <tt>addressof(x) == this</tt>, there are no effects. Otherwise, 
m</ins><del>M</del>erges the two sorted ranges <tt>[begin(), end())</tt> and <tt>[x.begin(), x.end())</tt>. 
<ins>The result is a range that is sorted with respect to the comparator <tt>comp</tt>.</ins> <del><tt>x</tt> is 
empty after the merge. If an exception is thrown other than by a comparison there are no effects.</del>
Pointers and references to the moved elements of <tt>x</tt> now refer to those same elements but 
as members of <tt>*this</tt>. Iterators referring to the moved elements will continue to refer to 
their elements, but they now behave as iterators into <tt>*this</tt>, not into <tt>x</tt>.
<p/>
-24- <i>Remarks:</i> Stable (16.5.5.8 <a href="https://timsong-cpp.github.io/cppwp/algorithm.stable">[algorithm.stable]</a>). <ins>If <tt>addressof(x) != this</tt>,
<tt>x</tt> is empty after the merge. No elements are copied by this operation.
If an exception is thrown other than by a comparison there are no effects.</ins>
<p/>
-25- <i>Complexity:</i> At most <tt>distance(begin(), end()) + distance(x.begin(), x.end()) - 1</tt> 
comparisons <ins>if <tt>addressof(x) != this</tt>; otherwise, no comparisons are performed</ins>.
</p>
</blockquote>
</blockquote>
</li>
<li><p>Edit 22.3.10.5 <a href="https://timsong-cpp.github.io/cppwp/list.ops">[list.ops]</a> as indicated:</p>
<blockquote>
<pre>
void merge(list&amp; x);
void merge(list&amp;&amp; x);
template&lt;class Compare&gt; void merge(list&amp; x, Compare comp);
template&lt;class Compare&gt; void merge(list&amp;&amp; x, Compare comp);
</pre>
<blockquote>
<p>
<ins>-?- Let <tt>comp</tt> be <tt>less&lt;&gt;{}</tt> for the first two overloads.</ins>
<p/>
-24- <i>Expects:</i> <del>Both the list and the argument list shall be</del><ins><tt>*this</tt> and <tt>x</tt> are both</ins>
sorted with respect to the comparator <del><tt>operator&lt;</tt>
(for the first two overloads) or </del><tt>comp</tt><del> (for the last two overloads).</del><ins>, and</ins>
<tt>get_allocator() != x.get_allocator()</tt> is <tt>true</tt>.
<p/>
-25- <i>Effects:</i> If <tt>addressof(x) == this</tt>, <del>does nothing; o</del><ins>there are no effects. O</ins>therwise,
merges the two sorted ranges <tt>[begin(), end())</tt> and <tt>[x.begin(), x.end())</tt>.
The result is a range <del>in which the elements will be sorted in non-decreasing order according to the ordering 
defined by <tt>comp</tt>; that is, for every iterator <tt>i</tt>, in the range other than the first, the condition
<tt>comp(*i, *(i - 1))</tt> will be <tt>false</tt></del><ins>that is sorted with respect to the comparator
<tt>comp</tt></ins>. Pointers and references to the moved elements of <tt>x</tt> now refer to those same elements 
but as members of <tt>*this</tt>. Iterators referring to the moved elements will continue to refer to their elements,
but they now behave as iterators into <tt>*this</tt>, not into <tt>x</tt>.
<p/>
-26- <i>Remarks:</i> Stable (16.5.5.8 <a href="https://timsong-cpp.github.io/cppwp/algorithm.stable">[algorithm.stable]</a>). If <tt>addressof(x) != this</tt>, <del>the range
<tt>[x.begin(), x.end())</tt></del><ins><tt>x</tt></ins> is empty after the merge. No elements are copied by this operation.
<ins>If an exception is thrown other than by a comparison there are no effects.</ins>
<p/>
-27- <i>Complexity:</i> At most <tt>size() + x.size() - 1</tt> <del>applications of <tt>comp</tt></del><ins>comparisons</ins>
if <tt>addressof(x) != this</tt>; otherwise, no <del>applications of <tt>comp</tt></del><ins>comparisons</ins> are performed. 
<del>If an exception is thrown other than by a comparison there are no effects.</del>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3089" href="3089">3089.</a> <tt>copy_n</tt> should require non-overlapping ranges</h3>
<p><b>Section:</b> 25.6.1 <a href="https://timsong-cpp.github.io/cppwp/alg.copy">[alg.copy]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2018-03-21 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#alg.copy">active issues</a> in [alg.copy].</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.copy">issues</a> in [alg.copy].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
All the copy algorithms have some kind of prohibition on having the input and output ranges overlap. 
<p/>
The serial version of <tt>copy</tt> says:
</p>
<blockquote><p>
<i>Requires:</i> <tt>result</tt> shall not be in the range <tt>[first, last)</tt>.
</p></blockquote>
<p>
The parallel version of <tt>copy</tt> says:
</p>
<blockquote><p>
<i>Requires:</i> The ranges <tt>[first, last)</tt> and <tt>[result, result + (last - first))</tt> 
shall not overlap.
</p></blockquote>
<p>
<tt>copy_if</tt> says: 
</p>
<blockquote><p>
<i>Requires:</i> The ranges <tt>[first, last)</tt> and <tt>[result, result + (last - first))</tt> 
shall not overlap.
</p></blockquote>
<p>
<tt>copy_backwards</tt> says:
</p>
<blockquote><p>
<i>Requires:</i> <tt>result</tt> shall not be in the range <tt>[first, last)</tt>.
</p></blockquote>
<p>
But <tt>copy_n</tt> has no such requirement.
<p/>
I think it should. I checked the minutes of the LWG discussion from 2008 when this was added, and 
there was no discussion of overlapping ranges.
</p>

<p>What formulation do we want here? Is it sufficient to say "... shall not be in the range ..." or should we use the stronger "... shall not overlap ..."? Some <tt>copy</tt> variants use one, some use the other.  Should we be consistent? Issue <a href="3085">3085</a> is a similar issue for <tt>char_traits::copy</tt>.</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.</p>

<ol>
<li><p>Edit 25.6.1 <a href="https://timsong-cpp.github.io/cppwp/alg.copy">[alg.copy]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> I'm using the permission in 25.2 <a href="https://timsong-cpp.github.io/cppwp/algorithms.requirements">[algorithms.requirements]</a>/10 to 
do random-access arithmetic on (possibly) input iterators.]
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class InputIterator, class Size, class OutputIterator&gt;
  constexpr OutputIterator copy_n(InputIterator first, Size n,
                                  OutputIterator result);
template&lt;class ExecutionPolicy, class ForwardIterator1, class Size, class ForwardIterator2&gt;
  ForwardIterator2 copy_n(ExecutionPolicy&amp;&amp; exec,
                          ForwardIterator1 first, Size n,
                          ForwardIterator2 result);
</pre>
<blockquote>
<p>
<ins>-?- <i>Requires:</i> <tt>result</tt> shall not be in the range <tt>[first, first + n)</tt>.</ins>
<p/>
-9- <i>Effects:</i> For each non-negative integer <tt>i &lt; n</tt>, performs <tt>*(result + i) = *(first + i)</tt>.
<p/>
-10- <i>Returns:</i> <tt>result + n</tt>.
<p/>
-11- <i>Complexity:</i> Exactly <tt>n</tt> assignments.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3090" href="3090">3090.</a> What is &sect;[time.duration.cons]p4's "no overflow is induced in the conversion" intended to mean?</h3>
<p><b>Section:</b> 27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2018-03-22 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.duration.cons">active issues</a> in [time.duration.cons].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.duration.cons">issues</a> in [time.duration.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> p4 says:
</p>
<blockquote>
<pre>
template&lt;class Rep2, class Period2&gt;
  constexpr duration(const duration&lt;Rep2, Period2&gt;&amp; d);
</pre>
<blockquote>
<p>
<i>Remarks:</i> This constructor shall not participate in overload resolution unless no overflow is induced in the 
conversion and <tt>treat_as_floating_point_v&lt;rep&gt;</tt> is <tt>true</tt> or both 
<tt>ratio_divide&lt;Period2, period&gt;::den</tt> is 1 and <tt>treat_as_floating_point_v&lt;Rep2&gt;</tt> is <tt>false</tt>.
</p>
</blockquote>
</blockquote>
<p>
with this example:
</p>
<blockquote><pre>
duration&lt;int, milli&gt; ms(3);
duration&lt;int, micro&gt; us = ms;  <i>// OK</i>
duration&lt;int, milli&gt; ms2 = us; <i>// error</i>
</pre></blockquote>
<p>
It's unclear to me what "no overflow is induced in the conversion" means in the above. What happens here:
</p>
<blockquote><pre>
duration&lt;int, milli&gt; ms(INT_MAX);
duration&lt;int, micro&gt; us = ms;  <i>// ???</i>
</pre></blockquote>
<p>
An overflow is clearly induced in the conversion here: internally, we'll multiply <tt>INT_MAX</tt> by 1000. But that 
cannot be determined statically (in general), and so can't affect the result of overload resolution.
<p/>
So what's actually supposed to happen? Are we actually just supposed to check that <tt>Rep2</tt> is no larger than <tt>Rep</tt>? 
(If so, what happens on overflow? Undefined behavior?)
<p/>
It has been pointed out by Howard Hinnant:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
This refers to the compile-time conversion factor to convert <tt>Period2</tt> to <tt>Period</tt>. If that conversion factor 
is not representable as a (reduced) <tt>ratio&lt;N, D&gt;</tt>, then the constructor is SFINAE'd out. This might happen 
(for example) converting years to picoseconds.
</blockquote>
<p>
I would not have guessed that from the wording. Maybe replacing "no overflow is induced in the conversion" with "the result 
of <tt>ratio_divide&lt;Period2, Period&gt;</tt> is representable as a <tt>ratio</tt>" or similar would help? 
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3092" href="3092">3092.</a> Unclear semantics of <tt>enum class</tt> bitmask types</h3>
<p><b>Section:</b> 16.4.2.2.4 <a href="https://timsong-cpp.github.io/cppwp/bitmask.types">[bitmask.types]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Geoffrey Romer <b>Opened:</b> 2018-03-26 <b>Last modified:</b> 2019-07-22 17:12:46 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#bitmask.types">issues</a> in [bitmask.types].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[bitmask.types] specifies the semantics of a bitmask type in terms of an "exposition only" <tt>enum</tt> definition, 
together with some constants and overloads. Notably, it is depicted as an unscoped enum, which implies among other 
things that it is implicitly convertible to <tt>int_type</tt>. At least some sources treat that as normative (as 
of this writing, <a href="http://cppreference.com/">cppreference.com</a>'s documentation for 
<a href="http://en.cppreference.com/w/cpp/concept/BitmaskType"><tt>BitmaskType</tt></a> says the expression 
<tt>(X &amp; Y) != 0</tt> is guaranteed to be well-formed), and it's hard to argue that they're wrong on the basis 
of the existing wording.
<p/>
On the other hand, many standard library types are depicted as scoped enums, but still specified to be "bitmask types". 
As far as I can tell, it's impossible in library code to make a scoped enum implicitly convertible to its underlying type, 
and even if you could, what would be the point? Presumably the specification of those types as scoped enums is intended 
to have some sort of observable consequences.
<p/>
In addition, some library types (notably in clause 31) are specified to be bitmask types, without indicating whether 
they are scoped or unscoped. It's not clear what the standard guarantees about e.g. whether they can be implicitly 
converted.
<p/>
I assume the intent is that "bitmask type" doesn't specify an implicit conversion, or any of the other ways unscoped 
and scoped enums differ, but the standard doesn't actually say that. We really ought to rewrite [bitmask.types] as 
a requirements table, but here's a quick hack to the existing wording as a stopgap.
</p>
<p><i>[2018-04-23 Priority set to 2 after discussion on the reflector.]</i></p>


<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p><a href="https://wg21.link/N3110">N3110</a> also touches on this.</p>
<p>Nico to survey the enums in the library and report back on which ones should be class.</p>

<p><i>[2019 Cologne Wednesday night]</i></p>

<p>Changing existing enums to class enums is an ABI break on some platforms; current wording does not require the use of enums. See N3110.</p>
<p>Daniel to provide requirements tables, Jonathan to assist. Reduce priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.</p>

<ol>
<li><p>Edit 16.4.2.2.4 <a href="https://timsong-cpp.github.io/cppwp/bitmask.types">[bitmask.types]</a> as indicated:</p>
<blockquote>
<p>
-2- The bitmask type <tt><i>bitmask</i></tt> can be written:
</p>
<blockquote><pre>
<i>// For exposition only.</i>
<i>// </i>int_type<i> is an integral type capable of representing all values of the bitmask type.</i>
<del>enum</del><ins><i>E</i></ins> bitmask : int_type {
  V<sub>0</sub> = 1 &lt;&lt; 0, V<sub>1</sub> = 1 &lt;&lt; 1, V<sub>2</sub> = 1 &lt;&lt; 2, V<sub>3</sub> = 1 &lt;&lt; 3, .....
};
[&hellip;]
</pre></blockquote>
<p>
-3- Here, <ins><tt><i>E</i></tt> may represent either <tt>enum</tt> or <tt>enum class</tt> (the choice is implementation-defined 
unless otherwise specified), and</ins> the names <tt><i>C</i><sub>0</sub></tt>, <tt><i>C</i><sub>1</sub></tt>, etc. represent 
<i>bitmask elements</i> for this particular bitmask type. <ins>The zero value <tt><i>bitmask</i>{}</tt> is used to represent an 
<i>empty bitmask</i>, in which no bitmask elements are set.</ins> All <del>such</del><ins>bitmask</ins> elements have distinct, 
nonzero values such that, for any pair <tt><i>C<sub>i</sub></i></tt> and <tt><i>C<sub>j</sub></i></tt> where 
<tt><i>i</i> &ne; <i>j</i></tt>, <tt><i>C<sub>i</sub></i> &amp; <i>C<sub>i</sub></i></tt> is nonzero and 
<tt><i>C<sub>i</sub></i> &amp; <i>C<sub>j</sub></i></tt> is zero. <del>Additionally, the value <tt>0</tt> is used to represent 
an <i>empty bitmask</i>, in which no bitmask elements are set.</del>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3093" href="3093">3093.</a> LWG 2294/2192 missed a <tt>std::abs</tt> overload</h3>
<p><b>Section:</b> 26.8.2 <a href="https://timsong-cpp.github.io/cppwp/c.math.abs">[c.math.abs]</a>, 17.2.2 <a href="https://timsong-cpp.github.io/cppwp/cstdlib.syn">[cstdlib.syn]</a>, 29.12.2 <a href="https://timsong-cpp.github.io/cppwp/cinttypes.syn">[cinttypes.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2018-03-30 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="2192">2192</a> changed the library specification so that you always get all the <tt>std::abs</tt> overloads for fundamental 
types if you get any of them.
<p/>
Except that it missed one: <tt>&lt;cinttypes&gt;</tt> provides a <tt>std::abs</tt> (and <tt>std::div</tt>) overload for 
<tt>intmax_t</tt> if it's not <tt>long long</tt> (since LWG <a href="1449">1449</a>). Presumably that one should also follow the 
<tt>&lt;cstdlib&gt;</tt>/<tt>&lt;cmath&gt;</tt> pattern and we should make the complete <tt>abs</tt> overload set available 
whenever any of the three headers is included? (And likewise we should make the complete <tt>std::div</tt> overload set 
available whenever either <tt>&lt;cstdlib&gt;</tt> or <tt>&lt;cinttypes&gt;</tt> is included.)
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3095" href="3095">3095.</a> <tt>strstreambuf</tt> refers to nonexistent member of <tt>fpos</tt>, <tt>fpos::offset</tt></h3>
<p><b>Section:</b> D.10.2.3 <a href="https://timsong-cpp.github.io/cppwp/depr.strstreambuf.virtuals">[depr.strstreambuf.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-04-04 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#depr.strstreambuf.virtuals">issues</a> in [depr.strstreambuf.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>strstreambuf</tt> refers to a nonexistent member function of <tt>fpos</tt> in the specification of the member function
<tt>seekpos</tt>, D.10.2.3 <a href="https://timsong-cpp.github.io/cppwp/depr.strstreambuf.virtuals">[depr.strstreambuf.virtuals]</a>/18 (emphasize mine): 
</p>
<blockquote><p>
For a sequence to be positioned, if its next pointer is a null pointer, the positioning operation fails.
Otherwise, the function determines <tt>newoff</tt> from <span style="color:#C80000;font-weight:bold"><tt>sp.offset()</tt></span>:
</p></blockquote>
<p>
The intent is clearly to get the corresponding <tt>streamoff</tt> from the <tt>fpos</tt>, as p19 says "the resultant 
offset <tt>newoff</tt> (of type <tt>off_type</tt>)". The mechanism to make that conversion is a normal explicit conversion, 
as indicated in the last row of the table in [fpos.operations].
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 4</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li>
<p>Edit D.10.2.3 <a href="https://timsong-cpp.github.io/cppwp/depr.strstreambuf.virtuals">[depr.strstreambuf.virtuals]</a> as indicated:</p>
<blockquote>
<pre>
pos_type seekpos(pos_type sp, ios_base::openmode which
                 = ios_base::in | ios_base::out) override;
</pre>
<blockquote>
<p>
-17- <i>Effects:</i> [&hellip;]
<p/>
-18- For a sequence to be positioned, if its next pointer is a null pointer, the positioning operation fails.
Otherwise, the function determines <tt>newoff</tt> from <tt><ins>static_cast&lt;off_type&gt;(</ins>sp<ins>)</ins><del>.offset()</del></tt>:
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3097" href="3097">3097.</a> <tt>basic_stringbuf seekoff</tt> effects trigger undefined behavior and have contradictory returns</h3>
<p><b>Section:</b> 29.8.2.4 <a href="https://timsong-cpp.github.io/cppwp/stringbuf.virtuals">[stringbuf.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-04-07 <b>Last modified:</b> 2018-04-22 15:57:42 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#stringbuf.virtuals">active issues</a> in [stringbuf.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#stringbuf.virtuals">issues</a> in [stringbuf.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Paragraph citations relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>
<p>
[stringbuf.virtuals]/10 says that <tt>newoff</tt> might be calculated from <tt>xnext - xbegin</tt>, 
or from <tt>high_mark - xbegin</tt>. After <tt>newoff</tt> is calculated, it does the null pointer 
check against and zero offset check. However, that means the effects may have already done 
<tt>nullptr -</tt> non-<tt>nullptr</tt>, or non-<tt>nullptr - nullptr</tt>, which [expr.add]/5 says 
is undefined behavior.
<p/>
Moreover, the attempt at avoiding this problem only tests <tt>newoff</tt>, not the value actually used 
which is <tt>newoff + off</tt>. For example, <tt>buf.seekoff(100, ios_base::beg, ios_base::out)</tt> 
on a read-only <tt>streambuf</tt> would try to assign <tt>pptr() + newoff + off to pptr()</tt>, but 
<tt>pptr()</tt> may have been <tt>nullptr</tt>, giving <tt>nullptr + 0 + 100</tt> which triggers UB. 
(Perhaps the "refers to an uninitialized character" bit protects that though).
<p/>
Last, the <i>Returns:</i> element says that it returns <tt>newoff</tt>, but then also says it returns 
the resulting stream position, which should be something like <tt>newoff + off</tt>. (I checked libc++ 
and MSVC++ and we both return <tt>newoff + off</tt>)
<p/>
We probably want to resolve that by renaming the value that comes out of Table 108 to something like 
"<tt>basis</tt>" and make "<tt>newoff</tt>" actually be the new offset instead of the starting offset.
</p>

<p><i>[2018-04-16 Priority set to 3 after discussion on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3098" href="3098">3098.</a> Misleading example for <tt>filesystem::path::filename()</tt></h3>
<p><b>Section:</b> 29.11.7.4.9 <a href="https://timsong-cpp.github.io/cppwp/fs.path.decompose">[fs.path.decompose]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-04-06 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#fs.path.decompose">issues</a> in [fs.path.decompose].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The example in [fs.path.decompose] p7 includes:
</p>
<blockquote><pre>
path("//host").filename();  <i>// yields</i> ""
</pre></blockquote>
<p>
This result isn't guaranteed, it depends whether the implementation interprets <tt>"//host"</tt> as a <i>root-name</i> 
or as a <i>root-directory</i> (with a redundant <i>directory-separator</i>) followed by the <i>filename</i> <tt>"host"</tt>.
<p/>
The example should make it clear that this interpretation is allowed.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.
</p>

<ol>
<li>
<p>Edit 29.11.7.4.9 <a href="https://timsong-cpp.github.io/cppwp/fs.path.decompose">[fs.path.decompose]</a> as indicated:</p>
<blockquote>
<pre>
path filename() const;
</pre>
<blockquote>
<p>
-6- <i>Returns:</i> <tt>relative_path().empty() ? path() : *--end()</tt>.
<p/>
[<i>Example:</i>
</p>
<blockquote><pre>
path("/foo/bar.txt").filename(); <i>// yields</i> "bar.txt"
path("/foo/bar").filename();     <i>// yields</i> "bar"
path("/foo/bar/").filename();    <i>// yields</i> ""
path("/").filename();            <i>// yields</i> ""
path("//host").filename();       <i>// yields</i> "" <ins><i>or</i> "host"</ins>
path(".").filename();            <i>// yields</i> "."
path("..").filename();           <i>// yields</i> ".."
</pre></blockquote>
<p>
&mdash; end example]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-04-10, Jonathan comments and provides revised wording]</i></p>

<p>
Based on the reflector discussion I'd like to change the P/R to Billy's suggestion of simply removing that line from the example.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4727">N4741</a>.
</p>

<ol>
<li>
<p>Edit 29.11.7.4.9 <a href="https://timsong-cpp.github.io/cppwp/fs.path.decompose">[fs.path.decompose]</a> as indicated:</p>
<blockquote>
<pre>
path filename() const;
</pre>
<blockquote>
<p>
-6- <i>Returns:</i> <tt>relative_path().empty() ? path() : *--end()</tt>.
<p/>
[<i>Example:</i>
</p>
<blockquote><pre>
path("/foo/bar.txt").filename(); <i>// yields</i> "bar.txt"
path("/foo/bar").filename();     <i>// yields</i> "bar"
path("/foo/bar/").filename();    <i>// yields</i> ""
path("/").filename();            <i>// yields</i> ""
<del>path("//host").filename();       <i>// yields</i> ""</del>
path(".").filename();            <i>// yields</i> "."
path("..").filename();           <i>// yields</i> ".."
</pre></blockquote>
<p>
&mdash; end example]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3099" href="3099">3099.</a> <tt>is_assignable&lt;Incomplete&amp;, Incomplete&amp;&gt;</tt></h3>
<p><b>Section:</b> 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-04-10 <b>Last modified:</b> 2018-08-22 12:55:05 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.type.synop">active issues</a> in [meta.type.synop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.type.synop">issues</a> in [meta.type.synop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG <a href="2939">2939</a> suggests that the the preconditions of the type traits need reevaluation.
This issue focuses specifically on <tt>is_assignable</tt> and, by extension, its variants:
<ul>
<li><tt>is_copy_assignable&lt;T&gt;</tt>, equivalent to <tt>is_assignable&lt;T&amp;, const T&amp;&gt;</tt>,
</li>
<li><tt>is_move_assignable&lt;T&gt;</tt>, equivalent to <tt>is_assignable&lt;T&amp;, T&gt;</tt>,
</li>
<li><tt>is_trivially_assignable&lt;T, U&gt;</tt>, equivalent to <tt>is_assignable&lt;T, U&gt; &amp;&amp;
  /* magic */</tt>,
</li>
<li><tt>is_trivially_copy_assignable&lt;T&gt;</tt>, equivalent to <tt>is_assignable&lt;T&amp;, const T&amp;&gt; &amp;&amp;
  /* magic */</tt>,
</li>
<li><tt>is_trivially_move_assignable&lt;T&gt;</tt>, equivalent to <tt>is_assignable&lt;T&amp;, T&gt; &amp;&amp;
  /* magic */</tt>,
</li>
<li><tt>is_nothrow_assignable&lt;T, U&gt;</tt>, equivalent to <tt>is_assignable&lt;T, U&gt; &amp;&amp;
    noexcept(declval&lt;T&gt;() = declval&lt;U&gt;())</tt>,
</li>
<li><tt>is_nothrow_copy_assignable&lt;T&gt;</tt>, equivalent to <tt>is_assignable&lt;T&amp;, const T&amp;&gt; &amp;&amp;
    noexcept(declval&lt;T&amp;&gt;() = declval&lt;const T&amp;&gt;())</tt>,
</li>
<li><tt>is_nothrow_move_assignable&lt;T&gt;</tt>, equivalent to <tt>is_assignable&lt;T&amp;, T&gt; &amp;&amp;
    noexcept(declval&lt;T&amp;&gt;() = declval&lt;T&gt;())</tt>, and
</li>
</ul>
</p>
<p>
We note a discrepancy: <tt>is_copy_assignable&lt;T&gt;</tt> requires <tt>T</tt> to be a complete type, but the
equivalent form <tt>is_assignable&lt;T&amp;, const T&amp;&gt;</tt> <em>does not</em>. The requirement for
<tt>is_copy_assignable&lt;T&gt;</tt> seems sensible, since there's no way to determine whether or not the assignment
<tt>declval&lt;T&amp;&gt;() = declval&lt;const T&amp;&gt;()</tt> is well-formed when <tt>T</tt> is incomplete.
It seems that the same argument should apply to all of the above "assignable" traits, and that they must require that
the referent type is complete when given a reference type parameter to be implementable.
</p>

<p><i>[2018-08 Batavia Monday issue discussion]</i></p>

<p>Issues <a href="2797">2797</a>, <a href="2939">2939</a>, <a href="3022">3022</a>, and <a href="3099">3099</a> are all closely related. Walter to write a paper resolving them.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4741">N4741</a>.</p>
<blockquote>
<ol>
<li>In 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> Table 42, change the Precondition text for <tt>is_assignable</tt>,
<tt>is_trivially_assignable</tt>, and <tt>is_nothrow_assignable</tt> as follows:
<blockquote>
<ins><tt>remove_cvref_t&lt;</tt></ins><tt>T</tt><ins><tt>&gt;</tt></ins> and
<ins><tt>remove_cvref_t&lt;</tt></ins><tt>U</tt><ins><tt>&gt;</tt></ins> shall be complete types, <del><i>cv</i></del>
<tt>void</tt>, or arrays of unknown bound.
</blockquote>
</li>

<li>In 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a> Table 42, change the Precondition text for <tt>is_copy_assignable</tt>,
<tt>is_move_assignable</tt>, <tt>is_trivially_copy_assignable</tt>, <tt>is_trivially_move_assignable</tt>,
<tt>is_nothrow_copy_assignable</tt>, and <tt>is_nothrow_move_assignable</tt> as follows:
<blockquote>
<ins><tt>remove_cvref_t&lt;</tt></ins><tt>T</tt><ins><tt>&gt;</tt></ins> shall be a complete type, <del><i>cv</i></del>
<tt>void</tt>, or an array of unknown bound.
</blockquote>
</li>
</ol>
</blockquote>





<hr>
<h3><a name="3105" href="3105">3105.</a> <tt>T1</tt> is convertible to <tt>T2</tt></h3>
<p><b>Section:</b> 16 <a href="https://timsong-cpp.github.io/cppwp/library">[library]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2018-04-24 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#library">active issues</a> in [library].</p>
<p><b>View all other</b> <a href="lwg-index.html#library">issues</a> in [library].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The library wording frequently uses the construction "type <tt>T1</tt> is convertible to type <tt>T2</tt>", 
but this is an undefined phrase.
<p/>
For requirements on user code (e.g. [tuple.rel]), it is unclear whether all expressions of type <tt>T1</tt> 
must satisfy the convertibility requirement, regardless of value category, or whether a single
value category is in view only.
<p/>
Consider:
</p>
<blockquote>
<pre>
struct C 
{
  operator int() &amp;&amp;;
};

int main()
{
  int x = C(); <i>// prvalue can be implicitly converted to int</i>
  C c;
  int y = c;   <i>// lvalue can't</i>
}
</pre>
</blockquote>
<p>
The library has an "<tt>is_convertible&lt;T1, T2&gt;</tt>" trait, but that checks convertibility 
only for a single value category, not all possible ones.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3107" href="3107">3107.</a> <tt>istreambuf_iterator</tt> has public <i>exposition-only</i> member</h3>
<p><b>Section:</b> 23.6.3 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator">[istreambuf.iterator]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-04-26 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#istreambuf.iterator">active issues</a> in [istreambuf.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#istreambuf.iterator">issues</a> in [istreambuf.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
LWG has said recently that we don't want public exposition-only things, as that may encourage users to try 
to use those names (and some implementers to actually use those names).
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 4</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4741">N4741</a>.
</p>

<ol>
<li>
<p>Edit 23.6.3 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator">[istreambuf.iterator]</a> as indicated:</p>
<blockquote>
<pre>
namespace std {
  template&lt;class charT, class traits = char_traits&lt;charT&gt;&gt;
  class istreambuf_iterator {
  public:
    [&hellip;]
    using istream_type = basic_istream&lt;charT,traits&gt;;
  
    <del>class proxy; <i>// exposition only</i></del>
  
    constexpr istreambuf_iterator() noexcept;
    [&hellip;]
  private:
    <ins>class proxy; <i>// exposition only</i></ins>
    streambuf_type* sbuf_; <i>// exposition only</i>
  };
  [&hellip;]
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3108" href="3108">3108.</a> <tt>istreambuf_iterator::proxy::operator*</tt> should be <tt>const</tt></h3>
<p><b>Section:</b> 23.6.3.1 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator.proxy">[istreambuf.iterator.proxy]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-04-26 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>operator*</tt> on iterators is usually intended to be <tt>const</tt>; see 23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a> 
Table 87, <tt>*a</tt>, where <tt>a</tt> is of type <tt>X</tt> or <tt>const X</tt>. (Technically, <tt>proxy</tt> 
is implementing the <tt>*r++</tt> requirement in this table, and <tt>r</tt> doesn't imply a const iterator, 
but there's no reason for the iterator's <tt>operator*</tt> to differ from the proxy)
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4741">N4741</a>.
</p>

<ol>
<li>
<p>Edit 23.6.3.1 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator.proxy">[istreambuf.iterator.proxy]</a> as indicated:</p>
<blockquote>
<pre>
namespace std {
  template&lt;class charT, class traits = char_traits&lt;charT&gt;&gt;
  class istreambuf_iterator&lt;charT, traits&gt;::proxy { <i>// exposition only</i>
    charT keep_;
    basic_streambuf&lt;charT,traits&gt;* sbuf_;
    proxy(charT c, basic_streambuf&lt;charT,traits&gt;* sbuf)
      : keep_(c), sbuf_(sbuf) { }
    public:
      charT operator*() <ins>const</ins> { return keep_; }
  };
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3109" href="3109">3109.</a> <tt>strstreambuf</tt> is copyable</h3>
<p><b>Section:</b> D.10.2 <a href="https://timsong-cpp.github.io/cppwp/depr.strstreambuf">[depr.strstreambuf]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-05-02 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In C++03 <tt>strstreambuf</tt> was not copyable, because <tt>basic_streambuf</tt> wasn't copyable. 
In C++11 we made <tt>basic_streambuf</tt> copyable by derived classes, and <tt>strstreambuf</tt> 
doesn't define any special members, so it (unintentionally?) became copyable, with completely 
unspecified semantics.
<p/>
VC++ and libc++ make it movable not copyable, and libstdc++ still follows C++03, so it's neither 
movable nor copyable. Making it movable seems to be the sane option, and consistent with 
<tt>filebuf</tt> and <tt>stringbuf</tt>.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 4</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3110" href="3110">3110.</a> Contiguous Iterators should always be Random-Access</h3>
<p><b>Section:</b> 23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marc Aldorasi <b>Opened:</b> 2018-05-07 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.requirements.general">active issues</a> in [iterator.requirements.general].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.requirements.general">issues</a> in [iterator.requirements.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In [iterator.requirements.general] paragraph 6, contiguous iterators are defined in terms of general iterators, 
not random-access iterators. Since the defining expressions require random-access and the original paper's 
introduction describes contiguous iterators as a refinement of random-access iterators, contiguous iterators 
should be defined in terms of random-access iterators.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4741">N4741</a>.
</p>

<ol>
<li>
<p>Edit 23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a> as indicated:</p>
<blockquote>
<p>
-6- <ins>Random-access i</ins><del>I</del>terators that further satisfy the requirement that, for integral values 
<tt>n</tt> and dereferenceable iterator values <tt>a</tt> and <tt>(a + n)</tt>, <tt>*(a + n)</tt> is equivalent to 
<tt>*(addressof(*a) + n)</tt>, are called <i>contiguous iterators</i>. [<i>Note:</i> For example, the type "pointer to 
<tt>int</tt>" is a contiguous iterator, but <tt>reverse_iterator&lt;int *&gt;</tt> is not. For a valid iterator 
range <tt>[a, b)</tt> with dereferenceable a, the corresponding range denoted by pointers is <tt>[addressof(*a), 
addressof(*a) + (b - a))</tt>; <tt>b</tt> might not be dereferenceable. &mdash; <i>end note</i>] 
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3114" href="3114">3114.</a> [networking.ts] Permit efficient composition when using <tt>DynamicBuffer</tt></h3>
<p><b>Section:</b> 16 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer">[networking.ts::buffer]</a>, 17 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.stream">[networking.ts::buffer.stream]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Vinnie Falco <b>Opened:</b> 2018-05-18 <b>Last modified:</b> 2018-06-19 05:49:11 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses: networking.ts</b>
<p>
Asynchronous algorithms are started by a call to an <em>initiating function</em>.
When these algorithms are constructed from calls to other initiating functions,
the result is called a <em>composed operation</em>. For example, <tt>async_read</tt> may be 
implemented in terms of zero or more calls to a stream's <tt>async_read_some</tt> algorithm. 
For operations where the caller cannot easily determine ahead of time the storage requirements 
needed for an algorithm to meet its post-conditions, [networking.ts] introduces the
<b>DynamicBuffer</b> concept:
</p>
<blockquote>
<p>
A dynamic buffer encapsulates memory storage that may be automatically
resized as required, where the memory is divided into two regions: readable
bytes followed by writable bytes. [buffer.reqmts.dynamicbuffer]
</p>
</blockquote>
<p>
Signatures for algorithms in the technical specification which accept dynamic
buffers use forwarding references:
</p>
<blockquote><pre>
<i>// 17.10 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read.until">[networking.ts::buffer.async.read.until]</a>, asynchronous delimited read operations:</i>

template&lt;
  class AsyncReadStream,
  class DynamicBuffer,
  class CompletionToken&gt;
<i>DEDUCED</i> async_read_until(
  AsyncReadStream&amp; s,
  DynamicBuffer&amp;&amp; b,
  char delim,
  CompletionToken&amp;&amp; token);
</pre></blockquote>
<p>
Because the initiating function returns immediately, and the associated composed operation executes later, 
it is necessary for the algorithm to manage the lifetime of the dynamic buffer. Guidance for doing so is 
given in the TS:
</p>
<blockquote>
<b>13.2.7.5 Lifetime of initiating function arguments [async.reqmts.async.lifetime]</b>
<p>
1. Unless otherwise specified, the lifetime of arguments to initiating functions shall be treated as 
follows: [&hellip;] the implementation does not assume the validity of the argument after the initiating 
function completes [&hellip;] The implementation may make copies of the argument, and all copies shall be
destroyed no later than immediately after invocation of the completion handler.
</p>
</blockquote>
<p>
Given the guidance above, the most sensible approach is for the implementation
to move or make a decay-copy of the argument. An implementation of the TS,
authored by the principal architect of the TS itself, does precisely that:
</p>
<blockquote><pre>
template &lt;
    typename AsyncReadStream,
    typename DynamicBuffer,
    typename ReadHandler&gt;
class read_until_delim_op
{
public:
    template &lt;typename DeducedBuffers&gt;
    read_until_delim_op(
        AsyncReadStream&amp; stream,
        DeducedBuffers&amp;&amp; buffers,
        char delim, ReadHandler&amp; handler)
    : [&hellip;]
      buffers_(std::forward&lt;DeducedBuffers&gt;(buffers))
      [&hellip;]
    {
    }
    [&hellip;]
    DynamicBuffer buffers_;
    [&hellip;]
};

template &lt;
    typename AsyncReadStream,
    typename DynamicBuffer,
    typename ReadHandler&gt;
NET_TS_INITFN_RESULT_TYPE(ReadHandler,
    void (std::error_code, std::size_t))
async_read_until(
    AsyncReadStream&amp; s,
    DynamicBuffer&amp;&amp; buffers,
    char delim,
    ReadHandler&amp;&amp; handler)
{
  // If you get an error on the following line it means that your handler does
  // not meet the documented type requirements for a ReadHandler.
  NET_TS_READ_HANDLER_CHECK(ReadHandler, handler) type_check;

  async_completion&lt;ReadHandler,
    void (std::error_code, std::size_t)&gt; init(handler);

  detail::read_until_delim_op&lt;
    AsyncReadStream,
    typename decay&lt;DynamicBuffer&gt;::type,
    NET_TS_HANDLER_TYPE(ReadHandler, void (std::error_code, std::size_t))&gt;(
        s,
        DynamicBuffer&amp;&amp;buffers,
        delim,
        init.completion_handler)(std::error_code(), 0, 1);

  return init.result.get();
}
</pre></blockquote>
<p>
Given the semantics of dynamic buffers implied by the wording, instances of
dynamic buffers behave more like references to storage types rather than
storage types, as copies refer to the same underlying storage. This can be
seen in the declaration of <tt>dynamic_string_buffer</tt> which meets
the requirements of <b>DynamicBuffer</b>:
</p>
<blockquote><pre>
template &lt;typename Elem, typename Traits, typename Allocator&gt;
class dynamic_string_buffer
{
  [&hellip;]
private:
  std::basic_string&lt;Elem, Traits, Allocator&gt;&amp; string_;
  std::size_t size_;
  const std::size_t max_size_;
};
</pre></blockquote>
<p>
A dynamic string buffer contains a reference to the underlying string. Copies
of a dynamic string buffer refer to the same string. Note that the dynamic
string buffer also contains some state: the <tt>size_</tt> and <tt>max_size_</tt>
data members. This additional metadata informs the dynamic string buffer of
the boundaries between the readable and writable bytes, as well as the maximum
allowed size of the total of the readable and writable bytes.
<p/>
When only one composed operation handles the dynamic buffer, things seem to
work. However, if a composed operation wishes to invoke another composed
operation and pass that dynamic buffer, a problem arises. Consider two composed
operations <tt>f</tt> and <tt>g</tt>, which both operate on an instance of
dynamic buffer. When <tt>f</tt> is invoked, it makes a copy of the dynamic
buffer and then calls <tt>g</tt> with the copy. At this point, <tt>g</tt> must
also make a copy. Copies share the underlying storage, but in the case of
dynamic string buffers each copy maintains its own distinct metadata. When
<tt>g</tt> has finished mutating the dynamic buffer and returns control back
to <tt>f</tt> by invoking the completion handler, the metadata in the copy of
the dynamic buffer held by <tt>f</tt> will not have the changes made by <tt>g</tt>.
<p/>
Another design problem caused by adding metadata to the dynamic buffer concept
is illustrated in the following example code:
</p>
<blockquote><pre>
template&lt;class MutableBufferSequence&gt;
std::size_t read(const MutableBufferSequence&amp;)
{
  throw std::exception{};
}

int main()
{
  std::string s;
  assert(s.empty());
  try
  {
    auto b = boost::asio::dynamic_buffer(s);
    b.commit(read(b.prepare(32)));
  }
  catch(const std::exception&amp;)
  {
    assert(s.empty()); // fails
  }
}
</pre></blockquote>
<p>
While not technically incorrect, it may be surprising to the user that
the string contains additional value-initialized data which was not part
of the original readable bytes (which in this case was empty). The wording of
the dynamic buffer concept does not address this case.
<p/>
The solution we propose is to change the semantics of <b>DynamicBuffer</b>
to represent a true storage type rather than a hybrid reference with metadata.
Instances of dynamic buffers will be passed by reference, and callers will
be required to manage the lifetime of dynamic buffer objects for the duration
of any asynchronous operations. An additional benefit of this change is that
it also solves the problem of exceptions described above.
</p>

<p><i>[2018-06-18 after reflector discussion]</i></p>

<p>Status to LEWG; there will be a paper <a href="https://wg21.link/P1100R0">P1100R0</a> in the post-Rapperswil mailing addressing this.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4734">N4734</a>.</p>

<blockquote class="note">
<p>[<i>Drafting note:</i> The project editor is kindly asked to replace all occurrences of 
<tt>DynamicBuffer&amp;&amp;</tt> with <tt>DynamicBuffer&amp;</tt> as indicated by the provided
wording changes below. &mdash; <i>end drafting note</i>]
</p>
</blockquote>

<ol>
<li><p>Modify 16.1 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.synop">[networking.ts::buffer.synop]</a>, header <tt>&lt;experimental/buffer&gt;</tt> synopsis, 
as indicated:</p>
<blockquote><pre>
[&hellip;]
<i>// 16.11 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.creation">[networking.ts::buffer.creation]</a>, buffer creation:</i>
[&hellip;]

template&lt;class T, class Allocator&gt;
class dynamic_vector_buffer;

template&lt;class CharT, class Traits, class Allocator&gt;
class <ins>basic_</ins>dynamic_string_buffer;

<del><i>// 16.14 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.dynamic.creation">[networking.ts::buffer.dynamic.creation]</a>, dynamic buffer creation:</i></del>

<del>template&lt;class T, class Allocator&gt;
  dynamic_vector_buffer&lt;T, Allocator&gt;
  dynamic_buffer(vector&lt;T, Allocator&gt;&amp; vec) noexcept;
template&lt;class T, class Allocator&gt;
  dynamic_vector_buffer&lt;T, Allocator&gt;
  dynamic_buffer(vector&lt;T, Allocator&gt;&amp; vec, size_t n) noexcept;
</del>

<del>template&lt;class CharT, class Traits, class Allocator&gt;
  dynamic_string_buffer&lt;CharT, Traits, Allocator&gt;
  dynamic_buffer(basic_string&lt;CharT, Traits, Allocator&gt;&amp; str) noexcept;
template&lt;class CharT, class Traits, class Allocator&gt;
  dynamic_string_buffer&lt;CharT, Traits, Allocator&gt;
  dynamic_buffer(basic_string&lt;CharT, Traits, Allocator&gt;&amp; str, size_t n) noexcept;</del>

[&hellip;]
<i>// 17.5 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.read">[networking.ts::buffer.read]</a>, synchronous read operations:</i>
[&hellip;]

template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b, error_code&amp; ec);
template&lt;class SyncReadStream, class DynamicBuffer, class CompletionCondition&gt;
  size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
              CompletionCondition completion_condition);
template&lt;class SyncReadStream, class DynamicBuffer, class CompletionCondition&gt;
  size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
              CompletionCondition completion_condition, error_code&amp; ec);

<i>// 17.6 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read">[networking.ts::buffer.async.read]</a>, asynchronous read operations:</i>              
[&hellip;]

template&lt;class AsyncReadStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_read(AsyncReadStream&amp; stream,
                     DynamicBuffer&amp;<del>&amp;</del> b, CompletionToken&amp;&amp; token);
template&lt;class AsyncReadStream, class DynamicBuffer,
  class CompletionCondition, class CompletionToken&gt;
    <i>DEDUCED</i> async_read(AsyncReadStream&amp; stream,
                       DynamicBuffer&amp;<del>&amp;</del> b,
                       CompletionCondition completion_condition,
                       CompletionToken&amp;&amp; token);

<i>// 17.7 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.write">[networking.ts::buffer.write]</a>, synchronous write operations:</i>                       
[&hellip;]

template&lt;class SyncWriteStream, class DynamicBuffer&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del>; b);
template&lt;class SyncWriteStream, class DynamicBuffer&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b, error_code&amp; ec);
template&lt;class SyncWriteStream, class DynamicBuffer, class CompletionCondition&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
               CompletionCondition completion_condition);
template&lt;class SyncWriteStream, class DynamicBuffer, class CompletionCondition&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
               CompletionCondition completion_condition, error_code&amp; ec);

<i>// 17.8 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.write">[networking.ts::buffer.async.write]</a>, asynchronous write operations:</i>               
[&hellip;]

template&lt;class AsyncWriteStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_write(AsyncWriteStream&amp; stream,
                      DynamicBuffer&amp;<del>&amp;</del> b, CompletionToken&amp;&amp; token);
template&lt;class AsyncWriteStream, class DynamicBuffer,
  class CompletionCondition, class CompletionToken&gt;
    <i>DEDUCED</i> async_write(AsyncWriteStream&amp; stream,
                        DynamicBuffer&amp;<del>&amp;</del> b,
                        CompletionCondition completion_condition,
                        CompletionToken&amp;&amp; token);

<i>// 17.9 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.read.until">[networking.ts::buffer.read.until]</a>, synchronous delimited read operations:</i>                        

template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b, char delim);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b,
                    char delim, error_code&amp; ec);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b, string_view delim);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b,
                    string_view delim, error_code&amp; ec);

<i>// 17.10 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read.until">[networking.ts::buffer.async.read.until]</a>, asynchronous delimited read operations:</i>

template&lt;class AsyncReadStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_read_until(AsyncReadStream&amp; s,
                           DynamicBuffer&amp;<del>&amp;</del> b, char delim,
                           CompletionToken&amp;&amp; token);
template&lt;class AsyncReadStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_read_until(AsyncReadStream&amp; s,
                           DynamicBuffer&amp;<del>&amp;</del> b, string_view delim,
                           CompletionToken&amp;&amp; token);

[&hellip;]
</pre></blockquote>
</li>

<li>
<p>Modify 16.2.4 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.reqmts.dynamicbuffer">[networking.ts::buffer.reqmts.dynamicbuffer]</a>, as indicated:</p>

<blockquote>
<p>
-1- [&hellip;]
<p/>
-2- A type <tt>X</tt> meets the <tt>DynamicBuffer</tt> requirements if it satisfies
the requirements of <tt>Destructible</tt> (C++ 2014 [destructible])
<del>and <tt>MoveConstructible</tt> (C++ 2014 [moveconstructible]),</del>
as well as the additional requirements listed in Table 14.
</p>
</blockquote>
</li>

<li><p>Modify 16.12 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.dynamic.vector">[networking.ts::buffer.dynamic.vector]</a>, as indicated:</p>

<blockquote>
<blockquote><pre>
[&hellip;]

template&lt;class T, class Allocator<ins> = allocator&lt;T&gt;</ins>&gt;
class dynamic_vector_buffer
{
public:
  <em>// types:</em>
  <ins>using value_type = vector&lt;T, Allocator&gt;;</ins>
  using const_buffers_type = const_buffer;
  using mutable_buffers_type = mutable_buffer;
  
  <em>// constructors:</em>
  <ins>dynamic_vector_buffer() = default;</ins>
  <ins>explicit dynamic_vector_buffer(size_t maximum_size);</ins>
  explicit dynamic_vector_buffer(vector&lt;T, Allocator&gt;<del>&amp;</del> vec) <del>noexcept;</del>
  dynamic_vector_buffer(vector&lt;T, Allocator&gt;<del>&amp;</del> vec, size_t maximum_size) <del>noexcept;</del>
  dynamic_vector_buffer(dynamic_vector_buffer&amp;&amp;) = default;
  
  <em>// members:</em>
  size_t size() const noexcept;
  size_t max_size() const noexcept;
  <ins>void max_size(size_t maximum_size);</ins>
  size_t capacity() const noexcept;
  const_buffers_type data() const noexcept;
  mutable_buffers_type prepare(size_t n);
  void commit(size_t n);
  void consume(size_t n);
  <ins>span&lt;const T&gt; get() const noexcept</ins>
  <ins>value_type release();</ins>

private:
  vector&lt;T, Allocator&gt;<del>&amp;</del> vec_; <em>// exposition only</em>
  size_t size_; <em>// exposition only</em>
  <del>const</del> size_t max_size_; <em>// exposition only</em>
};

[&hellip;]
</pre></blockquote>
<p>
-2- [&hellip;]
<p/>
-3- [&hellip;]
</p>
<pre>
<ins>explicit dynamic_vector_buffer(size_t maximum_size)</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Effects:</em> Default-constructs <tt>vec_</tt>. Initializes <tt>size_</tt> with <tt>0</tt>, and 
<tt>max_size_</tt> with <tt>maximum_size</tt>.</ins>
</p>
</blockquote>
<pre>
explicit dynamic_vector_buffer(vector&lt;T, Allocator&gt;<del>&amp;</del> vec) <del>noexcept</del>
</pre>
<blockquote>
<p>
-4- <em>Effects:</em> Initializes <tt>vec_</tt> with <tt><ins>move(</ins>vec<ins>)</ins></tt>,
  <tt>size_</tt> with <tt>vec<ins>_</ins>.size()</tt>, and <tt>max_size_</tt> with <tt>vec<ins>_</ins>.max_size()</tt>
</p>
</blockquote>
<pre>
dynamic_vector_buffer(vector&lt;T, Allocator&gt;<del>&amp;</del> vec,
                      size_t maximum_size) <del>noexcept</del>;
</pre>
<blockquote>
<p>
-5- <em>Requires:</em> <tt>vec.size() &lt;= maximum_size</tt>
<p/>
-6- <em>Effects:</em> Initializes <tt>vec_</tt> with <tt><ins>move(</ins>vec<ins>)</ins></tt>,
  <tt>size_</tt> with <tt>vec<ins>_</ins>.size()</tt>, and <tt>max_size_</tt> with <tt>maximum_size</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
size_t max_size() const noexcept;
</pre>
<blockquote>
<p>
-8- <i>Returns:</i> <tt>max_size_</tt>.
</p>
</blockquote>
<pre>
<ins>void max_size(size_t maximum_size)</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Effects:</em> Performs <tt>max_size_ = maximum_size</tt>.</ins>
</p>
</blockquote>
[&hellip;]
<pre>
void consume(size_t n);
</pre>
<blockquote>
<p>
-15- <i>Effects:</i> [&hellip;]
</p>
</blockquote>
<pre>
<ins>span&lt;const T&gt; get() const noexcept</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Returns:</em> <tt>span&lt;const T&gt;(vec_.data(), size_)</tt>.</ins>
</p>
</blockquote>
<pre>
<ins>value_type release()</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Returns:</em> <tt>move(vec_)</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 16.13 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.dynamic.string">[networking.ts::buffer.dynamic.string]</a>, as indicated:</p>

<blockquote>
<blockquote><pre>
template&lt;class CharT, class Traits, class Allocator&gt;
class <ins>basic_</ins>dynamic_string_buffer
{
public:
  <em>// types:</em>
  <ins>using value_type = basic_string&lt;CharT, Traits, Allocator&gt;;</ins>
  using const_buffers_type = const_buffer;
  using mutable_buffers_type = mutable_buffer;

  <em>// constructors:</em>
  <ins>basic_dynamic_string_buffer() = default;</ins>
  <ins>explicit basic_dynamic_string_buffer(size_t maximum_size);</ins>
  explicit <ins>basic_</ins>dynamic_string_buffer(basic_string&lt;CharT, Traits, Allocator&gt;<del>&amp;</del> str) <del>noexcept;</del>
  <ins>basic_</ins>dynamic_string_buffer(basic_string&lt;CharT, Traits, Allocator&gt;<del>&amp;</del> str, size_t maximum_size) <del>noexcept;</del>
  <ins>basic_</ins>dynamic_string_buffer(<ins>basic_</ins>dynamic_string_buffer&amp;&amp;) = default;

  <em>// members:</em>
  size_t size() const noexcept;
  size_t max_size() const noexcept;
  <ins>void max_size(size_t maximum_size)</ins>
  size_t capacity() const noexcept;
  const_buffers_type data() const noexcept;
  mutable_buffers_type prepare(size_t n);
  void commit(size_t n) noexcept;
  void consume(size_t n);
  <ins>basic_string_view&lt;CharT, Traits&gt; get() const noexcept</ins>
  <ins>value_type release();</ins>

private:
  basic_string&lt;CharT, Traits, Allocator&gt;<del>&amp;</del> str_; <em>// exposition only</em>
  size_t size_; <em>// exposition only</em>
  <del>const </del>size_t max_size_; <em>// exposition only</em>
};

<ins>using dynamic_string_buffer =
  basic_dynamic_string_buffer&lt;char, char_traits&lt;char&gt;, allocator&lt;char&gt;&gt;</ins>
</pre>
</blockquote>
<p>
-2- [&hellip;]
<p/>
-3- [&hellip;]
</p>
<pre>
<ins>explicit basic_dynamic_string_buffer(size_t maximum_size)</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Effects:</em> Default-constructs <tt>str_</tt>. Initializes <tt>size_</tt> with <tt>0</tt>, and 
<tt>max_size_</tt> with <tt>maximum_size</tt>.</ins>
</p>
<p>[&hellip;]</p>
</blockquote>
<pre>
explicit <ins>basic_</ins>dynamic_string_buffer(basic_string&lt;CharT, Traits, Allocator&gt;<del>&amp;</del> str) <del>noexcept</del>
</pre>
<blockquote>
<p>
-4- <em>Effects:</em> Initializes <tt>str_</tt> with <tt><ins>move(</ins>str<ins>)</ins></tt>,
  <tt>size_</tt> with <tt>str<ins>_</ins>.size()</tt>, and <tt>max_size_</tt> with <tt>str<ins>_</ins>.max_size()</tt>
</p>
</blockquote>
<pre>
<ins>basic_</ins>dynamic_string_buffer(string&lt;CharT, Traits, Allocator&gt;<del>&amp;</del> str,
                            size_t maximum_size) <del>noexcept</del>;
</pre>
<blockquote>
<p>
-5- <em>Requires:</em> <tt>str.size() &lt;= maximum_size</tt>.
</p>
<p>
-6- <em>Effects:</em> Initializes <tt>str_</tt> with <tt><ins>move(</ins>str<ins>)</ins></tt>,
  <tt>size_</tt> with <tt>str<ins>_</ins>.size()</tt>, and <tt>max_size_</tt> with <tt>maximum_size</tt>.
</p>
<p>[&hellip;]</p>
</blockquote>
<pre>
size_t max_size() const noexcept;
</pre>
<blockquote>
<p>
-8- <em>Returns:</em> <tt>max_size_</tt>.
</p>
</blockquote>
<pre>
<ins>void max_size(size_t maximum_size)</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Effects:</em> Performs <tt>max_size_ = maximum_size</tt>.</ins>
</p>
</blockquote>
<p>[&hellip;]</p>
<pre>
void consume(size_t n);
</pre>
<blockquote>
<p>
-15- <i>Effects:</i> [&hellip;]
</p>
</blockquote>
<pre>
<ins>basic_string_view&lt;CharT, Traits&gt; get() const noexcept</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Returns:</em> <tt>basic_string_view&lt;CharT, Traits&gt;(str_)</tt>.</ins>
</p>
</blockquote>
<pre>
<ins>value_type release()</ins>
</pre>
<blockquote>
<p>
<ins>-?- <em>Returns:</em> <tt>move(str_)</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Remove 16.14 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.dynamic.creation">[networking.ts::buffer.dynamic.creation]</a> entirely</p></li>

<li><p>Modify 17.5 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.read">[networking.ts::buffer.read]</a>, as indicated:</p>
<blockquote>
<pre>
[&hellip;]

template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b, error_code&amp; ec);
template&lt;class SyncReadStream, class DynamicBuffer,
  class CompletionCondition&gt;
    size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
                CompletionCondition completion_condition);
template&lt;class SyncReadStream, class DynamicBuffer,
  class CompletionCondition&gt;
    size_t read(SyncReadStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
                CompletionCondition completion_condition,
                error_code&amp; ec);

[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 17.6 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read">[networking.ts::buffer.async.read]</a>, as indicated:</p>
<blockquote>
<pre>
[&hellip;]

template&lt;class AsyncReadStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_read(AsyncReadStream&amp; stream,
                     DynamicBuffer&amp;<del>&amp;</del> b, CompletionToken&amp;&amp; token);
template&lt;class AsyncReadStream, class DynamicBuffer, class CompletionCondition,
  class CompletionToken&gt;
    <i>DEDUCED</i> async_read(AsyncReadStream&amp; stream,
                       DynamicBuffer&amp;<del>&amp;</del> b,
                       CompletionCondition completion_condition,
                       CompletionToken&amp;&amp; token);

[&hellip;]
</pre>
<p>
-14- The program shall ensure <ins>both</ins> the <tt>AsyncReadStream</tt>
object <tt>stream</tt> <ins>and the <tt>DynamicBuffer</tt> object <tt>b</tt>
are</ins><del> is</del> valid until the completion handler for the asynchronous
operation is invoked.
</p>
</blockquote>
</li>

<li><p>Modify 17.7 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.write">[networking.ts::buffer.write]</a>, as indicated:</p>
<blockquote><pre>
[&hellip;]

template&lt;class SyncWriteStream, class DynamicBuffer&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b);
template&lt;class SyncWriteStream, class DynamicBuffer&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b, error_code&amp; ec);
template&lt;class SyncWriteStream, class DynamicBuffer, class CompletionCondition&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
               CompletionCondition completion_condition);
template&lt;class SyncWriteStream, class DynamicBuffer, class CompletionCondition&gt;
  size_t write(SyncWriteStream&amp; stream, DynamicBuffer&amp;<del>&amp;</del> b,
               CompletionCondition completion_condition,
               error_code&amp; ec);

[&hellip;]
</pre></blockquote>
</li>

<li><p>Modify 17.8 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.write">[networking.ts::buffer.async.write]</a>, as indicated:</p>
<blockquote><pre>
[&hellip;]

template&lt;class AsyncWriteStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_write(AsyncWriteStream&amp; stream,
                      DynamicBuffer&amp;<del>&amp;</del> b, CompletionToken&amp;&amp; token);
template&lt;class AsyncWriteStream, class DynamicBuffer, class CompletionCondition,
  class CompletionToken&gt;
    <i>DEDUCED</i> async_write(AsyncWriteStream&amp; stream,
                        DynamicBuffer&amp;<del>&amp;</del> b,
                        CompletionCondition completion_condition,
                        CompletionToken&amp;&amp; token);

[&hellip;]
</pre>
<p>
-14- The program shall ensure both the <tt>AsyncWriteStream</tt> object
<tt>stream</tt> and the <ins><tt>DynamicBuffer</tt> object <tt>b</tt></ins>
<del>memory associated with the dynamic buffer <tt>b</tt></del>
are valid until the completion handler for the asynchronous operation
is invoked.
</p>
</blockquote>
</li>

<li><p>Modify 17.9 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.read.until">[networking.ts::buffer.read.until]</a>, as indicated:</p>
<blockquote><pre>
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b, char delim);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b,
                    char delim, error_code&amp; ec);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b, string_view delim);
template&lt;class SyncReadStream, class DynamicBuffer&gt;
  size_t read_until(SyncReadStream&amp; s, DynamicBuffer&amp;<del>&amp;</del> b,
                    string_view delim, error_code&amp; ec);

[&hellip;]
</pre></blockquote>
</li>

<li><p>Modify 17.10 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/buffer.async.read.until">[networking.ts::buffer.async.read.until]</a>, as indicated:</p>
<blockquote><pre>
template&lt;class AsyncReadStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_read_until(AsyncReadStream&amp; s,
                           DynamicBuffer&amp;<del>&amp;</del> b, char delim,
                           CompletionToken&amp;&amp; token);
template&lt;class AsyncReadStream, class DynamicBuffer, class CompletionToken&gt;
  <i>DEDUCED</i> async_read_until(AsyncReadStream&amp; s,
                           DynamicBuffer&amp;<del>&amp;</del> b, string_view delim,
                           CompletionToken&amp;&amp; token);

[&hellip;]
</pre>
<p>
-6- The program shall ensure <ins>both</ins> the <tt>AsyncReadStream</tt> object
<tt>stream</tt> <ins>and the <tt>DynamicBuffer</tt> object <tt>b</tt>
are</ins><del> is</del> valid until the completion handler for the
asynchronous operation is invoked.
</p>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3117" href="3117">3117.</a> Missing <tt>packaged_task</tt> deduction guides</h3>
<p><b>Section:</b> 32.9.10 <a href="https://timsong-cpp.github.io/cppwp/futures.task">[futures.task]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marc Mutz <b>Opened:</b> 2018-06-08 <b>Last modified:</b> 2020-02-14 08:01:28 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#futures.task">issues</a> in [futures.task].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>std::function</tt> has deduction guides, but <tt>std::packaged_task</tt>, which is otherwise very
similar, does not. This is surprising to users and I can think of no reason for the former
to be treated differently from the latter. I therefore propose to add deduction guides for
packaged task with the same semantics as the existing ones for function.
</p>

<p><i>[2018-06-23 after reflector discussion]</i></p>

<p>Priority set to 3</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.</p>

<ol>
<li><p>Modify 32.9.10 <a href="https://timsong-cpp.github.io/cppwp/futures.task">[futures.task]</a>, class template <tt>packaged_task</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
namespace std {
  [&hellip;]
  template&lt;class R, class... ArgTypes&gt;
  class packaged_task&lt;R(ArgTypes...)&gt; {
    [&hellip;]
  };
  
  <ins>template&lt;class R, class... ArgTypes&gt;
  packaged_task(R (*)( ArgTypes ...)) -&gt; packaged_task&lt;R( ArgTypes...)&gt;;

  template&lt;class F&gt; packaged_task(F) -&gt; packaged_task&lt;<i>see below</i>&gt;;</ins>
  
  template&lt;class R, class... ArgTypes&gt;
    void swap(packaged_task&lt;R(ArgTypes...)&gt;&amp; x, packaged_task&lt;R(ArgTypes...)&gt;&amp; y) noexcept;
}
</pre>
</blockquote>
</li>

<li><p>Modify 32.9.10.1 <a href="https://timsong-cpp.github.io/cppwp/futures.task.members">[futures.task.members]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class F&gt;
  packaged_task(F&amp;&amp; f);
</pre>
[&hellip;]
<pre>
<ins>template&lt;class F&gt; packaged_task(F) -&gt; packaged_task&lt;<i>see below</i>&gt;;</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Remarks:</i> This deduction guide participates in overload resolution only if <tt>&amp;F::operator()</tt> 
is well-formed when treated as an unevaluated operand. In that case, if <tt>decltype(&amp;F::operator())</tt> is of the 
form <tt>R(G::*)(A...) <i>cv</i> &amp;<sub><i>opt</i></sub> noexcept<sub><i>opt</i></sub></tt> for a class type <tt>G</tt>, 
then the deduced type is <tt>packaged_task&lt;R(A...)&gt;</tt>.</ins>
</p>
</blockquote>
[&hellip;]
<pre>
packaged_task(packaged_task&amp;&amp; rhs) noexcept;
</pre>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13; Prague]</i></p>

<p>
LWG improves wording matching Marshall's Mandating paper.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 32.9.10 <a href="https://timsong-cpp.github.io/cppwp/futures.task">[futures.task]</a>, class template <tt>packaged_task</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
namespace std {
  [&hellip;]
  template&lt;class R, class... ArgTypes&gt;
  class packaged_task&lt;R(ArgTypes...)&gt; {
    [&hellip;]
  };
  
  <ins>template&lt;class R, class... ArgTypes&gt;
  packaged_task(R (*)( ArgTypes ...)) -&gt; packaged_task&lt;R( ArgTypes...)&gt;;

  template&lt;class F&gt; packaged_task(F) -&gt; packaged_task&lt;<i>see below</i>&gt;;</ins>
  
  template&lt;class R, class... ArgTypes&gt;
    void swap(packaged_task&lt;R(ArgTypes...)&gt;&amp; x, packaged_task&lt;R(ArgTypes...)&gt;&amp; y) noexcept;
}
</pre>
</blockquote>
</li>

<li><p>Modify 32.9.10.1 <a href="https://timsong-cpp.github.io/cppwp/futures.task.members">[futures.task.members]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class F&gt;
  packaged_task(F&amp;&amp; f);
</pre>
[&hellip;]
<pre>
<ins>template&lt;class F&gt; packaged_task(F) -&gt; packaged_task&lt;<i>see below</i>&gt;;</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> <tt>&amp;F::operator()</tt> is well-formed when treated as an unevaluated operand 
and <tt>decltype(&amp;F::operator())</tt> is of the form <tt>R(G::*)(A...) <i>cv</i> &amp;<sub><i>opt</i></sub> 
noexcept<sub><i>opt</i></sub></tt> for a class type <tt>G</tt>.</ins>
<p/>
<ins>-?- <i>Remarks:</i> The deduced type is <tt>packaged_task&lt;R(A...)&gt;</tt>.</ins>
</p>
</blockquote>
[&hellip;]
<pre>
packaged_task(packaged_task&amp;&amp; rhs) noexcept;
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3118" href="3118">3118.</a> <tt>fpos</tt> equality comparison unspecified</h3>
<p><b>Section:</b> 29.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/fpos.operations">[fpos.operations]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-06-04 <b>Last modified:</b> 2018-06-25 00:47:25 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#fpos.operations">active issues</a> in [fpos.operations].</p>
<p><b>View all other</b> <a href="lwg-index.html#fpos.operations">issues</a> in [fpos.operations].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The <tt>fpos</tt> requirements do not give any idea what is compared by <tt>operator==</tt> (even after Daniel's 
<a href="http://wg21.link/p0759r1">P0759R1</a> paper). I'd like something to make it clear that <tt>return true;</tt> 
is not a valid implementation of <tt>operator==(const fpos&lt;T&gt;&amp;, const fpos&lt;T&gt;&amp;)</tt>. Maybe in the 
<tt>P(o)</tt> row state that "<tt>p == P(o)</tt>" and "<tt>p != P(o + 1)</tt>", i.e. two <tt>fpos</tt> objects 
constructed from the same <tt>streamoff</tt> values are equal, and two <tt>fpos</tt> objects constructed from two 
different <tt>streamoff</tt> values are not equal.
</p>

<p><i>[2018-06-23 after reflector discussion]</i></p>

<p>Priority set to 4</p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3120" href="3120">3120.</a> Unclear behavior of <tt>monotonic_buffer_resource::release()</tt></h3>
<p><b>Section:</b> 20.12.6.2 <a href="https://timsong-cpp.github.io/cppwp/mem.res.monotonic.buffer.mem">[mem.res.monotonic.buffer.mem]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Arthur O'Dwyer <b>Opened:</b> 2018-06-10 <b>Last modified:</b> 2018-08-27 14:39:57 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#mem.res.monotonic.buffer.mem">issues</a> in [mem.res.monotonic.buffer.mem].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The effects of <tt>monotonic_buffer_resource::release()</tt> are defined as:
</p>
<blockquote>
<p>
Calls <tt>upstream_rsrc-&gt;deallocate()</tt> as necessary to release all allocated memory.
</p>
</blockquote>
<p>
This doesn't give any instruction on what to do with the memory controlled by the <tt>monotonic_buffer_resource</tt> which 
was not allocated, i.e., what to do with the initial buffer provided to its constructor.
<p/>
Boost.Container's pmr implementation expels its initial buffer after a <tt>release()</tt>.
Arthur O'Dwyer's proposed pmr implementation for libc++ reuses the initial buffer after a <tt>release()</tt>, on the 
assumption that this is what the average library user will be expecting.
</p>
<blockquote>
<pre>
#include &lt;memory_resource&gt;

int main() 
{
  char buffer[100];
  {
    std::pmr::monotonic_buffer_resource mr(buffer, 100, std::pmr::null_memory_resource());
    mr.release();
    mr.allocate(60);  // A
  }
  {
    std::pmr::monotonic_buffer_resource mr(buffer, 100, std::pmr::null_memory_resource());
    mr.allocate(60);  // B
    mr.release();
    mr.allocate(60);  // C
  }
}
</pre>
</blockquote>
<p>
Assume that allocation "B" always succeeds.<br/>
With the proposed libc++ implementation, allocations "A" and "C" both succeed.<br/>
With Boost.Container's implementation, allocations "A" and "C" both fail.<br/>
Using another plausible implementation strategy, allocation "A" could succeed but allocation "C" 
could fail. I have been informed that MSVC's implementation does this.
<p/>
Which of these strategies should be permitted by the Standard?
<p/>
Arthur considers "A and C both succeed" to be the obviously most user-friendly strategy, and really 
really hopes it's going to be permitted. Requiring "C" to succeed is unnecessary (and would render MSVC's 
current implementation non-conforming) but could help programmers concerned with portability between 
different implementations.
<p/>
Another side-effect of <tt>release()</tt> which goes underspecified by the Standard is the effect of 
<tt>release()</tt> on <tt>next_buffer_size</tt>. As currently written, my interpretation is that 
<tt>release()</tt> is not permitted to decrease <tt>current_buffer_size</tt>; I'm not sure if this 
is a feature or a bug.
<p/>
Consider this test case (taken from <a href="https://reviews.llvm.org/D47111#inline-421469">here</a>):
</p>
<blockquote>
<pre>
std::pmr::monotonic_buffer_resource mr(std::pmr::new_delete_resource());
for (int i=0; i &lt; 100; ++i) {
  mr.allocate(1);  // D
  mr.release();
}
</pre>
</blockquote>
<p>
Arthur believes it is important that the 100<sup>th</sup> invocation of line "D" does not attempt to allocate 
2<sup>100</sup> bytes from the upstream resource.
</p>

<p><i>[2018-06-23 after reflector discussion]</i></p>

<p>Priority set to 2</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The resolution depicted below would make MSVC's and my-proposed-libc++'s implementations 
both conforming.]</p>
</blockquote>

<ol>
<li><p>Modify 20.12.6.2 <a href="https://timsong-cpp.github.io/cppwp/mem.res.monotonic.buffer.mem">[mem.res.monotonic.buffer.mem]</a> as indicated:</p>
<blockquote>
<pre>
void release();
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Calls <tt>upstream_rsrc-&gt;deallocate()</tt> as necessary to release all allocated memory. 
<ins>Resets the state of the initial buffer.</ins>
<p/>
-2- [<i>Note:</i> The memory is released back to <tt>upstream_rsrc</tt> even if some blocks that were allocated from
this have not been deallocated from this. <ins>This function has an unspecified effect on <tt>next_buffer_size</tt>.</ins> 
&mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>We liked Pablo's wording from the reflector discussion. Status to Open.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.</p>

<ol>
<li><p>Modify 20.12.6.2 <a href="https://timsong-cpp.github.io/cppwp/mem.res.monotonic.buffer.mem">[mem.res.monotonic.buffer.mem]</a> as indicated:</p>
<blockquote>
<pre>
void release();
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Calls <tt>upstream_rsrc-&gt;deallocate()</tt> as necessary to release all allocated memory. 
<ins>Resets <tt>*this</tt> to its initial state at construction.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3121" href="3121">3121.</a> <tt>tuple</tt> constructor constraints for <tt>UTypes&amp;&amp;...</tt> overloads</h3>
<p><b>Section:</b> 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Matt Calabrese <b>Opened:</b> 2018-06-12 <b>Last modified:</b> 2018-11-12 05:21:03 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#tuple.cnstr">active issues</a> in [tuple.cnstr].</p>
<p><b>View all other</b> <a href="lwg-index.html#tuple.cnstr">issues</a> in [tuple.cnstr].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Currently the <tt>tuple</tt> constructors of the form:
</p>
<blockquote>
<pre>
template&lt;class... UTypes&gt;
<i>EXPLICIT</i> constexpr tuple(UTypes&amp;&amp;...);
</pre>
</blockquote>
<p>
are not properly constrained in that in the 1-element <tt>tuple</tt> case, the constraints do no short-circuit when 
the constructor would be (incorrectly) considered as a possible copy/move constructor candidate. libc++ has a 
workaround for this, but the additional short-circuiting does not actually appear in the working draft.
<p/>
As an example of why this lack of short circuiting is a problem in practice, consider the following line:
</p>
<blockquote>
<pre>
bool a = std::is_copy_constructible_v&lt;std::tuple&lt;any&gt;&gt;;
</pre>
</blockquote>
<p>
The above code will cause a compile error because of a recursive trait definition. The copy constructibility 
check implies doing substitution into the <tt>UTypes&amp;&amp;...</tt> constructor overloads, which in turn 
will check if <tt>tuple&lt;any&gt;</tt> is convertible to any, which in turn will check if <tt>tuple&lt;any&gt;</tt> 
is copy constructible (and so the trait is dependent on itself).
<p/>
I do not provide wording for the proposed fix in anticipation of requires clauses potentially changing how we 
do the specification, however, the basic solution should be similar to what we've done for other standard library 
types, which is to say that the very first constraint should be to check that if <tt>sizeof...(UTypes) == 1</tt> 
and the type, after applying <tt>remove_cvref_t</tt>, is the <tt>tuple</tt> type itself, then we should force 
substitution failure rather than checking any further constraints.
</p>

<p><i>[2018-06-23 after reflector discussion]</i></p>

<p>Priority set to 3</p>

<p><i>[2018-08-20, Jonathan provides wording]</i></p>


<p><i>[2018-08-20, Daniel comments]</i></p>

<p>
The wording changes by this issue are very near to those suggested for LWG <a href="3155">3155</a>.
</p>

<p><i>[2018-11 San Diego Thursday night issue processing]</i></p>

<p>Jonathan to update wording - using conjunction. Priority set to 2</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ul>
<li><p>Modify 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class... UTypes&gt; explicit(<i>see below</i>) constexpr tuple(UTypes&amp;&amp;... u);
</pre>
<blockquote>
<p>
-9- <i>Effects:</i> Initializes the elements in the tuple with the corresponding value in 
<tt>std::forward&lt;UTypes&gt;(u)</tt>.
<p/>
-10- <i>Remarks:</i> This constructor shall not participate in overload resolution unless 
<tt>sizeof...(Types) == sizeof...(UTypes)</tt> and <tt>sizeof...(Types) &gt;= 1</tt> <ins>and <tt>(sizeof...(Types) 
&gt; 1 || !is_same_v&lt;remove_cvref_t&lt;U<sub>0</sub>&gt;, tuple&gt;)</tt></ins> and 
<tt>is_constructible_v&lt;T<sub><i>i</i></sub>, U<sub><i>i</i></sub>&amp;&amp;&gt;</tt> is <tt>true</tt> 
for all <tt><i>i</i></tt>. The expression inside <tt>explicit</tt> is equivalent to:
<p/>
<tt>!conjunction_v&lt;is_convertible&lt;UTypes, Types&gt;...&gt;</tt>
</p>
</blockquote>
</blockquote>
</li>
</ul>





<hr>
<h3><a name="3123" href="3123">3123.</a> <tt>duration</tt> constructor from representation shouldn't be effectively non-throwing</h3>
<p><b>Section:</b> 27.5 <a href="https://timsong-cpp.github.io/cppwp/time.duration">[time.duration]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2018-06-22 <b>Last modified:</b> 2018-06-27 19:02:12 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#time.duration">issues</a> in [time.duration].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[time.duration]/4 states:
</p>
<blockquote><p>
Members of duration shall not throw exceptions other than those thrown by the indicated operations on their representations.
</p></blockquote>
<p>
Where representation is defined in the non-normative, brief description at [time.duration]/1:
</p>
<blockquote><p>
[&hellip;] A duration has a representation which holds a count of ticks and a tick period. [&hellip;]
</p></blockquote>
<p>
[time.duration.cons]/2 doesn't indicate the operation undergone by its representation, merely stating a postcondition in [time.duration.cons]/3:
</p>
<blockquote>
<p>
<i>Effects:</i> Constructs an object of type <tt>duration</tt>.
<p/>
<i>Postconditions:</i> <tt>count() == static_cast&lt;rep&gt;(r)</tt>.
</p>
</blockquote>
<p>
I suggest this reformulation that follows the format of [time.duration.cons]/5.
</p>
<blockquote>
<p>
<i>Effects:</i> Constructs an object of type duration, constructing <tt>rep_</tt> from <tt>r</tt>.
</p>
</blockquote>
<p>
Now it is clear why the constructor would throw.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.
</p>

<p>Change 27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep2&gt;
  constexpr explicit duration(const Rep2&amp; r);
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This constructor shall not participate in overload resolution unless [&hellip;]
<p/>
-2- <i>Effects:</i> Constructs an object of type <tt>duration</tt><ins>, constructing <tt>rep_</tt> from <tt>r</tt></ins>.
<p/>
-3- <i>Postconditions:</i> <tt>count() == static_cast&lt;rep&gt;(r)</tt>.
</p>
</blockquote>
</blockquote></blockquote>

<p><i>[2018-06-27 after reflector discussion]</i></p>

<p>Priority set to 3. Improved wording as result of that discussion.</p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.
</p>

<p>Change 27.5.1 <a href="https://timsong-cpp.github.io/cppwp/time.duration.cons">[time.duration.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Rep2&gt;
  constexpr explicit duration(const Rep2&amp; r);
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> This constructor shall not participate in overload resolution unless [&hellip;]
<p/>
-2- <i>Effects:</i> <del>Constructs an object of type <tt>duration</tt></del><ins>Initializes <tt>rep_</tt> with <tt>r</tt></ins>.
<p/>
<del>-3- <i>Postconditions:</i> <tt>count() == static_cast&lt;rep&gt;(r)</tt>.</del>
</p>
</blockquote>
</blockquote>





<hr>
<h3><a name="3124" href="3124">3124.</a> [networking.ts] Unclear how <tt>execution_context</tt> is intended to store services</h3>
<p><b>Section:</b> 13.7.5 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/async.exec.ctx.globals">[networking.ts::async.exec.ctx.globals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-06-23 <b>Last modified:</b> 2018-07-20 21:06:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<b>Addresses: networking.ts</b>
<p>
<tt>make_service</tt> and <tt>use_service</tt> create arbitrary numbers of type <tt>Service</tt>, a type provided 
by the user, similar to how locale's <tt>use_facet</tt> works. As a result there's no amount of storage that could 
be reserved inside <tt>execution_context</tt> to avoid allocating memory. However, there's no allocator support 
here, and <tt>make_service</tt> is forbidden from throwing allocation related exceptions by 
<a href="http://wg21.link/n4734">N4734</a> [async.exec.ctx.globals]/7.
<p/>
If the intent is for <tt>execution_context</tt> to allocate memory, are user overloads of <tt>operator new</tt> 
on type <tt>Service</tt> intended to be used?
</p>

<p><i>[2018-07-20 Priority set to 3 after reflector discussion]</i></p>

<p><i>[Jonathan provides wording.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to the N4762.</p>

<ol>
<li><p>Modify 13.7.5 <a href="https://timsong-cpp.github.io/cppwp/networking-ts/async.exec.ctx.globals">[networking.ts::async.exec.ctx.globals]</a> p7:</p>
<p>
-7- <i>Throws:</i> <tt>service_already_exists</tt> if a corresponding service object of type <tt>Service::key_type</tt> is
already present in the set <ins>, <tt>bad_alloc</tt>, or an implementation-defined exception when a resource other than memory could
not be obtained. Any exception thrown by the constructor of <tt>Service</tt></ins>.
</p>
</li>
</ol>





<hr>
<h3><a name="3125" href="3125">3125.</a> <tt>duration</tt> streaming precondition should be a SFINAE condition</h3>
<p><b>Section:</b> 27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2018-06-23 <b>Last modified:</b> 2020-02-13 18:38:05 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.duration.io">active issues</a> in [time.duration.io].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.duration.io">issues</a> in [time.duration.io].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a>/1 states:
</p>
<blockquote>
<pre>
template&lt;class charT, class traits, class Rep, class Period&gt;
  basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const duration&lt;Rep, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
<i>Requires:</i> <tt>Rep</tt> is an integral type whose integer conversion rank (6.8.4 <a href="https://timsong-cpp.github.io/cppwp/conv.rank">[conv.rank]</a>) is greater 
than or equal to that of <tt>short</tt>, or a floating point type. <tt>charT</tt> is <tt>char</tt> or <tt>wchar_t</tt>.
</p>
</blockquote>
</blockquote>
<p>
I think the intention was to make this a compile-time error, since all the information to make it so is available 
at compile-time. But the wording doesn't suggest that.
</p>
<p><i>[2018-06-29; Daniel comments]</i></p>

<p>
The wording will be significantly simplified by the application of the new Library element <i>Constraints:</i> 
introduced by <a href="http://wg21.link/p0788r3">P0788R3</a> and available with the post-Rapperswil working draft.
</p>

<p><i>[2018-07-20 Priority set to 2 after reflector discussion. NAD and P0 were also mentioned.]</i></p>


<p><i>[2018-08-23 Batavia Issues processing]</i></p>

<p>Marshall to talk to Howard about his intent. Status to Open</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>
This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.
</p>

<p>Change 27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The suggested wording changes include the insertion of two bullets into the existing running text
to improve clarification of the logic arm of the "unless"].
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class charT, class traits, class Rep, class Period&gt;
  basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const duration&lt;Rep, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
-1- <i><del>Requires</del><ins>Remarks</ins>:</i> <ins>This function shall not participate in overload resolution 
unless:</ins>
</p>
<ul>
<li><p><tt>Rep</tt> is an integral type whose integer conversion rank (6.8.4 <a href="https://timsong-cpp.github.io/cppwp/conv.rank">[conv.rank]</a>) is 
greater than or equal to that of <tt>short</tt>, or a floating point type<del>.</del><ins>, and</ins></p></li>
<li><p><tt>charT</tt> is <tt>char</tt> or <tt>wchar_t</tt></p></li>
</ul>
<p>
[&hellip;]
</p>
</blockquote>
</blockquote>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Will be resolved by LWG <a href="3317">3317</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>





<hr>
<h3><a name="3126" href="3126">3126.</a> There's no <tt>std::sub_match::compare(string_view)</tt> overload</h3>
<p><b>Section:</b> 30.9 <a href="https://timsong-cpp.github.io/cppwp/re.submatch">[re.submatch]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-06-26 <b>Last modified:</b> 2018-07-20 21:06:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.submatch">active issues</a> in [re.submatch].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.submatch">issues</a> in [re.submatch].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>std::sub_match::compare</tt> can be called with a <tt>basic_string</tt> or a pointer to a null-terminated 
character sequence, but can't be called with a <tt>basic_string_view</tt>. To compare to a <tt>string_view</tt> 
requires either conversion to <tt>basic_string</tt> (with a potential allocation) or a redundant call to 
<tt>traits_type::length</tt> to calculate a length that is already known.
</p>

<p><i>[2018-07-02, Jonathan comments and completes proposed wording]</i></p>

<p>
To make the relational and equality operators for <tt>sub_match</tt> support string views I propose specifying 
the semantics, not adding another 12 overloaded operators to namespace <tt>std</tt>, in addition to the 42 
already there. This allows them to be implemented as "hidden friends" if the implementation so desires, or to 
retain namespace-scope declaration if backwards compatibility with C++11 - C++17 is preferred.
</p>

<p><i>[2018-07-20 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4750">N4750</a>.
</p>

<ol>
<li>
<p>Change 30.4 <a href="https://timsong-cpp.github.io/cppwp/re.syn">[re.syn]</a>, header <tt>&lt;regex&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
#include &lt;initializer_list&gt;

namespace std {
  [&hellip;]
  using csub_match = sub_match&lt;const char*&gt;;
  using wcsub_match = sub_match&lt;const wchar_t*&gt;;
  using ssub_match = sub_match&lt;string::const_iterator&gt;;
  using wssub_match = sub_match&lt;wstring::const_iterator&gt;;

  <del><i>// 30.9.2 <a href="https://timsong-cpp.github.io/cppwp/re.submatch.op">[re.submatch.op]</a>, sub_match non-member operators</i>
  template&lt;class BiIter&gt;
  bool operator==(const sub_match&lt;BiIter&gt;&amp; lhs, const sub_match&lt;BiIter&gt;&amp; rhs);
  [&hellip;]
  template&lt;class BiIter&gt;
    bool operator&gt;=(const sub_match&lt;BiIter&gt;&amp; lhs,
                   const typename iterator_traits&lt;BiIter&gt;::value_type&amp; rhs);</del>

  template&lt;class charT, class ST, class BiIter&gt;
  basic_ostream&lt;charT, ST&gt;&amp;
  operator&lt;&lt;(basic_ostream&lt;charT, ST&gt;&amp; os, const sub_match&lt;BiIter&gt;&amp; m);
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li>
<p>Change 30.9 <a href="https://timsong-cpp.github.io/cppwp/re.submatch">[re.submatch]</a>, class template <tt>sub_match</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;class BidirectionalIterator&gt;
  class sub_match : public pair&lt;BidirectionalIterator, BidirectionalIterator&gt; {
  public:
    using value_type =
      typename iterator_traits&lt;BidirectionalIterator&gt;::value_type;
    [&hellip;]
    int compare(const sub_match&amp; s) const;
    int compare(const string_type&amp; s) const;
    int compare(const value_type* s) const;
    <ins>int compare(basic_string_view&lt;value_type&gt; s) const;</ins>
  };
}
</pre>
</blockquote>
</li>

<li>
<p>Change 30.9.1 <a href="https://timsong-cpp.github.io/cppwp/re.submatch.members">[re.submatch.members]</a> as indicated:</p>

<blockquote>
<pre>
int compare(const value_type* s) const;
</pre>
<blockquote>
<p>
-7- <i>Returns:</i> <tt>str().compare(s)</tt>.
</p>
</blockquote>
<pre>
<ins>int compare(basic_string_view&lt;value_type&gt; s) const;</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Returns:</i> <tt>str().compare(s)</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>

<li>
<p>Change sub-clause 30.9.2 <a href="https://timsong-cpp.github.io/cppwp/re.submatch.op">[re.submatch.op]</a> as indicated:</p>

<blockquote>
<p>
<b>31.9.2 <tt>sub_match</tt> non-member operators [re.submatch.op]</b>
</p>
<pre><del>template&lt;class BiIter&gt;
bool operator==(const sub_match&lt;BiIter&gt;&amp; lhs, const sub_match&lt;BiIter&gt;&amp; rhs);</del></pre>
<blockquote>
<p>
<del>-1- <i>Returns:</i> <tt>lhs.compare(rhs) == 0</tt>.</del>
</p>
</blockquote>
<del>[&hellip;]</del>
<pre>
<del>template&lt;class BiIter&gt;
  bool operator&gt;=(const sub_match&lt;BiIter&gt;&amp; lhs,
    const typename iterator_traits&lt;BiIter&gt;::value_type&amp; rhs);</del></pre>
<blockquote>
<p>
<del>-42- <i>Returns:</i> <tt>!(lhs &lt; rhs)</tt>.</del>
</p>
</blockquote>
<pre>
template&lt;class charT, class ST, class BiIter&gt;
  basic_ostream&lt;charT, ST&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, ST&gt;&amp; os, const sub_match&lt;BiIter&gt;&amp; m);</pre>
<blockquote>
<p>
-43- <i>Returns:</i> <tt>os &lt;&lt; m.str()</tt>.
</p>
</blockquote>
<p>
<ins>Class template <tt>sub_match</tt> provides overloaded relational operators (7.6.9 <a href="https://timsong-cpp.github.io/cppwp/expr.rel">[expr.rel]</a>) and 
equality operators (7.6.10 <a href="https://timsong-cpp.github.io/cppwp/expr.eq">[expr.eq]</a>) for comparisons with another <tt>sub_match</tt>, with a <tt>string</tt>, 
or with a single character. The expressions shown in Table ?? are valid when one of the operands is a type <tt>S</tt>, 
that is a specialization of <tt>sub_match</tt>, and the other expression is one of:</ins>
</p>
<ol style="list-style-type: none">
<li><p><ins>(?.?) &mdash; a value <tt>x</tt> of a type <tt>S</tt>, in which case <tt><i>STR</i>(x)</tt> is 
<tt>x.str()</tt>;</ins></p></li>
<li><p><ins>(?.?) &mdash; a value <tt>x</tt> of type <tt>basic_string&lt;S::value_type, T, A&gt;</tt> for any types 
<tt>T</tt> and <tt>A</tt>, in which case <tt><i>STR</i>(x)</tt> is 
<tt>basic_string_view&lt;S::value_type&gt;(x.data(), x.length())</tt>;</ins></p></li>
<li><p><ins>(?.?) &mdash; a value <tt>x</tt> of type <tt>basic_string_view&lt;S::value_type, T&gt;</tt> for 
any type <tt>T</tt>, in which case <tt><i>STR</i>(x)</tt> is 
<tt>basic_string_view&lt;S::value_type&gt;(x.data(), x.length())</tt>;</ins></p></li>
<li><p><ins>(?.?) &mdash; a value <tt>x</tt> of a type convertible to <tt>const S::value_type*</tt>, in which 
case <tt><i>STR</i>(x)</tt> is <tt>basic_string_view&lt;S::value_type&gt;(x)</tt>;</ins></p></li>
<li><p><ins>(?.?) &mdash; a value <tt>x</tt> of type convertible to <tt>S::value_type</tt>, in which case 
<tt><i>STR</i>(x)</tt> is <tt>basic_string_view&lt;S::value_type&gt;(&amp;x, 1)</tt>.</ins></p></li>
</ol>
<table border="1">
<caption><ins>Table ?? &mdash; <tt>sub_match</tt> comparisons</ins></caption>
<tr style="text-align:center">
<th><ins>Expression</ins></th>
<th><ins>Return type</ins></th>
<th><ins>Operational<br/>semantics</ins></th>
</tr>
<tr>
<td>
<ins><tt>s == t</tt></ins>
</td>
<td>
<ins><tt>bool</tt></ins>
</td>
<td>
<ins><tt><i>STR</i>(s).compare(<i>STR</i>(t)) == 0</tt></ins>
</td>
</tr>
<tr>
<td>
<ins><tt>s != t</tt></ins>
</td>
<td>
<ins><tt>bool</tt></ins>
</td>
<td>
<ins><tt><i>STR</i>(s).compare(<i>STR</i>(t)) != 0</tt></ins>
</td>
</tr>
<tr>
<td>
<ins><tt>s &lt; t</tt></ins>
</td>
<td>
<ins><tt>bool</tt></ins>
</td>
<td>
<ins><tt><i>STR</i>(s).compare(<i>STR</i>(t)) &lt; 0</tt></ins>
</td>
</tr>
<tr>
<td>
<ins><tt>s &gt; t</tt></ins>
</td>
<td>
<ins><tt>bool</tt></ins>
</td>
<td>
<ins><tt><i>STR</i>(s).compare(<i>STR</i>(t)) &gt; 0</tt></ins>
</td>
</tr>
<tr>
<td>
<ins><tt>s &lt;= t</tt></ins>
</td>
<td>
<ins><tt>bool</tt></ins>
</td>
<td>
<ins><tt><i>STR</i>(s).compare(<i>STR</i>(t)) &lt;= 0</tt></ins>
</td>
</tr>
<tr>
<td>
<ins><tt>s &gt;= t</tt></ins>
</td>
<td>
<ins><tt>bool</tt></ins>
</td>
<td>
<ins><tt><i>STR</i>(s).compare(<i>STR</i>(t)) &gt;= 0</tt></ins>
</td>
</tr>
</table>

</blockquote>
</li>

</ol>





<hr>
<h3><a name="3135" href="3135">3135.</a> [fund.ts.v3] LFTSv3 contains two redundant alias templates</h3>
<p><b>Section:</b> 3.3.1 [fund.ts.v3::meta.type.synop], 5.1 [fund.ts.v3::header.memory.synop] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Thomas K&ouml;ppe <b>Opened:</b> 2018-07-02 <b>Last modified:</b> 2018-07-20 21:06:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#fund.ts.v3::meta.type.synop">issues</a> in [fund.ts.v3::meta.type.synop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v3</b></p>
<p>
The LFTSv3 prospective-working-paper <a href="http://wg21.link/n4758">N4758</a> contains two aliases 
that are already in C++17:
</p>
<ul>
<li><p><tt>void_t</tt> in 3.3.1 [fund.ts.v3::meta.type.synop]</p></li>
<li><p><tt>uses_allocator_v</tt> in 5.1 [fund.ts.v3::header.memory.synop]</p></li>
</ul>
<p>
I'd like to propose deleting both, but separate discussion is warranted:
<p/>
<tt>void_t</tt> belongs with the larger "detection idiom", which has not been merged into C++17. We may prefer 
to keep our own local version of the alias.
<p/>
<tt>uses_allocator_v</tt> aliases a version of <tt>uses_allocator</tt> that is modified by this TS. However, 
as specified the alias may actually end up referring to <tt>std::uses_allocator</tt> (because 
<tt>&lt;memory&gt;</tt> is included), not to <tt>std::experimental::uses_allocator</tt>, as may have been intended.
</p>

<p><i>[2018-07-20 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3136" href="3136">3136.</a> [fund.ts.v3] LFTSv3 awkward wording in <tt>propagate_const</tt> requirements</h3>
<p><b>Section:</b> 3.2.2.2.1 [fund.ts.v3::propagate_const.class_type_requirements] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Thomas K&ouml;ppe <b>Opened:</b> 2018-07-02 <b>Last modified:</b> 2018-07-20 21:06:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v3</b></p>
<p>
In the LFTSv3 prospective-working-paper <a href="http://wg21.link/n4758">N4758</a>, [propagate_const.class_type_requirements] 
uses a strange turn of phrase:
</p>
<blockquote><p>
"In this sub-clause, <tt>t</tt> denotes a non-<tt>const</tt> lvlaue of type <tt>T</tt>, <tt>ct</tt> is a <tt>const T&amp;</tt> 
bound to <tt>t</tt>, [&hellip;]"
</p></blockquote>
<p>
The last bit is strange: "<tt>ct</tt> is a <tt>const T&amp;</tt> bound to <tt>t</tt>" is not how we usually say things. 
The specification-variables usually denote values, and values can't be references. Perhaps we could just say, 
"<tt>ct</tt> is <tt>as_const(t)</tt>"?
</p>

<p><i>[2018-07-20 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4758">N4758</a>.
</p>

<ol>
<li>
<p>
Edit 3.2.2.2.1 [fund.ts.v3::propagate_const.class_type_requirements] as indicated:
</p>
<blockquote>
<p>
-1- If <tt>T</tt> is class type then it shall satisfy the following requirements. In this sub-clause <tt>t</tt> denotes 
a non-<tt>const</tt> lvalue of type <tt>T</tt>, <tt>ct</tt> is <del>a 
<tt>const T&amp;</tt> bound to <tt>t</tt></del><ins><tt>as_const(t)</tt></ins>, <tt>element_type</tt> denotes an object type. 
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3141" href="3141">3141.</a> <tt>CopyConstructible</tt> doesn't preserve source values</h3>
<p><b>Section:</b> 18.6 <a href="https://timsong-cpp.github.io/cppwp/concepts.object">[concepts.object]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-07-07 <b>Last modified:</b> 2020-02-14 09:37:04 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>

<p>
The design intent of the <tt>CopyConstructible</tt> concept has always been that the source of the
constructions it requires be left unmodified. Before <a href="https://wg21.link/p0541r1">P0541R1</a>
reformulated the <tt>Constructible</tt> concept in terms of <tt>is_constructible</tt>, the wording
which is now in 18.2 <a href="https://timsong-cpp.github.io/cppwp/concepts.equality">[concepts.equality]</a>/5:
<blockquote>
This document uses a notational convention to specify which expressions declared in a
<i>requires-expression</i> modify which inputs: except where otherwise specified, [&hellip;] Operands that
are constant lvalues or rvalues are required to not be modified.
</blockquote>
indirectly enforced that requirement. Unfortunately, <em>nothing</em> in the current wording in
18.4.14 <a href="https://timsong-cpp.github.io/cppwp/concept.copyconstructible">[concept.copyconstructible]</a> enforces that requirement.
</p>

<p><i>[2018-11 Reflector prioritization]</i></p>

<p>Set Priority to 2</p>

<strong>Previous resolution: [SUPERSEDED]</strong>

<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<p>Change 18.4.14 <a href="https://timsong-cpp.github.io/cppwp/concept.copyconstructible">[concept.copyconstructible]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class T&gt;
  concept CopyConstructible =
    MoveConstructible&lt;T&gt; &amp;&amp;
    Constructible&lt;T, T&amp;&gt; &amp;&amp; ConvertibleTo&lt;T&amp;, T&gt; &amp;&amp;
    Constructible&lt;T, const T&amp;&gt; &amp;&amp; ConvertibleTo&lt;const T&amp;, T&gt; &amp;&amp;
    Constructible&lt;T, const T&gt; &amp;&amp; ConvertibleTo&lt;const T, T&gt;;
</pre>
<p>
-1- If <tt>T</tt> is an object type, then let <tt>v</tt> be an lvalue of type (possibly <tt>const</tt>)
<tt>T</tt> or an rvalue of type <tt>const T</tt>. <tt>CopyConstructible&lt;T&gt;</tt> is satisfied
only if
</p><p>
(1.1) &mdash; After the definition <tt>T u = v;</tt>, <tt>u</tt> is equal to <tt>v</tt> <ins>and
<tt>v</tt> is unmodified</ins>.
</p><p>
(1.2) &mdash; <tt>T(v)</tt> is equal to <tt>v</tt> <ins>and does not modify <tt>v</tt></ins>.
</p>
</blockquote>
</blockquote>

<p><i>[2020-02-13 Per LWG review, Casey provides updated P/R wording.]</i></p>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<p>Change 18.4.14 <a href="https://timsong-cpp.github.io/cppwp/concept.copyconstructible">[concept.copyconstructible]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class T&gt;
  concept copy_constructible =
    move_constructible&lt;T&gt; &amp;&amp;
    constructible_from&lt;T, T&amp;&gt; &amp;&amp; convertible_to&lt;T&amp;, T&gt; &amp;&amp;
    constructible_from&lt;T, const T&amp;&gt; &amp;&amp; convertible_to&lt;const T&amp;, T&gt; &amp;&amp;
    constructible_from&lt;T, const T&gt; &amp;&amp; convertible_to&lt;const T, T&gt;;
</pre>
<p>
-1- If <tt>T</tt> is an object type, then let <tt>v</tt> be an lvalue of type (possibly <tt>const</tt>)
<tt>T</tt> or an rvalue of type <tt>const T</tt>. <tt>T</tt> models <tt>copy_constructible</tt> only if
</p><p>
(1.1) &mdash; After the definition <tt>T u = v;</tt>, <tt>u</tt> is equal to <tt>v</tt> <ins>(18.2 <a href="https://timsong-cpp.github.io/cppwp/concepts.equality">[concepts.equality]</a>) and
<tt>v</tt> is not modified</ins>.
</p><p>
(1.2) &mdash; <tt>T(v)</tt> is equal to <tt>v</tt> <ins>and does not modify <tt>v</tt></ins>.
</p>
</blockquote>






<hr>
<h3><a name="3142" href="3142">3142.</a> <tt>std::foo&lt;incomplete&gt;</tt> should be ill-formed NDR</h3>
<p><b>Section:</b> 16.5.4.8 <a href="https://timsong-cpp.github.io/cppwp/res.on.functions">[res.on.functions]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-07-07 <b>Last modified:</b> 2018-11-27 04:34:19 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#res.on.functions">issues</a> in [res.on.functions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>

<p>
16.5.4.8 <a href="https://timsong-cpp.github.io/cppwp/res.on.functions">[res.on.functions]</a>/2 states:
<blockquote>
<p>
-2- In particular, the effects are undefined in the following cases:
</p><p>
[&hellip;]
</p><p>
(2.5) &mdash; if an incomplete type (6.8 <a href="https://timsong-cpp.github.io/cppwp/basic.types">[basic.types]</a>) is used as a template argument
when instantiating a template component or evaluating a concept, unless specifically allowed for
that component.
</p>
</blockquote>
While undefined behavior is appropriate for the other cases specified in the earlier bullets, which
describe failure to meet (runtime) semantic requirements, "instantiating a template component or
evaluating a concept" with an incomplete type happens at compile-time, and could potentially be
diagnosed. It would therefore be more appropriate to specify that programs which do so are
ill-formed with no diagnostic required.
</p>

<p><i>[2018-11 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>

<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<p>Change 16.5.4.8 <a href="https://timsong-cpp.github.io/cppwp/res.on.functions">[res.on.functions]</a> as indicated:</p>
<blockquote>
<p>
<del>(2.5) &mdash; if an incomplete type (6.8 <a href="https://timsong-cpp.github.io/cppwp/basic.types">[basic.types]</a>) is used as a template
argument when instantiating a template component or evaluating a concept, unless specifically
allowed for that component.</del>
</p><p>
<ins>-?- Unless explicitly stated otherwise, a program that instantiates a template component or
evaluates a concept with an incomplete type (6.8 <a href="https://timsong-cpp.github.io/cppwp/basic.types">[basic.types]</a>) as a template argument is
ill-formed with no diagnostic required.</ins>
</p>
</blockquote>






<hr>
<h3><a name="3143" href="3143">3143.</a> <tt>monotonic_buffer_resource</tt> growth policy is unclear</h3>
<p><b>Section:</b> 20.12.6 <a href="https://timsong-cpp.github.io/cppwp/mem.res.monotonic.buffer">[mem.res.monotonic.buffer]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-07-20 <b>Last modified:</b> 2020-02-13 15:53:10 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
During the discussion of LWG <a href="3120">3120</a> it was pointed out that the current
wording in 20.12.6 <a href="https://timsong-cpp.github.io/cppwp/mem.res.monotonic.buffer">[mem.res.monotonic.buffer]</a> is contradictory. The introductory text for 
the class says "Each additional buffer is larger than the previous one, following 
a geometric progression" but the spec for <tt>do_allocate</tt> doesn't agree.
<p/>
Firstly, it's impossible for the implementation to ensure a single geometric progression, 
because the size of the next buffer can be arbitrarily large. If the caller asks for an 
allocation that is <tt>N</tt> times bigger than the previous buffer, the next buffer will be at
least <tt>N</tt> times larger than the previous one. If <tt>N</tt> is larger than the
implementation-defined growth factor it's not a geometric progression.
<p/>
Secondly, it's not even clear that each additional buffer will be larger than the previous one. 
Given a <tt>monotonic_buffer_resource</tt> object with little remaining space in <tt>current_buffer</tt>, 
a request to allocate <tt>10*next_buffer_size</tt> will:
<p/>
"set <tt>current_buffer</tt> to <tt>upstream_rsrc-&gt;allocate(n, m)</tt>, where <tt>n</tt> is not
less than <tt>max(bytes, next_buffer_size)</tt> and <tt>m</tt> is not less than <tt>alignment</tt>, 
and increase <tt>next_buffer_size</tt> by an implementation-defined growth factor (which need not 
be integral), then allocate the return block from the newly-allocated <tt>current_buffer</tt>."
<p/>
The effects are to allocate a new buffer of at least <tt>max(10*next_buffer_size, next_buffer_size)</tt> 
bytes, and then do <tt>next_buffer_size *= growth_factor</tt>. If <tt>growth_factor &lt; 10</tt> then 
the next allocated buffer might be smaller than the last one. This means that although 
<tt>next_buffer_size</tt> itself follows a geometric progression, the actual size of any single 
allocated buffer can be much larger than <tt>next_buffer_size</tt>. A graph of the allocated sizes looks 
like a geometric progression with spikes where an allocation size is larger than <tt>next_buffer_size</tt>.
<p/>
If the intention is to set <tt>next_buffer_size = max(n, next_buffer_size * growth_factor)</tt> so 
that every allocation from upstream is larger than the previous one, then we need a change to the 
<i>Effects:</i> to actually say that. Rather than a geometric progression with anomalous spikes,
this would produce a number of different geometric progressions with discontinuous jumps between them.
<p/>
If the spiky interpretation is right then we need to weaken the "Each additional buffer is larger" 
statement. Either way, we need to add a caveat to the "following a geometric progression" text 
because that isn't true for the spiky interpretation or the jumpy interpretation.
<p/>
Thirdly, the <i>Effects:</i> says that the size of the allocated block, <tt>n</tt>, is not less than 
<tt>max(bytes, next_buffer_size)</tt>. This seems to allow an implementation to choose to do 
<tt>n = ceil2(max(bytes, next_buffer_size))</tt> if it wishes (maybe because allocating sizes that 
are a power of 2 simplifies the <tt>monotonic_buffer_resource</tt> implementation, or allows reducing 
the bookkeeping overhead). This still results in an approximate geometric progression (under either 
the spiky or jumpy interpretation) but the graph has steps rather than being a smooth curve (but 
always above the curve). This is another way that "Each additional buffer is larger than the previous 
one" is not guaranteed. Even if <tt>max(bytes, next_buffer_size)</tt> is greater on every call, for a
growth factor between <tt>1.0</tt> and <tt>2.0</tt> the result of <tt>ceil2</tt> might be the same 
for two successive buffers. I see no reason to forbid this, but Pablo suggested it's not allowed 
because it doesn't result in exponential growth (which I disagree with). If this is supposed to be
forbidden, the wording needs to be fixed to forbid it.
</p>

<p><i>[2019-01-20 Reflector prioritization]</i></p>

<p>Set Priority to 2</p>

<p><i>[2020-02-13, Prague]</i></p>

<p>
LWG looked at the issue and a suggestion was presented to eliminate most of 20.12.6 <a href="https://timsong-cpp.github.io/cppwp/mem.res.monotonic.buffer">[mem.res.monotonic.buffer]</a>
to solve the problem the current requirements impose.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.12.6 <a href="https://timsong-cpp.github.io/cppwp/mem.res.monotonic.buffer">[mem.res.monotonic.buffer]</a>, as indicated:</p>

<blockquote>
<p>
-1- A <tt>monotonic_buffer_resource</tt> is a special-purpose memory resource intended for very fast memory allocations
in situations where memory is used to build up a few objects and then is released all at once when the
memory resource object is destroyed. <del>It has the following qualities:</del>
</p>
<ol style="list-style-type: none"> 
<li><p><del>(1.1) &mdash; A call to <tt>deallocate</tt> has no effect, thus the amount of memory consumed increases 
monotonically until the resource is destroyed.</del></p></li>
<li><p><del>(1.2) &mdash; The program can supply an initial buffer, which the allocator uses to satisfy memory requests.</del></p></li>
<li><p><del>(1.3) &mdash; When the initial buffer (if any) is exhausted, it obtains additional buffers from an upstream 
memory resource supplied at construction. Each additional buffer is larger than the previous one, following a
geometric progression.</del></p></li>
<li><p><del>(1.4) &mdash; It is intended for access from one thread of control at a time. Specifically, calls to <tt>allocate</tt> and
<tt>deallocate</tt> do not synchronize with one another.</del></p></li>
<li><p><del>(1.5) &mdash; It frees the allocated memory on destruction, even if <tt>deallocate</tt> has not been called 
for some of the allocated blocks.</del></p></li>
</ol>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3146" href="3146">3146.</a> Excessive unwrapping in <tt>std::ref</tt>/<tt>cref</tt></h3>
<p><b>Section:</b> 20.14.5.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap.helpers">[refwrap.helpers]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2018-07-10 <b>Last modified:</b> 2018-08-22 12:55:05 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The overloads of <tt>std::ref</tt>/<tt>cref</tt> that take a <tt>reference_wrapper</tt> as argument are 
defined as calling <tt>std::ref</tt>/<tt>cref</tt> recursively, whereas the return type is defined as 
unwrapping just one level. Calling these functions with arguments of multiple level of wrapping leads 
to ill-formed programs:
</p>
<blockquote><pre>
int i = 0;
std::reference_wrapper&lt;int&gt; ri(i);
std::reference_wrapper&lt;std::reference_wrapper&lt;int&gt;&gt; rri(ri);
std::ref(rri); <i>// error within 'std::ref'</i>
</pre></blockquote>
<p>
[Note: these overloads were added by issue resolution 10.29 for TR1, which can be found at 
<a href="http://wg21.link/n1688">N1688</a>, at Redmond 2004]
</p>
<p><i>[2018-08-20 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4762">N4762</a>.
</p>

<ol>
<li>
<p>Change 20.14.5.5 <a href="https://timsong-cpp.github.io/cppwp/refwrap.helpers">[refwrap.helpers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T&gt; reference_wrapper&lt;T&gt; ref(reference_wrapper&lt;T&gt; t) noexcept;
</pre>
<blockquote>
<p>
-2- <i>Returns:</i> <tt><del>ref(t.get())</del><ins>t</ins></tt>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class T&gt; reference_wrapper&lt;const T&gt; cref(reference_wrapper&lt;T&gt; t) noexcept;
</pre>
<blockquote>
<p>
-4- <i>Returns:</i> <tt><del>cref(t.get())</del><ins>t</ins></tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3150" href="3150">3150.</a> <tt>UniformRandomBitGenerator</tt> should validate <tt>min</tt> and <tt>max</tt></h3>
<p><b>Section:</b> 26.6.2.3 <a href="https://timsong-cpp.github.io/cppwp/rand.req.urng">[rand.req.urng]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-08-09 <b>Last modified:</b> 2020-02-13 20:13:47 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#rand.req.urng">active issues</a> in [rand.req.urng].</p>
<p><b>View all other</b> <a href="lwg-index.html#rand.req.urng">issues</a> in [rand.req.urng].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
26.6.2.3 <a href="https://timsong-cpp.github.io/cppwp/rand.req.urng">[rand.req.urng]</a>
<a href="https://wg21.link/rand.req.urng#2">paragraph 2</a> specifies axioms for
the <tt>UniformRandomBitGenerator</tt> concept:
</p>
<blockquote>
<p>
2 Let <tt>g</tt> be an object of type <tt>G</tt>. <tt>G</tt> models
<tt>UniformRandomBitGenerator</tt> only if
</p><p>
(2.1) &mdash; both <tt>G::min()</tt> and <tt>G::max()</tt> are constant
expressions (7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>),
</p><p>
(2.2) &mdash; <tt>G::min() &lt; G::max()</tt>,
</p><p>
(2.3) &mdash; <tt>G::min() &lt;= g()</tt>,
</p><p>
(2.4) &mdash; <tt>g() &lt;= G::max()</tt>, and
</p><p>
(2.5) &mdash; <tt>g()</tt> has amortized constant complexity.
</p>
</blockquote>
<p>
Bullets 2.1 and 2.2 are both compile-time requirements that ought to be
validated by the concept.
</p>

<p><i>[2018-08-20 Priority set to 3 after reflector discussion]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4791">N4791</a>.</p>

<ol>
<li><p>Modify 26.6.2.3 <a href="https://timsong-cpp.github.io/cppwp/rand.req.urng">[rand.req.urng]</a> as follows:</p>

<blockquote>
<p>1 A <i>uniform random bit generator</i> <tt>g</tt> of type <tt>G</tt> is a
function object returning unsigned integer values such that each value in the
range of possible results has (ideally) equal probability of being returned.
[<i>Note:</i> The degree to which <tt>g</tt>'s results approximate the ideal is
often determined statistically.&mdash;<i>end note</i>]
</p>
<blockquote>
<pre>
<ins>template&lt;auto&gt; struct <i>require-constant</i>; // <i>exposition-only</i></ins>

template&lt;class G&gt;
  concept UniformRandomBitGenerator =
    Invocable&lt;G&amp;&gt; &amp;&amp; UnsignedIntegral&lt;invoke_result_t&lt;G&amp;&gt;&gt; &amp;&amp;
    requires {
      { G::min() } -> Same&lt;invoke_result_t&lt;G&amp;&gt;&gt;;
      { G::max() } -> Same&lt;invoke_result_t&lt;G&amp;&gt;&gt;;
      <ins>typename <i>require-constant</i>&lt;G::min()&gt;;</ins>
      <ins>typename <i>require-constant</i>&lt;G::max()&gt;;</ins>
      <ins>requires G::min() &lt; G::max();</ins>
    };
</pre>
</blockquote>
<p>
2 Let <tt>g</tt> be an object of type <tt>G</tt>. <tt>G</tt> models
<tt>UniformRandomBitGenerator</tt> only if
</p><p>
<del>(2.1) &mdash; both <tt>G::min()</tt> and <tt>G::max()</tt> are constant
expressions (7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>),</del>
</p><p>
<del>(2.2) &mdash; <tt>G::min() &lt; G::max()</tt>,</del>
</p><p>
(2.3) &mdash; <tt>G::min() &lt;= g()</tt>,
</p><p>
(2.4) &mdash; <tt>g() &lt;= G::max()</tt>, and
</p><p>
(2.5) &mdash; <tt>g()</tt> has amortized constant complexity.
</p><p>
3 A class <tt>G</tt> meets the <i>uniform random bit generator</i> requirements
if <tt>G</tt> models <tt>UniformRandomBitGenerator</tt>,
<tt>invoke_result_t&lt;G&amp;&gt;</tt> is an unsigned integer type
(6.8.1 <a href="https://timsong-cpp.github.io/cppwp/basic.fundamental">[basic.fundamental]</a>), and <tt>G</tt> provides a nested
<i>typedef-name</i> <tt>result_type</tt> that denotes the same type as
<tt>invoke_result_t&lt;G&amp;&gt;</tt>.
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13; Prague]</i></p>

<p>
LWG provided some improved wording.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 26.6.2.3 <a href="https://timsong-cpp.github.io/cppwp/rand.req.urng">[rand.req.urng]</a> as follows:</p>

<blockquote>
<p>1 A <i>uniform random bit generator</i> <tt>g</tt> of type <tt>G</tt> is a
function object returning unsigned integer values such that each value in the
range of possible results has (ideally) equal probability of being returned.
[<i>Note:</i> The degree to which <tt>g</tt>'s results approximate the ideal is
often determined statistically.&mdash;<i>end note</i>]
</p>
<blockquote>
<pre>
template&lt;class G&gt;
  concept uniform_random_bit_generator =
    invocable&lt;G&amp;&gt; &amp;&amp; unsigned_integral&lt;invoke_result_t&lt;G&amp;&gt;&gt; &amp;&amp;
    requires {
      { G::min() } -> same_as&lt;invoke_result_t&lt;G&amp;&gt;&gt;;
      { G::max() } -> same_as&lt;invoke_result_t&lt;G&amp;&gt;&gt;;
      <ins>requires bool_constant&lt;(G::min() &lt; G::max())&gt;::value;</ins>
    };
</pre>
</blockquote>
<p>
-2- Let <tt>g</tt> be an object of type <tt>G</tt>. <tt>G</tt> models
<tt>uniform_random_bit_generator</tt> only if
</p><p>
<del>(2.1) &mdash; both <tt>G::min()</tt> and <tt>G::max()</tt> are constant
expressions (7.7 <a href="https://timsong-cpp.github.io/cppwp/expr.const">[expr.const]</a>),</del>
</p><p>
<del>(2.2) &mdash; <tt>G::min() &lt; G::max()</tt>,</del>
</p><p>
(2.3) &mdash; <tt>G::min() &lt;= g()</tt>,
</p><p>
(2.4) &mdash; <tt>g() &lt;= G::max()</tt>, and
</p><p>
(2.5) &mdash; <tt>g()</tt> has amortized constant complexity.
</p><p>
3 A class <tt>G</tt> meets the <i>uniform random bit generator</i> requirements
if <tt>G</tt> models <tt>uniform_random_bit_generator</tt>,
<tt>invoke_result_t&lt;G&amp;&gt;</tt> is an unsigned integer type
(6.8.1 <a href="https://timsong-cpp.github.io/cppwp/basic.fundamental">[basic.fundamental]</a>), and <tt>G</tt> provides a nested
<i>typedef-name</i> <tt>result_type</tt> that denotes the same type as
<tt>invoke_result_t&lt;G&amp;&gt;</tt>.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3151" href="3151">3151.</a> <tt>ConvertibleTo</tt> rejects conversions from array and function types</h3>
<p><b>Section:</b> 18.4.4 <a href="https://timsong-cpp.github.io/cppwp/concept.convertible">[concept.convertible]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-08-09 <b>Last modified:</b> 2020-02-13 20:59:34 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#concept.convertible">active issues</a> in [concept.convertible].</p>
<p><b>View all other</b> <a href="lwg-index.html#concept.convertible">issues</a> in [concept.convertible].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In the definition of <tt>ConvertibleTo</tt> in 18.4.4 <a href="https://timsong-cpp.github.io/cppwp/concept.convertible">[concept.convertible]</a>:
</p>
<blockquote>
<pre>
template&lt;class From, class To&gt;
  concept ConvertibleTo =
    is_convertible_v&lt;From, To&gt; &amp;&amp;
    requires(From (&amp;f)()) {
      static_cast&lt;To&gt;(f());
    };
</pre>
</blockquote>
<p>
<tt>f</tt> is an arbitrary function that returns type <tt>From</tt>. Since
functions cannot return array or function types (9.3.3.5 <a href="https://timsong-cpp.github.io/cppwp/dcl.fct">[dcl.fct]</a>
<a href="https://wg21.link/dcl.fct#11">paragraph 11</a>), <tt>ConvertibleTo</tt>
cannot be satisfied when <tt>From</tt> is an array or function type regardless
of the type of <tt>To</tt>. This is incompatibility with <tt>is_convertible_v</tt>
was not an intentional design feature, so it should be corrected. (Note that any
change made here must take care to avoid breaking the
<tt>ConvertibleTo&lt;T, void&gt;</tt> cases.)
</p>

<p><i>[2018-08-20 Priority set to 3 after reflector discussion]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
[<i>Drafting Note:</i> I've used <tt>declval</tt> here, despite that "Concepts
mean we never have to use <tt>declval</tt> again!" because the alternative
is less readable:]
</p>
<blockquote>
<pre>
requires(add_rvalue_reference_t&lt;From&gt; (&amp;f)()) {
  static_cast&lt;To&gt;(f());
};
</pre>
</blockquote>

<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Modify 18.4.4 <a href="https://timsong-cpp.github.io/cppwp/concept.convertible">[concept.convertible]</a> as follows:</p>

<blockquote>
<pre>
template&lt;class From, class To&gt;
  concept ConvertibleTo =
    is_convertible_v&lt;From, To&gt; &amp;&amp;
    requires<del>(From (&amp;f)())</del> {
      static_cast&lt;To&gt;(<del>f()</del> <ins>declval&lt;From&gt;()</ins>);
    };
</pre>
</blockquote>
</li>
</ol>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>This issue is resolved by the resolution of issue <a href="3194">3194</a>.</p>





<hr>
<h3><a name="3152" href="3152">3152.</a> <tt>common_type</tt> and <tt>common_reference</tt> have flaws in common</h3>
<p><b>Section:</b> 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-08-10 <b>Last modified:</b> 2018-12-16 11:19:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.trans.other">active issues</a> in [meta.trans.other].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.trans.other">issues</a> in [meta.trans.other].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> p5 characterizes the requirements for
program-defined specializations of <tt>common_type</tt> with the sentence:
</p>
<blockquote>
Such a specialization need not have a member named <tt>type</tt>, but if it does,
that member shall be a <i>typedef-name</i> for an accessible and unambiguous
cv-unqualified non-reference type <tt>C</tt> to which each of the types
<tt>T1</tt> and <tt>T2</tt> is explicitly convertible.
</blockquote>
<p>
This sentence - which 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> p7 largely duplicates to
specify requirements on program-defined specializations of
<tt>basic_common_reference</tt> - has two problems:
</p><ol>
<li><p>The grammar term "<i>typedef-name</i>" is overconstraining; there's no
reason to prefer a <i>typedef-name</i> here to an actual type, and</p>
</li>
<li><p>"accessible" and "unambiguous" are not properties of <em>types</em>, they
are properties of names and base classes.</p>
</li>
<li><p>While we're here, we may as well strike the unused name <tt>C</tt> which
both Note B and Note D define for the type denoted by <tt>type</tt>.</p>
</li></ol>

<p><i>[2018-08 Batavia Monday issue prioritization]</i></p>

<p>Priority set to 3</p>


<p><b>Proposed resolution:</b></p>

<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Modify 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> p5 as follows:</p>
<blockquote>
<p>
-5- Note B: Notwithstanding the provisions of 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a>,
and pursuant to 16.5.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/namespace.std">[namespace.std]</a>, a program may specialize
<tt>common_type&lt;T1, T2&gt;</tt> for types <tt>T1</tt> and <tt>T2</tt> such
that <tt>is_same_v&lt;T1, decay_t&lt;T1&gt;&gt;</tt> and <tt>is_same_v&lt;T2,
decay_t&lt;T2&gt;&gt;</tt> are each true. [<i>Note:</i> &hellip;] Such a
specialization need not have a member named <tt>type</tt>, but if it does,
<del>that member shall be a <i>typedef-name</i> for an accessible and
unambiguous</del> <ins>the <i>qualified-id</i>
<tt>common_type&lt;T1, T2&gt;::type</tt> shall denote a</ins> cv-unqualified
non-reference type <del><tt>C</tt></del> to which each of the types <tt>T1</tt>
and <tt>T2</tt> is explicitly convertible. Moreover, [&hellip;]
</p>
</blockquote>
</li>
<li><p>Modify 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> p7 similarly:</p>
<blockquote>
<p>
-7- Note D: Notwithstanding  the provisions of 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a>,
and pursuant to 16.5.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/namespace.std">[namespace.std]</a>, a program may partially
specialize <tt>basic_common_reference&lt;T, U, TQual, UQual&gt;</tt> for types
<tt>T</tt> and <tt>U</tt> such that <tt>is_same_v&lt;T, decay_t&lt;T&gt;&gt;</tt>
and <tt>is_same_v&lt;U, decay_t&lt;U&gt;&gt;</tt> are each true. [<i>Note:</i>
&hellip;] Such a specialization need not have a member named <tt>type</tt>, but
if it does, <del>that member shall be a <i>typedef-name</i> for an accessible
and unambiguous</del> <ins>the <i>qualified-id</i>
<tt>basic_common_reference&lt;T, U, TQual, UQual&gt;::type</tt> shall denote
a</ins> cv-unqualified non-reference type <del><tt>C</tt></del> to which each of
the types <tt>TQual&lt;T&gt;</tt> and <tt>UQual&lt;U&gt;</tt> is convertible.
Moreover, [&hellip;]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3155" href="3155">3155.</a> <tt>tuple&lt;any, any&gt;{allocator_arg_t, an_allocator}</tt></h3>
<p><b>Section:</b> 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-08-18 <b>Last modified:</b> 2018-12-16 11:19:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#tuple.cnstr">active issues</a> in [tuple.cnstr].</p>
<p><b>View all other</b> <a href="lwg-index.html#tuple.cnstr">issues</a> in [tuple.cnstr].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
For a 2-element <tt>std::tuple</tt>, attempting to call the "allocator-extended default constructor" might actually 
pass the <tt>allocator_arg</tt> tag and the allocator to the tuple element constructors:
</p>
<blockquote>
<pre>
tuple&lt;any, any&gt; t{allocator_arg, allocator&lt;int&gt;{}};
assert(std::get&lt;0&gt;(t).has_value());
</pre>
</blockquote>
<p>
This assertion should pass according to the standard, but users might expect the elements to be default constructed. 
If you really wanted to construct the elements with the tag and the allocator, you could do:
</p>
<blockquote>
<pre>
tuple&lt;any, any&gt; t{{allocator_arg}, {allocator&lt;int&gt;{}}};
</pre>
</blockquote>
<p>
or
</p>
<blockquote>
<pre>
tuple&lt;any, any&gt; t{tuple&lt;allocator_arg_t, allocator&lt;int&gt;&gt;{allocator_arg, allocator&lt;int&gt;{}}};
</pre>
</blockquote>
<p>
The deduction guides for <tt>std::tuple</tt> always treat <tt>{allocator_arg_t, <i>an_allocator</i>}</tt> as the 
allocator-extended default constructor, so this creates an empty tuple:
</p>
<blockquote>
<pre>
tuple t{allocator_arg, allocator&lt;int&gt;{}};
</pre>
</blockquote>
<p>
And this is needed to create <tt>tuple&lt;any, any&gt;</tt>:
</p>
<blockquote>
<pre>
tuple t{allocator_arg, allocator&lt;int&gt;{}, any{}, any{}};
</pre>
</blockquote>
<p>
The proposed resolution seems consistent with that, always calling an allocator-extended constructor for 
<tt>{allocator_arg_t, <i>a</i>}</tt>, instead of the <tt>tuple(UTypes&amp;&amp;...)</tt> constructor.
<p/>
Ville Voutilainen:
<p/>
This was discussed in <a href="http://lists.isocpp.org/lib-ext/2016/10/3154.php">this reflector thread</a>, 
where Andrzej convinced me to change libstdc++ tuple.
</p>

<p><i>[2018-08-20, Daniel comments]</i></p>

<p>
The wording changes by this issue are very near to those suggested for LWG <a href="3121">3121</a>.
</p>

<p><i>[2018-08 Batavia Monday issue prioritization]</i></p>

<p>Priority set to 0, status to 'Tentatively Ready'. Alisdair to write a paper about 
SFINAE constraints on the Allocator-aware tuple constructors.</p>

<p><i>[2018-08 Batavia Friday]</i></p>

<p>Tim Song found a 3-element case of this issue. Status back to 'Open'</p> 
<p><tt>tuple&lt;any,any,any&gt;(allocator_arg_t, a, tuple)</tt></p>

<p><i>[2018-09 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>

<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Modify 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class... UTypes&gt; explicit(<i>see below</i>) constexpr tuple(UTypes&amp;&amp;... u);
</pre>
<blockquote>
<p>
-9- <i>Effects:</i> Initializes the elements in the tuple with the corresponding value in 
<tt>std::forward&lt;UTypes&gt;(u)</tt>.
<p/>
-10- <i>Remarks:</i> This constructor shall not participate in overload resolution unless 
<tt>sizeof...(Types) == sizeof...(UTypes)</tt> and <tt>sizeof...(Types) &gt;= 1</tt> and 
<tt>is_constructible_v&lt;T<sub><i>i</i></sub>, U<sub><i>i</i></sub>&amp;&amp;&gt;</tt> is <tt>true</tt> 
for all <tt><i>i</i></tt> <ins>and <tt>(sizeof...(Types) != 2 || !is_same_v&lt;remove_cvref_t&lt;U<sub>0</sub>&gt;, 
allocator_arg_t&gt;)</tt></ins>. The expression inside <tt>explicit</tt> is equivalent to:
<p/>
<tt>!conjunction_v&lt;is_convertible&lt;UTypes, Types&gt;...&gt;</tt>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3156" href="3156">3156.</a> <tt>ForwardIterator</tt> should only mean forward iterator</h3>
<p><b>Section:</b> 20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-09-06 <b>Last modified:</b> 2018-12-16 11:19:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#specialized.algorithms">active issues</a> in [specialized.algorithms].</p>
<p><b>View all other</b> <a href="lwg-index.html#specialized.algorithms">issues</a> in [specialized.algorithms].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a> para 1.2 describes how the specialized
algorithms with a template parameter named <tt>ForwardIterator</tt> impose
requirements on the type passed as argument for that parameter: it must meet
the <tt><i>Cpp17ForwardIterator</i></tt> requirements, which is consistent with
how the rest of the Library uses the template parameter name
<tt>ForwardIterator</tt>, and many of the required operations on that type must
not throw exceptions, which is <em>not</em> consistent with how the rest of the
Library uses that name.
</p><p>
To avoid confusion and keep the meaning of requirements imposed by template
parameter names crisp, the specialized memory algorithms should use a different
template parameter name for this different set of requirements.
</p><p>
Note that the proposed change has no normative effect; it's simply a
clarification of the existing wording.
</p>

<p><i>[2018-09 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>

<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Modify 20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a> as indicated:</p>
<blockquote>
<pre>
[&hellip;]

// 20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a>, specialized algorithms
template&lt;class T&gt;
  constexpr T* addressof(T&amp; r) noexcept;
template&lt;class T&gt;
  const T* addressof(const T&amp;&amp;) = delete;
template&lt;class <ins>NoThrow</ins>ForwardIterator&gt;
  void uninitialized_default_construct(<ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator&gt;
  void uninitialized_default_construct(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                       <ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last);
template&lt;class <ins>NoThrow</ins>ForwardIterator, class Size&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_default_construct_n(<ins>NoThrow</ins>ForwardIterator first, Size n);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator, class Size&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_default_construct_n(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                                    <ins>NoThrow</ins>ForwardIterator first, Size n);
template&lt;class <ins>NoThrow</ins>ForwardIterator&gt;
  void uninitialized_value_construct(<ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator&gt;
  void uninitialized_value_construct(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                     <ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last);
template&lt;class <ins>NoThrow</ins>ForwardIterator, class Size&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_value_construct_n(<ins>NoThrow</ins>ForwardIterator first, Size n);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator, class Size&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_value_construct_n(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                                  <ins>NoThrow</ins>ForwardIterator first, Size n);
template&lt;class InputIterator, class <ins>NoThrow</ins>ForwardIterator&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_copy(InputIterator first, InputIterator last,
                                     <ins>NoThrow</ins>ForwardIterator result);
template&lt;class ExecutionPolicy, class InputIterator, class <ins>NoThrow</ins>ForwardIterator&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_copy(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                     InputIterator first, InputIterator last,
                                     <ins>NoThrow</ins>ForwardIterator result);
template&lt;class InputIterator, class Size, class <ins>NoThrow</ins>ForwardIterator&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_copy_n(InputIterator first, Size n,
                                       <ins>NoThrow</ins>ForwardIterator result);
template&lt;class ExecutionPolicy, class InputIterator, class Size, class <ins>NoThrow</ins>ForwardIterator&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_copy_n(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                       InputIterator first, Size n,
                                       <ins>NoThrow</ins>ForwardIterator result);
template&lt;class InputIterator, class <ins>NoThrow</ins>ForwardIterator&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_move(InputIterator first, InputIterator last,
                                     <ins>NoThrow</ins>ForwardIterator result);
template&lt;class ExecutionPolicy, class InputIterator, class <ins>NoThrow</ins>ForwardIterator&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_move(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                     InputIterator first, InputIterator last,
                                     <ins>NoThrow</ins>ForwardIterator result);
template&lt;class InputIterator, class Size, class <ins>NoThrow</ins>ForwardIterator&gt;
  pair&lt;InputIterator, <ins>NoThrow</ins>ForwardIterator&gt; uninitialized_move_n(InputIterator first, Size n,
                                                            <ins>NoThrow</ins>ForwardIterator result);
template&lt;class ExecutionPolicy, class InputIterator, class Size, class <ins>NoThrow</ins>ForwardIterator&gt;
  pair&lt;InputIterator, <ins>NoThrow</ins>ForwardIterator&gt; uninitialized_move_n(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                                            InputIterator first, Size n,
                                                            <ins>NoThrow</ins>ForwardIterator result);
template&lt;class <ins>NoThrow</ins>ForwardIterator, class T&gt;
  void uninitialized_fill(<ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last, const T&amp; x);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator, class T&gt;
  void uninitialized_fill(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                          <ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last, const T&amp; x);
template&lt;class <ins>NoThrow</ins>ForwardIterator, class Size, class T&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_fill_n(<ins>NoThrow</ins>ForwardIterator first, Size n, const T&amp; x);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator, class Size, class T&gt;
  <ins>NoThrow</ins>ForwardIterator uninitialized_fill_n(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                                       <ins>NoThrow</ins>ForwardIterator first, Size n, const T&amp; x);
template&lt;class T&gt;
  void destroy_at(T* location);
template&lt;class <ins>NoThrow</ins>ForwardIterator&gt;
  void destroy(<ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator&gt;
  void destroy(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
               <ins>NoThrow</ins>ForwardIterator first, <ins>NoThrow</ins>ForwardIterator last);
template&lt;class <ins>NoThrow</ins>ForwardIterator, class Size&gt;
  <ins>NoThrow</ins>ForwardIterator destroy_n(<ins>NoThrow</ins>ForwardIterator first, Size n);
template&lt;class ExecutionPolicy, class <ins>NoThrow</ins>ForwardIterator, class Size&gt;
  <ins>NoThrow</ins>ForwardIterator destroy_n(ExecutionPolicy&amp;&amp; exec, // see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a>
                            <ins>NoThrow</ins>ForwardIterator first, Size n);

// 20.11.1 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr">[unique.ptr]</a>, class template unique_ptr
[&hellip;]
</pre>
</blockquote>
</li>
<li><p>Modify 20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a> as indicated:</p>
<blockquote>
<p>
[&hellip;]
</p><p>
(1.2) &mdash; If an algorithm's template parameter is named
<tt><ins>NoThrow</ins>ForwardIterator</tt>, the template argument shall satisfy
the <tt><i>Cpp17ForwardIterator</i></tt> requirements
(23.3.5.4 <a href="https://timsong-cpp.github.io/cppwp/forward.iterators">[forward.iterators]</a>), and is required to have the property that
no exceptions are thrown from increment, assignment, comparison, or indirection
through valid iterators.
</p><p>
[&hellip;]
</p>
</blockquote>
</li>
<li><p>Modify the declarations of the specialized algorithms in the remainder of
20.10.11 <a href="https://timsong-cpp.github.io/cppwp/specialized.algorithms">[specialized.algorithms]</a> to agree with the proposed changes to
20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a> above.</p>
</li>
</ol>





<hr>
<h3><a name="3157" href="3157">3157.</a> Allocator <tt>destroy</tt> and fancy pointer operations must be non-throwing</h3>
<p><b>Section:</b> 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-09-07 <b>Last modified:</b> 2018-12-16 11:19:04 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.requirements">active issues</a> in [allocator.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.requirements">issues</a> in [allocator.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In annotating things required to be called by <tt>~vector</tt>, Casey pointed out that several operations I guarded 
with <tt>noexcept</tt> aren't actually mandated by the standard to be <tt>noexcept</tt>. However, the STL, and more 
specifically here, containers, consider inability to destroy an element an unrecoverable condition. This is evidenced 
for the whole STL by 16.5.5.13 <a href="https://timsong-cpp.github.io/cppwp/res.on.exception.handling">[res.on.exception.handling]</a>/3 "Every destructor in the C ++ standard library shall 
behave as if it had a non-throwing exception specification.".
<p/>
As a result, <tt>allocator::destroy</tt> and fancy pointer operations must be non-throwing for valid input, or the 
containers don't make any sense. This is obvious for things like <tt>vector::~vector</tt>, but less obviously the 
containers rely on these guarantees whenever inserting more than one element, etc.
<p/>
Moreover, we too narrowly specify the domain of the <tt>pointer_traits::pointer_to</tt> requirement in the 
<tt><i>Cpp17Allocator</i></tt> requirements, because any node-based container that uses container-internal sentinel 
nodes needs to be able to form pointers to said sentinel nodes; that operation must also be non-throwing.
</p>

<p><i>[2018-09 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>

<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Modify 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 32 "Descriptive variable definitions" as indicated:</p>
<blockquote>
<table border="1">
<caption>Table 32 &mdash; Descriptive variable definitions</caption>
<tr>
<th>Variable</th>
<th>Definition</th>
</tr>

<tr>
<td colspan="2" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>YY</tt>
</td>
<td>
the type <tt>allocator_traits&lt;Y&gt;</tt>
</td>
</tr>

<tr>
<td>
<ins><tt>Z</tt></ins>
</td>
<td>
<ins>an allocator-aware container type (22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>)</ins>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>y</tt>
</td>
<td>
a value of type <tt>XX::const_void_pointer</tt> obtained by<br/>
conversion from a result value of <tt>YY::allocate</tt>, or else a<br/>
value of type (possibly <tt>const</tt>) <tt>std::nullptr_t</tt>.
</td>
</tr>

<tr>
<td>
<tt><ins>z</ins></tt>
</td>
<td>
<ins>an lvalue of type <tt>Z</tt> such that <tt>z.get_allocator() == a</tt></ins>
</td>
</tr>

<tr>
<td>
<tt><ins>r1</ins></tt>
</td>
<td>
<ins>a reference to any member subobject of <tt>z</tt></ins>
</td>
</tr>

<tr>
<td>
<tt>n</tt>
</td>
<td>
a value of type <tt>XX::size_type</tt>.
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Modify 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 33 "<tt><i>Cpp17Allocator</i></tt> requirements" as indicated:</p>
<blockquote>
<table border="1">
<caption>Table 33 &mdash; <tt><i>Cpp17Allocator</i></tt> requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>pointer_traits&lt;<br/>
X::pointer<br/>
&gt;::pointer_to(r)</tt>
</td>
<td>
<tt>X::pointer</tt>
</td>
<td>
<ins>S</ins><del>s</del>ame as <tt>p</tt><ins>.<br/>
<i>Throws:</i> Nothing.</ins>
</td>
<td>
</td>
</tr>

<tr>
<td>
<ins><tt>pointer_traits&lt;<br/>
X::pointer<br/>
&gt;::pointer_to(r1)</tt></ins>
</td>
<td>
</td>
<td>
<ins>A value of type <tt>YY::pointer</tt> or<br/>
<tt>YY::const_pointer</tt> <tt>k</tt> such that<br/> 
<tt>*k</tt> is <tt>r1</tt>.<br/>
<i>Throws:</i> Nothing.</ins>
</td>
<td>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.destroy(c)</tt>
</td>
<td>
(not used)
</td>
<td>
<i>Effects:</i> Destroys the object at <tt>c</tt><ins>.</ins><br/>
<ins><i>Throws:</i> Nothing.</ins>
</td>
<td>
<tt>c-&gt;~C()</tt>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, p5, as indicated:</p>

<blockquote>
<p>
-5- An allocator type <tt>X</tt> shall satisfy the <tt><i>Cpp17CopyConstructible</i></tt> requirements (Table 26). 
The <tt>X::pointer</tt>, <tt>X::const_pointer</tt>, <tt>X::void_pointer</tt>, and <tt>X::const_void_pointer</tt> 
types shall satisfy the <tt><i>Cpp17NullablePointer</i></tt> requirements (Table 30). No constructor, comparison 
function, copy operation, move operation, or swap operation on these pointer types shall exit via an exception. 
<tt>X::pointer</tt> and <tt>X::const_pointer</tt> shall also satisfy the requirements for a random access iterator 
(23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a>) and of a contiguous iterator (23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>)
<ins>and operations in those requirements shall not exit via an exception so long as resulting iterators are 
dereferencable or past-the-end</ins>.
</p>
</blockquote>
</li>

<li><p>Modify 20.10.9.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.traits.members">[allocator.traits.members]</a>, as indicated:</p>

<blockquote>
<pre>
template&lt;class T&gt;
  static void destroy(Alloc&amp; a, T* p);
</pre>
<blockquote>
<p>
-6- <i>Effects:</i> Calls <tt>a.destroy(p)</tt> if that call is well-formed; otherwise, invokes <tt>p-&gt;~T()</tt>.
<p/>
<ins>-?- <i>Throws:</i> Nothing.</ins>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3159" href="3159">3159.</a> &sect;[unique.ptr.single] requirements on deleter may be too strict</h3>
<p><b>Section:</b> 20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2018-09-17 <b>Last modified:</b> 2018-10-06 10:50:02 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#unique.ptr.single">active issues</a> in [unique.ptr.single].</p>
<p><b>View all other</b> <a href="lwg-index.html#unique.ptr.single">issues</a> in [unique.ptr.single].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a> p1 says:
</p>
<blockquote><p>
The default type for the template parameter <tt>D</tt> is <tt>default_delete</tt>. A client-supplied template argument 
<tt>D</tt> shall be a function object type (19.14), lvalue reference to function, or lvalue reference to function object 
type for which, given a value <tt>d</tt> of type <tt>D</tt> and a value ptr of type <tt>unique_ptr&lt;T, D&gt;::pointer</tt>, 
the expression <tt>d(ptr)</tt> is valid and has the effect of disposing of the pointer as appropriate for that deleter.
</p></blockquote>
<p>
That means this is undefined:
</p>
<blockquote><pre>
#include &lt;memory&gt;

struct IncompleteBase;

struct Deleter {
  void operator()(IncompleteBase*) const;
};

struct IncompleteDerived;

struct X {
  std::unique_ptr&lt;IncompleteDerived, Deleter&gt; p;
  ~X();
};
</pre></blockquote>
<p>
<tt>unique_ptr::pointer</tt> is <tt>IncompleteDerived*</tt>, but <tt>is_invocable&lt;Deleter, IncompleteDerived*&gt;</tt> 
is unknowable until the type is complete (see LWG <a href="3099">3099</a> etc).
<p/>
The intention is that <tt>IncompleteDerived</tt> only needs to be complete when the deleter is invoked, which is in the 
definition of <tt>X::~X()</tt> for this example. But the requirement for <tt>d(ptr)</tt> to be valid requires a complete type. 
If the <tt>unique_ptr</tt> implementation adds <tt>static_assert(is_invocable_v&lt;D, pointer&gt;)</tt> to enforce the 
requirement, the example above fails to compile. GCC recently added that assertion.
<p/>
Do we want to relax that requirement, or do we want to force the code above to define <tt>Deleter::pointer</tt> as 
<tt>IncompleteBase*</tt> so that the <tt>is_invocable</tt> condition can be checked?
<p/>
The destructor and <tt>reset</tt> member function already require that the deleter can be invoked (and that <i>Requires:</i> 
element will be turned into a <i>Mandates:</i> one soon). We can just remove that requirement from the preamble for the 
class template, or say that the expression only needs to be valid when the destructor and <tt>reset</tt> member are 
instantiated. We could also rephrase it in terms of <tt>is_invocable_v&lt;D, unique_ptr&lt;T, D&gt;::pointer&gt;</tt>.
</p>

<p><i>[2018-10 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3161" href="3161">3161.</a> Container adapters mandate use of <tt>emplace_back</tt> but don't require it</h3>
<p><b>Section:</b> 22.6.6 <a href="https://timsong-cpp.github.io/cppwp/stack">[stack]</a>, 22.6.4 <a href="https://timsong-cpp.github.io/cppwp/queue">[queue]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2018-10-02 <b>Last modified:</b> 2019-02-21 17:23:36 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#stack">issues</a> in [stack].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
22.6.6 <a href="https://timsong-cpp.github.io/cppwp/stack">[stack]</a> p1 says:
</p>
<blockquote>
Any sequence container supporting operations <tt>back()</tt>, <tt>push_back()</tt> and <tt>pop_back()</tt> can be used to 
instantiate <tt>stack</tt>. 
</blockquote>

<p>but then in 22.6.6.1 <a href="https://timsong-cpp.github.io/cppwp/stack.defn">[stack.defn]</a> we have the following code:</p>
<pre>
template&lt;class... Args&gt;
  decltype(auto) emplace(Args&amp;&amp;... args)
    { return c.emplace_back(std::forward&lt;Args&gt;(args)...); }
</pre>

<p>The same pattern appears in 22.6.4 <a href="https://timsong-cpp.github.io/cppwp/queue">[queue]</a>.</p>

<p>I see two ways to resolve this:</p>
<p>The first is to add <tt>emplace_back()</tt> to the list of requirements for underlying containers for <tt>stack</tt> and <tt>queue</tt></p>

<p>The second is to replace the calls to <tt>c.emplace_back(std::forward&lt;Args&gt;(args)...)</tt> with <tt>c.emplace(c.end(), std::forward&lt;Args&gt;(args)...)</tt>. We can do this w/o messing with the list above because <tt>emplace</tt> is part of the sequence container requirements, while <tt>emplace_back</tt> is not. I checked the libc++ implementation of <tt>vector</tt>, <tt>deque</tt>, and <tt>list</tt>, and they all do the same thing for <tt>emplace(end(), ...)</tt> and <tt>emplace_back(...)</tt>.</p>

<p><i>[2019-02; Kona Wednesday night issue processing]</i></p>

<p>Status to Open; Casey to provide updated wording, and re-vote on reflector.</p>
<p>Polls were: NAD - 5-1-3; "Option B" - 2-5-2 and "Probe the container" - 7-2-0</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<blockquote class="note">
I have prepared two mutually exclusive options.
<br/>Option A a requirement for <tt>emplace_back</tt> to the underlying container.
<br/>Option B one replaces the calls to <tt>emplace_back</tt> with calls to <tt>emplace</tt>.
</blockquote>

<p><b>Option A</b></p>
<ol>
<li><p>Edit 22.6.6 <a href="https://timsong-cpp.github.io/cppwp/stack">[stack]</a>, as indicated:</p>
<p>Any sequence container supporting operations <tt>back()</tt>, <tt>push_back()</tt>,  <ins><tt>emplace_back()</tt></ins> and <tt>pop_back()</tt> can be used to instantiate <tt>stack</tt>. </p>
</li>

<li><p>Edit 22.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/queue.defn">[queue.defn]</a>, as indicated:</p>
<p>Any sequence container supporting operations <tt>front()</tt>, <tt>back()</tt>, <tt>push_back()</tt>,  <ins><tt>emplace_back()</tt></ins> and <tt>pop_front()</tt> can be used to instantiate <tt>queue</tt>. </p>
</li>
</ol>

<p><b>Option B</b></p>
<ol>
<li><p>Edit 22.6.6.1 <a href="https://timsong-cpp.github.io/cppwp/stack.defn">[stack.defn]</a>, class template <tt>stack</tt> definition, as indicated:</p>
<blockquote><pre>
template&lt;class... Args&gt;
  decltype(auto) emplace(Args&amp;&amp;... args)
    { return c.emplace<del>_back</del>(<ins>c.end(), </ins>std::forward&lt;Args&gt;(args)...); }
</pre></blockquote>
</li>

<li><p>Edit 22.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/queue.defn">[queue.defn]</a>, class template <tt>queue</tt> definition, as indicated:</p>
<blockquote><pre>
template&lt;class... Args&gt;
  decltype(auto) emplace(Args&amp;&amp;... args)
    { return c.emplace<del>_back</del>(<ins>c.end(), </ins>std::forward&lt;Args&gt;(args)...); }
</pre></blockquote>
</li>
</ol>






<hr>
<h3><a name="3162" href="3162">3162.</a> <tt>system_error::system_error(error_code ec)</tt> not explicit</h3>
<p><b>Section:</b> 19.5.7.2 <a href="https://timsong-cpp.github.io/cppwp/syserr.syserr.members">[syserr.syserr.members]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Peter Dimov <b>Opened:</b> 2018-10-02 <b>Last modified:</b> 2018-10-06 11:25:03 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#syserr.syserr.members">issues</a> in [syserr.syserr.members].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The constructor for <tt>std::system_error</tt> taking a single argument of type <tt>std::error_code</tt> is 
not marked explicit, which allows implicit conversions from <tt>error_code</tt> to <tt>system_error</tt>. I 
think that this is an oversight and not intentional, and that we should make this constructor explicit.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4762">N4762</a>.</p>

<ol>
<li><p>Change 19.5.7.1 <a href="https://timsong-cpp.github.io/cppwp/syserr.syserr.overview">[syserr.syserr.overview]</a> p2, class <tt>system_error</tt> synopsis, as indicated</p>
<blockquote><pre>
namespace std {
  class system_error : public runtime_error {
  public:
    system_error(error_code ec, const string&amp; what_arg);
    system_error(error_code ec, const char* what_arg);
    <ins>explicit</ins> system_error(error_code ec);
    system_error(int ev, const error_category&amp; ecat, const string&amp; what_arg);
    system_error(int ev, const error_category&amp; ecat, const char* what_arg);
    system_error(int ev, const error_category&amp; ecat);
    const error_code&amp; code() const noexcept;
    const char* what() const noexcept override;
  };
}
</pre></blockquote>
</li>

<li><p>Change 19.5.7.2 <a href="https://timsong-cpp.github.io/cppwp/syserr.syserr.members">[syserr.syserr.members]</a> as indicated</p>
<blockquote>
<pre>
<ins>explicit</ins> system_error(error_code ec);
</pre>
<blockquote>
<p>
-5- <i>Effects:</i> [&hellip;]
<p/>
-6- <i>Ensures:</i> [&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="3165" href="3165">3165.</a> All <tt>starts_with()</tt> overloads should be called "<tt>begins_with</tt>"</h3>
<p><b>Section:</b> 21.3.2 <a href="https://timsong-cpp.github.io/cppwp/basic.string">[basic.string]</a>, 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Gennaro Prota <b>Opened:</b> 2018-10-22 <b>Last modified:</b> 2018-11-27 04:34:19 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#basic.string">active issues</a> in [basic.string].</p>
<p><b>View all other</b> <a href="lwg-index.html#basic.string">issues</a> in [basic.string].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Throughout the standard library, the opposite of the verb "to end" is "to begin", not to "to start". In this 
respect, all the overloads of <tt>std::basic_string::starts_with</tt> and <tt>std::basic_string_view::starts_with</tt> 
are named inconsistently. These calls were added in <a href="https://wg21.link/p0457r2">P0457R2</a>, which refers 
to analogous functions in Java, Python, Qt, LLVM, WebKit, all of which use the term "start". But, in our opinion, 
the C++ standard library should first be consistent with itself. 
</p>

<p>11-2018: Referred to LEWG after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4778">N4778</a>.</p>

<ol>
<li><p>Change 21.3.2 <a href="https://timsong-cpp.github.io/cppwp/basic.string">[basic.string]</a>, class template <tt>basic_string</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
bool <ins>begin</ins><del>start</del>s_with(basic_string_view&lt;charT, traits&gt; x) const noexcept;
bool <ins>begin</ins><del>start</del>s_with(charT x) const noexcept;
bool <ins>begin</ins><del>start</del>s_with(const charT* x) const;
</pre>
</blockquote>
</li>

<li><p>Change 21.3.2.7.5 <a href="https://timsong-cpp.github.io/cppwp/string.starts.with">[string.starts.with]</a> as indicated</p>
<blockquote>
<pre>
bool <ins>begin</ins><del>start</del>s_with(basic_string_view&lt;charT, traits&gt; x) const noexcept;
bool <ins>begin</ins><del>start</del>s_with(charT x) const noexcept;
bool <ins>begin</ins><del>start</del>s_with(const charT* x) const;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to:
</p>
<pre>
return basic_string_view&lt;charT, traits&gt;(data(), size()).<ins>begin</ins><del>start</del>s_with(x);
</pre>
</blockquote>
</blockquote>
</li>

<li><p>Change 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a>, class template <tt>basic_string_view</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
constexpr bool <ins>begin</ins><del>start</del>s_with(basic_string_view x) const noexcept;
constexpr bool <ins>begin</ins><del>start</del>s_with(charT x) const noexcept;
constexpr bool <ins>begin</ins><del>start</del>s_with(const charT* x) const;
</pre>
</blockquote>
</li>

<li><p>Change 21.4.2.6 <a href="https://timsong-cpp.github.io/cppwp/string.view.ops">[string.view.ops]</a> as indicated:</p>
<blockquote>
<pre>
constexpr bool <ins>begin</ins><del>start</del>s_with(basic_string_view x) const noexcept;
</pre>
<blockquote>
<p>
-20- <i>Effects:</i> Equivalent to: <tt>return compare(0, npos, x) == 0;</tt>
</p>
</blockquote>
<pre>
constexpr bool <ins>begin</ins><del>start</del>s_with(charT x) const noexcept;
</pre>
<blockquote>
<p>
-21- <i>Effects:</i> Equivalent to: <tt>return <ins>begin</ins><del>start</del>s_with(basic_string_view(&amp;x, 1));</tt>
</p>
</blockquote>
<pre>
constexpr bool <ins>begin</ins><del>start</del>s_with(const charT* x) const;
</pre>
<blockquote>
<p>
-22- <i>Effects:</i> Equivalent to: <tt>return <ins>begin</ins><del>start</del>s_with(basic_string_view(x));</tt>
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="3166" href="3166">3166.</a> No such descriptive element as <i>Value:</i></h3>
<p><b>Section:</b> 20.4.4 <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a>, 20.7.4 <a href="https://timsong-cpp.github.io/cppwp/variant.helper">[variant.helper]</a>, 22.3.7.7 <a href="https://timsong-cpp.github.io/cppwp/array.tuple">[array.tuple]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Walter Brown <b>Opened:</b> 2018-11-08 <b>Last modified:</b> 2018-11-27 04:34:19 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#pair.astuple">issues</a> in [pair.astuple].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In <a href="http://wg21.link/n4778">N4778</a>, 20.4.4 <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a>, 20.7.4 <a href="https://timsong-cpp.github.io/cppwp/variant.helper">[variant.helper]</a>, 
and 22.3.7.7 <a href="https://timsong-cpp.github.io/cppwp/array.tuple">[array.tuple]</a>, are partly specified via a fictitious descriptive element <i>Value:</i>  Moreover, 
22.7.3.9 <a href="https://timsong-cpp.github.io/cppwp/span.tuple">[span.tuple]</a> is on track to do likewise in the near future.
<p/>
Let's invent such a <i>Value:</i> element and properly document it within 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a>, 
or else let's respecify the offending uses.
</p>

<p><i>[2018-11 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3167" href="3167">3167.</a> [fund.ts.v3] Does <tt>observer_ptr</tt> support function types?</h3>
<p><b>Section:</b> 5.2 [fund.ts.v3::memory.observer.ptr] <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2018-11-14 <b>Last modified:</b> 2018-11-27 04:34:19 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v3</b></p>
<p>
From the wording, function pointers are never clearly considered. P1 infers
support for only objects, but it is not clear that wording is intended to be a
deliberate restriction, or is casual wording.
<p/>
Paragraph 2 mandates that we cannot instantiate for reference types, and do
support incomplete types, but still does not consider function types. Calling
out references specifically, as they are not object types, suggests the inferred
support for only objects in p1 is more a case of casual phrasing, than deliberate
intent.
<p/>
However, if we did intend to support function pointers, we may want to consider
adding a function-call operator, constrained to supporting pointer-to function types.
One other possibility is that the explicit conversion to <tt>pointer</tt> already serves that
purpose, although I need to double-check the core language that contextual
conversions to function pointer are considered when invoking the function call
operator.  If this <em>is</em> the case, then I suggest a note to that effect in
[memory.observer.ptr.conv] instead.
</p>

<p><i>[2018-11 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3168" href="3168">3168.</a> <i>Expects:</i> element should be specified in one place</h3>
<p><b>Section:</b> 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a>, 16.5.4.11 <a href="https://timsong-cpp.github.io/cppwp/res.on.required">[res.on.required]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Geoffrey Romer <b>Opened:</b> 2018-11-21 <b>Last modified:</b> 2019-07-22 17:12:46 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#structure.specifications">active issues</a> in [structure.specifications].</p>
<p><b>View all other</b> <a href="lwg-index.html#structure.specifications">issues</a> in [structure.specifications].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a>/p3.4 specifies the <i>Expects:</i> element as "the conditions (sometimes termed preconditions) 
that the function assumes to hold whenever it is called". This is nonsensical (functions can't "assume" things because 
they're not sentient), and more to the point it says nothing about what happens if those conditions don't hold. This is 
a serious problem because the whole point of introducing <i>Expects:</i> was to correct the vagueness of <i>Requires:</i> on 
exactly that point.
<p/>
16.5.4.11 <a href="https://timsong-cpp.github.io/cppwp/res.on.required">[res.on.required]</a>/p2 is more explicit: "Violation of any preconditions specified in a function's <i>Expects:</i> 
element results in undefined behavior." However, I think putting the actual meaning of the <i>Expects:</i> element in a subclause 
called "Requires paragraph", 21 pages away from where <i>Expects:</i> is nominally specified, is asking too much of the reader. 
Splitting the specification of <i>Requires:</i> into two places 21 pages apart also seems needlessly obtuse, but that's less pressing 
since <i>Requires:</i> should be going away soon.
</p>

<p><i>[2018-11 Reflector prioritization]</i></p>

<p>Set Priority to 2</p>
<p><i>[2019-02; Kona Wednesday night issue processing]</i></p>

<p>Alternate wording discussed; Marshall to check with Geoffrey and vote on reflector.</p>

<p><i>[2019 Cologne Wednesday night]</i></p>

<p>Revisit once the appropriate "Mandating" paper has landed</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4778">N4778</a>.</p>

<blockquote class="note">
[<i>Drafting Note:</i> I have prepared two mutually exclusive options, depicted below by <b>Option A</b> and <b>Option B</b>, 
respectively. In case the committee would prefer to leave "Requires" alone, <b>Option B</b> describes just the "Expects" 
edits, as an alternate P/R]
</blockquote>

<p><b>Option A</b></p>

<ol>
<li><p>Change 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> as indicated:</p>
<blockquote>
<p>
-3- Descriptions of function semantics contain the following elements (as appropriate):(footnote)
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; <i>Requires:</i> <del>the preconditions for calling the function.</del><ins>the conditions that are required to hold 
when the function is called in order for the call to successfully complete. [<i>Note:</i> When these conditions are violated, 
the function's <i>Throws:</i> element may specify throwing an exception. Otherwise, the behavior is undefined. &mdash; 
<i>end note</i>]</ins></p></li>
<li><p>(3.2) &mdash; <i>Constraints:</i> [&hellip;]</p></li>
<li><p>(3.3) &mdash; <i>Mandates:</i> [&hellip;]</p></li>
<li><p>(3.4) &mdash; <i>Expects:</i> the conditions (sometimes termed preconditions) that <del>the function assumes to hold whenever
it is called</del><ins>are required to hold when the function is called in order for the call to have well-defined behavior</ins>. 
[<i>Example:</i> An implementation might express such conditions via an attribute such as <tt>[[expects]]</tt> 
( [dcl.attr.contract]). However, some such conditions might not lend themselves to expression via code. &mdash; 
<i>end example</i>]</p></li>
</ol>
</blockquote>
</li>

<li><p>Delete 16.5.4.11 <a href="https://timsong-cpp.github.io/cppwp/res.on.required">[res.on.required]</a> in it's entirety as indicated:</p>
<blockquote>
<p>
<del><b>15.5.4.11 Requires paragraph [res.on.required]</b></del>
<p/>
<del>-1- Violation of any preconditions specified in a function's <i>Requires:</i> element results in undefined behavior unless
the function's <i>Throws:</i> element specifies throwing an exception when the precondition is violated.</del>
<p/>
<del>-2- Violation of any preconditions specified in a function's <i>Expects:</i> element results in undefined behavior.</del>
</p>
</blockquote>
</li>
</ol>

<p><b>Option B</b></p>

<ol>
<li><p>Change 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> as indicated:</p>
<blockquote>
<p>
-3- Descriptions of function semantics contain the following elements (as appropriate):(footnote)
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; <i>Requires:</i> the preconditions for calling the function.</p></li>
<li><p>(3.2) &mdash; <i>Constraints:</i> [&hellip;]</p></li>
<li><p>(3.3) &mdash; <i>Mandates:</i> [&hellip;]</p></li>
<li><p>(3.4) &mdash; <i>Expects:</i> the conditions (sometimes termed preconditions) that <del>the function assumes to hold whenever
it is called</del><ins>are required to hold when the function is called in order for the call to have well-defined behavior</ins>. 
[<i>Example:</i> An implementation might express such conditions via an attribute such as <tt>[[expects]]</tt> 
( [dcl.attr.contract]). However, some such conditions might not lend themselves to expression via code. &mdash; 
<i>end example</i>]</p></li>
</ol>
</blockquote>
</li>

<li><p>Change 16.5.4.11 <a href="https://timsong-cpp.github.io/cppwp/res.on.required">[res.on.required]</a> as indicated:</p>
<blockquote>
<p>
-1- Violation of any preconditions specified in a function's <i>Requires:</i> element results in undefined behavior unless
the function's <i>Throws:</i> element specifies throwing an exception when the precondition is violated.
<p/>
<del>-2- Violation of any preconditions specified in a function's <i>Expects:</i> element results in undefined behavior.</del>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3170" href="3170">3170.</a> <tt>is_always_equal</tt> added to <tt>std::allocator</tt> makes the standard library treat 
derived types as always equal</h3>
<p><b>Section:</b> 20.10.10 <a href="https://timsong-cpp.github.io/cppwp/default.allocator">[default.allocator]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-11-29 <b>Last modified:</b> 2019-07-22 17:12:46 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#default.allocator">active issues</a> in [default.allocator].</p>
<p><b>View all other</b> <a href="lwg-index.html#default.allocator">issues</a> in [default.allocator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I (Billy O'Neal) attempted to change MSVC++'s standard library to avoid instantiating allocators' <tt>operator==</tt> 
for allocators that are declared <tt>is_always_equal</tt> to reduce the number of template instantiations emitted into .objs.
<p/>
In so doing I introduced an unrelated bug related to POCMA handling, but it brought my attention to 
<a href="https://github.com/boostorg/poly_collection/blob/5ed5d5e99336130783bdb33126d8629890235aed/test/test_utilities.hpp#L324">this 
allocator</a>. This allocator doesn't meet the allocator requirements because it is getting <tt>std::allocator</tt>'s 
<tt>operator==</tt> and <tt>operator!=</tt> which don't compare the root member. However, if this had been a conforming C++14 
allocator with its own <tt>==</tt> and <tt>!=</tt> we would still be treating it as <tt>is_always_equal</tt>, as it picks that 
up by deriving from <tt>std::allocator</tt>.
<p/>
<tt>std::allocator</tt> doesn't actually need <tt>is_always_equal</tt> because the defaults provided by <tt>allocator_traits</tt> 
will say <tt>true_type</tt> for it, since implementers don't make <tt>std::allocator</tt> stateful.
<p/>
Billy O'Neal thinks this is NAD on the grounds that we need to be able to add things or change the behavior of standard library types.
<p/>
Stephan T Lavavej thinks we should resolve this anyway because we don't know of an implementation for which this would change 
the default answer provided by <tt>allocator_traits</tt>.
</p>

<p><i>[2019-02 Priority set to 2 after reflector discussion]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4778">N4778</a>.</p>

<ol>
<li><p>Modify 20.10.10 <a href="https://timsong-cpp.github.io/cppwp/default.allocator">[default.allocator]</a> as follows:</p>

<blockquote>
<p>
-1- All specializations of the default allocator satisfy the allocator completeness requirements (16.5.3.5.1 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements.completeness">[allocator.requirements.completeness]</a>).
</p>
<pre>
namespace std {
  template&lt;class T&gt; class allocator {
  public:
    using value_type = T;
    using size_type = size_t;
    using difference_type = ptrdiff_t;
    using propagate_on_container_move_assignment = true_type;
    <del>using is_always_equal = true_type;</del>
    constexpr allocator() noexcept;
    constexpr allocator(const allocator&amp;) noexcept;
    template&lt;class U&gt; constexpr allocator(const allocator&lt;U&gt;&amp;) noexcept;
    ~allocator();
    allocator&amp; operator=(const allocator&amp;) = default;
    [[nodiscard]] T* allocate(size_t n);
    void deallocate(T* p, size_t n);
  };
}
</pre>
<p>
<ins>-?- <tt>allocator_traits&lt;allocator&lt;T&gt;&gt;::is_always_equal::value</tt> is <tt>true</tt> for any <tt>T</tt>.</ins>
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-07 Cologne]</i></p>

<p>
Jonathan provides updated wording.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4820">N4820</a>.</p>

<ol>
<li><p>Modify 20.10.10 <a href="https://timsong-cpp.github.io/cppwp/default.allocator">[default.allocator]</a> as follows:</p>

<blockquote>
<p>
-1- All specializations of the default allocator satisfy the allocator completeness requirements (16.5.3.5.1 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements.completeness">[allocator.requirements.completeness]</a>).
</p>
<pre>
namespace std {
  template&lt;class T&gt; class allocator {
  public:
    using value_type = T;
    using size_type = size_t;
    using difference_type = ptrdiff_t;
    using propagate_on_container_move_assignment = true_type;
    <del>using is_always_equal = true_type;</del>
    constexpr allocator() noexcept;
    constexpr allocator(const allocator&amp;) noexcept;
    template&lt;class U&gt; constexpr allocator(const allocator&lt;U&gt;&amp;) noexcept;
    ~allocator();
    allocator&amp; operator=(const allocator&amp;) = default;
    [[nodiscard]] T* allocate(size_t n);
    void deallocate(T* p, size_t n);
  };
}
</pre>
<p>
<ins>-?- <tt>allocator_traits&lt;allocator&lt;T&gt;&gt;::is_always_equal::value</tt> is <tt>true</tt> for any <tt>T</tt>.</ins>
</p>
</blockquote>
</li>

<li><p>Add a new subclause in Annex D after D.10 <a href="https://timsong-cpp.github.io/cppwp/depr.str.strstreams">[depr.str.strstreams]</a>:</p>

<blockquote>
<p>
<b><ins>D.? The default allocator  [depr.default.allocator]</ins></b>
<p/>
<ins>-?- The following member is defined in addition to those specified in 20.10.10 <a href="https://timsong-cpp.github.io/cppwp/default.allocator">[default.allocator]</a>:</ins>
</p>
<pre>
<ins>namespace std {
  template &lt;class T&gt; class allocator {
  public:
    using is_always_equal = true_type;
  };
}</ins>
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3171" href="3171">3171.</a> LWG 2989 breaks <tt>directory_entry</tt> stream insertion</h3>
<p><b>Section:</b> 29.11.11 <a href="https://timsong-cpp.github.io/cppwp/fs.class.directory.entry">[fs.class.directory.entry]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2018-12-03 <b>Last modified:</b> 2019-04-02 17:52:57 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#fs.class.directory.entry">active issues</a> in [fs.class.directory.entry].</p>
<p><b>View all other</b> <a href="lwg-index.html#fs.class.directory.entry">issues</a> in [fs.class.directory.entry].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>directory_entry</tt> has a conversion function to <tt>const path&amp;</tt> and depends on <tt>path</tt>'s stream insertion 
operator for stream insertion support, which is now broken after LWG <a href="2989">2989</a> made it a hidden friend.
<p/>
This does not appear to be intended.
</p>

<p><i>[2018-12-21 Reflector prioritization]</i></p>

<p>Set Priority to 2</p>
<p><i>[2019-02; Kona Wednesday night issue processing]</i></p>

<p>Status to Open; Marshall to move definition inline and re-vote on reflector.</p>
<p>Jonathan to write a paper about how to specify "hidden friends".</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4778">N4778</a>.</p>

<ol>
<li><p>Modify  [fs.class.directory_entry], class <tt>directory_entry</tt> synopsis, as follows:</p>

<blockquote>
<pre>
namespace std::filesystem {
  class directory_entry {
  public:
    [&hellip;]
  private:
    filesystem::path pathobject;     // exposition only
    friend class directory_iterator; // exposition only

<ins>    template&lt;class charT, class traits&gt;
      friend basic_ostream&lt;charT, traits&gt;&amp;
        operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const directory_entry&amp; d);</ins>
  };
}
</pre>
</blockquote>
</li>
<li>
<p>Add a new subclause at the end of  [fs.class.directory_entry], as follows:</p>
<blockquote>
<p><strong>28.11.11.4 Inserter [fs.dir.entry.io]</strong></p>
<blockquote>
<pre>
template&lt;class charT, class traits&gt;
  friend basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const directory_entry&amp; d);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to: <tt> return os &lt;&lt; d.path(); </tt>
</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3172" href="3172">3172.</a> 3-arg <tt>std::hypot</tt> is underspecified compared to the 2-arg overload</h3>
<p><b>Section:</b> 26.8.3 <a href="https://timsong-cpp.github.io/cppwp/c.math.hypot3">[c.math.hypot3]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Matthias Kretz <b>Opened:</b> 2018-12-06 <b>Last modified:</b> 2018-12-21 15:26:00 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The 2-arg <tt>hypot</tt> function specified in the C standard is required to avoid overflow and underflow 
(7.12.7.3 p2). Furthermore C's Annex F (IEC 60559 floating-point arithmetic) defines special cases for 
inputs of <tt>&plusmn;0</tt> and <tt>&plusmn;inf</tt> (F. 10.4.3). The 3-arg <tt>hypot</tt> function 
26.8.3 <a href="https://timsong-cpp.github.io/cppwp/c.math.hypot3">[c.math.hypot3]</a> is only specified as "<i>Returns:</i> 
<math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo>
<msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup></msqrt></math>.". This is 
inconsistent with the 2-arg overload.
<p/>
It is not clear whether C's Annex F is "imported" into the C++ standard. [cmath.syn] p1 suggests that it 
is: "The contents and meaning of the header <tt>&lt;cmath&gt;</tt> are the same as the C standard library 
header <tt>&lt;math.h&gt;</tt>, [&hellip;]". 
</p>

<p><i>[2018-12-21 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4778">N4778</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting Note:</i> Two mutually exclusive options are prepared, depicted below by <b>Option A</b> and 
<b>Option B</b>, respectively.]
</p>
</blockquote>

<p><b>Option A</b></p>

<ol>
<li><p>Modify 26.8.3 <a href="https://timsong-cpp.github.io/cppwp/c.math.hypot3">[c.math.hypot3]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
float hypot(float x, float y, float z);
double hypot(double x, double y, double z);
long double hypot(long double x, long double y, long double z);
</pre>
<blockquote>
<p>
<ins>-?- <i>Effects:</i> The <tt>hypot</tt> functions compute the square root of the sum of the
squares of <tt>x</tt>, <tt>y</tt>, and <tt>z</tt>, without undue overflow or underflow. A range error
may occur.</ins>
<p/>
-1- <i>Returns:</i> <math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo>
<msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup></msqrt></math>.
<p/>
<ins>-?- <i>Remarks:</i> If <tt>__STDC_IEC_559__</tt> is defined, the following guarantees hold:</ins>
</p>
<ul>
<li><p><ins><tt>hypot(x, y, z)</tt>, <tt>hypot(x, z, y)</tt>, <tt>hypot(z, y, x)</tt>, and <tt>hypot(x, y, -z)</tt> 
are equivalent.</ins></p></li>
<li><p><ins>if <tt>y<sup>2</sup> + z<sup>2</sup> == &plusmn;0</tt>, <tt>hypot(x, y, z)</tt> is equivalent to <tt>fabs(x)</tt>.</ins></p></li>
<li><p><ins><tt>hypot(&plusmn;&infin;, y, z)</tt> returns <tt>+&infin;</tt>, even if <tt>y</tt> and/or <tt>z</tt> is a 
NaN.</ins></p></li>
</ul>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>

<p><b>Option B</b></p>

<ol>
<li><p>Add a note that clarifies that the behavior of the 3-arg <tt>hypot</tt> function
differs from the C specification. I.e. that no special guarantees wrt. over-/underflow or 
special values are given.</p>
</li>
</ol>





<hr>
<h3><a name="3174" href="3174">3174.</a> Precondition on <tt>is_convertible</tt> is too strong</h3>
<p><b>Section:</b> 20.15.6 <a href="https://timsong-cpp.github.io/cppwp/meta.rel">[meta.rel]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2018-12-09 <b>Last modified:</b> 2019-03-16 21:04:24 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.rel">issues</a> in [meta.rel].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Per <a href="http://eel.is/c++draft/meta.rel#tab:type-traits.relationship">Table 49</a>
in 20.15.6 <a href="https://timsong-cpp.github.io/cppwp/meta.rel">[meta.rel]</a>, the preconditions for both
<tt>is_convertible&lt;From, To&gt;</tt> and
<tt>is_nothrow_convertible&lt;From, To&gt;</tt> are:
</p>
<blockquote>
<p>
<tt>From</tt> and <tt>To</tt> shall be complete types, arrays of unknown bound,
or <i>cv</i> <tt>void</tt> types.
</p>
</blockquote>
<p>
Consequently, this program fragment:
</p>
<blockquote>
<pre>
struct S;
static_assert(is_convertible_v&lt;S, const S&amp;&gt;);
</pre>
</blockquote>
<p>
has undefined behavior despite that the actual behavior of <tt>is_convertible</tt>
specified in <a href="https://wg21.link/meta.rel#5">[meta.rel]/5</a>:
</p>
<blockquote>
<p>
-5- The predicate condition for a template specialization
<tt>is_convertible&lt;From, To&gt;</tt> shall be satisfied if and only if the
return expression in the following code would be well-formed, including any
implicit conversions to the return type of the function:
</p>
<blockquote>
<pre>
To test() {
  return declval&lt;From&gt;();
}
</pre>
</blockquote>
<p>[ <i>Note:</i> &hellip;]</p>
</blockquote>
<p>
is well-formed: <tt>declval&lt;S&gt;()</tt> is an xvalue of type <tt>S</tt>,
which certainly does implicitly convert to <tt>const S&amp;</tt>. We should
relax the precondition to allow this perfectly valid case (and similar cases
like <tt>is_convertible&lt;S, S&amp;&amp;&gt;</tt>), letting the cases that
would in fact be invalid fall through to the blanket "incompletely-defined
object type" wording in
<a href="https://wg21.link/meta.rqmts#5">[meta.rqmts]/5</a>.
</p>

<p><i>[2018-12-21 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4791">N4791</a>.</p>

<ol>
<li><p>Modify Table 49 in 20.15.6 <a href="https://timsong-cpp.github.io/cppwp/meta.rel">[meta.rel]</a> as follows:</p>
<table border="1">
<caption>Table 49 &mdash; Type relationship predicates</caption>
<tr style="text-align:center">
<th>Template</th>
<th>Condition</th>
<th>Comments</th>
</tr>
<tr>
<td>[&hellip;]</td>
<td>[&hellip;]</td>
<td>[&hellip;]</td>
</tr>
<tr>
<td>
<pre>
template&lt;class From, class To&gt;
struct is_convertible;
</pre>
</td>
<td><i>see below</i></td>
<td>
<del><tt>From</tt> and</del> <tt>To</tt> shall be <ins>a</ins><br/>
complete type<del>s</del>, <ins>an</ins><br/>
array<del>s</del> of unknown bound,<br/>
or <i>cv</i> <tt>void</tt> <del>types</del>.
</td>
</tr>
<tr>
<td>
<pre>
template&lt;class From, class To&gt;
struct is_nothrow_convertible;
</pre>
</td>
<td>
<tt>is_convertible_v&lt;From, <br/>
To&gt;</tt> is <tt>true</tt> and the<br/>
conversion, as defined by<br/>
<tt>is_convertible</tt>, is known<br/>
not to throw any<br/>
exceptions (7.6.2.6 <a href="https://timsong-cpp.github.io/cppwp/expr.unary.noexcept">[expr.unary.noexcept]</a>)
</td>
<td>
<del><tt>From</tt> and</del> <tt>To</tt> shall be <ins>a</ins><br/>
complete type<del>s</del>, <ins>an</ins><br/>
array<del>s</del> of unknown bound,<br/>
or <i>cv</i> <tt>void</tt> <del>types</del>.
</td>
</tr>
<tr>
<td>[&hellip;]</td>
<td>[&hellip;]</td>
<td>[&hellip;]</td>
</tr>
</table>
</li>
</ol>





<hr>
<h3><a name="3175" href="3175">3175.</a> The <tt>CommonReference</tt> requirement of concept <tt>SwappableWith</tt> is not satisfied in the example</h3>
<p><b>Section:</b> 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Kostas Kyrimis <b>Opened:</b> 2018-12-14 <b>Last modified:</b> 2020-02-10 19:48:51 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#concept.swappable">active issues</a> in [concept.swappable].</p>
<p><b>View all other</b> <a href="lwg-index.html#concept.swappable">issues</a> in [concept.swappable].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The defect stems from the example found in sub-clause 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a> p5:
</p>
<blockquote>
<pre>
[&hellip;]

template&lt;class T, std::SwappableWith&lt;T&gt; U&gt;
void value_swap(T&amp;&amp; t, U&amp;&amp; u) {
  ranges::swap(std::forward&lt;T&gt;(t), std::forward&lt;U&gt;(u));
}

[&hellip;]
namespace N {
  struct A { int m; };
  struct Proxy { A* a; };
  Proxy proxy(A&amp; a) { return Proxy{ &amp;a }; }
  
  void swap(A&amp; x, Proxy p) {
    ranges::swap(x.m, p.a-&gt;m);
  }
  void swap(Proxy p, A&amp; x) { swap(x, p); } <i>// satisfy symmetry requirement</i>
}

int main() {
  [&hellip;]
  N::A a1 = { 5 }, a2 = { -5 };
  value_swap(a1, proxy(a2)); // diagnostic manifests here(#1)
  assert(a1.m == -5 &amp;&amp; a2.m == 5);
}
</pre>
</blockquote>
<p>
The call to <tt>value_swap(a1, proxy(a2))</tt> resolves to [<tt>T</tt> = <tt>N::A&amp;</tt>, <tt>U</tt> = <tt>N::Proxy</tt>]
The compiler will issue a diagnostic for #1 because:
</p>
<ol>
<li><p>rvalue <tt>proxy(a2)</tt> is not swappable</p></li>
<li><p>concept <tt>SwappableWith&lt;T, U&gt;</tt> requires <tt>N::A</tt> and <tt>Proxy</tt> to model
<tt>CommonReference&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt;</tt> It follows 
from the example that there is no common reference for [<tt>T</tt> = <tt>N::A&amp;</tt>, <tt>U</tt> = <tt>N::Proxy</tt>]</p></li>
</ol>

<p><i>[2019-06-20; Casey Carter comments and provides improved wording]</i></p>

<p>
The purpose of the <tt>CommonReference</tt> requirements in the cross-type concepts is to provide a 
sanity check. The fact that two types satisfy a single-type concept, have a common reference type 
that satisfies that concept, and implement cross-type operations required by the cross-type flavor 
of that concept very strongly suggests the programmer intends them to model the cross-type concept. 
It's an opt-in that requires some actual work, so it's unlikely to be inadvertent.
<p/>
The <tt>CommonReference&lt;const T&amp;, const U&amp;&gt;</tt> pattern makes sense for the comparison 
concepts which require that all variations of <tt>const</tt> and value category be comparable: we 
use <tt>const</tt> lvalues to trigger the "implicit expression variation" wording in 
18.2 <a href="https://timsong-cpp.github.io/cppwp/concepts.equality">[concepts.equality]</a>. <tt>SwappableWith</tt>, however, doesn't care about implicit expression 
variations: it only needs to witness that we can exchange the values denoted by two reference-y 
expressions <tt>E1</tt> and <tt>E2</tt>. This suggests that <tt>CommonReference&lt;decltype((E1)), 
decltype((E2))&gt;</tt> is a more appropriate requirement than the current 
<tt>CommonReference&lt;const remove_reference_t&lt;&hellip;&gt;</tt> mess that was blindly copied 
from the comparison concepts.
<p/>
We must change the definition of "exchange the values" in 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a> &mdash; 
which refers to the common reference type &mdash; consistently.
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4791">N4791</a>.</p>

<ol>
<li><p>Change 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a> as indicated:</p>

<blockquote>
<p>
-3- [&hellip;]
</p>
<blockquote>
<pre>
template&lt;class T&gt;
  concept Swappable = requires(T&amp; a, T&amp; b) { ranges::swap(a, b); };
  
template&lt;class T, class U&gt;
  concept SwappableWith =
  CommonReference&lt;<ins>T, U</ins><del>const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;</del>&gt; &amp;&amp;
  requires(T&amp;&amp; t, U&amp;&amp; u) {
    ranges::swap(std::forward&lt;T&gt;(t), std::forward&lt;T&gt;(t));
    ranges::swap(std::forward&lt;U&gt;(u), std::forward&lt;U&gt;(u));
    ranges::swap(std::forward&lt;T&gt;(t), std::forward&lt;U&gt;(u));
    ranges::swap(std::forward&lt;U&gt;(u), std::forward&lt;T&gt;(t));
  };
</pre>
</blockquote>
<p>
-4- [&hellip;]
<p/>
-5- [<i>Example:</i> User code can ensure that the evaluation of <tt>swap</tt> calls is performed in an appropriate context
under the various conditions as follows:
</p>
<blockquote>
<pre>
#include &lt;cassert&gt;
#include &lt;concepts&gt;
#include &lt;utility&gt;

namespace ranges = std::ranges;

template&lt;class T, std::SwappableWith&lt;T&gt; U&gt;
void value_swap(T&amp;&amp; t, U&amp;&amp; u) {
  ranges::swap(std::forward&lt;T&gt;(t), std::forward&lt;U&gt;(u));
}

template&lt;std::Swappable T&gt;
void lv_swap(T&amp; t1, T&amp; t2) {
  ranges::swap(t1, t2);
}

namespace N {
  struct A { int m; };
  struct Proxy { 
    A* a;
    <ins>Proxy(A&amp; a) : a{&amp;a} {}</ins>
    <ins>friend void swap(Proxy&amp;&amp; x, Proxy&amp;&amp; y) {
      ranges::swap(x.a, y.a);
    }</ins>
  };
  Proxy proxy(A&amp; a) { return Proxy{ &amp;a }; }
  void swap(A&amp; x, Proxy p) {
    ranges::swap(x.m, p.a->m);
  }
  void swap(Proxy p, A&amp; x) { swap(x, p); } // satisfy symmetry requirement
}

int main() {
  int i = 1, j = 2;
  lv_swap(i, j);
  assert(i == 2 &amp;&amp; j == 1);
  N::A a1 = { 5 }, a2 = { -5 };
  value_swap(a1, proxy(a2));
  assert(a1.m == -5 &amp;&amp; a2.m == 5);
}
</pre>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>
<p><i>[2020-01-16 Priority set to 1 after discussion on the reflector.]</i></p>


<p><i>[2020-02-10 Move to Immediate Monday afternoon in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>.</p>

<ol>
<li><p>Change 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a> as indicated:</p>

<blockquote>
<p>
-1- Let <tt>t1</tt> and <tt>t2</tt> be equality-preserving expressions that denote distinct equal objects 
of type <tt>T</tt>, and let <tt>u1</tt> and <tt>u2</tt> similarly denote distinct equal objects of type 
<tt>U</tt>. [<i>Note:</i> <tt>t1</tt> and <tt>u1</tt> can denote distinct objects, or the same object. 
&mdash; <i>end note</i>] An operation <i>exchanges the values</i> denoted by <tt>t1</tt> and <tt>u1</tt> if 
and only if the operation modifies neither <tt>t2</tt> nor <tt>u2</tt> and:
</p>
<ol style="list-style-type:none">
<li><p>(1.1) &mdash; If <tt>T</tt> and <tt>U</tt> are the same type, the result of the operation is that 
<tt>t1</tt> equals <tt>u2</tt> and <tt>u1</tt> equals <tt>t2</tt>.</p></li>
<li><p>(1.2) &mdash; If <tt>T</tt> and <tt>U</tt> are different types <del>that model 
<tt>CommonReference&lt;const T&amp;, const U&amp;&gt;</tt></del><ins>and 
<tt>CommonReference&lt;decltype((t1)), decltype((u1))&gt;</tt> is modeled</ins>, the result of the 
operation is that <tt>C(t1)</tt> equals <tt>C(u2)</tt> and <tt>C(u1)</tt> equals <tt>C(t2)</tt> where 
<tt>C</tt> is <tt>common_reference_t&lt;<del>const T&amp;, 
const U&amp;</del><ins>decltype((t1)), decltype((u1))</ins>&gt;</tt>.</p></li>
</ol>
<p>
-2- [&hellip;]
<p/>
-3- [&hellip;]
</p>
<blockquote>
<pre>
template&lt;class T&gt;
  concept Swappable = requires(T&amp; a, T&amp; b) { ranges::swap(a, b); };
  
template&lt;class T, class U&gt;
  concept SwappableWith =
  CommonReference&lt;<ins>T, U</ins><del>const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;</del>&gt; &amp;&amp;
  requires(T&amp;&amp; t, U&amp;&amp; u) {
    ranges::swap(std::forward&lt;T&gt;(t), std::forward&lt;T&gt;(t));
    ranges::swap(std::forward&lt;U&gt;(u), std::forward&lt;U&gt;(u));
    ranges::swap(std::forward&lt;T&gt;(t), std::forward&lt;U&gt;(u));
    ranges::swap(std::forward&lt;U&gt;(u), std::forward&lt;T&gt;(t));
  };
</pre>
</blockquote>
<p>
-4- [&hellip;]
<p/>
-5- [<i>Example:</i> User code can ensure that the evaluation of <tt>swap</tt> calls is performed in an appropriate context
under the various conditions as follows:
</p>
<blockquote>
<pre>
#include &lt;cassert&gt;
#include &lt;concepts&gt;
#include &lt;utility&gt;

namespace ranges = std::ranges;

template&lt;class T, std::SwappableWith&lt;T&gt; U&gt;
void value_swap(T&amp;&amp; t, U&amp;&amp; u) {
  ranges::swap(std::forward&lt;T&gt;(t), std::forward&lt;U&gt;(u));
}

template&lt;std::Swappable T&gt;
void lv_swap(T&amp; t1, T&amp; t2) {
  ranges::swap(t1, t2);
}

namespace N {
  struct A { int m; };
  struct Proxy { 
    A* a;
    <ins>Proxy(A&amp; a) : a{&amp;a} {}</ins>
    <ins>friend void swap(Proxy x, Proxy y) {
      ranges::swap(*x.a, *y.a);
    }</ins>
  };
  Proxy proxy(A&amp; a) { return Proxy{ <del>&amp;</del>a }; }
  <del>void swap(A&amp; x, Proxy p) {
    ranges::swap(x.m, p.a->m);
  }
  void swap(Proxy p, A&amp; x) { swap(x, p); } <i>// satisfy symmetry requirement</i></del>
}

int main() {
  int i = 1, j = 2;
  lv_swap(i, j);
  assert(i == 2 &amp;&amp; j == 1);
  N::A a1 = { 5 }, a2 = { -5 };
  value_swap(a1, proxy(a2));
  assert(a1.m == -5 &amp;&amp; a2.m == 5);
}
</pre>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3177" href="3177">3177.</a> Limit permission to specialize variable templates to program-defined types</h3>
<p><b>Section:</b> 16.5.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/namespace.std">[namespace.std]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2018-12-11 <b>Last modified:</b> 2018-12-21 15:26:00 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#namespace.std">issues</a> in [namespace.std].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The permission denoted by [namespace.std]/3 should be limited to program-defined types.
</p>

<p><i>[2018-12-21 Reflector prioritization]</i></p>

<p>Set Priority to 3</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4791">N4791</a>.</p>

<ol>
<li><p>Change 16.5.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/namespace.std">[namespace.std]</a> as indicated:</p>
<blockquote>
<p>
-2- Unless explicitly prohibited, a program may add a template specialization for any standard library class
template to namespace <tt>std</tt> provided that (a) the added declaration depends on at least one program-defined
type and (b) the specialization meets the standard library requirements for the original template.(footnote 174)
<p/>
-3- The behavior of a C++ program is undefined if it declares an explicit or partial specialization of any standard
library variable template, except where explicitly permitted by the specification of that variable 
template<ins>, provided that the added declaration depends on at least one program-defined type</ins>.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3178" href="3178">3178.</a> <tt>std::mismatch</tt> is missing an upper bound</h3>
<p><b>Section:</b> 25.5.10 <a href="https://timsong-cpp.github.io/cppwp/mismatch">[mismatch]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> Geoffrey Romer <b>Opened:</b> 2018-12-20 <b>Last modified:</b> 2019-03-24 16:07:34 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#mismatch">issues</a> in [mismatch].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Consider the following code:
</p>
<blockquote><pre>
std::vector&lt;int&gt; v1 = {1, 2, 3, 4};
std::vector&lt;int&gt; v2 = {1, 2, 3, 5};
auto result = std::mismatch(v1.begin(), v1.begin() + 2, v2.begin(), v2.begin() + 2);
</pre></blockquote>
<p>
The current wording of [mismatch] seems to require <tt>result</tt> to be <tt>{v1.begin() + 3, v2.begin() + 3}</tt>, because 3
is the smallest integer <tt>n</tt> such that <tt>*(v1.begin() + n) != *(v2.begin + n)</tt>. In other words, if there's a
mismatch that's reachable from <tt>first1</tt> and <tt>first2</tt>, then <tt>std::mismatch</tt> must find and return it,
even if it's beyond the end iterators passed by the user.
<p/>
This is doubly unimplementable: the library has no way of knowing that it's safe to keep going past the end of the user-supplied
range, and even if it could, doing so would violate the complexity requirements. More importantly, it would violate the
fundamental convention that STL algorithms operate on user-supplied ranges, not on the underlying containers.
</p>

<p><i>[2019-01-26 Priority to 0 and Status to Tentatively Ready after discussions on the reflector]</i></p>

<p>
During that reflector discussion several contributers argued in favour for changing the current wording in
25.5.10 <a href="https://timsong-cpp.github.io/cppwp/mismatch">[mismatch]</a> p3 from "smallest integer" to "smallest <ins>nonnegative</ins> integer". This minor 
wording delta has also been added to the original proposed wording.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4791">N4791</a>.</p>

<ol>
<li><p>Change 25.5.10 <a href="https://timsong-cpp.github.io/cppwp/mismatch">[mismatch]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class InputIterator1, class InputIterator2&gt;
  constexpr pair&lt;InputIterator1, InputIterator2&gt;
    mismatch(InputIterator1 first1, InputIterator1 last1,
             InputIterator2 first2);
[&hellip;]
namespace ranges {
  template&lt;InputIterator I1, Sentinel&lt;I1&gt; S1, InputIterator I2, Sentinel&lt;I2&gt; S2,
           class Proj1 = identity, class Proj2 = identity,
           IndirectRelation&lt;projected&lt;I1, Proj1&gt;,
           projected&lt;I2, Proj2&gt;&gt; Pred = ranges::equal_to&lt;&gt;&gt;
    constexpr mismatch_result&lt;I1, I2>
      mismatch(I1 first1, S1 last1, I2 first2, S2 last2, Pred pred = {},
               Proj1 proj1 = {}, Proj2 proj2 = {});
  template&lt;InputRange R1, InputRange R2,
           class Proj1 = identity, class Proj2 = identity,
           IndirectRelation&lt;projected&lt;iterator_t&lt;R1&gt;, Proj1&gt;,
           projected&lt;iterator_t&lt;R2&gt;, Proj2&gt;&gt; Pred = ranges::equal_to&lt;&gt;&gt;
    constexpr mismatch_result&lt;safe_iterator_t&lt;R1&gt;, safe_iterator_t&lt;R2&gt;&gt;
      mismatch(R1&amp;&amp; r1, R2&amp;&amp; r2, Pred pred = {},
               Proj1 proj1 = {}, Proj2 proj2 = {});
}
</pre>
<blockquote>
<p>
-1- Let <tt>last2</tt> be <tt>first2 + (last1 - first1)</tt> for the overloads with no parameter <tt>last2</tt> or <tt>r2</tt>.
<p/>
-2- Let <tt><i>E</i></tt> be:
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; <tt>!(*(first1 + n) == *(first2 + n))</tt> for the overloads with no parameter <tt>pred</tt>,</p></li>
<li><p>(2.2) &mdash; <tt>pred(*(first1 + n), *(first2 + n)) == false</tt> for the overloads with a parameter <tt>pred</tt> and
no parameter <tt>proj1</tt>,</p></li>
<li><p>(2.3) &mdash; <tt>!invoke(pred, invoke(proj1, *(first1 + n)), invoke(proj2, *(first2 + n)))</tt> for the overloads with
both parameters <tt>pred</tt> and <tt>proj1</tt>.</p></li>
</ol>
<ins>-?- Let <tt><i>N</i></tt> be <tt>min(last1 - first1, last2 - first2)</tt>.</ins>
<p/>
-3- <i>Returns:</i> <tt>{ first1 + n, first2 + n }</tt>, where <tt>n</tt> is the smallest <ins>nonnegative</ins> integer such 
that <tt><i>E</i></tt> holds, or <tt><del>min(last1 - first1, last2 - first2)</del><ins><i>N</i></ins></tt> if no such integer 
<ins>less than <tt><i>N</i></tt></ins> exists.
<p/>
-4- <i>Complexity:</i> At most <tt><del>min(last1 - first1, last2 - first2)</del><ins><i>N</i></ins></tt> applications of the
corresponding predicate and any projections.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-03-15; Daniel comments]</i></p>

<p>
The <a href="https://github.com/cplusplus/draft/issues/2611">editorial issue #2611</a> had been
resolved via this <a href="https://github.com/cplusplus/draft/pull/2613">pull request #2613</a>.
The editorial changes should make the suggested wording changes obsolete and I recommend to close
this issue as <b>Resolved</b>.
</p>


<p><b>Rationale:</b></p>
Resolved by editorial <a href="https://github.com/cplusplus/draft/pull/2613">pull request #2613</a>.


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3188" href="3188">3188.</a> <tt>istreambuf_iterator::pointer</tt> should not be <i>unspecified</i></h3>
<p><b>Section:</b> 23.6.3 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator">[istreambuf.iterator]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-02-21 <b>Last modified:</b> 2019-10-30 17:35:10 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#istreambuf.iterator">active issues</a> in [istreambuf.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#istreambuf.iterator">issues</a> in [istreambuf.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current working paper requires <tt>iterator_traits&lt;Iter&gt;::pointer</tt> to be <tt>void</tt> if <tt>Iter</tt> 
doesn't define <tt>operator-&gt;</tt> (23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a>). We recently removed <tt>operator-&gt;</tt> 
from <tt>istreambuf_iterator</tt> via LWG <a href="2790">2790</a>, therefore either its <tt>pointer</tt> member should be 
<tt>void</tt>, or there should be a partial specialization of <tt>iterator_traits</tt>. Do we want to change 
<i>unspecified</i> to <tt>void</tt> in the class synopsis in [istreambuf.iterator]?
</p>

<p><i>[2019-03-03, Daniel provides concrete wording]</i></p>


<p><i>[2019-03-05 Priority set to 3 after reflector discussion]</i></p>


<p><i>[2019-03-05, Daniel comments]</i></p>

<p>
With the acceptance of <a href="https://wg21.link/p1252r2">P1252R2</a> the committee decided to deprecate <tt>operator-&gt;</tt> 
of <tt>move_iterator</tt>, interestingly without mentioning what should happen with its current <tt>pointer</tt> typedef (which
is equal to the template parameter <tt>Iterator</tt> and thus never <tt>void</tt>). Effectively this is a very similar situation 
as for the here discussed <tt>istreambuf_iterator</tt> case and it seems attractive to me to solve both cases similarly. 
</p>

<p><i>[2019-10-30, Jonathan comments]</i></p>

<p>
Also, <tt>reverse_iterator::operator-&gt;()</tt> is now constrained and so not always defined, but 
<tt>reverse_iterator::pointer</tt> is defined unconditionally.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4800">N4800</a>.</p>

<ol>
<li><p>Change class template <tt>istreambuf_iterator</tt> synopsis, 23.6.3 <a href="https://timsong-cpp.github.io/cppwp/istreambuf.iterator">[istreambuf.iterator]</a>, as indicated:</p>

<blockquote>
<pre>
template&lt;class charT, class traits = char_traits&lt;charT&gt;&gt;
class istreambuf_iterator {
public:
  using iterator_category = input_iterator_tag;
  using value_type        = charT;
  using difference_type   = typename traits::off_type;
  using pointer           = <ins>void</ins><del><i>unspecified</i></del>;
  using reference         = charT;
  [&hellip;]
};
</pre>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3189" href="3189">3189.</a> Missing requirement for <tt>std::priority_queue</tt></h3>
<p><b>Section:</b> 22.6.5 <a href="https://timsong-cpp.github.io/cppwp/priority.queue">[priority.queue]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-02-21 <b>Last modified:</b> 2019-03-05 18:54:44 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#priority.queue">issues</a> in [priority.queue].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
We don't require that the <tt>Compare</tt> template parameter can be invoked with arguments of the queue's value type. 
It seems like something we can use <i>Mandates:</i> for, since it'll be ill-formed otherwise. Something like 
<tt>is_invocable_r_v&lt;bool, Compare&amp;, value_type&amp;, value_type&amp;&gt;</tt>.
<p/>
This might also apply to the <tt>Compare</tt> parameter for the <tt>merge</tt> and <tt>sort</tt> functions of 
<tt>forward_list</tt> and <tt>list</tt>.
</p>

<p><i>[2019-03-05 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3192" href="3192">3192.</a> &sect;[allocator.uses.construction] functions misbehave for <tt>const</tt> types</h3>
<p><b>Section:</b> 20.10.8.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.uses.construction">[allocator.uses.construction]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-02-28 <b>Last modified:</b> 2019-03-16 08:03:53 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.uses.construction">active issues</a> in [allocator.uses.construction].</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.uses.construction">issues</a> in [allocator.uses.construction].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The new functions added by <a href="https://wg21.link/p0591r4">P0591R4</a> misbehave for <i>cv</i>-qualified types. 
A specialization <tt>std::uses_allocator&lt;X, Alloc&gt;</tt> will not match <tt>const X</tt>, so 
<tt>std::uses_allocator_construction_args&lt;const X&gt;</tt> will return a different result from 
<tt>std::uses_allocator_construction_args&lt;X&gt;</tt>. It makes no sense to construct <tt>X</tt> and <tt>const X</tt> 
differently, either the type wants to use an allocator or it doesn't. I think 
<tt>std::uses_allocator_construction_args&lt;T&gt;</tt> should remove <i>cv</i>-qualifiers before checking 
<tt>uses_allocator</tt>, so that it works consistently. 
<p/>
We could consider changing <tt>std::make_obj_using_allocator</tt> to also strip <i>cv</i>-qualifiers, but it's not 
necessary as C++17 guaranteed elision works even for prvalues of <tt>const</tt> types. We only need to make the 
construction args ignore <i>cv</i>-qualifiers. We don't want to make <i>cv</i>-qualified types ill-formed, because 
that would require users of uses-allocator construction to strip <i>cv</i>-qualifiers before using these functions, 
e.g. in cases like <tt>std::tuple&lt;const int&gt; t(allocator_arg, alloc, 1);</tt>
</p>

<p><i>[2019-03-15 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4800">N4800</a>.</p>

<ol>
<li><p>Change 20.10.8.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.uses.construction">[allocator.uses.construction]</a> as indicated:</p>

<blockquote>
<pre>
template &lt;class T, class Alloc, class... Args&gt;
  auto uses_allocator_construction_args(const Alloc&amp; alloc, Args&amp;&amp;... args) -&gt; <i>see below</i>;
</pre>
<blockquote>
<p>
-4- <i>Constraints:</i> <tt>T</tt> is not a specialization of <tt>pair</tt>.
<p/>
-5- <i>Returns:</i> A <tt>tuple</tt> value determined as follows<ins>, where <tt>U</tt> denotes the type 
<tt>remove_cv_t&lt;T&gt;</tt></ins>:
<ol style="list-style-type: none">
<li><p>(5.1) &mdash; If <tt>uses_allocator_v&lt;<del>T</del><ins>U</ins>, Alloc&gt;</tt> is <tt>false</tt> and 
<tt>is_constructible_v&lt;T, Args...&gt;</tt> is <tt>true</tt>, return 
<tt>forward_as_tuple(std::forward&lt;Args&gt;(args)...)</tt>.</p></li>
<li><p>(5.2) &mdash; Otherwise, if <tt>uses_allocator_v&lt;<del>T</del><ins>U</ins>, Alloc&gt;</tt> is <tt>true</tt> and 
<tt>is_constructible_v&lt;T, allocator_arg_t, Alloc, Args...&gt;</tt> is <tt>true</tt>, return</p>
<blockquote><pre>
tuple&lt;allocator_arg_t, const Alloc&amp;, Args&amp;&amp;...&gt;(
  allocator_arg, alloc, std::forward&lt;Args&gt;(args)...)
</pre></blockquote>
</li>
<li><p>(5.3) &mdash; Otherwise, if <tt>uses_allocator_v&lt;<del>T</del><ins>U</ins>, Alloc&gt;</tt> is <tt>true</tt> and 
<tt>is_constructible_v&lt;T, Args..., Alloc&gt;</tt> is <tt>true</tt>, return 
<tt>forward_as_tuple(std::forward&lt;Args&gt;(args)..., alloc)</tt>.</p></li>
<li><p>(5.4) &mdash; Otherwise, the program is ill-formed.</p></li>
</ol>
</p>
</blockquote>
[&hellip;]
<pre>
template &lt;class T, class Alloc, class Tuple1, class Tuple2&gt;
  auto uses_allocator_construction_args(const Alloc&amp; alloc, piecewise_construct_t,
                                        Tuple1&amp;&amp; x, Tuple2&amp;&amp; y) -&gt; <i>see below</i>;
</pre>
<blockquote>
<p>
-6- <i>Constraints:</i> <tt>T</tt> is a specialization of <tt>pair</tt>.
<p/>
-7- <i>Effects:</i> For <tt>T</tt> specified as <ins>(possibly <tt>const</tt>)</ins> <tt>pair&lt;T1, T2&gt;</tt>, equivalent to:
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template &lt;class T, class Alloc, class... Args&gt;
  T* uninitialized_construct_using_allocator(T* p, const Alloc&amp; alloc, Args&amp;&amp;... args);
</pre>
<blockquote>
<p>
-17- <i>Effects:</i> Equivalent to:
</p>
<blockquote><pre>
return ::new(<del>static_cast&lt;void*&gt;</del><ins><i>voidify</i></ins>(<ins>*</ins>p))
  T(make_obj_using_allocator&lt;T&gt;(alloc, std::forward&lt;Args&gt;(args)...));
</pre></blockquote>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3193" href="3193">3193.</a> <i>Mandates:</i> and <i>Expects:</i> elements are not defined for types</h3>
<p><b>Section:</b> 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2019-03-04 <b>Last modified:</b> 2019-03-18 20:52:45 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#structure.specifications">active issues</a> in [structure.specifications].</p>
<p><b>View all other</b> <a href="lwg-index.html#structure.specifications">issues</a> in [structure.specifications].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The working paper uses the special elements <i>Mandates:</i>, <i>Expects:</i> as well as 
<i>Requires:</i> to types, albeit 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> defines them 
only for functions, for example 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> sub-bullet (3.4):
</p>
<blockquote><p>
<i>Expects:</i> the conditions (sometimes termed preconditions) that the function assumes to hold whenever
it is called.
</p></blockquote>
<p>
Examples for such usages on types are (from <a href="https://wg21.link/n4800">N4800</a>):
</p>
<ul>
<li><p>21.2.2 <a href="https://timsong-cpp.github.io/cppwp/char.traits.typedefs">[char.traits.typedefs]</a> for types <tt>int_type</tt> and <tt>state_type</tt></p></li>
<li><p>20.4.4 <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a> for <tt>tuple_element&lt;I, pair&lt;T1, T2&gt;&gt;::type</tt></p></li>
<li><p>20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a> for <tt>tuple_element&lt;I, tuple&lt;Types...&gt;&gt;::type</tt></p></li>
<li><p>20.5.9 <a href="https://timsong-cpp.github.io/cppwp/tuple.traits">[tuple.traits]</a> for <tt>uses_allocator&lt;tuple&lt;Types...&gt;, Alloc&gt;</tt></p></li>
<li><p>Table 62 &mdash; "Container requirements" for type <tt>XX::value_type</tt></p></li>
<li><p>Table 65 &mdash; "Allocator-aware container requirements" for type <tt>allocator_type</tt></p></li>
<li><p>Table 69 &mdash; "Associative container requirements" for types <tt>X::value_type</tt> and <tt>X::key_compare</tt></p></li>
<li><p>Table 70 &mdash; "Unordered associative container requirements" for types <tt>X::value_type</tt> and <tt>X::key_equal</tt></p></li>
</ul>
<p>
Instead of replacing these elements usages for these places by extra wording to reach the same effects I
recommend to update instead 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a> to ensure that requirement-expressing elements
are defined in a way that it also allows to express requirements imposed on types by these elements to standardize 
"existing practice". 
<p/>
Considering details, it seems obvious that <i>Mandates:</i>, <i>Expects:</i> as well as <i>Requires:</i> are "suitable"
to be defined for types (With the acceptance of <a href="https://wg21.link/p1463r1">P1463R1</a> there are now also
<i>Mandates:</i> for types such as Table 65 &mdash; "Allocator-aware container requirements" for type <tt>allocator_type</tt>). 
<p/>
For <i>Constraints:</i> the meaning would not be so clear: Should it mean that there is conditionally a type defined or not? 
According to  the submitters knowledge there are currently no known examples for <i>Constraints:</i> to specify 
constraint on types, therefore I'm suggesting to restrict this extension to <i>Mandates:</i>, <i>Expects:</i>, 
and <i>Requires:</i> alone.
</p>

<p><i>[2019-03-15 Priority set to 3 after reflector discussion]</i></p>


<p><i>[2019-03-15; Daniel comments and provides wording]</i></p>

<p>
During the preparation of the wording for this issue it was found that we should allow 
<i>Remarks:</i> elements to be used for other things than functions. One example of imposed 
restrictions can be found in 17.11.3 <a href="https://timsong-cpp.github.io/cppwp/cmp.common">[cmp.common]</a>:
</p>
<blockquote>
<pre>
template&lt;class... Ts&gt;
struct common_comparison_category {
  using type = <i>see below</i>;
};
</pre>
<p>
-2- <i>Remarks:</i> The member <i>typedef-name</i> <tt>type</tt> denotes the common comparison type 
(11.11.3 <a href="https://timsong-cpp.github.io/cppwp/class.spaceship">[class.spaceship]</a>) of <tt>Ts...</tt>, the expanded parameter pack. [&hellip;]
</p>
</blockquote>
<p>
The discussion of this issue speaks of "type" restrictions (versus the specified restrictions on
functions), because even the non-type template argument restrictions of 20.4.4 <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a> 
appear in the context of a member type specification, but there are examples where not really a 
single (member) type is involved, e.g. in the 20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a> example mentioned above. 
<p/>
Another example is when such elements are used for the specification of template specializations, e.g.
in 20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a>:
</p>
<blockquote>
<pre>
template&lt;class T&gt; struct tuple_size;
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> All specializations of <tt>tuple_size</tt> shall satisfy the 
<i>Cpp17UnaryTypeTrait</i> requirements (20.15.1 <a href="https://timsong-cpp.github.io/cppwp/meta.rqmts">[meta.rqmts]</a>) with a base characteristic 
of <tt>integral_constant&lt;size_t, N&gt;</tt> for some <tt>N</tt>.
</p>
</blockquote>
</blockquote>
<p>
Besides class template specializations, a second relevant use-case is the specification of member types 
(Which are not necessarily part of a template), typically within the requirement tables, e.g. in 
Table 62 &mdash; "Container requirements"'s entry <tt>X::value_type</tt>:
</p>
<blockquote>
<p>
<i>Requires:</i> <tt>T</tt> is <i>Cpp17Erasable</i> from <tt>X</tt>
</p>
</blockquote>
<p>
The suggested wording tries to cover the generalization by means of the term "non-function 
entities" in addition to the existing functions to prevent being enforced to enumerate all entities
to which the extended rules apply.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Change 16.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/structure.specifications">[structure.specifications]</a>, as indicated:</p>

<blockquote>
<p>
-3- Descriptions of function semantics contain the following elements (as appropriate)<ins>; some
of these elements may also appear in the description of non-function entities as denoted 
below</ins>: (footnote [&hellip;])
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; <i>Requires:</i> the preconditions <ins>imposed on a non-function entity, 
or</ins> for calling the function.</p></li>
<li><p>(3.2) &mdash; <i>Constraints:</i> [&hellip;]</p></li>
<li><p>(3.3) &mdash; <i>Mandates:</i> the conditions that, if not met, render the program 
ill-formed. [<i>Example:</i> An implementation might express such a condition 
via the <i>constant-expression</i> in a <i>static_assert-declaration</i> (Clause 9). 
If the diagnostic is to be emitted only after the function has been selected by overload resolution, an 
implementation might express such a condition via a <i>constraint-expression</i> 
(13.5.2 <a href="https://timsong-cpp.github.io/cppwp/temp.constr.decl">[temp.constr.decl]</a>) and also define the function as deleted. &mdash; <i>end example</i>]</p></li>
<li><p>(3.4) &mdash; <i>Expects:</i> the conditions (sometimes termed preconditions) <ins>imposed 
on a non-function entity, or</ins> that the function assumes to hold whenever 
it is called. [<i>Example:</i> An implementation might express such conditions via an attribute such 
as <tt>[[expects]]</tt> ( [dcl.attr.contract]) <ins>on a function declaration</ins>. 
However, some such conditions might not lend themselves to expression via code. &mdash; 
<i>end example</i>]</p></li> <li><p>[&hellip;]</p></li>
<li><p>(3.11) &mdash; <i>Remarks:</i> additional semantic constraints <del>on the function</del>.</p></li>
<li><p>[&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Change 16.5.4.11 <a href="https://timsong-cpp.github.io/cppwp/res.on.required">[res.on.required]</a>, as indicated:</p>

<blockquote>
<p>
-1- Violation of any preconditions specified in a <del>function's</del> <i>Requires:</i> element 
results in undefined behavior unless the function's <i>Throws:</i> element specifies 
throwing an exception when <del>the</del><ins>a function's</ins> precondition is violated.
<p/>
-2- Violation of any preconditions specified in a<ins>n</ins> <del>function's</del> <i>Expects:</i> 
element results in undefined behavior.
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3194" href="3194">3194.</a> <tt>ConvertibleTo</tt> prose does not match code</h3>
<p><b>Section:</b> 18.4.4 <a href="https://timsong-cpp.github.io/cppwp/concept.convertible">[concept.convertible]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Hubert Tong  <b>Opened:</b> 2019-03-05 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#concept.convertible">active issues</a> in [concept.convertible].</p>
<p><b>View all other</b> <a href="lwg-index.html#concept.convertible">issues</a> in [concept.convertible].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The prose in <a href="https://wg21.link/n4800">N4800</a> subclause  [concept.convertibleto] indicates 
that the requirement is for an expression of a particular type and value category to be both implicitly and explicitly 
convertible to some other type. However, for a type
</p>
<blockquote><pre>
struct A { A(const A&amp;) = delete; };
</pre></blockquote>
<p>
<tt>ConvertibleTo&lt;const A, A&gt;</tt> would be <tt>false</tt> despite the following being okay:
</p>
<blockquote><pre>
const A f();

A test() {
  static_cast&lt;A&gt;(f());
  return f();
}
</pre></blockquote>

<p><i>[2019-03-15 Priority set to 1 after reflector discussion]</i></p>


<p><i>[2019-07-14 Tim adds PR based on discussion in 2019-07-09 LWG telecon]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>, and also resolves LWG <a href="3151">3151</a>.</p>

<ol>
<li><p>Modify  [concept.convertibleto] as indicated:</p>

<blockquote>
<p>
-1- The <tt>ConvertibleTo</tt> concept requires <del>an</del><ins>a glvalue</ins> expression of a particular type and
value category to be both implicitly and explicitly convertible to some other type. The implicit and explicit conversions
are required to produce equal results.
</p>

<pre>
template&lt;class From, class To&gt;
  concept ConvertibleTo =
    is_convertible_v&lt;From, To&gt; &amp;&amp;
    requires(<ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins> (&amp;f)()) {
      static_cast&lt;To&gt;(f());
    };
</pre>
<blockquote>
<p>
-2- Let <tt>test</tt> be the invented function:
</p>
<blockquote>
<pre>
To test(<ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins> (&amp;f)()) {
  return f();
}
</pre>
</blockquote>
<p>
for some types <tt>From</tt> and <tt>To</tt>, and let <tt>f</tt> be a function with no arguments and return type
<tt><ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins></tt> such that <tt>f()</tt> is equality-preserving.
<tt>From</tt> and <tt>To</tt> model <tt>ConvertibleTo&lt;From, To&gt;</tt> only if:
</p>
<ol style="list-style-type:none">
<li><p>(2.1) &mdash; <tt>To</tt> is not an object or reference-to-object type, or <tt>static_cast&lt;To&gt;(f())</tt>
is equal to <tt>test(f)</tt>.</p></li>
<li><p>(2.2) &mdash; <tt><ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins></tt> is not a reference-to-object type, or</p>
<ol style="list-style-type:none">
<li><p>(2.2.1) &mdash; If <tt><ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins></tt> is an rvalue reference 
to a non const-qualified type, the resulting state of the object referenced by <tt>f()</tt> after either above expression is valid
but unspecified (16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>).</p></li>
<li><p>(2.2.2) &mdash; Otherwise, the object referred to by <tt>f()</tt> is not modified by either above expression.</p></li>
</ol>
</li>
</ol>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-09-23; Daniel adjusts wording to working draft changes]</i></p>

<p>
Due to the concept renaming caused by <a href="http://wg21.link/p1754r1">P1754R1</a> the proposed
wording is outdated and needs adjustments.
</p>
<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>, and also resolves LWG <a href="3151">3151</a>.</p>

<ol>
<li><p>Modify 18.4.4 <a href="https://timsong-cpp.github.io/cppwp/concept.convertible">[concept.convertible]</a> as indicated:</p>

<blockquote>
<p>
-1- The <tt>convertible_to</tt> concept requires <del>an</del><ins>a glvalue</ins> expression of a particular type and
value category to be both implicitly and explicitly convertible to some other type. The implicit and explicit conversions
are required to produce equal results.
</p>

<pre>
template&lt;class From, class To&gt;
  concept convertible_to =
    is_convertible_v&lt;From, To&gt; &amp;&amp;
    requires(<ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins> (&amp;f)()) {
      static_cast&lt;To&gt;(f());
    };
</pre>
<blockquote>
<p>
-2- Let <tt>test</tt> be the invented function:
</p>
<blockquote>
<pre>
To test(<ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins> (&amp;f)()) {
  return f();
}
</pre>
</blockquote>
<p>
for some types <tt>From</tt> and <tt>To</tt>, and let <tt>f</tt> be a function with no arguments and return type
<tt><ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins></tt> such that <tt>f()</tt> is equality-preserving.
<tt>From</tt> and <tt>To</tt> model <tt>convertible_to&lt;From, To&gt;</tt> only if:
</p>
<ol style="list-style-type:none">
<li><p>(2.1) &mdash; <tt>To</tt> is not an object or reference-to-object type, or <tt>static_cast&lt;To&gt;(f())</tt>
is equal to <tt>test(f)</tt>.</p></li>
<li><p>(2.2) &mdash; <tt><ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins></tt> is not a reference-to-object type, or</p>
<ol style="list-style-type:none">
<li><p>(2.2.1) &mdash; If <tt><ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins></tt> is an rvalue reference 
to a non const-qualified type, the resulting state of the object referenced by <tt>f()</tt> after either above expression is valid
but unspecified (16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>).</p></li>
<li><p>(2.2.2) &mdash; Otherwise, the object referred to by <tt>f()</tt> is not modified by either above expression.</p></li>
</ol>
</li>
</ol>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>
<p><i>[2019-11-06 Tim updates PR based on discussion in Belfast LWG evening session]</i></p>

<p>
"glvalue" is incorrect because we want to allow testing <tt>convertible_to&lt;void, void&gt;</tt>. It's also less than clear
how the "expression" and "a particular type" in the first sentence correspond to the parameters of the concept.
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4835">N4835</a>, and also resolves LWG <a href="3151">3151</a>.</p>

<ol>
<li><p>Modify 18.4.4 <a href="https://timsong-cpp.github.io/cppwp/concept.convertible">[concept.convertible]</a> as indicated:</p>

<blockquote>
<p>
-1- The <tt>convertible_to</tt> concept <ins>for types <tt>From</tt> and <tt>To</tt></ins> requires an expression
<ins><tt>E</tt> such that <tt>decltype((E))</tt> is <tt>add_rvalue_reference_t&lt;From&gt;</tt></ins>
<del>of a particular type and value category</del> to be both implicitly and explicitly convertible to 
<del>some other type</del> <ins><tt>To</tt></ins>. The implicit and explicit conversions are required to produce equal results.
</p>

<pre>
template&lt;class From, class To&gt;
  concept convertible_to =
    is_convertible_v&lt;From, To&gt; &amp;&amp;
    requires(<ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins> (&amp;f)()) {
      static_cast&lt;To&gt;(f());
    };
</pre>
<blockquote>
<p>
-2- Let <ins><tt>FromR</tt> be <tt>add_rvalue_reference_t&lt;From&gt;</tt> and</ins> <tt>test</tt> be the invented function:
</p>
<blockquote>
<pre>
To test(From<ins>R</ins> (&amp;f)()) {
  return f();
}
</pre>
</blockquote>
<p>
for some types <tt>From</tt> and <tt>To</tt>, and let <tt>f</tt> be a function with no arguments and return type
<tt>From<ins>R</ins></tt> such that <tt>f()</tt> is equality-preserving.
<tt>From</tt> and <tt>To</tt> model <tt>convertible_to&lt;From, To&gt;</tt> only if:
</p>
<ol style="list-style-type:none">
<li><p>(2.1) &mdash; <tt>To</tt> is not an object or reference-to-object type, or <tt>static_cast&lt;To&gt;(f())</tt>
is equal to <tt>test(f)</tt>.</p></li>
<li><p>(2.2) &mdash; <tt>From<ins>R</ins></tt> is not a reference-to-object type, or</p>
<ol style="list-style-type:none">
<li><p>(2.2.1) &mdash; If <tt>From<ins>R</ins></tt> is an rvalue reference 
to a non const-qualified type, the resulting state of the object referenced by <tt>f()</tt> after either above expression is valid
but unspecified (16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>).</p></li>
<li><p>(2.2.2) &mdash; Otherwise, the object referred to by <tt>f()</tt> is not modified by either above expression.</p></li>
</ol>
</li>
</ol>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>
<p><i>[2019-11-09 Tim rephrased first sentence based on discussion in Belfast LWG Saturday session]</i></p>

<p><i>[Status to Tentatively ready after Belfast LWG Saturday session]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4835">N4835</a>, and also resolves LWG <a href="3151">3151</a>.</p>

<ol>
<li><p>Modify 18.4.4 <a href="https://timsong-cpp.github.io/cppwp/concept.convertible">[concept.convertible]</a> as indicated:</p>

<blockquote>
<p>
-1- <ins>Given types <tt>From</tt> and <tt>To</tt> and an expression <tt>E</tt> such that <tt>decltype((E))</tt>
is <tt>add_rvalue_reference_t&lt;From&gt;</tt>, <tt>convertible_to&lt;From, To&gt;</tt></ins>
<del>The <tt>convertible_to</tt> concept</del> requires <ins><tt>E</tt></ins>
<del>an expression of a particular type and value category</del> to be both implicitly and explicitly convertible to 
<del>some other</del> type<ins> <tt>To</tt></ins>. The implicit and explicit conversions are required to produce equal results.
</p>

<pre>
template&lt;class From, class To&gt;
  concept convertible_to =
    is_convertible_v&lt;From, To&gt; &amp;&amp;
    requires(<ins>add_rvalue_reference_t&lt;</ins>From<ins>&gt;</ins> (&amp;f)()) {
      static_cast&lt;To&gt;(f());
    };
</pre>
<blockquote>
<p>
-2- Let <ins><tt>FromR</tt> be <tt>add_rvalue_reference_t&lt;From&gt;</tt> and</ins> <tt>test</tt> be the invented function:
</p>
<blockquote>
<pre>
To test(From<ins>R</ins> (&amp;f)()) {
  return f();
}
</pre>
</blockquote>
<p>
for some types <tt>From</tt> and <tt>To</tt>, and let <tt>f</tt> be a function with no arguments and return type
<tt>From<ins>R</ins></tt> such that <tt>f()</tt> is equality-preserving.
<tt>From</tt> and <tt>To</tt> model <tt>convertible_to&lt;From, To&gt;</tt> only if:
</p>
<ol style="list-style-type:none">
<li><p>(2.1) &mdash; <tt>To</tt> is not an object or reference-to-object type, or <tt>static_cast&lt;To&gt;(f())</tt>
is equal to <tt>test(f)</tt>.</p></li>
<li><p>(2.2) &mdash; <tt>From<ins>R</ins></tt> is not a reference-to-object type, or</p>
<ol style="list-style-type:none">
<li><p>(2.2.1) &mdash; If <tt>From<ins>R</ins></tt> is an rvalue reference 
to a non const-qualified type, the resulting state of the object referenced by <tt>f()</tt> after either above expression is valid
but unspecified (16.5.5.16 <a href="https://timsong-cpp.github.io/cppwp/lib.types.movedfrom">[lib.types.movedfrom]</a>).</p></li>
<li><p>(2.2.2) &mdash; Otherwise, the object referred to by <tt>f()</tt> is not modified by either above expression.</p></li>
</ol>
</li>
</ol>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3195" href="3195">3195.</a> What is the stored pointer value of an empty <tt>weak_ptr</tt>?</h3>
<p><b>Section:</b> 20.11.4.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak.const">[util.smartptr.weak.const]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-03-15 <b>Last modified:</b> 2019-06-10 05:16:56 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.11.4.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak.const">[util.smartptr.weak.const]</a> specifies <tt>weak_ptr</tt>'s default constructor:
</p>
<blockquote>
<pre>
constexpr weak_ptr() noexcept;
</pre>
<blockquote>
<p>
1 <i>Effects:</i> Constructs an empty <tt>weak_ptr</tt> object.
<p/>
2 <i>Ensures:</i> <tt>use_count() == 0</tt>.
</p>
</blockquote>
</blockquote>
<p>
and <tt>shared_ptr</tt> converting constructor template:
</p>
<blockquote>
<pre>
weak_ptr(const weak_ptr&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr(const weak_ptr&lt;Y&gt;&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
</pre>
<blockquote>
<p>
3 <i>Remarks:</i> The second and third constructors shall not participate in overload resolution unless <tt>Y*</tt> is
compatible with <tt>T*</tt>.
<p/>
4 <i>Effects:</i> If <tt>r</tt> is empty, constructs an empty <tt>weak_ptr</tt> object; otherwise, constructs a
<tt>weak_ptr</tt> object that shares ownership with <tt>r</tt> and stores a copy of the pointer stored in <tt>r</tt>.
<p/>
5 <i>Ensures:</i> <tt>use_count() == r.use_count()</tt>.
</p>
</blockquote>
</blockquote>
<p>
Note that neither specifies the value of the stored pointer when the resulting <tt>weak_ptr</tt> is empty.
This didn't matter &mdash; the stored pointer value was unobservable for an empty <tt>weak_ptr</tt> &mdash;
until we added <tt>atomic&lt;weak_ptr&gt;</tt>. 31.8.6.2 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.atomic.weak">[util.smartptr.atomic.weak]</a>/15 says:
</p>
<blockquote>
<p>
<i>Remarks:</i> Two <tt>weak_ptr</tt> objects are equivalent if they store the same pointer value and either
share ownership, or both are empty. The weak form may fail spuriously. See 31.8.1 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.operations">[atomics.types.operations]</a>.
</p>
</blockquote>
<p>
Two empty <tt>weak_ptr</tt> objects that store different pointer values are not equivalent. We <em>could</em>
correct this by changing 31.8.6.2 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.atomic.weak">[util.smartptr.atomic.weak]</a>/15 to "Two <tt>weak_ptr</tt> objects are
equivalent if they are both empty, or if they share ownership and store the same pointer value." In practice,
an implementation of <tt>atomic&lt;weak_ptr&gt;</tt> will CAS on both the ownership (control block pointer)
and stored pointer value, so it seems cleaner to pin down the stored pointer value of an empty <tt>weak_ptr</tt>.
</p>

<p><i>[2019-06-09 Priority set to 2 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 20.11.4.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak.const">[util.smartptr.weak.const]</a> as indicated (note the drive-by edit to cleanup the occurrences of "constructs
an object of class foo"):</p>

<blockquote><pre>
constexpr weak_ptr() noexcept;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Constructs an empty <del><tt>weak_ptr</tt></del> object <ins>that stores a null pointer value</ins>.
<p/>
-2- <i>Ensures:</i> <tt>use_count() == 0</tt>.
</p>
</blockquote>
<pre>
weak_ptr(const weak_ptr&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr(const weak_ptr&lt;Y&gt;&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
</pre>
<blockquote>
<p>
-3- <i>Remarks:</i> The second and third constructors shall not participate in overload resolution unless <tt>Y*</tt> is
compatible with <tt>T*</tt>.
<p/>
-4- <i>Effects:</i> If <tt>r</tt> is empty, constructs an empty <del><tt>weak_ptr</tt></del> object <ins>that stores a
null pointer value</ins>; otherwise, constructs a <tt>weak_ptr</tt> object that shares ownership with <tt>r</tt>
and stores a copy of the pointer stored in <tt>r</tt>.
<p/>
-5- <i>Ensures:</i> <tt>use_count() == r.use_count()</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3197" href="3197">3197.</a> <tt>std::prev</tt> should not require <tt>BidirectionalIterator</tt></h3>
<p><b>Section:</b> 23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2019-04-03 <b>Last modified:</b> 2019-06-10 05:16:56 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.operations">active issues</a> in [iterator.operations].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.operations">issues</a> in [iterator.operations].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
MSVC++ (and apparently libc++) have asserts that <tt>std::prev</tt> only accepts <tt>BidirectionalIterator</tt>s, 
because it's declared in the standard as accepting only <tt>BidirectionalIterator</tt>. libc++ changed their tests 
(in <a href="https://github.com/llvm/llvm-project/commit/f51ee632475654a396f93da9d36841989e1c7742">this commit</a>), 
apparently from a bug report from Ville and Jonathan, saying that one could theoretically call <tt>std::prev</tt> 
with a negative number.
<p/>
The standardese in [iterator.operations] strongly indicates that <tt>prev</tt> requires a <tt>BidirectionalIterator</tt>, 
but I don't see the usual wording that connects template type parameters of that name to the <tt>&lt;algorithm&gt;</tt> 
requirements or similar. So perhaps one could argue that the name <tt>Bidirectional</tt> there has no meaning. Even 
if that is the case, that's a defect in the other direction.
</p>

<p><i>[2019-06-12 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting Note:</i> Three mutually exclusive options are prepared, depicted below by <b>Option A</b>, 
<b>Option B</b>, and <b>Option C</b>, respectively.]
</p>
</blockquote>

<p><b>Option A</b></p>

<ol>
<li><p>NAD, the name <tt>BidirectionalIterator</tt> actually means that <tt>prev</tt> requires bidirectional iterators, in which 
case this change to libcxx is incorrect.</p>
</li>
</ol>

<p><b>Option B</b></p>

<ol>
<li><p>Modify 23.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.synopsis">[iterator.synopsis]</a>, header <tt>&lt;iterator&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
<i>// 23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a>, iterator operations</i>
[&hellip;]
template&lt;class <del>Bidirectional</del><ins>Input</ins>Iterator&gt;
  constexpr <del>Bidirectional</del><ins>Input</ins>Iterator prev(<del>Bidirectional</del><ins>Input</ins>Iterator x,
    typename iterator_traits&lt;<del>Bidirectional</del><ins>Input</ins>Iterator&gt;::difference_type n = 1);
</pre>
</blockquote>
</li>

<li><p>Modify 23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a> as indicated:</p>

<blockquote><pre>
template&lt;class <del>Bidirectional</del><ins>Input</ins>Iterator&gt;
  constexpr <del>Bidirectional</del><ins>Input</ins>Iterator prev(<del>Bidirectional</del><ins>Input</ins>Iterator x,
    typename iterator_traits&lt;<del>Bidirectional</del><ins>Input</ins>Iterator&gt;::difference_type n = 1);
</pre>
<blockquote>
<p>
-7- <i>Effects:</i> Equivalent to: <tt>advance(x, -n); return x;</tt>
</p>
</blockquote>
</blockquote>
</li>
</ol>

<p><b>Option C</b></p>

<ol>
<li><p>The intent of the wording is that the template parameters apply requirements, and the defect is that they do not. 
We should add a requirement in 23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a>/1 to the effect that the template parameter names 
impose said requirements.</p>
</li>
</ol>





<hr>
<h3><a name="3200" href="3200">3200.</a> <tt>midpoint</tt> should not constrain <tt>T</tt> is complete</h3>
<p><b>Section:</b> 25.9.15 <a href="https://timsong-cpp.github.io/cppwp/numeric.ops.midpoint">[numeric.ops.midpoint]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Paolo Torres <b>Opened:</b> 2019-04-10 <b>Last modified:</b> 2019-06-10 05:16:56 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The constraint of the <tt>midpoint</tt> overload in 25.9.15 <a href="https://timsong-cpp.github.io/cppwp/numeric.ops.midpoint">[numeric.ops.midpoint]</a>:
</p>
<blockquote>
<pre>
template&lt;class T&gt;
constexpr T* midpoint(T* a, T* b);
</pre>
<blockquote>
<p>
-4- <i>Constraints:</i> <tt>T</tt> is a complete object type.
</p>
</blockquote>
</blockquote>
<p>
is incorrect. Paragraph 4 states <tt>T</tt> is constrained to be a complete object type, however it does not seem to 
be possible to implement <tt>T</tt> is complete. This means behavior is conditioned dependent on whether a type is 
complete, and this seems inconsistent with the library precedent.
</p>

<p><i>[2019-06-12 Priority set to 2 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 25.9.15 <a href="https://timsong-cpp.github.io/cppwp/numeric.ops.midpoint">[numeric.ops.midpoint]</a> as indicated:</p>

<blockquote><pre>
template&lt;class T&gt;
  constexpr T* midpoint(T* a, T* b);
</pre>
<blockquote>
<p>
-4- <i>Constraints:</i> <tt>T</tt> is a<ins>n</ins> <del>complete</del> object type.
<p/>
<ins>-?- <i>Mandates:</i> <tt>T</tt> is a complete type.</ins>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3201" href="3201">3201.</a> <tt>lerp</tt> should be marked as <tt>noexcept</tt></h3>
<p><b>Section:</b> 26.8.4 <a href="https://timsong-cpp.github.io/cppwp/c.math.lerp">[c.math.lerp]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Paolo Torres <b>Opened:</b> 2019-04-10 <b>Last modified:</b> 2020-02-14 06:55:06 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The overloads of <tt>lerp</tt> should be marked as <tt>noexcept</tt>, and this can be explained through the Lakos Rule. 
This function does not specify any undefined behaviour, and as such has no preconditions. This implies it has a wide 
contract, meaning it cannot throw, and thus can be marked as <tt>noexcept</tt>.
</p>

<p><i>[2020-02 Moved to Immediate on Thursday afternoon in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a>, header <tt>&lt;cmath&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
<i>// 26.8.4 <a href="https://timsong-cpp.github.io/cppwp/c.math.lerp">[c.math.lerp]</a>, linear interpolation</i>
constexpr float lerp(float a, float b, float t) <ins>noexcept</ins>;
constexpr double lerp(double a, double b, double t) <ins>noexcept</ins>;
constexpr long double lerp(long double a, long double b, long double t) <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

<li><p>Modify 26.8.4 <a href="https://timsong-cpp.github.io/cppwp/c.math.lerp">[c.math.lerp]</a> as indicated:</p>

<blockquote>
<pre>
constexpr float lerp(float a, float b, float t) <ins>noexcept</ins>;
constexpr double lerp(double a, double b, double t) <ins>noexcept</ins>;
constexpr long double lerp(long double a, long double b, long double t) <ins>noexcept</ins>;
</pre>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3203" href="3203">3203.</a> <tt>span</tt> element access invalidation</h3>
<p><b>Section:</b> 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2019-05-04 <b>Last modified:</b> 2019-06-10 05:16:56 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#span.overview">active issues</a> in [span.overview].</p>
<p><b>View all other</b> <a href="lwg-index.html#span.overview">issues</a> in [span.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>span</tt> doesn't explicitly point out when its accessed elements are invalidated like <tt>string_view</tt> 
does in 21.4.2.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.iterators">[string.view.iterators]</a> p2.
</p>

<p><i>[2019-06-12 Priority set to 2 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a> as indicated:</p>

<blockquote>
<p>
-4- <tt>ElementType</tt> is required to be a complete object type that is not an abstract class type.
<p/>
<ins>-?- For a <tt>span s</tt>, any operation that invalidates a pointer in the range 
<tt>[s.data(), s.data() + s.size())</tt> invalidates pointers, iterators, and references other than 
<tt>*this</tt> returned from <tt>s</tt>'s member functions.</ins>
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3204" href="3204">3204.</a> <tt>sub_match::swap</tt> only swaps the base class</h3>
<p><b>Section:</b> 30.9 <a href="https://timsong-cpp.github.io/cppwp/re.submatch">[re.submatch]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-05-07 <b>Last modified:</b> 2019-06-10 05:16:56 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.submatch">active issues</a> in [re.submatch].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.submatch">issues</a> in [re.submatch].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>sub_match&lt;I&gt;</tt> derives publicly from <tt>pair&lt;I,I&gt;</tt>, and so inherits 
<tt>pair::swap(pair&amp;)</tt>. This means that the following program fails:
</p>
<blockquote><pre>
#include &lt;regex&gt;
#include &lt;cassert&gt;

int main()
{
  std::sub_match&lt;const char*&gt; a, b;
  a.matched = true;
  a.swap(b);
  assert(b.matched);
}
</pre></blockquote>
<p>
The <tt>pair::swap(pair&amp;)</tt> member should be hidden by a <tt>sub_match::swap(sub_match&amp;)</tt> 
member that does the right thing.
</p>

<p><i>[2019-06-12 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 30.9 <a href="https://timsong-cpp.github.io/cppwp/re.submatch">[re.submatch]</a>, class template <tt>sub_match</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template&lt;class BidirectionalIterator&gt;
class sub_match : public pair&lt;BidirectionalIterator, BidirectionalIterator&gt; {
public:
  [&hellip;]
  int compare(const sub_match&amp; s) const;
  int compare(const string_type&amp; s) const;
  int compare(const value_type* s) const;
  
  <ins>void swap(sub_match&amp; s) noexcept(<i>see below</i>);</ins>
};
</pre>
</blockquote>
</li>

<li><p>Modify 30.9.1 <a href="https://timsong-cpp.github.io/cppwp/re.submatch.members">[re.submatch.members]</a> as indicated:</p>

<blockquote>
<pre>
int compare(const value_type* s) const;
</pre>
<blockquote>
<p>
[&hellip;]
</p>
</blockquote>
<pre>
<ins>void swap(sub_match&amp; s) noexcept(<i>see below</i>);</ins>
</pre>
<blockquote class="note">
[<i>Drafting note:</i> The swappable requirement should really be unnecessary because <i>Cpp17Iterator</i> 
requires it, but there is no wording that requires <tt>BidirectionalIterator</tt> to satisfy the 
bidirectional iterator requirements. &mdash; <i>end drafting note</i>]
</blockquote>
<blockquote>
<p>
<ins>-?- <i>Expects:</i> Lvalues of type <tt>BidirectionalIterator</tt> are swappable 
(16.5.3.2 <a href="https://timsong-cpp.github.io/cppwp/swappable.requirements">[swappable.requirements]</a>).</ins>
<p/>
<ins>-?- <i>Effects:</i> Equivalent to:</ins>
</p>
<blockquote><pre>
<ins>this-&gt;pair&lt;BidirectionalIterator, BidirectionalIterator&gt;::swap(s);
std::swap(matched, s.matched);</ins>
</pre></blockquote>
<p>
<ins>-?- <i>Remarks:</i> The expression inside <tt>noexcept</tt> is equivalent to 
<tt>is_nothrow_swappable_v&lt;BidirectionalIterator&gt;</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3205" href="3205">3205.</a> <tt>decay_t</tt> in the new <tt>common_type</tt> fallback should be <tt>remove_cvref_t</tt></h3>
<p><b>Section:</b> 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-05-12 <b>Last modified:</b> 2019-06-10 05:16:56 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.trans.other">active issues</a> in [meta.trans.other].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.trans.other">issues</a> in [meta.trans.other].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/p0898r4">P0898R4</a> "The One Ranges Proposal" added a new fallback case to 
the definition of <tt>common_type</tt> in 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a>, bullet 3.3.4:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
<p>
Otherwise, if <tt><i>COND_RES</i>(<i>CREF</i>(D1), <i>CREF</i>(D2))</tt> denotes a type, let <tt>C</tt> 
denote the type <tt>decay_t&lt;<i>COND_RES</i>(<i>CREF</i>(D1), <i>CREF</i>(D2))&gt;</tt>.
</p>
</blockquote>
<p>
Per para 3.3, <tt>D1</tt> and <tt>D2</tt> are decayed types. If both are <tt>void</tt>, bullet 3.3.4 
is not reached. If either is an abominable function type or <tt>void</tt>, the <tt><i>COND_RES</i></tt> 
type expression above is ill-formed and bullet 3.3.4 does not apply. In all cases in which the 
<tt><i>COND_RES</i></tt> expression is well-formed, <tt>D1</tt> and <tt>D2</tt> denote <i>cv</i>-unqualified 
non-array object types. Given that fact, (1) <tt><i>CREF</i>(D1)</tt> and <tt><i>CREF</i>(D2)</tt> 
are equivalent to <tt>const D1&amp;</tt> and <tt>const D2&amp;</tt>, respectively, and (2) the 
<tt><i>COND_RES</i></tt> expression is equivalent to <tt>decltype(false ? 
declval&lt;const D1&amp;&gt;() : declval&lt;const D1&amp;&gt;())</tt>, i.e., the second and third 
operands of the conditional operator are lvalues of type <tt>const D1</tt> and <tt>const D2</tt>, respectively.
<p/>
[expr.cond]/3 cannot apply since the operands are not glvalue bit-fields.
<p/>
If <tt>D1</tt> and <tt>D2</tt> are the same type, [expr.cond]/4 does not apply. If <tt>D1</tt> and 
<tt>D2</tt> are different types, there are a few cases to consider:
</p>
<ol>
<li><p>If [expr.cond]/4.1 applies, one operand is converted into an lvalue reference to the type of the other, 
i.e., both resulting operands are lvalues of type either <tt>const D1</tt> or <tt>const D2</tt>.</p></li>
<li><p>[expr.cond]/4.2 cannot apply since neither operand is an xvalue.</p></li>
<li><p>[expr.cond]/4.3.1 cannot apply since it would imply that the operands have the same type.</p></li>
<li><p>If [expr.cond]/4.3.2 applies &mdash; if either <tt>D1</tt> or <tt>D2</tt> is a base class of the 
other &mdash; again the resulting operands are lvalues of type either <tt>const D1</tt> or <tt>const D2</tt>.</p></li>
<li><p>If [expr.cond]/4.3.3 applies, the either the <tt>const D1&amp;</tt> operand converts to 
<tt>const D2</tt> or the <tt>const D2&amp;</tt> operand converts to <tt>const D1</tt>.</p></li>
<li><p>If none of the sub-bullets in [expr.cond]/4 applies, the operands are left unchanged.</p></li>
</ol>
<p>
[expr.cond]/5 applies if the operands initially had the same type, or in cases 1 and 4 above. The 
conditional expression is an lvalue of type <tt>const D1</tt> or <tt>const D2</tt>, and the 
<tt><i>COND_RES</i></tt> expression yields <tt>const D1&amp;</tt> or <tt>const D2&amp;</tt>.
<p/>
Only cases 5 and 6 reach [expr.cond]/6. This paragraph performs overload resolution, which may result 
in converting both operands to the same non-class type to invoke a builtin conditional operator "overload". 
<p/>
[expr.cond]/7 applies standard conversions including array-to-pointer and function-to-pointer conversion to the operands. Consequently, the operands are once more "decayed" if [expr.cond]/6 converted them to an array or function type. Again case-by-case:
</p>
<ol>
<li><p>[expr.cond]/7.1 applies if the operands now have the same type, which is the type of the conditional 
expression.</p></li>
<li><p>[expr.cond]/7.2 applies if the operands have arithmetic or enumeration type; the conditional expression yields the result of applying the usual arithmetic conversions.</p></li>
<li><p>[expr.cond]/7.3 applies if the operands have pointer type; the conditional expression yields their composite pointer type.</p></li>
<li><p>[expr.cond]/7.4 applies if the operands have pointer-to-member type; the conditional expression applies some more standard conversions and yields their composite pointer type.</p></li>
<li><p>[expr.cond]/7.5 applies if one operand has type <tt>nullptr_t</tt> and the other is either a null 
pointer constant or has type <tt>nullptr_t</tt>; the conditional expression yields <tt>nullptr_t</tt>.</p></li>
</ol>
<p>
In every case above, the conditional expression is either ill-formed, an lvalue of type <tt>const D1</tt> or 
<tt>const D2</tt>, or a prvalue of a non-array non-function type. Consequently the <tt><i>COND_RES</i></tt> 
type expression always yields a non-array non-function type, for which <tt>decay_t</tt> and <tt>remove_cvref_t</tt> 
are equivalent. We can therefore replace <tt><i>COND_RES</i>(<i>CREF</i>(D1), <i>CREF</i>(D2))</tt> in
[meta.trans.other]/3.3.4 with <tt>decltype(false ? declval&lt;const D1&amp;&gt;() : 
declval&lt;const D2&amp;&gt;())</tt>, and replace the usage of <tt>decay_t</tt> with <tt>remove_cvref_t</tt>.
<p/>
Furthermore, there are now quite a few different cases describing the behavior of <tt>common_type</tt>. 
It's not clear that <tt>common_type&lt;T...&gt;::type</tt> is always a decayed type without in-depth analysis. 
We should non-normatively clarify that fact.
</p>

<p><i>[2019-06-12 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> as indicated:</p>

<blockquote>
<p>
-2- Let:
</p>
<ol style="list-style-type: none">
<li><p><del>(2.1) &mdash; <tt><i>CREF</i>(A)</tt> be 
<tt>add_lvalue_reference_t&lt;const remove_reference_t&lt;A&gt;&gt;</tt>,</del></p></li>
<li><p>(2.2) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(2.9) &mdash; [&hellip;]</p></li>
</ol>
<p>
If any of the types computed above is ill-formed, then <tt><i>COMMON_REF</i>(A, B)</tt> is ill-formed.
<p/>
-3- Note A: For the <tt>common_type</tt> trait applied to a template parameter pack <tt>T</tt> of types, the member 
<tt>type</tt> shall be either defined or not present as follows:
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; [&hellip;]</p></li>
<li><p>(3.2) &mdash; [&hellip;]</p></li>
<li><p>(3.3) &mdash; If <tt>sizeof...(T)</tt> is two, let the first and second types constituting <tt>T</tt> 
be denoted by <tt>T1</tt> and <tt>T2</tt>, respectively, and let <tt>D1</tt> and <tt>D2</tt> denote the 
same types as <tt>decay_t&lt;T1&gt;</tt> and <tt>decay_t&lt;T2&gt;</tt>, respectively.</p>
<ol style="list-style-type: none">
<li><p>(3.3.1) &mdash; [&hellip;]</p></li>
<li><p>(3.3.2) &mdash; [&hellip;]</p></li>
<li><p>(3.3.3) &mdash; Otherwise, if</p>
<blockquote><pre>
decay_t&lt;decltype(false ? declval&lt;D1&gt;() : declval&lt;D2&gt;())&gt;
</pre></blockquote>
<p>
denotes a valid type, let <tt>C</tt> denote that type.
</p>
</li>
<li><p>(3.3.4) &mdash; Otherwise, if <del><tt><i>COND_RES</i>(<i>CREF</i>(D1), <i>CREF</i>(D2))</tt></del></p>
<blockquote><pre>
<ins>remove_cvref_t&lt;decltype(false ? declval&lt;const D1&amp;&gt;() : declval&lt;const D2&amp;&gt;())&gt;</ins>
</pre></blockquote>
<p> 
denotes a type, let <tt>C</tt> denote th<del>e</del><ins>at</ins> type 
<del><tt>decay_t&lt;<i>COND_RES</i>(<i>CREF</i>(D1), <i>CREF</i>(D2))&gt;</tt></del>.</p></li>
</ol>
</li>
<li><p>(3.4) &mdash; [&hellip;]</p></li>
</ol>
<p>
<ins>[<i>Note:</i> Whenever the <i>qualified-id</i> <tt>common_type&lt;T...&gt;::type</tt> is valid, 
it denotes the same type as <tt>decay_t&lt;common_type&lt;T...&gt;::type&gt;</tt>. &mdash; <i>end note</i>]</ins>
<p/>
-4- Note B: [&hellip;]
</p>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3207" href="3207">3207.</a> <tt>N</tt> in <tt>ssize(const T (&amp;)[N])</tt> should be <tt>size_t</tt></h3>
<p><b>Section:</b> 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a> <b>Status:</b> <a href="lwg-active.html#NAD">Tentatively NAD</a>
 <b>Submitter:</b> Nevin Liber <b>Opened:</b> 2019-05-23 <b>Last modified:</b> 2019-06-10 05:16:56 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.range">active issues</a> in [iterator.range].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.range">issues</a> in [iterator.range].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively NAD">Tentatively NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The <tt>N</tt> in <tt>ssize(const T (&amp;)[N])</tt> is specified to be of type <tt>ptrdiff_t</tt>.  
It should be <tt>size_t</tt> to be consistent with the rest of the standard library, such as the
array overloads for all other range access functions, the <tt>swap</tt> overload for arrays, and
other function template overloads for arrays. (Note: the return type of this function should still 
be <tt>ptrdiff_t</tt>.)
</p>

<p><i>[2019-06-12 Tentatively NAD after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T, <del>ptrdiff</del><ins>size</ins>_t N&gt; constexpr ptrdiff_t ssize(const T (&amp;array)[N]) noexcept;
</pre>
<blockquote>
<p>
-19- <i>Returns:</i> <tt><ins>static_cast&lt;ptrdiff_t&gt;(</ins>N<ins>)</ins></tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3210" href="3210">3210.</a> <tt>allocate_shared</tt> is inconsistent about removing <tt>const</tt> from the pointer 
passed to allocator <tt>construct</tt> and <tt>destroy</tt></h3>
<p><b>Section:</b> 20.11.3.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.create">[util.smartptr.shared.create]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2019-05-29 <b>Last modified:</b> 2019-06-16 19:32:21 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#util.smartptr.shared.create">active issues</a> in [util.smartptr.shared.create].</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared.create">issues</a> in [util.smartptr.shared.create].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I implemented the fix for LWG <a href="3008">3008</a> and Stephan pointed out there's an inconsistency here 
for <tt>allocate_shared&lt;const T&gt;</tt>.
<p/>
20.11.3.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.create">[util.smartptr.shared.create]</a> p3 says that the allocator construct call is done without removing 
<i>cv</i> qualifiers, but 20.11.3.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.create">[util.smartptr.shared.create]</a> p7.12 says that the <tt>destroy</tt> 
call is done with removed <i>cv</i> qualifiers.
<p/>
The fallback for <tt>allocator_traits::construct</tt> rejects <tt>const T*</tt> (since it <tt>static_casts</tt> 
to <tt>void*</tt>), so the most likely outcome of attempting to do this today is to fail to compile, which 
is a break with C++17.
<p/>
Our options are:
</p>
<ol>
<li><p>Fix the allocator model to deal with <tt>const</tt> elements somehow, which breaks compatibility 
with existing allocators unprepared for <tt>const</tt> elements here. We would need to extend the allocator 
requirements to allow <tt>const T*</tt> to be passed here, and fix our default to <tt>const_cast</tt>.</p></li>
<li><p>Fix <tt>allocate_shared</tt> to remove <tt>const</tt> before calling <tt>construct</tt>, which 
changes the experience for C++17 customers because <tt>allocate_shared</tt> constructs a <tt>T</tt> 
instead of a <tt>const T</tt>, but not in a way substantially different to edits 
<a href="http://wg21.link/p0674">P0674</a> already made here.</p></li>
<li><p>Back out <tt>allocate_shared</tt>'s interaction with this part of the allocator model (reverting 
this part of <a href="http://wg21.link/p0674">P0674</a> and reopening LWG <a href="3008">3008</a>).</p></li>
<li><p>Go around the problem by prohibiting <tt>allocate_shared&lt;const T&gt;</tt>, which breaks 
existing C++17 customers.</p></li>
</ol>
<p>
Billy O'Neal argues that only (2) preserves the design intent <a href="http://wg21.link/p0674">P0674</a> 
while maintaining compatibility for most allocators and most C++17 customers.
<p/>
Peter Dimov argues that (1) isn't likely to break enough to matter.
</p>

<p><i>[2019-06-16 Priority set to 3 based on reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> As the issue submitter prefers option (2), this is wording for that.]
</p>
</blockquote>

<ol>
<li><p>Modify 20.11.3.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.create">[util.smartptr.shared.create]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T, ...&gt;
  shared_ptr&lt;T&gt; make_shared(<i>args</i>);
template&lt;class T, class A, ...&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, <i>args</i>);
template&lt;class T, ...&gt;
  shared_ptr&lt;T&gt; make_shared_default_init(<i>args</i>);
template&lt;class T, class A, ...&gt;
  shared_ptr&lt;T&gt; allocate_shared_default_init(const A&amp; a, <i>args</i>);
</pre>
<blockquote>
<p>
-2- <i>Requires:</i> [&hellip;]
<p/>
[&hellip;]
<p/>
-7- <i>Remarks:</i>
</p>
<ol style="list-style-type: none">
<li><p>(7.1) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(7.5) &mdash; When a (sub)object of a non-array type <tt>U</tt> is specified to have an initial 
value of <tt>v</tt>, or <tt>U(l...)</tt>, where <tt>l...</tt> is a list of constructor arguments, 
<tt>allocate_shared</tt> shall initialize this (sub)object via the expression
</p>
<ol style="list-style-type: none">
<li><p>(7.5.1) &mdash; <tt>allocator_traits&lt;A2&gt;::construct(a2, pv, v)</tt> or</p></li>
<li><p>(7.5.2) &mdash; <tt>allocator_traits&lt;A2&gt;::construct(a2, pv, l...)</tt></p></li>
</ol>
<p>
respectively, where <tt>pv</tt> points to storage suitable to hold an object of type 
<tt><ins>remove_cv_t&lt;</ins>U<ins>&gt;</ins></tt> and <tt>a2</tt> of type <tt>A2</tt> is a 
rebound copy of the allocator <tt>a</tt> passed to <tt>allocate_shared</tt> such that its <tt>value_type</tt> 
is <tt>remove_cv_t&lt;U&gt;</tt>.
</p>
</li>
</ol>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3211" href="3211">3211.</a> <tt>std::tuple&lt;&gt;</tt> should be trivially constructible</h3>
<p><b>Section:</b> 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Ready</a>
 <b>Submitter:</b> Louis Dionne <b>Opened:</b> 2019-05-29 <b>Last modified:</b> 2020-02-13 12:51:34 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#tuple.cnstr">active issues</a> in [tuple.cnstr].</p>
<p><b>View all other</b> <a href="lwg-index.html#tuple.cnstr">issues</a> in [tuple.cnstr].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Ready">Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
That requirement is really easy to enforce, and it has been requested by users (e.g. 
<a href="https://bugs.llvm.org/show_bug.cgi?id=41714">libc++ bug 41714</a>).
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> as indicated:</p>

<blockquote>
<p>
-4- If <tt>is_trivially_destructible_v&lt;T<sub><i>i</i></sub>&gt;</tt> is <tt>true</tt> for all 
<tt>T<sub><i>i</i></sub></tt>, then the destructor of <tt>tuple</tt> is trivial. 
<ins>The default constructor of <tt>tuple&lt;&gt;</tt> is trivial.</ins>
</p>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
LWG discussion revealed that all where happy that we want this, except that the new wording should become 
a separate paragraph.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> as indicated:</p>

<blockquote>
<p>
-4- If <tt>is_trivially_destructible_v&lt;T<sub><i>i</i></sub>&gt;</tt> is <tt>true</tt> for all 
<tt>T<sub><i>i</i></sub></tt>, then the destructor of <tt>tuple</tt> is trivial. 
<p/>
<ins>-?- The default constructor of <tt>tuple&lt;&gt;</tt> is trivial.</ins>
</p>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3212" href="3212">3212.</a> <tt>tuple_element_t&lt;1, const span&lt;int, 42&gt;&gt;</tt> is <tt>const int</tt></h3>
<p><b>Section:</b> 22.7.3.9 <a href="https://timsong-cpp.github.io/cppwp/span.tuple">[span.tuple]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2019-05-31 <b>Last modified:</b> 2020-02-13 12:33:49 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
As currently specified, it uses the <i>cv</i>-qualified partial specialization, which incorrectly 
adds <i>cv</i>-qualification to the element type.
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 22.7.2 <a href="https://timsong-cpp.github.io/cppwp/span.syn">[span.syn]</a>, header <tt>&lt;span&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<i>// 22.7.3.9 <a href="https://timsong-cpp.github.io/cppwp/span.tuple">[span.tuple]</a>, tuple interface</i>
template&lt;class T&gt; class tuple_size;
template&lt;size_t I, class T&gt; class tuple_element;
template&lt;class ElementType, size_t Extent&gt;
  struct tuple_size&lt;span&lt;ElementType, Extent&gt;&gt;;
template&lt;class ElementType&gt;
  struct tuple_size&lt;span&lt;ElementType, dynamic_extent&gt;&gt;; <i>// not defined</i>
template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, span&lt;ElementType, Extent&gt;&gt;;
<ins>template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, const span&lt;ElementType, Extent&gt;&gt;;
template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, volatile span&lt;ElementType, Extent&gt;&gt;;
template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, const volatile span&lt;ElementType, Extent&gt;&gt;;</ins>
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.7.3.9 <a href="https://timsong-cpp.github.io/cppwp/span.tuple">[span.tuple]</a> before p1 as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The representation style for the newly added wording follows the new style
for <tt>tuple_element&lt;I, span&lt;ElementType, Extent&gt;&gt;::type</tt>, which 
  <a href="https://github.com/cplusplus/draft/pull/2868">had recently been changed editorially</a>.]
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class ElementType, size_t Extent&gt;
  struct tuple_size&lt;span&lt;ElementType, Extent&gt;&gt;
    : integral_constant&lt;size_t, Extent&gt; { };

tuple_element&lt;I, span&lt;ElementType, Extent&gt;&gt;::type

<ins>template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, const span&lt;ElementType, Extent&gt;&gt; {
    using type = ElementType;
  };

template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, volatile span&lt;ElementType, Extent&gt;&gt; {
    using type = ElementType;
  };

template&lt;size_t I, class ElementType, size_t Extent>
  struct tuple_element&lt;I, const volatile span&lt;ElementType, Extent&gt;&gt; {
    using type = ElementType;
  };</ins>
</pre>
<blockquote>
<p>
-1- <i>Mandates:</i> <tt>Extent != dynamic_extent &amp;&amp; I &lt; Extent</tt> is <tt>true</tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Wording needs to be adjusted, because we accepted <a href="http://wg21.link/p1831r1">P1831R1</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 22.7.2 <a href="https://timsong-cpp.github.io/cppwp/span.syn">[span.syn]</a>, header <tt>&lt;span&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<i>// 22.7.3.9 <a href="https://timsong-cpp.github.io/cppwp/span.tuple">[span.tuple]</a>, tuple interface</i>
template&lt;class T&gt; class tuple_size;
template&lt;size_t I, class T&gt; class tuple_element;
template&lt;class ElementType, size_t Extent&gt;
  struct tuple_size&lt;span&lt;ElementType, Extent&gt;&gt;;
template&lt;class ElementType&gt;
  struct tuple_size&lt;span&lt;ElementType, dynamic_extent&gt;&gt;; <i>// not defined</i>
template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, span&lt;ElementType, Extent&gt;&gt;;
<ins>template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, const span&lt;ElementType, Extent&gt;&gt;;</ins>
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.7.3.9 <a href="https://timsong-cpp.github.io/cppwp/span.tuple">[span.tuple]</a> before p1 as indicated:</p>

<blockquote>
<pre>
template&lt;class ElementType, size_t Extent&gt;
  struct tuple_size&lt;span&lt;ElementType, Extent&gt;&gt;
    : integral_constant&lt;size_t, Extent&gt; { };

template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, span&lt;ElementType, Extent&gt;&gt; {
    using type = ElementType;
  };

<ins>template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, const span&lt;ElementType, Extent&gt;&gt; {
    using type = ElementType;
  };</ins>
</pre>
<blockquote>
<p>
-1- <i>Mandates:</i> <tt>Extent != dynamic_extent &amp;&amp; I &lt; Extent</tt> is <tt>true</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Add the following wording to Annex D:</p>

<blockquote>
<p>
<ins><b>D.? Deprecated <tt>span</tt> tuple interface [depr.span.syn]</b></ins>
<p/>
<ins>1 The header <tt>&lt;span&gt;</tt> (22.7.2 <a href="https://timsong-cpp.github.io/cppwp/span.syn">[span.syn]</a>) has the following additions:</ins>
</p>
<blockquote><pre>
<ins>
namespace std {
  template&lt;size_t I, class ElementType, size_t Extent&gt;
    struct tuple_element&lt;I, volatile span&lt;ElementType, Extent&gt;&gt;;
  template&lt;size_t I, class ElementType, size_t Extent&gt;
    struct tuple_element&lt;I, const volatile span&lt;ElementType, Extent&gt;&gt;;
}</ins>
</pre></blockquote>
<p>
<ins><b>D.1.? tuple interface [depr.span.tuple]</b></ins>
</p>
<blockquote><pre>
<ins>template&lt;size_t I, class ElementType, size_t Extent&gt;
  struct tuple_element&lt;I, volatile span&lt;ElementType, Extent&gt;&gt; {
    using type = ElementType;
  };

template&lt;size_t I, class ElementType, size_t Extent>
  struct tuple_element&lt;I, const volatile span&lt;ElementType, Extent&gt;&gt; {
    using type = ElementType;
  };</ins>
</pre></blockquote>
<p>
<ins>-?- <i>Mandates:</i> <tt>Extent != dynamic_extent &amp;&amp; I &lt; Extent</tt> is <tt>true</tt>.</ins>
</p>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3213" href="3213">3213.</a> <tt>for_each_n</tt> and <tt>copy_n</tt> missing requirements for <tt>Size</tt></h3>
<p><b>Section:</b> 25.5.4 <a href="https://timsong-cpp.github.io/cppwp/alg.foreach">[alg.foreach]</a>, 25.6.1 <a href="https://timsong-cpp.github.io/cppwp/alg.copy">[alg.copy]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-05-31 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.foreach">issues</a> in [alg.foreach].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>search_n</tt> and <tt>fill_n</tt> and <tt>generate_n</tt> require that "The type <tt>Size</tt> shall be
convertible to integral type", but <tt>for_each_n</tt> and <tt>copy_n</tt> have no requirements on
<tt>Size</tt>. Presumably it should be convertible to an integral type.
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 3 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> Clause [algorithms] has not yet gone through a "Mandating" cleanup of our new wording
style for requirements expressed in <i>Requires</i> and <i>Expects</i> elements. The below wording
changes perform this fix for the touched paragraphs and also replaces here <i>Requires</i> by
<i>Expects</i> to prevent papers that address such wording changes to keep tracking of additional
wording changes caused by proposed wording of issues.]
</p>
</blockquote>

<ol>
<li><p>Modify 25.5.4 <a href="https://timsong-cpp.github.io/cppwp/alg.foreach">[alg.foreach]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class InputIterator, class Size, class Function&gt;
  constexpr InputIterator for_each_n(InputIterator first, Size n, Function f);
</pre>
<blockquote>
<p>
-16- <i>Requires:</i> shall satisfy the <i>Cpp17MoveConstructible</i> requirements [&hellip;]
<p/>
-17- <i><del>Requires</del><ins>Expects</ins>:</i> <ins>The type <tt>Size</tt> is convertible to integral type
(7.3.8 <a href="https://timsong-cpp.github.io/cppwp/conv.integral">[conv.integral]</a>, 11.4.7 <a href="https://timsong-cpp.github.io/cppwp/class.conv">[class.conv]</a>).</ins> <tt>n &gt;= 0</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class ExecutionPolicy, class ForwardIterator, class Size, class Function&gt;
  ForwardIterator for_each_n(ExecutionPolicy&amp;&amp; exec, ForwardIterator first, Size n,
                             Function f);
</pre>
<blockquote>
<p>
-21- <i>Requires:</i> shall satisfy the <i>Cpp17CopyConstructible</i> requirements [&hellip;]
<p/>
-22- <i><del>Requires</del><ins>Expects</ins>:</i> <ins>The type <tt>Size</tt> is convertible to integral type
(7.3.8 <a href="https://timsong-cpp.github.io/cppwp/conv.integral">[conv.integral]</a>, 11.4.7 <a href="https://timsong-cpp.github.io/cppwp/class.conv">[class.conv]</a>).</ins> <tt>n &gt;= 0</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 25.6.1 <a href="https://timsong-cpp.github.io/cppwp/alg.copy">[alg.copy]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class InputIterator, class Size, class OutputIterator&gt;
  constexpr OutputIterator copy_n(InputIterator first, Size n,
                                  OutputIterator result);
template&lt;class ExecutionPolicy, class ForwardIterator1, class Size, class ForwardIterator2&gt;
  ForwardIterator2 copy_n(ExecutionPolicy&amp;&amp; exec,
                          ForwardIterator1 first, Size n,
                          ForwardIterator2 result);
template&lt;InputIterator I, WeaklyIncrementable O&gt;
  requires IndirectlyCopyable&lt;I, O&gt;
  constexpr ranges::copy_n_result&lt;I, O&gt;
    ranges::copy_n(I first, iter_difference_t&lt;I&gt; n, O result);
</pre>
<blockquote>
<p>
-10- Let <tt><i>M</i></tt> be <tt>max(n, 0)</tt>.
<p/>
<ins>-?- <i>Expects:</i> The type <tt>Size</tt> is convertible to integral type
(7.3.8 <a href="https://timsong-cpp.github.io/cppwp/conv.integral">[conv.integral]</a>, 11.4.7 <a href="https://timsong-cpp.github.io/cppwp/class.conv">[class.conv]</a>).</ins>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3214" href="3214">3214.</a> &sect;[facet.num.get.virtuals] doesn't say what it means for digit grouping to be consistent</h3>
<p><b>Section:</b> 28.4.2.1.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.get.virtuals">[facet.num.get.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-06-03 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#facet.num.get.virtuals">active issues</a> in [facet.num.get.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#facet.num.get.virtuals">issues</a> in [facet.num.get.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
28.4.2.1.2 <a href="https://timsong-cpp.github.io/cppwp/facet.num.get.virtuals">[facet.num.get.virtuals]</a> paragraph 4 says:
</p>
<blockquote><p>
"Digit grouping is checked. That is, the positions of discarded separators is examined for consistency with
<tt>use_facet&lt;numpunct&lt;charT&gt;&gt;(loc).grouping()</tt>. If they are not consistent then
<tt>ios_base::failbit</tt> is assigned to <tt>err</tt>."
</p></blockquote>
<p>
It's unclear what is considered consistent or not.
<p/>
Obviously if the expected grouping is "1,234,567" then an input of "1,234,567" is consistent. Libstdc++,
MSVC and Boost all consider "1234567" to be consistent with an expected grouping "1,234,567" (and it
looks like libc++ is going to agree soon). That can be justified by saying that there are no discarded
separators to examine, so no inconsistency. But what about "1234,567"? There is only one discarded
separator here, and its position is consistent with the expected format.
<p/>
The wording should clarify that if there are no separators at all, that is OK. If there are one or more
separators then they must be at the expected positions, and there must not be any missing.
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 4 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3215" href="3215">3215.</a> <tt>variant</tt> default constructor has vague <tt>constexpr</tt> requirements</h3>
<p><b>Section:</b> 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Louis Dionne <b>Opened:</b> 2019-06-04 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#variant.ctor">active issues</a> in [variant.ctor].</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.ctor">issues</a> in [variant.ctor].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a> p5, we say:
</p>
<blockquote><p>
<i>Remarks:</i> This function shall be <tt>constexpr</tt> if and only if the value-initialization of
the alternative type <tt>T<sub>0</sub></tt> would satisfy the requirements for a constexpr function.
[&hellip;]
</p></blockquote>
<p>
First of all, I find it confusing that we say "This function shall be <tt>constexpr</tt> if [&hellip;]",
when the declaration of the function clearly has the <tt>constexpr</tt> keyword on it
unconditionally. Instead, I would use the wording "This function shall be usable in a constexpr context
if [&hellip;]".
<p/>
Secondly, I think we shouldn't be using if-and-only-if since it restricts whether implementations can be
<tt>constexpr</tt>-friendly as an extension. Instead, it seems better to just say "if".
<p/>
Finally, I think the condition under which the function must be <tt>constexpr</tt>-friendly is not
something we can test for because it says "value-initialization of the alternative type
<tt>T<sub>0</sub></tt> would satisfy the requirements for a constexpr function", which doesn't imply
the value initialization can actually be be performed inside a constexpr context (for example the
default constructor could be <tt>constexpr</tt> friendly <em>but</em> not marked with the
<tt>constexpr</tt> keyword).
</p>

<p><i>[2017-06-17, Tim Song comments]</i></p>

<p>This issue is related to LWG <a href="2833">2833</a>.</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 2 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a> as indicated:</p>

<blockquote>
<pre>
constexpr variant() noexcept(<i>see below</i>);
</pre>
<blockquote>
<p>
-2- <i>Effects:</i> [&hellip;]
<p/>
-3- <i>Ensures:</i> [&hellip;]
<p/>
-4- <i>Throws:</i> [&hellip;]
<p/>
-5- <i>Remarks:</i> This function shall be <ins>usable in a context that requires constant
evaluation if the alternative type <tt>T<sub>0</sub></tt> can be value-initialized in a context
that requires constant evaluation</ins><del><tt>constexpr</tt> if and only if the
value-initialization of the alternative type <tt>T<sub>0</sub></tt> would satisfy the requirements
for a constexpr function</del>. [&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3216" href="3216">3216.</a> Rebinding the allocator before calling <tt>construct</tt>/<tt>destroy</tt> in <tt>allocate_shared</tt></h3>
<p><b>Section:</b> 20.11.3.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.create">[util.smartptr.shared.create]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2019-06-11 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#util.smartptr.shared.create">active issues</a> in [util.smartptr.shared.create].</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared.create">issues</a> in [util.smartptr.shared.create].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The new <tt>allocate_shared</tt> wording says we need to rebind the allocator back to <tt>T</tt>'s
type before we can call <tt>construct</tt> or <tt>destroy</tt>, but this is suboptimal (might make
extra unnecessary allocator copies), and is inconsistent with the containers' behavior, which call
allocator <tt>construct</tt> on whatever <tt>T</tt> they want. (For example,
<tt>std::list&lt;T, alloc&lt;T&gt;&gt;</tt> rebinds to <tt>alloc&lt;_ListNode&lt;T&gt;&gt;</tt>,
but calls <tt>construct(T*)</tt> without rebinding back)
<p/>
It seems like we should be consistent with the containers and not require a rebind here. PR would
look something like this, relative to N4810; I'm still not super happy with this wording because
it looks like it might be saying a copy of the allocator must be made we would like to avoid&hellip;
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 3 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 20.11.3.6 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.create">[util.smartptr.shared.create]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The edits to change <tt>pv</tt> to <tt>pu</tt> were suggested by Jonathan
Wakely (thanks!). This wording also has the <tt>remove_cv_t</tt> fixes specified by LWG <a href="3210">3210</a>
&mdash; if that change is rejected some of those have to be stripped here.]
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class T, ...&gt;
  shared_ptr&lt;T&gt; make_shared(<i>args</i>);
template&lt;class T, class A, ...&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, <i>args</i>);
template&lt;class T, ...&gt;
  shared_ptr&lt;T&gt; make_shared_default_init(<i>args</i>);
template&lt;class T, class A, ...&gt;
  shared_ptr&lt;T&gt; allocate_shared_default_init(const A&amp; a, <i>args</i>);
</pre>
<blockquote>
<p>
-2- <i>Requires:</i> [&hellip;]
<p/>
[&hellip;]
<p/>
-7- <i>Remarks:</i>
</p>
<ol style="list-style-type: none">
<li><p>(7.1) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(7.5) &mdash; When a (sub)object of a non-array type <tt>U</tt> is specified to have an initial
value of <tt>v</tt>, or <tt>U(l...)</tt>, where <tt>l...</tt> is a list of constructor arguments,
<tt>allocate_shared</tt> shall initialize this (sub)object via the expression
</p>
<ol style="list-style-type: none">
<li><p>(7.5.1) &mdash; <tt>allocator_traits&lt;A2&gt;::construct(a2, p<del>v</del><ins>u</ins>, v)</tt> or</p></li>
<li><p>(7.5.2) &mdash; <tt>allocator_traits&lt;A2&gt;::construct(a2, p<del>v</del><ins>u</ins>, l...)</tt></p></li>
</ol>
<p>
respectively, where <tt>p<del>v</del><ins>u</ins></tt> <ins>is a pointer of type
<tt>remove_cv_t&lt;U&gt;*</tt></ins> point<del>s</del><ins>ing</ins> to storage suitable to hold
an object of type <tt><ins>remove_cv_t&lt;</ins>U<ins>&gt;</ins></tt> and <tt>a2</tt> of type
<tt>A2</tt> is a <ins>potentially</ins> rebound copy of the allocator <tt>a</tt>
passed to <tt>allocate_shared</tt> <del>such that its <tt>value_type</tt> is <tt>remove_cv_t&lt;U&gt;</tt></del>.
</p>
</li>
<li><p>(7.6) &mdash; [&hellip;]</p></li>
<li><p>(7.7) &mdash; When a (sub)object of non-array type <tt>U</tt> is specified to have a default
initial value, <tt>allocate_shared</tt> <del>shall</del> initialize<ins>s</ins> this (sub)object via
the expression <tt>allocator_traits&lt;A2&gt;::construct(a2, p<del>v</del><ins>u</ins>)</tt>, where
<tt>p<del>v</del><ins>u</ins></tt> <ins>is a pointer of type <tt>remove_cv_t&lt;U&gt;*</tt></ins>
point<del>s</del><ins>ing</ins> to storage suitable to hold an object of type
<tt><ins>remove_cv_t&lt;</ins>U<ins>&gt;</ins></tt> and <tt>a2</tt> of type <tt>A2</tt> is a
<ins>potentially</ins> rebound copy of the allocator <tt>a</tt> passed to <tt>allocate_shared</tt>
<del>such that its <tt>value_type</tt> is <tt>remove_cv_t&lt;U&gt;</tt></del>.</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(7.12) &mdash; When a (sub)object of non-array type <tt>U</tt> that was initialized by
<tt>allocate_shared</tt> is to be destroyed, it is destroyed via the expression
<tt>allocator_traits&lt;A2&gt;::destroy(a2, p<del>v</del><ins>u</ins>)</tt> where
<tt>p<del>v</del><ins>u</ins></tt> <ins>is a pointer of type <tt>remove_cv_t&lt;U&gt;*</tt></ins>
point<del>s</del><ins>ing</ins> to that object of type <tt>remove_cv_t&lt;U&gt;</tt> and
<tt>a2</tt> of type <tt>A2</tt> is a <ins>potentially</ins> rebound copy of the
allocator <tt>a</tt> passed to <tt>allocate_shared</tt> <del>such that its <tt>value_type</tt> is
<tt>remove_cv_t&lt;U&gt;</tt></del>.</p></li>
</ol>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3217" href="3217">3217.</a> <tt>&lt;memory&gt;</tt> and <tt>&lt;execution&gt;</tt> should define <tt>__cpp_lib_parallel_algorithm</tt></h3>
<p><b>Section:</b> 17.3.1 <a href="https://timsong-cpp.github.io/cppwp/support.limits.general">[support.limits.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-06-12 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#support.limits.general">issues</a> in [support.limits.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
There are parallel overloads of algorithms in <tt>&lt;memory&gt;</tt>, so it should define the macro.
Also, <tt>&lt;execution&gt;</tt> defines the exec policies for use with the algos, so that should
define the macro too.
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 3 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 17.3.1 <a href="https://timsong-cpp.github.io/cppwp/support.limits.general">[support.limits.general]</a>, Table 36 &mdash; "Standard library feature-test
macros", as indicated:</p>

<blockquote>

<table border="1">
<caption>Table 36 &mdash; Standard library feature-test macros</caption>
<tr style="text-align:center">
<th>Macro name</th>
<th>Value</th>
<th>Header(s)</th>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td><tt>__cpp_lib_parallel_algorithm</tt></td>
<td><tt>201603L</tt></td>
<td><tt>&lt;algorithm&gt; <ins>&lt;execution&gt; &lt;memory&gt;</ins> &lt;numeric&gt;</tt></td>
</tr>
<tr>
<td colspan="3" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>

</blockquote>
</li>
</ol>




<hr>
<h3><a name="3219" href="3219">3219.</a> <tt>std::array</tt> overview container requirements are incorrect</h3>
<p><b>Section:</b> 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a>, 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Nevin Liber &amp; Christian Trott <b>Opened:</b> 2019-06-13 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#array.overview">active issues</a> in [array.overview].</p>
<p><b>View all other</b> <a href="lwg-index.html#array.overview">issues</a> in [array.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The requirements specified in 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> p3 are incorrect; namely:
</p>
<ul>
<li><p>A default constructed <tt>array&lt;T, N&gt;</tt> where <tt>0 &lt; N</tt> has linear,
not constant complexity.</p></li>
<li><p>A default constructed <tt>array&lt;T, 0&gt;</tt> is empty and has constant complexity.</p></li>
</ul>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 3 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>, Table 62 &mdash; "Container requirements",
as indicated (This table can be identified by the "section" identifier [tab:container.req] in the next
working draft):</p>

<blockquote>
<table border="1">
<caption>Table 62 &mdash; Container requirements</caption>
<tr style="text-align:center">
<th>Expression</th>
<th>Return type</th>
<th>Operational<br/>semantics</th>
<th>Assertion/note<br/>pre/post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="5" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>X u;</tt>
</td>
<td>
<tt></tt>
</td>
<td></td>
<td>
<ins><i>Ensures:</i> <tt>!u.empty()</tt> for <tt>array&lt;T, N&gt;</tt> where <tt>0 &lt; N</tt>, and</ins><br/>
<i>Ensures:</i> <tt>u.empty()</tt> <ins>for all other standard containers.</ins>
</td>
<td>
<del>constant</del><ins>(Note A)</ins>
</td>
</tr>
<tr>
<td>
<tt>X()</tt>
</td>
<td>
<tt></tt>
</td>
<td></td>
<td>
<ins><i>Ensures:</i> <tt>!X().empty()</tt> for <tt>array&lt;T, N&gt;</tt> where <tt>0 &lt; N</tt>, and</ins><br/>
<i>Ensures:</i> <tt>X().empty()</tt> <ins>for all other standard containers.</ins>
</td>
<td>
<del>constant</del><ins>(Note A)</ins>
</td>
</tr>

<tr>
<td colspan="5" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>
<p>
Those entries marked "(Note A)" or "(Note B)" have linear complexity for <tt>array<ins>&lt;T, N&gt;</ins></tt>
<ins>where <tt>0 &lt; N</tt></ins> and have constant complexity for all other standard containers.
</p>
</blockquote>

</li>

<li><p>Modify 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> as indicated:</p>

<blockquote>
<p>
-2- An <tt>array</tt> is an aggregate (9.4.1 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.aggr">[dcl.init.aggr]</a>) that can be list-initialized with up to
<tt>N</tt> elements whose types are convertible to <tt>T</tt>.
<p/>
-3- <ins>An <tt>array&lt;T, 0&gt;</tt> satisfies all of the requirements of a container and of a
reversible container (22.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>).</ins> An
<tt>array<ins>&lt;T, N&gt;</ins></tt> <ins>where <tt>0 &lt; N</tt></ins> satisfies all
of the requirements of a container and of a reversible container
(22.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>), except that a default constructed
<tt>array<ins>&lt;T, N&gt;</ins></tt> object is not empty and <del>that</del><ins>both default
construction and</ins> <tt>swap</tt> <del>does not</del> have <del>constant</del><ins>linear</ins>
complexity. An <tt>array</tt> satisfies some of the requirements of a sequence container
(22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>). Descriptions are provided here only for operations on
<tt>array</tt> that are not described in one of these tables and for operations where there is
additional semantic information.
</p>
</blockquote>

</li>
</ol>




<hr>
<h3><a name="3220" href="3220">3220.</a> P0558 broke conforming C++14 uses of atomic <tt>shared_ptr</tt></h3>
<p><b>Section:</b> 31.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.syn">[atomics.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-06-11 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#atomics.syn">active issues</a> in [atomics.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.syn">issues</a> in [atomics.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This well-formed C++14 program:
</p>
<blockquote><pre>
#include &lt;atomic&gt;
#include &lt;memory&gt;

struct Abstract { virtual void test() = 0; };
struct Concrete : Abstract { virtual void test() override {} };

int main() {
  std::shared_ptr&lt;Abstract&gt; ptr;
  std::atomic_store&lt;Abstract&gt;(&amp;ptr, std::make_shared&lt;Concrete&gt;());
}
</pre></blockquote>
<p>
is ill-formed in C++17. <a href="http://wg21.link/p0558">P0558</a> changed the non-member
non-<tt>shared_ptr</tt> atomic functions to avoid deducing from their second argument,
e.g. C++14 <tt>atomic_store</tt>:
</p>
<blockquote><pre>
template&lt;class T&gt; void atomic_store(atomic&lt;T&gt;*, T); <i>// #1</i>
</pre></blockquote>
<p>
became C++17 <tt>atomic_store</tt>:
</p>
<blockquote><pre>
template&lt;class T&gt; void atomic_store(atomic&lt;T&gt;*, typename atomic&lt;T&gt;::value_type); <i>// #2</i>
</pre></blockquote>
<p>
The program intends to call the "other" <tt>atomic_store</tt> from
D.14 <a href="https://timsong-cpp.github.io/cppwp/depr.util.smartptr.shared.atomic">[depr.util.smartptr.shared.atomic]</a>:
</p>
<blockquote><pre>
template&lt;class T&gt; void atomic_store(shared_ptr&lt;T&gt;*, shared_ptr&lt;T&gt;); <i>// #3</i>
</pre></blockquote>
<p>
In C++14, the call expression in the sample program &mdash;
<tt>std::atomic_store&lt;Abstract&gt;(&amp;ptr, std::make_shared&lt;Concrete&gt;())</tt> &mdash;
selects overload <tt><i>#3</i></tt>; overload <tt><i>#1</i></tt> fails to be viable due to the
lack of conversions from <tt>shared_ptr&lt;Abstract&gt;*</tt> to <tt>atomic&lt;Abstract&gt;*</tt>
and from <tt>shared_ptr&lt;Concrete&gt;</tt> to <tt>Abstract</tt>. In C++17, overload
<tt><i>#2</i></tt> doesn't get to the point of considering argument conversions: when we try to
generate the declaration of the specialization for <tt>T = Abstract</tt> we must instantiate
<tt>atomic&lt;Abstract&gt;</tt> in order to substitute <tt>typename atomic&lt;Abstract&gt;::value_type</tt>,
but doing so violates the requirement in [atomics.types.generic] p1 that "The type of the template
argument <tt>T</tt> shall be trivially copyable"
<p/>
The fix is fairly straightforward since <tt>atomic&lt;T&gt;::value_type</tt> is always an alias
for <tt>T</tt>: for those non-member atomic functions with overloads defined in
D.14 <a href="https://timsong-cpp.github.io/cppwp/depr.util.smartptr.shared.atomic">[depr.util.smartptr.shared.atomic]</a>, use a different form to require that <tt>T</tt>
in the type of the second parameter is non-deduced.
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 3 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4810">N4810</a>.</p>

<ol>
<li><p>Modify 31.2 <a href="https://timsong-cpp.github.io/cppwp/atomics.syn">[atomics.syn]</a>, header <tt>&lt;atomic&gt;</tt> synopsis, as indicated:</p>

<blockquote><pre>
[&hellip;]
<i>// 31.9 <a href="https://timsong-cpp.github.io/cppwp/atomics.nonmembers">[atomics.nonmembers]</a>, non-member functions</i>
[&hellip;]
template&lt;class T&gt;
  void atomic_store(volatile atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  void atomic_store(atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  void atomic_store_explicit(volatile atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                             memory_order) noexcept;
template&lt;class T&gt;
  void atomic_store_explicit(atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                             memory_order) noexcept;
[&hellip;]
template&lt;class T&gt;
  T atomic_exchange(volatile atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  T atomic_exchange(atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  T atomic_exchange_explicit(volatile atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                             memory_order) noexcept;
template&lt;class T&gt;
  T atomic_exchange_explicit(atomic&lt;T&gt;*, <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                             memory_order) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_weak(volatile atomic&lt;T&gt;*,
                                    <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                    <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_weak(atomic&lt;T&gt;*,
                                    <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                    <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_strong(volatile atomic&lt;T&gt;*,
                                      <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                      <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_strong(atomic&lt;T&gt;*,
                                      <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                      <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_weak_explicit(volatile atomic&lt;T&gt;*,
                                             <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                             <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                                             memory_order, memory_order) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_weak_explicit(atomic&lt;T&gt;*,
                                             <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                             <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                                             memory_order, memory_order) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_strong_explicit(volatile atomic&lt;T&gt;*,
                                               <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                               <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                                               memory_order, memory_order) noexcept;
template&lt;class T&gt;
  bool atomic_compare_exchange_strong_explicit(atomic&lt;T&gt;*,
                                               <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>*,
                                               <del>typename atomic&lt;T&gt;::value_type</del><ins>type_identity_t&lt;T&gt;</ins>,
                                               memory_order, memory_order) noexcept;
</pre></blockquote>

</li>

<li><p>Modify 31.9 <a href="https://timsong-cpp.github.io/cppwp/atomics.nonmembers">[atomics.nonmembers]</a> as indicated:</p>

<blockquote>
<p>
-1- A non-member function template whose name matches the pattern <tt>atomic_<i>f</i></tt> or the
pattern <tt>atomic_<i>f</i>_explicit</tt> invokes the member function <tt><i>f</i></tt>, with the
value of the first parameter as the object expression and the values of the remaining parameters
(if any) as the arguments of the member function call, in order. An argument for a parameter of
type <tt>atomic&lt;T&gt;::value_type*</tt> <ins>or <tt>type_identity_t&lt;T&gt;*</tt></ins> is
dereferenced when passed to the member function call. If no such member function exists, the
program is ill-formed.
</p>
</blockquote>

</li>
</ol>




<hr>
<h3><a name="3223" href="3223">3223.</a> <tt>lerp</tt> should not add the "sufficient additional overloads"</h3>
<p><b>Section:</b> 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2019-06-20 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#cmath.syn">active issues</a> in [cmath.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#cmath.syn">issues</a> in [cmath.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It seems that <tt>lerp</tt> can't give a sensible answer for integer inputs. It's new machinery,
not the legacy C stuff extended with extra overloads.
<p/>
I would prefer to fix this by explicitly annotating the functions that are supposed to get additional
overloads because we keep getting this wrong, but we could also exempt <tt>lerp</tt> in
26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> p2.
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 2 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3226" href="3226">3226.</a> <tt>zoned_time</tt> constructor from <tt>string_view</tt> should accept
<tt>zoned_time&lt;Duration2, TimeZonePtr2&gt;</tt></h3>
<p><b>Section:</b> 27.11.7.2 <a href="https://timsong-cpp.github.io/cppwp/time.zone.zonedtime.ctor">[time.zone.zonedtime.ctor]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tomasz Kami&nacute;ski <b>Opened:</b> 2019-06-23 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#time.zone.zonedtime.ctor">issues</a> in [time.zone.zonedtime.ctor].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<code>zoned_time</code> constructors with <code>string_view</code> and
another <code>zoned_time</code> are not accepting <code>zoned_time</code>
instances that use a different time zone representation (<code>TimeZonePtr</code> parameter):
</p>
<blockquote><pre>
zoned_time(string_view name, const zoned_time&lt;Duration&gt;&amp; zt);
zoned_time(string_view name, const zoned_time&lt;Duration&gt;&amp; zt, choose);
</pre></blockquote>
<p>
This makes them inconsistent with the constructors from <code>TimeZonePtr</code> 
and <code>zoned_time</code>, that they delegate to: 
</p>
<blockquote><pre>
template&lt;class Duration2, class TimeZonePtr2&gt;
  zoned_time(TimeZonePtr z, const zoned_time&lt;Duration2, TimeZonePtr2&gt;&amp; zt);
template&lt;class Duration2, class TimeZonePtr2&gt;
  zoned_time(TimeZonePtr z, const zoned_time&lt;Duration2, TimeZonePtr2&gt;&amp; zt, choose);
</pre></blockquote>
<p>
Furthermore it forces the creation of a temporary <code>zoned_time</code> object in 
case when the source uses the same <code>TimeZonePtr</code>, but different <code>Duration</code>.
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>.</p>

<ol>
<li><p>Modify 27.11.7.1 <a href="https://timsong-cpp.github.io/cppwp/time.zone.zonedtime.overview">[time.zone.zonedtime.overview]</a>, class template <tt>zoned_time</tt> synopsis, 
as indicated:</p>

<blockquote>
<pre>
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; zt);
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; zt, choose);</pre>
</blockquote>
</li>

<li><p>Modify 27.11.7.2 <a href="https://timsong-cpp.github.io/cppwp/time.zone.zonedtime.ctor">[time.zone.zonedtime.ctor]</a> as indicated:</p>

<blockquote>
<pre>
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; y);
</pre>
<blockquote>
<p>
-32- <i>Remarks:</i> This constructor does not participate in overload resolution unless 
<tt>zoned_time</tt> is constructible from the return type of <tt>traits::locate_zone(name)</tt> 
and <tt>zoned_time<ins>&lt;Duration2, TimeZonePtr2&gt;</ins></tt>.
<p/>
-33- <i>Effects:</i> Equivalent to construction with <tt>{traits::locate_zone(name), y}</tt>.
</p>
</blockquote>
<pre>
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; y, choose c););
</pre>
<blockquote>
<p>
-34- <i>Remarks:</i> This constructor does not participate in overload resolution unless 
<tt>zoned_time</tt> is constructible from the return type of <tt>traits::locate_zone(name)</tt>, 
<tt>zoned_time<ins>&lt;Duration2, TimeZonePtr2&gt;</ins></tt>, and <tt>choose</tt>.
<p/>
-35- <i>Effects:</i> Equivalent to construction with <tt>{traits::locate_zone(name), y, c}</tt>.
<p/>
-36- [<i>Note:</i> The <tt>choose</tt> parameter has no effect. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>
</ol>

</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
During LWG discussions it was suggested to rebase the wording to reduce the chances for confusion.
</p>
<p><i>[2020-02 Status to Immediate on Thursday morning in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 27.11.7.1 <a href="https://timsong-cpp.github.io/cppwp/time.zone.zonedtime.overview">[time.zone.zonedtime.overview]</a>, class template <tt>zoned_time</tt> synopsis, 
as indicated:</p>

<blockquote>
<pre>
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; zt);
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; zt, choose);</pre>
</blockquote>
</li>

<li><p>Modify 27.11.7.2 <a href="https://timsong-cpp.github.io/cppwp/time.zone.zonedtime.ctor">[time.zone.zonedtime.ctor]</a> as indicated:</p>

<blockquote>
<pre>
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; y);
</pre>
<blockquote>
<p>
-32- <i>Constraints:</i> <tt>zoned_time</tt> is constructible from the return type of <tt>traits::locate_zone(name)</tt> 
and <tt>zoned_time<ins>&lt;Duration2, TimeZonePtr2&gt;</ins></tt>.
<p/>
-33- <i>Effects:</i> Equivalent to construction with <tt>{traits::locate_zone(name), y}</tt>.
</p>
</blockquote>
<pre>
<ins>template&lt;class Duration2, class TimeZonePtr2&gt;</ins>
zoned_time(string_view name, const zoned_time&lt;Duration<ins>2, TimeZonePtr2</ins>&gt;&amp; y, choose c););
</pre>
<blockquote>
<p>
-34- <i>Constraints:</i> <tt>zoned_time</tt> is constructible from the return type of <tt>traits::locate_zone(name)</tt>, 
<tt>zoned_time<ins>&lt;Duration2, TimeZonePtr2&gt;</ins></tt>, and <tt>choose</tt>.
<p/>
-35- <i>Effects:</i> Equivalent to construction with <tt>{traits::locate_zone(name), y, c}</tt>.
<p/>
-36- [<i>Note:</i> The <tt>choose</tt> parameter has no effect. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3227" href="3227">3227.</a> Ambiguity issue for <tt>extract</tt> in ordered and unordered associative containers</h3>
<p><b>Section:</b> 22.2.6 <a href="https://timsong-cpp.github.io/cppwp/associative.reqmts">[associative.reqmts]</a>, 22.2.7 <a href="https://timsong-cpp.github.io/cppwp/unord.req">[unord.req]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Konstantin Boyarinov <b>Opened:</b> 2019-06-25 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#associative.reqmts">active issues</a> in [associative.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#associative.reqmts">issues</a> in [associative.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Ordered and unordered associative containers in C++14 contained an issue, which caused an ambiguity
while invoking <tt>std::map::erase</tt> when <tt>key_type</tt> of the map can be constructed from
the iterator. In this case both overloads <tt>erase(const key_type&amp;)</tt> and
<tt>erase(const_iterator)</tt> could be chosen.
<p/>
The issue LWG <a href="2059">2059</a> was reported and resolved in C++17 by adding an extra overload
for <tt>erase</tt> in ordered and unordered associative containers which accepts <tt>iterator</tt>
as an argument.
<p/>
C++17 also introduced new functionality for splicing ordered and unordered maps and sets.
One of the extensions allows to extract a node from the container by passing either
<tt>key_type&amp;</tt> or <tt>const_iterator</tt> to the <tt>extract()</tt> member function:
</p>
<blockquote><pre>
node_type extract(const key_type&amp; x);
node_type extract(const_iterator position);
</pre></blockquote>
<p>
Providing these two <tt>extract</tt> overloads causes the same problem as for <tt>erase</tt>.
Consider the following example:
</p>
<blockquote><pre>
#include &lt;map&gt;
#include &lt;string&gt;

struct Key
{
  template &lt;typename T&gt;
  Key(const T&amp;) {}
};

bool operator&lt;(const Key&amp;, const Key&amp;) { return false; }

int main()
{
  using map_type = std::map&lt;Key, std::string&gt;;

  map_type m({ {Key(1), "a"}, {Key(2), "b"} });
  map_type::iterator it = m.begin();
  auto nh = m.extract(it);
}
</pre></blockquote>
<p>
In this case, call to <tt>extract()</tt> is ambiguous, because the overloads which accept
<tt>const_iterator</tt> and <tt>key_type</tt> are equally good matches for the argument
<tt>it</tt>.
<p/>
Consequently, this issue can be resolved in the same way as for <tt>std::map::erase</tt>
by adding an overload for <tt>extract</tt> which accepts <tt>iterator</tt> as an argument.
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 3 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>.</p>

<ol>
<li><p>Modify  [tab:container.assoc.req], Table 69 &mdash;
"Associative container requirements", as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 69 &mdash; Associative container requirements (in addition to container)
 [tab:container.assoc.req]</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.extract(q)</tt>
</td>
<td>
<tt>node_type</tt>
</td>
<td>
<i>Effects:</i> Removes the element<br/>
pointed to by <tt>q</tt>.<br/>
<i>Returns:</i> A <tt>node_type</tt> owning<br/>
that element.
</td>
<td>
amortized constant
</td>
</tr>

<tr>
<td>
<ins><tt>a.extract(r)</tt></ins>
</td>
<td>
<ins><tt>node_type</tt></ins>
</td>
<td>
<ins><i>Effects:</i> Removes the element<br/>
pointed to by <tt>r</tt>.<br/>
<i>Returns:</i> A <tt>node_type</tt> owning<br/>
that element.</ins>
</td>
<td>
<ins>amortized constant</ins>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify  [tab:container.assoc.req], Table 70 &mdash;
"Unordered associative container requirements", as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 70 &mdash; Unordered associative container requirements (in addition to container)
 [tab:container.hash.req]</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note pre-&#47;post-condition</th>
<th>Complexity</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.extract(q)</tt>
</td>
<td>
<tt>node_type</tt>
</td>
<td>
<i>Effects:</i> Removes the element<br/>
pointed to by <tt>q</tt>.<br/>
<i>Returns:</i> A <tt>node_type</tt> owning<br/>
that element.
</td>
<td>
Average case
<tt>&#x1d4aa;(1)</tt>, worst case
<tt>&#x1d4aa;(a.size())</tt>.
</td>
</tr>

<tr>
<td>
<ins><tt>a.extract(r)</tt></ins>
</td>
<td>
<ins><tt>node_type</tt></ins>
</td>
<td>
<ins><i>Effects:</i> Removes the element<br/>
pointed to by <tt>r</tt>.<br/>
<i>Returns:</i> A <tt>node_type</tt> owning<br/>
that element.</ins>
</td>
<td>
<ins>Average case
<tt>&#x1d4aa;(1)</tt>, worst case
<tt>&#x1d4aa;(a.size())</tt>.</ins>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify 22.4.4.1 <a href="https://timsong-cpp.github.io/cppwp/map.overview">[map.overview]</a>, class template <tt>map</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.4.5.1 <a href="https://timsong-cpp.github.io/cppwp/multimap.overview">[multimap.overview]</a>, class template <tt>multimap</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.4.6.1 <a href="https://timsong-cpp.github.io/cppwp/set.overview">[set.overview]</a>, class template <tt>set</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.4.7.1 <a href="https://timsong-cpp.github.io/cppwp/multiset.overview">[multiset.overview]</a>, class template <tt>multiset</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/unord.map.overview">[unord.map.overview]</a>, class template <tt>unordered_map</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.5.5.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multimap.overview">[unord.multimap.overview]</a>, class template <tt>unordered_multimap</tt>
synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/unord.set.overview">[unord.set.overview]</a>, class template <tt>unordered_set</tt>
synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.5.7.1 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset.overview">[unord.multiset.overview]</a>, class template <tt>unordered_multiset</tt>
synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<ins>node_type extract(iterator position);</ins>
node_type extract(const_iterator position);
node_type extract(const key_type&amp; x);
[&hellip;]
</pre>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3228" href="3228">3228.</a> Surprising <tt>variant</tt> construction</h3>
<p><b>Section:</b> 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2019-06-25 <b>Last modified:</b> 2019-11-04 18:05:33 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#variant.ctor">active issues</a> in [variant.ctor].</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.ctor">issues</a> in [variant.ctor].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
User mcencora on reddit today posted this example:
</p>
<blockquote><pre>
#include &lt;variant&gt;

struct ConvertibleToBool
{
  constexpr operator bool() const { return true; }
};

static_assert(std::holds_alternative&lt;bool&gt;(std::variant&lt;int, bool&gt;(ConvertibleToBool{})));
</pre></blockquote>
<p>
Before <a href="http://wg21.link/p0608">P0608</a>, the <tt>variant</tt> holds <tt>bool</tt>. After P0608,
the <tt>variant</tt> holds <tt>int</tt> so the static assertion fires.
<p/>
I don't know what the right answer is between (a) ill-formed (b) hold <tt>bool</tt> and (c)
hold <tt>int</tt> is, but I think (a) and (b) are better options than (c).
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 2 after discussion on the reflector.</p>
<p><i>[This is US212; status set to "LEWG" for guidance on desired behavior.]</i></p>




<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3229" href="3229">3229.</a> &sect;[res.on.exception.handling]#3 cannot apply to types with implicitly declared destructors</h3>
<p><b>Section:</b> 16.5.5.13 <a href="https://timsong-cpp.github.io/cppwp/res.on.exception.handling">[res.on.exception.handling]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Nevin Liber <b>Opened:</b> 2019-06-28 <b>Last modified:</b> 2019-08-23 18:06:54 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#res.on.exception.handling">issues</a> in [res.on.exception.handling].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
16.5.5.13 <a href="https://timsong-cpp.github.io/cppwp/res.on.exception.handling">[res.on.exception.handling]</a>#3 says:
</p>
<blockquote><p>
Destructor operations defined in the C++ standard library shall not throw exceptions.
Every destructor in the C++ standard library shall behave as if it had a non-throwing
exception specification.
</p></blockquote>
<p>
However, types like <tt>pair</tt> and <tt>array</tt> have implicitly declared destructors,
where 14.5 <a href="https://timsong-cpp.github.io/cppwp/except.spec">[except.spec]</a>#8 applies:
</p>
<blockquote><p>
The exception specification for an implicitly-declared destructor, or a destructor without
a <i>noexcept</i>-specifier, is potentially-throwing if and only if any of the destructors
for any of its potentially constructed subobjects is potentially-throwing or the destructor
is virtual and the destructor of any virtual base class is potentially throwing.
</p></blockquote>
<p>
We can relax 16.5.5.13 <a href="https://timsong-cpp.github.io/cppwp/res.on.exception.handling">[res.on.exception.handling]</a> to only cover explicitly declared
destructors because if they hold a user type where the destructor throws then we get UB
from 16.5.4.8 <a href="https://timsong-cpp.github.io/cppwp/res.on.functions">[res.on.functions]</a>#2:
</p>
<blockquote><p>
In particular, the effects are undefined in the following cases: [&hellip;]
</p>
<ol style="list-style-type:none">
<li><p>[&hellip;]</p></li>
<li><p>(2.4) &mdash; if any replacement function or handler function or destructor operation
exits via an exception, unless specifically allowed in the applicable
<i>Required behavior:</i> paragraph.</p></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
<p>
and the referred to UB happens before [res.on.exception.handling] could apply.
</p>

<p><i>[2019-07 Issue Prioritization]</i></p>

<p>Priority to 3 after discussion on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>.</p>

<ol>
<li><p>Modify 16.5.5.13 <a href="https://timsong-cpp.github.io/cppwp/res.on.exception.handling">[res.on.exception.handling]</a> as indicated:</p>

<blockquote><p>
-3- Destructor operations defined in the C++ standard library shall not throw exceptions.
Every <ins>explicitly declared</ins> destructor in the C++ standard library shall behave
as if it had a non-throwing exception specification.
</p></blockquote>
</li>
</ol>




<hr>
<h3><a name="3233" href="3233">3233.</a> Broken requirements for <tt>shared_ptr</tt> converting constructors</h3>
<p><b>Section:</b> 20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-07-10 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#util.smartptr.shared.const">active issues</a> in [util.smartptr.shared.const].</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared.const">issues</a> in [util.smartptr.shared.const].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Issue <a href="2875">2875</a> added 20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a> paragraph 13:
<blockquote>
<i>Remarks</i>: When <tt>T</tt> is an array type, this constructor shall not participate in overload
resolution unless <tt>is_move_constructible_v&lt;D&gt;</tt> is <tt>true</tt>, the expression
<tt>d(p)</tt> is well-formed, and either <tt>T</tt> is <tt>U[N]</tt> and <tt>Y(*)[N]</tt> is
convertible to <tt>T*</tt>, or <tt>T</tt> is <tt>U[]</tt> and <tt>Y(*)[]</tt> is convertible to
<tt>T*</tt>. When <tt>T</tt> is not an array type, this constructor shall not participate in
overload resolution unless <tt>is_move_constructible_v&lt;D&gt;</tt> is <tt>true</tt>, the
expression <tt>d(p)</tt> is well-formed, and <tt>Y*</tt> is convertible to <tt>T*</tt>.
</blockquote>
which pertains to the four constructor overloads:
<blockquote><pre>
template&lt;class Y, class D&gt; shared_ptr(Y* p, D d);
template&lt;class Y, class D, class A&gt; shared_ptr(Y* p, D d, A a);
template&lt;class D&gt; shared_ptr(nullptr_t p, D d);
template&lt;class D, class A&gt; shared_ptr(nullptr_t p, D d, A a);
</pre></blockquote>
which is fine (ignoring for now that two occurrences of "this constructor" should read "these
constructors") for the two overloads with a template parameter <tt>Y</tt>, but not so much for the
two with no such template parameter.
</p>
<p>
MSVC ignores the constraints on <tt>Y</tt> for the overloads with no such template parameter,
whereas libstdc++ and libc++ seem to ignore <em>all</em> of the constraints for those overloads (See
<a href="https://gcc.godbolt.org/z/ECdop6">Compiler Explorer</a>). We should fix the broken wording,
ideally by requiring the MSVC interpretation - the <tt>nullptr_t</tt> constructors participate in
overload resolution only when <tt>is_movable_v&lt;D&gt;</tt> is <tt>true</tt> and <tt>d(p)</tt> is
well-formed - so concepts and traits that check constructibility are correct.
</p>

<p><i>[2019-11-17 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after six positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a> as indicated:</p>

<blockquote>
<blockquote><pre>
template&lt;class Y, class D&gt; shared_ptr(Y* p, D d);
template&lt;class Y, class D, class A&gt; shared_ptr(Y* p, D d, A a);
template&lt;class D&gt; shared_ptr(nullptr_t p, D d);
template&lt;class D, class A&gt; shared_ptr(nullptr_t p, D d, A a);
</pre></blockquote>
<p>
<ins>-?- <i>Constraints:</i> <tt>is_move_constructible_v&lt;D&gt;</tt> is <tt>true</tt>, and
<tt>d(p)</tt> is a well-formed expression. For the first two overloads:</ins>
</p>
<ul>
  <li><p><ins>
    If <tt>T</tt> is an array type, then either <tt>T</tt> is <tt>U[N]</tt> and <tt>Y(*)[N]</tt> is
    convertible to <tt>T*</tt>, or <tt>T</tt> is <tt>U[]</tt> and <tt>Y(*)[]</tt> is convertible to
    <tt>T*</tt>.
  </ins></p></li>
  <li><p><ins>
    If <tt>T</tt> is not an array type, then <tt>Y*</tt> is convertible to <tt>T*</tt>.
  </ins></p></li>
</ul>
<p>
-9- <i><del>Requires</del><ins>Expects</ins>:</i> Construction of <tt>d</tt> and a deleter of type [&hellip;]
</p>
<p>[&hellip;]</p>
<p>
<del>-13- <i>Remarks:</i> When <tt>T</tt> is an array type, this constructor shall not participate
in overload resolution unless <tt>is_move_constructible_v&lt;D&gt;</tt> is <tt>true</tt>, the
expression <tt>d(p)</tt> is well-formed, and either <tt>T</tt> is <tt>U[N]</tt> and <tt>Y(*)[N]</tt>
is convertible to <tt>T*</tt>, or <tt>T</tt> is <tt>U[]</tt> and <tt>Y(*)[]</tt> is convertible to
<tt>T*</tt>. When <tt>T</tt> is not an array type, this constructor shall not participate in
overload resolution unless <tt>is_move_constructible_v&lt;D&gt;</tt> is <tt>true</tt>, the
expression <tt>d(p)</tt> is well-formed, and <tt>Y*</tt> is convertible to <tt>T*</tt>.</del>
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3234" href="3234">3234.</a> Sufficient Additional Special Math Overloads</h3>
<p><b>Section:</b> 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-07-11 <b>Last modified:</b> 2019-07-28 15:43:50 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#cmath.syn">active issues</a> in [cmath.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#cmath.syn">issues</a> in [cmath.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The "sufficient additional overloads" wording in 26.8.1 <a href="https://timsong-cpp.github.io/cppwp/cmath.syn">[cmath.syn]</a> paragraph 2 does not 
apply to the special math functions, since they are not "overloaded functions". The lack of 
"sufficient additional overloads" doesn't agree with <a href="https://wg21.link/n3060">N3060</a> (the 
final draft of ISO/IEC 29124 which standardized the mathematical special functions) [sf.cmath] 
paragraphs 3 and 4:
</p>
<blockquote>
<p>
-3- Each of the functions specified above that has one or more <tt>double</tt> parameters (the 
<tt>double</tt> version) shall have two additional overloads:
</p>
<ol><li><p>
a version with each <tt>double</tt> parameter replaced with a <tt>float</tt> parameter (the 
<tt>float</tt> version), and
</p></li><li><p>
a version with each <tt>double</tt> parameter replaced with a <tt>long double</tt> parameter (the 
<tt>long double</tt> version).
</p></li>
</ol>
<p>
The return type of each such <tt>float</tt> version shall be <tt>float</tt>, and the return type of 
each such <tt>long double</tt> version shall be <tt>long double</tt>.
<p/>
-4- Moreover, each <tt>double</tt> version shall have sufficient additional overloads to determine 
which of the above three versions to actually call, by the following ordered set of rules:
</p>
<ol>
<li><p>
First, if any argument corresponding to a <tt>double</tt> parameter in the <tt>double</tt> version 
has type <tt>long double</tt>, the <tt>long double</tt> version is called.
</p></li><li><p>
Otherwise, if any argument corresponding to a <tt>double</tt> parameter in the <tt>double</tt> 
version has type <tt>double</tt> or has an integer type, the <tt>double</tt> version is called. 
</p></li><li><p>
Otherwise, the <tt>float</tt> version is called.
</p></li>
</ol>
</blockquote>
<p>
<a href="https://wg21.link/p0226r1">P226R1 "Mathematical Special Functions for C++17"</a> notably 
states: "At the level of and following [c.math], create a new subclause with heading and initial 
content the same as IS 29124:2010's clause [sf.cmath], 'Additions to header <tt>&lt;cmath&gt;</tt>,' 
renumbering as appropriate to the new context." which suggests the change between 29124 and C++17
was an oversight and not intentional.
<p/>
Notably there is implementation divergence: MSVC implements precisely the wording in C++17, whereas 
libstdc++ provides additional overloads as specified in 29124, so they disagree 
<a href="https://godbolt.org/z/C6_NB2">e.g. on whether <tt>std::sph_neumann({}, {})</tt> is 
well-formed</a>.
</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3236" href="3236">3236.</a> Random access iterator requirements lack limiting relational operators domain to comparing 
those from the same range</h3>
<p><b>Section:</b> 23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Ready</a>
 <b>Submitter:</b> Peter Sommerlad <b>Opened:</b> 2019-07-15 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#random.access.iterators">issues</a> in [random.access.iterators].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Ready">Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
For forward iterators we have very clear wording regarding the restricted domain of <tt>operator==</tt>
in 23.3.5.4 <a href="https://timsong-cpp.github.io/cppwp/forward.iterators">[forward.iterators]</a> p2:
</p>
<blockquote><p>
The domain of <tt>==</tt> for forward iterators is that of iterators over the same underlying sequence. 
However, value-initialized iterators may be compared and shall compare equal to other value-initialized 
iterators of the same type. [<i>Note:</i> Value-initialized iterators behave as if they refer past the 
end of the same empty sequence. &mdash; <i>end note</i>]
</p></blockquote>
<p>
But for the relational operators of random access iterators specified in 
23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a>, Table  [tab:randomaccessiterator],
no such domain constraints are clearly defined, except that we can infer that they are
similarly constrained as the difference of the compared iterators by means of the
operational semantics of <tt>operator&lt;</tt>.
</p>

<p><i>[2019-07-29; Casey comments and provides wording]</i></p>

<p>
Change the "Operational Semantics" column of the "<tt>a &lt; b</tt>" row of [tab:randomaccessiterator] to 
"<ins><i>Effects:</i> Equivalent to: <tt>return</tt></ins> <tt>b - a &gt; 0</tt><ins>;</ins>
<p/>
It then follows that <tt>a &lt; b</tt> is required to be well-defined over the domain for which 
<tt>b - a</tt> is required to be well-defined, which is the set of pairs <tt>(x, y)</tt> such that 
there exists a value <tt>n</tt> of type difference_type such that <tt>x + n == b</tt>.
</p>

<p><i>[2020-02-13, Prague]</i></p>

<p>
P3, but some hesitation to make it Immediate, therefore moving to Ready.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 87: <i>Cpp17RandomAccessIterator</i> requirements (in addition to 
<i>Cpp17BidirectionalIterator</i>) [tab:randomaccessiterator]</caption>
<tr align="center">
<th>Expression</th>
<th>Return type</th>
<th>Operational semantics</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
</tr> 

<tr>
<td colspan="4" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>a &lt; b</tt>
</td>
<td>
contextually convertible to <tt>bool</tt>
</td>
<td>
<ins><i>Effects:</i> Equivalent to: <tt>return</tt></ins> <tt>b - a &gt; 0<ins>;</ins></tt>
</td>
<td>
<tt>&lt;</tt> is a total ordering relation
</td>
</tr>

</table>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3237" href="3237">3237.</a> LWG 3038 and 3190 have inconsistent PRs</h3>
<p><b>Section:</b> 20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-07-18 <b>Last modified:</b> 2020-02-14 06:55:06 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#mem.poly.allocator.mem">active issues</a> in [mem.poly.allocator.mem].</p>
<p><b>View all other</b> <a href="lwg-index.html#mem.poly.allocator.mem">issues</a> in [mem.poly.allocator.mem].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Both LWG <a href="3038">3038</a> and LWG <a href="3190">3190</a> deal with how to respond to requests to allocate 
"<tt>n * sizeof(T)</tt>" bytes of memory when <tt>n * sizeof(T)</tt> is not sufficient storage for 
<tt>n</tt> objects of type <tt>T</tt>, i.e., when <tt>n &gt; SIZE_MAX / sizeof(T)</tt>. LWG 
<a href="3038">3038</a> changed <tt>polymorphic_allocator::allocate</tt> to throw <tt>length_error</tt> upon 
detecting this condition, whereas LWG <a href="3190">3190</a> changed <tt>allocator::allocate</tt> to 
throw <tt>bad_array_new_length</tt>. It's peculiar that two standard library components which allocate 
memory both detect this condition but handle it by throwing different exception types; for consistency, 
the two should be harmonized.
<p/>
Reflector discussion of 3190 seemed to achieve consensus that <tt>bad_array_new_length</tt> was 
the better option. Unlike <tt>length_error</tt>, <tt>bad_array_new_length</tt> derives from 
<tt>bad_alloc</tt> so we can make this change without altering the invariant that allocation functions 
either succeed or throw an exception derived from <tt>bad_alloc</tt>.
<p/>
Further, <a href="http://wg21.link/p0339r6">P0339R6</a> "<tt>polymorphic_allocator&lt;&gt;</tt> as a 
vocabulary type" recently added the function template "<tt>template&lt;class T&gt; T* 
allocate_object(size_t n = 1);</tt>" to <tt>std::pmr::polymorphic_allocator</tt>, which is another 
instance of the "allocate memory for <tt>n</tt> objects of type <tt>T</tt>" pattern. 
20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a> paragraph 8.1 specifies that <tt>allocate_object</tt> throws 
<tt>length_error</tt> when <tt>SIZE_MAX / sizeof(T) &lt; n</tt>, presumably for consistency with <tt>std::pmr::polymorphic_allocator::allocate</tt> specified in paragraph 1. <tt>allocate_object</tt>'s 
behavior should be consistent with <tt>allocator::allocate</tt> and 
<tt>polymorphic_allocator::allocate</tt> so we have a single means of communicating "request for 
allocation of unrepresentable size" errors in the Standard Library.
</p>

<p><i>[2020-02 Moved to Immediate on Thursday afternoon in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>.</p>

<ol>
<li><p>Modify 20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a> as indicated:</p>

<blockquote>
<pre>
[[nodiscard]] Tp* allocate(size_t n);
</pre><blockquote>
<p>
-1- <i>Effects:</i> If <tt>SIZE_MAX / sizeof(Tp) &lt; n</tt>, throws 
<tt><del>length_error</del><ins>bad_array_new_length</ins></tt>. 
Otherwise equivalent to:
</p>
<blockquote><pre>
return static_cast&lt;Tp*&gt;(memory_rsrc-&gt;allocate(n * sizeof(Tp), alignof(Tp)));
</pre>
</blockquote>
</blockquote>
[&hellip;]
<pre>
template&lt;class T&gt;
  T* allocate_object(size_t n = 1);
</pre><blockquote>
<p>
-8- <i>Effects:</i> Allocates memory suitable for holding an array of <tt>n</tt> objects of type 
<tt>T</tt>, as follows:
</p>
<ol style="list-style-type: none">
<li><p>(8.1) &mdash; if <tt>SIZE_MAX / sizeof(T) &lt; n</tt>, throws 
<tt><del>length_error</del><ins>bad_array_new_length</ins></tt>,</p></li>
<li><p>(8.2) &mdash; otherwise equivalent to:</p>
<blockquote><pre>
return static_cast&lt;T*&gt;(allocate_bytes(n*sizeof(T), alignof(T)));
</pre></blockquote>
</li>
</ol>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3238" href="3238">3238.</a> Insufficiently-defined behavior of <tt>std::function</tt> deduction guides</h3>
<p><b>Section:</b> 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Louis Dionne <b>Opened:</b> 2019-07-17 <b>Last modified:</b> 2020-02-14 08:07:47 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#func.wrap.func.con">active issues</a> in [func.wrap.func.con].</p>
<p><b>View all other</b> <a href="lwg-index.html#func.wrap.func.con">issues</a> in [func.wrap.func.con].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The following code is currently undefined behavior:
</p>
<blockquote><pre>
#include &lt;functional&gt;

struct R { };
struct f0 { R operator()() &amp;&amp; { return {}; } };

int main() { std::function f = f0{}; }
</pre></blockquote>
<p>
The reason is that 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a>/12 says:
</p>
<blockquote><p>
This deduction guide participates in overload resolution only if <tt>&amp;F::operator()</tt> is well-formed 
when treated as an unevaluated operand. In that case, if <tt>decltype(&amp;F::operator())</tt> is of the 
form <tt>R(G::*)(A...) <i>cv</i> &amp;<sub><i>opt</i></sub> noexcept<sub><i>opt</i></sub></tt> for a 
class type <tt>G</tt>, then the deduced type is <tt>function&lt;R(A...)&gt;</tt>.
</p></blockquote>
<p>
However, it does not define the behavior when <tt>&amp;F::operator()</tt> is well-formed but <em>not</em> 
of the required form (in the above example it's of the form <tt>R(G::*)(A...) &amp;&amp;</tt>, which is 
rvalue-reference qualified instead of optionally-lvalue-reference qualified). libc++'s implementation 
of the deduction guide SFINAE's out when either <tt>&amp;F::operator()</tt> is not well-formed, or it 
is not of the required form. It seems like mandating that behavior in the Standard is the way to go.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>.</p>

<ol>
<li><p>Modify 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class F&gt; function(F) -&gt; function&lt;<i>see below</i>&gt;;
</pre><blockquote>
<p>
-12- <i>Remarks:</i> This deduction guide participates in overload resolution only if 
<tt>&amp;F::operator()</tt> is well-formed when treated as an unevaluated operand<ins>, and its type is 
of the form <tt>R(G::*)(A...) <i>cv</i> &amp;<sub><i>opt</i></sub> noexcept<sub><i>opt</i></sub></tt> 
for a class type <tt>G</tt> and a sequence of types <tt>A...</tt></ins>. 
In that case, <del>if <tt>decltype(&amp;F::operator())</tt> is of the form <tt>R(G::*)(A...) <i>cv</i> 
&amp;<sub><i>opt</i></sub> noexcept<sub><i>opt</i></sub></tt> for a class type <tt>G</tt>, 
then</del> the deduced type is <tt>function&lt;R(A...)&gt;</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13; Prague]</i></p>

<p>
LWG improves wording matching Marshall's Mandating paper.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.14.16.2.1 <a href="https://timsong-cpp.github.io/cppwp/func.wrap.func.con">[func.wrap.func.con]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class F&gt; function(F) -&gt; function&lt;<i>see below</i>&gt;;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> <tt>&amp;F::operator()</tt> is well-formed when treated as an unevaluated operand 
and <tt>decltype(&amp;F::operator())</tt> is of the form <tt>R(G::*)(A...) <i>cv</i> &amp;<sub><i>opt</i></sub> 
noexcept<sub><i>opt</i></sub></tt> for a class type <tt>G</tt>.</ins>
<p/>
-12- <i>Remarks:</i> <del>This deduction guide participates in overload resolution only if 
<tt>&amp;F::operator()</tt> is well-formed when treated as an unevaluated operand. 
In that case, if <tt>decltype(&amp;F::operator())</tt> is of the form <tt>R(G::*)(A...) <i>cv</i> 
&amp;<sub><i>opt</i></sub> noexcept<sub><i>opt</i></sub></tt> for a class type <tt>G</tt>, 
then t</del><ins>T</ins>he deduced type is <tt>function&lt;R(A...)&gt;</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3240" href="3240">3240.</a> Headers declare more than entities</h3>
<p><b>Section:</b> 16.5.2.2 <a href="https://timsong-cpp.github.io/cppwp/using.headers">[using.headers]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Alisdair Meredith <b>Opened:</b> 2019-07-24 <b>Last modified:</b> 2019-07-30 16:57:54 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#using.headers">issues</a> in [using.headers].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Quoting 16.5.2.2 <a href="https://timsong-cpp.github.io/cppwp/using.headers">[using.headers]</a> p3:
</p>
<blockquote><p>
"[&hellip;] and shall include the header lexically before the first reference in that translation
 unit to any of the entities declared in that header."
</p></blockquote>
<p>
This suggests we may be able to use macros and typedefs (like <tt>size_t</tt>) declared in 
standard headers without the corresponding <tt>#include</tt>. Clearly that is not the intended 
behavior!
<p/>
I thought about replacing 'entity' with 'name', but the same name may occur with
different contexts throughout the standard library. I thought about "contents of that
header", but run afoul of the same function overloads (<tt>std::begin</tt> etc.) being declared
in multiple headers.
<p/>
It may be simpler to turn this sentence around, along the lines of:
</p>
<blockquote><p>
"No part of the standard library shall be used in a translation unit prior to a including
or importing a header that provides that feature."
</p></blockquote>
<p>
Even here, 'used' may be a problematic term of art. Perhaps "named"?
</p>

<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3242" href="3242">3242.</a> <tt>std::format</tt>: missing rules for <tt>arg-id</tt> in <tt>width</tt> and <tt>precision</tt></h3>
<p><b>Section:</b> 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-07-31 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.string.std">active issues</a> in [format.string.std].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.string.std">issues</a> in [format.string.std].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
According to 20.20.2 <a href="https://timsong-cpp.github.io/cppwp/format.string">[format.string]</a> we have:
</p>
<blockquote><p>
If the numeric <tt>arg-id</tt>s in a format string are <tt>0, 1, 2, ...</tt> in sequence, they can all be 
omitted (not just some) and the numbers <tt>0, 1, 2, ...</tt> will be automatically used in that order. 
A format string does not contain a mixture of automatic and manual indexing.
</p></blockquote>
<p>
&hellip; but what does that mean in the presence of <tt>arg-id</tt> in <tt>width</tt> and <tt>precision</tt>? 
Can one replace
</p>
<blockquote><pre>
"{0:{1}} {2}"
</pre></blockquote>
<p>
with
</p>
<blockquote><pre>
"{:{}} {}"
</pre></blockquote>
<p>
? The grammar says the answer is no, because the <tt>arg-id</tt> in <tt>width</tt> is not optional, but 
the normative wording says the answer is yes.
<p/>
<b>Victor Zverovich:</b>
<p/>
That's a bug in the grammar. The <tt>arg-id</tt> should be optional in <tt>width</tt> and <tt>precision</tt>:
</p>
<blockquote>
<pre>
width     ::= nonzero-digit [integer] | '{' [arg-id] '}'
precision ::= integer | '{' [arg-id] '}'
</pre>
</blockquote>

<p><i>[2020-02 Status to Immediate on Thursday morning in Prague.]</i></p>




<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify the <tt><i>width</i></tt> and <tt><i>precision</i></tt> grammar in the syntax 
of format specifications of 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
[&hellip;]
<i>width:</i>
         <i>positive-integer</i>
         { <i>arg-id<ins><sub>opt</sub></ins></i> }
<i>precision:</i>
         . <i>nonnegative-integer</i>  
         . { <i>arg-id<ins><sub>opt</sub></ins></i> }   
[&hellip;]         
</pre>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<p>
-6- The <i>#</i> option causes [&hellip;]
<p/>
<ins>-?- If <tt>{ <i>arg-id<sub>opt</sub></i> }</tt> is used in a <i>width</i> or <i>precision</i>, 
the value of the corresponding formatting argument is used in its place. If the corresponding 
formatting argument is not of integral type, or its value is negative for <i>precision</i> or 
non-positive for <i>width</i>, an exception of type <tt>format_error</tt> is thrown.</ins>
<p/>
-7- The <i>positive-integer</i> in <i>width</i> is a decimal integer defining the minimum field width. 
If <i>width</i> is not specified, there is no minimum field width, and the field width is determined 
based on the content of the field.
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3243" href="3243">3243.</a> <tt>std::format</tt> and negative zeroes</h3>
<p><b>Section:</b> 20.20.2 <a href="https://timsong-cpp.github.io/cppwp/format.string">[format.string]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-07-31 <b>Last modified:</b> 2020-02-13 19:29:26 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.string">active issues</a> in [format.string].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.string">issues</a> in [format.string].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
What are these:
</p>
<blockquote><pre>
std::format("{}", -0.0);
std::format("{:+}", -0.0);
std::format("{:-}", -0.0);
std::format("{: }", -0.0);
</pre></blockquote>
<p>
with
</p>
<blockquote><pre>
"{:{}} {}"
</pre></blockquote>
<p>
A negative zero is not a negative number, so I <em>think</em> the answer for an implementation that supports 
signed zeroes is <tt>"0"</tt>, <tt>"-0"</tt>, <tt>"0"</tt>, <tt>" 0"</tt>. Is that the intent? (Note 
that this doesn't satisfy <tt>to_chars</tt>' round-trip guarantee.)
<p/>
Or should the behavior actually be that <tt>"+"</tt> means "insert a leading <tt>+</tt> if <tt>to_chars</tt>' 
output does not start with <tt>-"</tt> and <tt>" "</tt> actually means "insert a leading space if 
<tt>to_chars</tt>' output does not start with <tt>-"</tt> (that is, the same as <tt>"%+f"</tt> and <tt>"% f"</tt>) 
&mdash; so that the result of all four calls is <tt>"-0"</tt>?
<p/>
<b>Victor Zverovich:</b>
<p/>
The latter. <tt>std::format</tt> is specified in terms of <tt>to_chars</tt> and the intent is to have similar 
round trip guarantee here, so the result should be <tt>"-0"</tt>, <tt>"-0"</tt>, <tt>"-0"</tt>, <tt>"-0"</tt>. 
This has also been extensively discussed in LEWG and the outcome of that discussion was to print <tt>'-'</tt> 
for negative zeros.
<p/>
So I think it should be clarified that <tt>'-'</tt> and space apply to negative numbers and negative zero.
</p>

<p><i>[2019-08-17 Priority set to 2 based on reflector discussion]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify the <i>sign</i> options Table [tab:format.sign] in 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 59: Meaning of <i>sign</i> options [tab:format.sign]</caption>
<tr align="center">
<th>Option</th>
<th>Meaning</th>
</tr> 

<tr>
<td>
<tt>'+'</tt>
</td>
<td>
Indicates that a sign should be used for both non-negative and negative numbers.
</td>
</tr>

<tr>
<td>
<tt>'-'</tt>
</td>
<td>
Indicates that a sign should be used only for negative numbers <ins>and negative zero</ins> 
(this is the default behavior).
</td>
</tr>

<tr>
<td>
space
</td>
<td>
Indicates that a leading space should be used for non-negative numbers <ins>other than negative 
zero</ins>, and a minus sign for negative numbers <ins>and negative zero</ins>.
</td>
</tr>

</table>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Rebased and some wording finetuning by LWG.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify the <i>sign</i> options Table [tab:format.sign] in 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 58: Meaning of <i>sign</i> options [tab:format.sign]</caption>
<tr align="center">
<th>Option</th>
<th>Meaning</th>
</tr> 

<tr>
<td>
<tt>'+'</tt>
</td>
<td>
Indicates that a sign should be used for both non-negative and negative numbers.
</td>
</tr>

<tr>
<td>
<tt>'-'</tt>
</td>
<td>
Indicates that a sign should be used <del>only</del> for negative numbers <ins>and negative zero only</ins> 
(this is the default behavior).
</td>
</tr>

<tr>
<td>
space
</td>
<td>
Indicates that a leading space should be used for non-negative numbers <ins>other than negative 
zero</ins>, and a minus sign for negative numbers <ins>and negative zero</ins>.
</td>
</tr>

</table>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3247" href="3247">3247.</a> <tt>ranges::iter_move</tt> should perform ADL-only lookup of <tt>iter_move</tt></h3>
<p><b>Section:</b> 23.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.move">[iterator.cust.move]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-07-29 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.cust.move">active issues</a> in [iterator.cust.move].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.cust.move">issues</a> in [iterator.cust.move].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The specification of the <tt>ranges::iter_move</tt> customization point in [iterator.cust.move] 
doesn't include a deleted poison pill overload. There is no <tt>std::iter_move</tt> to avoid, 
so such a poison pill is not needed. This is fine, except that it suggests that unqualified 
lookup for <tt>iter_move</tt> in the <tt>iter_move(E)</tt> expression in paragraph 1.1 should 
find declarations of iter_move in the global namespace via normal unqualified lookup, when the 
design intent is that only ADL be used to find overloads of <tt>iter_move</tt>.
<p/>
Absent a more idiomatic wording to specify an ADL-only lookup, we can correct the problem by 
specifying the lookup in paragraph 1.1 is performed in a context that includes the declaration 
"<tt>void iter_move();</tt>" which has the desired effect.
</p>

<p><i>[2020-02 Status to Immediate on Thursday morning in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4820">N4820</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting Note:</i> There's a drive-by fix here to change "valid" &mdash; which suggests runtime behavior 
which cannot be validated at compile time &mdash; to "well-formed".]
</p>
</blockquote>

<ol>
<li><p>Modify 23.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.move">[iterator.cust.move]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>ranges::iter_move</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). The expression <tt>ranges::iter_move(E)</tt> for 
some subexpression <tt>E</tt> is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>iter_move(E)</tt>, if that expression is <del>valid</del><ins>well-formed 
when treated as an unevaluated operand</ins>, with overload resolution 
performed in a context that does not include a declaration of <tt>ranges::iter_move</tt><del>.</del> 
<ins>but does include the declaration:</ins></p>
<pre>
   <ins>void iter_move();</ins>
</pre></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3248" href="3248">3248.</a> <tt>std::format</tt> <tt>#b</tt>, <tt>#B</tt>, <tt>#o</tt>, <tt>#x</tt>, and <tt>#X</tt> 
presentation types misformat negative numbers</h3>
<p><b>Section:</b> 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-08-01 <b>Last modified:</b> 2020-02-13 19:42:16 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.string.std">active issues</a> in [format.string.std].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.string.std">issues</a> in [format.string.std].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
According to both the specification for <tt>'#'</tt> and the presentation types <tt>b</tt>, <tt>B</tt>, 
<tt>o</tt>, <tt>x</tt>, and <tt>X</tt> (which redundantly duplicate the rule for the relevant prefixes), 
the string <tt>0b</tt>, <tt>0B</tt>, <tt>0</tt>, <tt>0x</tt>, or <tt>0X</tt> is prefixed to the result 
of <tt>to_chars</tt>. That means:
</p>
<blockquote><pre>
std::format("{0:#b} {0:#B} {0:#o} {0:#x} {0:#X}", -1)
</pre></blockquote>
<p>
produces
</p>
<blockquote><pre>
"0b-1 0B-1 0-1 0x-1 0X-1"
</pre></blockquote>
<p>
I assume that's a bug?
<p/>
(Additionally, if the <tt>+</tt> specifier is used, there appears to be no specification of where 
the sign is inserted into the output.)
<p/>
<b>Victor Zverovich:</b>
<p/>
Yes. I suggest replacing
</p>
<blockquote><p>
adds the respective prefix <tt>"0b"</tt> (<tt>"0B"</tt>), <tt>"0"</tt>, or <tt>"0x"</tt> (<tt>"0X"</tt>) 
to the output value
</p></blockquote>
<p>
with something like 
</p>
<blockquote><p>
inserts the respective prefix <tt>"0b"</tt> (<tt>"0B"</tt>), <tt>"0"</tt>, or <tt>"0x"</tt> (<tt>"0X"</tt>) 
to the output value after the sign, if any,
</p></blockquote>
<p>
I think the duplicate wording in the presentation types <tt>b</tt>, <tt>B</tt>, <tt>o</tt>, <tt>x</tt>, and 
<tt>X</tt> can be dropped.
<p/>
Regarding the <tt>+</tt> specifier problem: How about adding
</p>
<blockquote><p>
The sign is inserted before the output of <tt>to_chars</tt>.
</p></blockquote>
<p>
?
</p>

<p><i>[2019-08-21 Priority set to 2 based on reflector discussion]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify the <i>sign</i> options Table [tab:format.sign] in 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 59: Meaning of <i>sign</i> options [tab:format.sign]</caption>
<tr align="center">
<th>Option</th>
<th>Meaning</th>
</tr> 

<tr>
<td>
<tt>'+'</tt>
</td>
<td>
Indicates that a sign should be used for both non-negative and negative numbers. <ins>The sign is 
inserted before the output of <tt>to_chars</tt>.</ins>
</td>
</tr>

<tr>
<td>
<tt>'-'</tt>
</td>
<td>
Indicates that a sign should be used only for negative numbers (this is the default behavior).
</td>
</tr>

<tr>
<td>
space
</td>
<td>
Indicates that a leading space should be used for non-negative numbers, and a minus
sign for negative numbers.
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify [format.string] as indicated:</p>

<blockquote>
<p>
-6 The <tt>#</tt> option causes the <i>alternate form</i> to be used for the conversion. This option 
is only valid for arithmetic types other than <tt>charT</tt> and <tt>bool</tt> or when an integer 
presentation type is specified. For integral types, the alternate form <del>adds</del><ins>inserts</ins> 
the base prefix (if any) specified in Table [tab:format.type.int] to the output value <ins>after the 
sign, if any</ins>. [&hellip;]
</p>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2019-08-21; Victor Zverovich provides improved wording]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify the <i>sign</i> options Table [tab:format.sign] in 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 59: Meaning of <i>sign</i> options [tab:format.sign]</caption>
<tr align="center">
<th>Option</th>
<th>Meaning</th>
</tr> 

<tr>
<td>
<tt>'+'</tt>
</td>
<td>
Indicates that a sign should be used for both non-negative and negative numbers. <ins>The <tt>+</tt> 
sign is inserted before the output of <tt>to_chars</tt> for non-negative numbers other than 
the negative zero. [<i>Note:</i> For negative numbers and the negative zero the output of 
<tt>to_chars</tt> will already contain the sign so no additional transformation is performed. &mdash; 
<i>end note</i>]</ins>
</td>
</tr>

<tr>
<td>
<tt>'-'</tt>
</td>
<td>
Indicates that a sign should be used only for negative numbers (this is the default behavior).
</td>
</tr>

<tr>
<td>
space
</td>
<td>
Indicates that a leading space should be used for non-negative numbers, and a minus
sign for negative numbers.
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify [format.string] as indicated:</p>

<blockquote>
<p>
-6- The <tt>#</tt> option causes the <i>alternate form</i> to be used for the conversion. This option 
is only valid for arithmetic types other than <tt>charT</tt> and <tt>bool</tt> or when an integer 
presentation type is specified. For integral types, the alternate form <del>adds</del><ins>inserts</ins> 
the base prefix (if any) specified in Table [tab:format.type.int] to the output value <ins>after the 
sign character (possibly space) if there is one, or before the output of <tt>to_chars</tt> otherwise</ins>. 
[&hellip;]
</p>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
LWG made some improvements to the wording.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify the <i>sign</i> options Table [tab:format.sign] in 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 58: Meaning of <i>sign</i> options [tab:format.sign]</caption>
<tr align="center">
<th>Option</th>
<th>Meaning</th>
</tr> 

<tr>
<td>
<tt>'+'</tt>
</td>
<td>
Indicates that a sign should be used for both non-negative and negative numbers. <ins>The <tt>+</tt> 
sign is inserted before the output of <tt>to_chars</tt> for non-negative numbers other than 
negative zero. [<i>Note:</i> For negative numbers and negative zero the output of 
<tt>to_chars</tt> will already contain the sign so no additional transformation is performed. &mdash; 
<i>end note</i>]</ins>
</td>
</tr>

<tr>
<td>
<tt>'-'</tt>
</td>
<td>
Indicates that a sign should be used only for negative numbers (this is the default behavior).
</td>
</tr>

<tr>
<td>
space
</td>
<td>
Indicates that a leading space should be used for non-negative numbers, and a minus
sign for negative numbers.
</td>
</tr>

</table>
</blockquote>
</li>

<li><p>Modify [format.string] as indicated:</p>

<blockquote>
<p>
-6- The <tt>#</tt> option causes the <i>alternate form</i> to be used for the conversion. This option 
is <del>only</del> valid for arithmetic types other than <tt>charT</tt> and <tt>bool</tt> or when an integer 
presentation type is specified<ins>, and not otherwise</ins>. For integral types, the alternate form 
<del>adds</del><ins>inserts</ins> the base prefix (if any) specified in Table [tab:format.type.int] 
<del>to</del><ins>into</ins> the output <del>value</del> <ins>after the sign character (possibly space) 
if there is one, or before the output of <tt>to_chars</tt> otherwise</ins>. 
[&hellip;]
</p>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3249" href="3249">3249.</a> There are no 'pointers' in &sect;[atomics.lockfree]</h3>
<p><b>Section:</b> 31.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.lockfree">[atomics.lockfree]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Ready</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2019-08-03 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.lockfree">issues</a> in [atomics.lockfree].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Ready">Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
According to SG1 experts, the requirement in [atomics.lockfree]/2 is intended to require that 
the answer for <tt>is_lock_free()</tt> be the same for a given <tt>T</tt> for a given run of 
the program. The wording does not achieve that because it's described in terms of 'pointers', 
but there are no pointers in an <tt>atomic&lt;int&gt;</tt>.
</p>

<p><i>[2020-02 Status to Ready on Thursday morning in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 31.5 <a href="https://timsong-cpp.github.io/cppwp/atomics.lockfree">[atomics.lockfree]</a> as indicated:</p>

<blockquote>
<p>
-2- The function<ins>s <tt>atomic&lt;T&gt;::is_lock_free</tt>, and</ins> <tt>atomic_is_lock_free</tt> 
(31.8.1 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.operations">[atomics.types.operations]</a>) indicate<del>s</del> whether the object is lock-free. In any given program execution, the result of the lock-free query <ins>is the same for all atomic objects</ins> <del>shall 
be consistent for all pointers</del> of the same type.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3250" href="3250">3250.</a> <tt>std::format</tt>: <tt>#</tt> (alternate form) for NaN and inf</h3>
<p><b>Section:</b> 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-08-05 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.string.std">active issues</a> in [format.string.std].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.string.std">issues</a> in [format.string.std].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
We have:
</p>
<blockquote><p>
"For floating-point numbers, the alternate form causes the result of the conversion to always contain a decimal-point character, even if no digits follow it."
</p></blockquote>
<p>
So does that mean that infinity is formatted as <tt>"inf."</tt> and NaN as <tt>"nan."</tt>? (Or 
something like that? Where exactly do we add the decimal point in this case?) Or does this 
affect infinity but not NaN (because we can handwave that a NaN value is not a 
"floating-point number")?
<p/>
I suspect that this should only cover finite floating-point numbers.
<p/>
<b>Victor Zverovich:</b>
<p/>
Right. So infinity and NaN should be still formatted as <tt>"inf"</tt> and <tt>"nan"</tt> 
without a decimal point.
</p>

<p><i>[2020-02 Status to Immediate on Thursday morning in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<p>
-6- [&hellip;] For floating-point types, the alternate form causes the result of the conversion 
<ins>of finite values</ins> to always contain a decimal-point character, even if no digits follow 
it. Normally, a decimal-point character appears in the result of these conversions only if a digit 
follows it. In addition, for <tt>g</tt> and <tt>G</tt> conversions, trailing zeros are not removed 
from the result.
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3251" href="3251">3251.</a> Are <tt>std::format</tt> alignment specifiers applied to string arguments?</h3>
<p><b>Section:</b> 20.20.2 <a href="https://timsong-cpp.github.io/cppwp/format.string">[format.string]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-08-02 <b>Last modified:</b> 2020-02-14 09:37:04 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.string">active issues</a> in [format.string].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.string">issues</a> in [format.string].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
We are told:
</p>
<blockquote><p>
Formatting of objects of arithmetic types and <tt>const void*</tt> is done as if by 
calling <tt>to_chars</tt> (unless otherwise specified) and copying the output through 
the output iterator of the format context with additional padding and adjustments 
as specified by the format specifiers.
</p></blockquote>
<p>
&hellip; but there is no corresponding rule for strings. Is an alignment specifier 
intended to be applied to strings or not? The wording as-is is ambiguous.
<p/>
(The above also doesn't cover formatting <tt>void*</tt> or <tt>std::nullptr_t</tt>. 
Presumably at least those two should have the relevant adjustments applied to them!)
<p/>
The wording never actually anywhere says that the <tt>basic_format_args</tt> are in 
any way involved in the formatting process, or how formatting actually happens. 
(The wording doesn't say that <tt>basic_format_arg::handle::format</tt> is ever 
called, for example.)
<p/>
<b>Victor Zverovich:</b>
<p/>
An alignment specifier is intended to be applied to strings as well, <tt>void*</tt> and 
<tt>std::nullptr_t</tt> are converted into <tt>const void*</tt> when constructing 
<tt>basic_format_arg</tt>.
<p/>
The wording for <tt>vformat</tt> and similar functions says that <tt>basic_format_args</tt> is involved:
</p>
<blockquote><p>
<i>Returns:</i> A string object holding the character representation of formatting arguments
 provided by <tt>args</tt> formatted according to specifications given in <tt>fmt</tt>.
</p></blockquote>
<p>
but I admit that it is hand-wavy. Perhaps we could add something along the lines of
</p>
<blockquote><p>
For each replacement field referring to the argument with index <tt>(arg-id) i</tt>, the 
<tt>basic_format_arg</tt> object referring to the argument is obtained via <tt>args.get(i)</tt> 
and the <tt>parse</tt> and <tt>format</tt> functions of the <tt>formatter</tt> specialization 
for the underlying argument type are called to parse the format specification and format the value.
</p></blockquote>
<p>
to clarify how we format <tt>args</tt> (<tt>basic_format_args</tt>).
</p>

<p><i>[2019-08-21 Priority set to 2 based on reflector discussion]</i></p>


<p><i>[2019-08-21; Victor Zverovich suggests wording]</i></p>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<p>
-3- <ins>The <i>align</i> specifier applies to all argument types.</ins> The meaning of the 
various alignment options is as specified in Table [tab:format.align]. 
[<i>Example:</i> [&hellip;
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3252" href="3252">3252.</a> Parse locale's aware modifiers for commands are not consistent
with POSIX spec</h3>
<p><b>Section:</b> 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tomasz Kami&nacute;ski <b>Opened:</b> 2019-08-06 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.parse">active issues</a> in [time.parse].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.parse">issues</a> in [time.parse].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current specification of the locale modifiers for the parse flags in
"[tab:time.parse.spec] Meaning of <code>parse</code> flags" is
inconsistent with the <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/strptime.html">
POSIX <code>strptime</code> specification</a>:
</p>
<ul>
<li><p>New flags <code>%OC</code>, <code>%Ou</code> are added</p></li>
<li><p>Flags <code>%OI</code>, <code>%OU</code>, <code>%OW</code> are missing</p></li>
</ul>
<p>
Per Howard's comment:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
I only invented in a couple places for these flags, and none of them
involved locale-dependent stuff. If we are inconsistent with POSIX/C on
this, it's a bug. Rationale, <code>std::get_time</code> is already 
specified in terms of <code>strptime</code>, and we can't afford to be 
inventive with locale-dependent things.
</blockquote>
<p>
Note that, due above, the inconsistency between <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/strftime.html">
POSIX <code>strftime</code> specification</a> that supports <code>%Ou</code> 
and <code>%OV</code> that are not handled by <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/strptime.html">
<code>strptime</code></a> should be (by design) reflected in "[tab:time.format.spec] 
Meaning of conversion specifiers" and "[tab:time.parse.spec] Meaning of
<code>parse</code> flags" tables.
<p/>
The <code>%d</code> modifier was addressed by LWG <a href="3218">3218</a>.
</p>
<p><i>[2020-02 Status to Immediate on Thursday morning in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify Table 99 "Meaning of <tt>parse</tt> flags [tab:time.parse.spec]" in
27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 99: Meaning of <tt>parse</tt> flags [tab:time.parse.spec]</caption>
<tr align="center">
<th>Flag</th>
<th>Parsed value</th>
</tr> 

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>%C</tt>
</td>
<td>
The century as a decimal number. The modified command <tt>%<i>N</i>C</tt> specifies the maximum
number of characters to read. If <tt><i>N</i></tt> is not specified, the default is <tt>2</tt>. 
Leading zeroes are permitted but not required. The modified command<del>s</del> <tt>%EC</tt> 
<del>and <tt>%OC</tt></del> interpret<ins>s</ins> the locale's alternative representation of 
the century.
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>%I</tt>
</td>
<td>
The hour (12-hour clock) as a decimal number. The modified command <tt>%<i>N</i>I</tt> specifies
the maximum number of characters to read. If <tt><i>N</i></tt> is not specified, the default is <tt>2</tt>.
Leading zeroes are permitted but not required. <ins>The modified command <tt>%OI</tt> interprets 
the locale's alternative representation.</ins>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>%u</tt>
</td>
<td>
The ISO weekday as a decimal number (<tt>1-7</tt>), where Monday is <tt>1</tt>. The modified
command <tt>%<i>N</i>u</tt> specifies the maximum number of characters to read. If <tt><i>N</i></tt> 
is not specified, the default is <tt>1</tt>. Leading zeroes are permitted but not required. 
<del>The modified command <tt>%Ou</tt> interprets the locale's alternative representation.</del>
</td>
</tr>

<tr>
<td>
<tt>%U</tt>
</td>
<td>
The week number of the year as a decimal number. The first Sunday of the year is the
first day of week <tt>01</tt>. Days of the same year prior to that are in week <tt>00</tt>. 
The modified command <tt>%<i>N</i>U</tt> specifies the maximum number of characters to read. 
If <tt><i>N</i></tt> is not specified, the default is <tt>2</tt>. Leading zeroes are permitted 
but not required. <ins>The modified command <tt>%OU</tt> interprets the locale's
alternative representation.</ins>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>%W</tt>
</td>
<td>
The week number of the year as a decimal number. The first Monday of the year is the
first day of week <tt>01</tt>. Days of the same year prior to that are in week <tt>00</tt>. 
The modified command <tt>%<i>N</i>W</tt> specifies the maximum number of characters to read. 
If <tt><i>N</i></tt> is not specified, the default is <tt>2</tt>. Leading zeroes are permitted 
but not required. <ins>The modified command <tt>%OW</tt> interprets the locale's
alternative representation.</ins>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

</table>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3254" href="3254">3254.</a> Strike <tt>stop_token</tt>'s <tt>operator!=</tt></h3>
<p><b>Section:</b> 32.3.3 <a href="https://timsong-cpp.github.io/cppwp/stoptoken">[stoptoken]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-08-06 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In the shiny new world of the future, we need not declare overloads of <tt>operator!=</tt> that 
<tt>return !(x == y);</tt> the rewrite rule in 12.4.1.2 <a href="https://timsong-cpp.github.io/cppwp/over.match.oper">[over.match.oper]</a> para 3.4.3 
achieves the same effect. Consequently, we should not declare such unnecessary 
<tt>operator!=</tt> overloads. The synopsis of class <tt>stop_token</tt> in 32.3.3 <a href="https://timsong-cpp.github.io/cppwp/stoptoken">[stoptoken]</a> 
declares exactly such an <tt>operator!=</tt> friend which should be struck.
</p>
<p><i>[01-2020 Moved to Tentatively Ready after 5 positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 32.3.3 <a href="https://timsong-cpp.github.io/cppwp/stoptoken">[stoptoken]</a>, class <tt>stop_token</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  class stop_token {
  public:  
    [&hellip;]
    [[nodiscard]] friend bool operator==(const stop_token&amp; lhs, const stop_token&amp; rhs) noexcept;
    <del>[[nodiscard]] friend bool operator!=(const stop_token&amp; lhs, const stop_token&amp; rhs) noexcept;</del>
    friend void swap(stop_token&amp; lhs, stop_token&amp; rhs) noexcept;
  };
}
</pre>
</blockquote>

</li>

<li><p>Modify 32.3.3.3 <a href="https://timsong-cpp.github.io/cppwp/stoptoken.cmp">[stoptoken.cmp]</a> and 32.3.3.4 <a href="https://timsong-cpp.github.io/cppwp/stoptoken.special">[stoptoken.special]</a> as indicated:</p>

<blockquote>
<p>
<b>32.3.3.3 <ins>Non-member functions</ins><del>Comparisons</del> [stoptoken.<ins>nonmembers</ins><del>cmp</del>]</b>
</p>
<pre>
[[nodiscard]] bool operator==(const stop_token&amp; lhs, const stop_token&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>true</tt> if <tt>lhs</tt> and <tt>rhs</tt> have ownership of the same stop 
state or if both <tt>lhs</tt> and <tt>rhs</tt> do not have ownership of a stop state; otherwise <tt>false</tt>.
</p>
</blockquote>
<pre>
<del>[[nodiscard]] bool operator!=(const stop_token&amp; lhs, const stop_token&amp; rhs) noexcept;</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Returns:</i> <tt>!(lhs==rhs)</tt>.</del>
</p>
</blockquote>
<p>
<del><b>32.3.3.4 Specialized algorithms [stoptoken.special]</b></del>
</p>
<pre>
friend void swap(stop_token&amp; x, stop_token&amp; y) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to: <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3255" href="3255">3255.</a> <tt>span</tt>'s <tt>array</tt> constructor is too strict</h3>
<p><b>Section:</b> 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Jean Guegant &amp; Barry Revzin <b>Opened:</b> 2019-08-10 <b>Last modified:</b> 2020-02-14 09:37:04 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#span.cons">active issues</a> in [span.cons].</p>
<p><b>View all other</b> <a href="lwg-index.html#span.cons">issues</a> in [span.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<b>Barry Revzin:</b>
<p/>
From <a href="https://stackoverflow.com/q/57444188/2069064">StackOverflow</a>:
<p/>
This compiles:
</p>
<blockquote><pre>
std::vector&lt;int*&gt; v = {nullptr, nullptr};
std::span&lt;const int* const&gt; s{v};
</pre></blockquote>
<p>
This does not:
</p>
<blockquote><pre>
std::array&lt;int*, 2&gt; a = {nullptr, nullptr};
std::span&lt;const int* const&gt; s{a};
</pre></blockquote>
<p>
The problem is that <tt>span</tt>'s constructors include
</p>
<ul>
<li><p>A constructor template that takes any <tt>Container</tt> that is neither a raw array nor a <tt>std::array</tt></p></li>
<li><p>A constructor template that takes an <tt>array&lt;value_type, N&gt;&amp;</tt></p></li>
<li><p>A constructor template that takes a <tt>const array&lt;value_type, N&gt;&amp;</tt></p></li>
</ul>
<p>
So the first is excluded, and the other two don't match. We can change the array constructor templates to take an
<tt>array&lt;T, N&gt;</tt> with the requirement that <tt>T(*)[]</tt> is convertible to <tt>ElementType(*)[]</tt>?
<p/>
<b>Jean Guegant:</b>
<p/>
It is impossible to create a <tt>std::span</tt> from a <tt>std::array&lt;const T, X&gt;</tt> given the current
set of constructors of <tt>std::span</tt> (22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a>):
</p>
<blockquote><pre>
std::array&lt;const int, 4&gt; a = {1, 2, 3, 4};
std::span&lt;const int&gt; s{a}; <i>// No overload can be found.</i>
std::span s{a}; <i>// CTAD doesn't help either.</i>
</pre></blockquote>
<p>
Both constructors accepting a <tt>std::array</tt> (22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p11) require the first template
parameter of the <tt>std::array</tt> parameter to be <tt>value_type</tt>:
</p>
<blockquote><pre>
template&lt;size_t N&gt; constexpr span(array&lt;value_type, N&gt;&amp; arr) noexcept;
template&lt;size_t N&gt; constexpr span(const array&lt;value_type, N&gt;&amp; arr) noexcept;
</pre></blockquote>
<p>
<tt>value_type</tt> being defined as <tt>remove_cv_t&lt;ElementType&gt;</tt> &mdash; this constrains the first
template parameter not to be <tt>const</tt>.
<p/>
Both constructors accepting a generic <tt>Container</tt> (22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p14) have a
constraint &mdash; (p14.3) <tt>Container</tt> is not a specialization of <tt>array</tt> &mdash;
rejecting <tt>std::array</tt>.
<p/>
While you can call <tt>std::array&lt;const T, X&gt;::data</tt> and <tt>std::array&lt;const T, X&gt;::size</tt>
to manually create a <tt>std::span</tt>, we should, in my opinion, offer a proper overload for this scenario.
Two reasons came to my mind:
</p>
<ol>
<li><p><tt>std::span</tt> handles C-arrays and <tt>std::arrays</tt> in an asymmetric way. The constructor
taking a C-array (22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p11) is using <tt>element_type</tt> and as such can work with
<tt>const T</tt>:</p>
<blockquote><pre>
const int a[] = {1, 2, 3, 4};
std::span&lt;const int&gt; s{a}; <i>// It works</i>
</pre></blockquote>
<p>
If a user upgrades her/his code from C-arrays to a <tt>std::array</tt>s and literally take the type
<tt>const T</tt> and use it as the first parameter of <tt>std::array</tt>, he/she will face an error.
</p>
</li>
<li><p>Even if the user is aware that <tt>const std::array&lt;T, X&gt;</tt> is more idiomatic than
<tt>std::array&lt;const T, X&gt;</tt>, the second form may appear in the context of template
instantiation.</p></li>
</ol>
<p>
At the time this issue is written <tt>gls::span</tt>, from which <tt>std::span</tt> is partly based on,
does not suffer from the same issue: Its constructor taking a generic <tt>const Container&amp;</tt> does
not constraint the <tt>Container</tt> not to be a <tt>std::array</tt> (although its constructor taking
a generic <tt>Container&amp;</tt> does). For the users willing to upgrade from <tt>gsl::span</tt> to
<tt>std::span</tt>, this could be a breaking change.
</p>

<p><i>[2019-09-01 Priority set to 2 based on reflector discussion]</i></p>


<p><i>[2020-02-13 Tim updates PR]</i></p>

<p>
The previous PR's change to the raw array constructor is both 1) unnecessary and 2) incorrect; it prevents
<tt>span&lt;const int&gt;</tt> from being initialized with an <tt>int[42]</tt> xvalue.
</p>

<strong>Previous resolution: [SUPERSEDED]</strong>

<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note">
<p>
The only change is to make the constructors templated on the element type of the array as well.
We already have the right constraints in place. It's just that the 2nd constraint is trivially
satisfied today by the raw array constructor and either always or never satisfied by the <tt>std::array</tt> one.
</p>
</blockquote>

<ol>
<li><p>Modify 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a>, class template <tt>span</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template&lt;class ElementType, size_t Extent = dynamic_extent&gt;
class span {
public:
  [&hellip;]
  <i>// 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a>, constructors, copy, and assignment</i>
  constexpr span() noexcept;
  constexpr span(pointer ptr, index_type count);
  constexpr span(pointer first, pointer last);
  template&lt;<ins>class T,</ins> size_t N&gt;
    constexpr span(<ins>T</ins><del>element_type</del> (&amp;arr)[N]) noexcept;
  template&lt;<ins>class T,</ins> size_t N&gt;
    constexpr span(array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
  template&lt;<ins>class T,</ins> size_t N&gt;
    constexpr span(const array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
  [&hellip;]
};
</pre>
</blockquote>
</li>

<li><p>Modify 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;<ins>class T,</ins> size_t N&gt;
  constexpr span(<ins>T</ins><del>element_type</del> (&amp;arr)[N]) noexcept;
template&lt;<ins>class T,</ins> size_t N&gt;
  constexpr span(array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
template&lt;<ins>class T,</ins> size_t N&gt;
  constexpr span(const array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
</pre>
<blockquote>
<p>
-11- <i>Constraints:</i>
</p>
<ol style="list-style-type: none">
<li><p>(11.1) &mdash; <tt>extent == dynamic_extent || N == extent</tt> is <tt>true</tt>, and</p></li>
<li><p>(11.2) &mdash; <tt>remove_pointer_t&lt;decltype(data(arr))&gt;(*)[]</tt> is convertible to <tt>ElementType(*)[]</tt>.</p></li>
</ol>
<p>
-12- <i>Effects:</i> Constructs a <tt>span</tt> that is a view over the supplied array.
<p/>
-13- <i>Ensures:</i> <tt>size() == N &amp;&amp; data() == data(arr)</tt> <ins>is <tt>true</tt></ins>.
</p>
</blockquote>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>
<ol>
<li><p>Modify 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a>, class template <tt>span</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
template&lt;class ElementType, size_t Extent = dynamic_extent&gt;
class span {
public:
  [&hellip;]
  <i>// 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a>, constructors, copy, and assignment</i>
  constexpr span() noexcept;
  [&hellip;]
  template&lt;size_t N&gt;
    constexpr span(element_type (&amp;arr)[N]) noexcept;
  template&lt;<ins>class T,</ins> size_t N&gt;
    constexpr span(array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
  template&lt;<ins>class T,</ins> size_t N&gt;
    constexpr span(const array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
  [&hellip;]
};
</pre>
</blockquote>
</li>

<li><p>Modify 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;size_t N&gt;
  constexpr span(element_type (&amp;arr)[N]) noexcept;
template&lt;<ins>class T,</ins> size_t N&gt;
  constexpr span(array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
template&lt;<ins>class T,</ins> size_t N&gt;
  constexpr span(const array&lt;<ins>T</ins><del>value_type</del>, N&gt;&amp; arr) noexcept;
</pre>
<blockquote>
<p>
-11- <i>Constraints:</i>
</p>
<ol style="list-style-type: none">
<li><p>(11.1) &mdash; <tt>extent == dynamic_extent || N == extent</tt> is <tt>true</tt>, and</p></li>
<li><p>(11.2) &mdash; <tt>remove_pointer_t&lt;decltype(data(arr))&gt;(*)[]</tt> is convertible to <tt>ElementType(*)[]</tt>.</p></li>
</ol>
<p>
-12- <i>Effects:</i> Constructs a <tt>span</tt> that is a view over the supplied array.
<p/>
-13- <i>Postconditions:</i> <tt>size() == N &amp;&amp; data() == data(arr)</tt> <ins>is <tt>true</tt></ins>.
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3258" href="3258">3258.</a> Range access and <tt>initializer_list</tt></h3>
<p><b>Section:</b> 24.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.access.begin">[range.access.begin]</a>, 24.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.access.end">[range.access.end]</a>, 24.3.5 <a href="https://timsong-cpp.github.io/cppwp/range.access.rbegin">[range.access.rbegin]</a>, 24.3.6 <a href="https://timsong-cpp.github.io/cppwp/range.access.rend">[range.access.rend]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-08-15 <b>Last modified:</b> 2019-10-07 02:21:30 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The specification of <tt>ranges::begin</tt> in 24.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.access.begin">[range.access.begin]</a> includes a
"poison pill" overload:
<blockquote><pre>
template&lt;class T&gt; void begin(initializer_list&lt;T&gt;&amp;&amp;) = delete;
</pre></blockquote>
which exists to create an ambiguity with the non-member <tt>initializer_list</tt> overload of
<tt>begin</tt> in namespace <tt>std</tt> (17.10.1 <a href="https://timsong-cpp.github.io/cppwp/initializer.list.syn">[initializer.list.syn]</a>) when performing
unqualified lookup, since specializations of <tt>initializer_list</tt> should not satisfy
<tt><i>forwarding-range</i></tt> (24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a>). The design intent is that
<tt>const</tt> specializations of <tt>initializer_list</tt> should also not satisfy
<tt><i>forwarding-range</i></tt>, although they are rare enough beasts that they were overlooked
when this wording is written.
</p><p>
<tt>ranges::end</tt> (24.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.access.end">[range.access.end]</a>) has a similar poison pill for
<tt>initializer_list</tt>, which should be changed consistently.
</p><p>
Notably <tt>ranges::rbegin</tt> (24.3.5 <a href="https://timsong-cpp.github.io/cppwp/range.access.rbegin">[range.access.rbegin]</a>) and <tt>ranges::rend</tt>
(24.3.5 <a href="https://timsong-cpp.github.io/cppwp/range.access.rbegin">[range.access.rbegin]</a>) as currently specified <em>accept</em> rvalue
<tt>initializer_list</tt> arguments; they find the <tt>initializer_list</tt> overloads of
<tt>std::rbegin</tt> and <tt>std::rend</tt> (23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a>) via ADL. While I can't
put my finger on anything in particular that's broken by this behavior, it seems wise to make
<tt>rbegin</tt> and <tt>rend</tt> consistent with <tt>begin</tt> and <tt>end</tt> for
<tt>initializer_list</tt> until and unless we discover a reason to do otherwise.
</p>
<p><i>[2019-10 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.access.begin">[range.access.begin]</a> as follows:</p>

<blockquote><p>
-1- The name <tt>ranges::begin</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). The expression <tt>ranges::begin(E)</tt> for some
subexpression <tt>E</tt> is expression-equivalent to:
</p><p>
(1.1) &mdash; <tt>E + 0</tt> if <tt>E</tt> is an lvalue of array type (6.8.2 <a href="https://timsong-cpp.github.io/cppwp/basic.compound">[basic.compound]</a>).
</p><p>
(1.2) &mdash; Otherwise, if <tt>E</tt> is an lvalue, <tt><i>decay-copy</i>(E.begin())</tt> if it
is a valid expression and its type <tt>I</tt> models <tt>input_or_output_iterator</tt>.
</p><p>
(1.3) &mdash; Otherwise, <tt><i>decay-copy</i>(begin(E))</tt> if it is a valid expression and its
type <tt>I</tt> models <tt>input_or_output_iterator</tt> with overload resolution performed in a
context that includes the declarations:
<blockquote><pre>
template&lt;class T&gt; void begin(T&amp;&amp;) = delete;
template&lt;class T&gt; void begin(initializer_list&lt;T&gt;<del>&amp;&amp;</del>) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::begin</tt>.
</p><p>
[&hellip;]
</p></blockquote>
</li>

<li><p>Modify 24.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.access.end">[range.access.end]</a> as follows:</p>

<blockquote><p>
-1- The name <tt>ranges::end</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). The expression <tt>ranges::end(E)</tt> for some
subexpression <tt>E</tt> is expression-equivalent to:
</p><p>
(1.1) &mdash; <tt>E + extent_v&lt;T&gt;</tt> if <tt>E</tt> is an lvalue of array type (6.8.2 <a href="https://timsong-cpp.github.io/cppwp/basic.compound">[basic.compound]</a>) <tt>T</tt>.
</p><p>
(1.2) &mdash; Otherwise, if <tt>E</tt> is an lvalue, <tt><i>decay-copy</i>(E.end())</tt> if it is a
valid expression and its type <tt>S</tt> models <tt>sentinel_for&lt;decltype(ranges::begin(E))&gt;</tt>
</p><p>
(1.3) &mdash; Otherwise, <tt><i>decay-copy</i>(end(E))</tt> if it is a valid expression and its type
<tt>S</tt> models <tt>sentinel_for&lt;decltype(ranges::begin(E))&gt;</tt> with overload resolution
performed in a context that includes the declarations:
<blockquote><pre>
template&lt;class T&gt; void end(T&amp;&amp;) = delete;
template&lt;class T&gt; void end(initializer_list&lt;T&gt;<del>&amp;&amp;</del>) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::end</tt>.
</p><p>
[&hellip;]
</p></blockquote>
</li>

<li><p>Modify 24.3.5 <a href="https://timsong-cpp.github.io/cppwp/range.access.rbegin">[range.access.rbegin]</a> as follows:</p>

<blockquote><p>
-1- The name <tt>ranges::rbegin</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). The expression <tt>ranges::rbegin(E)</tt> for some
subexpression <tt>E</tt> is expression-equivalent to:
</p><p>
(1.1) &mdash; If <tt>E</tt> is an lvalue, <tt><i>decay-copy</i>(E.rbegin())</tt> if it is a valid
expression and its type <tt>I</tt> models <tt>input_or_output_iterator</tt>.
</p><p>
(1.2) &mdash; Otherwise, <tt><i>decay-copy</i>(rbegin(E))</tt> if it is a valid expression and its
type <tt>I</tt> models <tt>input_or_output_iterator</tt> with overload resolution performed in a
context that includes the declaration<ins>s</ins>:
<blockquote><pre>
template&lt;class T&gt; void rbegin(T&amp;&amp;) = delete;
<ins>template&lt;class T&gt; void rbegin(initializer_list&lt;T&gt;) = delete;</ins>
</pre></blockquote>
and does not include a declaration of <tt>ranges::rbegin</tt>.
</p><p>
[&hellip;]
</p></blockquote>
</li>

<li><p>Modify 24.3.6 <a href="https://timsong-cpp.github.io/cppwp/range.access.rend">[range.access.rend]</a> as follows:</p>

<blockquote><p>
-1- The name <tt>ranges::rend</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). The expression <tt>ranges::rend(E)</tt> for some
subexpression <tt>E</tt> is expression-equivalent to:
</p><p>
(1.1) &mdash; If <tt>E</tt> is an lvalue, <tt><i>decay-copy</i>(E.rend())</tt> if it is a valid
expression and its type <tt>S</tt> models
<blockquote><pre>
sentinel_for&lt;decltype(ranges::rbegin(E))&gt;
</pre></blockquote>
</p><p>
(1.2) &mdash; Otherwise, <tt><i>decay-copy</i>(rend(E))</tt> if it is a valid expression and its
type <tt>S</tt> models
<blockquote><pre>
sentinel_for&lt;decltype(ranges::rbegin(E))&gt;
</pre></blockquote>
with overload resolution performed in a context that includes the declaration<ins>s</ins>:
<blockquote><pre>
template&lt;class T&gt; void rend(T&amp;&amp;) = delete;
<ins>template&lt;class T&gt; void rend(initializer_list&lt;T&gt;) = delete;</ins>
</pre></blockquote>
and does not include a declaration of <tt>ranges::rend</tt>.
</p><p>
[&hellip;]
</p></blockquote>
</li>
</ol>





<hr>
<h3><a name="3260" href="3260">3260.</a> <tt>year_month*</tt> arithmetic rejects durations convertible to years</h3>
<p><b>Section:</b> 27.8 <a href="https://timsong-cpp.github.io/cppwp/time.cal">[time.cal]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tomasz Kami&nacute;ski <b>Opened:</b> 2019-08-15 <b>Last modified:</b> 2020-02-13 22:05:05 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Currently, the <tt>year_month*</tt> types (<tt>year_month</tt>,
<tt>year_month_day</tt>) provide separate arithmetic operators with
duration type of <tt>years</tt> or <tt>months</tt>. This is an intentional
optimization that avoids performing modulo arithmetic in the former case.
<p/>
However, these make the arithmetic of <code>year_month*</code> types
with durations that are convertible to <code>years</code> (and by
consequence to <code>months</code>) ambiguous. For example, the following
code is ambiguous:
</p>
<blockquote>
<pre>
using decades = duration&lt;int, ratio_multiply&lt;ratio&lt;10&gt;, years::period&gt;&gt;;
auto ymd = 2001y/January/1d;
ymd += decades(1); // <span style="color:#C80000;font-weight:bold">error, ambiguous</span>
</pre>
</blockquote>
<p>
while less usual durations that are only convertible to <tt>months</tt> work correctly:
</p>
<blockquote>
<pre>
using decamonths = duration&lt;int, ratio_multiply&lt;ratio&lt;10&gt;, months::period&gt;&gt;;
auto ymd = 2001y/January/1d;
ymd += decamonths(1);
</pre>
</blockquote>
<p>
The example implementation resolves the issues by making sure that the
<tt>years</tt> overload will be preferred in case of ambiguity, by declaring the
<tt>months</tt> overload a function template with a default argument for its parameter
(suggested by Tim Song):
</p>
<blockquote>
<pre>
<ins>template&lt;class = <em>unspecified</em>&gt;</ins>
constexpr year_month_weekday&amp; operator+=(const months&amp; m) noexcept;
constexpr year_month_weekday&amp; operator+=(const years&amp; m) noexcept;
</pre>
</blockquote>

<p><i>[2019-09-14 Priority set to 2 based on reflector discussion]</i></p>


<p><i>[2019-09-14; Tomasz and Howard provide concrete wording]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> Suggested wording below assumes that we can add a <i>Constraints:</i> to a 
signature where the constraint does not apply to a deduced template. We have examples of such 
constraints in other parts of the WD (e.g. 20.11.1.2.1 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.ctor">[unique.ptr.single.ctor]</a>/p15, 
20.11.1.2.3 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.asgn">[unique.ptr.single.asgn]</a>/p1). And we have the old form "does not participate &hellip;" 
being used for non-deduced templates in several places as well (e.g. 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a>/p5).
<p/>
There are several ways of implementing such a constraint, such as adding a gratuitous template 
parameter.]
</p>
</blockquote>

<ol>
<li><p>Modify 27.8.13.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ym.members">[time.cal.ym.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month&amp; operator+=(const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-4- <i>Effects:</i> <tt>*this = *this + dm</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month&amp; operator-=(const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-6- <i>Effects:</i> <tt>*this = *this - dm</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.13.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ym.nonmembers">[time.cal.ym.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month operator+(const year_month&amp; ym, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-3- <i>Returns:</i> A <tt>year_month</tt> value <tt>z</tt> such that <tt>z - ym == dm</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month operator+(const months&amp; dm, const year_month&amp; ym) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-5- <i>Returns:</i> <tt>ym + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month operator-(const year_month&amp; ym, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-6- <i>Returns:</i> <tt>ym + -dm</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.14.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymd.members">[time.cal.ymd.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_day&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-7- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_day&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-9- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.14.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymd.nonmembers">[time.cal.ymd.nonmembers]</a> as indicated:</p>
<blockquote>
<pre>
constexpr year_month_day operator+(const year_month_day&amp; ymd, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-3- <i>Returns:</i> <tt>(ymd.year() / ymd.month() + dm) / ymd.day()</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_day operator+(const months&amp; dm, const year_month_day&amp; ymd) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-5- <i>Returns:</i> <tt>ymd + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_day operator+(const months&amp; dm, const year_month_day&amp; ymd) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-6- <i>Returns:</i> <tt>ymd + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.15.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymdlast.members">[time.cal.ymdlast.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_day_last&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-2- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_day_last&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-4- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.15.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymdlast.nonmembers">[time.cal.ymdlast.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_day_last
  operator+(const year_month_day_last&amp; ymdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-3- <i>Returns:</i> <tt>(ymdl.year() / ymdl.month() + dm) / last</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_day_last
  operator+(const months&amp; dm, const year_month_day_last&amp; ymdl) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-4- <i>Returns:</i> <tt>ymdl + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_day_last
  operator-(const year_month_day_last&amp; ymdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-5- <i>Returns:</i> <tt>ymdl + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.16.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwd.members">[time.cal.ymwd.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-6- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_weekday&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-8- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.16.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwd.nonmembers">[time.cal.ymwd.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday operator+(const year_month_weekday&amp; ymwd, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-2- <i>Returns:</i> <tt>(ymwd.year() / ymwd.month() + dm) / ymwd.weekday_indexed()</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday operator+(const months&amp; dm, const year_month_weekday&amp; ymwd) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-3- <i>Returns:</i> <tt>ymwd + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday operator-(const year_month_weekday&amp; ymwd, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-4- <i>Returns:</i> <tt>ymwd + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.17.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwdlast.members">[time.cal.ymwdlast.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday_last&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-2- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_weekday_last&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-4- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.17.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwdlast.nonmembers">[time.cal.ymwdlast.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday_last
  operator+(const year_month_weekday_last&amp; ymwdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-2- <i>Returns:</i> <tt>(ymwdl.year() / ymwdl.month() + dm) / ymwdl.weekday_last()</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday_last
  operator+(const months&amp; dm, const year_month_weekday_last&amp; ymwdl) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-3- <i>Returns:</i> <tt>ymwdl + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday_last
  operator-(const year_month_weekday_last&amp; ymwdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> The argument supplied by the caller for the <tt>months</tt> 
parameter is not implicitly convertible to <tt>years</tt>.</ins>
<p/>
-4- <i>Returns:</i> <tt>ymwdl + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Tim Song found a wording problem that we would like to resolve:
<p/>
Given a class like
</p>
<blockquote><pre>
struct C : months {
  operator years();
};
</pre></blockquote>
<p>
The previous wording requires calls with a <tt>C</tt> argument to use the <tt>years</tt> overload, which 
would require implementation heroics since its conversion sequence to <tt>months</tt> is better than <tt>years</tt>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> Suggested wording below assumes that we can add a <i>Constraints:</i> to a 
signature where the constraint does not apply to a deduced template. We have examples of such 
constraints in other parts of the WD (e.g. 20.11.1.2.1 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.ctor">[unique.ptr.single.ctor]</a>/p15, 
20.11.1.2.3 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.asgn">[unique.ptr.single.asgn]</a>/p1). And we have the old form "does not participate &hellip;" 
being used for non-deduced templates in several places as well (e.g. 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a>/p5).
<p/>
There are several ways of implementing such a constraint, such as adding a gratuitous template 
parameter.]
</p>
</blockquote>

<ol>
<li><p>Modify 27.8.13.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ym.members">[time.cal.ym.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month&amp; operator+=(const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-4- <i>Effects:</i> <tt>*this = *this + dm</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month&amp; operator-=(const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-6- <i>Effects:</i> <tt>*this = *this - dm</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.13.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ym.nonmembers">[time.cal.ym.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month operator+(const year_month&amp; ym, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-3- <i>Returns:</i> A <tt>year_month</tt> value <tt>z</tt> such that <tt>z - ym == dm</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month operator+(const months&amp; dm, const year_month&amp; ym) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-5- <i>Returns:</i> <tt>ym + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month operator-(const year_month&amp; ym, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-6- <i>Returns:</i> <tt>ym + -dm</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.14.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymd.members">[time.cal.ymd.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_day&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-7- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_day&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-9- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.14.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymd.nonmembers">[time.cal.ymd.nonmembers]</a> as indicated:</p>
<blockquote>
<pre>
constexpr year_month_day operator+(const year_month_day&amp; ymd, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-3- <i>Returns:</i> <tt>(ymd.year() / ymd.month() + dm) / ymd.day()</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_day operator+(const months&amp; dm, const year_month_day&amp; ymd) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-5- <i>Returns:</i> <tt>ymd + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_day operator+(const months&amp; dm, const year_month_day&amp; ymd) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-6- <i>Returns:</i> <tt>ymd + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.15.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymdlast.members">[time.cal.ymdlast.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_day_last&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-2- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_day_last&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-4- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.15.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymdlast.nonmembers">[time.cal.ymdlast.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_day_last
  operator+(const year_month_day_last&amp; ymdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-3- <i>Returns:</i> <tt>(ymdl.year() / ymdl.month() + dm) / last</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_day_last
  operator+(const months&amp; dm, const year_month_day_last&amp; ymdl) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-4- <i>Returns:</i> <tt>ymdl + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_day_last
  operator-(const year_month_day_last&amp; ymdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-5- <i>Returns:</i> <tt>ymdl + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.16.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwd.members">[time.cal.ymwd.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-6- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_weekday&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-8- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.16.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwd.nonmembers">[time.cal.ymwd.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday operator+(const year_month_weekday&amp; ymwd, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-2- <i>Returns:</i> <tt>(ymwd.year() / ymwd.month() + dm) / ymwd.weekday_indexed()</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday operator+(const months&amp; dm, const year_month_weekday&amp; ymwd) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-3- <i>Returns:</i> <tt>ymwd + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday operator-(const year_month_weekday&amp; ymwd, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-4- <i>Returns:</i> <tt>ymwd + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.17.2 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwdlast.members">[time.cal.ymwdlast.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday_last&amp; operator+=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-2- <i>Effects:</i> <tt>*this = *this + m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr year_month_weekday_last&amp; operator-=(const months&amp; m) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-4- <i>Effects:</i> <tt>*this = *this - m</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.8.17.3 <a href="https://timsong-cpp.github.io/cppwp/time.cal.ymwdlast.nonmembers">[time.cal.ymwdlast.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr year_month_weekday_last
  operator+(const year_month_weekday_last&amp; ymwdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-2- <i>Returns:</i> <tt>(ymwdl.year() / ymwdl.month() + dm) / ymwdl.weekday_last()</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday_last
  operator+(const months&amp; dm, const year_month_weekday_last&amp; ymwdl) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-3- <i>Returns:</i> <tt>ymwdl + dm</tt>.
</p>
</blockquote>
<pre>
constexpr year_month_weekday_last
  operator-(const year_month_weekday_last&amp; ymwdl, const months&amp; dm) noexcept;
</pre>
<blockquote>
<p>
<ins>-?- <i>Constraints:</i> If the argument supplied by the caller for the <tt>months</tt> 
parameter is convertible to <tt>years</tt>, its implicit conversion sequence to <tt>years</tt> is 
worse than its implicit conversion sequence to <tt>months</tt> (12.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/over.ics.rank">[over.ics.rank]</a>).</ins>
<p/>
-4- <i>Returns:</i> <tt>ymwdl + (-dm)</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3261" href="3261">3261.</a> <tt>regex</tt> components' <tt>noexcept</tt> annotations appear broken for POCMA or throwing 
<tt>BidirectionalIterator</tt></h3>
<p><b>Section:</b> 30.8 <a href="https://timsong-cpp.github.io/cppwp/re.regex">[re.regex]</a>, 30.10 <a href="https://timsong-cpp.github.io/cppwp/re.results">[re.results]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2019-08-17 <b>Last modified:</b> 2019-10-07 02:21:30 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.regex">active issues</a> in [re.regex].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.regex">issues</a> in [re.regex].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>std::basic_regex</tt> and <tt>std::match_results</tt> have <tt>noexcept</tt> move construction, and 
<tt>std::basic_regex</tt> has <tt>noexcept</tt> move assignment, but both of them have throwing swaps. We 
probably need an <i>Expects:</i> or something to say that <tt>BidirectionalIterator</tt> doesn't 
throw through these operations. We probably also need <tt>match_results::operator=</tt> to 
respect <tt>propagate_on_container_move_assignment</tt> (and maybe the copy ctor respect 
<tt>propagate_on_container_copy_assignment</tt>).
</p>
<p><i>[2019-09-02; Tim Song comments]</i></p>

<p>
The issue is related to LWG <a href="2490">2490</a>.
</p>
<p><i>[2019-10 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>



<hr>
<h3><a name="3262" href="3262">3262.</a> Formatting of negative durations is not specified</h3>
<p><b>Section:</b> 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tomasz Kami&nacute;ski <b>Opened:</b> 2019-08-18 <b>Last modified:</b> 2020-02-13 18:06:22 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.format">active issues</a> in [time.format].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.format">issues</a> in [time.format].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current specification of the formatting for <code>std::chrono::duration</code> and 
<code>std::hh_mm_ss</code> types is unclear in regards the the handling of negative values. 
To illustrate:
</p>
<blockquote><pre>
std::cout &lt;&lt; std::format("%H:%M:%S", -10'000s); <i>// prints either -02:46:40 or -02:-46:-40</i>
</pre></blockquote>
<p>
The indented behavior (and currently implemented, see 
<a href="https://wandbox.org/permlink/mrw03IaAldP7Bdx1">here</a>) is to apply the
sign once, before the leftmost converted field.
</p>

<p><i>[2019-09-14 Priority set to 2 based on reflector discussion]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> With the above clarification, the specification of the
<code>operator&lt;&lt;</code> for <code>hh_mm_ss</code> may be simplified to
<code>format("{:%T}", hms)</code>.]
</p>
</blockquote>

<ol>
<li><p>Modify 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a> as indicated:</p>

<blockquote>
<p>
-2- Each conversion specifier <i>conversion-spec</i> is replaced by appropriate 
characters as described in Table [tab:time.format.spec]. Some of the conversion 
specifiers depend on the locale that is passed to the formatting function if 
the latter takes one, or the global locale otherwise. If the formatted object 
does not contain the information the conversion specifier refers to, an 
exception of type <tt>format_error</tt> is thrown.
<p/>
<ins>-?- The result of formatting a <tt>std::chrono::duration</tt> instance holding 
a negative value, or of an <tt>hh_mm_ss</tt> object <tt>h</tt> for which <tt>h.is_negative()</tt> 
is <tt>true</tt>, is equivalent to the output of the corresponding positive value, 
with a <tt>-</tt> character placed before the replacement of the leftmost conversion
specifier.</ins>
<p/>
<ins>[<i>Example:</i></ins>
</p>
<blockquote><pre>
<ins>cout &lt;&lt; format("%T", -10'000s); <i>// prints:</i> -02:46:40
cout &lt;&lt; format("%H:%M:%S", -10'000s); <i>// prints:</i> -02:46:40
cout &lt;&lt; format("minutes %M, hours %H, seconds %S", -10'000s); <i>// prints:</i> minutes -46, hours 02, seconds 40</ins>
</pre></blockquote>
<p>
<ins>&mdash; <i>end example</i>]</ins>
<p/>
-3- Unless explicitly requested, [&hellip;]
</p>
</blockquote>
</li>

<li><p>Modify 27.9.3 <a href="https://timsong-cpp.github.io/cppwp/time.hms.nonmembers">[time.hms.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class charT, class traits, class Duration&gt;
basic_ostream&lt;charT, traits&gt;&amp;
operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const hh_mm_ss&lt;Duration&gt;&amp; hms);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to:
</p>
<blockquote><pre>
return os &lt;&lt; format(os.getloc(),
             <del>hms.is_negative() ? <i>STATICALLY-WIDEN</i>&lt;charT&gt;("-{:%T}")
                               : </del><i>STATICALLY-WIDEN</i>&lt;charT&gt;("{:%T}"),
             <del>abs(</del>hms<del>.to_duration())</del>);
</pre></blockquote>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2019-09-14; Howard improves wording]</i></p>

<p><i>[2020-02; Status set to Immediate after LWG discussion Thursday in Prague. (Minor example wording cleanup)]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> With the above clarification, the specification of the
<code>operator&lt;&lt;</code> for <code>hh_mm_ss</code> may be simplified to
<code>format("{:%T}", hms)</code>.]
</p>
</blockquote>

<ol>
<li><p>Modify 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a> as indicated:</p>

<blockquote>
<p>
-2- Each conversion specifier <i>conversion-spec</i> is replaced by appropriate 
characters as described in Table [tab:time.format.spec]. Some of the conversion 
specifiers depend on the locale that is passed to the formatting function if 
the latter takes one, or the global locale otherwise. If the formatted object 
does not contain the information the conversion specifier refers to, an 
exception of type <tt>format_error</tt> is thrown.
<p/>
<ins>-?- The result of formatting a <tt>std::chrono::duration</tt> instance holding 
a negative value, or of an <tt>hh_mm_ss</tt> object <tt>h</tt> for which <tt>h.is_negative()</tt> 
is <tt>true</tt>, is equivalent to the output of the corresponding positive value, 
with a <tt><i>STATICALLY-WIDEN</i>&lt;charT&gt;("-")</tt> character sequence placed 
before the replacement of the leftmost conversion specifier.</ins>
<p/>
<ins>[<i>Example:</i></ins>
</p>
<blockquote><pre>
<ins>cout &lt;&lt; format("{%:T}", -10'000s); <i>// prints:</i> -02:46:40
cout &lt;&lt; format("{:%H:%M:%S}", -10'000s); <i>// prints:</i> -02:46:40
cout &lt;&lt; format("{:minutes %M, hours %H, seconds %S}", -10'000s); <i>// prints:</i> minutes -46, hours 02, seconds 40</ins>
</pre></blockquote>
<p>
<ins>&mdash; <i>end example</i>]</ins>
<p/>
-3- Unless explicitly requested, [&hellip;]
</p>
</blockquote>
</li>

<li><p>Modify 27.9.3 <a href="https://timsong-cpp.github.io/cppwp/time.hms.nonmembers">[time.hms.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class charT, class traits, class Duration&gt;
basic_ostream&lt;charT, traits&gt;&amp;
operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const hh_mm_ss&lt;Duration&gt;&amp; hms);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to:
</p>
<blockquote><pre>
return os &lt;&lt; format(os.getloc(),
             <del>hms.is_negative() ? <i>STATICALLY-WIDEN</i>&lt;charT&gt;("-{:%T}")
                               : </del><i>STATICALLY-WIDEN</i>&lt;charT&gt;("{:%T}"),
             <del>abs(</del>hms<del>.to_duration())</del>);
</pre></blockquote>
</blockquote>
</blockquote>
</li>
</ol>



<hr>
<h3><a name="3263" href="3263">3263.</a> Atomic waiting function calls should only be unblocked once</h3>
<p><b>Section:</b> 31.6 <a href="https://timsong-cpp.github.io/cppwp/atomics.wait">[atomics.wait]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Geoffrey Romer <b>Opened:</b> 2019-08-19 <b>Last modified:</b> 2019-09-15 10:35:38 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#atomics.wait">active issues</a> in [atomics.wait].</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.wait">issues</a> in [atomics.wait].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It appears that in a conforming implementation, all but one <tt>wait()</tt> call on a given 
atomic object may block forever, regardless of any <tt>notify_one()</tt> calls, because in 
principle every <tt>notify_one()</tt> call could be considered to unblock the same single 
<tt>wait()</tt> call. Common sense suggests (and David Olsen confirms) that the intent is 
for each waiting function call to be (non-spuriously) unblocked by at most one notifying 
function call, but as far as I can tell the words never say that.
</p>

<p><i>[2019-09-14 Priority set to 3 based on reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 31.6 <a href="https://timsong-cpp.github.io/cppwp/atomics.wait">[atomics.wait]</a> as indicated:</p>

<blockquote>
<p>
<ins>-?- All blocking and unblocking events on a single atomic object occur in a single total order 
that is consistent with the "happens before" partial order.</ins>
<p/>
-4- A call to an atomic waiting operation on an atomic object <tt>M</tt> is <i>eligible to be 
unblocked</i> by a call to an atomic notifying operation on <tt>M</tt> if <ins>it has not been 
unblocked, and</ins> there exist side effects <tt>X</tt> and <tt>Y</tt> on <tt>M</tt> such that:
</p>
<ol style="list-style-type: none">
<li><p>(4.1) &mdash; the atomic waiting operation has blocked after observing the result of <tt>X</tt>,</p></li>
<li><p>(4.2) &mdash; <tt>X</tt> precedes <tt>Y</tt> in the modification order of <tt>M</tt>, and</p></li>
<li><p>(4.3) &mdash; <tt>Y</tt> happens before the call to the atomic notifying operation.</p></li>
</ol>
</blockquote>
</li>

</ol>



<hr>
<h3><a name="3264" href="3264">3264.</a> <tt>sized_range</tt> and <tt>ranges::size</tt> redundantly use <tt>disable_sized_range</tt></h3>
<p><b>Section:</b> 24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-08-26 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>disable_sized_range</tt> (24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a>) is an opt-out trait that users may
specialize when their <tt>range</tt> type conforms to the syntax of <tt>sized_range</tt> but not its
semantics, or when the type is so poorly suited to the Standard Library that even testing the
validity of the expressions <tt>r.size()</tt> or <tt>size(r)</tt> for a range <tt>r</tt> is
impossible. The library inspects <tt>disable_sized_range</tt> in two places. (1) In the definition of
the <tt>sized_range</tt> concept:
<blockquote><pre>
template&lt;class T&gt;
  concept sized_range =
    range&lt;T&gt; &amp;&amp;
    !disable_sized_range&lt;remove_cvref_t&lt;T&gt;&gt; &amp;&amp;
    requires(T&amp; t) { ranges::size(t); };
</pre></blockquote>
If the pertinent specialization of <tt>disable_sized_range</tt> is <tt>true</tt>, we avoid checking
the validity of the expression <tt>ranges::size(t)</tt> in the <i>requires-expression</i>.
(2) In the definition of the <tt>ranges::size</tt> CPO itself (24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a>),
the validity of the expressions <tt><i>decay-copy</i>(E.size())</tt> and
<tt><i>decay-copy</i>(size(E))</tt> is not checked if the pertinent specialization of
<tt>disable_sized_range</tt> is <tt>true</tt>.
</p><p>
<tt>disable_sized_range</tt> is effectively checked <em>twice</em> when evaluating
<tt>sized_range</tt>. This redundancy could be forgiven, if it did not permit the existence of
non-<tt>sized_range</tt>s for which <tt>ranges::size</tt> returns a valid size:
<blockquote><pre>
struct mytype {};
using A = mytype[42];

template &lt;&gt;
constexpr bool std::ranges::disable_sized_range&lt;A&gt; = true;

static_assert(std::ranges::range&lt;A&gt;);
static_assert(!std::ranges::sized_range&lt;A&gt;);
static_assert(std::ranges::size(A{}) == 42);

struct myrange {
    constexpr int* begin() const { return nullptr; }
    constexpr int* end() const { return nullptr; }
};

template &lt;&gt;
constexpr bool std::ranges::disable_sized_range&lt;myrange&gt; = true;

static_assert(std::ranges::range&lt;myrange&gt;);
static_assert(!std::ranges::sized_range&lt;myrange&gt;);
static_assert(std::ranges::size(myrange{}) == 0);
</pre></blockquote>
We should remove this gap between <tt>ranges::size</tt> and <tt>sized_range</tt> by checking
<tt>disable_sized_range</tt> only in the definition of <tt>ranges::size</tt>, and continuing to rely
on the validity of <tt>ranges::size</tt> in the <tt>sized_range</tt> concept.
</p>

<p><i>[2019-09-14 Priority set to 1 based on reflector discussion]</i></p>

<p><i>[2019-11 Wednesday night issue processing in Belfast.]</i></p>

<p>Status to Ready</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a> as follows:</p>

<blockquote><pre>
template&lt;class T&gt;
  concept sized_range =
    range&lt;T&gt; &amp;&amp;
    <del>!disable_sized_range&lt;remove_cvref_t&lt;T&gt;&gt; &amp;&amp;</del>
    requires(T&amp; t) { ranges::size(t); };
</pre></blockquote>
</li>
</ol>





<hr>
<h3><a name="3265" href="3265">3265.</a> <tt>move_iterator</tt>'s conversions are more broken after P1207</h3>
<p><b>Section:</b> 23.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/move.iter.cons">[move.iter.cons]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-08-23 <b>Last modified:</b> 2019-09-14 17:05:44 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The converting constructor and assignment operator specified in 23.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/move.iter.cons">[move.iter.cons]</a> 
were technically broken before P1207:
</p>
<ul>
<li><p>23.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/move.iter.cons">[move.iter.cons]</a> para 3 (and 5 for that matter) is an instance of LWG 
<a href="3105">3105</a>; it should instead mandate that <tt>u.base()</tt> is convertible to <tt>Iterator</tt>.</p></li>
<li><p>23.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/move.iter.cons">[move.iter.cons]</a> para 5 uses "is convertible" to guard an assignment operation 
instead of a conversion; it should instead mandate.</p></li>
</ul>
<p>
After applying <a href="http://wg21.link/p1207r4">P1207R4</a> "Movability of Single-pass Iterators", 
<tt>u.base()</tt> is not always well-formed, exacerbating the problem. These operations must ensure 
that <tt>u.base()</tt> is well-formed.
<p/>
Drive-by:
</p>
<ul>
<li><p>Let's burninate "Constructs a <tt>move_iterator</tt>" while we're touching this subclause.</p></li>
<li><p>We'll also burninate "Iterator operations applied..." since the requirement it wants to impose 
is covered (and indeed must be covered) by the specifications of those other operations.</p></li>
</ul>

<p><i>[2019-09-14 Priority set to 2 based on reflector discussion]</i></p>




<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 23.5.3.3 <a href="https://timsong-cpp.github.io/cppwp/move.iter.cons">[move.iter.cons]</a> as indicated:</p>

<blockquote>
<pre>
constexpr move_iterator();
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> <del>Constructs a <tt>move_iterator</tt>, 
v</del><ins>V</ins>alue-initializ<ins>es</ins><del>ing</del> <tt>current</tt>. <del>Iterator operations applied to the
resulting iterator have defined behavior if and only if the corresponding operations are defined on a
value-initialized iterator of type <tt>Iterator</tt>.</del>
</p>
</blockquote>
<pre>
constexpr explicit move_iterator(Iterator i);
</pre>
<blockquote>
<p>
-2- <i>Effects:</i> <del>Constructs a move_iterator, i</del><ins>I</ins>nitializ<ins>es</ins><del>ing</del> 
<tt>current</tt> with <tt>std::move(i)</tt>.
</p>
</blockquote>
<pre>
template&lt;class U&gt; constexpr move_iterator(const move_iterator&lt;U&gt;&amp; u);
</pre>
<blockquote>
<p>
-3- <i>Mandates:</i> <tt><del>U</del><ins>u.base()</ins></tt> is <ins>well-formed and</ins> convertible 
to <tt>Iterator</tt>.
<p/>
-4- <i>Effects:</i> <del>Constructs a <tt>move_iterator</tt>, i</del><ins>I</ins>nitializ<ins>es</ins><del>ing</del> 
<tt>current</tt> with <tt>u.base()</tt>.
</p>
</blockquote>
<pre>
template&lt;class U&gt; constexpr move_iterator&amp; operator=(const move_iterator&lt;U&gt;&amp; u);
</pre>
<blockquote>
<p>
-5- <i>Mandates:</i> <del><tt>U</tt> is convertible to <tt>Iterator</tt></del><ins><tt>u.base()</tt> is 
well-formed and <tt>is_assignable_v&lt;Iterator&amp;, const U&amp;&gt;</tt> is <tt>true</tt></ins>.
<p/>
-6- <i>Effects:</i> Assigns <tt>u.base()</tt> to <tt>current</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3267" href="3267">3267.</a> Rebound allocators and <tt>is_always_equal</tt></h3>
<p><b>Section:</b> 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> FrankHB1989 <b>Opened:</b> 2019-08-27 <b>Last modified:</b> 2019-10-07 02:21:30 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.requirements">active issues</a> in [allocator.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.requirements">issues</a> in [allocator.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[allocator.requirements] does not mention the interaction between <tt>is_always_equal</tt> 
and allocator rebinding. As the result, a rebound allocator may have different 
<tt>is_always_equal::value</tt> to the original allocator.
<p/>
Further, for an allocator type <tt>X</tt> satisfying 
<tt>std::allocator_type&lt;X&gt;::is_always_equal::value == true</tt>, rebound allocators 
of <tt>X</tt> with same type are not guaranteed equal.
<p/>
Consider:
</p>
<ol>
<li><p><tt>X</tt> is used as an allocator for <tt>value_type</tt> used in a node-based container;</p></li>
<li><p><tt>Y</tt> is the rebound allocator type for the node type used in the implementation;</p></li>
<li><p><tt>b1</tt> and <tt>b2</tt> are values of <tt>Y</tt> from different allocator objects.</p></li>
</ol>
<p>
Then, <tt>std::allocator_type&lt;X&gt;::is_always_equal::value == true</tt> does not necessarily 
imply <tt>b1 == b2</tt>.
<p/>
Since some of containers in the standard have already explicitly relied on <tt>is_always_equal</tt> 
of allocators for their <tt>value_type</tt> (notably, in the exception specification of the move 
assignment), this can cause subtle problems.
<p/>
In general, the implementation of the move assignment operator of such a container can not avoid 
allocation for new nodes when <tt>!std::allocator_traits&lt;Y&gt;::propagate_on_container_move_assignment::value 
&amp;&amp; b1 != b2</tt>. This can throw, and it can clash with the required exception specification 
based on <tt>std::allocator_traits&lt;value_type&gt;::is_always_equal</tt>:
</p>
<blockquote><pre>
#include &lt;utility&gt;
#include &lt;memory&gt;
#include &lt;new&gt;
#include &lt;map&gt;
#include &lt;functional&gt; 
#include &lt;type_traits&gt; 

using K = int;
using V = int;
using P = std::pair&lt;const K, V&gt;; 

bool stop_alloc; 

template&lt;typename T&gt;
struct AT
{
  using value_type = T; 

  std::shared_ptr&lt;void&gt; sp = {}; 

  template&lt;typename U&gt;
  struct rebind
  {
    using other = AT&lt;U&gt;;
  }; 

  using is_always_equal = std::is_same&lt;T, P&gt;; 

  AT() : sp(is_always_equal::value ? nullptr : new T*()) {}

  AT(const AT&amp; a) = default;

  template&lt;typename U&gt;
  AT(const AT&lt;U>&amp; a) noexcept : sp(a.sp) {} 

  T* allocate(std::size_t size)
  {
    if (stop_alloc)
      throw std::bad_alloc();
    return static_cast&lt;T*&gt;(::operator new(size * sizeof(T)));
  } 

  void deallocate(T* p, std::size_t)
  {
    ::operator delete(p);
  }

  friend bool operator==(const AT&amp; x, const AT&amp; y) noexcept
  {
    return !x.sp.owner_before(y.sp) &amp;&amp; !y.sp.owner_before(x.sp);
  } 

  friend bool operator!=(const AT&amp; x, const AT&amp; y) noexcept 
  {
    return !(x == y);
  }

};

using A = AT&lt;P&gt;; 

int main()
{
  // Some sanity checks:
  static_assert(std::is_same_v&lt;A::template rebind&lt;A::value_type&gt;::other, A&gt;);
  // For any U:
  using U = int;
  static_assert(std::is_same_v&lt;A::template rebind&lt;U&gt;::other::template rebind&lt;A::value_type&gt;::other, A&gt;); 

  using C = std::less&lt;&gt;;
  using M = std::map&lt;K, V, C, A&gt;; 

  // As required by the current wording of the container move operator:
  using always_equal = std::allocator_traits&lt;A&gt;::is_always_equal;
  constexpr bool std_nothrow = always_equal::value &amp;&amp; std::is_nothrow_move_assignable_v&lt;C&gt;;
  static_assert(std_nothrow);

  // For conforming implementations:
  // static_assert(!(std_nothrow &amp;&amp; !std::is_nothrow_move_assignable&lt;M&gt;::value)); 

  M m{{K(), V()}}, m2;
  auto a = m.get_allocator(); 

  a.sp = std::make_shared&lt;int&gt;(42);
  stop_alloc = true;

  try
  {
    // Call terminate with conforming implementations. This does not work on libstdc++.
    m2 = std::move(m);
    // For libstdc++, terminate on allocator-extended move constructor call.
    //    M m3(std::move(m), a);
  }
  catch(...)
  {}
}
</pre></blockquote>

<p><i>[2019-10 Priority set to 4 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> Additional questions: Is it necessary to ensure that<br/>
<tt>XX::propagate_on_container_copy_assignment::value == YY::propagate_on_container_copy_assignment::value</tt>
is <tt>true</tt> as well?]
</p>
</blockquote>

<ol>
<li><p>Modify 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table [tab:cpp17.allocator] 
"<tt><i>Cpp17Allocator</i></tt> requirements" as indicated:</p>
<blockquote>
<table border="1">
<caption>Table 34 &mdash; <tt><i>Cpp17Allocator</i></tt> requirements [tab:cpp17.allocator]</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>typename<br/>
X::template<br/>
rebind&lt;U&gt;::other</tt>
</td>
<td>
<tt>Y</tt>
</td>
<td>
For all <tt>U</tt> (including <tt>T</tt>),<br/>
<tt>Y::template<br/>
rebind&lt;T&gt;::other</tt> is <tt>X</tt>.<br/>
<ins><tt>XX::is_always_equal::value == YY::is_always_equal::value</tt><br/>
is <tt>true</tt>.</ins>
</td>
<td>
See Note A,<br/>
below.
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3268" href="3268">3268.</a> <tt>memory_order::memory_order_foo</tt> broken in C++20</h3>
<p><b>Section:</b> 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Eric Fiselier <b>Opened:</b> 2019-08-31 <b>Last modified:</b> 2019-10-07 02:21:30 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#atomics.order">active issues</a> in [atomics.order].</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.order">issues</a> in [atomics.order].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/p0439r0">P0439R0</a> renamed the <tt>std::memory_order</tt> enumerators 
when making it a scoped enumeration. The paper makes the old unscoped names available in the 
global namespace, but not within the scope of the enumeration.
<p/>
For example:
<p/>
<tt>std::memory_order::memory_order_consume</tt> is no longer well-formed but 
<tt>std::memory_order::consume</tt> and <tt>std::memory_order_consume</tt> are.
<p/>
In order to prevent unnecessary breakage, we should re-add the <tt>memory_order_foo</tt> names 
to the enumeration.
</p>
<p><i>[2019-10 Priority set to 4 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Add a new sub-clause at the end of Clause D <a href="https://timsong-cpp.github.io/cppwp/depr">[depr]</a> as indicated:</p>

<blockquote>
<p>
<ins><b>D.?? Deprecated <tt>memory_order</tt> enumerators</b></ins>
<p/>
<ins>-?- The following enumerators are declared in addition to those specified in 31.4 <a href="https://timsong-cpp.github.io/cppwp/atomics.order">[atomics.order]</a>:</ins>
</p>
<blockquote>
<pre>
<ins>namespace std {
  enum class memory_order : <i>unspecified</i> {
    memory_order_relaxed = relaxed, memory_order_consume = consume, memory_order_acquire = acquire, 
    memory_order_release = release, memory_order_acq_rel = acq_rel, memory_order_seq_cst = seq_cst
  };
}</ins>
</pre>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3269" href="3269">3269.</a> Parse manipulators do not specify the result of the extraction from stream</h3>
<p><b>Section:</b> 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tomasz Kami&nacute;ski <b>Opened:</b> 2019-09-01 <b>Last modified:</b> 2020-02-13 17:56:25 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.parse">active issues</a> in [time.parse].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.parse">issues</a> in [time.parse].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
None of the <tt>parse</tt> manipulators for the <tt>chrono</tt> types
specifies the result of the extraction from the stream, as consequence 
they cannot be chained with the other read operations (at least portably). 
For example the following code is not required to work:
</p>
<blockquote>
<pre>
std::chrono::sys_stime s; 
int x;
std::cin &gt;&gt; std::chrono::parse("%X", s) &gt;&gt; x;
</pre>
</blockquote>

<p><i>[2019-10 Priority set to 2 after reflector discussion]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> As a drive-by fix the <i>Remarks</i> element is also 
converted to a <i>Constraints</i> element. The wording integrates the resolution for 
LWG <a href="3235">3235</a>.
</p>
</blockquote>

<ol>
<li><p>Modify 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> as indicated:</p>

<blockquote>
<p>
-1- Each parse overload specified in this subclause calls <tt>from_stream</tt> unqualified, 
so as to enable argument dependent lookup (6.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.lookup.argdep">[basic.lookup.argdep]</a>). 
<ins>In the following paragraphs, let <tt>is</tt> denote an object of type 
<tt>basic_istream&lt;charT, traits&gt;</tt> and let <tt>I</tt> be
<tt>basic_istream&lt;charT, traits&gt;&amp;</tt>, where <tt>charT</tt> and
<tt>traits</tt> are template parameters in that context.</ins>
</p>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable&gt;
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp);
</pre>
<blockquote>
<p>
-2- <i><del>Remarks</del><ins>Constraints</ins>:</i> <del>This function shall not participate in 
overload resolution unless</del><ins>The expression</ins>
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(), fmt.c_str(), tp)
</pre></blockquote>
is <del>a valid expression</del><ins>well-formed when treated as an unevaluated operand</ins>.
<p/>
-3- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression
<tt>is &gt;&gt; parse(fmt, tp)</tt> has type <tt>I</tt>, value <tt>is</tt>, 
and</ins> calls <tt>from_stream(is, fmt.c_str(), tp)</tt>.
</p>
</blockquote>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable&gt;
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp,
          basic_string&lt;charT, traits, Alloc&gt;&amp; abbrev);
</pre>
<blockquote>
<p>
-4- <i><del>Remarks</del><ins>Constraints</ins>:</i> <del>This function shall not participate 
in overload resolution unless</del><ins>The expression</ins>
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(), fmt.c_str(), tp, addressof(abbrev))
</pre></blockquote>
is <del>a valid expression</del><ins>well-formed when treated as an unevaluated operand</ins>.
<p/>
-5- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression <tt>is &gt;&gt; 
parse(fmt, tp, abbrev)</tt> has type <tt>I</tt>, value <tt>is</tt>, and</ins> calls 
<tt>from_stream(is, fmt.c_str(), tp, addressof(abbrev))</tt>.
</p>
</blockquote>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable&gt;
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp,
          minutes&amp; offset);
</pre>
<blockquote>
<p>
-6- <i><del>Remarks</del><ins>Constraints</ins>:</i> <del>This function shall not participate 
in overload resolution unless</del><ins>The expression</ins>
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(), fmt.c_str(), tp, 
            <ins>declval&lt;basic_string&lt;charT, traits, Alloc&gt;*&gt;()</ins><del>nullptr</del>, &amp;offset)
</pre></blockquote>
is <del>a valid expression</del><ins>well-formed when treated as an unevaluated operand</ins>.
<p/>
-7- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression <tt>is &gt;&gt; 
parse(fmt, tp, offset)</tt> has type <tt>I</tt>, value <tt>is</tt>, and</ins> 
calls <tt>from_stream(is, fmt.c_str(), tp, <ins>static_cast&lt;basic_string&lt;charT, 
traits, Alloc&gt;*&gt;(</ins>nullptr<ins>)</ins>, &amp;offset)</tt>.
</p>
</blockquote>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable>
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp,
          basic_string&lt;charT, traits, Alloc&gt;&amp; abbrev, minutes&amp; offset);
</pre>
<blockquote>
<p>
-8- <i><del>Remarks</del><ins>Constraints</ins>:</i> <del>This function shall not participate 
in overload resolution unless</del><ins>The expression</ins>
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(),
            fmt.c_str(), tp, addressof(abbrev), &amp;offset)
</pre></blockquote>
is <del>a valid expression</del><ins>well-formed when treated as an unevaluated operand</ins>.
<p/>
-9- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression <tt>is &gt;&gt; 
parse(fmt, tp, abbrev, offset)</tt> has type <tt>I</tt>, value <tt>is</tt>, 
and</ins> calls <tt>from_stream(is, fmt.c_str(), tp, addressof(abbrev), &amp;offset)</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Issue wording has been rebased.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> as indicated:</p>

<blockquote>
<p>
-1- Each <tt>parse</tt> overload specified in this subclause calls <tt>from_stream</tt> unqualified, 
so as to enable argument dependent lookup (6.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.lookup.argdep">[basic.lookup.argdep]</a>). In the following paragraphs, 
let <tt>is</tt> denote an object of type <tt>basic_istream&lt;charT, traits&gt;</tt> <ins>and let <tt>I</tt> be 
<tt>basic_istream&lt;charT, traits&gt;&amp;</tt></ins>, where <tt>charT</tt> and <tt>traits</tt> are 
template parameters in that context.
</p>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable&gt;
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp);
</pre>
<blockquote>
<p>
-2- <i>Constraints:</i> <ins>The expression</ins>
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(), fmt.c_str(), tp)
</pre></blockquote>
is <del>a valid expression</del><ins>well-formed when treated as an unevaluated operand</ins>.
<p/>
-3- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression
<tt>is &gt;&gt; parse(fmt, tp)</tt> has type <tt>I</tt>, value <tt>is</tt>, 
and</ins> calls <tt>from_stream(is, fmt.c_str(), tp)</tt>.
</p>
</blockquote>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable&gt;
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp,
          basic_string&lt;charT, traits, Alloc&gt;&amp; abbrev);
</pre>
<blockquote>
<p>
-4- <i>Constraints:</i> <ins>The expression</ins>
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(), fmt.c_str(), tp, addressof(abbrev))
</pre></blockquote>
is <del>a valid expression</del><ins>well-formed when treated as an unevaluated operand</ins>.
<p/>
-5- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression <tt>is &gt;&gt; 
parse(fmt, tp, abbrev)</tt> has type <tt>I</tt>, value <tt>is</tt>, and</ins> calls 
<tt>from_stream(is, fmt.c_str(), tp, addressof(abbrev))</tt>.
</p>
</blockquote>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable&gt;
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp,
          minutes&amp; offset);
</pre>
<blockquote>
<p>
-6- <i>Constraints:</i> The expression
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(), 
            fmt.c_str(), tp, 
            declval&lt;basic_string&lt;charT, traits, Alloc&gt;*&gt;(), 
            &amp;offset)
</pre></blockquote>
is well-formed when treated as an unevaluated operand.
<p/>
-7- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression <tt>is &gt;&gt; 
parse(fmt, tp, offset)</tt> has type <tt>I</tt>, value <tt>is</tt>, and</ins> 
calls
</p>
<blockquote><pre>
from_stream(is, 
            fmt.c_str(), tp, 
            static_cast&lt;basic_string&lt;charT, traits, Alloc&gt;*&gt;(nullptr), 
            &amp;offset)
</pre></blockquote>
</blockquote>
<pre>
template&lt;class charT, class traits, class Alloc, class Parsable>
  <i>unspecified</i>
    parse(const basic_string&lt;charT, traits, Alloc&gt;&amp; fmt, Parsable&amp; tp,
          basic_string&lt;charT, traits, Alloc&gt;&amp; abbrev, minutes&amp; offset);
</pre>
<blockquote>
<p>
-8- <i>Constraints:</i> <ins>The expression</ins>
<blockquote><pre>
from_stream(declval&lt;basic_istream&lt;charT, traits&gt;&amp;&gt;(),
            fmt.c_str(), tp, addressof(abbrev), &amp;offset)
</pre></blockquote>
is <del>a valid expression</del><ins>well-formed when treated as an unevaluated operand</ins>.
<p/>
-9- <i>Returns:</i> A manipulator <ins>such</ins> that<del>, when extracted from a 
<tt>basic_istream&lt;charT, traits&gt; is</tt>,</del><ins>the expression <tt>is &gt;&gt; 
parse(fmt, tp, abbrev, offset)</tt> has type <tt>I</tt>, value <tt>is</tt>, 
and</ins> calls <tt>from_stream(is, fmt.c_str(), tp, addressof(abbrev), &amp;offset)</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3270" href="3270">3270.</a> Parsing and formatting <tt>%j</tt> with <tt>duration</tt>s</h3>
<p><b>Section:</b> 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a>, 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Howard Hinnant <b>Opened:</b> 2019-09-02 <b>Last modified:</b> 2020-02-14 07:30:42 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.format">active issues</a> in [time.format].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.format">issues</a> in [time.format].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>%j</tt> represents the day number of the year when formatting and parsing <tt>time_point</tt>s. 
It is also handy to interpret this flag consistently when formatting and parsing durations. That 
is if there is not enough information in the stream to represent a <tt>time_point</tt>, and if the 
target of the format/parse is a <tt>duration</tt>, <tt>%j</tt> represents a number of days.
</p>
<blockquote>
<pre>
#include &lt;chrono&gt;
#include &lt;iostream&gt;
#include &lt;sstream&gt;
#include &lt;string&gt;

int main()
{
  using namespace std;
  using namespace std::chrono;
  <i>// Parse %j as number of days into a duration</i>
  istringstream in{"222"};
  hours d;
  in &gt;&gt; parse("%j", d);
  cout &lt;&lt; d &lt;&lt; '\n';
  cout &lt;&lt; format("{:%j}", d) &lt;&lt; '\n';
}
</pre>
</blockquote>
<p>
Output:
</p>
<blockquote>
<pre>
5328h
222
</pre>
</blockquote>
<p><i>[2019-10 Priority set to 2 after reflector discussion]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify "Table 98 &mdash; Meaning of conversion specifiers"
 [tab:time.format.spec] as indicated:</p>

<blockquote>

<table border="1">
<caption>Table 98 &mdash; Meaning of conversion specifiers  [tab:time.format.spec]</caption>
<tr style="text-align:center">
<th>Specifier</th>
<th>Replacement</th>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td><tt>%j</tt></td>
<td>The day of the year as a decimal number. Jan 1 is <tt>001</tt>. If the result is less than three<br/>
digits, it is left-padded with <tt>0</tt> to three digits. <ins>If the type being formatted is a<br/> 
specialization of <tt>duration</tt>, it is formatted as a decimal number of <tt>days</tt>.</ins></td>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>

</blockquote>

</li>

<li><p>Modify "Table 99 &mdash; Meaning of <tt>parse</tt> flags"
 [tab:time.parse.spec] as indicated:</p>

<blockquote>

<table border="1">
<caption>Table 99 &mdash; Meaning of <tt>parse</tt> flags  [tab:time.parse.spec]</caption>
<tr style="text-align:center">
<th>Flag</th>
<th>Parsed value</th>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td><tt>%j</tt></td>
<td>The day of the year as a decimal number. Jan 1 is <tt>1</tt>. The modified command <tt>%<i>N</i>j</tt><br/>
specifies the maximum number of characters to read. If <tt><i>N</i></tt> is not specified, the default<br/>
is <tt>3</tt>. Leading zeroes are permitted but not required. <ins>If the type being parsed is a<br/> 
specialization of <tt>duration</tt>, it is parsed as a decimal number of <tt>days</tt>.</ins></td>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>

</blockquote>

</li>
</ol></blockquote>

<p><i>[2020-02-13 After Thursday afternoon discussion in Prague, Marshall provides updated wording.]</i></p>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify "Table 98 &mdash; Meaning of conversion specifiers"
 [tab:time.format.spec] as indicated:</p>

<blockquote>

<table border="1">
<caption>Table 98 &mdash; Meaning of conversion specifiers  [tab:time.format.spec]</caption>
<tr style="text-align:center">
<th>Specifier</th>
<th>Replacement</th>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td><tt>%j</tt></td>
<td><ins>If the type being formatted is a specialization of <tt>duration</tt>, 
the decimal number of <tt>days</tt><br/>without padding. Otherwise, the</ins><del>The</del> 
day of the year as a decimal number.<br/>Jan 1 is <tt>001</tt>. If the result 
is less than three digits, it is left-padded with <tt>0</tt> to three digits. </td>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>

</blockquote>

</li>

<li><p>Modify "Table 99 &mdash; Meaning of <tt>parse</tt> flags"
 [tab:time.parse.spec] as indicated:</p>

<blockquote>

<table border="1">
<caption>Table 99 &mdash; Meaning of <tt>parse</tt> flags  [tab:time.parse.spec]</caption>
<tr style="text-align:center">
<th>Flag</th>
<th>Parsed value</th>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td><tt>%j</tt></td>
<td><ins>If the type being parsed is a specialization of <tt>duration</tt>,<br/>
a decimal number of <tt>days</tt>. Otherwise, the</ins><del>The</del> 
day of the year as a decimal number. Jan 1 is <tt>1</tt>.<br/>
<ins>In either case, the</ins><del>The</del> modified command <tt>%<i>N</i>j</tt> specifies the maximum number of characters to read.<br/>
If <tt><i>N</i></tt> is not specified, the default is <tt>3</tt>. Leading zeroes are permitted but not required.</td>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>

</blockquote>

</li>
</ol>





<hr>
<h3><a name="3271" href="3271">3271.</a> Parsing functions should save and restore stream format state</h3>
<p><b>Section:</b> 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Howard Hinnant <b>Opened:</b> 2019-09-02 <b>Last modified:</b> 2019-10-07 02:21:30 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.parse">active issues</a> in [time.parse].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.parse">issues</a> in [time.parse].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>from_stream</tt> overloads may need to set various formatting state and flags of the <tt>basic_istream</tt> 
to implement the parsing functionality. Such settings must not persist beyond the parsing functions. Thus 
these functions need to save and restore any settings on the <tt>basic_istream</tt> they may need to change.
</p>

<p><i>[2019-10 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The modification of 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> p1 is intended to be non-conflictingly 
mergeable with the change suggested by LWG <a href="3269">3269</a> at the same paragraph.]
</p>
</blockquote>

<ol>
<li><p>Modify 27.13 <a href="https://timsong-cpp.github.io/cppwp/time.parse">[time.parse]</a> as indicated:</p>

<blockquote>
<p> 
-1- Each parse overload specified in this subclause calls <tt>from_stream</tt> unqualified, 
so as to enable argument dependent lookup (6.5.2 <a href="https://timsong-cpp.github.io/cppwp/basic.lookup.argdep">[basic.lookup.argdep]</a>).
<ins>In the following paragraphs, let <tt>is</tt> denote an object of type 
<tt>basic_istream&lt;charT, traits&gt;</tt>, where <tt>charT</tt> and
<tt>traits</tt> are template parameters in that context.</ins>
<p/>
[&hellip;]
<p/>
-10- All <tt>from_stream</tt> overloads behave as unformatted input functions, except that they have an 
unspecified effect on the value returned by subsequent calls to <tt>basic_istream&lt;&gt;::gcount()</tt>.
<ins>Any changes made to <tt>is.fill()</tt>, <tt>is.width()</tt> or <tt>is.flags()</tt> are undone 
prior to an returning or exceptional execution ([thread.once.callonce]).</ins> 
Each overload takes a format string containing ordinary characters and flags which have special meaning. 
Each flag begins with a <tt>%</tt>. Some flags can be modified by <tt>E</tt> or <tt>O</tt>. During parsing 
each flag interprets characters as parts of date and time types according to Table [tab:time.parse.spec]. 
Some flags can be modified by a width parameter given as a positive decimal integer called out as 
<tt><i>N</i></tt> below which governs how many characters are parsed from the stream in interpreting the 
flag. All characters in the format string that are not represented in Table [tab:time.parse.spec], except 
for white space, are parsed unchanged from the stream. A white space character matches zero or more white
space characters in the input stream.
</p>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3275" href="3275">3275.</a> Why does <tt>time_get::do_get</tt> require a valid pointer when none of the others do?</h3>
<p><b>Section:</b> 28.4.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get.virtuals">[locale.time.get.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marshall Clow <b>Opened:</b> 2019-09-09 <b>Last modified:</b> 2019-10-07 02:21:30 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#locale.time.get.virtuals">active issues</a> in [locale.time.get.virtuals].</p>
<p><b>View all other</b> <a href="lwg-index.html#locale.time.get.virtuals">issues</a> in [locale.time.get.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
According to 28.4.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get.virtuals">[locale.time.get.virtuals]</a> p11:
</p>
<blockquote><p>
<i>Requires:</i> <tt>t</tt> shall point to an object
</p></blockquote>
<p>
[Note: In my "Mandates" paper, I changed this to "<i>Expects:</i> <tt>t</tt> points to an object"]
<p/>
Nevertheless, it's odd, and inconsistent. <tt>time_get::get</tt> does not have any such stated requirement, 
and it calls <tt>do_get</tt>. None of the other "time" calls in <tt>time_get</tt> have such a (stated) 
requirement.
<p/>
I believe that this requirement is redundant, that it is implied by the wording in P12 and P14.
<p/>
P12: "or until it has extracted and assigned those <tt>struct tm</tt> members"
<p/>
P14: "It is unspecified whether multiple calls to <tt>do_get()</tt> with the address of the same 
<tt>struct tm</tt> object will update the current contents of the object or simply overwrite its members."
<p/>
If the pointer is invalid (null, or points to unmapped memory, say), you've got UB anyway.
<p/>
All the other calls in [locale.time.get.virtuals] were from C++98. <tt>do_get_time</tt> was added in C++11, 
and p11 originally said "<tt>t</tt> shall be dereferenceable". 
<p/>
This was changed to "<tt>t</tt> shall point to an object" as part of the resolution of CWG issue 
<a href="https://wg21.link/cwg342">342</a>
</p>

<p><i>[2019-10 Priority set to 3 after reflector discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 28.4.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.time.get.virtuals">[locale.time.get.virtuals]</a> as indicated:</p>

<blockquote>
<pre>
iter_type do_get(iter_type s, iter_type end, ios_base&amp; f,
                 ios_base::iostate&amp; err, tm* t, char format, char modifier) const;
</pre>
<blockquote>
<p>
<del>-11- <i>Requires:</i> <tt>t</tt> shall point to an object.</del>
<p/>
-12- <i>Effects:</i> [&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3278" href="3278">3278.</a> <tt>join_view&lt;V&gt;::iterator&lt;true&gt;</tt> tries to write through <tt>const join_view</tt> ptr</h3>
<p><b>Section:</b> 24.7.10.2 <a href="https://timsong-cpp.github.io/cppwp/range.join.view">[range.join.view]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-09 <b>Last modified:</b> 2020-02-10 14:07:48 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.join.view">active issues</a> in [range.join.view].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.join.view">issues</a> in [range.join.view].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The non-<tt>const</tt> <tt>join_view::begin()</tt> returns <tt>iterator&lt;<i>simple-view</i>&lt;V&gt;&gt;</tt>. 
If <tt><i>simple-view</i>&lt;V&gt;</tt> is <tt>true</tt>, then the iterator stores a <tt>const join_view*</tt> 
named <tt>parent_</tt>. <tt>iterator::satisfy()</tt> will try to write to <tt>parent_-&gt;inner_</tt> if 
<tt>ref_is_glvalue</tt> is <tt>false</tt>. That doesn't work because the <tt>inner_</tt> field is not marked 
mutable.
</p>
<p><i>[2019-10 Priority set to 2 after reflector discussion]</i></p>


<p><i>[2020-02-10, Prague]</i></p>

<p>
Would be resolved by <a href="http://wg21.link/p1983r0">P1983R0</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.7.10.2 <a href="https://timsong-cpp.github.io/cppwp/range.join.view">[range.join.view]</a>, class <tt>template join_view</tt> synopsis, as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> Changing the <tt>join_view&lt;V&gt;::inner_</tt> member to be mutable is safe 
because this exposition-only member is only used when the <tt>join_view</tt> is single-pass and 
only modified by operations that invalidate other iterators]
</p>
</blockquote>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;input_range V&gt;
    requires view&lt;V&gt; &amp;&amp; input_range&lt;range_reference_t&lt;V&gt;&gt;&gt; &amp;&amp;
            (is_reference_v&lt;range_reference_t&lt;V&gt;&gt; ||
            view&lt;range_value_t&lt;V&gt;&gt;)
  class join_view : public view_interface&lt;join_view&lt;V&gt;&gt; {
  private:
    [&hellip;]
    V base_ = V(); <i>// exposition only</i>
    <ins>mutable</ins> all_view&lt;InnerRng&gt; inner_ = <i>// exposition only, present only when</i> 
                                        <ins><i>//</i></ins> !is_reference_v&lt;InnerRng&gt;
      all_view&lt;InnerRng&gt;();
  public:
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3280" href="3280">3280.</a> View converting constructors can cause constraint recursion and are unneeded</h3>
<p><b>Section:</b> 24.7.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.filter.view">[range.filter.view]</a>, 24.7.5.2 <a href="https://timsong-cpp.github.io/cppwp/range.transform.view">[range.transform.view]</a>, 24.7.6.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.view">[range.take.view]</a>, 24.7.10.2 <a href="https://timsong-cpp.github.io/cppwp/range.join.view">[range.join.view]</a>, 24.7.11.2 <a href="https://timsong-cpp.github.io/cppwp/range.split.view">[range.split.view]</a>, 24.7.14.2 <a href="https://timsong-cpp.github.io/cppwp/range.reverse.view">[range.reverse.view]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-09 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The following program fails to compile:
</p>
<blockquote><pre>
#include &lt;ranges&gt;

int main() {
  namespace ranges = std::ranges;
  int a[] = {1, 7, 3, 6, 5, 2, 4, 8};
  auto r0 = ranges::view::reverse(a);
  auto is_even = [](int i) { return i % 2 == 0; };
  auto r1 = ranges::view::filter(r0, is_even);
  int sum = 0;
  for (auto i : r1) {
    sum += i;
  }
  return sum - 20;
}
</pre></blockquote>
<p>
The problem comes from constraint recursion, caused by the following constructor:
</p>
<blockquote><pre>
template&lt;viewable_range R&gt;
  requires bidirectional_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr explicit reverse_view(R&amp;&amp; r);
</pre></blockquote>
<p>
This constructor owes its existence to class template argument deduction; it is the constructor 
we intend to use to resolve <tt>reverse_view{r}</tt>, which (in accordance to the deduction guide) 
will construct an object of type <tt>reverse_view&lt;all_view&lt;decltype(r)&gt;&gt;</tt>.
<p/>
However, we note that <tt>all_view&lt;R&gt;</tt> is always one of:
</p>
<ul>
<li><p><tt>decay_t&lt;R&gt;</tt></p></li>
<li><p><tt>ref_view&lt;remove_reference_t&lt;R&gt;&gt;</tt></p></li>
<li><p><tt>subrange&lt;iterator_t&lt;R&gt;, sentinel_t&lt;R&gt;, [sized?]&gt;</tt></p></li>
</ul>
<p>
In all cases, there is a conversion from <tt>r</tt> to the destination type. As a result, the 
following non-template <tt>reverse_view</tt> constructor can fulfill the duty that the above 
constructor was meant to fulfill, and does <em>not</em> cause constraint recursion:
</p>
<blockquote><pre>
constexpr explicit reverse_view(V r);
</pre></blockquote>
<p>
In short, the problematic constructor can simply be removed with no negative impact on the design. 
And the similar constructors from the other range adaptors should similarly be stricken.
<p/>
Suggested priority P1. The view types are unusable without this change.
<p/>
This proposed resolution has been implemented in range-v3 and has been shipping for some time.
</p>

<p><i>[2019-10 Priority set to 1 after reflector discussion]</i></p>

<p><i>[2019-10 Status set to ready Wednesday night discussion in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.7.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.filter.view">[range.filter.view]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;input_range V, indirect_unary_predicate&lt;iterator_t&lt;V&gt;&gt; Pred&gt;
    requires view&lt;V&gt; &amp;&amp; is_object_v&lt;Pred&gt;
  class filter_view : public view_interface&lt;filter_view&lt;V, Pred&gt;&gt; {
  [&hellip;]
  public:
    filter_view() = default;
    constexpr filter_view(V base, Pred pred);
    <del>template&lt;input_range R&gt;
      requires viewable_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
    constexpr filter_view(R&amp;&amp; r, Pred pred);</del>
    [&hellip;]
  };
  [&hellip;]
}
</pre>
[&hellip;]
<pre>
<del>template&lt;input_range R&gt;
  requires viewable_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr filter_view(R&amp;&amp; r, Pred pred);</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Effects:</i> Initializes <tt>base_</tt> with <tt>views::all(std::forward&lt;R&gt;(r))</tt> 
and initializes <tt>pred_</tt> with <tt>std::move(pred)</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.7.5.2 <a href="https://timsong-cpp.github.io/cppwp/range.transform.view">[range.transform.view]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;input_range V, copy_constructible F&gt;
    requires view&lt;V&gt; &amp;&amp; is_object_v&lt;F&gt; &amp;&amp;
    regular_invocable&lt;F&amp;, range_reference_t&lt;V&gt;&gt;
  class transform_view : public view_interface&lt;transform_view&lt;V, F&gt;&gt; {
  private:
    [&hellip;]
  public:
    transform_view() = default;
    constexpr transform_view(V base, F fun);
    <del>template&lt;input_range R&gt;
      requires viewable_range&lt;R> &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
    constexpr transform_view(R&amp;&amp; r, F fun);</del>
    [&hellip;]
  };
  [&hellip;]
}
</pre>
[&hellip;]
<pre>
<del>template&lt;input_range R&gt;
  requires viewable_range&lt;R> &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr transform_view(R&amp;&amp; r, F fun);</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Effects:</i> Initializes <tt>base_</tt> with <tt>views::all(std::forward&lt;R&gt;(r))</tt> 
and <tt>fun_</tt> with <tt>std::move(fun)</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.7.6.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.view">[range.take.view]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;view V&gt;
  class take_view : public view_interface&lt;take_view&lt;V&gt;&gt; {
  private:
    [&hellip;]
  public:
    take_view() = default;
    constexpr take_view(V base, range_difference_t&lt;V&gt; count);
    <del>template&lt;viewable_range R&gt;
      requires constructible_from&lt;V, all_view&lt;R&gt;&gt;
    constexpr take_view(R&amp;&amp; r, range_difference_t&lt;V&gt; count);</del>
    [&hellip;]
  };
[&hellip;]
}
</pre>
[&hellip;]
<pre>
<del>template&lt;viewable_range R&gt;
  requires constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr take_view(R&amp;&amp; r, range_difference_t&lt;V&gt; count);</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Effects:</i> Initializes <tt>base_</tt> with <tt>views::all(std::forward&lt;R&gt;(r))</tt> 
and <tt>count_</tt> with <tt>count</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.7.10.2 <a href="https://timsong-cpp.github.io/cppwp/range.join.view">[range.join.view]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;input_range V&gt;
    requires view&lt;V&gt; &amp;&amp; input_range&lt;range_reference_t&lt;V&gt;&gt; &amp;&amp;
             (is_reference_v&lt;range_reference_t&lt;V&gt;&gt; ||
             view&lt;range_value_t&lt;V&gt;&gt;)
  class join_view : public view_interface&lt;join_view&lt;V&gt;&gt; {
  private:
    [&hellip;]
  public:
    join_view() = default;
    constexpr explicit join_view(V base);
    <del>template&lt;input_range R&gt;
      requires viewable_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
    constexpr explicit join_view(R&amp;&amp; r);</del>
    [&hellip;]
  };
[&hellip;]
}
</pre>
[&hellip;]
<pre>
<del>template&lt;input_range R&gt;
  requires viewable_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr explicit join_view(R&amp;&amp; r);</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Effects:</i> Initializes <tt>base_</tt> with <tt>views::all(std::forward&lt;R&gt;(r))</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.7.11.2 <a href="https://timsong-cpp.github.io/cppwp/range.split.view">[range.split.view]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
[&hellip;]
  template&lt;input_range V, forward_range Pattern&gt;
    requires view&lt;V&gt; &amp;&amp; view&lt;Pattern&gt; &amp;&amp;
             indirectly_comparable&lt;iterator_t&lt;V&gt;, iterator_t&lt;Pattern&gt;, ranges::equal_to&gt; &amp;&amp;
             (forward_range&lt;V&gt; || <i>tiny-range</i>&lt;Pattern&gt;)
  class split_view : public view_interface&lt;split_view&lt;V, Pattern&gt;&gt; {
  private:
    [&hellip;]
  public:
    split_view() = default;
    constexpr split_view(V base, Pattern pattern);
    <del>template&lt;input_range R, forward_range P&gt;
      requires constructible_from&lt;V, all_view&lt;R&gt;&gt; &amp;&amp;
               constructible_from&lt;Pattern, all_view&lt;P&gt;&gt;
    constexpr split_view(R&amp;&amp; r, P&amp;&amp; p);</del>
    [&hellip;]
  };
[&hellip;]
}
</pre>
[&hellip;]
<pre>
<del>template&lt;input_range R, forward_range P&gt;
  requires constructible_from&lt;V, all_view&lt;R&gt;&gt; &amp;&amp;
           constructible_from&lt;Pattern, all_view&lt;P&gt;&gt;
constexpr split_view(R&amp;&amp; r, P&amp;&amp; p);</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Effects:</i> Initializes <tt>base_</tt> with <tt>views::all(std::forward&lt;R&gt;(r))</tt>, 
and <tt>pattern_</tt> with <tt>views::all(std::forward&lt;P&gt;(p))</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.7.14.2 <a href="https://timsong-cpp.github.io/cppwp/range.reverse.view">[range.reverse.view]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;view V&gt;
    requires bidirectional_range&lt;V&gt;
  class reverse_view : public view_interface&lt;reverse_view&lt;V&gt;&gt; {
  private:
    [&hellip;]
  public:
    reverse_view() = default;
    constexpr explicit reverse_view(V r);
    <del>template&lt;viewable_range R&gt;
      requires bidirectional_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
    constexpr explicit reverse_view(R&amp;&amp; r);</del>
    [&hellip;]
  };
[&hellip;]
}
</pre>
[&hellip;]
<pre>
<del>template&lt;viewable_range R&gt;
  requires bidirectional_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr explicit reverse_view(R&amp;&amp; r);</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Effects:</i> Initializes <tt>base_</tt> with <tt>views::all(std::forward&lt;R&gt;(r))</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3281" href="3281">3281.</a> Conversion from <tt><i>pair-like</i></tt> types to <tt>subrange</tt> is a silent semantic promotion</h3>
<p><b>Section:</b> 24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-10 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.subrange">active issues</a> in [range.subrange].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.subrange">issues</a> in [range.subrange].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Just because a <tt>pair</tt> is holding two iterators, it doesn't mean those two iterators denote a 
valid range. Implicitly converting such <tt><i>pair-like</i></tt> types to a <tt>subrange</tt> is 
dangerous and should be disallowed.
<p/>
Suggested priority P1.
<p/>
Implementation experience: range-v3's subrange lacks these constructors.
</p>

<p><i>[2019-10 Priority set to 1 and status to LEWG after reflector discussion]</i></p>

<p><i>[2019-11 Status to Ready after LWG discussion Friday in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
[&hellip;]
  <del>template&lt;class T, class U, class V&gt;
    concept <i>pair-like-convertible-to</i> = <i>// exposition only</i>
      !range&lt;T&gt; &amp;&amp; <i>pair-like</i>&lt;remove_reference_t&lt;T&gt;&gt; &amp;&amp;
      requires(T&amp;&amp; t) {
        { get&lt;0&gt;(std::forward&lt;T&gt;(t)) } -&gt; convertible_to&lt;U&gt;;
        { get&lt;1&gt;(std::forward&lt;T&gt;(t)) } -&gt; convertible_to&lt;V&gt;;
      };</del>
[&hellip;]
  template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S = I, subrange_kind K =
           sized_sentinel_for&lt;S, I&gt; ? subrange_kind::sized : subrange_kind::unsized&gt;
    requires (K == subrange_kind::sized || !sized_sentinel_for&lt;S, I&gt;)
  class subrange : public view_interface&lt;subrange&lt;I, S, K&gt;&gt; {
  private:
    [&hellip;]
  public:
    [&hellip;]
    <del>template&lt;<i>not-same-as</i>&lt;subrange&gt; PairLike&gt;
      requires <i>pair-like-convertible-to</i>&lt;PairLike, I, S&gt;
    constexpr subrange(PairLike&amp;&amp; r) requires (!StoreSize)
      : subrange{std::get&lt;0&gt;(std::forward&lt;PairLike&gt;(r)),
                 std::get&lt;1&gt;(std::forward&lt;PairLike&gt;(r))}
    {}
    template&lt;<i>pair-like-convertible-to</i>&lt;I, S&gt; PairLike&gt;
    constexpr subrange(PairLike&amp;&amp; r, <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n)
      requires (K == subrange_kind::sized)
      : subrange{std::get&lt;0&gt;(std::forward&lt;PairLike&gt;(r)),
                 std::get&lt;1&gt;(std::forward&lt;PairLike&gt;(r)), n}
    {}</del>
  [&hellip;]
  };
[&hellip;]
}
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3282" href="3282">3282.</a> <tt>subrange</tt> converting constructor should disallow derived to base conversions</h3>
<p><b>Section:</b> 24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-10 <b>Last modified:</b> 2020-02-10 19:48:51 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.subrange">active issues</a> in [range.subrange].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.subrange">issues</a> in [range.subrange].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The following code leads to slicing and general badness:
</p>
<blockquote><pre>
struct Base {};
struct Derived : Base {};
subrange&lt;Derived*&gt; sd;
subrange&lt;Base*&gt; sb = sd;
</pre></blockquote>
<p>
Traversal operations on iterators that are pointers do pointer arithmetic. If a <tt>Base*</tt> is 
actually pointing to a <tt>Derived*</tt>, then pointer arithmetic is invalid. <tt>subrange</tt>'s 
constructors can easily flag this invalid code, and probably should.
<p/>
The following PR incorporates the suggested fix to issue LWG <a href="3281">3281</a> I previously reported.
<p/>
Suggested priority: P1, since it will be hard to fix this after C++20 ships.
</p>
<p><i>[2019-10 Priority set to 1 and status to LEWG after reflector discussion]</i></p>

<p><i>[2019-10; Marshall comments]</i></p>

<p>
This issue would resolve <a href="https://github.com/cplusplus/nbballot/issues/281">US-285</a>.
</p>
<p><i>[2019-11 LEWG says OK; Status to Open. Friday PM discussion in Belfast. Casey to investigate and report back.]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  <ins>template&lt;class From, class To&gt;
    concept <i>convertible-to-non-slicing</i> = <i>// exposition only</i>
      convertible_to&lt;From, To&gt; &amp;&amp;
      !(is_pointer_v&lt;decay_t&lt;From&gt;&gt; &amp;&amp;
      is_pointer_v&lt;decay_t&lt;To&gt;&gt; &amp;&amp;
      <i>not-same-as</i>&lt;remove_pointer_t&lt;decay_t&lt;From&gt;&gt;, remove_pointer_t&lt;decay_t&lt;To&gt;&gt;&gt;);</ins>
      
  template&lt;class T&gt;
    concept <i>pair-like</i> = <i>// exposition only</i>
      [&hellip;]
      
  <del>template&lt;class T, class U, class V&gt;
    concept <i>pair-like-convertible-to</i> = <i>// exposition only</i>
      !range&lt;T&gt; &amp;&amp; <i>pair-like</i>&lt;remove_reference_t&lt;T&gt;&gt; &amp;&amp;
      requires(T&amp;&amp; t) {
        { get&lt;0&gt;(std::forward&lt;T&gt;(t)) } -&gt; convertible_to&lt;U&gt;;
        { get&lt;1&gt;(std::forward&lt;T&gt;(t)) } -&gt; convertible_to&lt;V&gt;;
      };</del>
      
   template&lt;class T, class U, class V&gt;
     concept <i>pair-like-convertible-from</i> = <i>// exposition only</i>
       !range&lt;T&gt; &amp;&amp; <i>pair-like</i>&lt;T&gt; &amp;&amp; 
       constructible_from&lt;T, U, V&gt; <ins>&amp;&amp;
       <i>convertible-to-non-slicing</i>&lt;U, tuple_element_t&lt;0, T&gt;&gt; &amp;&amp;
       convertible_to&lt;V, tuple_element_t&lt;1, T&gt;&gt;</ins>;

[&hellip;]
[&hellip;]
  template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S = I, subrange_kind K =
           sized_sentinel_for&lt;S, I&gt; ? subrange_kind::sized : subrange_kind::unsized&gt;
    requires (K == subrange_kind::sized || !sized_sentinel_for&lt;S, I&gt;)
  class subrange : public view_interface&lt;subrange&lt;I, S, K&gt;&gt; {
  private:
    [&hellip;]
  public:
    subrange() = default;
    
    constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s) requires (!StoreSize);
    
    constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s, 
                       <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n) requires (K == subrange_kind::sized);
    
    template&lt;<i>not-same-as</i>&lt;subrange&gt; R&gt;
      requires <i>forwarding-range</i>&lt;R&gt; &amp;&amp;
        <del>convertible_to</del><ins><i>convertible-to-non-slicing</i></ins>&lt;iterator_t&lt;R&gt;, I&gt; &amp;&amp; 
        convertible_to&lt;sentinel_t&lt;R&gt;, S&gt;
    constexpr subrange(R&amp;&amp; r) requires (!StoreSize || sized_range&lt;R&gt;);
    
    template&lt;<i>forwarding-range</i> R&gt;
      requires convertible_to&lt;iterator_t&lt;R&gt;, I&gt; &amp;&amp; convertible_to&lt;sentinel_t&lt;R&gt;, S&gt;
    constexpr subrange(R&amp;&amp; r, <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n)
      requires (K == subrange_kind::sized)
        : subrange{ranges::begin(r), ranges::end(r), n}
    {}
    
    <del>template&lt;<i>not-same-as</i>&lt;subrange&gt; PairLike&gt;
      requires <i>pair-like-convertible-to</i>&lt;PairLike, I, S&gt;
    constexpr subrange(PairLike&amp;&amp; r) requires (!StoreSize)
      : subrange{std::get&lt;0&gt;(std::forward&lt;PairLike&gt;(r)),
                 std::get&lt;1&gt;(std::forward&lt;PairLike&gt;(r))}
    {}

    template&lt;<i>pair-like-convertible-to</i>&lt;I, S&gt; PairLike&gt;
    constexpr subrange(PairLike&amp;&amp; r, <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n)
      requires (K == subrange_kind::sized)
      : subrange{std::get&lt;0&gt;(std::forward&lt;PairLike&gt;(r)),
                 std::get&lt;1&gt;(std::forward&lt;PairLike&gt;(r)), n}
    {}</del>
  [&hellip;]
  };
  
  <ins>template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  subrange(I, S) -&gt; subrange&lt;I, S&gt;;</ins>  
  
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 24.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.subrange.ctor">[range.subrange.ctor]</a> as indicated:</p>

<blockquote>
<pre>
constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s) requires (!StoreSize);
</pre>
<blockquote>
<p>
-1- <i>Expects:</i> [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s, 
                   <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n) requires (K == subrange_kind::sized);
</pre>
<blockquote>
<p>
-2- <i>Expects:</i> [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;<i>not-same-as</i>&lt;subrange&gt; R&gt;
  requires <i>forwarding-range</i>&lt;R&gt; &amp;&amp;
    <del>convertible_to</del><ins><i>convertible-to-non-slicing</i></ins>&lt;iterator_t&lt;R&gt;, I&gt; &amp;&amp; 
    convertible_to&lt;sentinel_t&lt;R&gt;, S&gt;
constexpr subrange(R&amp;&amp; r) requires (!StoreSize || sized_range&lt;R&gt;);
</pre>
<blockquote>
<p>
-6- <i>Effects:</i> [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-10; Prague]</i></p>

<p>
The group identified minor problems that have been fixed in the revised wording.
</p>

<p><i>[2020-02-10 Move to Immediate Monday afternoon in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  <ins>template&lt;class From, class To&gt;
    concept <i>convertible-to-non-slicing</i> = <i>// exposition only</i>
      convertible_to&lt;From, To&gt; &amp;&amp;
      !(is_pointer_v&lt;decay_t&lt;From&gt;&gt; &amp;&amp;
      is_pointer_v&lt;decay_t&lt;To&gt;&gt; &amp;&amp;
      <i>not-same-as</i>&lt;remove_pointer_t&lt;decay_t&lt;From&gt;&gt;, remove_pointer_t&lt;decay_t&lt;To&gt;&gt;&gt;);</ins>
      
  template&lt;class T&gt;
    concept <i>pair-like</i> = <i>// exposition only</i>
      [&hellip;]
      
  <del>template&lt;class T, class U, class V&gt;
    concept <i>pair-like-convertible-to</i> = <i>// exposition only</i>
      !range&lt;T&gt; &amp;&amp; <i>pair-like</i>&lt;remove_reference_t&lt;T&gt;&gt; &amp;&amp;
      requires(T&amp;&amp; t) {
        { get&lt;0&gt;(std::forward&lt;T&gt;(t)) } -&gt; convertible_to&lt;U&gt;;
        { get&lt;1&gt;(std::forward&lt;T&gt;(t)) } -&gt; convertible_to&lt;V&gt;;
      };</del>
      
   template&lt;class T, class U, class V&gt;
     concept <i>pair-like-convertible-from</i> = <i>// exposition only</i>
       !range&lt;T&gt; &amp;&amp; <i>pair-like</i>&lt;T&gt; &amp;&amp; 
       constructible_from&lt;T, U, V&gt; <ins>&amp;&amp;
       <i>convertible-to-non-slicing</i>&lt;U, tuple_element_t&lt;0, T&gt;&gt; &amp;&amp;
       convertible_to&lt;V, tuple_element_t&lt;1, T&gt;&gt;</ins>;

[&hellip;]
[&hellip;]
  template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S = I, subrange_kind K =
           sized_sentinel_for&lt;S, I&gt; ? subrange_kind::sized : subrange_kind::unsized&gt;
    requires (K == subrange_kind::sized || !sized_sentinel_for&lt;S, I&gt;)
  class subrange : public view_interface&lt;subrange&lt;I, S, K&gt;&gt; {
  private:
    [&hellip;]
  public:
    subrange() = default;
    
    constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s) requires (!StoreSize);
    
    constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s, 
                       <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n) requires (K == subrange_kind::sized);
    
    template&lt;<i>not-same-as</i>&lt;subrange&gt; R&gt;
      requires <i>forwarding-range</i>&lt;R&gt; &amp;&amp;
        <del>convertible_to</del><ins><i>convertible-to-non-slicing</i></ins>&lt;iterator_t&lt;R&gt;, I&gt; &amp;&amp; 
        convertible_to&lt;sentinel_t&lt;R&gt;, S&gt;
    constexpr subrange(R&amp;&amp; r) requires (!StoreSize || sized_range&lt;R&gt;);
    
    template&lt;<i>forwarding-range</i> R&gt;
      requires <del>convertible_to</del><ins><i>convertible-to-non-slicing</i></ins>&lt;iterator_t&lt;R&gt;, I&gt; &amp;&amp; 
	    convertible_to&lt;sentinel_t&lt;R&gt;, S&gt;
    constexpr subrange(R&amp;&amp; r, <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n)
      requires (K == subrange_kind::sized)
        : subrange{ranges::begin(r), ranges::end(r), n}
    {}
    
    <del>template&lt;<i>not-same-as</i>&lt;subrange&gt; PairLike&gt;
      requires <i>pair-like-convertible-to</i>&lt;PairLike, I, S&gt;
    constexpr subrange(PairLike&amp;&amp; r) requires (!StoreSize)
      : subrange{std::get&lt;0&gt;(std::forward&lt;PairLike&gt;(r)),
                 std::get&lt;1&gt;(std::forward&lt;PairLike&gt;(r))}
    {}

    template&lt;<i>pair-like-convertible-to</i>&lt;I, S&gt; PairLike&gt;
    constexpr subrange(PairLike&amp;&amp; r, <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n)
      requires (K == subrange_kind::sized)
      : subrange{std::get&lt;0&gt;(std::forward&lt;PairLike&gt;(r)),
                 std::get&lt;1&gt;(std::forward&lt;PairLike&gt;(r)), n}
    {}</del>
  [&hellip;]
  };
  
  <ins>template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  subrange(I, S) -&gt; subrange&lt;I, S&gt;;</ins>  
  
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 24.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.subrange.ctor">[range.subrange.ctor]</a> as indicated:</p>

<blockquote>
<pre>
constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s) requires (!StoreSize);
</pre>
<blockquote>
<p>
-1- <i>Expects:</i> [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
constexpr subrange(<ins><i>convertible-to-non-slicing</i>&lt;</ins>I<ins>&gt; auto</ins> i, S s, 
                   <i>make-unsigned-like-t</i>(iter_difference_t&lt;I&gt;) n) requires (K == subrange_kind::sized);
</pre>
<blockquote>
<p>
-2- <i>Expects:</i> [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;<i>not-same-as</i>&lt;subrange&gt; R&gt;
  requires <i>forwarding-range</i>&lt;R&gt; &amp;&amp;
    <del>convertible_to</del><ins><i>convertible-to-non-slicing</i></ins>&lt;iterator_t&lt;R&gt;, I&gt; &amp;&amp; 
    convertible_to&lt;sentinel_t&lt;R&gt;, S&gt;
constexpr subrange(R&amp;&amp; r) requires (!StoreSize || sized_range&lt;R&gt;);
</pre>
<blockquote>
<p>
-6- <i>Effects:</i> [&hellip;]
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3283" href="3283">3283.</a> Types satisfying <tt>input_iterator</tt> but not <tt>equality_comparable</tt> look like 
C++17 output iterators</h3>
<p><b>Section:</b> 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-10 <b>Last modified:</b> 2020-02-13 18:18:00 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.traits">active issues</a> in [iterator.traits].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.traits">issues</a> in [iterator.traits].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In C++20, if an iterator doesn't define <em>all</em> of the associated iterator types (value, 
category, reference, and difference), the primary <tt>std::iterator_traits</tt> template picks 
a category based on structural conformance to a set of implementation-defined concepts that 
capture the old iterator requirements tables. (See 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a>.) In C++17, 
input iterators were required to be equality-comparable with themselves. In C++20 that is not 
the case, so such iterators must not be given <tt>intput_iterator_tag</tt> as a category. 
They don't, so that's all well and good.
<p/>
However, 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> concludes that, since such an iterator cannot be an 
input iterator, it must therefor be an <em>output</em> iterator, and it assigns it a category 
of <tt>std::output_iterator_tag</tt>. It does this even if there is a nested 
<tt>iterator_category</tt> typedef declaring the iterator to be input. (This will happen 
frequently as C++20 iterators don't require iterators to declare their reference type, for 
instance.) This will be extremely confusing to users who, understandably, will be at a loss to 
understand why the legacy STL algorithms think their iterator is an output iterator when they 
have clearly stated that the iterator is input!
<p/>
The fix is to tweak the specification such that the output category is assigned to an iterator 
only (a) if it declares its category to be output, or (b) it doesn't specify a category at all. 
The result, for the user, is that their iterator simply won't look like a C++17 iterator at all, 
because it isn't!
<p/>
Suggested priority: P1. We can't make this change after C++20 because it would be an observable change.
<p/>
This fix has been implemented in range-v3.
</p>

<p><i>[2019-10-12 Priority set to 1 after reflector discussion]</i></p>


<p><i>[2019-11 Wednesday night Issue processing in Belfast]</i></p>

<p>Much discussion along with <a href="3289">3289</a>. CC to write rationale for NAD.</p>

<p><i>[2020-02-13, Prague; Priority reduced to 2 after LWG discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> as indicated:</p>

<blockquote>
<p>
-3- The members of a specialization <tt>iterator_traits&lt;I&gt;</tt> generated from the 
<tt>iterator_traits</tt> primary template are computed as follows:
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; If <tt>I</tt> has valid [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(3.3) &mdash; Otherwise, if <tt>I</tt> satisfies the exposition-only concept 
<tt><i>cpp17-iterator</i></tt> <ins>and either</ins></p>
<ol style="list-style-type:lower-alpha">
<li><p><ins><tt>I::iterator_category</tt> is valid and denotes <tt>output_iterator_tag</tt> or a 
type publicly and unambiguously derived from <tt>output_iterator_tag</tt>, or</ins></p></li>
<li><p><ins>there is no type <tt>I::iterator_category</tt></ins></p></li>
</ol> 
<p>then <tt>iterator_traits&lt;I&gt;</tt> has the following publicly accessible members:</p></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3284" href="3284">3284.</a> <tt>random_access_iterator</tt> semantic constraints accidentally promote difference type
 using unary negate</h3>
<p><b>Section:</b> 23.3.4.13 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.random.access">[iterator.concept.random.access]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-10 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.concept.random.access">issues</a> in [iterator.concept.random.access].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
23.3.4.13 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.random.access">[iterator.concept.random.access]</a>/p2.7 says:
</p>
<blockquote><p>
<tt>(b += -n)</tt> is equal to <tt>a</tt>
</p></blockquote>
<p>
Unary minus can do integer promotion. That is not the intent here.
</p>

<p><i>[2019-10-12 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after five positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 23.3.4.13 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.random.access">[iterator.concept.random.access]</a> as indicated:</p>

<blockquote>
<p>
-2- Let <tt>a</tt> and <tt>b</tt> be valid iterators of type <tt>I</tt> such that <tt>b</tt> 
is reachable from <tt>a</tt> after <tt>n</tt> applications of <tt>++a</tt>, let <tt>D</tt> be
<tt>iter_difference_t&lt;I&gt;</tt>, and let <tt>n</tt> denote a value of type <tt>D</tt>. 
<tt>I</tt> models <tt>random_access_iterator</tt> only if:
</p>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; <tt>(a += n)</tt> is equal to <tt>b</tt>.</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(2.7) &mdash; <tt>(b += <ins>D(</ins>-n<ins>)</ins>)</tt> is equal to <tt>a</tt>.</p></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3285" href="3285">3285.</a> The type of a customization point object shall satisfy <tt>semiregular</tt></h3>
<p><b>Section:</b> 16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-10 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
We should be testing the un-<i>cv</i>-qualified type of a customization point object.
</p>

<p><i>[2019-10-12 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after seven positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a> as indicated:</p>

<blockquote>
<p>
-2- The type of a customization point object <ins>ignoring <i>cv</i>-qualifiers</ins> shall 
model <tt>semiregular</tt> (18.6 <a href="https://timsong-cpp.github.io/cppwp/concepts.object">[concepts.object]</a>).
</p>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3286" href="3286">3286.</a> <tt>ranges::size</tt> is not required to be valid after a call to <tt>ranges::begin</tt> on an input range</h3>
<p><b>Section:</b> 24.7.6.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.view">[range.take.view]</a>, 24.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.subrange.ctor">[range.subrange.ctor]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-10 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
On an input (but not forward) range, <tt>begin(rng)</tt> is not required to be an equality-preserving 
expression (24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a>/3.3). If the range is <em>also</em> sized, then it is not valid 
to call <tt>size(rng)</tt> after <tt>begin(rng)</tt> (24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a>/2.2). In several 
places in the ranges clause, this precondition is violated. A trivial re-expression of the effects 
clause fixes the problem.
</p>

<p><i>[2019-10-12 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after seven positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.7.6.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.view">[range.take.view]</a>, class template <tt>take_view</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;view V&gt;
  class take_view : public view_interface&lt;take_view&lt;V&gt;&gt; {
  private:
    [&hellip;]
  public:
    [&hellip;]
    constexpr auto begin() requires (!<i>simple-view</i>&lt;V&gt;) {
      if constexpr (sized_range&lt;V&gt;) {
        if constexpr (random_access_range&lt;V&gt;)
          return ranges::begin(base_);
        else <ins>{
          auto sz = size();</ins>
          return counted_iterator{ranges::begin(base_), <del>size()</del><ins>sz</ins>};
        <ins>}</ins>
      } else
        return counted_iterator{ranges::begin(base_), count_};
    }

    constexpr auto begin() const requires range&lt;const V&gt; {
      if constexpr (sized_range&lt;const V&gt;) {
        if constexpr (random_access_range&lt;const V&gt;)
          return ranges::begin(base_);
        else <ins>{
          auto sz = size();</ins>
          return counted_iterator{ranges::begin(base_), <del>size()</del><ins>sz</ins>};
        <ins>}</ins>
      } else
        return counted_iterator{ranges::begin(base_), count_};
    }
    
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 24.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.subrange.ctor">[range.subrange.ctor]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;<i>not-same-as</i>&lt;subrange&gt; R&gt;
  requires forwarding-range&lt;R&gt; &amp;&amp;
    convertible_to&lt;iterator_t&lt;R&gt;, I&gt; &amp;&amp; convertible_to&lt;sentinel_t&lt;R&gt;, S&gt;
constexpr subrange(R&amp;&amp; r) requires (!StoreSize || sized_range&lt;R&gt;);
</pre>
<blockquote>
<p>
-6- <i>Effects:</i> Equivalent to:
<ol style="list-style-type: none">
<li><p>(6.1) &mdash; If <tt>StoreSize</tt> is <tt>true</tt>, <tt>subrange{<del>ranges::begin(r), 
ranges::end(r)</del><ins>r</ins>, ranges::size(r)}</tt>.</p></li>
<li><p>(6.2) &mdash; Otherwise, <tt>subrange{ranges::begin(r), ranges::end(r)}</tt>.</p></li>
</ol>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3287" href="3287">3287.</a> Exposition-only <tt><i>cpp17-input-iterator</i></tt> concept is needlessly complex</h3>
<p><b>Section:</b> 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-10 <b>Last modified:</b> 2019-10-14 17:22:27 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.traits">active issues</a> in [iterator.traits].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.traits">issues</a> in [iterator.traits].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The new C++20 iterator concepts use <tt>common_reference</tt> to constrain the value, reference, and 
rvalue_reference associated types in order to support proxy references (see 
23.3.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.readable">[iterator.concept.readable]</a>).
<p/>
However, the C++17 iterators did not support proxy references, so the use of <tt>common_reference</tt> in 
23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a>/p2 is needlessly complex. The <tt>common_reference</tt> constraints can be 
replaced with simple convertibility requirements to a <tt>const</tt> lvalue reference to the value type.
<p/>
This fix has been implemented in range-v3.
</p>

<p><i>[2019-10-14 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> as indicated:</p>

<blockquote>
<p>
-2- The definitions in this subclause make use of the following exposition-only concepts:
</p>
<blockquote>
<pre>
template&lt;class I&gt;
concept <i>cpp17-iterator</i> =
  copyable&lt;I&gt; &amp;&amp; requires(I i) {
    {   *i } -&gt; <i>can-reference</i>;
    {  ++i } -&gt; same_as&lt;I&amp;&gt;;
    { *i++ } -&gt; <i>can-reference</i>;
  };

template&lt;class I&gt;
concept <i>cpp17-input-iterator</i> =
  <i>cpp17-iterator</i>&lt;I&gt; &amp;&amp; equality_comparable&lt;I&gt; &amp;&amp; requires(I i) {
    typename incrementable_traits&lt;I&gt;::difference_type;
    typename readable_traits&lt;I&gt;::value_type;
    <del>typename common_reference_t&lt;iter_reference_t&lt;I&gt;&amp;&amp;,
                                typename readable_traits&lt;I&gt;::value_type&amp;&gt;;
    typename common_reference_t&lt;decltype(*i++)&amp;&amp;,
                                typename readable_traits&lt;I&gt;::value_type&amp;&gt;;</del>
    <ins>{ *i } -&gt; convertible_to&lt;const typename readable_traits&lt;I&gt;::value_type&amp;&gt;;
    { *i++ } -&gt; convertible_to&lt;const typename readable_traits&lt;I&gt;::value_type&amp;&gt;;</ins>
    requires signed_integral&lt;typename incrementable_traits&lt;I&gt;::difference_type&gt;;
  };

[&hellip;]
</pre>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3288" href="3288">3288.</a> <tt>atomic&lt;T&gt;::notify_one</tt> is unimplementable</h3>
<p><b>Section:</b> 31.6 <a href="https://timsong-cpp.github.io/cppwp/atomics.wait">[atomics.wait]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Anthony Williams <b>Opened:</b> 2019-09-11 <b>Last modified:</b> 2019-09-17 17:38:52 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#atomics.wait">active issues</a> in [atomics.wait].</p>
<p><b>View all other</b> <a href="lwg-index.html#atomics.wait">issues</a> in [atomics.wait].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
I am concerned by the wording around <tt>atomic&lt;T&gt;::wait()/atomic&lt;T&gt;::notify_one()</tt>.
<p/>
31.6 <a href="https://timsong-cpp.github.io/cppwp/atomics.wait">[atomics.wait]</a> p4 requires that the thread that calls <tt>wait()</tt> observed a
value <tt>X</tt> prior to the value <tt>Y</tt> which results from a store that happens-before 
the notify in order to be eligible to be unlocked.
<p/>
I am not sure how to implement that.
</p>
<blockquote><pre>
atomic&lt;int&gt; a = 0;

T1: int ra=a, read 0
T1: a.wait(0)
T2: a=42
T3: int ra=a, read 42
T3: a.wait(42)
T2: a.notify_one()
</pre></blockquote>
<p>
The wording requires that <tt>T1</tt> is eligible to be unlocked, but not <tt>T3</tt>, as
there is not a write <em>after</em> the value read by <tt>T3</tt> that happens-before
the notify.
<p/>
However, both <tt>T1</tt> and <tt>T3</tt> are waiting, so <tt>T3</tt> may be woken by the OS.
Waking <tt>T3</tt> is allowed (<tt>wait()</tt> says it may wake spuriously), but waking <tt>T1</tt>
is currently required as it is the only thread "eligible to be unblocked".
<p/>
This requires <tt>notify_one()</tt> to wake <em>all</em> waiters, which defeats the purpose.
<p/>
I suspect we need to change 31.6 <a href="https://timsong-cpp.github.io/cppwp/atomics.wait">[atomics.wait]</a> p4.
<p/>
How about:
</p>
<blockquote><p>
"A call to an atomic waiting operation <tt>W</tt> on an atomic object <tt>M</tt> is
<i>eligible to be unlocked</i> by a call to an atomic notifying operation <tt>N</tt> on
<tt>M</tt> if
<ul>
<li><p><tt>N</tt> does not happen-before <tt>W</tt></p></li>
<li><p>There are no side effects <tt>X</tt> and <tt>Y</tt> in the modification order of <tt>M</tt> such
that <tt>N</tt> happens-before <tt>X</tt>, <tt>X</tt> precedes <tt>Y</tt> in the modification order 
of <tt>M</tt> and an atomic operation that observes the effects of <tt>Y</tt> happens-before <tt>W</tt>.</p></li>
</ul>
"
</p></blockquote>
<p>
This would allow <tt>T3</tt> to be woken in the preceding example, but prevent it
being woken in the following case:
</p>
<blockquote><pre>
T1: int ra=a, read 0
T1: a.wait(0)
T2: a=42
T2: a.notify_one()
T2: a=69
T3: int ra=a, read 69
T3: a.wait(69)
</pre></blockquote>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 31.6 <a href="https://timsong-cpp.github.io/cppwp/atomics.wait">[atomics.wait]</a> as indicated:</p>

<blockquote>
<p>
-4- A call to an atomic waiting operation <ins><tt>W</tt></ins> on an atomic object <tt>M</tt> is 
<i>eligible to be unblocked</i> by a call to an atomic notifying operation <ins><tt>N</tt></ins> on <tt>M</tt> 
if <del>there exist side effects <tt>X</tt> and <tt>Y</tt> on <tt>M</tt> such that:</del>
<ol style="list-style-type: none">
<li><p>(4.1) &mdash; <ins><tt>N</tt> does not happen before <tt>W</tt></ins><del>the atomic waiting operation 
has blocked after observing the result of <tt>X</tt></del>,</p></li>
<li><p>(4.2) &mdash; <ins>There are no side effects</ins> <tt>X</tt> <ins>and</ins><del>precedes</del> <tt>Y</tt> 
in the modification order of <tt>M</tt><del>, and</del><ins>such that <tt>N</tt> happens before <tt>X</tt>, 
<tt>X</tt> precedes <tt>Y</tt> in the modification order of <tt>M</tt> and an atomic operation that observes 
the effects of <tt>Y</tt> happens before <tt>W</tt>.</ins></p></li>
<li><p><del>(4.3) &mdash; <tt>Y</tt> happens before the call to the atomic notifying operation.</del></p></li>
</ol>
</p>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3289" href="3289">3289.</a> Cannot opt out of C++17 iterator-ness without also opting out of C++20 iterator-ness</h3>
<p><b>Section:</b> 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a>, 23.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/common.iter.types">[common.iter.types]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-11 <b>Last modified:</b> 2020-02-13 18:18:00 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.traits">active issues</a> in [iterator.traits].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.traits">issues</a> in [iterator.traits].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The way to non-intrusively say that a type doesn't satisfy the C++17 iterator requirements is to 
specialize <tt>std::iterator_traits</tt> and not provide the nested typedefs. However, if a user 
were to do that, she would <em>also</em> be saying that the type is not a C++20 iterator. That is 
because <tt>readable</tt> and <tt>weakly_incrementable</tt> are specified in terms of 
<tt>iter_value_t&lt;I&gt;</tt> and <tt>iter_difference_t&lt;I&gt;</tt>. Those aliases check to 
see if <tt>std::iterator_traits&lt;I&gt;</tt> has been specialized (answer: yes), and if so 
resolve to <tt>std::iterator_traits&lt;I&gt;::value_type</tt> and 
<tt>std::iterator_traits&lt;I&gt;::difference_type</tt> respectively.
<p/>
The proper way to opt out of C++17 iterator-ness while opting <em>in</em> to C++20 iterator-ness 
would be to specialize <tt>std::iterator_traits</tt> and specify all the nested typedefs <em>except</em> 
<tt>::iterator_category</tt>. That's a bit weird and may throw off code that is expecting all the 
typedefs to be there, or none of them, so instead we can suggest users to set the <tt>iterator_category</tt> 
typedef to denote <tt>output_iterator_tag</tt>, which is a harmless lie; generic C++17 code will get 
the message: this iterator is not a c++17 input iterator, which is the salient bit.
<p/>
We then must fix up all the places in the Ranges clause that make faulty assumptions about an 
iterator's <tt>iterator_category</tt> typedef (as distinct from the iterator concept that it models).
</p>

<p><i>[2019-10-19 Issue Prioritization]</i></p>

<p>Priority to 1 after reflector discussion.</p>

<p><i>[2019-11 Wednesday night Issue processing in Belfast]</i></p>

<p>Much discussion; no consensus that this is a good approach. Need to coordinate between this and <a href="3283">3283</a></p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> as indicated:</p>

<blockquote>
<p>
-4- Explicit or partial specializations of <tt>iterator_traits</tt> may have a member type 
<tt>iterator_concept</tt> that is used to indicate conformance to the iterator concepts 
(23.3.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concepts">[iterator.concepts]</a>). <ins>[<i>Example:</i> To indicate conformance to the 
<tt>input_iterator</tt> concept but a lack of conformance to the <i>Cpp17InputIterator</i> 
requirements (23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>), an <tt>iterator_traits</tt> 
specialization might have <tt>iterator_concept</tt> denote <tt>input_iterator_tag</tt> and 
<tt>iterator_category</tt> denote <tt>output_iterator_tag</tt>. &mdash; <i>end example</i>]</ins>
</p>
</blockquote>
</li>

<li><p>Modify 23.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/common.iter.types">[common.iter.types]</a> as indicated:</p>

<blockquote>
<p>
-1- The nested <i>typedef-names</i> of the specialization of <tt>iterator_traits</tt> for 
<tt>common_iterator&lt;I, S&gt;</tt> are defined as follows.
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>iterator_concept</tt> denotes <tt>forward_iterator_tag</tt> if <tt>I</tt> 
models <tt>forward_iterator</tt>; otherwise it denotes <tt>input_iterator_tag</tt>.</p></li>
<li><p>(1.2) &mdash; <tt>iterator_category</tt> denotes <tt>forward_iterator_tag</tt> if 
<tt>iterator_traits&lt;I&gt;::iterator_category</tt> models <tt>derived_from&lt;forward_iterator_tag&gt;</tt>; 
otherwise it denotes <tt><del>input_iterator_tag</del><ins>iterator_traits&lt;I&gt;::iterator_category</ins></tt>.</p></li>
<li><p>(1.3) &mdash; If the expression <tt>a.operator-&gt;()</tt> is well-formed, where <tt>a</tt> is 
an lvalue of type <tt>const common_iterator&lt;I, S&gt;</tt>, then <tt>pointer</tt> denotes the type 
of that expression. Otherwise, pointer denotes <tt>void</tt>.</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.7.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.filter.iterator">[range.filter.iterator]</a> as indicated:</p>

<blockquote>
<p>
-3- <tt>iterator::iterator_category</tt> is defined as follows:
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; Let <tt>C</tt> denote the type <tt>iterator_traits&lt;iterator_t&lt;V&gt;&gt;::iterator_category</tt>.</p></li>
<li><p>(3.2) &mdash; If <tt>C</tt> models <tt>derived_from&lt;bidirectional_iterator_tag&gt;</tt>, then 
<tt>iterator_category</tt> denotes <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p><del>(3.3) &mdash; Otherwise, if <tt>C</tt> models <tt>derived_from&lt;forward_iterator_tag&gt;</tt>, then 
<tt>iterator_category</tt> denotes <tt>forward_iterator_tag</tt>.</del></p></li>
<li><p>(3.4) &mdash; Otherwise, <tt>iterator_category</tt> denotes <tt><del>input_iterator_tag</del><ins>C</ins></tt>.</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.7.10.3 <a href="https://timsong-cpp.github.io/cppwp/range.join.iterator">[range.join.iterator]</a> as indicated:</p>

<blockquote>
<p>
-3- <tt>iterator::iterator_category</tt> is defined as follows:
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; Let <tt><i>OUTERC</i></tt> denote 
<tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt>, and let <tt><i>INNERC</i></tt> 
denote <tt>iterator_traits&lt;iterator_t&lt;range_reference_t&lt;Base&gt;&gt;&gt;::iterator_category</tt>.</p></li>
<li><p><ins>(3.?) &mdash; If <tt><i>OUTERC</i></tt> does not model <tt>derived_from&lt;input_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes <tt><i>OUTERC</i></tt>.</ins></p></li>
<li><p><ins>(3.?) &mdash; Otherwise, if <tt><i>INNERC</i></tt> does not model 
<tt>derived_from&lt;input_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes <tt><i>INNERC</i></tt>.</ins></p></li>
<li><p>(3.2) &mdash; <ins>Otherwise, i</ins><del>I</del>f <tt>ref_is_glvalue</tt> is <tt>true</tt>,</p>
<ol style="list-style-type: none">
<li><p>(3.2.1) &mdash; If <tt><i>OUTERC</i></tt> and <tt><i>INNERC</i></tt> each model 
<tt>derived_from&lt;bidirectional_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes 
<tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(3.2.2) &mdash; Otherwise, if <tt><i>OUTERC</i></tt> and <tt><i>INNERC</i></tt> each model 
<tt>derived_from&lt;forward_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes 
<tt>forward_iterator_tag</tt>.</p></li>
</ol>
</li>
<li><p>(3.3) &mdash; Otherwise, <tt>iterator_category</tt> denotes <tt>input_iterator_tag</tt>.</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.7.11.3 <a href="https://timsong-cpp.github.io/cppwp/range.split.outer">[range.split.outer]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
namespace std::ranges {
  template&lt;class V, class Pattern&gt;
  template&lt;bool Const&gt;
  struct split_view&lt;V, Pattern&gt;::outer_iterator {
  private:
    [&hellip;]
  public:
    using iterator_concept =
      conditional_t&lt;forward_range&lt;Base&gt;, forward_iterator_tag, input_iterator_tag&gt;;
    using iterator_category = <ins><i>see below</i></ins><del>input_iterator_tag</del>;
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
<p>
<ins>-?- The <i>typedef-name</i> <tt>iterator_category</tt> denotes <tt>input_iterator_tag</tt> if 
<tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt> models 
<tt>derived_from&lt;input_iterator_tag&gt;</tt>, and 
<tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt> otherwise.</ins>
<p/>
-1- Many of the following specifications refer to the notional member <tt>current</tt> of 
<tt>outer_iterator</tt>. <tt>current</tt> is equivalent to <tt>current_</tt> if <tt>V</tt> models 
<tt>forward_range</tt>, and <tt>parent_-&gt;current_</tt> otherwise.
</p>
</blockquote>
</li>

<li><p>Modify 24.7.11.5 <a href="https://timsong-cpp.github.io/cppwp/range.split.inner">[range.split.inner]</a> as indicated:</p>

<blockquote>
<p>
-1- The <i>typedef-name</i> <tt>iterator_category</tt> denotes <tt>forward_iterator_tag</tt> if 
<tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt> models 
<tt>derived_from&lt;forward_iterator_tag&gt;</tt>, and 
<tt><del>input_iterator_tag</del><ins>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</ins></tt> 
otherwise.
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-10, Prague]</i></p>

<p>
The issue is out of sync with the current working draft, Daniel provides a synchronized merge.
</p>

<p><i>[2020-02-13, Prague; Priority reduced to 2 after LWG discussion]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> as indicated:</p>

<blockquote>
<p>
-4- Explicit or partial specializations of <tt>iterator_traits</tt> may have a member type 
<tt>iterator_concept</tt> that is used to indicate conformance to the iterator concepts 
(23.3.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concepts">[iterator.concepts]</a>). <ins>[<i>Example:</i> To indicate conformance to the 
<tt>input_iterator</tt> concept but a lack of conformance to the <i>Cpp17InputIterator</i> 
requirements (23.3.5.2 <a href="https://timsong-cpp.github.io/cppwp/input.iterators">[input.iterators]</a>), an <tt>iterator_traits</tt> 
specialization might have <tt>iterator_concept</tt> denote <tt>input_iterator_tag</tt> and 
<tt>iterator_category</tt> denote <tt>output_iterator_tag</tt>. &mdash; <i>end example</i>]</ins>
</p>
</blockquote>
</li>

<li><p>Modify 23.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/common.iter.types">[common.iter.types]</a> as indicated:</p>

<blockquote>
<p>
-1- The nested <i>typedef-name</i>s of the specialization of <tt>iterator_traits</tt> for 
<tt>common_iterator&lt;I, S&gt;</tt> are defined as follows.
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>iterator_concept</tt> denotes <tt>forward_iterator_tag</tt> if <tt>I</tt> 
models <tt>forward_iterator</tt>; otherwise it denotes <tt>input_iterator_tag</tt>.</p></li>
<li><p>(1.2) &mdash; <tt>iterator_category</tt> denotes <tt>forward_iterator_tag</tt> if 
<tt>iterator_traits&lt;I&gt;::iterator_category</tt> models <tt>derived_from&lt;forward_iterator_tag&gt;</tt>; 
otherwise it denotes <tt><del>input_iterator_tag</del><ins>iterator_traits&lt;I&gt;::iterator_category</ins></tt>.</p></li>
<li><p>(1.3) &mdash; If the expression <tt>a.operator-&gt;()</tt> is well-formed, where <tt>a</tt> is 
an lvalue of type <tt>const common_iterator&lt;I, S&gt;</tt>, then <tt>pointer</tt> denotes the type 
of that expression. Otherwise, pointer denotes <tt>void</tt>.</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.7.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.filter.iterator">[range.filter.iterator]</a> as indicated:</p>

<blockquote>
<p>
-3- <tt>iterator::iterator_category</tt> is defined as follows:
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; Let <tt>C</tt> denote the type <tt>iterator_traits&lt;iterator_t&lt;V&gt;&gt;::iterator_category</tt>.</p></li>
<li><p>(3.2) &mdash; If <tt>C</tt> models <tt>derived_from&lt;bidirectional_iterator_tag&gt;</tt>, then 
<tt>iterator_category</tt> denotes <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p><del>(3.3) &mdash; Otherwise, if <tt>C</tt> models <tt>derived_from&lt;forward_iterator_tag&gt;</tt>, then 
<tt>iterator_category</tt> denotes <tt>forward_iterator_tag</tt>.</del></p></li>
<li><p>(3.4) &mdash; Otherwise, <tt>iterator_category</tt> denotes <tt>C</tt>.</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.7.10.3 <a href="https://timsong-cpp.github.io/cppwp/range.join.iterator">[range.join.iterator]</a> as indicated:</p>

<blockquote>
<p>
-2- <tt>iterator::iterator_category</tt> is defined as follows:
</p>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; Let <tt><i>OUTERC</i></tt> denote 
<tt>iterator_traits&lt;iterator_t&lt;<i>Base</i>&gt;&gt;::iterator_category</tt>, and let <tt><i>INNERC</i></tt> 
denote <tt>iterator_traits&lt;iterator_t&lt;range_reference_t&lt;<i>Base</i>&gt;&gt;&gt;::iterator_category</tt>.</p></li>
<li><p><ins>(2.?) &mdash; If <tt><i>OUTERC</i></tt> does not model <tt>derived_from&lt;input_iterator_tag&gt;</tt>, 
<tt>iterator_category</tt> denotes <tt><i>OUTERC</i></tt>.</ins></p></li>
<li><p><ins>(2.?) &mdash; Otherwise, if <tt><i>INNERC</i></tt> does not model 
<tt>derived_from&lt;input_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes <tt><i>INNERC</i></tt>.</ins></p></li>
<li><p>(2.2) &mdash; <ins>Otherwise, i</ins><del>I</del>f <tt><i>ref-is-glvalue</i></tt> is <tt>true</tt> and 
<tt><i>OUTERC</i></tt> and <tt><i>INNERC</i></tt> each model <tt>derived_from&lt;bidirectional_iterator_tag&gt;</tt>, 
<tt>iterator_category</tt> denotes <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(2.3) &mdash; Otherwise, if <tt><i>ref-is-glvalue</i></tt> is <tt>true</tt> and <tt><i>OUTERC</i></tt> and 
<tt><i>INNERC</i></tt> each model <tt>derived_from&lt;forward_iterator_tag&gt;</tt>, <tt>iterator_category</tt> 
denotes <tt>forward_iterator_tag</tt>.</p></li>
<li><p>(2.4) &mdash; Otherwise, if <tt><i>OUTERC</i></tt> and <tt><i>INNERC</i></tt> each model 
<tt>derived_from&lt;input_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes <tt>input_iterator_tag</tt>.</p></li>
<li><p>(2.5) &mdash; Otherwise, <tt>iterator_category</tt> denotes <tt>output_iterator_tag</tt>.</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.7.11.3 <a href="https://timsong-cpp.github.io/cppwp/range.split.outer">[range.split.outer]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The previous wording change has been adjusted to follow the pattern used in 24.7.11.5 <a href="https://timsong-cpp.github.io/cppwp/range.split.inner">[range.split.inner]</a> p1.]
</p>
</blockquote>

<blockquote>
<blockquote>
<pre>
namespace std::ranges {
  template&lt;class V, class Pattern&gt;
  template&lt;bool Const&gt;
  struct split_view&lt;V, Pattern&gt;::<i>outer_iterator</i> {
  private:
    [&hellip;]
  public:
    using iterator_concept =
      conditional_t&lt;forward_range&lt;<i>Base</i>&gt;, forward_iterator_tag, input_iterator_tag&gt;;
    using iterator_category = <ins><i>see below</i></ins><del>input_iterator_tag</del>;
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
<p>
<ins>-?- The <i>typedef-name</i> <tt>iterator_category</tt> denotes:</ins>
</p>
<ol style="list-style-type: none">
<li><p><ins>(?.?) &mdash; <tt>input_iterator_tag</tt> if 
<tt>iterator_traits&lt;iterator_t&lt;<i>Base</i>&gt;&gt;::iterator_category</tt> models 
<tt>derived_from&lt;input_iterator_tag&gt;</tt>;</ins></p></li>
<li><p><ins>(?.?) &mdash; otherwise, <tt>iterator_traits&lt;iterator_t&lt;<i>Base</i>&gt;&gt;::iterator_category</tt>.</ins></p></li>
</ol>
<p>
-1- Many of the following specifications refer to the notional member <tt><i>current</i></tt> of 
<tt><i>outer-iterator</i></tt>. <tt><i>current</i></tt> is equivalent to <tt><i>current_</i></tt> 
if <tt>V</tt> models <tt>forward_range</tt>, and <tt><i>parent_-&gt;current_</i></tt> otherwise.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3290" href="3290">3290.</a> Are <tt>std::format</tt> field widths code units, code points, or something else?</h3>
<p><b>Section:</b> 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tom Honermann <b>Opened:</b> 2019-09-08 <b>Last modified:</b> 2020-02-13 13:56:59 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.string.std">active issues</a> in [format.string.std].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.string.std">issues</a> in [format.string.std].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> p7 states:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
<p>
The <i>positive-integer</i> in <i>width</i> is a decimal integer defining the minimum field width. If <i>width</i> 
is not specified, there is no minimum field width, and the field width is determined based on the content of the field.
</p>
</blockquote>
<p>
Is field width measured in code units, code points, or something else?
<p/>
Consider the following example assuming a UTF-8 locale:
</p>
<blockquote><pre>
std::format("{}", "\xC3\x81");     // U+00C1        { LATIN CAPITAL LETTER A WITH ACUTE }
std::format("{}", "\x41\xCC\x81"); // U+0041 U+0301 { LATIN CAPITAL LETTER A } { COMBINING ACUTE ACCENT }
</pre></blockquote>
<p>
In both cases, the arguments encode the same user-perceived character (&#xc1;). The first uses two UTF-8 
code units to encode a single code point that represents a single glyph using a composed Unicode 
normalization form. The second uses three code units to encode two code points that represent the same 
glyph using a decomposed Unicode normalization form.
<p/>
How is the field width determined? If measured in code units, the first has a width of 2 and the second of 
3. If measured in code points, the first has a width of 1 and the second of 2. If measured in grapheme 
clusters, both have a width of 1. Is the determination locale dependent?
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> as indicated:</p>

<blockquote>
<p>
-7- The <i>positive-integer</i> in <i>width</i> is a decimal integer defining the minimum field width. If 
<i>width</i> is not specified, there is no minimum field width, and the field width is determined based 
on the content of the field. <ins>Field width is measured in code units. Each byte of a multibyte 
character contributes to the field width.</ins>
</p>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Resolved by <a href="http://wg21.link/p1868r2">P1868R2</a>
</p>


<p><b>Proposed resolution:</b></p>
<p>
</p>




<hr>
<h3><a name="3291" href="3291">3291.</a> <tt>iota_view::iterator</tt> has the wrong <tt>iterator_category</tt></h3>
<p><b>Section:</b> 24.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/range.iota.iterator">[range.iota.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Eric Niebler <b>Opened:</b> 2019-09-13 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.iota.iterator">active issues</a> in [range.iota.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.iota.iterator">issues</a> in [range.iota.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In the old way of looking at the world, forward iterators need to return real references. Since 
dereferencing <tt>iota_view</tt>'s iterators returns by value, it cannot be a C++17 forward 
iterator. (It can, however, be a C++20 <tt>forward_iterator</tt>.) However, <tt>iota_view</tt>'s 
iterator has an <tt>iterator_category</tt> that (sometimes) falsely claims that it is forward or 
better (depending on the properties of the <tt>weakly_incrementable</tt> type it wraps).
</p>

<p><i>[2019-10-19 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after eight positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/range.iota.iterator">[range.iota.iterator]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
namespace std::ranges {
  template&lt;class W, class Bound&gt;
  struct iota_view&lt;W, Bound&gt;::iterator {
  private:
    [&hellip;]
  public:
    using iterator_c<ins>oncept</ins><del>ategory</del> = <i>see below</i>;
    <ins>using iterator_category = input_iterator_tag;</ins>
    using value_type = W;
    using difference_type = <i>IOTA-DIFF-T</i>(W);
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
<p>
-1- <tt>iterator::iterator_c<ins>oncept</ins><del>ategory</del></tt> is defined as follows:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; If <tt>W</tt> models <tt><i>advanceable</i></tt>, then 
<tt>iterator_c<ins>oncept</ins><del>ategory</del></tt> is <tt>random_access_iterator_tag</tt>.</p></li>
<li><p>(1.2) &mdash; Otherwise, if <tt>W</tt> models <tt><i>decrementable</i></tt>, then 
<tt>iterator_c<ins>oncept</ins><del>ategory</del></tt> is <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(1.3) &mdash; Otherwise, if <tt>W</tt> models <tt>incrementable</tt>, then 
<tt>iterator_c<ins>oncept</ins><del>ategory</del></tt> is <tt>forward_iterator_tag</tt>.</p></li>
<li><p>(1.4) &mdash; Otherwise, <tt>iterator_c<ins>oncept</ins><del>ategory</del></tt> is 
<tt>input_iterator_tag</tt>.</p></li>
</ol>

</blockquote>
</li>

</ol>





<hr>
<h3><a name="3292" href="3292">3292.</a> <tt>iota_view</tt> is under-constrained</h3>
<p><b>Section:</b> 24.6.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iota.view">[range.iota.view]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2019-09-13 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/p1207r4">P1207R4</a> changed <tt>weakly_incrementable</tt> from requiring 
<tt>semiregular</tt> to requiring <tt>default_constructible &amp;&amp; movable</tt>.
<p/>
<tt>iota_view</tt> currently is specified to require that <tt>W</tt> be just <tt>weakly_incrementable</tt>. 
But we have to copy the <tt>W</tt> from the view into its iterator and also in <tt>operator*()</tt> to 
return a <tt>W</tt>.
<p/>
The shortest resolution is just to add "<tt> &amp;&amp; semiregular&lt;W&gt;</tt>" to the class 
constraints.
</p>
<p><i>[Status to ready after discussion Friday morning in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.6.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iota.view">[range.iota.view]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  [&hellip;]
  template&lt;weakly_incrementable W, semiregular Bound = unreachable_sentinel_t&gt;
    requires <i>weakly-equality-comparable-with</i>&lt;W, Bound&gt; <ins>&amp;&amp; semiregular&lt;W&gt;</ins>
  class iota_view : public view_interface&lt;iota_view&lt;W, Bound&gt; {
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>

</li>

</ol>





<hr>
<h3><a name="3293" href="3293">3293.</a> <tt>move_iterator operator+()</tt> has incorrect constraints</h3>
<p><b>Section:</b> 23.5.3.8 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nonmember">[move.iter.nonmember]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Bo Persson <b>Opened:</b> 2019-09-13 <b>Last modified:</b> 2019-11-04 20:10:00 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#move.iter.nonmember">active issues</a> in [move.iter.nonmember].</p>
<p><b>View all other</b> <a href="lwg-index.html#move.iter.nonmember">issues</a> in [move.iter.nonmember].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Section 23.5.3.8 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nonmember">[move.iter.nonmember]</a>/2-3 says:
</p>
<blockquote>
<pre>
template&lt;class Iterator&gt;
  constexpr move_iterator&lt;Iterator&gt;
    operator+(iter_difference_t&lt;Iterator&gt; n, const move_iterator&lt;Iterator&gt;&amp; x);
</pre>
<blockquote>
<p>
<i>Constraints:</i> <tt>x + n</tt> is well-formed and has type <tt>Iterator</tt>.
<p/>
<i>Returns:</i> <tt>x + n</tt>.
</p>
</blockquote>
</blockquote>
<p>
However, the return type of this operator is <tt>move_iterator&lt;Iterator&gt;</tt>, so
the expression <tt>x + n</tt> ought to have that type. Also, there is no <tt>operator+</tt> 
that matches the constraints, so it effectively disables the addition.
</p>

<p><i>[2019-10-31 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 23.5.3.8 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nonmember">[move.iter.nonmember]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Iterator&gt;
  constexpr move_iterator&lt;Iterator&gt;
    operator+(iter_difference_t&lt;Iterator&gt; n, const move_iterator&lt;Iterator&gt;&amp; x);
</pre>
<blockquote>
<p>
-2- <i>Constraints:</i> <tt>x + n</tt> is well-formed and has type <tt><ins>move_iterator&lt;</ins>Iterator<ins>&gt;</ins></tt>.
<p/>
-3- <i>Returns:</i> <tt>x + n</tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2019-11-04; Casey comments and provides revised wording]</i></p>

<p>
After applying the P/R the <i>Constraint</i> element requires <tt>x + n</tt> to be well-formed (it always is, 
since that operation is unconstrained) and requires <tt>x + n</tt> to have type 
<tt>move_iterator&lt;Iterator&gt;</tt> (which it always does). Consequently, this <i>Constraint</i> 
is always satisfied and it has no normative effect. The intent of the change in 
<a href="http://wg21.link/p0896r4">P0896R4</a> was that this operator be constrained to require 
addition on the base iterator to be well-formed and have type <tt>Iterator</tt>, which ensures that 
the other semantics of this operation are implementable.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 23.5.3.8 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nonmember">[move.iter.nonmember]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Iterator&gt;
  constexpr move_iterator&lt;Iterator&gt;
    operator+(iter_difference_t&lt;Iterator&gt; n, const move_iterator&lt;Iterator&gt;&amp; x);
</pre>
<blockquote>
<p>
-2- <i>Constraints:</i> <tt>x<ins>.base()</ins> + n</tt> is well-formed and has type <tt>Iterator</tt>.
<p/>
-3- <i>Returns:</i> <tt>x + n</tt>.
</p>
</blockquote>
</blockquote>

</li>

</ol>




<hr>
<h3><a name="3294" href="3294">3294.</a> <tt>zoned_time</tt> deduction guides misinterprets <tt>string</tt>/<tt>char*</tt></h3>
<p><b>Section:</b> 27.11.7.1 <a href="https://timsong-cpp.github.io/cppwp/time.zone.zonedtime.overview">[time.zone.zonedtime.overview]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Tomasz Kami&nacute;ski <b>Opened:</b> 2019-09-14 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#time.zone.zonedtime.overview">issues</a> in [time.zone.zonedtime.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current deduction guide for <code>zoned_time</code> for the following declarations
</p>
<blockquote>
<pre>
zoned_time zpc("America/New_York", std::chrono::system_clock::now());
zoned_time zps(std::string("America/New_York"), std::chrono::system_clock::now());
</pre>
</blockquote>
<p>
will attempt to produce a <code>zoned_time</code> instance with <code>const char*</code> 
(for <tt>zpc</tt>) and with <code>std::string</code> (for <tt>zps</tt>), respectively, 
as the deduced type for the <tt>TimeZonePtr</tt> template parameter. This is caused by 
the fact that the unconstrained <code>TimeZonePtr</code> deduction guide template will 
produce better candidates and will be selected by overload resolution.
<p/>
The proposed resolution merges the deduction of the 
<code>std::string_view</code>/<code>TimeZonePtr</code> deduction guides
into one guide, that deduces <code>const time_zone*</code> for any type
convertible to <code>string_view</code>. This is necessary to override
the deduction from <code>TimeZonePtr</code> constructor candidates.
<p/>
In addition, we disable the deduction from <code>string_view</code>
constructors, that would produce better candidates than the deduction guides
and create <code>zoned_time</code> instances with durations coarser than
<code>seconds</code> (causing similar issue as LWG <a href="3232">3232</a>):
</p>
<blockquote>
<pre>
std::chrono::local_time&lt;hours&gt; lh(10h);
std::chrono::zoned_time zt1("Europe/Helsinki", lh);
std::chrono::zoned_time zt2(std::string("Europe/Helsinki"), lh);
std::chrono::zoned_time zt3(std::string_view("Europe/Helsinki"), lh);
</pre>
</blockquote>
<p>
Without disabling the deduction from the <code>string_view</code>
constructor, the type of the <code>zt3</code> variable would be deduced to 
<code>zoned_time&lt;hours&gt;</code>, with the proposed change the types
of the variables <code>zt1</code>, <code>zt2</code>, and <code>zt3</code> 
are consistently deduced as <code>zoned_time&lt;seconds&gt;</code>.
<p/>
Finally, the wording eliminates the unnecessary <code>zoned_time&lt;Duration&gt;</code> 
guide (covered by <code>zoned_time&lt;Duration, TimeZonePtr2&gt;</code>).
<p/>
The change was implemented in the example implementation. The dedicated
test can be found 
<a href="https://github.com/HowardHinnant/date/blob/master/test/tz_test/zoned_time_deduction.pass.cpp">here</a>.
</p>

<p><i>[2019-10-31 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after five positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 27.11.7.1 <a href="https://timsong-cpp.github.io/cppwp/time.zone.zonedtime.overview">[time.zone.zonedtime.overview]</a>, class template <tt>zoned_time</tt> 
synopsis, as indicated:</p>

<blockquote>
<blockquote>
<pre>
namespace std::chrono {
  [&hellip;]
  zoned_time() -&gt; zoned_time&lt;seconds&gt;;
  
  template&lt;class Duration&gt;
    zoned_time(sys_time&lt;Duration&gt;)
      -&gt; zoned_time&lt;common_type_t&lt;Duration, seconds&gt;&gt;;
      
  <ins>template&lt;class TimeZonePtrOrName&gt;
    using <i>time-zone-representation</i> =
      conditional_t&lt;is_convertible_v&lt;TimeZonePtrOrName, string_view&gt;, 
        const time_zone*,
        remove_cv_ref&lt;TimeZonePtrOrName&gt;&gt;; <i>// exposition only</i>

  template&lt;class TimeZonePtrOrName&gt;
    zoned_time(TimeZonePtrOrName&amp;&amp;)
      -&gt; zoned_time&lt;seconds, <i>time-zone-representation</i>&lt;TimeZonePtr&gt;&gt;;</ins>
  
  template&lt;class TimeZonePtr<ins>OrName</ins>, class Duration&gt;
    zoned_time(TimeZonePtr<ins>OrName&amp;&amp;</ins>, sys_time&lt;Duration&gt;)
      -&gt; zoned_time&lt;common_type_t&lt;Duration, seconds&gt;, 
        <ins><i>time-zone-representation</i>&lt;</ins>TimeZonePtr<ins>OrName&gt;</ins>&gt;;
  
  template&lt;class TimeZonePtr<ins>OrName</ins>, class Duration&gt;
    zoned_time(TimeZonePtr<ins>OrName&amp;&amp;</ins>, local_time&lt;Duration&gt;, choose = choose::earliest)
      -&gt; zoned_time&lt;common_type_t&lt;Duration, seconds&gt;, 
        <ins><i>time-zone-representation</i>&lt;</ins>TimeZonePtr<ins>OrName&gt;</ins>&gt;;
  
  <del>template&lt;class TimeZonePtr, class Duration&gt;
    zoned_time(TimeZonePtr, zoned_time&lt;Duration&gt;, choose = choose::earliest)
      -&gt;> zoned_time&lt;common_type_t&lt;Duration, seconds&gt;, TimeZonePtr&gt;;
  
  zoned_time(string_view) -&gt; zoned_time&lt;seconds&gt;;

  template&lt;class Duration&gt;
    zoned_time(string_view, sys_time&lt;Duration&gt;)
      -&gt; zoned_time&lt;common_type_t&lt;Duration, seconds&gt;&gt;;
  
  template&lt;class Duration&gt;
    zoned_time(string_view, local_time&lt;Duration&gt;, choose = choose::earliest)
      -&gt; zoned_time&lt;common_type_t&lt;Duration, seconds&gt;&gt;;</del>
  
  template&lt;class Duration, class TimeZonePtr<ins>OrName</ins>, class TimeZonePtr2&gt;
    zoned_time(TimeZonePtr<ins>OrName&amp;&amp;</ins>, zoned_time&lt;Duration, TimeZonePtr2&gt;, choose = choose::earliest)
     -&gt; zoned_time&lt;Duration, <ins><i>time-zone-representation</i>&lt;</ins>TimeZonePtr<ins>OrName&gt;</ins>&gt;;
}
</pre>
</blockquote>
<p>
-1- <tt>zoned_time</tt> represents a logical pairing of a <tt>time_zone</tt> and a <tt>time_point</tt> 
with precision <tt>Duration</tt>. <tt>zoned_time&lt;Duration&gt;</tt> maintains the invariant that it 
always refers to a valid time zone and represents a point in time that exists and is not ambiguous in 
that time zone.
<p/>
-2- If <tt>Duration</tt> is not a specialization of <tt>chrono::duration</tt>, the program is ill-formed.
<p/>
<ins>-?- Every constructor of <tt>zoned_time</tt> that accepts a <tt>string_view</tt> as first parameter 
does not participate in class template argument deduction (12.4.1.8 <a href="https://timsong-cpp.github.io/cppwp/over.match.class.deduct">[over.match.class.deduct]</a>).</ins>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3296" href="3296">3296.</a> Inconsistent default argument for <tt>basic_regex&lt;&gt;::assign</tt></h3>
<p><b>Section:</b> 30.8 <a href="https://timsong-cpp.github.io/cppwp/re.regex">[re.regex]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Mark de Wever <b>Opened:</b> 2019-09-16 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#re.regex">active issues</a> in [re.regex].</p>
<p><b>View all other</b> <a href="lwg-index.html#re.regex">issues</a> in [re.regex].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The declaration of the overload of <tt>basic_regex&lt;&gt;::assign(const charT* p, size_t len, flag_type f)</tt>
has an inconsistent default argument for the <tt>flag_type f</tt> parameter.
<p/>
30.8 <a href="https://timsong-cpp.github.io/cppwp/re.regex">[re.regex]</a> p3:
</p>
<blockquote><pre>
basic_regex&amp; assign(const charT* p, size_t len, flag_type f);
</pre></blockquote>
<p>
30.8.2 <a href="https://timsong-cpp.github.io/cppwp/re.regex.assign">[re.regex.assign]</a> before p12:
</p>
<blockquote><pre>
basic_regex&amp; assign(const charT* ptr, size_t len, flag_type f = regex_constants::ECMAScript);
</pre></blockquote>
<p>
Since all other overloads have a default argument in both 30.8 <a href="https://timsong-cpp.github.io/cppwp/re.regex">[re.regex]</a> and
30.8.2 <a href="https://timsong-cpp.github.io/cppwp/re.regex.assign">[re.regex.assign]</a> I propose to add a default argument for this overload
in the declaration in 30.8 <a href="https://timsong-cpp.github.io/cppwp/re.regex">[re.regex]</a>.
<p/>
It should be pointed out that there exists implementation divergence due to the current
wording state: libc++ and libstdc++ do <em>not</em> implement the default argument.
The MS STL library <em>does</em> have the default argument.
</p>

<p><i>[2019-10-31 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after six positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 30.8 <a href="https://timsong-cpp.github.io/cppwp/re.regex">[re.regex]</a>, class template <tt>basic_regex</tt> synopsis, 
as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<i>// 30.8.2 <a href="https://timsong-cpp.github.io/cppwp/re.regex.assign">[re.regex.assign]</a>, assign</i>
[&hellip;]
basic_regex&amp; assign(const charT* ptr, flag_type f = regex_constants::ECMAScript);
basic_regex&amp; assign(const charT* p, size_t len, flag_type f <ins>= regex_constants::ECMAScript</ins>);
template&lt;class string_traits, class A&gt;
  basic_regex&amp; assign(const basic_string&lt;charT, string_traits, A&gt;&amp; s,
                      flag_type f = regex_constants::ECMAScript);
template&lt;class InputIterator&gt;
  basic_regex&amp; assign(InputIterator first, InputIterator last,
                      flag_type f = regex_constants::ECMAScript);
basic_regex&amp; assign(initializer_list&lt;charT&gt;,
                    flag_type = regex_constants::ECMAScript);
[&hellip;]
</pre>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3297" href="3297">3297.</a> Useless sequence container requirement</h3>
<p><b>Section:</b> 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-09-17 <b>Last modified:</b> 2019-10-31 18:46:30 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#sequence.reqmts">active issues</a> in [sequence.reqmts].</p>
<p><b>View all other</b> <a href="lwg-index.html#sequence.reqmts">issues</a> in [sequence.reqmts].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> paragraph 3 says that the names <tt>i</tt> and <tt>j</tt> denote 
"iterators that meet the <i>Cpp17InputIterator</i> requirements and refer to elements implicitly 
convertible to <tt>value_type</tt>". Ignoring for the moment that this is an occurrence of LWG 
<a href="3105">3105</a> &mdash; we really mean that <tt>*i</tt> and <tt>*j</tt> must be implicitly 
convertible to <tt>value_type</tt> &mdash; this requirement seems to be completely extraneous.
<p/>
The names <tt>i</tt> and <tt>j</tt> are used in three places in the requirements table:
</p>
<ul>
<li><p>The range constructors <tt>X(i, j)</tt> and <tt>X u(i, j)</tt>, which require that the 
container's value type is <i>Cpp17EmplaceConstructible</i> into the container from <tt>*i</tt>; 
implicit conversion is neither necessary nor sufficient.</p></li>
<li><p>The range insert overload <tt>a.insert(p, i, j)</tt> which also requires <i>Cpp17EmplaceConstructible</i>, 
as well as the capability to move elements around for <tt>vector</tt> and <tt>deque</tt>; again, 
implicit conversion is neither necessary nor sufficient. It <em>would</em> be useful / performant 
here to require that the container's value type is assignable from <tt>*i</tt>, which may have 
been the intent of the implicit conversion requirement &mdash; would doing so be too breaking?</p></li>
<li><p>The range assign overload <tt>a.assign(i, j)</tt> which requires both 
<i>Cpp17EmplaceConstructible</i> as above and that it can assign the result of dereferencing an 
iterator directly to the container's value type; again, implicit conversion is not useful here.</p></li>
</ul>
<p>
We should strike the implicit conversion requirement since it is not useful and only serves to confuse 
readers of the Standard (see e.g. <a href="https://github.com/microsoft/STL/issues/107">here</a>).
</p>

<p><i>[2019-10-31 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a> as indicated:</p>

<blockquote>
<p>
-3- In Tables 76 and 77, <tt>X</tt> denotes a sequence container class, <tt>a</tt> denotes a value 
of type <tt>X</tt> containing elements of type <tt>T</tt>, <tt>u</tt> denotes the name of a variable 
being declared, <tt>A</tt> denotes <tt>X::allocator_type</tt> if the <i>qualified-id</i>
<tt>X::allocator_type</tt> is valid and denotes a type (13.10.2 <a href="https://timsong-cpp.github.io/cppwp/temp.deduct">[temp.deduct]</a>) and 
<tt>allocator&lt;T&gt;</tt> if it doesn't, <tt>i</tt> and <tt>j</tt> denote iterators that meet 
the <i>Cpp17InputIterator</i> requirements <del>and refer to elements implicitly convertible to
<tt>value_type</tt></del>, <tt>[i, j)</tt> denotes a valid range, [&hellip;]
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3299" href="3299">3299.</a> Pointers don't need customized iterator behavior</h3>
<p><b>Section:</b> 23.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.move">[iterator.cust.move]</a>, 23.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.swap">[iterator.cust.swap]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-10-07 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.cust.move">active issues</a> in [iterator.cust.move].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.cust.move">issues</a> in [iterator.cust.move].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It is not intentional design that users may customize the behavior of
<tt>ranges::iter_move</tt> (23.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.move">[iterator.cust.move]</a>) and
<tt>ranges::iter_swap</tt> (23.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.swap">[iterator.cust.swap]</a>)  for pointers to program-defined
type by defining e.g. <tt>iter_move(my_type*)</tt> or <tt>iter_swap(my_type*, my_type*)</tt> in a
namespace associated with <tt>my_type</tt>. The intent of customization points is that users may
define behavior for types they define, not that users may mess with the well-defined semantics for
existing types like pointers.
</p><p>
We should forbid such silliness by constraining the "finds an overload via ADL" cases for
customization points to only trigger with argument expressions of class or enumeration type. Note
that WG21 made a similar change to <tt>ranges::swap</tt> shortly before merging it into the working
draft to forbid users customizing behavior for pointers to program-defined types or arrays of
program-defined types.
</p>

<p><i>[2019-11-16 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after seven positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<blockquote class="note"><p>
[<i>Drafting note:</i> <a href="3247">3247</a> touches the same wording in
23.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.move">[iterator.cust.move]</a>; if both are resolved simultaneously the changes should be
reconciled before passing them on to the Editor.]
</p></blockquote>

<ol>
<li><p>Modify 23.3.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.move">[iterator.cust.move]</a> as follows:</p>

<blockquote><p>
(1.1) &mdash; <tt>iter_move(E)</tt>, if <del>that expression is valid,</del> <ins><tt>E</tt> has
class or enumeration type and <tt>iter_move(E)</tt> is a well-formed expression</ins> with overload
resolution performed in a context that does not include a declaration of <tt>ranges::iter_move</tt>.
</p></blockquote>
</li>

<li><p>Modify 23.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.swap">[iterator.cust.swap]</a> as follows:</p>

<blockquote><p>
(4.1) &mdash; <tt>(void)iter_swap(E1, E2)</tt>, if <del>that expression is valid,</del> <ins>either
<tt>E1</tt> or <tt>E2</tt> has class or enumeration type and <tt>iter_swap(E1, E2)</tt> is a
well-formed expression</ins> with overload resolution performed in a context that includes the
declaration
<blockquote><pre>
template&lt;class I1, class I2&gt;
void iter_swap(I1, I2) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::iter_swap</tt>. If the function selected by
overload resolution does not exchange the values denoted by <tt>E1</tt> and <tt>E2</tt>, the program
is ill-formed with no diagnostic required.
</p></blockquote>
</li>
</ol>





<hr>
<h3><a name="3300" href="3300">3300.</a> Non-array <tt>ssize</tt> overload is underconstrained</h3>
<p><b>Section:</b> 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-09-27 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.range">active issues</a> in [iterator.range].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.range">issues</a> in [iterator.range].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The overload of <tt>ssize</tt> specified in 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a>/18 has no constraints, 
yet it specializes <tt>make_signed_t</tt> which has a precondition that its type parameter is an 
integral type or enumeration but not <tt>bool</tt> (20.15.7.3 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.sign">[meta.trans.sign]</a>). This 
precondition needs to be propagated to <tt>ssize</tt> as "<i>Mandates</i> [or <i>Constraints</i>]: 
<tt>decltype(c.size())</tt> [meets the requirements for the type argument to <tt>make_signed</tt>]". 
"<i>Mandates</i>" seems to be more in line with LWG guidance since there are no traits nor concepts 
that observe <tt>ssize</tt>.
</p>

<p><i>[2019-11-16 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class C&gt; constexpr auto ssize(const C&amp; c)
  -&gt; common_type_t&lt;ptrdiff_t, make_signed_t&lt;decltype(c.size())&gt;&gt;;
</pre>
<blockquote>
<p>
<ins>-?- <i>Mandates:</i> <tt>decltype(c.size())</tt> is a (possibly <i>cv</i>-qualified) integral or 
enumeration type but not a <tt>bool</tt> type.</ins>
<p/>
-18- <i>Returns:</i>
<blockquote>
<pre>
static_cast&lt;common_type_t&lt;ptrdiff_t, make_signed_t&lt;decltype(c.size())&gt;&gt;&gt;(c.size())
</pre>
</blockquote>
</p>
</blockquote>
</blockquote>
</li>

</ol></blockquote>

<p><i>[2019-10-28; Tim provides improved wording]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class C&gt; constexpr auto ssize(const C&amp; c)
  -&gt; common_type_t&lt;ptrdiff_t, make_signed_t&lt;decltype(c.size())&gt;&gt;;
</pre>
<blockquote>
<p>
<ins>-?- <i>Mandates:</i> <tt>decltype(c.size())</tt> is an integral or enumeration type
other than <tt>bool</tt>.</ins>
<p/>
-18- <i>Returns:</i>
<blockquote>
<pre>
static_cast&lt;common_type_t&lt;ptrdiff_t, make_signed_t&lt;decltype(c.size())&gt;&gt;&gt;(c.size())
</pre>
</blockquote>
</p>
</blockquote>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2019-11-18; Casey comments and improves wording]</i></p>

<p>
It would be better to provided the <i>Mandates:</i> guarantee in [tab:meta.trans.sign] instead of
one special place where the <tt>make_signed</tt> template is used. The wording below attempts to 
realize that.
</p>

<p><i>[2019-11-23 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready after five positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Change Table 52 &mdash; "Sign modifications" in  [tab:meta.trans.sign] as indicated:</p>

<table border="1">
<caption>Table 52 &mdash; Sign modifications [tab:meta.trans.sign]</caption>
<tr>
<th>Template</th>
<th>Comments</th>
</tr> 

<tr>
<td>
<tt>template &lt;class T&gt;<br/>
struct make_signed;</tt>
</td>
<td>
If <tt>T</tt> names a (possibly <i>cv</i>-qualified) signed integer type (6.8.1 <a href="https://timsong-cpp.github.io/cppwp/basic.fundamental">[basic.fundamental]</a>) then<br/>
the member typedef <tt>type</tt> names the type <tt>T</tt>; otherwise, if <tt>T</tt> names a<br/>
(possibly <i>cv</i>-qualified) unsigned integer type then <tt>type</tt> names the<br/>
corresponding signed integer type, with the same <i>cv</i>-qualifiers as <tt>T</tt>;<br/>
otherwise, <tt>type</tt> names the signed integer type with smallest<br/>
rank (6.8.4 <a href="https://timsong-cpp.github.io/cppwp/conv.rank">[conv.rank]</a>) for which <tt>sizeof(T) == sizeof(type)</tt>, with the same<br/>
<i>cv</i>-qualifiers as <tt>T</tt>.<br/>
<i><del>Requires</del><ins>Mandates</ins>:</i> <tt>T</tt> <del>shall be</del><ins>is</ins> a<ins>n</ins> <del>(possibly <i>cv</i>-qualified)</del> integral <del>type</del> or enumeration <ins>type other than <i>cv</i></ins> <del>but not a</del> <tt>bool</tt> <del>type</del>.
</td>
</tr>

<tr>
<td>
<tt>template &lt;class T&gt;<br/>
struct make_unsigned;</tt>
</td>
<td>
If <tt>T</tt> names a (possibly <i>cv</i>-qualified) unsigned integer type (6.8.1 <a href="https://timsong-cpp.github.io/cppwp/basic.fundamental">[basic.fundamental]</a>) then<br/>
the member typedef <tt>type</tt> names the type <tt>T</tt>; otherwise, if <tt>T</tt> names a<br/>
(possibly <i>cv</i>-qualified) signed integer type then <tt>type</tt> names the<br/>
corresponding unsigned integer type, with the same <i>cv</i>-qualifiers as <tt>T</tt>;<br/>
otherwise, <tt>type</tt> names the unsigned integer type with smallest<br/>
rank (6.8.4 <a href="https://timsong-cpp.github.io/cppwp/conv.rank">[conv.rank]</a>) for which <tt>sizeof(T) == sizeof(type)</tt>, with the same<br/>
<i>cv</i>-qualifiers as <tt>T</tt>.<br/>
<i><del>Requires</del><ins>Mandates</ins>:</i> <tt>T</tt> <del>shall be</del><ins>is</ins> a<ins>n</ins> <del>(possibly <i>cv</i>-qualified)</del> integral <del>type</del> or enumeration <ins>type other than <i>cv</i></ins> <del>but not a</del> <tt>bool</tt> <del>type</del>.
</td>
</tr>
</table>

</li>

<li><p>Change 23.7 <a href="https://timsong-cpp.github.io/cppwp/iterator.range">[iterator.range]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class C&gt; constexpr auto ssize(const C&amp; c)
  -&gt; common_type_t&lt;ptrdiff_t, make_signed_t&lt;decltype(c.size())&gt;&gt;;
</pre>
<blockquote>
<p>
-18- <i><del>Returns</del><ins>Effects</ins>:</i> <ins>Equivalent to:</ins>
<blockquote>
<pre>
<ins>return</ins> static_cast&lt;common_type_t&lt;ptrdiff_t, make_signed_t&lt;decltype(c.size())&gt;&gt;&gt;(c.size())<ins>;</ins>
</pre>
</blockquote>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3301" href="3301">3301.</a> <tt>transform_view::iterator</tt> has incorrect <tt>iterator_category</tt></h3>
<p><b>Section:</b> 24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Michel Morin <b>Opened:</b> 2019-10-03 <b>Last modified:</b> 2020-02-10 19:48:51 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
When the transformation function returns an rvalue, <tt>transform_view::iterator</tt> 
cannot model <tt><i>cpp17-forward-iterator</i></tt>. However, similar to LWG <a href="3291">3291</a>,
the current wording on <tt>transform_view::iterator::iterator_category</tt> does not 
consider this.
<p/>
As Casey Carter pointed out <a href="https://github.com/ericniebler/stl2/issues/637#issuecomment-535594100">here</a>,
the proposed wording below does not consider <tt>input_iterator</tt> that is not 
<tt><i>cpp17-input-iterator</i></tt> (this problem is not specific to the PR; it's pervasive 
in adapted iterators) and concepts-based determination would be a better fix for issues around 
<tt>iterator_category</tt>. But anyway, I consider this PR as a minimal fix at the moment.
</p>

<p><i>[2019-10-31 Issue Prioritization]</i></p>

<p>Priority to 1 after reflector discussion.</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a> as indicated:</p>

<blockquote>
<p>
-2- <ins><tt>iterator::iterator_category</tt> is defined as follows:</ins> 
Let <tt>C</tt> denote the type <tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt>.
</p>
<ol style="list-style-type: none">
<li><p><ins>(2.?) &mdash; If <tt>is_lvalue_reference_v&lt;iter_reference_t&lt;iterator_t&lt;Base&gt;&gt;&gt;</tt> 
is <tt>true</tt>,</ins></p>
<ol style="list-style-type: none">
<li><p><ins>(2.?.?) &mdash;</ins> If <tt>C</tt> models <tt>derived_from&lt;contiguous_iterator_tag&gt;</tt>, 
then <tt>iterator_category</tt> denotes <tt>random_access_iterator_tag</tt>;</p></li>
<li><p><ins>(2.?.?) &mdash;</ins> <ins>O</ins><del>o</del>therwise, <tt>iterator_category</tt> denotes 
<tt>C</tt>.</p></li>
</ol>
</li>
<li><p><ins>(2.?) &mdash; Otherwise, <tt>iterator_category</tt> denotes 
<tt>input_iterator_tag</tt>.</ins></p></li>
</ol>
</blockquote>
</li>

</ol>
</blockquote>
<p><i>[2019-11-06, Tim updates P/R based on Belfast LWG evening session discussion]</i></p>

<p>
The check in the original P/R is incorrect; we want to check the transformation's result, not the base iterator.
</p>

<p><i>[2020-02-10 Move to Immediate Monday afternoon in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a> as indicated:</p>

<blockquote>
<p>
-2- <ins><tt>iterator::iterator_category</tt> is defined as follows:</ins> 
Let <tt>C</tt> denote the type <tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt>.
</p>
<ol style="list-style-type: none">
<li><p><ins>(2.?) &mdash; If <tt>is_lvalue_reference_v&lt;invoke_result_t&lt;F&amp;, range_reference_t&lt;Base&gt;&gt;&gt;</tt> 
is <tt>true</tt>,</ins></p>
<ol style="list-style-type: none">
<li><p><ins>(2.?.?) &mdash;</ins> If <tt>C</tt> models <tt>derived_from&lt;contiguous_iterator_tag&gt;</tt>, 
then <tt>iterator_category</tt> denotes <tt>random_access_iterator_tag</tt>;</p></li>
<li><p><ins>(2.?.?) &mdash;</ins> <ins>O</ins><del>o</del>therwise, <tt>iterator_category</tt> denotes 
<tt>C</tt>.</p></li>
</ol>
</li>
<li><p><ins>(2.?) &mdash; Otherwise, <tt>iterator_category</tt> denotes 
<tt>input_iterator_tag</tt>.</ins></p></li>
</ol>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3302" href="3302">3302.</a> Range adaptor objects <tt>keys</tt> and <tt>values</tt> are unspecified</h3>
<p><b>Section:</b> 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Michel Morin <b>Opened:</b> 2019-10-04 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#ranges.syn">active issues</a> in [ranges.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#ranges.syn">issues</a> in [ranges.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This issue was submitted as editorial issue 
<a href="https://github.com/cplusplus/draft/issues/3231">cplusplus/draft#3231</a> but had been
classified as non-editorial.
<p/>
<tt>keys</tt> and <tt>values</tt> are listed in 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>, but not specified.
It seems that <a href="http://wg21.link/p1035r7">P1035R7</a> forgot to specify them (as 
<tt>elements&lt;0&gt;</tt> and <tt>elements&lt;1&gt;</tt>).
</p>

<p><i>[2019-10-31 Issue Prioritization]</i></p>

<p>Priority to 1 after reflector discussion.</p>
<p><i>[2019-11 Wednesday night issue processing in Belfast.]</i></p>

<p>Status to Ready.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>, header <tt>&lt;ranges&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  [&hellip;]
  
  template&lt;class R&gt;
    using keys_view = elements_view&lt;all_view&lt;R&gt;, 0&gt;;
  template&lt;class R&gt;
    using values_view = elements_view&lt;all_view&lt;R&gt;, 1&gt;;
  namespace views {
    template&lt;size_t N&gt;
      inline constexpr <i>unspecified</i> elements = <i>unspecified</i>;
    inline constexpr <ins>auto</ins><del><i>unspecified</i></del> keys = <ins>elements&lt;0&gt;</ins><del><i>unspecified</i></del>;
    inline constexpr <ins>auto</ins><del><i>unspecified</i></del> values = <ins>elements&lt;1&gt;</ins><del><i>unspecified</i></del>;
  }  
}
[&hellip;]
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3303" href="3303">3303.</a> Bad "<tt>constexpr</tt>" marker for <tt>destroy/destroy_n</tt></h3>
<p><b>Section:</b> 20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2019-10-10 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This issue was submitted as editorial issue 
<a href="https://github.com/cplusplus/draft/issues/3181">cplusplus/draft#3181</a> but is 
considered non-editorial.
<p/>
<a href="http://wg21.link/p0784r7">P0784R7</a>, approved in Cologne, added "<tt>constexpr</tt>" markers to
the overloads of <tt>destroy</tt> and <tt>destroy_n</tt> taking an <tt>ExecutionPolicy</tt> 
parameter.  This seems to be in error; parallel algorithms should not be marked "<tt>constexpr</tt>".
(None of the parallel algorithms in <tt>&lt;algorithm&gt;</tt> is marked "<tt>constexpr</tt>".)
</p>
<p><i>[2019-11 Marked as 'Ready' during Monday issue prioritization in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>Modify 20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a>, header <tt>&lt;memory&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  [&hellip;]
  
  <i>// 20.10.11.9 <a href="https://timsong-cpp.github.io/cppwp/specialized.destroy">[specialized.destroy]</a>, destroy</i>
  template&lt;class T&gt;
    constexpr void destroy_at(T* location);
  template&lt;class ForwardIterator&gt;
    constexpr void destroy(ForwardIterator first, ForwardIterator last);
  template&lt;class ExecutionPolicy, class ForwardIterator&gt;
    <del>constexpr</del> void destroy(ExecutionPolicy&amp;&amp; exec, <i>// see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a></i>
                           ForwardIterator first, ForwardIterator last);
  template&lt;class ForwardIterator, class Size&gt;
    constexpr ForwardIterator destroy_n(ForwardIterator first, Size n);
  template&lt;class ExecutionPolicy, class ForwardIterator, class Size&gt;
    <del>constexpr</del> ForwardIterator destroy_n(ExecutionPolicy&amp;&amp; exec, <i>// see 25.3.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a></i>
                                        ForwardIterator first, Size n);  
  [&hellip;]
}
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3304" href="3304">3304.</a> Allocate functions of <tt>std::polymorphic_allocator</tt> should require <tt>[[nodiscard]]</tt></h3>
<p><b>Section:</b> 20.12.3 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.class">[mem.poly.allocator.class]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Hiroaki Ando <b>Opened:</b> 2019-10-16 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#mem.poly.allocator.class">active issues</a> in [mem.poly.allocator.class].</p>
<p><b>View all other</b> <a href="lwg-index.html#mem.poly.allocator.class">issues</a> in [mem.poly.allocator.class].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>[[nodiscard]]</tt> is specified for <tt>std::polymorphic_allocator&lt;&gt;::allocate()</tt>.
<p/>
But the allocate functions added with <a href="https://wg21.link/p0339r6">P0339R6</a> doesn't have it.
<p/>
Isn't <tt>[[nodiscard]]</tt> necessary for these functions?
</p>

<p><i>[2019-11 Priority to 3 during Monday issue prioritization in Belfast]</i></p>

<p><i>[2019-11 After discussion with LEWG, assigning to LEWG]</i></p>

<p><i>[2019-11-4; Daniel comments]</i></p>

<p>
This issue is related to LWG <a href="3312">3312</a>.
</p>
<p><i>[2019-11; Friday AM in Belfast. Status changed to "Ready"]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.12.3 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.class">[mem.poly.allocator.class]</a>, class template <tt>polymorphic_allocator</tt> 
synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std::pmr {
  template&lt;class Tp = byte&gt; class polymorphic_allocator {
    [&hellip;]
    <i>// 20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a>, member functions</i>
    [[nodiscard]] Tp* allocate(size_t n);
    void deallocate(Tp* p, size_t n);

    <ins>[[nodiscard]]</ins> void* allocate_bytes(size_t nbytes, size_t alignment = alignof(max_align_t));
    void deallocate_bytes(void* p, size_t nbytes, size_t alignment = alignof(max_align_t));
    template&lt;class T&gt; <ins>[[nodiscard]]</ins> T* allocate_object(size_t n = 1);
    template&lt;class T&gt; void deallocate_object(T* p, size_t n = 1);
    template&lt;class T, class... CtorArgs&gt; <ins>[[nodiscard]]</ins> T* new_object(CtorArgs&amp;&amp;... ctor_args);
    template&lt;class T&gt; void delete_object(T* p);  
    [&hellip;]
  };  
}
</pre>
</blockquote>
</li>

<li><p>Modify 20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a> as indicated:</p>

<blockquote>
<pre>
<ins>[[nodiscard]]</ins> void* allocate_bytes(size_t nbytes, size_t alignment = alignof(max_align_t));
</pre>
<blockquote>
<p>
-5- <i>Effects:</i> Equivalent to: <tt>return memory_rsrc-&gt;allocate(nbytes, alignment);</tt>
<p/>
[&hellip;]
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class T&gt;
  <ins>[[nodiscard]]</ins> T* allocate_object(size_t n = 1);
</pre>
<blockquote>
<p>
-8- <i>Effects:</i> Allocates memory suitable for holding an array of <tt>n</tt> objects of type <tt>T</tt>, as follows:
<ol style="list-style-type: none">
<li><p>(8.1) &mdash; if <tt>SIZE_MAX / sizeof(T) &lt; n</tt>, throws <tt>length_error</tt>,</p></li>
<li><p>(8.2) &mdash; otherwise equivalent to:</p>
<blockquote><pre>
return static_cast&lt;T*&gt;(allocate_bytes(n*sizeof(T), alignof(T)));
</pre></blockquote>
</li>
</ol>
<p/>
[&hellip;]
</p>
</blockquote>
<pre>
template&lt;class T, class CtorArgs...&gt;
  <ins>[[nodiscard]]</ins> T* new_object(CtorArgs&amp;&amp;... ctor_args);
</pre>
<blockquote>
<p>
-11- <i>Effects:</i> Allocates and constructs an object of type <tt>T</tt>, as follows.
Equivalent to:
<blockquote><pre>
T* p = allocate_object&lt;T&gt;();
try {
  construct(p, std::forward&lt;CtorArgs&gt;(ctor_args)...);
} catch (...) {
  deallocate_object(p);
  throw;
}
return p;
</pre></blockquote>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3305" href="3305">3305.</a> <tt>any_cast&lt;void&gt;</tt></h3>
<p><b>Section:</b> 20.8.4 <a href="https://timsong-cpp.github.io/cppwp/any.nonmembers">[any.nonmembers]</a> <b>Status:</b> <a href="lwg-active.html#Open">Open</a>
 <b>Submitter:</b> John Shaw <b>Opened:</b> 2019-10-16 <b>Last modified:</b> 2020-02-14 06:55:06 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#any.nonmembers">issues</a> in [any.nonmembers].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Open">Open</a> status.</p>
<p><b>Discussion:</b></p>
<blockquote><pre>
any foo;
void* p = any_cast&lt;void&gt;(&amp;foo);
</pre></blockquote>
<p>
Per 20.8.4 <a href="https://timsong-cpp.github.io/cppwp/any.nonmembers">[any.nonmembers]</a>/9, since the operand isn't <tt>nullptr</tt> and 
<tt>operand-&gt;type() == typeid(T)</tt> (because <tt>T = void</tt> in this case), we should 
return a pointer to the object contained by <tt>operand</tt>. But there is no such object.
<p/>
We need to handle the <tt>T = void</tt> case, probably by just explicitly returning <tt>nullptr</tt>.
</p>

<p><i>[2019-11 Priority to 2 during Monday issue prioritization in Belfast. There is implementation divergence here.]</i></p>

<p><i>[2020-02 Discussion in Prague did not reach consensus. Status to Open.]</i></p>

<p>There was discussion about whether or not <tt>any_cast&lt;void&gt;(a)</tt> should be ill-formed, or return <tt>nullptr</tt>.</p>
<p>Poll "should it return nullptr" was 0-4-5-5-1.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.8.4 <a href="https://timsong-cpp.github.io/cppwp/any.nonmembers">[any.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T&gt;
  const T* any_cast(const any* operand) noexcept;
template&lt;class T&gt;
  T* any_cast(any* operand) noexcept;
</pre>
<blockquote>
<p>
-9- <i>Returns:</i> If <tt>operand != nullptr &amp;&amp; operand-&gt;type() == typeid(T) <ins>&amp;&amp; 
is_object_v&lt;T&gt;</ins></tt>, a pointer to the object contained by <tt>operand</tt>; otherwise, 
<tt>nullptr</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3306" href="3306">3306.</a> <tt>ranges::advance</tt> violates its preconditions</h3>
<p><b>Section:</b> 23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-10-27 <b>Last modified:</b> 2019-11-16 13:50:32 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>Recall that "<tt>[i, s)</tt> denotes a range" for an iterator <tt>i</tt> and sentinel <tt>s</tt>
means that either <tt>i == s</tt> holds, or <tt>i</tt> is dereferenceable and <tt>[++i, s)</tt>
denotes a range ( [iterator.requirements.genera]).
</p><p>
The three-argument overload <tt>ranges::advance(i, n, bound)</tt> is specified in
23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a> paragraphs 5 through 7. Para 5 establishes a precondition that
<tt>[bound, i)</tt> denotes a range when <tt>n &lt; 0</tt> (both <tt>bound</tt> and <tt>i</tt> must
have the same type in this case). When <tt>sized_sentinel_for&lt;S, I&gt;</tt> holds and
<tt>n &lt; bound - i</tt>, para 6.1.1 says that <tt>ranges::advance(i, n, bound)</tt> is equivalent
to <tt>ranges::advance(i, bound)</tt>. Para 3, however, establishes a precondition for
<tt>ranges::advance(i, bound)</tt> that <tt>[i, bound)</tt> denotes a range. <tt>[bound, i)</tt> and
<tt>[i, bound)</tt> cannot both denote ranges unless <tt>i == bound</tt>, which is not the case for
all calls that reach 6.1.1.
</p><p>
The call in para 6.1.1 wants the effects of either 4.1 - which really has no preconditions - or 4.2,
which is well-defined if either <tt>[i, bound)</tt> or <tt>[bound, i)</tt> denotes a range. Para 3's
stronger precondition is actually only required by Para 4.3, which increments <tt>i</tt> blindly
looking for <tt>bound</tt>. The straight-forward fix here seems to be to relax para 3's precondition
to only apply when 4.3 will be reached.
</p>

<p><i>[2019-11 Priority to 2 during Monday issue prioritization in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  constexpr void ranges::advance(I&amp; i, S bound);
</pre>
<p>
-3- <i>Expects:</i> <ins>Either <tt>assignable_from&lt;I&amp;, S&gt; ||
sized_sentinel_for&lt;S, I&gt;</tt> is modeled, or</ins> <tt>[i, bound)</tt> denotes a range.
</p><p>
-4- <i>Effects:</i>
</p><p>
(4.1) &mdash; If <tt>I</tt> and <tt>S</tt> model <tt>assignable_from&lt;I&amp;, S&gt;</tt>,
equivalent to <tt>i = std::move(bound)</tt>.
</p><p>
(4.2) &mdash; Otherwise, if <tt>S</tt> and <tt>I</tt> model <tt>sized_sentinel_for&lt;S, I&gt;</tt>,
equivalent to <tt>ranges::advance(i, bound - i)</tt>.
</p><p>
(4.3) &mdash; Otherwise, while <tt>bool(i != bound)</tt> is <tt>true</tt>, increments <tt>i</tt>.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3307" href="3307">3307.</a> <tt>std::allocator&lt;void&gt;().allocate(n)</tt></h3>
<p><b>Section:</b> 20.10.10 <a href="https://timsong-cpp.github.io/cppwp/default.allocator">[default.allocator]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-10-25 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#default.allocator">active issues</a> in [default.allocator].</p>
<p><b>View all other</b> <a href="lwg-index.html#default.allocator">issues</a> in [default.allocator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In C++20 the <tt>std::allocator&lt;void&gt;</tt> explicit specialization is gone, which means it uses the 
primary template, which has allocate and deallocate members.
<p/>
Although it's implied by the use of <tt>sizeof(T)</tt>, <tt>std::allocator&lt;T&gt;::allocate</tt> 
doesn't have an explicit precondition that the value type is complete.
</p>

<p><i>[2019-11 Status to 'Ready' in Monday issue prioritization in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.10.10.1 <a href="https://timsong-cpp.github.io/cppwp/allocator.members">[allocator.members]</a> as indicated:</p>

<blockquote>
<pre>
[[nodiscard]] constexpr T* allocate(size_t n);
</pre>
<p>
<ins>-?- <i>Mandates:</i> <tt>T</tt> is not an incomplete type (6.8 <a href="https://timsong-cpp.github.io/cppwp/basic.types">[basic.types]</a>).</ins>
<p/>
-2- <i>Returns:</i> A pointer to the initial element of an array of storage of size 
<tt>n * sizeof(T)</tt>, aligned appropriately for objects of type <tt>T</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3308" href="3308">3308.</a> <tt>vector</tt> and <tt>deque</tt> iterator <tt>erase</tt> invalidates elements even when no change occurs</h3>
<p><b>Section:</b> 22.3.8.4 <a href="https://timsong-cpp.github.io/cppwp/deque.modifiers">[deque.modifiers]</a>, 22.3.11.5 <a href="https://timsong-cpp.github.io/cppwp/vector.modifiers">[vector.modifiers]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2019-10-29 <b>Last modified:</b> 2019-11-04 18:40:23 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#deque.modifiers">issues</a> in [deque.modifiers].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It seems incorrect that a container would invalidate anything as a result of being asked to erase 0 elements. 
This came up in a recent customer bug report against Visual Studio, where given a <tt>vector v</tt>, 
<tt>v.erase(v.begin(), v.begin())</tt> triggered a self-assignment of all the elements in the vector. 
<p/>
<tt>deque</tt> has language enumerating erasures of the first and last element which invalidate fewer 
iterators, and a fallback that says all iterators are invalidated, which seems to intend to be talking about middle-of-container erasures. However, erasing 0 elements isn't really a middle of container erasure.
<p/>
<tt>vector</tt> says that iterators and references are invalidated after the 'point of the erase', but when 0 
elements are erased it's unclear what that even means.
<p/>
We should say that erasures that erase 0 elements are no ops and be clearer about which elements are 
invalidated for <tt>vector</tt>.
</p>

<p><i>[2019-11 Priority to 3 during Monday issue prioritization in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 22.3.8.4 <a href="https://timsong-cpp.github.io/cppwp/deque.modifiers">[deque.modifiers]</a> as indicated:</p>

<blockquote>
<pre>
iterator erase(const_iterator position);
iterator erase(const_iterator first, const_iterator last);
void pop_front();
void pop_back();
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> <ins>Erases elements as indicated in Table 75 [tab:container.seq.req].</ins> 
An erase operation that erases the last element of a deque invalidates only the past-the-end 
iterator and all iterators and references to the erased elements. An erase operation that erases 
the first element of a deque but not the last element invalidates only iterators and references 
to the erased elements. An erase operation that erases <ins>any elements, but</ins> neither the 
first element nor the last element of a deque invalidates the past-the-end iterator and all 
iterators and references to all the elements of the deque. <del>[<i>Note:</i> <tt>pop_front</tt> 
and <tt>pop_back</tt> are erase operations. &mdash; <i>end note</i>]</del>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.3.11.5 <a href="https://timsong-cpp.github.io/cppwp/vector.modifiers">[vector.modifiers]</a> as indicated:</p>

<blockquote>
<pre>
constexpr iterator erase(const_iterator position);
constexpr iterator erase(const_iterator first, const_iterator last);
constexpr void pop_back();
</pre>
<blockquote>
<p>
-3- <i>Effects:</i> <ins>Erases elements as indicated in Table 75 [tab:container.seq.req].</ins> 
Invalidates iterators and references at or after the <del>point of the erase.</del><ins>first erased 
element. [<i>Note:</i> For the second overload of <tt>erase</tt>, if <tt>first == last</tt>, no 
elements are erased, and no iterators or references are invalidated. &mdash; <i>end note</i>]</ins>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3309" href="3309">3309.</a> Is <tt>&lt;ios&gt;</tt> implicitly <tt>#include</tt>d by <tt>&lt;sstream&gt;</tt>, <tt>&lt;fstream&gt;</tt> etc.?</h3>
<p><b>Section:</b> 29.8 <a href="https://timsong-cpp.github.io/cppwp/string.streams">[string.streams]</a>, 29.9 <a href="https://timsong-cpp.github.io/cppwp/file.streams">[file.streams]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2019-11-01 <b>Last modified:</b> 2019-11-04 13:23:43 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#string.streams">issues</a> in [string.streams].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It is unclear whether the streams headers implicitly <tt>#include &lt;ios&gt;</tt> and make (for example) 
the name <tt>std::basic_ios</tt> available after including <tt>&lt;sstream&gt;</tt>.
<p/>
This question becomes more important as header units arrive with modules, where there is an explicit 
choice whether to re-export names from subordinate headers.
</p>

<p><i>[2019-11 Priority to 3 during Monday issue prioritization in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3310" href="3310">3310.</a> Replace <tt>SIZE_MAX</tt> with <tt>numeric_limits&lt;size_t&gt;::max()</tt></h3>
<p><b>Section:</b> 20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Japan <b>Opened:</b> 2019-11-04 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#mem.poly.allocator.mem">active issues</a> in [mem.poly.allocator.mem].</p>
<p><b>View all other</b> <a href="lwg-index.html#mem.poly.allocator.mem">issues</a> in [mem.poly.allocator.mem].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses JP 218/219</b></p>

<p>
It's better to use a C++ property than C standard library macro, <tt>SIZE_MAX</tt>.
</p>

<p><i>[2019-11 Status to Ready during Tuesday morning issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.12.3.2 <a href="https://timsong-cpp.github.io/cppwp/mem.poly.allocator.mem">[mem.poly.allocator.mem]</a> as indicated:</p>

<blockquote>
<pre>
[[nodiscard]] Tp* allocate(size_t n);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> If <tt><del>SIZE_MAX</del><ins>numeric_limits&lt;size_t&gt;::max()</ins> / sizeof(Tp) &lt; n</tt>, 
throws <tt>length_error</tt>. [&hellip;]
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class T&gt;
  T* allocate_object(size_t n = 1);
</pre>
<blockquote>
<p>
-8- <i>Effects:</i> Allocates memory suitable for holding an array of <tt>n</tt> objects of type <tt>T</tt>, as follows:
<ol style="list-style-type: none">
<li><p>(8.1) &mdash; if <tt><del>SIZE_MAX</del><ins>numeric_limits&lt;size_t&gt;::max()</ins> / sizeof(T) &lt; n</tt>, throws <tt>length_error</tt>,</p></li>
<li><p>(8.2) &mdash; otherwise equivalent to:</p>
<blockquote><pre>
return static_cast&lt;T*&gt;(allocate_bytes(n*sizeof(T), alignof(T)));
</pre></blockquote>
</li>
</ol>

</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3313" href="3313">3313.</a> <tt>join_view::iterator::operator--</tt> is incorrectly constrained</h3>
<p><b>Section:</b> 24.7.10.3 <a href="https://timsong-cpp.github.io/cppwp/range.join.iterator">[range.join.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-04 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.join.iterator">active issues</a> in [range.join.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.join.iterator">issues</a> in [range.join.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses US 294</b></p>

<p>
<tt>join_view::iterator::operator--</tt> is improperly constrained. In the <i>Effects:</i> clause in
paragraph 14, we see the statement:
</p>
<blockquote><pre>
inner_ = ranges::end(*--outer_);
</pre></blockquote>
<p>
However, this only well-formed when <tt>end</tt> returns an iterator, not a sentinel. This
requirement is not reflected in the constraints of the function(s).
<p/>
<b>Eric Niebler:</b>
<p/>
From the WD, <tt>join_view::iterator::operator--</tt> is specified as:
</p>
<blockquote><pre>
constexpr iterator&amp; operator--()
  requires ref_is_glvalue &amp;&amp; bidirectional_range&lt;Base&gt; &amp;&amp;
    bidirectional_range&lt;range_reference_t&lt;Base&gt;&gt;;
</pre>
-14- <i>Effects:</i> Equivalent to:
<blockquote><pre>
if (outer_ == ranges::end(parent_-&gt;base_))
  inner_ = ranges::end(*--outer_);
while (inner_ == ranges::begin(*outer_))
  inner_ = ranges::end(*--outer_);
--inner_;
return *this;
</pre></blockquote>
</blockquote>
<p>
The trouble is from the lines that do:
</p>
<blockquote><pre>
  inner_ = ranges::end(*--outer_);
</pre></blockquote>
<p>
Clearly this will only compile when <tt>*--outer</tt> returns a <tt>common_range</tt>, but 
nowhere is that requirement stated.
</p>

<p><i>[2019-11 Status to Ready during Tuesday morning issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 24.7.10.3 <a href="https://timsong-cpp.github.io/cppwp/range.join.iterator">[range.join.iterator]</a>, class template <tt>join_view::iterator</tt> synopsis, 
as indicated:</p>

<blockquote>
<pre>
constexpr iterator&amp; operator--()
  requires ref_is_glvalue &amp;&amp; bidirectional_range&lt;Base&gt; &amp;&amp;
           bidirectional_range&lt;range_reference_t&lt;Base&gt;&gt; <ins>&amp;&amp;
           common_range&lt;range_reference_t&lt;Base&gt;&gt;</ins>;

constexpr iterator operator--(int)
  requires ref_is_glvalue &amp;&amp; bidirectional_range&lt;Base&gt; &amp;&amp;
           bidirectional_range&lt;range_reference_t&lt;Base&gt;&gt; <ins>&amp;&amp;
           common_range&lt;range_reference_t&lt;Base&gt;&gt;</ins>;
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.10.3 <a href="https://timsong-cpp.github.io/cppwp/range.join.iterator">[range.join.iterator]</a> as indicated:</p>

<blockquote>
<pre>
constexpr iterator&amp; operator--()
  requires ref_is_glvalue &amp;&amp; bidirectional_range&lt;Base&gt; &amp;&amp;
           bidirectional_range&lt;range_reference_t&lt;Base&gt;&gt; <ins>&amp;&amp;
           common_range&lt;range_reference_t&lt;Base&gt;&gt;</ins>;
</pre>
<blockquote>
<p>
-14- <i>Effects:</i> Equivalent to:
<blockquote><pre>
if (outer_ == ranges::end(parent_-&gt;base_))
  inner_ = ranges::end(*--outer_);
while (inner_ == ranges::begin(*outer_))
  inner_ = ranges::end(*--outer_);
--inner_;
return *this;
</pre></blockquote>
</p>
</blockquote>
<pre>
constexpr iterator operator--(int)
  requires ref_is_glvalue &amp;&amp; bidirectional_range&lt;Base&gt; &amp;&amp;
           bidirectional_range&lt;range_reference_t&lt;Base&gt;&gt; <ins>&amp;&amp;
           common_range&lt;range_reference_t&lt;Base&gt;&gt;</ins>;
</pre>
<blockquote>
<p>
-15- <i>Effects:</i> Equivalent to:
<blockquote><pre>
auto tmp = *this;
--*this;
return tmp;
</pre></blockquote>
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3314" href="3314">3314.</a> Is stream insertion behavior locale dependent when <tt>Period::type</tt> is <tt>micro</tt>?</h3>
<p><b>Section:</b> 27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tom Honermann <b>Opened:</b> 2019-11-04 <b>Last modified:</b> 2020-02-14 09:37:04 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.duration.io">active issues</a> in [time.duration.io].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.duration.io">issues</a> in [time.duration.io].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> states:
</p>
<blockquote>
<pre>
template&lt;class charT, class traits, class Rep, class Period>
  basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const duration&lt;Rep, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-3- The units suffix depends on the type <tt>Period::type</tt> as follows:
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p>(3.5) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>micro</tt>, the suffix is <tt>"&micro;s"</tt> 
(<tt>"\u00b5\u0073"</tt>).</p></li>
<li><p>[&hellip;]</p></li>
</ol>
<p/>
[&hellip;]
<p/>
-4- If <tt>Period::type</tt> is <tt>micro</tt>, but the character U+00B5 cannot be represented in the 
encoding used for <tt>charT</tt>, the unit suffix <tt>"us"</tt> is used instead of <tt>"&micro;s"</tt>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
<p>
Which encoding is intended by "the encoding used for <tt>charT</tt>"?  There are two candidates:
</p>
<ol>
<li><p>The associated execution character set as defined by 5.3 <a href="https://timsong-cpp.github.io/cppwp/lex.charset">[lex.charset]</a> p3 used to encode 
character and string literals (e.g., the "execution wide-character set" for <tt>wchar_t</tt>).</p></li>
<li><p>The locale dependent character set used by the <tt>std::locale ctype</tt> and <tt>codecvt</tt> 
facets as specified in 28.4.1 <a href="https://timsong-cpp.github.io/cppwp/category.ctype">[category.ctype]</a>, sometimes referred to as the 
"native character set".</p></li>
</ol>
<p>
The behavior should not be dependent on <tt>locale</tt> and should therefore be specified in terms of 
the execution character sets.
<p/>
The execution character set is implementation defined and some implementations allow the choice of 
execution character set to be specified via a compiler option or determined based on the locale active 
when the compiler is run. For example, the Microsoft compiler, when run on a Windows system with regional 
language settings configured for "English (United States)", will use Windows-1252 for the execution 
character set, but allows this choice to be overridden with the <tt>/execution-charset</tt> compiler 
option. The Microsoft compiler might therefore use <tt>"us"</tt> by default, but <tt>"&micro;s"</tt> 
when invoked with the <tt>/execution-charset:utf-8</tt> or <tt>/execution-charset:.437</tt> options. 
In the latter two cases, the string contents would contain <tt>"\xb5\x73"</tt> and <tt>"\xe6\x73"</tt> 
respectively (Unicode and Windows code page 437 map &micro; (U+00B5, MICRO SIGN) to different code points).
<p/>
This resolution relies on the character set for the locale used at run-time being compatible with the 
execution character set if the produced string is to be displayed correctly when written to a terminal 
or console. This is a typical requirement for character and string literals but is more strongly 
relevant for this issue since &micro; lacks representation in many character sets. Additionally, if the 
stream is imbued with a <tt>std::codecvt</tt> facet, the facet must provide appropriate conversion 
support for behavior to be well defined.
</p>

<p><i>[2019-11 Priority to 2 during Tuesday morning issue processing in Belfast.]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> "implementation's native character set" is used in 28.4.1.1 <a href="https://timsong-cpp.github.io/cppwp/locale.ctype">[locale.ctype]</a> 
and 28.4.1.4 <a href="https://timsong-cpp.github.io/cppwp/locale.codecvt">[locale.codecvt]</a> to refer to the locale dependent character encoding.]
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class charT, class traits, class Rep, class Period>
  basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const duration&lt;Rep, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-3- The units suffix depends on the type <tt>Period::type</tt> as follows:
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p>(3.5) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>micro</tt>, the suffix is <tt>"&micro;s"</tt> 
(<tt>"\u00b5\u0073"</tt>).</p></li>
<li><p>[&hellip;]</p></li>
</ol>
<p/>
[&hellip;]
<p/>
-4- If <tt>Period::type</tt> is <tt>micro</tt>, but the character U+00B5 <del>cannot be represented in the 
encoding used</del><ins>lacks representation in the execution character set</ins> for <tt>charT</tt>, the 
unit suffix <tt>"us"</tt> is used instead of <tt>"&micro;s"</tt>. <ins>If <tt>"&micro;s"</tt> is used but 
the implementation's native character set lacks representation for U+00B5 and the stream is associated 
with a terminal or console, or if the stream is imbued with a <tt>std::codecvt</tt> facet that lacks 
conversion support for the character, then the result is unspecified.</ins>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2019-11-12; Tom Honermann improves wording]</i></p>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class charT, class traits, class Rep, class Period>
  basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const duration&lt;Rep, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-3- The units suffix depends on the type <tt>Period::type</tt> as follows:
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p>(3.5) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>micro</tt>, <ins>it is implementation-defined 
whether</ins> the suffix is <tt>"&micro;s"</tt> (<tt>"\u00b5\u0073"</tt>) <ins>or <tt>"us"</tt></ins>.</p></li>
<li><p>[&hellip;]</p></li>
</ol>
<p/>
[&hellip;]
<p/>
<del>-4- If <tt>Period::type</tt> is <tt>micro</tt>, but the character U+00B5 cannot be represented in the 
encoding used for <tt>charT</tt>, the unit suffix <tt>"us"</tt> is used instead of <tt>"&micro;s"</tt>.</del>
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3315" href="3315">3315.</a> Correct Allocator Default Behavior</h3>
<p><b>Section:</b> 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-04 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.requirements">active issues</a> in [allocator.requirements].</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.requirements">issues</a> in [allocator.requirements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses US 162/US 163</b></p>

<p>
<b><a href="https://github.com/cplusplus/nbballot/issues/160">US 162</a>:</b>
<p/>
The default behavior for <tt>a.destroy</tt> is now to call <tt>destroy_at</tt>
<p/>
Proposed change:
<p/>
Replace "default" entry with: <tt>destroy_at(c)</tt>
</p>
<p>
<b><a href="https://github.com/cplusplus/nbballot/issues/161">US 163</a>:</b>
<p/>
The default behavior for <tt>a.construct</tt> is now to call <tt>construct_at</tt>
<p/>
Proposed change:
<p/>
Replace "default" entry with: <tt>construct_at(c, std::forward&lt;Args&gt;(args)...)</tt>
<p/>
<b>Dietmar K&uuml;hl:</b>
<p/>
In Table 34 [tab:cpp17.allocator] the behavior of <tt>a.construct(c, args)</tt> and
<tt>a.destroy(c)</tt> are described to have a default behavior of 
<tt>::new ((void*)c) C(forward&lt;Args&gt;(args))</tt> and <tt>c-&gt;~C()</tt>, respectively.
However, this table doesn't actually define what is happening if these operations are omitted: 
The behavior is provided when using an allocator is used via <tt>std::allocator_traits</tt> 
and is, thus, defined by the corresponding <tt>std::allocator_traits</tt> functions. These
functions are specified in 20.10.9.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.traits.members">[allocator.traits.members]</a> paragraphs 5 and 6 to call 
<tt>construct_at(c, std::forward&lt;Args&gt;(args)</tt> and <tt>destroy_at(p)</tt>, respectively.  
The text in the table should be updated to match the actual behavior.
</p>

<p><i>[2019-11 Status to Ready during Wednesday morning issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 16.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table [tab:cpp17.allocator] 
"<tt><i>Cpp17Allocator</i></tt> requirements" as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 34 &mdash; <tt><i>Cpp17Allocator</i></tt> requirements [tab:cpp17.allocator]</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>a.construct(c, args)</tt>
</td>
<td>
(not used)
</td>
<td>
<i>Effects:</i> Constructs an object of type <tt>C</tt> at <tt>c</tt>
</td>
<td>
<tt><del>::new ((void*)c) C(</del><ins>construct_at(c, std::</ins>forward&lt;Args&gt;(args)...)</tt>
</td>
</tr>

<tr>
<td>
<tt>a.destroy(c)</tt>
</td>
<td>
(not used)
</td>
<td>
<i>Effects:</i> Destroys the object at <tt>c</tt>
</td>
<td>
<tt><del>c-&gt;~C()</del><ins>destroy_at(c)</ins></tt>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3316" href="3316">3316.</a> Correctly define epoch for <tt>utc_clock</tt> / <tt>utc_timepoint</tt></h3>
<p><b>Section:</b> 27.7.2.1 <a href="https://timsong-cpp.github.io/cppwp/time.clock.utc.overview">[time.clock.utc.overview]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Great Britain <b>Opened:</b> 2019-11-05 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/329">GB 333</a></b></p>

<p>
UTC epoch is not correctly defined UTC has an officially recorded epoch of 1/1/1972 00:00:00 
and is 10 seconds behind TAI.
This can be confirmed through reference to the 
<a href="https://www.bipm.org/cc/CCTF/Allowed/18/CCTF_09-32_noteUTC.pdf#page=6">BIPM</a> (the 
body that oversees international metrology)
</p>
<blockquote><p>
"The defining epoch of 1 January 1972, <tt>0 h 0m 0 s</tt> UTC was set 10 s behind TAI, which
was the approximate accumulated difference between TAI and UT1 since the inception of
TAI in 1958, and a unique fraction of a second adjustment was applied so that UTC would
differ from TAI by an integral number of seconds. The recommended maximum departure of 
UTC from UT1 was 0.7 s. The term "leap second" was introduced for the stepped second."
</p></blockquote>
<p>
Proposed change:
<p/>
<tt>utc_clock</tt> and <tt>utc_timepoint</tt> should correctly report relative to the official 
UTC epoch. 27.2.2.1 footnote 1 should read: 
</p>
<blockquote><p>
In contrast to <tt>sys_time</tt>, which does not take leap seconds into account, 
<tt>utc_clock</tt> and its associated <tt>time_point</tt>, <tt>utc_time</tt>, count time,
including leap seconds, since 1972-01-01 00:00:00 UTC. [<i>Example:</i> 
<tt>clock_cast&lt;utc_clock&gt;(sys_seconds{sys_days{1972y/January/1}}).time_since_epoch()</tt> 
is <tt>0s</tt>. <tt>clock_cast&lt;utc_clock&gt;(sys_seconds{sys_days{2000y/January/1}}).time_since_epoch()</tt>
is <tt>883'612'822</tt>, which is <tt>10'197 * 86'400s + 22s</tt>. &mdash; <i>end example</i>]
</p></blockquote>
<p>
<b>Howard Hinnant:</b>
<p/>
Clarify that the epoch of <code>utc_clock</code> is intended to be <tt>1970-01-01</tt>.
<p/>
Rationale: The main use case of <code>utc_clock</code> is to get the correct number of seconds 
when subtracting time points straddling a leap second insertion point, and this computation 
is independent of the epoch. Furthermore learning/teaching that <code>utc_clock</code> is 
<code>system_clock</code> except that <code>utc_clock</code> includes leap seconds is easier.  
And this fact is more easily understood when comparing the underlying <code>.time_since_epoch()</code> 
of equivalent time points from each clock.
</p>

<p><i>[2019-11 Status to Ready during Wednesday morning issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 27.7.2.1 <a href="https://timsong-cpp.github.io/cppwp/time.clock.utc.overview">[time.clock.utc.overview]</a> as indicated:</p>

<blockquote>
<p>
-1- In contrast to <tt>sys_time</tt>, which does not take leap seconds into account, <tt>utc_clock</tt> 
and its associated <tt>time_point</tt>, <tt>utc_time</tt>, count time, including leap seconds, since 
1970-01-01 00:00:00 UTC. <ins>[<i>Note:</i> The UTC time standard began on 
1972-01-01 00:00:10 TAI. To measure time since this epoch instead, one can add/subtract the 
constant <tt>sys_days{1972y/1/1} - sys_days{1970y/1/1}</tt> (<tt>63'072'000s</tt>) from the 
<tt>utc_time</tt> &mdash; <i>end note</i>]</ins> [<i>Example:</i> <tt>clock_cast&lt;utc_clock&gt;(sys_seconds{sys_days{1970y/January/1}}).time_since_epoch()</tt> is <tt>0s</tt>. 
<tt>clock_cast&lt;utc_clock&gt;(sys_seconds{sys_days{2000y/January/1}}).time_since_epoch()</tt>
is <tt>946'684'822s</tt>, which is <tt>10'957 * 86'400s + 22s</tt>. &mdash; <i>end example</i>]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3317" href="3317">3317.</a> Incorrect <tt>operator&lt;&lt;</tt> for floating-point durations</h3>
<p><b>Section:</b> 27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-05 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.duration.io">active issues</a> in [time.duration.io].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.duration.io">issues</a> in [time.duration.io].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/330">US 334</a></b></p>

<p>
<tt>operator&lt;&lt;</tt> for floating-point durations always produces output with six digits 
after the decimal point, and doesn't use the stream's locale either.
</p>
<p>
Proposed change:
<p/>
Rewrite the specification to not rely on <tt>to_string()</tt> for floating-point formatting.
</p>

<p><i>[2019-11 Status to Ready during Wednesday morning issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 27.5.10 <a href="https://timsong-cpp.github.io/cppwp/time.duration.io">[time.duration.io]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class charT, class traits, class Rep, class Period>
  basic_ostream&lt;charT, traits&gt;&amp;
    operator&lt;&lt;(basic_ostream&lt;charT, traits&gt;&amp; os, const duration&lt;Rep, Period&gt;&amp; d);
</pre>
<blockquote>
<p>
<del>-1- <i>Requires:</i> <tt>Rep</tt> is an integral type whose integer conversion rank 
(6.8.4 <a href="https://timsong-cpp.github.io/cppwp/conv.rank">[conv.rank]</a>) is greater than or equal to that of <tt>short</tt>, or a floating-point type. 
<tt>charT</tt> is <tt>char</tt> or <tt>wchar_t</tt>.</del>
<p/>
-2- <i>Effects:</i> <del>Forms a <tt>basic_string&lt;charT, traits&gt;</tt> from <tt>d.count()</tt> using 
<tt>to_string</tt> if <tt>charT</tt> is <tt>char</tt>, or <tt>to_wstring</tt> if <tt>charT</tt> is 
<tt>wchar_t</tt>. Appends the units suffix described below to the <tt>basic_string</tt>.
Inserts the resulting <tt>basic_string</tt> into <tt>os</tt>. [<i>Note:</i> This specification ensures 
that the result of this streaming operation will obey the width and alignment properties of the stream. 
&mdash; <i>end note</i>]</del><ins>Inserts the duration <tt>d</tt> onto the stream <tt>os</tt> as if it 
were implemented as follows:</ins>
<blockquote><pre>
<ins>basic_ostringstream&lt;charT, traits&gt; s;
s.flags(os.flags());
s.imbue(os.getloc());
s.precision(os.precision());
s &lt;&lt; d.count() &lt;&lt; <i>units_suffix</i>;
return os &lt;&lt; s.str();</ins>
</pre></blockquote>
<p/>
-3- <del>The units suffix</del><ins><tt><i>units_suffix</i></tt></ins> depends on the type 
<tt>Period::type</tt> as follows:
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; If <tt>Period::type</tt> is <tt>atto</tt>, <del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> 
is <tt>"as"</tt>.</p></li>
<li><p>(3.2) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>femto</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"fs"</tt>.</p></li>
<li><p>(3.3) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>pico</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"ps"</tt>.</p></li>
<li><p>(3.4) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>nano</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"ns"</tt>.</p></li>
<li><p>(3.5) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>micro</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"&micro;s"</tt> 
(<tt>"\u00b5\u0073"</tt>).</p></li>
<li><p>(3.6) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>milli</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"ms"</tt>.</p></li>
<li><p>(3.7) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>centi</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"cs"</tt>.</p></li>
<li><p>(3.8) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>deci</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"ds"</tt>.</p></li>
<li><p>(3.9) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>ratio&lt;1&gt;</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"s"</tt>.</p></li>
<li><p>(3.10) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>deca</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"das"</tt>.</p></li>
<li><p>(3.11) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>hecto</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"hs"</tt>.</p></li>
<li><p>(3.12) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>kilo</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"ks"</tt>.</p></li>
<li><p>(3.13) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>mega</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"Ms"</tt>.</p></li>
<li><p>(3.14) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>giga</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"Gs"</tt>.</p></li>
<li><p>(3.15) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>tera</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"Ts"</tt>.</p></li>
<li><p>(3.16) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>peta</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"Ps"</tt>.</p></li>
<li><p>(3.17) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>exa</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"Es"</tt>.</p></li>
<li><p>(3.18) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>ratio&lt;60&gt;</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"min"</tt>.</p></li>
<li><p>(3.19) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>ratio&lt;3600&gt;</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"h"</tt>.</p></li>
<li><p>(3.20) &mdash; Otherwise, if <tt>Period::type</tt> is <tt>ratio&lt;86400&gt;</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"d"</tt>.</p></li>
<li><p>(3.21) &mdash; Otherwise, if <tt>Period::type::den == 1</tt>, 
<del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> is <tt>"<i>[num</i>]s"</tt>.</p></li>
<li><p>(3.22) &mdash; Otherwise, <del>the suffix</del><ins><tt><i>units_suffix</i></tt></ins> 
is <tt>"[<i>num</i>/<i>den</i>]s"</tt>.</p></li>
</ol>
<p/>
In the list above the use of <tt><i>num</i></tt> and <tt><i>den</i></tt> refer to the static data members 
of <tt>Period::type</tt>, which are converted to arrays of <tt>charT</tt> using a decimal conversion with 
no leading zeroes.
<p/>
-4- If <tt>Period::type</tt> is <tt>micro</tt>, but the character U+00B5 cannot be represented in the 
encoding used for <tt>charT</tt>, <del>the unit suffix</del><ins><tt><i>units_suffix</i></tt></ins> 
<tt>"us"</tt> is used instead of <tt>"&micro;s"</tt>.
<p/>
-5- <i>Returns:</i> <tt>os</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3318" href="3318">3318.</a> Clarify whether clocks can represent time before their epoch</h3>
<p><b>Section:</b> 27.7.1.1 <a href="https://timsong-cpp.github.io/cppwp/time.clock.system.overview">[time.clock.system.overview]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Great Britain <b>Opened:</b> 2019-11-05 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/331">GB 335</a></b></p>

<p>
Wording for clocks should be unified unless they are intended to behave differently
In 27.7.1.1 note 1 for <tt>system_clock</tt> it is stated: 
</p>
<blockquote><p>
"Objects of type <tt>system_clock</tt> represent wall clock time from the system-wide realtime
clock. Objects of type <tt>sys_time&lt;Duration&gt;</tt> measure time since (and before) 
1970-01-01 00:00:00 UTC" 
</p></blockquote>
<p>
The express statement of "since (and before)" is important given the time epoch of these clocks. 
If all the clocks support time prior to their zero-time then this should be stated explicitly. 
If not then likewise that should be noted. No change is proposed yet, clarification
required over the intended behaviour when using values prior to a given clock's epoch is
needed before the appropriate change can be suggested.
<p/>
Proposed change:
<p/>
Unify the wording.
</p>
<p>
<b>Howard Hinnant:</b>
<p/>
The clocks that are specified to have a signed <code>rep</code> imply that they will support 
negative time points, but not <i>how</i> negative. For example if <code>system_clock::duration</code> 
is <code>nanoseconds</code> represented with 64 bits, then <code>system_clock::time_point</code> 
can't possibly represent dates prior to 1677-09-21 00:12:43.145224192. This is a negative 
<code>time_point</code> since it is prior to 1970-01-01 00:00:00. But it is not very negative 
compared to (for example) <code>sys_time&lt;microseconds&gt;::min()</code>.
<p/>
Those clocks with a signed <code>rep</code> are:
</p>
<ul>
<li><p><code>system_clock</code></p></li>
<li><p><code>utc_clock</code></p></li>
<li><p><code>tai_clock</code></p></li>
<li><p><code>gps_clock</code></p></li>
<li><p><code>file_clock</code></p></li>
</ul>
<p>
Those clocks where the signed-ness of <code>rep</code> is unspecified are:
</p>
<ul>
<li><p><code>steady_clock</code></p></li>
<li><p><code>high_resolution_clock</code></p></li>
</ul>
<p>
Therefore this response emphasizes the "Unify the wording" part of this NB comment.
</p>

<p><i>[2019-11 Status to Ready during Wednesday morning issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 27.7.1.1 <a href="https://timsong-cpp.github.io/cppwp/time.clock.system.overview">[time.clock.system.overview]</a> as indicated:</p>

<blockquote>
<p>
-1- Objects of type <tt>system_clock</tt> represent wall clock time from the system-wide 
realtime clock. Objects of type <tt>sys_time&lt;Duration&gt;</tt> measure time since 
<del>(and before)</del> 1970-01-01 00:00:00 UTC excluding leap seconds. This measure is commonly 
referred to as Unix time. This measure facilitates an efficient mapping between
<tt>sys_time</tt> and calendar types (27.8 <a href="https://timsong-cpp.github.io/cppwp/time.cal">[time.cal]</a>). [<i>Example:</i>
<tt>sys_seconds{sys_days{1970y/January/1}}.time_since_epoch()</tt> is <tt>0s</tt>.
<tt>sys_seconds{sys_days{2000y/January/1}}.time_since_epoch()</tt> is <tt>946'684'800s</tt>, 
which is <tt>10'957 * 86'400s</tt>. &mdash; <i>end example</i>]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3319" href="3319">3319.</a> Properly reference specification of IANA time zone database</h3>
<p><b>Section:</b> 27.11.1 <a href="https://timsong-cpp.github.io/cppwp/time.zone.general">[time.zone.general]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Germany <b>Opened:</b> 2019-11-05 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/340">DE 344</a></b></p>

<p>
This paragraph says 
</p>
<blockquote><p>
"27.11 describes an interface for accessing the IANA Time Zone database described in RFC 6557, &hellip;"
</p></blockquote>
<p>
However, RFC 6557 does not describe the database itself; it only describes the maintenance procedures 
for that database, as its title implies (quoted in clause 2).
<p/>
Proposed change:
<p/>
Add a reference to a specification of the database itself, or excise all references to the IANA
time zone database.
</p>
<p>
<b>Howard Hinnant:</b>
<p/>
We can not entirely remove the reference to IANA because we need portable <code>time_zone</code> 
names (e.g. "America/New_York") and definitions. However the NB comment is quite accurate and 
fixed with the proposed resolution.
</p>

<p><i>[2019-11 Status to Ready during Wednesday morning issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 2 <a href="https://timsong-cpp.github.io/cppwp/intro.refs">[intro.refs]</a> as indicated:</p>

<blockquote>
<p>
-1- The following documents are referred to in the text in such a way that some or all of their 
content constitutes requirements of this document. For dated references, only the edition cited 
applies. For undated references, the latest edition of the referenced document (including any 
amendments) applies.
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p><del>(1.2) &mdash; INTERNET ENGINEERING TASK FORCE (IETF). RFC 6557: Procedures for Maintaining 
the Time Zone Database [online]. Edited by E. Lear, P. Eggert. February 2012 [viewed 2018-03-26]. 
Available at https://www.ietf.org/rfc/rfc6557.txt</del></p></li>
<li><p>[&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 27.11.1 <a href="https://timsong-cpp.github.io/cppwp/time.zone.general">[time.zone.general]</a> as indicated:</p>

<blockquote>
<p>
-1- 27.11 <a href="https://timsong-cpp.github.io/cppwp/time.zone">[time.zone]</a> describes an interface for accessing the IANA Time Zone 
<del>d</del><ins>D</ins>atabase <del>described in RFC 6557,</del> that interoperates with 
<tt>sys_time</tt> and <tt>local_time</tt>. This interface provides time zone support to 
both the civil calendar types (27.8 <a href="https://timsong-cpp.github.io/cppwp/time.cal">[time.cal]</a>) and to user-defined calendars. 
</p>
</blockquote>
</li>

<li><p>Modify section "Bibliography" as indicated:</p>

<blockquote>
<p>
The following documents are cited informatively in this document.
<ol style="list-style-type: none">
<li><p><ins>&mdash; IANA Time Zone Database. Available at 
<a href="https://www.iana.org/time-zones">https://www.iana.org/time-zones</a></ins></p></li>
<li><p>&mdash; ISO/IEC 10967-1:2012, <i>Information technology &mdash; Language independent arithmetic &mdash; 
Part 1: Integer and floating point arithmetic</i></p></li>
<li><p>[&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3320" href="3320">3320.</a> <tt>span::cbegin/cend</tt> methods produce different results than <tt>std::[ranges::]cbegin/cend</tt></h3>
<p><b>Section:</b> 22.7.3.7 <a href="https://timsong-cpp.github.io/cppwp/span.iterators">[span.iterators]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Poland <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/243">PL 247</a></b></p>

<p>
<tt>span&lt;T&gt;</tt> provides a <tt>const</tt>-qualified <tt>begin()</tt> method and <tt>cbegin()</tt> 
method that produces a different result if <tt>T</tt> is not <tt>const</tt>-qualifed:
</p>
<ol>
<li><p><tt>begin()</tt> produces mutable iterator over <tt>T</tt> (as if <tt>T*</tt>)</p></li>
<li><p><tt>cbegin()</tt> produces <tt>const</tt> iterator over <tt>T</tt> (as if <tt>T const*</tt>)</p></li>
</ol>
<p>
As consequence for the object <tt>s</tt> of type <tt>span&lt;T&gt;</tt>, the call to the 
<tt>std::cbegin(s)/std::ranges::cbegin(s)</tt> produces different result than <tt>s.cbegin()</tt>.
<p/>
Proposed change:
<p/>
Change <tt>span&lt;T&gt;</tt> members <tt>cbegin()/cend()/crbegin()/crend()/const_iterator</tt> 
to be equivalent to <tt>begin()/end()/rbegin()/rend()/iterator</tt> respectively.
</p>
<p>
<b>Tomasz Kami&nacute;ski:</b>
<p/>
Per <a href="https://github.com/cplusplus/nbballot/issues/243">LEWG discussion in Belfast</a> these 
methods and related typedefs should be removed.
</p>

<p><i>[2019-11 Status to Ready during Wednesday night issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a>, class template <tt>span</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;class ElementType, size_t Extent = dynamic_extent&gt;
  class span {
  public:
    <i>// constants and types</i>
    using element_type = ElementType;
    using value_type = remove_cv_t&lt;ElementType&gt;;
    using index_type = size_t;
    using difference_type = ptrdiff_t;
    using pointer = element_type*;
    using const_pointer = const element_type*;
    using reference = element_type&amp;;
    using const_reference = const element_type&amp;;
    using iterator = <i>implementation-defined</i>; <i>// see 22.7.3.7 <a href="https://timsong-cpp.github.io/cppwp/span.iterators">[span.iterators]</a></i>
    <del>using const_iterator = <i>implementation-defined</i>;</del>
    using reverse_iterator = std::reverse_iterator&lt;iterator&gt;;
    <del>using const_reverse_iterator = std::reverse_iterator&lt;const_iterator&gt;;</del>
    static constexpr index_type extent = Extent;
    
    [&hellip;]
    <i>// 22.7.3.7 <a href="https://timsong-cpp.github.io/cppwp/span.iterators">[span.iterators]</a>, iterator support</i>
    constexpr iterator begin() const noexcept;
    constexpr iterator end() const noexcept;
    <del>constexpr const_iterator cbegin() const noexcept;
    constexpr const_iterator cend() const noexcept;</del>
    constexpr reverse_iterator rbegin() const noexcept;
    constexpr reverse_iterator rend() const noexcept;
    <del>constexpr const_reverse_iterator crbegin() const noexcept;
    constexpr const_reverse_iterator crend() const noexcept;</del>
    friend constexpr iterator begin(span s) noexcept { return s.begin(); }
    friend constexpr iterator end(span s) noexcept { return s.end(); }
    [&hellip;]
  };
[&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 22.7.3.7 <a href="https://timsong-cpp.github.io/cppwp/span.iterators">[span.iterators]</a> as indicated:</p>

<blockquote>
<pre>
using iterator = <i>implementation-defined</i>;
<del>using const_iterator = <i>implementation-defined</i>;</del>
</pre>
<blockquote>
<p>
-1- The type<del>s</del> model<ins>s</ins> <tt>contiguous_iterator</tt> 
(23.3.4.14 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.contiguous">[iterator.concept.contiguous]</a>), meet<ins>s</ins> the <i>Cpp17RandomAccessIterator</i> 
requirements (23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a>), and meet<ins>s</ins> the requirements for 
constexpr iterators (23.3.1 <a href="https://timsong-cpp.github.io/cppwp/iterator.requirements.general">[iterator.requirements.general]</a>). All requirements on container 
iterators (22.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>) apply to <tt>span::iterator</tt> <del>and 
<tt>span::const_iterator</tt></del> as well.
</p>
</blockquote>
[&hellip;]
<pre>
<del>constexpr const_iterator cbegin() const noexcept;</del>
</pre>
<blockquote>
<p>
<del>-6- <i>Returns:</i> A constant iterator referring to the first element in the span. If 
<tt>empty()</tt> is <tt>true</tt>, then it returns the same value as <tt>cend()</tt>.</del>
</p>
</blockquote>
<pre>
<del>constexpr const_iterator cend() const noexcept;</del>
</pre>
<blockquote>
<p>
<del>-7- <i>Returns:</i> A constant iterator which is the past-the-end value.</del>
</p>
</blockquote>
<pre>
<del>constexpr const_reverse_iterator crbegin() const noexcept;</del>
</pre>
<blockquote>
<p>
<del>-8- <i>Effects:</i> Equivalent to: <tt>return const_reverse_iterator(cend());</tt></del>
</p>
</blockquote>
<pre>
<del>constexpr const_reverse_iterator crend() const noexcept;</del>
</pre>
<blockquote>
<p>
<del>-9- <i>Effects:</i> Equivalent to: <tt>return const_reverse_iterator(cbegin());</tt></del>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3321" href="3321">3321.</a> <tt>uninitialized_construct_using_allocator</tt> should use <tt>construct_at</tt></h3>
<p><b>Section:</b> 20.10.8.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.uses.construction">[allocator.uses.construction]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.uses.construction">active issues</a> in [allocator.uses.construction].</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.uses.construction">issues</a> in [allocator.uses.construction].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/210">US 213</a></b></p>

<p>
<tt>uninitialized_construct_using_allocator</tt> should use <tt>construct_at</tt> instead 
of <tt>operator new</tt>
<p/>
Proposed change:
</p>
<blockquote>
<p>
<i>Effects:</i> Equivalent to:
</p>
<blockquote><pre>
return <del>::new(static_cast&lt;void*&gt;(p))</del>
<ins>construct_at(p,</ins>
<del>T(</del>make_obj_using_allocator&lt;T&gt;(alloc,
std::forward&lt;Args&gt;(args)...))<ins>)</ins>;
</pre></blockquote>
</blockquote>
<p>
<b>Tim Song:</b>
<p/>
The proposed wording in the NB comment is incorrect, because it prevents guaranteed elision.
</p>

<p><i>[2019-11 Status to Ready during Wednesday night issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.10.8.2 <a href="https://timsong-cpp.github.io/cppwp/allocator.uses.construction">[allocator.uses.construction]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T, class Alloc, class... Args&gt;
  constexpr T* uninitialized_construct_using_allocator(T* p, const Alloc&amp; alloc, Args&amp;&amp;... args);
</pre>
<blockquote>
<p>
-17- <i>Effects:</i> Equivalent to:
<blockquote><pre>
return <del>::new(static_cast&lt;void*&gt;(p))
  T(make_obj_using_allocator&lt;T&gt;(</del><ins>apply([&amp;](auto&amp;&amp;...xs) {
         return construct_at(p, std::forward&lt;decltype(xs)&gt;(xs)...);
     }, uses_allocator_construction_args&lt;T&gt;(</ins>alloc, std::forward&lt;Args&gt;(args)...));
</pre></blockquote>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3322" href="3322">3322.</a> Add <tt>join_view::base()</tt> member function</h3>
<p><b>Section:</b> 24.7.10.2 <a href="https://timsong-cpp.github.io/cppwp/range.join.view">[range.join.view]</a> <b>Status:</b> <a href="lwg-active.html#Resolved">Tentatively Resolved</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2019-12-21 13:59:05 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.join.view">active issues</a> in [range.join.view].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.join.view">issues</a> in [range.join.view].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Resolved">Tentatively Resolved</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/289">US 293</a></b></p>

<p>
<tt>join_view</tt> is missing a <tt>base()</tt> member for returning the underlying view. All the other
range adaptors provide this.
<p/>
Proposed change:
</p>
<p>
To the <tt>join_view</tt> class template add the member:
</p>
<blockquote><pre>
constexpr V base() const { return base_; }
</pre></blockquote>
<p>
<b>Jonathan Wakely:</b>
<p/>
The NB comment says "<code>join_view</code> is missing a <code>base()</code> member for returning the 
underlying view. All the other range adaptors provide this."
<p/>
In fact, <tt>split_view</tt> and <tt>istream_view</tt> do not provide <tt>base()</tt> either. Of the 
views that do define <tt>base()</tt>, all except <tt>all_view</tt> do so out-of-line, so the proposed 
resolution adds it out-of-line too.
</p>

<p><i>[2019-11 Status to Ready during Wednesday night issue processing in Belfast.]</i></p>


<p><i>[2019-12-16; Casey comments]</i></p>

<p>
This issue has been resolved by <a href="https://wg21.link/p1456r1">P1456R1</a> "Move-only views", which 
added no less than two member functions named "base" to <tt>join_view</tt>.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 24.7.10.2 <a href="https://timsong-cpp.github.io/cppwp/range.join.view">[range.join.view]</a>, class template <tt>join_view</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
template&lt;input_range R&gt;
  requires viewable_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr explicit join_view(R&amp;&amp; r);

<ins>constexpr V base() const;</ins>

constexpr auto begin() {
  return iterator&lt;<i>simple-view</i>&lt;V&gt;&gt;{*this, ranges::begin(base_)};
}
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.10.2 <a href="https://timsong-cpp.github.io/cppwp/range.join.view">[range.join.view]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;input_range R&gt;
  requires viewable_range&lt;R&gt; &amp;&amp; constructible_from&lt;V, all_view&lt;R&gt;&gt;
constexpr explicit join_view(R&amp;&amp; r);
</pre>
<blockquote>
<p>
-2- <i>Effects:</i> [&hellip;]
</p>
</blockquote>
<pre>
<ins>constexpr V base() const;</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Effects:</i> Equivalent to: <tt>return base_;</tt></ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>
Resolved by accepting <a href="https://wg21.link/p1456r1">P1456R1</a>.
</p>




<hr>
<h3><a name="3323" href="3323">3323.</a> <tt><i>has-tuple-element</i></tt> helper concept needs <tt>convertible_to</tt></h3>
<p><b>Section:</b> 24.7.15.2 <a href="https://timsong-cpp.github.io/cppwp/range.elements.view">[range.elements.view]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Great Britain <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/295">GB 299</a></b></p>

<p>
<tt><i>has-tuple-element</i></tt> helper concept needs <tt>convertible_to</tt>
<p/>
The exposition-only <tt><i>has-tuple-element</i></tt> concept (for <tt>elements_view</tt>) is defined as
</p>
<blockquote><pre>
template&lt;class T, size_t N&gt;
concept <i>has-tuple-element</i> = <i>exposition only</i>
  requires(T t) {
    typename tuple_size&lt;T&gt;::type;
    requires N &lt; tuple_size_v&lt;T&gt;;
    typename tuple_element_t&lt;N, T&gt;;
    { get&lt;N&gt;(t) } -&gt; const tuple_element_t&lt;N, T&gt;&amp;;
  };
</pre></blockquote>
<p>
However, the return type constraint for <tt>{ get&lt;N&gt;(t) }</tt> is no longer valid 
under the latest concepts changes
<p/>
Proposed change:
</p>
<p>
Change to:
</p>
<blockquote><pre>
template&lt;class T, size_t N&gt;
concept <i>has-tuple-element</i> = <i>exposition only</i>
  requires(T t) {
    typename tuple_size&lt;T&gt;::type;
    requires N &lt; tuple_size_v&lt;T&gt;;
    typename tuple_element_t&lt;N, T&gt;;
    { get&lt;N&gt;(t) } -&gt; convertible_to&lt;const tuple_element_t&lt;N, T&gt;&amp;&gt;;
  };
</pre></blockquote>
<p>
<b>Jonathan Wakely:</b>
<p/>
The NB comment says "The return type constraint for <tt>{ get(t) }</tt> is no longer valid under 
the latest concepts changes." The changes referred to are those in <a href="https://wg21.link/p1452r2">P1452R2</a>. 
</p>

<p><i>[2019-11 Status to Ready during Wednesday night issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 24.7.15.2 <a href="https://timsong-cpp.github.io/cppwp/range.elements.view">[range.elements.view]</a>, class template <tt>elements_view</tt> synopsis, 
as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;class T, size_t N&gt;
  concept <i>has-tuple-element</i> = <i>// exposition only</i>
    requires(T t) {
      typename tuple_size&lt;T&gt;::type;
      requires N &lt; tuple_size_v&lt;T&gt;;
      typename tuple_element_t&lt;N, T&gt;;
      { get&lt;N&gt;(t) } -&gt; <ins>convertible_to&lt;</ins>const tuple_element_t&lt;N, T&gt;&amp;<ins>&gt;</ins>;
    };
[&hellip;]
}
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3324" href="3324">3324.</a> Special-case <tt>std::strong/weak/partial_order</tt> for pointers</h3>
<p><b>Section:</b> 17.11.7 <a href="https://timsong-cpp.github.io/cppwp/cmp.alg">[cmp.alg]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Canada <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/176">CA 178</a></b></p>

<p>
<tt>std::strong_order</tt>, <tt>weak_order</tt>, and <tt>partial_order</tt> have special cases 
for floating point, but are missing special casing for pointers. <tt>compare_three_way</tt> and 
<tt>std::less</tt> have the special casing for pointers.
</p>
Proposed change:
<p/>
Change [cmp.alg] bullet 1.4 from
<br/>
"Otherwise, <tt>strong_ordering(E &lt;=&gt; F)</tt> if it is a well-formed expression."
<br/>
to
<br/>
"Otherwise, <tt>strong_ordering(compare_three_way()(E, F))</tt> if it is a well-formed expression."
<p/>
Change [cmp.alg] bullet 2.4 from
<br/>
"Otherwise, <tt>weak_ordering(E &lt;=&gt; F)</tt> if it is a well-formed expression."
<br/>
to
<br/>
"Otherwise, <tt>weak_ordering(compare_three_way()(E, F))</tt> if it is a well-formed expression."
<br/>
Change [cmp.alg] bullet 3.3 from
<br/>
"Otherwise, <tt>partial_ordering(E &lt;=&gt; F)</tt> if it is a well-formed expression."
<br/>
to
<br/>
"Otherwise, <tt>partial_ordering(compare_three_way()(E, F))</tt> if it is a well-formed expression."
<p>
<b>Dietmar K&uuml;hl:</b>
<p/>
Use <tt>compare_three_way</tt> instead of <tt>&lt;=&gt;</tt> for the various comparison algorithms.
</p>

<p><i>[2019-11 Status to Ready during Wednesday night issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Change 17.11.7 <a href="https://timsong-cpp.github.io/cppwp/cmp.alg">[cmp.alg]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>strong_order</tt> [&hellip;]
</p>
<blockquote>
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p>(1.4) &mdash; Otherwise, <tt>strong_ordering(<del>E &lt;=&gt; F</del><ins>compare_three_way()(E, F)</ins>)</tt> 
if it is a well-formed expression.</p></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
<p>
-2- The name <tt>weak_order</tt> [&hellip;]
</p>
<blockquote>
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p>(2.4) &mdash; Otherwise, <tt>weak_ordering(<del>E &lt;=&gt; F</del><ins>compare_three_way()(E, F)</ins>)</tt> 
if it is a well-formed expression.</p></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
<p>
-3- The name <tt>partial_order</tt> [&hellip;]
</p>
<blockquote>
<ol style="list-style-type: none">
<li><p>[&hellip;]</p></li>
<li><p>(3.3) &mdash; Otherwise, <tt>partial_ordering(<del>E &lt;=&gt; F</del><ins>compare_three_way()(E, F)</ins>)</tt> 
if it is a well-formed expression.</p></li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3325" href="3325">3325.</a> Constrain return type of transformation function for <tt>transform_view</tt></h3>
<p><b>Section:</b> 24.7.5.2 <a href="https://timsong-cpp.github.io/cppwp/range.transform.view">[range.transform.view]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/299">US 303</a></b></p>

<p>
The <tt>transform_view</tt> does not constrain the return type of the transformation function. It
is invalid to pass a <tt>void</tt>-returning transformation function to the <tt>transform_view</tt>, 
which would cause its <tt>iterator</tt>s' <tt>operator*</tt> member to return <tt>void</tt>.
<p/>
Proposed change:
</p>
<p>
Change the constraints on <tt>transform_view</tt> to the following:
</p>
<blockquote><pre>
template&lt;input_range V, copy_constructible F&gt;
  requires view&lt;V&gt; &amp;&amp; is_object_v&lt;F&gt; &amp;&amp;
           regular_invocable&lt;F&amp;, range_reference_t&lt;V&gt;&gt; &amp;&amp;
           <i>can-reference</i>&lt;invoke_result_t&lt;F&amp;, range_reference_t&lt;V&gt;&gt;&gt;
class transform_view;
</pre></blockquote>
<p>
<b>Jonathan Wakely:</b>
<p/>
The NB comment says "The <tt>transform_view</tt> does not constrain the return type of the transformation 
function. It is invalid to pass a <tt>void</tt>-returning transformation function to the <tt>transform_view</tt>, 
which would cause its <tt>iterator</tt>s' <tt>operator*</tt> member to return <tt>void</tt>."
</p>

<p><i>[2019-11 Status to Ready during Wednesday night issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 24.7.5.2 <a href="https://timsong-cpp.github.io/cppwp/range.transform.view">[range.transform.view]</a>, class template <tt>elements_view</tt> synopsis, 
as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;input_range V, copy_constructible F&gt;
    requires view&lt;V&gt; &amp;&amp; is_object_v&lt;F&gt; &amp;&amp;
             regular_invocable&lt;F&amp;, range_reference_t&lt;V&gt;&gt; <ins>&amp;&amp;
             <i>can-reference</i>&lt;invoke_result_t&lt;F&amp;, range_reference_t&lt;V&gt;&gt;&gt;</ins>
  class transform_view : public view_interface&lt;transform_view&lt;V, F&gt;&gt; {
    [&hellip;]
  };
[&hellip;]
}
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3326" href="3326">3326.</a> <tt>enable_view</tt> has false positives</h3>
<p><b>Section:</b> 24.4.4 <a href="https://timsong-cpp.github.io/cppwp/range.view">[range.view]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Germany <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2020-02-13 05:28:08 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/278">DE 282</a></b></p>

<p>
"Since the difference between range and view is largely semantic, the
two are differentiated with the help of <tt>enable_view</tt>." (&sect;3)
<p/>
<tt>enable_view</tt> is designed as on opt-in trait to specify that a type is a
view. It defaults to true for types derived from <tt>view_base</tt> (&sect;4.2) which
is clearly a form of opt-in. But it also employs a heuristic assuming that anything with 
<tt>iterator == const_iterator</tt> is also view (&sect;4.3).
<p/>
This is a very poor heuristic, the same paragraph already needs to define six
exceptions from this rule for standard library types (&sect;4.2).
<p/>
Experience in working with range-v3 has revealed multiple of our own library types as being 
affected from needing to opt-out from the "auto-opt-in", as well. This is counter-intuitive: 
something that was never designed to be a view shouldn't go through hoops so that it isn't
treated as a view.
<p/>
Proposed change:
</p>
<p>
Make <tt>enable_view</tt> truly be opt-in by relying only on explicit specialisation or 
inheritance from <tt>view_base</tt>. This means removing 24.4.4 &sect;4.2 - &sect;4.4 and 
introducing new &sect;4.2 "Otherwise, false".
<p/>
Double-check if existing standard library types like <tt>basic_string_view</tt> and <tt>span</tt> 
need to opt-in to being a view now.
</p>
<p>
<b>Casey Carter:</b>
<p/>
<tt>enable_view</tt> (24.4.4 <a href="https://timsong-cpp.github.io/cppwp/range.view">[range.view]</a>) is designed as on opt-in trait to specify that a type 
is a view. It defaults to <tt>true</tt> for types derived from <tt>view_base</tt> &mdash; which is a 
form of opt-in &mdash; and it also employs a heuristic. Unfortunately, the heuristic has false positives. 
The working draft itself includes six exceptions to the heuristic for standard library types. Since 
false positives are much more problematic for users than false negatives, we should eliminate the heuristic.
</p>
<p><i>[2019-11 Status to Ready during Wednesday night issue processing in Belfast.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 24.4.4 <a href="https://timsong-cpp.github.io/cppwp/range.view">[range.view]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T&gt;
  inline constexpr bool enable_view = <del><i>see below</i></del><ins>derived_from&lt;T, view_base&gt;</ins>;
</pre>
<blockquote>
<p>
<del>-4- <i>Remarks:</i> For a type <tt>T</tt>, the default value of <tt>enable_view&lt;T&gt;</tt> is:</del>
<ol style="list-style-type: none">
<li><p><del>(4.1) &mdash; If <tt>derived_from&lt;T, view_base&gt;</tt> is <tt>true</tt>, 
<tt>true</tt>.</del></p></li>
<li><p><del>(4.2) &mdash; Otherwise, if <tt>T</tt> is a specialization of class template 
<tt>initializer_list</tt> (17.10 <a href="https://timsong-cpp.github.io/cppwp/support.initlist">[support.initlist]</a>), <tt>set</tt> (22.4.6 <a href="https://timsong-cpp.github.io/cppwp/set">[set]</a>),
<tt>multiset</tt> (22.4.7 <a href="https://timsong-cpp.github.io/cppwp/multiset">[multiset]</a>), <tt>unordered_set</tt> (22.5.6 <a href="https://timsong-cpp.github.io/cppwp/unord.set">[unord.set]</a>), 
<tt>unordered_multiset</tt> (22.5.7 <a href="https://timsong-cpp.github.io/cppwp/unord.multiset">[unord.multiset]</a>), or <tt>match_results</tt>
(30.10 <a href="https://timsong-cpp.github.io/cppwp/re.results">[re.results]</a>), <tt>false</tt>.</del></p></li>
<li><p><del>(4.3) &mdash; Otherwise, if both <tt>T</tt> and <tt>const T</tt> model <tt>range</tt> and 
<tt>range_reference_t&lt;T&gt;</tt> is not the same type as <tt>range_reference_t&lt;const T&gt;</tt>, 
<tt>false</tt>. [<i>Note:</i> Deep <tt>const</tt>-ness implies element ownership, whereas shallow const-ness 
implies reference semantics. &mdash; <i>end note</i>]</del></p></li>
<li><p><del>(4.4) &mdash; Otherwise, true.</del></p></li>
</ol>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 21.4.1 <a href="https://timsong-cpp.github.io/cppwp/string.view.synop">[string.view.synop]</a>, header <tt>&lt;string_view&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  <i>// 21.4.2 <a href="https://timsong-cpp.github.io/cppwp/string.view.template">[string.view.template]</a>, class template basic_string_view</i>
  template&lt;class charT, class traits = char_traits&lt;charT&gt;&gt;
  class basic_string_view;
  
  <ins>template&lt;class charT, class traits&gt;
    inline constexpr bool ranges::enable_view&lt;basic_string_view&lt;charT, traits&gt;&gt; = true;</ins>
    
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 22.7.2 <a href="https://timsong-cpp.github.io/cppwp/span.syn">[span.syn]</a>, header <tt>&lt;span&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  <i>// constants</i>
  inline constexpr size_t dynamic_extent = numeric_limits&lt;size_t&gt;::max();
  
  <i>// 22.7.3 <a href="https://timsong-cpp.github.io/cppwp/views.span">[views.span]</a>, class template span</i>
  template&lt;class ElementType, size_t Extent = dynamic_extent&gt;
  class span;
    
  <ins>template&lt;class ElementType, size_t Extent&gt;
    inline constexpr bool ranges::enable_view&lt;span&lt;ElementType, Extent&gt;&gt; = Extent == 0 || 
      Extent == dynamic_extent;</ins>
    
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.11.4 <a href="https://timsong-cpp.github.io/cppwp/range.split.outer.value">[range.split.outer.value]</a>, class <tt>split_view::outer_iterator::value_type</tt>
synopsis, as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The following applies the proposed wording for LWG <a href="3276">3276</a>]
</p>
</blockquote>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;class V, class Pattern&gt;
  template&lt;bool Const&gt;
  struct split_view&lt;V, Pattern&gt;::outer_iterator&lt;Const&gt;::value_type 
    <ins>: view_interface&lt;value_type&gt;</ins> {
  private:
    outer_iterator i_ = outer_iterator(); <i>// exposition only</i>
  public:
    value_type() = default;
    constexpr explicit value_type(outer_iterator i);

    constexpr inner_iterator&lt;Const&gt; begin() const;
    constexpr default_sentinel_t end() const;
  };
}
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3327" href="3327">3327.</a> Format alignment specifiers vs. text direction</h3>
<p><b>Section:</b> 20.20.2.2 <a href="https://timsong-cpp.github.io/cppwp/format.string.std">[format.string.std]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Great Britain <b>Opened:</b> 2019-11-07 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.string.std">active issues</a> in [format.string.std].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.string.std">issues</a> in [format.string.std].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/222">GB 225</a></b></p>

<p>
<tt>std::format()</tt> alignment specifiers should be independent of text direction
The align specifiers for formatting standard integer and string types are expressed in
terms of "left" and "right". However, "left alignment" as currently defined in the 
<tt>format()</tt> specification might end up being right-aligned when the resulting 
string is displayed in a RTL or bidirectional locale. This ambiguity can be resolved 
by removing "left" and "right" and replacing with "start" and "end", without changing 
any existing implementation and without changing the intent of the feature.
<p/>
Proposed change:
</p>
<p>
In [tab:format.align]:
Forces the field to be <del>left-aligned within</del> <ins>aligned to the start of</ins>
the available space and Forces the field to be <del>right-aligned within</del> 
<ins>aligned to the end of</ins> the available space
</p>
<p>
<b>Jeff Garland:</b>
<p/>
<a href="http://wiki.edg.com/bin/view/Wg21belfast/LWGWednesdayIssuePrioritization">Wiki notes 
from Belfast Wed</a>:
</p>
<blockquote><p>
# GB225
<p/>
JG: SG16 approved this.
<p/>
JG: If you scroll back up, you'll see see it's very tiny. Two line change.
<p/>
JG: I'm willing to submit an LWG issue to suggest we make a wording change to take it off our plate.
<p/>
CC: Is this the one that changes left/right to beginning/end?
<p/>
Some people: yes
<p/>
MC: Any problem with Jeff's proposed direction and this proposed fix?
<p/>
MC: I hear none. 
</p></blockquote>

<p><i>[2019-11 Moved to Ready on Friday AM in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify "Table 57 &mdash; Meaning of <i>align</i> options"
 [tab:format.align] as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 57 &mdash; Meaning of <i>align</i> options  [tab:format.align]</caption>
<tr style="text-align:center">
<th>Option</th>
<th>Meaning</th>
</tr>
<tr>
<td><tt>&lt;</tt></td>
<td>Forces the field to be <del>left-aligned within</del><ins>aligned to the start of</ins> the 
available space. This is the default for non-arithmetic types, <tt>charT</tt>, and <tt>bool</tt>, 
unless an integer presentation type is specified.</td>
</tr>
<tr>
<td><tt>&gt;</tt></td>
<td>Forces the field to be <del>right-aligned within</del><ins>aligned to the end of</ins> the 
available space. This is the default for arithmetic types other than <tt>charT</tt> and <tt>bool</tt> 
or when an integer presentation type is specified.</td>
</tr>
<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>

</blockquote>
</li>

</ol>





<hr>
<h3><a name="3328" href="3328">3328.</a> Clarify that <tt>std::string</tt> is not good for UTF-8</h3>
<p><b>Section:</b> D.19 <a href="https://timsong-cpp.github.io/cppwp/depr.fs.path.factory">[depr.fs.path.factory]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> The Netherlands <b>Opened:</b> 2019-11-07 <b>Last modified:</b> 2020-02-12 03:28:55 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/371">NL 375</a></b></p>

<p>
Example in deprecated section implies that <tt>std::string</tt> is the type to use for utf8 strings.
</p>
<blockquote><p>
[<i>Example:</i> A string is to be read from a database that is encoded in UTF-8, and used
to create a directory using the native encoding for filenames:
<pre>
namespace fs = std::filesystem;
std::string utf8_string = read_utf8_data();
fs::create_directory(fs::u8path(utf8_string));
</pre>
</p></blockquote>
<p>
Proposed change:
</p>
<p>
Add clarification that <tt>std::string</tt> is the wrong type for utf8 strings
</p>
<p>
<b>Jeff Garland:</b>
<p/>
SG16 in Belfast: Recommend to accept with a modification to update the example in
D.19 <a href="https://timsong-cpp.github.io/cppwp/depr.fs.path.factory">[depr.fs.path.factory]</a> p4 to state that <tt>std::u8string</tt> should
be preferred for UTF-8 data.
<p/>
Rationale: The example code is representative of historic use of <tt>std::filesystem::u8path</tt>
and should not be changed to use <tt>std::u8string</tt>. The recommended change is to a
non-normative example and may therefore be considered editorial.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify D.19 <a href="https://timsong-cpp.github.io/cppwp/depr.fs.path.factory">[depr.fs.path.factory]</a> as indicated:</p>

<blockquote>
<p>
-4- [<i>Example:</i> A string is to be read from a database that is encoded in UTF-8,
and used to create a directory using the native encoding for filenames:
<blockquote><pre>
namespace fs = std::filesystem;
std::string utf8_string = read_utf8_data();
fs::create_directory(fs::u8path(utf8_string));
</pre></blockquote>
For POSIX-based operating systems with the native narrow encoding set to UTF-8,
no encoding or type conversion occurs.
<p/>
For POSIX-based operating systems with the native narrow encoding not set to UTF-8,
a conversion to UTF-32 occurs, followed by a conversion to the current native narrow
encoding. Some Unicode characters may have no native character set representation.
<p/>
For Windows-based operating systems a conversion from UTF-8 to UTF-16 occurs. &mdash;
<i>end example</i>]
<p/>
<ins>[<i>Note:</i> The example above is representative of historic use of
<tt>filesystem</tt> <tt>u8path</tt>. New code should use <tt>std::u8string</tt>
in place of <tt>std::string</tt>. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</li>

</ol>
</blockquote>

<p><em>LWG Belfast Friday Morning</em></p>
<p>
Requested changes:
<ul>
<li>Historic =&gt; historical.</li>
<li>Add missing :: before u8path.</li>
<li>Remove ISO rules forbidden 'should' in a note.</li>
<li>Use language describing why new code should use the u8string constructor
rather than preaching that new code should do something.</li>
</ul>
Billy O'Neal provides updated wording.
</p>

<p><i>[2020-02 Moved to Immediate on Tuesday in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify D.19 <a href="https://timsong-cpp.github.io/cppwp/depr.fs.path.factory">[depr.fs.path.factory]</a> as indicated:</p>

<blockquote>
<p>
-4- [<i>Example:</i> A string is to be read from a database that is encoded in UTF-8,
and used to create a directory using the native encoding for filenames:
<blockquote><pre>
namespace fs = std::filesystem;
std::string utf8_string = read_utf8_data();
fs::create_directory(fs::u8path(utf8_string));
</pre></blockquote>
For POSIX-based operating systems with the native narrow encoding set to UTF-8,
no encoding or type conversion occurs.
<p/>
For POSIX-based operating systems with the native narrow encoding not set to UTF-8,
a conversion to UTF-32 occurs, followed by a conversion to the current native narrow
encoding. Some Unicode characters may have no native character set representation.
<p/>
For Windows-based operating systems a conversion from UTF-8 to UTF-16 occurs. &mdash;
<i>end example</i>]
<p/>
<ins>[<i>Note:</i> The example above is representative of a historical use of
<tt>filesystem::u8path</tt>. Passing a <tt>std::u8string</tt> to <tt>path</tt>'s
constructor is preferred for an indication of UTF-8 encoding more consistent with
<tt>path</tt>'s handling of other encodings.  &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3329" href="3329">3329.</a> <tt>totally_ordered_with</tt> both directly and indirectly requires <tt>common_reference_with</tt></h3>
<p><b>Section:</b> 18.5.4 <a href="https://timsong-cpp.github.io/cppwp/concept.totallyordered">[concept.totallyordered]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-07 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#concept.totallyordered">active issues</a> in [concept.totallyordered].</p>
<p><b>View all other</b> <a href="lwg-index.html#concept.totallyordered">issues</a> in [concept.totallyordered].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/199">US 201</a></b></p>

<p>
The <tt>totally_ordered_with&lt;T, U&gt;</tt> redundantly requires both
<tt>common_reference_with&lt;const remove_reference_t&amp;, const
remove_reference_t&amp;&gt;</tt> and <tt>equality_comparable_with&lt;T,
U&gt;</tt> (which also has the <tt>common_reference_with</tt> requirement). The
redundant requirement should be removed.
<p/>
Proposed change:
<p/>
Change the definition of <tt>totally_ordered_with</tt> to:
</p>
<blockquote>
<pre>
template&lt;class T, class U&gt;
  concept totally_ordered_with =
    totally_ordered&lt;T&gt; &amp;&amp; totally_ordered&lt;U&gt; &amp;&amp;
    equality_comparable_with&lt;T, U&gt; &amp;&amp;
    totally_ordered&lt;
      common_reference_t&lt;
        const remove_reference_t&lt;T&gt;&amp;,
        const remove_reference_t&lt;U&lt;&amp;&gt;&gt; &amp;&amp;
    requires(const remove_reference_t&lt;T&lt;&amp; t,
                    const remove_reference_t&gt;U&gt;&amp; u) {
      [&hellip; as before &hellip;]
</pre>
</blockquote>

<p><i>[2019-11 Moved to Ready on Friday AM in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Change 18.5.4 <a href="https://timsong-cpp.github.io/cppwp/concept.totallyordered">[concept.totallyordered]</a> as indicated:</p>

<blockquote>
<p>
For some type <tt>T</tt>, let <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> be lvalues
of type <tt>const remove_reference_t&lt;T&gt;</tt>. <tt>T</tt> models
<tt>totally_ordered</tt> only if
</p>
<ol style="list-style-type: none">
  <li><p>(1.1) &mdash; Exactly one of <tt>bool(a &lt; b)</tt>, <tt>bool(a &gt; b)</tt>, or <tt>bool(a == b)</tt> is
  <tt>true</tt>.</p></li>
  <li><p>(1.2) &mdash; If <tt>bool(a &lt; b)</tt> and <tt>bool(b &lt; c)</tt>, then <tt>bool(a &lt; c)</tt>.</p></li>
  <li><p>(1.3) &mdash; <tt>bool(a &gt; b) == bool(b &lt; a)</tt>.</p></li>
  <li><p>(1.4) &mdash; <tt>bool(a &lt;= b) == !bool(b &lt; a)</tt>.</p></li>
  <li><p>(1.5) &mdash; <tt>bool(a &gt;= b) == !bool(a &lt; b)</tt>.</p></li>
</ol>
<pre>
template&lt;class T, class U&gt;
  concept totally_ordered_with =
    totally_ordered&lt;T&gt; &amp;&amp; totally_ordered&lt;U&gt; &amp;&amp;
    <del>common_reference_with&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt; &amp;&amp;</del>
    <ins>equality_comparable_with&lt;T, U&gt; &amp;&amp;</ins>
    totally_ordered&lt;
      common_reference_t&lt;
        const remove_reference_t&lt;T&gt;&amp;,
        const remove_reference_t&lt;U&gt;&amp;&gt;&gt; &amp;&amp;
    <del>equality_comparable_with&lt;T, U&gt; &amp;&amp;</del>
    requires(const remove_reference_t&lt;T&gt;&amp; t,
             const remove_reference_t&lt;U&gt;&amp; u) {
      { t &lt;  u } -&gt; boolean;
      { t &gt;  u } -&gt; boolean;
      { t &lt;= u } -&gt; boolean;
      { t &gt;= u } -&gt; boolean;
      { u &lt;  t } -&gt; boolean;
      { u &gt;  t } -&gt; boolean;
      { u &lt;= t } -&gt; boolean;
      { u &gt;= t } -&gt; boolean;
    };
</pre>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3330" href="3330">3330.</a> Include <tt>&lt;compare&gt;</tt> from most library headers</h3>
<p><b>Section:</b> 17.12.1 <a href="https://timsong-cpp.github.io/cppwp/coroutine.syn">[coroutine.syn]</a>, 19.5.1 <a href="https://timsong-cpp.github.io/cppwp/system.error.syn">[system.error.syn]</a>, 20.2.1 <a href="https://timsong-cpp.github.io/cppwp/utility.syn">[utility.syn]</a>, 20.5.2 <a href="https://timsong-cpp.github.io/cppwp/tuple.syn">[tuple.syn]</a>, 20.6.2 <a href="https://timsong-cpp.github.io/cppwp/optional.syn">[optional.syn]</a>, 20.7.2 <a href="https://timsong-cpp.github.io/cppwp/variant.syn">[variant.syn]</a>, 20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a>, 20.17.1 <a href="https://timsong-cpp.github.io/cppwp/type.index.synopsis">[type.index.synopsis]</a>, 21.3.1 <a href="https://timsong-cpp.github.io/cppwp/string.syn">[string.syn]</a>, 21.4.1 <a href="https://timsong-cpp.github.io/cppwp/string.view.synop">[string.view.synop]</a>, 22.3.2 <a href="https://timsong-cpp.github.io/cppwp/array.syn">[array.syn]</a>, 22.3.3 <a href="https://timsong-cpp.github.io/cppwp/deque.syn">[deque.syn]</a>, 22.3.4 <a href="https://timsong-cpp.github.io/cppwp/forward.list.syn">[forward.list.syn]</a>, 22.3.5 <a href="https://timsong-cpp.github.io/cppwp/list.syn">[list.syn]</a>, 22.3.6 <a href="https://timsong-cpp.github.io/cppwp/vector.syn">[vector.syn]</a>, 22.4.2 <a href="https://timsong-cpp.github.io/cppwp/associative.map.syn">[associative.map.syn]</a>, 22.4.3 <a href="https://timsong-cpp.github.io/cppwp/associative.set.syn">[associative.set.syn]</a>, 22.5.2 <a href="https://timsong-cpp.github.io/cppwp/unord.map.syn">[unord.map.syn]</a>, 22.5.3 <a href="https://timsong-cpp.github.io/cppwp/unord.set.syn">[unord.set.syn]</a>, 22.6.2 <a href="https://timsong-cpp.github.io/cppwp/queue.syn">[queue.syn]</a>, 22.6.3 <a href="https://timsong-cpp.github.io/cppwp/stack.syn">[stack.syn]</a>, 23.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.synopsis">[iterator.synopsis]</a>, 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>, 27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a>, 29.11.5 <a href="https://timsong-cpp.github.io/cppwp/fs.filesystem.syn">[fs.filesystem.syn]</a>, 30.4 <a href="https://timsong-cpp.github.io/cppwp/re.syn">[re.syn]</a>, 32.4.1 <a href="https://timsong-cpp.github.io/cppwp/thread.syn">[thread.syn]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> United States <b>Opened:</b> 2019-11-07 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/179">US 181</a></b></p>

<p>
The spaceship <tt>operator&lt;=&gt;</tt> is typically not usable unless the library 
header <tt>&lt;compare&gt;</tt> is directly included by the user. Many standard
library headers provide overloads for this operator. Worse, several standard classes
have replaced their existing definition for comparison operators with a reliance on the
spaceship operator, and existing code will break if the necessary header is not
(transitively) included. In a manner similar to the mandated library headers
transitively <tt>#include</tt>-ing <tt>&lt;initializer_list&gt;</tt> in C++11, 
these headers should mandate a transitive <tt>#include &lt;compare&gt;</tt>.
<p/>
Proposed change:
<p/>
Add:
<p/>
<tt>#include &lt;compare&gt;</tt>
<p/>
to the header synopsis for each of the following headers:
</p>
<blockquote>
<pre>
&lt;array&gt;
&lt;chrono&gt;
&lt;coroutine&gt;
&lt;deque&gt;
&lt;forward_list&gt;
&lt;filesystem&gt;
&lt;iterator&gt;
&lt;list&gt;
&lt;map&gt;
&lt;memory&gt;
&lt;optional&gt;
&lt;queue&gt;
&lt;ranges&gt;
&lt;regex&gt;
&lt;set&gt;
&lt;stack&gt;
&lt;string&gt;
&lt;string_view&gt;
&lt;system_error&gt;
&lt;thread&gt;
&lt;tuple&gt;
&lt;type_index&gt;
&lt;unordered_map&gt;
&lt;unordered_set&gt;
&lt;utility&gt;
&lt;variant&gt;
&lt;vector&gt;
</pre>
</blockquote>

<p><i>[2019-11 Moved to Ready on Friday AM in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Add</p>
<blockquote><pre>
#include &lt;compare&gt;
</pre></blockquote>
<p>
to the following header synopses:
</p>
<ol>
<li>17.12.1 <a href="https://timsong-cpp.github.io/cppwp/coroutine.syn">[coroutine.syn]</a></li>
<li>19.5.1 <a href="https://timsong-cpp.github.io/cppwp/system.error.syn">[system.error.syn]</a></li>
<li>20.2.1 <a href="https://timsong-cpp.github.io/cppwp/utility.syn">[utility.syn]</a></li>
<li>20.5.2 <a href="https://timsong-cpp.github.io/cppwp/tuple.syn">[tuple.syn]</a></li>
<li>20.6.2 <a href="https://timsong-cpp.github.io/cppwp/optional.syn">[optional.syn]</a></li>
<li>20.7.2 <a href="https://timsong-cpp.github.io/cppwp/variant.syn">[variant.syn]</a></li>
<li>20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a></li>
<li>20.17.1 <a href="https://timsong-cpp.github.io/cppwp/type.index.synopsis">[type.index.synopsis]</a></li>
<li>21.3.1 <a href="https://timsong-cpp.github.io/cppwp/string.syn">[string.syn]</a></li>
<li>21.4.1 <a href="https://timsong-cpp.github.io/cppwp/string.view.synop">[string.view.synop]</a></li>
<li>22.3.2 <a href="https://timsong-cpp.github.io/cppwp/array.syn">[array.syn]</a></li>
<li>22.3.3 <a href="https://timsong-cpp.github.io/cppwp/deque.syn">[deque.syn]</a></li>
<li>22.3.4 <a href="https://timsong-cpp.github.io/cppwp/forward.list.syn">[forward.list.syn]</a></li>
<li>22.3.5 <a href="https://timsong-cpp.github.io/cppwp/list.syn">[list.syn]</a></li>
<li>22.3.6 <a href="https://timsong-cpp.github.io/cppwp/vector.syn">[vector.syn]</a></li>
<li>22.4.2 <a href="https://timsong-cpp.github.io/cppwp/associative.map.syn">[associative.map.syn]</a></li>
<li>22.4.3 <a href="https://timsong-cpp.github.io/cppwp/associative.set.syn">[associative.set.syn]</a></li>
<li>22.5.2 <a href="https://timsong-cpp.github.io/cppwp/unord.map.syn">[unord.map.syn]</a></li>
<li>22.5.3 <a href="https://timsong-cpp.github.io/cppwp/unord.set.syn">[unord.set.syn]</a></li>
<li>22.6.2 <a href="https://timsong-cpp.github.io/cppwp/queue.syn">[queue.syn]</a></li>
<li>22.6.3 <a href="https://timsong-cpp.github.io/cppwp/stack.syn">[stack.syn]</a></li>
<li>23.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.synopsis">[iterator.synopsis]</a></li>
<li>24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a></li>
<li>27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a></li>
<li>29.11.5 <a href="https://timsong-cpp.github.io/cppwp/fs.filesystem.syn">[fs.filesystem.syn]</a></li>
<li>30.4 <a href="https://timsong-cpp.github.io/cppwp/re.syn">[re.syn]</a></li>
<li>32.4.1 <a href="https://timsong-cpp.github.io/cppwp/thread.syn">[thread.syn]</a></li>
</ol>
</li>
</ol>




<hr>
<h3><a name="3331" href="3331">3331.</a> Define <tt>totally_ordered/_with</tt> in terms of <tt><i>partially-ordered-with</i></tt></h3>
<p><b>Section:</b> 18.5.4 <a href="https://timsong-cpp.github.io/cppwp/concept.totallyordered">[concept.totallyordered]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Great Britain <b>Opened:</b> 2019-11-08 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#concept.totallyordered">active issues</a> in [concept.totallyordered].</p>
<p><b>View all other</b> <a href="lwg-index.html#concept.totallyordered">issues</a> in [concept.totallyordered].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/200">GB 202</a></b></p>

<p>
Define <tt>totally_ordered[_with]</tt>
in terms of <tt><i>partially-ordered-with</i></tt>.
This will simplify the definition of both concepts
(particularly <tt>totally_ordered_with</tt>), and
make them in-line with <tt>equality_comparable[_with]</tt>.
Now that we've defined <tt><i>partially-ordered-with</i></tt>
for 17.11.4 <a href="https://timsong-cpp.github.io/cppwp/cmp.concept">[cmp.concept]</a>, we should consider
utilising it in as many locations as possible.
</p><p>
Proposed change:
</p><p>
<pre>
template&lt;class T&gt;
  concept totally_ordered =
    equality_comparable&lt;T&gt; &amp;&amp;
    <i>partially-ordered-with</i>&lt;T, T&gt;;

template&lt;class T, class U&gt;
  concept totally_ordered_with =
    totally_ordered&lt;T&gt; &amp;&amp;
    totally_ordered&lt;U&gt; &amp;&amp;
    common_reference_with&lt;
      const remove_reference_t&lt;T&gt;&amp;,
      const remove_reference_t&lt;U&gt;&amp;&gt; &amp;&amp;
    totally_ordered&lt;
      common_reference_t&lt;
        const remove_reference_t&lt;T&gt;&amp;,
        const remove_reference_t&lt;U&gt;&amp;&gt;&gt; &amp;&amp;
    equality_comparable_with&lt;T, U&gt; &amp;&amp;
    <i>partially-ordered-with</i>&lt;T, U&gt;;
</pre>
</p><p>
LWG discussion in Belfast notes that <a href="3329">3329</a>
also touches the definition of <tt>totally_ordered_with</tt>;
the two sets of changes are consistent.
</p>
<p><i>[2019-11 Status to Ready Friday afternoon LWG in Belfast]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Change 18.5.4 <a href="https://timsong-cpp.github.io/cppwp/concept.totallyordered">[concept.totallyordered]</a> as follows:</p>
<blockquote><pre>
template&lt;class T&gt;
  concept totally_ordered =
    equality_comparable&lt;T&gt; &amp;&amp; <ins><i>partially-ordered-with</i>&lt;T, T&gt;;</ins>
    <del>requires(const remove_reference_t&lt;T&gt;&amp; a,</del>
             <del>const remove_reference_t&lt;T&gt;&amp; b) {</del>
      <del>{ a &lt;  b } -&gt; boolean;</del>
      <del>{ a &gt;  b } -&gt; boolean;</del>
      <del>{ a &lt;= b } -&gt; boolean;</del>
      <del>{ a &gt;= b } -&gt; boolean;</del>
    <del>};</del>
</pre><p>
-1- For some type <tt>T</tt>, let <tt>a</tt>, <tt>b</tt>, and <tt>c</tt>
be lvalues of type <tt>const remove_reference_t&lt;T&gt;</tt>.
<tt>T</tt> models <tt>totally_ordered</tt> only if
</p><p>
(1.1) &mdash; Exactly one of <tt>bool(a &lt; b)</tt>, <tt>bool(a &gt; b)</tt>,
or <tt>bool(a == b)</tt> is <tt>true</tt>.
</p><p>
(1.2) &mdash; If <tt>bool(a &lt; b)</tt> and <tt>bool(b &lt; c)</tt>,
then <tt>bool(a &lt; c)</tt>.
</p><p>
<del>(1.3) &mdash; <tt>bool(a &gt; b) == bool(b &lt; a)</tt>.</del>
</p><p>
(1.4) &mdash; <tt>bool(a &lt;= b) == !bool(b &lt; a)</tt>.
</p><p>
(1.5) &mdash; <tt>bool(a &gt;= b) == !bool(a &lt; b)</tt>.
</p><pre>
template&lt;class T, class U&gt;
  concept totally_ordered_with =
    totally_ordered&lt;T&gt; &amp;&amp; totally_ordered&lt;U&gt; &amp;&amp;
    common_reference_with&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt; &amp;&amp;
    totally_ordered&lt;
      common_reference_t&lt;
        const remove_reference_t&lt;T&gt;&amp;,
        const remove_reference_t&lt;U&gt;&amp;&gt;&gt; &amp;&amp;
      equality_comparable_with&lt;T, U&gt; &amp;&amp;
      <ins><i>partially-ordered-with</i>&lt;T, U&gt;;</ins>
      <del>requires(const remove_reference_t&lt;T&gt;&amp; t,</del>
               <del>const remove_reference_t&lt;U&gt;&amp; u) {</del>
        <del>{ t &lt;  u } -&gt; boolean;</del>
        <del>{ t &gt;  u } -&gt; boolean;</del>
        <del>{ t &lt;= u } -&gt; boolean;</del>
        <del>{ t &gt;= u } -&gt; boolean;</del>
        <del>{ u &lt;  t } -&gt; boolean;</del>
        <del>{ u &gt;  t } -&gt; boolean;</del>
        <del>{ u &lt;= t } -&gt; boolean;</del>
        <del>{ u &gt;= t } -&gt; boolean;</del>
      <del>};</del>
</pre><p>
[&hellip;]
</p>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3332" href="3332">3332.</a> Issue in &sect;[time.format]</h3>
<p><b>Section:</b> 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Mateusz Pusz <b>Opened:</b> 2019-11-05 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#time.format">active issues</a> in [time.format].</p>
<p><b>View all other</b> <a href="lwg-index.html#time.format">issues</a> in [time.format].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Table 97 [tab:time.format.spec] enumerates <tt>'q'</tt> and <tt>'Q'</tt> but those are not specified in 
<i>chrono-format-spec</i> provided in paragraph 1 of sub-clause 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a>.
</p>

<p><i>[2019-11-23 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after eight positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Change the <i>type</i> grammar element in 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a> p1 as indicated:</p>

<blockquote>
<pre>
<i>type:</i> one of
         a A b B c C d D e F g G h H I j m M n
         p <ins>q Q</ins> r R S t T u U V w W x X y Y z Z %
</pre>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3334" href="3334">3334.</a> <tt>basic_osyncstream</tt> move assignment and destruction calls <tt>basic_syncbuf::emit()</tt> twice</h3>
<p><b>Section:</b> 29.10.3 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream">[syncstream.osyncstream]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2019-11-06 <b>Last modified:</b> 2020-02-14 07:30:42 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
These functions are specified to call <tt>emit()</tt>, which calls <tt>emit()</tt> on
the <tt>basic_syncbuf</tt> and sets <tt>badbit</tt> if it fails. Then, the move
assignment is specified to move-assign the <tt>basic_syncbuf</tt>, while the destructor
implicitly needs to destroy the <tt>basic_syncbuf</tt> data member. This calls <tt>emit()</tt>
on the <tt>basic_syncbuf</tt> again.
<p/>
Is this intended?
</p>
<p><i>[2020-02-13 Tim adds wording after discussion with Peter]</i></p>

<p><i>[2020-02 Status to Immediate Thursday afternoon in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/N4849">N4849</a>.</p>
<blockquote class="note">
<p>
[<i>Drafting note:</i> There is no need to explicitly call <tt>emit</tt> at all in these functions;
memberwise move-assignment/destruction is sufficient, so we can strike the specification
entirely and rely on the wording in 16.4.2.3 <a href="https://timsong-cpp.github.io/cppwp/functions.within.classes">[functions.within.classes]</a>. <i>&mdash; end drafting note</i>]
</p>
</blockquote>
<ol>
<li>
<p>Edit 29.10.3.2 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream.cons">[syncstream.osyncstream.cons]</a> as indicated:</p>
<blockquote>
<pre>
<del>~basic_osyncstream();</del>
</pre>
<blockquote>
<p><del>-6- <i>Effects:</i> Calls <tt>emit()</tt>. If an exception is thrown
from <tt>emit()</tt>, that exception is caught and ignored.</del></p>
</blockquote>
</blockquote>
</li>
<li>
<p>Strike 29.10.3.3 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream.assign">[syncstream.osyncstream.assign]</a>:</p>
<blockquote>
<pre>
<del>basic_osyncstream&amp; operator=(basic_osyncstream&amp;&amp; rhs) noexcept;</del>
</pre>
<blockquote>
<p><del>-1- <i>Effects:</i> First, calls <tt>emit()</tt>.
If an exception is thrown from <tt>emit()</tt>, that exception is caught and ignored.
Move assigns <tt>sb</tt> from <tt>rhs.sb</tt>. [ <i>Note:</i> This disassociates <tt>rhs</tt>
from its wrapped stream buffer ensuring destruction of <tt>rhs</tt> produces no output.  <i>end note</i> ]</del>
<p/>
<del>-2- <i>Postconditions:</i> <tt>nullptr == rhs.get_wrapped()</tt> is <tt>true</tt>.
<tt>get_wrapped()</tt> returns the value previously returned by <tt>rhs.get_wrapped()</tt>.
</del>
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3335" href="3335">3335.</a> Resolve C++20 NB comments US 273 and GB 274</h3>
<p><b>Section:</b> 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> United States/Great Britain <b>Opened:</b> 2019-11-08 <b>Last modified:</b> 2020-02-10 19:48:51 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#ranges.syn">active issues</a> in [ranges.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#ranges.syn">issues</a> in [ranges.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/269">US 273</a>/<a href="https://github.com/cplusplus/nbballot/issues/270">GB 274</a></b></p>

<p>
<b><a href="https://github.com/cplusplus/nbballot/issues/269">US 273</a>:</b>
<p/>
<tt>all_view</tt> is not a view like the others. For the other view types, <tt>foo_view{args...}</tt> is a valid
way to construct an instance of type foo_view. However, <tt>all_view</tt> is just an alias to the type of 
<tt>view::all(arg)</tt>, which could be one of several different types. <tt>all_view</tt> feels like the wrong name.
<p/>
Proposed change:
<p/>
Suggest renaming <tt>all_view</tt> to <tt>all_t</tt> and
moving it into the <tt>views::</tt> namespace.
</p>

<p>
<b><a href="https://github.com/cplusplus/nbballot/issues/270">GB 274</a>:</b>
<p/>
Add <tt>range_size_t</tt>.
<p/>
LEWG asked that <tt>range_size_t</tt> be removed from <a href="https://wg21.link/p1035">P1035</a>, 
as they were doing a good job of being neutral w.r.t whether or not size-types were signed or 
unsigned at the time. Now that we've got a policy on what size-types are, and that 
<a href="https://wg21.link/p1522">P1522</a> and <a href="https://wg21.link/p1523">P1523</a> 
have been adopted, it makes sense for there to be a <tt>range_size_t</tt>.
<p/>
Proposed change:
<p/>
Add to [ranges.syn]:
</p>
<blockquote><pre>
template&lt;range R&gt;
  using range_difference_t = iter_difference_t&lt;iterator_t&lt;R&gt;&gt;;
<ins>template&lt;sized_range R&gt;
  using range_size_t = decltype(ranges::size(declval&lt;R&amp;&gt;()));</ins>
</pre></blockquote>
<p>
<b>David Olsen:</b>
<p/>
The proposed wording has been approved by LEWG and LWG in Belfast.
</p>

<p><i>[2019-11-23 Issue Prioritization]</i></p>

<p>Priority to 1 after reflector discussion.</p>

<p><i>[2020-02-10 Move to Immediate Monday afternoon in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Change 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>, header <tt>&lt;ranges&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
#include &lt;initializer_list&gt;
#include &lt;iterator&gt;

namespace std::ranges {
  [&hellip;]
  <i>// 24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a>, ranges</i>
  template&lt;class T&gt;
  concept range = <i>see below</i>;
  [&hellip;]
  template&lt;range R&gt;
    using range_difference_t = iter_difference_t&lt;iterator_t&lt;R&gt;&gt;;
  <ins>template&lt;sized_range R&gt;
    using range_size_t = decltype(ranges::size(declval&lt;R&amp;&gt;()));</ins>
  template&lt;range R&gt;
    using range_value_t = iter_value_t&lt;iterator_t&lt;R&gt;&gt;;
  [&hellip;]
  <i>// 24.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.ref.view">[range.ref.view]</a>, all view</i>
  namespace views { <del>inline constexpr <i>unspecified</i> all = <i>unspecified</i>; }</del>
    <ins>inline constexpr <i>unspecified</i> all = <i>unspecified</i>;</ins>

    template&lt;viewable_range R&gt;
      using all_<ins>t</ins><del>view</del> = decltype(<del>views::</del>all(declval&lt;R&gt;()));
  <ins>}</ins>
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Globally replace all occurrences of <tt>all_view</tt> with <tt>views::all_t</tt>. There are 36 
occurrences in addition to the definition in the <tt>&lt;ranges&gt;</tt> synopsis that was changed above.</p>
</li>
</ol>




<hr>
<h3><a name="3337" href="3337">3337.</a> What is "is initialized" supposed to mean?</h3>
<p><b>Section:</b> 28.4.1.4.2 <a href="https://timsong-cpp.github.io/cppwp/locale.codecvt.virtuals">[locale.codecvt.virtuals]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-11-15 <b>Last modified:</b> 2019-11-30 13:47:36 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#locale.codecvt.virtuals">issues</a> in [locale.codecvt.virtuals].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In 28.4.1.4.2 <a href="https://timsong-cpp.github.io/cppwp/locale.codecvt.virtuals">[locale.codecvt.virtuals]</a> paragraphs 6 and 11, we find:
</p>
<blockquote>
<p>
<i>Preconditions:</i> <tt>(to &lt;= to_end)</tt> is well-defined and <tt>true</tt>; <tt>state</tt> 
is initialized, if at the beginning of a sequence, or else is equal to the result of converting 
the preceding characters in the sequence."
</p>
</blockquote>
<p>
This doesn't make sense. What is the value of <tt>state</tt> if we're at the beginning of a sequence? 
Is the fact that we say that it's initialized in that case supposed to imply that it need not be 
initialized otherwise?
<p/>
Perhaps this means "value-initialized" or "default-initialized" instead of merely "initialized"?
</p>

<p><i>[2019-11-30 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3338" href="3338">3338.</a> Rename <tt>default_constructible</tt> to <tt>default_initializable</tt></h3>
<p><b>Section:</b> 18.4.12 <a href="https://timsong-cpp.github.io/cppwp/concept.defaultconstructible">[concept.defaultconstructible]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-11-18 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#concept.defaultconstructible">issues</a> in [concept.defaultconstructible].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
WG21 merged <a href="http://wg21.link/p1754r1">P1754R1</a> "Rename concepts to <tt>standard_case</tt> for C++20" 
into the working draft as LWG Motion 11 in 2019 Cologne. That proposal contains editorial instructions to 
rename what was the <tt>DefaultConstructible</tt> concept:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
<pre>
IF LWG3151 ACCEPTED:
  default_initializable
ELSE
  default_constructible
</pre>
</blockquote>
<p>
Notably LWG <a href="3151">3151</a> "<tt>ConvertibleTo</tt> rejects conversions from array and function types" is 
not the intended issue number, LWG <a href="3149">3149</a> "<tt>DefaultConstructible</tt> should require default 
initialization" is. It was made clear during discussion in LEWG that 3149 would change the concept to require default-initialization to be valid rather than value-initialization which the <tt>is_default_constructible</tt> 
trait requires. LEWG agreed that it would be confusing to have a trait and concept with very similar names 
yet slightly different meanings, and approved <a href="http://wg21.link/p1754r1">P1754R1</a>'s proposed renaming.
<p/>
LWG <a href="3149">3149</a> was moved to "Ready" but not approved by WG21 until Belfast &mdash; after the application 
of P1754R1 to the working draft &mdash; so this renaming has not happened, but the rationale remains valid.
</p>

<p><i>[2019-11-30 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after eight positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Change the stable name "[concept.defaultconstructible]" to "[concept.default.init]" and retitle 
"Concept <tt>default_constructible</tt>" to "Concept <tt>default_initializable</tt>". Replace all references 
to the name <tt>default_constructible</tt> with <tt>default_initializable</tt> (There are 20 occurrences).</p>
</li>
</ol>




<hr>
<h3><a name="3339" href="3339">3339.</a> Move-constructed empty-container capacity</h3>
<p><b>Section:</b> 21.3.2 <a href="https://timsong-cpp.github.io/cppwp/basic.string">[basic.string]</a>, 22.3.11 <a href="https://timsong-cpp.github.io/cppwp/vector">[vector]</a>, 22.5.4 <a href="https://timsong-cpp.github.io/cppwp/unord.map">[unord.map]</a>, 22.5.6 <a href="https://timsong-cpp.github.io/cppwp/unord.set">[unord.set]</a>, 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Nathan Myers <b>Opened:</b> 2019-11-17 <b>Last modified:</b> 2019-12-01 10:59:02 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#basic.string">active issues</a> in [basic.string].</p>
<p><b>View all other</b> <a href="lwg-index.html#basic.string">issues</a> in [basic.string].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The Standard leaves unspecified the <tt>capacity()</tt> of a <tt>string</tt> or <tt>vector</tt>, 
and <tt>bucket_count()</tt> of an <tt>unordered_(multi)set</tt> or <tt>unordered_(multi)map</tt>, 
constructed by move from an empty <tt>other</tt>.
<p/>
For a non-empty <tt>other</tt>, normative language in the Standard constrains the new object to 
use (mostly) the same storage as the other, by way of lifetime of iterators and pointers
to elements.
<p/>
For an empty <tt>other</tt>, there can be no such pointers or iterators. However, the empty 
container may have a non-zero <tt>capacity()</tt> or <tt>bucket_count()</tt>, and having reserved 
storage there, one naturally expects that storage to be delivered to the new object in the same 
way as if it had elements.
<p/>
Existing implementations, in fact, do move storage to the new container, provided it can be 
deallocated using the new object's allocator. It is likely that existing programs have come to 
depend on this behavior.
<p/>
The resolution proposed is to add language to the Standard specifying that, if the allocators 
of the existing and new container objects are compatible, the storage of the new object is the 
same as of the old, so that no allocations or deallocations are performed in the process, as 
existing implementations in fact do.
<p/>
This appears to affect only <tt>string</tt>, <tt>vector</tt>, <tt>unordered_set</tt>, 
<tt>unordered_multiset</tt>, <tt>unordered_map</tt>, and <tt>unordered_multimap</tt>, but any 
new container types may also need similar attention.
<p/>
Note that in the case of the hashed containers, the array of buckets appears not to be required 
to be moved, even when elements contained are. This seems to be a similar oversight; extant 
implementations do move the bucket array. The resolution should cover this case as well.
<p/>
It is expected and intended that the proposed resolution does not require changes to the behavior 
of implementations.
<p/>
See also LWG <a href="2321">2321</a> and <a href="http://wg21.link/p0966r1">P0966R1</a>.
</p>

<p><i>[2019-11-30 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3340" href="3340">3340.</a> Formatting functions should throw on argument/format string mismatch in &sect;[format.functions]</h3>
<p><b>Section:</b> 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Great Britain <b>Opened:</b> 2019-11-17 <b>Last modified:</b> 2020-02-13 09:32:20 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.functions">active issues</a> in [format.functions].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.functions">issues</a> in [format.functions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/226">GB 229</a></b></p>

<p>
Formatting functions don't allow throwing on incorrect arguments. 
<tt>std::format</tt> is only allowed to throw if <tt>fmt</tt> is not a format string, but the 
intention is it also throws for errors during formatting, e.g. there are fewer arguments than 
required by the format string.
</p>
<p>
Proposed change:
</p>
<p>
Allow exceptions even when the format string is valid. Possibly state the <i>Effects:</i> more
precisely.
</p>
<p>
<b>Victor Zverovich:</b>
<p/>
LEWG approved resolution of this NB comment as an LWG issue.
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting Note:</i> Depending on whether LWG <a href="3336">3336</a>'s wording has been accepted when 
this issue's wording has been accepted, two mutually exclusive options are prepared, depicted below 
by <b>Option A</b> and <b>Option B</b>, respectively.]
</p>
</blockquote>

<p><b>Option A</b> (LWG <a href="3336">3336</a> has been accepted)</p>

<ol>
<li><p>Change 20.20.2.1 <a href="https://timsong-cpp.github.io/cppwp/format.string.general">[format.string.general]</a> as follows:</p>

<blockquote>
<p>
-1- A <i>format string</i> <ins>for arguments <tt>args</tt></ins> is a (possibly empty) sequence of 
<i>replacement fields</i>, <i>escape sequences</i>, and characters other than <tt>{</tt> and <tt>}</tt>. 
[&hellip;]
<p/>
-2- The <i>arg-id</i> field specifies the index of the argument in <tt>args</tt> whose value is to be 
formatted and inserted into the output instead of the replacement field. <ins>If there is no argument 
with the index <i>arg-id</i> in <tt>args</tt>, the string is not a format string.</ins> The optional 
<i>format-specifier</i> field explicitly specifies a format for the replacement value.
<p/>
[&hellip;]
<p/>
-5- The <i>format-spec</i> field contains <i>format specifications</i> that define how the value 
should be presented. Each type can define its own interpretation of the <i>format-spec</i> field. 
<ins>If <i>format-spec</i> doesn't conform to the format specifications for the argument in <tt>args</tt> 
referred to by <i>arg-id</i>, the string is not a format string.</ins> [&hellip;]
</p>
</blockquote>
</li>

<li><p>Before 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> insert a new sub-clause as indicated:</p>

<blockquote>
<p>
<ins><b>20.20.? Error reporting [format.err.report]</b></ins>
<p/>
<ins>-?- Formatting functions throw exceptions to report formatting and other errors. They throw 
<tt>format_error</tt> if an argument <tt>fmt</tt> is passed that is not a format string for arguments 
<tt>args</tt> and propagate exceptions thrown by <tt>formatter</tt> specializations and iterator operations. 
Failure to allocate storage is reported by throwing an exception as described in 
16.5.5.13 <a href="https://timsong-cpp.github.io/cppwp/res.on.exception.handling">[res.on.exception.handling]</a>.</ins>
</p>
</blockquote>
</li>

<li><p>Modify 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> as indicated:</p>

<blockquote>
<pre>
string vformat(string_view fmt, format_args args);
wstring vformat(wstring_view fmt, wformat_args args);
string vformat(const locale&amp; loc, string_view fmt, format_args args);
wstring vformat(const locale&amp; loc, wstring_view fmt, wformat_args args);
</pre>
<blockquote>
<p>
-6- [&hellip;]
<p/>
-7- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Out&gt;
  Out vformat_to(Out out, string_view fmt, format_args_t&lt;Out, char&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, wstring_view fmt, format_args_t&lt;Out, wchar_t&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, const locale&amp; loc, string_view fmt,
                 format_args_t&lt;Out, char&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, const locale&amp; loc, wstring_view fmt,
                 format_args_t&lt;Out, wchar_t&gt; args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-15- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      string_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      wstring_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      const locale&amp; loc, string_view fmt,
                                      const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      const locale&amp; loc, wstring_view fmt,
                                      const Args&amp;... args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-21- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class... Args&gt;
  size_t formatted_size(string_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(wstring_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(const locale&amp; loc, string_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(const locale&amp; loc, wstring_view fmt, const Args&amp;... args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-25- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
</blockquote>
</li>
</ol>

<p><b>Option B</b> (LWG <a href="3336">3336</a> has <b>not</b> been accepted)</p>

<ol>
<li><p>Change 20.20.2.1 <a href="https://timsong-cpp.github.io/cppwp/format.string.general">[format.string.general]</a> as follows:</p>

<blockquote>
<p>
-1- A <i>format string</i> <ins>for arguments <tt>args</tt></ins> is a (possibly empty) sequence of 
<i>replacement fields</i>, <i>escape sequences</i>, and characters other than <tt>{</tt> and <tt>}</tt>. 
[&hellip;]
<p/>
-2- The <i>arg-id</i> field specifies the index of the argument in <tt>args</tt> whose value is to be 
formatted and inserted into the output instead of the replacement field. <ins>If there is no argument 
with the index <i>arg-id</i> in <tt>args</tt>, the string is not a format string.</ins> The optional 
<i>format-specifier</i> field explicitly specifies a format for the replacement value.
<p/>
[&hellip;]
<p/>
-5- The <i>format-spec</i> field contains <i>format specifications</i> that define how the value 
should be presented. Each type can define its own interpretation of the <i>format-spec</i> field. 
<ins>If <i>format-spec</i> doesn't conform to the format specifications for the argument in <tt>args</tt> 
referred to by <i>arg-id</i>, the string is not a format string.</ins> [&hellip;]
</p>
</blockquote>
</li>

<li><p>Modify 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> as indicated:</p>

<blockquote>
<pre>
string vformat(string_view fmt, format_args args);
wstring vformat(wstring_view fmt, wformat_args args);
string vformat(const locale&amp; loc, string_view fmt, format_args args);
wstring vformat(const locale&amp; loc, wstring_view fmt, wformat_args args);
</pre>
<blockquote>
<p>
-6- [&hellip;]
<p/>
-7- <i>Throws:</i> <tt>format_error</tt> if <tt>fmt</tt> is not a format string <ins>for <tt>args</tt></ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Out&gt;
  Out vformat_to(Out out, string_view fmt, format_args_t&lt;Out, char&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, wstring_view fmt, format_args_t&lt;Out, wchar_t&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, const locale&amp; loc, string_view fmt,
                 format_args_t&lt;Out, char&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, const locale&amp; loc, wstring_view fmt,
                 format_args_t&lt;Out, wchar_t&gt; args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-15- <i>Throws:</i> <tt>format_error</tt> if <tt>fmt</tt> is not a format string <ins>for <tt>args</tt></ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      string_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      wstring_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      const locale&amp; loc, string_view fmt,
                                      const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      const locale&amp; loc, wstring_view fmt,
                                      const Args&amp;... args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-21- <i>Throws:</i> <tt>format_error</tt> if <tt>fmt</tt> is not a format string <ins>for <tt>args</tt></ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class... Args&gt;
  size_t formatted_size(string_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(wstring_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(const locale&amp; loc, string_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(const locale&amp; loc, wstring_view fmt, const Args&amp;... args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-25- <i>Throws:</i> <tt>format_error</tt> if <tt>fmt</tt> is not a format string <ins>for <tt>args</tt></ins>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-12, Prague; LWG discussion]</i></p>

<p>
Option A is the only one we look at to resolve LWG <a href="3336">3336</a> as well. During the discussions some 
wording refinements have been suggested that are integrated below.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Change 20.20.2.1 <a href="https://timsong-cpp.github.io/cppwp/format.string.general">[format.string.general]</a> as follows:</p>

<blockquote>
<p>
-1- A <i>format string</i> <ins>for arguments <tt>args</tt></ins> is a (possibly empty) sequence of 
<i>replacement fields</i>, <i>escape sequences</i>, and characters other than <tt>{</tt> and <tt>}</tt>. 
[&hellip;]
<p/>
-2- The <i>arg-id</i> field specifies the index of the argument in <tt>args</tt> whose value is to be 
formatted and inserted into the output instead of the replacement field. <ins>If there is no argument 
with the index <i>arg-id</i> in <tt>args</tt>, the string is not a format string for <tt>args</tt>.</ins> The optional 
<i>format-specifier</i> field explicitly specifies a format for the replacement value.
<p/>
[&hellip;]
<p/>
-5- The <i>format-spec</i> field contains <i>format specifications</i> that define how the value 
should be presented. Each type can define its own interpretation of the <i>format-spec</i> field. 
<ins>If <i>format-spec</i> does not conform to the format specifications for the argument type referred to 
by <i>arg-id</i>, the string is not a format string for <tt>args</tt>.</ins> [&hellip;]
</p>
</blockquote>
</li>

<li><p>Before 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> insert a new sub-clause as indicated:</p>

<blockquote>
<p>
<ins><b>20.20.? Error reporting [format.err.report]</b></ins>
<p/>
<ins>-?- Formatting functions throw <tt>format_error</tt> if an argument <tt>fmt</tt> is passed 
that is not a format string for <tt>args</tt>. They propagate exceptions thrown by operations of
<tt>formatter</tt> specializations and iterators. Failure to allocate storage is 
reported by throwing an exception as described in 16.5.5.13 <a href="https://timsong-cpp.github.io/cppwp/res.on.exception.handling">[res.on.exception.handling]</a>.</ins>
</p>
</blockquote>
</li>

<li><p>Modify 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> as indicated:</p>

<blockquote>
<pre>
string vformat(string_view fmt, format_args args);
wstring vformat(wstring_view fmt, wformat_args args);
string vformat(const locale&amp; loc, string_view fmt, format_args args);
wstring vformat(const locale&amp; loc, wstring_view fmt, wformat_args args);
</pre>
<blockquote>
<p>
-6- [&hellip;]
<p/>
-7- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Out&gt;
  Out vformat_to(Out out, string_view fmt, format_args_t&lt;Out, char&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, wstring_view fmt, format_args_t&lt;Out, wchar_t&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, const locale&amp; loc, string_view fmt,
                 format_args_t&lt;Out, char&gt; args);
template&lt;class Out&gt;
  Out vformat_to(Out out, const locale&amp; loc, wstring_view fmt,
                 format_args_t&lt;Out, wchar_t&gt; args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-15- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      string_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      wstring_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      const locale&amp; loc, string_view fmt,
                                      const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  format_to_n_result&lt;Out&gt; format_to_n(Out out, iter_difference_t&lt;Out&gt; n,
                                      const locale&amp; loc, wstring_view fmt,
                                      const Args&amp;... args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-21- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;class... Args&gt;
  size_t formatted_size(string_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(wstring_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(const locale&amp; loc, string_view fmt, const Args&amp;... args);
template&lt;class... Args&gt;
  size_t formatted_size(const locale&amp; loc, wstring_view fmt, const Args&amp;... args);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-25- <i>Throws:</i> <del><tt>format_error</tt> if <tt>fmt</tt> is not a format string</del><ins>As specified in  [format.err.report]</ins>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3341" href="3341">3341.</a> <tt>basic_regex</tt> range constructor: Missing requirements for iterator types</h3>
<p><b>Section:</b> 30.8.1 <a href="https://timsong-cpp.github.io/cppwp/re.regex.construct">[re.regex.construct]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> &Dcy;&iecy;&ncy;&icy;&scy; &Zcy;&acy;&khcy;&acy;&rcy;&ocy;&vcy; <b>Opened:</b> 2019-11-17 <b>Last modified:</b> 2019-11-30 13:47:36 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#re.regex.construct">issues</a> in [re.regex.construct].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This is description of a <tt>basic_regex</tt> range constructor from <a href="https://wg21.link/n4835">N4835</a>,
30.8.1 <a href="https://timsong-cpp.github.io/cppwp/re.regex.construct">[re.regex.construct]</a>:
</p>
<blockquote>
<pre>
template&lt;class ForwardIterator&gt;
  basic_regex(ForwardIterator first, ForwardIterator last,
              flag_type f = regex_constants::ECMAScript);
</pre>
<blockquote>
<p>
-17- <i>Throws:</i> <tt>regex_error</tt> if the sequence <tt>[first, last)</tt> is not a valid regular expression.
<p/>
-18- <i>Effects:</i> Constructs an object of class <tt>basic_regex</tt>; the object's internal finite state 
machine is constructed from the regular expression contained in the sequence of characters <tt>[first, last)</tt>, 
and interpreted according to the flags specified in <tt>f</tt>.
<p/>
-19- <i>Ensures:</i> <tt>flags()</tt> returns <tt>f. mark_count()</tt> returns the number of marked sub-expressions 
within the expression.
</p>
</blockquote>
</blockquote>
<p>
It seems that there are no requirements about dereferenced iterator's element type, that, apparently, 
must be implicitly convertible to the <tt>basic_regex::value_type</tt>. For example, containers having 
range constructor satisfy a SequenceContainer requirements, where implicit converting to its elements 
is specified.
</p>

<p><i>[2019-11-30 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3342" href="3342">3342.</a> Library wording uses "initializes <tt>x</tt> with <tt>y</tt>", which is underspecified</h3>
<p><b>Section:</b> 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a>, 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a>, 20.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/variant.ctor">[variant.ctor]</a>, 31.8.6.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.atomic.shared">[util.smartptr.atomic.shared]</a>, 20.13.3 <a href="https://timsong-cpp.github.io/cppwp/allocator.adaptor.cnstr">[allocator.adaptor.cnstr]</a>, 20.20.4.3 <a href="https://timsong-cpp.github.io/cppwp/format.parse.ctx">[format.parse.ctx]</a>, 20.20.5.1 <a href="https://timsong-cpp.github.io/cppwp/format.arg">[format.arg]</a>, 22.6 <a href="https://timsong-cpp.github.io/cppwp/container.adaptors">[container.adaptors]</a>, 23.5 <a href="https://timsong-cpp.github.io/cppwp/predef.iterators">[predef.iterators]</a>, 24.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.subrange.ctor">[range.subrange.ctor]</a>, 24.6 <a href="https://timsong-cpp.github.io/cppwp/range.factories">[range.factories]</a>, 24.7 <a href="https://timsong-cpp.github.io/cppwp/range.adaptors">[range.adaptors]</a>, 25.9 <a href="https://timsong-cpp.github.io/cppwp/numeric.ops">[numeric.ops]</a>, 27.9 <a href="https://timsong-cpp.github.io/cppwp/time.hms">[time.hms]</a>, 30.12 <a href="https://timsong-cpp.github.io/cppwp/re.iter">[re.iter]</a>, 31.8 <a href="https://timsong-cpp.github.io/cppwp/atomics.types.generic">[atomics.types.generic]</a>, 31.9 <a href="https://timsong-cpp.github.io/cppwp/atomics.nonmembers">[atomics.nonmembers]</a>, 32.3 <a href="https://timsong-cpp.github.io/cppwp/thread.stoptoken">[thread.stoptoken]</a>, 32.4 <a href="https://timsong-cpp.github.io/cppwp/thread.threads">[thread.threads]</a>, 32.5 <a href="https://timsong-cpp.github.io/cppwp/thread.mutex">[thread.mutex]</a>, 32.7 <a href="https://timsong-cpp.github.io/cppwp/thread.sema">[thread.sema]</a>, 32.8 <a href="https://timsong-cpp.github.io/cppwp/thread.coord">[thread.coord]</a>, 32.9 <a href="https://timsong-cpp.github.io/cppwp/futures">[futures]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-11-21 <b>Last modified:</b> 2019-12-08 18:50:22 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#pairs.pair">active issues</a> in [pairs.pair].</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs.pair">issues</a> in [pairs.pair].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The problem was discussed <a href="https://github.com/cplusplus/draft/pull/3454#discussion_r348198610">here</a>:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
<p>
It seems to me that this is just one instance of a systemic problem in the library wording. This phrasing 
"initializes <tt>x</tt> with <tt>y</tt>" is common, but underspecified (and formally meaningless) &mdash; 
the library wording either needs to say what kind of initialization is performed, or specify an initializer 
(not an expression) with which to initialize. We should ask LWG to think about this; for each "initializes 
<tt>x</tt> with <tt>y</tt>" utterance, the reader should know what kind of initialization we mean.
<p/>
Looking at random through the library wording, the first case I found: 22.6.4.2 <a href="https://timsong-cpp.github.io/cppwp/queue.cons">[queue.cons]</a>/1:
</p>
<blockquote><p>
<i>Effects:</i> Initializes <tt>c</tt> with <tt>cont</tt>.
</p></blockquote>
<p>
The meaning of this depends on whether this is direct- or copy-initialization. (It's obscure, but if <tt>T</tt> 
is not <i>Cpp17CopyInsertable</i> into the container, it could be the case that one form of initialization 
works and the other does not, or that they both work and do different things.)
<p/>
Another random sample: 25.9.6 <a href="https://timsong-cpp.github.io/cppwp/partial.sum">[partial.sum]</a>/2:
</p>
<blockquote><p>
<i>Effects:</i> For a non-empty range, the function creates an accumulator <tt>acc</tt> whose type is 
<tt>InputIterator</tt>'s value type, initializes it with <tt>*first</tt>, and assigns the result to <tt>*result</tt>.
</p></blockquote>
<p>
Again the difference between direct- and copy-initialization is observable here.
<p/>
Perhaps the library should have blanket wording that when it says "initializes", it means by 
direct- or copy-initialization, and that it's unspecified which one you get (or something like that) &mdash; 
and someone should go through all the instances and check if any of them mean something else (I doubt this 
is the only case that does).
</p>
</blockquote>
<p>
Suggestion: either
</p>
<ul>
<li><p>add blanket wording defining what you mean when you say "initializes <tt>x</tt> with <tt>y</tt>" 
(e.g., it's unspecified whether copy-initialization or direct-initialization is performed) and make sure 
that that's what's intended for all uses, or</p></li>
<li><p>stop using the "initializes <tt>x</tt> with <tt>y</tt>" formulation entirely, and specify the kind 
of initialization on each use, or</p></li>
<li><p>for each such use, ensure that <tt>y</tt> is an initializer (that is, of the form "<tt>= expr</tt>" 
or "<tt>(expr, expr, &hellip;)</tt>" or "<tt>= { &hellip; }</tt>" or "<tt>{ &hellip; }</tt>", and not 
merely an expression)</p></li>
</ul>

<p><i>[2019-12-08 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>




<hr>
<h3><a name="3343" href="3343">3343.</a> Ordering of calls to <tt>unlock()</tt> and <tt>notify_all()</tt> in <i>Effects</i> element of <tt>notify_all_at_thread_exit()</tt> should be reversed</h3>
<p><b>Section:</b> 32.6.2 <a href="https://timsong-cpp.github.io/cppwp/thread.condition.nonmember">[thread.condition.nonmember]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Lewis Baker <b>Opened:</b> 2019-11-21 <b>Last modified:</b> 2019-12-15 14:27:56 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
32.6.2 <a href="https://timsong-cpp.github.io/cppwp/thread.condition.nonmember">[thread.condition.nonmember]</a> p2 states:
</p>
<blockquote>
<p>
<i>Effects:</i> Transfers ownership of the lock associated with <tt>lk</tt> into internal storage 
and schedules <tt>cond</tt> to be notified when the current thread exits, after all objects of 
thread storage duration associated with the current thread have been destroyed. This notification 
shall be as if:
</p>
<blockquote><pre>
lk.unlock();
cond.notify_all();
</pre></blockquote>
</blockquote>
<p>
One common use-cases for the <tt>notify_all_at_thread_exit()</tt> is in conjunction with
<tt>thread::detach()</tt> to allow detached threads to signal when they complete and to allow 
another thread to wait for them to complete using the <tt>condition_variable/mutex</tt> pair.
<p/>
However, the current wording for <tt>notify_all_at_thread_exit(condition_variable&amp; cond, 
unique_lock&lt;mutex&gt; lk)</tt> makes it impossible to know when it is safe to destroy the 
<tt>condition_variable</tt> in the presence of spurious wake-ups and detached threads.
<p/>
For example: Consider the following code-snippet:
</p>
<blockquote><pre>
#include &lt;condition_variable&gt;
#include &lt;mutex&gt;
#include &lt;thread&gt;

int main() {
  std::condition_variable cv;
  std::mutex mut;
  bool complete = false;

  std::thread{[&amp;] {
    <i>// do work here</i>

    <i>// Signal thread completion</i>
    std::unique_lock lk{mut};
    complete = true;
    std::notify_all_at_thread_exit(cv, std::move(lk));
  }}.detach();

  <i>// Wait until thread completes</i>
  std::unique_lock lk{mut};
  cv.wait(lk, [&amp;] { return complete; });

  <i>// condition_variable destroyed on scope exit</i>
  return 0;
}
</pre></blockquote>
<p>
This seems to an intended usage of <tt>thread::detach()</tt> and <tt>std::notify_all_at_thread_exit()</tt> 
and yet this code contains a race involving the call to <tt>cv.notify_all()</tt> on the created thread, 
and the destructor of the <tt>condition_variable</tt>.
<p/>
To highlight the issue, consider the following case:
<p/>
Let <tt>T0</tt> be the thread that executes <tt>main()</tt> and <tt>T1</tt> be the thread created 
by the <tt>std::thread</tt> construction.
</p> 
<blockquote>
<p>
<tt>T0</tt>: creates thread <tt>T1</tt><br/>
<tt>T0</tt>: context-switched out by OS<br/>
<tt>T1</tt>: starts running<br/>
<p/>
<tt>T1</tt>: acquires mutex lock<br/>
<tt>T1</tt>: sets <tt>complete = true</tt><br/>
<p/>
<tt>T1</tt>: calls <tt>notify_all_at_thread_exit()</tt><br/>
<tt>T1</tt>: returns from thread-main function and runs all thread-local destructors<br/>
<tt>T1</tt>: calls <tt>lk.unlock()</tt><br/>
<tt>T1</tt>: context-switched out by OS<br/>
<tt>T0</tt>: resumes execution<br/>
<tt>T0</tt>: acquires mutex lock<br/>
<tt>T0</tt>: calls <tt>cv.wait()</tt> which returns immediately as <tt>complete</tt> is <tt>true</tt><br/>
<p/>
<tt>T0</tt>: returns from <tt>main()</tt>, destroying <tt>condition_variable</tt><br/>
<tt>T1</tt>: resumes execution<br/>
<p/>
<tt>T1</tt>: calls <tt>cv.notify_all()</tt> on a dangling <tt>cv</tt> reference (undefined behaviour)<br/>
</p>
</blockquote>
<p>
Other sequencings are possible involving spurious wake-ups of the <tt>cv.wait()</tt> call.
<p/>
A proof-of-concept showing this issue can be found <a href="https://wandbox.org/permlink/eUu3eiQbLl7JQKMm">here</a>.
<p/>
The current wording requires releasing the mutex lock before calling <tt>cv.notify_all()</tt>. In the 
presence of spurious wake-ups of a <tt>condition_variable::wait()</tt>, there is no way to know whether 
or not a detached thread that called <tt>std::notify_all_at_thread_exit()</tt> has finished calling 
<tt>cv.notify_all()</tt>. This means there is no portable way to know when it will be safe for the 
waiting thread to destroy that <tt>condition_variable</tt>.
<p/>
However, if we were to reverse the order of the calls to <tt>lk.unlock()</tt> and <tt>cond.notify_all()</tt> 
then the thread waiting for the detached thread to exit would not be able to observe the completion of the 
thread (in the above case, this would be observing the assignment of <tt>true</tt> to the <tt>complete</tt> 
variable) until the mutex lock was released by that thread and subsequently acquired by the waiting thread 
which would only happen after the completion of the call to <tt>cv.notify_all()</tt>. This would allow the 
above code example to eliminate the race between a subsequent destruction of the condition-variable and 
the call to <tt>cv.notify_all()</tt>.
</p>

<p><i>[2019-12-08 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>

<p><i>[2019-12-15; Daniel synchronizes wording with <a href="https://wg21.link/n4842">N4842</a>]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Change 32.6.2 <a href="https://timsong-cpp.github.io/cppwp/thread.condition.nonmember">[thread.condition.nonmember]</a> as indicated:</p>

<blockquote>
<pre>
void notify_all_at_thread_exit(condition_variable&amp; cond, unique_lock&lt;mutex&gt; lk);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-2- <i>Effects:</i> Transfers ownership of the lock associated with <tt>lk</tt> into internal 
storage and schedules <tt>cond</tt> to be notified when the current thread exits, after all 
objects of thread storage duration associated with the current thread have been destroyed. 
This notification is equivalent to:
</p>
<blockquote><pre>
<del>lk.unlock();</del>
cond.notify_all();
<ins>lk.unlock();</ins>
</pre></blockquote>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3344" href="3344">3344.</a> <tt>advance(i, <i>most-negative</i>)</tt> and <tt>prev(i, <i>most-negative</i>)</tt></h3>
<p><b>Section:</b> 23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a>, 23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-11-22 <b>Last modified:</b> 2019-12-07 13:45:41 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.operations">active issues</a> in [iterator.operations].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.operations">issues</a> in [iterator.operations].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>ranges::advance</tt> (23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a>) and <tt>std::advance</tt> 
(23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a>) can be called with a negative count <tt>n</tt> when the 
iterator argument <tt>i</tt> models <tt>bidirectional_iterator</tt> (respectively, meets the 
<i>Cpp17BidirectionalIterator</i> requirements). In this case, they are specified to "decrement <tt>i</tt> 
by <tt>-n</tt>". If <tt>n</tt> is the most-negative value of a signed integral type, the expression <tt>-n</tt> 
has undefined behavior. This UB is unfortunate given that typical implementations never actually 
form the expression <tt>-n</tt>. It's nonsensical to describe the effects of a function in terms 
of an expression with undefined behavior, so we should either define the behavior or exclude 
this case via precondition.
<p/>
<tt>ranges::prev()</tt> and <tt>std::prev</tt> (23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a>) have a similar problem: 
<tt>prev(i, n)</tt> is equivalent to:
</p>
<blockquote><pre>
advance(i, -n); 
return i;
</pre></blockquote>
<p>
which has undefined behavior when <tt>n</tt> is <tt>numeric_limits&lt;T&gt;::min()</tt> where <tt>T</tt> 
is <tt>iter_difference_t&lt;decltype(i)&gt;</tt> (for <tt>ranges::prev</tt>) or some signed integral type 
(for <tt>std::prev</tt>). There <em>is</em> an implicit precondition here thanks to "<i>Effects:</i> Equivalent 
to" since the equivalent code has a precondition that <tt>n</tt> is not a most-negative value, so 
this wording is not defective. We could, however, define behavior for <tt>prev</tt> regardless of the 
value of <tt>n</tt> by duplicating the specification of advance and inverting the "direction" of the 
operations. We should consider doing so.
</p>

<p><i>[2019-12-07 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> I've chosen to provide wording for the conservative "define behavior for 
<tt>advance</tt> and leave <tt>prev</tt> as status quo" middle ground.
<p/>
The occurrences of "|" in the below are math-font vertical bars (indicating absolute value). I've 
changed both positive and negative cases for consistency of presentation.
]
</p>
</blockquote>

<ol>
<li><p>Modify 23.4.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.operations">[iterator.operations]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class InputIterator, class Distance&gt;
  constexpr void advance(InputIterator&amp; i, Distance n);
</pre>
<blockquote>
<p>
-2- <i>Expects:</i> <tt>n</tt> is negative only for bidirectional iterators.
<p/>
-3- <i>Effects:</i> Increments <tt>i</tt> by <tt><ins>|</ins>n<ins>|</ins></tt> if <tt>n</tt> is 
non-negative, and decrements <tt>i</tt> by <tt><del>-</del><ins>|</ins>n<ins>|</ins></tt> otherwise.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;input_or_output_iterator I&gt;
  constexpr void ranges::advance(I&amp; i, iter_difference_t&lt;I&gt; n);
</pre>
<blockquote>
<p>
-1- <i>Expects:</i> If <tt>I</tt> does not model <tt>bidirectional_iterator</tt>, <tt>n</tt> is not negative.
<p/>
-2- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; If <tt>I</tt> models <tt>random_access_iterator</tt>, 
equivalent to <tt>i += n</tt>.</p></li>
<li><p>(2.2) &mdash; Otherwise, if <tt>n</tt> is non-negative, increments <tt>i</tt> by 
<tt><ins>|</ins>n<ins>|</ins></tt>.</p></li>
<li><p>(2.3) &mdash; Otherwise, decrements <tt>i</tt> by <tt><del>-</del><ins>|</ins>n<ins>|</ins></tt>.</p></li>
</ol>
</p>
</blockquote>
[&hellip;]
<pre>
template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  constexpr iter_difference_t&lt;I&gt; ranges::advance(I&amp; i, iter_difference_t&lt;I&gt; n, S bound);
</pre>
<blockquote>
<p>
-5- <i>Expects:</i> [&hellip;]
<p/>
-6- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(6.1) &mdash; If <tt>S</tt> and <tt>I</tt> model 
<tt>sized_sentinel_for&lt;S, I&gt;</tt>:</p>
<ol style="list-style-type: none">
<li><p>(6.1.1) &mdash; If <tt>|n| &ge; |bound - i|</tt>, equivalent to <tt>ranges::advance(i, bound)</tt>.:</p>
</li>
<li><p>(6.1.2) &mdash; Otherwise, equivalent to <tt>ranges::advance(i, n)</tt>.</p></li>
</ol>
</li>
<li><p>(6.2) &mdash; Otherwise,</p>
<ol style="list-style-type: none">
<li><p>(6.2.1) &mdash; if <tt>n</tt> is non-negative, while <tt>bool(i != bound)</tt> is <tt>true</tt>, 
increments <tt>i</tt> but at most <tt><ins>|</ins>n<ins>|</ins></tt> times.:</p>
</li>
<li><p>(6.2.2) &mdash; Otherwise, while <tt>bool(i != bound)</tt> is <tt>true</tt>, decrements <tt>i</tt> 
but at most <tt><del>-</del><ins>|</ins>n<ins>|</ins></tt> times.</p></li>
</ol>
</li>
</ol>
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3345" href="3345">3345.</a> Incorrect usages of "models" versus "satisfies"</h3>
<p><b>Section:</b> 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a>, 23.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.swap">[iterator.cust.swap]</a>, 23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a>, 23.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.distance">[range.iter.op.distance]</a>, 23.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/reverse.iterator">[reverse.iterator]</a>, 23.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/move.iterator">[move.iterator]</a>, 23.5.3.6 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nav">[move.iter.nav]</a>, 23.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/common.iter.types">[common.iter.types]</a>, 23.5.4.5 <a href="https://timsong-cpp.github.io/cppwp/common.iter.nav">[common.iter.nav]</a>, 24.3 <a href="https://timsong-cpp.github.io/cppwp/range.access">[range.access]</a>, 24.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/range.iota.iterator">[range.iota.iterator]</a>, 24.7 <a href="https://timsong-cpp.github.io/cppwp/range.adaptors">[range.adaptors]</a>, 25 <a href="https://timsong-cpp.github.io/cppwp/algorithms">[algorithms]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2019-11-23 <b>Last modified:</b> 2020-02-10 20:51:00 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#concept.swappable">active issues</a> in [concept.swappable].</p>
<p><b>View all other</b> <a href="lwg-index.html#concept.swappable">issues</a> in [concept.swappable].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current working draft uses at several places within normative wording the term "models" instead
of "satisfies" even though it is clear from the context that these are conditions to be tested by
the implementation. Since "models" includes both syntactic requirements as well as semantic requirements, 
such wording would require (at least in general) heroic efforts for an implementation. Just to name a 
few examples for such misusage:
</p>
<ul>
<li><p>The specification of the customization objects in 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a>,
23.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.swap">[iterator.cust.swap]</a>, 24.3 <a href="https://timsong-cpp.github.io/cppwp/range.access">[range.access]</a></p></li>
<li><p>The algorithmic decision logic for the effects of the functions specified in 
23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a>, 23.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.distance">[range.iter.op.distance]</a></p></li>
</ul>
<p>
The correct way to fix these presumably unintended extra requirements is to use the term 
"satisfies" at the places where it is clear that an implementation has to test them.
<p/>
Note: There exists similar misusage in regard to wording for types that "meet <i>Cpp17XX</i> 
requirements, but those are not meant to be covered as part of this issue. This additional wording 
problem should be handled by a separate issue.
</p>

<p><i>[2019-12-08 Issue Prioritization]</i></p>

<p>Priority to 2 after reflector discussion.</p>

<p><i>[2019-12-15; Daniel synchronizes wording with <a href="https://wg21.link/n4842">N4842</a>]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The proposed wording does intentionally not touch the definition of 
<tt>enable_view</tt>, whose definition is radically changed by LWG <a href="3326">3326</a> in a manner
that does no longer need similar adjustments.]
</p>
</blockquote>
<ol>
<li><p>Modify 18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a> as indicated:</p>

<blockquote>
<p>
-2- The name <tt>ranges::swap</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
The expression <tt>ranges::swap(E1, E2)</tt> for some subexpressions <tt>E1</tt> and <tt>E2</tt> is 
expression-equivalent to an expression <tt>S</tt> determined as follows:
</p>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; [&hellip;]</p></li>
<li><p>(2.2) &mdash; [&hellip;]</p></li>
<li><p>(2.3) &mdash; Otherwise, if <tt>E1</tt> and <tt>E2</tt> are lvalues of the same type <tt>T</tt> that 
<del>models</del><ins>satisfies</ins> <tt>move_constructible&lt;T&gt;</tt> and <tt>assignable_from&lt;T&amp;, 
T&gt;</tt>, <tt>S</tt> is an expression that exchanges the denoted values. <tt>S</tt> is a constant expression 
if [&hellip;]</p></li>
<li><p>(2.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 23.3.3.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.cust.swap">[iterator.cust.swap]</a> as indicated:</p>

<blockquote>
<p>
-4- The expression <tt>ranges::iter_swap(E1, E2)</tt> for some subexpressions <tt>E1</tt> and <tt>E2</tt> 
is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(4.1) &mdash; [&hellip;]</p></li>
<li><p>(4.2) &mdash; Otherwise, if the types of <tt>E1</tt> and <tt>E2</tt> each <del>model</del><ins>satisfy</ins> 
<tt>indirectly_readable</tt>, and if the reference types of <tt>E1</tt> and <tt>E2</tt> <del>model</del><ins>satisfy</ins> 
<tt>swappable_with</tt> (18.4.9 <a href="https://timsong-cpp.github.io/cppwp/concept.swappable">[concept.swappable]</a>), then <tt>ranges::swap(*E1, *E2)</tt>.</p></li>
<li><p>(4.3) &mdash; Otherwise, if the types <tt>T1</tt> and <tt>T2</tt> of <tt>E1</tt> and <tt>E2</tt> 
<del>model</del><ins>satisfy</ins> <tt>indirectly_movable_storable&lt;T1, T2&gt;</tt> and 
<tt>indirectly_movable_storable&lt;T2, T1&gt;</tt>, then <tt>(void)(*E1 = <i>iter-exchange-move</i>(E2, E1))</tt>,
except that <tt>E1</tt> is evaluated only once.</p></li>
<li><p>(4.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 23.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.iter.ops">[range.iter.ops]</a> as indicated:</p>

<blockquote>
<p>
-1- The library includes the function templates <tt>ranges::advance</tt>, <tt>ranges::distance</tt>, 
<tt>ranges::next</tt>, and <tt>ranges::prev</tt> to manipulate iterators. These operations adapt to the 
set of operators provided by each iterator category to provide the most efficient implementation possible 
for a concrete iterator type. [<i>Example:</i> <tt>ranges::advance</tt> uses the <tt>+</tt> operator 
to move a <tt>random_access_iterator</tt> forward <tt>n</tt> steps in constant time. For an iterator type 
that does not <del>model</del><ins>satisfy</ins> <tt>random_access_iterator</tt>, <tt>ranges::advance</tt> 
instead performs <tt>n</tt> individual increments with the <tt>++</tt> operator. &mdash; <i>end example</i>]
</p>
</blockquote>
</li>

<li><p>Modify 23.4.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.advance">[range.iter.op.advance]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;input_or_output_iterator I&gt;
  constexpr void ranges::advance(I&amp; i, iter_difference_t&lt;I&gt; n);
</pre>
<blockquote>
<p>
-1- <i>Preconditions:</i> [&hellip;]
<p/>
-2- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; If <tt>I</tt> <del>models</del><ins>satisfies</ins> <tt>random_access_iterator</tt>, 
equivalent to <tt>i += n</tt>.</p></li>
<li><p>(2.2) &mdash; [&hellip;]</p></li>
<li><p>(2.3) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
<pre>
template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  constexpr void ranges::advance(I&amp; i, S bound);
</pre>
<blockquote>
<p>
-3- <i>Preconditions:</i> [&hellip;]
<p/>
-4- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(4.1) &mdash; If <tt>I</tt> and <tt>S</tt> <del>model</del><ins>satisfy</ins> <tt>assignable_from&lt;I&amp;, 
S&gt;</tt>, equivalent to <tt>i = std::move(bound)</tt>.</p></li>
<li><p>(4.2) &mdash; Otherwise, if <tt>S</tt> and <tt>I</tt> <del>model</del><ins>satisfy</ins> 
<tt>sized_sentinel_for&lt;S, I&gt;</tt>, equivalent to <tt>ranges::advance(i, bound - i)</tt>.</p></li>
<li><p>(4.3) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
<pre>
template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  constexpr iter_difference_t&lt;I&gt; ranges::advance(I&amp; i, iter_difference_t&lt;I&gt; n, S bound);
</pre>
<blockquote>
<p>
-5- <i>Preconditions:</i> [&hellip;]
<p/>
-6- <i>Effects:</i>
<ol style="list-style-type: none">
<li><p>(6.1) &mdash; If <tt>S</tt> and <tt>I</tt> <del>model</del><ins>satisfy</ins> 
<tt>sized_sentinel_for&lt;S, I&gt;</tt>: [&hellip;]</p></li>
<li><p>(6.2) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 23.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.distance">[range.iter.op.distance]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  constexpr iter_difference_t&lt;I&gt; ranges::distance(I first, S last);
</pre>
<blockquote>
<p>
-1- <i>Preconditions:</i> [&hellip;]
<p/>
-2- <i>Effects:</i> If <tt>S</tt> and <tt>I</tt> <del>model</del><ins>satisfy</ins> <tt>sized_sentinel_for&lt;S, 
I&gt;</tt>, returns <tt>(last - first)</tt>; otherwise, returns the number of increments needed to get from 
<tt>first</tt> to <tt>last</tt>.
</p>
</blockquote>
<pre>
template&lt;range R&gt;
  range_difference_t&lt;R&gt; ranges::distance(R&amp;&amp; r);
</pre>
<blockquote>
<p>
-3- <i>Effects:</i> If <tt>R</tt> <del>models</del><ins>satisfies</ins> <tt>sized_range</tt>, equivalent to:
</p>
<blockquote><pre>
return static_cast&lt;range_difference_t&lt;R&gt;&gt;(ranges::size(r)); <i>// 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a></i>
</pre></blockquote>
<p>
Otherwise, equivalent to:
</p>
<blockquote><pre>
return ranges::distance(ranges::begin(r), ranges::end(r)); <i>// 24.3 <a href="https://timsong-cpp.github.io/cppwp/range.access">[range.access]</a></i>
</pre></blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Modify 23.5.1.1 <a href="https://timsong-cpp.github.io/cppwp/reverse.iterator">[reverse.iterator]</a> as indicated:</p>

<blockquote>
<p>
-1- The member <i>typedef-name</i> <tt>iterator_concept</tt> denotes
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>random_access_iterator_tag</tt> if <tt>Iterator</tt> <del>models</del><ins>satisfies</ins>
<tt>random_access_iterator</tt>, and</p></li>
<li><p>(1.2) &mdash; <tt>bidirectional_iterator_tag</tt> otherwise.</p></li>
</ol>
<p/>
-2-  The member <i>typedef-name</i> <tt>iterator_category</tt> denotes
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; <tt>random_access_iterator_tag</tt> if the type 
<tt>iterator_traits&lt;Iterator&gt;::iterator_category</tt> <del>models</del><ins>satisfies</ins> 
<tt>derived_from&lt;random_access_iterator_tag&gt;</tt>, and</p></li>
<li><p>(2.2) &mdash; <tt>iterator_traits&lt;Iterator&gt;::iterator_category</tt> otherwise.</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 23.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/move.iterator">[move.iterator]</a> as indicated:</p>

<blockquote>
<p>
-1- The member <i>typedef-name</i> <tt>iterator_category</tt> denotes
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>random_access_iterator_tag</tt> if the type 
<tt>iterator_traits&lt;Iterator&gt;::iterator_category</tt> <del>models</del><ins>satisfies</ins> 
<tt>derived_from&lt;random_access_iterator_tag&gt;</tt>, and</p></li>
<li><p>(1.2) &mdash; <tt>iterator_traits&lt;Iterator&gt;::iterator_category</tt> otherwise.</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 23.5.3.6 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nav">[move.iter.nav]</a> as indicated:</p>

<blockquote>
<pre>
constexpr auto operator++(int);
</pre>
<blockquote>
<p>
-3- <i>Effects:</i> <tt>Iterator</tt> <del>models</del><ins>satisfies</ins> <tt>forward_iterator</tt>, 
equivalent to:
</p>
<blockquote><pre>
move_iterator tmp = *this;
++current;
return tmp;
</pre></blockquote>
<p>
Otherwise, equivalent to <tt>++current</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 23.5.4.2 <a href="https://timsong-cpp.github.io/cppwp/common.iter.types">[common.iter.types]</a> as indicated:</p>

<blockquote>
<p>
-1- The nested <i>typedef-name</i>s of the specialization of <tt>iterator_traits</tt> for 
<tt>common_iterator&lt;I, S&gt;</tt> are defined as follows.
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>iterator_concept</tt> denotes <tt>forward_iterator_tag</tt> if <tt>I</tt> 
<del>models</del><ins>satisfies</ins> <tt>forward_iterator</tt>; otherwise it denotes <tt>input_iterator_tag</tt>.</p></li>
<li><p>(1.2) &mdash; <tt>iterator_category</tt> denotes <tt>forward_iterator_tag</tt> if 
<tt>iterator_traits&lt;I&gt;::iterator_category</tt> <del>models</del><ins>satisfies</ins> 
<tt>derived_from&lt;forward_iterator_tag&gt;</tt>; otherwise it denotes <tt>input_iterator_tag</tt>.</p></li>
<li><p>(1.3) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 23.5.4.5 <a href="https://timsong-cpp.github.io/cppwp/common.iter.nav">[common.iter.nav]</a> as indicated:</p>

<blockquote>
<pre>
decltype(auto) operator++(int);
</pre>
<blockquote>
<p>
-4- <i>Preconditions:</i> [&hellip;]
<p/>
-5- <i>Effects:</i> If <tt>I</tt> <del>models</del><ins>satisfies</ins> <tt>forward_iterator</tt>, equivalent to:
</p>
<blockquote><pre>
common_iterator tmp = *this;
++*this;
return tmp;
</pre></blockquote>
<p>
Otherwise, equivalent to <tt>return get&lt;I&gt;(v_)++;</tt>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.3.1 <a href="https://timsong-cpp.github.io/cppwp/range.access.begin">[range.access.begin]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>ranges::begin</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
Given a subexpression <tt>E</tt> and an lvalue <tt>t</tt> that denotes the same object as <tt>E</tt>, if <tt>E</tt> 
is an rvalue and <tt>enable_safe_range&lt;remove_cvref_t&lt;decltype((E))&gt;&gt;</tt> is <tt>false</tt>, 
<tt>ranges::begin(E)</tt> is ill-formed. Otherwise, <tt>ranges::begin(E)</tt> is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; [&hellip;]</p></li>
<li><p>(1.2) &mdash; Otherwise, <tt><i>decay-copy</i>(t.begin())</tt> if it is a 
valid expression and its type <tt>I</tt> <del>models</del><ins>satisfies</ins> <tt>input_or_output_iterator</tt>.</p></li>
<li><p>(1.3) &mdash; Otherwise, <tt><i>decay-copy</i>(begin(t))</tt> if it is a valid expression and its 
type <tt>I</tt> <del>models</del><ins>satisfies</ins> <tt>input_or_output_iterator</tt> with overload resolution 
performed in a context that includes the declarations:</p>
<blockquote><pre>
template&lt;class T&gt; void begin(T&amp;&amp;) = delete;
template&lt;class T&gt; void begin(initializer_list&lt;T&gt;&amp;&amp;) = delete;
</pre></blockquote>
<p>
and does not include a declaration of <tt>ranges::begin</tt>.
</p>
</li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.access.end">[range.access.end]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>ranges::end</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
Given a subexpression <tt>E</tt> and an lvalue <tt>t</tt> that denotes the same object as <tt>E</tt>, if <tt>E</tt> 
is an rvalue and <tt>enable_safe_range&lt;remove_cvref_t&lt;decltype((E))&gt;&gt;</tt> is <tt>false</tt>, 
<tt>ranges::end(E)</tt> is ill-formed. Otherwise, <tt>ranges::end(E)</tt> is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; [&hellip;]</p></li>
<li><p>(1.2) &mdash; Otherwise, <tt><i>decay-copy</i>(t.end())</tt> if it is a valid expression and its type 
<tt>S</tt> <del>models</del><ins>satisfies</ins> <tt>sentinel_for&lt;decltype(ranges::begin(E))&gt;</tt>.</p></li>
<li><p>(1.3) &mdash; Otherwise, <tt><i>decay-copy</i>(end(t))</tt> if it is a valid expression and its 
type <tt>S</tt> <del>models</del><ins>satisfies</ins> <tt>sentinel_for&lt;decltype(ranges::begin(E))&gt;</tt> 
with overload resolution performed in a context that includes the declarations:
<blockquote><pre>
template&lt;class T&gt; void end(T&amp;&amp;) = delete;
template&lt;class T&gt; void end(initializer_list&lt;T&gt;&amp;&amp;) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::end</tt>.</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.3.5 <a href="https://timsong-cpp.github.io/cppwp/range.access.rbegin">[range.access.rbegin]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>ranges::rbegin</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
Given a subexpression <tt>E</tt> and an lvalue <tt>t</tt> that denotes the same object as <tt>E</tt>, if <tt>E</tt> 
is an rvalue and <tt>enable_safe_range&lt;remove_cvref_t&lt;decltype((E))&gt;&gt;</tt> is <tt>false</tt>, 
<tt>ranges::rbegin(E)</tt> is ill-formed. Otherwise, <tt>ranges::rbegin(E)</tt> is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt><i>decay-copy</i>(t.rbegin())</tt> if it is a valid expression and its type 
<tt>I</tt> <del>models</del><ins>satisfies</ins> <tt>input_or_output_iterator</tt>.</p></li>
<li><p>(1.2) &mdash; Otherwise, <tt><i>decay-copy</i>(rbegin(t))</tt> if it is a valid expression and its 
type <tt>I</tt> <del>models</del><ins>satisfies</ins> <tt>input_or_output_iterator</tt> with overload resolution 
performed in a context that includes the declaration:
<blockquote><pre>
template&lt;class T&gt; void rbegin(T&amp;&amp;) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::rbegin</tt>.</p></li>
<li><p>(1.3) &mdash; Otherwise, <tt>make_reverse_iterator(ranges::end(t))</tt> if both 
<tt>ranges::begin(t)</tt> and <tt>ranges::end(t)</tt> are valid expressions of the same type <tt>I</tt> 
which <del>models</del><ins>satisfies</ins> <tt>bidirectional_iterator</tt> (23.3.4.12 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.bidir">[iterator.concept.bidir]</a>).
</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.3.6 <a href="https://timsong-cpp.github.io/cppwp/range.access.rend">[range.access.rend]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>ranges::rend</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
Given a subexpression <tt>E</tt> and an lvalue <tt>t</tt> that denotes the same object as <tt>E</tt>, if <tt>E</tt> 
is an rvalue and <tt>enable_safe_range&lt;remove_cvref_t&lt;decltype((E))&gt;&gt;</tt> is <tt>false</tt>, 
<tt>ranges::rend(E)</tt> is ill-formed. Otherwise, <tt>ranges::rend(E)</tt> is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt><i>decay-copy</i>(t.rend())</tt> if it is a valid expression and its type <tt>S</tt> 
<del>models</del><ins>satisfies</ins> <tt>sentinel_for&lt;decltype(ranges::rbegin(E))&gt;</tt>.</p></li>
<li><p>(1.2) &mdash; Otherwise, <tt><i>decay-copy</i>(rend(t))</tt> if it is a valid expression and its 
type <tt>S</tt> <del>models</del><ins>satisfies</ins> <tt>sentinel_for&lt;decltype(ranges::rbegin(E))&gt;</tt> 
with overload resolution performed in a context that includes the declaration:
<blockquote><pre>
template&lt;class T&gt; void rend(T&amp;&amp;) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::rend</tt>.</p></li>
<li><p>(1.3) &mdash; Otherwise, <tt>make_reverse_iterator(ranges::begin(t))</tt> if both 
<tt>ranges::begin(t)</tt> and <tt>ranges::end(t)</tt> are valid expressions of the same type <tt>I</tt> 
which <del>models</del><ins>satisfies</ins> <tt>bidirectional_iterator</tt> 
(23.3.4.12 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.bidir">[iterator.concept.bidir]</a>).
</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The term "is integer-like" is very specifically defined to be related to
semantic requirements as well, and the term "satisfy integer-like" seems to be undefined.
Fortunately, 23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> also introduces the exposition-only variable
template <tt><i>is-integer-like</i></tt> which we use as predicate below to describe the syntactic 
constraints of "integer-like" alone. This wording change regarding "is integer-like" is strictly
speaking not required because of the "if and only if" definition provided in 
23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> p12, but it has been made nonetheless to improve the 
consistency between discriminating compile-time tests from potentially semantic requirements]
</p>
</blockquote>

<blockquote>
<p>
-1- The name <tt>size</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
The expression <tt>ranges::size(E)</tt> for some subexpression <tt>E</tt> with type <tt>T</tt> is 
expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; [&hellip;]</p></li>
<li><p>(1.2) &mdash; Otherwise, if <tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> 
(24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a>) is <tt>false</tt>:</p>
<ol style="list-style-type: none">
<li><p>(1.2.1) &mdash; <tt><i>decay-copy</i>(E.size())</tt> if it is a valid expression and <del>its type <tt>I</tt> 
is integer-like</del><ins><tt><i>is-integer-like</i>&lt;I&gt;</tt> is <tt>true</tt></ins> 
(23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a>).</p></li>
<li><p>(1.2.2) &mdash; Otherwise, <tt><i>decay-copy</i>(size(E))</tt> if it is a valid expression and <del>its type 
<tt>I</tt> is integer-like</del><ins><tt><i>is-integer-like</i>&lt;I&gt;</tt> is <tt>true</tt></ins> with 
overload resolution performed in a context that includes the declaration:
<blockquote><pre>
template&lt;class T&gt; void size(T&amp;&amp;) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::size</tt>.</p></li>
</ol>
</li>
<li><p>(1.3) &mdash; Otherwise, <tt><i>make-unsigned-like</i>(ranges::end(E) - ranges::begin(E))</tt> 
(24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a>) if it is a valid expression and the types <tt>I</tt> and <tt>S</tt> of 
<tt>ranges::begin(E)</tt> and <tt>ranges::end(E)</tt> (respectively) <del>model</del><ins>satisfy</ins> both
<tt>sized_sentinel_for&lt;S, I&gt;</tt> (23.3.4.8 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.sizedsentinel">[iterator.concept.sizedsentinel]</a>) and 
<tt>forward_iterator&lt;I&gt;</tt>. However, <tt>E</tt> is evaluated only once.
</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.3.10 <a href="https://timsong-cpp.github.io/cppwp/range.prim.empty">[range.prim.empty]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>empty</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
The expression <tt>ranges::empty(E)</tt> for some subexpression <tt>E</tt> is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; [&hellip;]</p></li>
<li><p>(1.2) &mdash; [&hellip;]</p></li>
<li><p>(1.3) &mdash; Otherwise, <tt>EQ</tt>, where <tt>EQ</tt> is <tt>bool(ranges::begin(E) == ranges::end(E))</tt> 
except that <tt>E</tt> is only evaluated once, if <tt>EQ</tt> is a valid expression and the type of 
<tt>ranges::begin(E)</tt> <del>models</del><ins>satisfies</ins> <tt>forward_iterator</tt>.
</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>

<li><p>Modify 24.3.11 <a href="https://timsong-cpp.github.io/cppwp/range.prim.data">[range.prim.data]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>data</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
The expression <tt>ranges::data(E)</tt> for some subexpression <tt>E</tt> is expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; [&hellip;]</p></li>
<li><p>(1.2) &mdash; Otherwise, if <tt>ranges::begin(E)</tt> is a valid expression whose type 
<del>models</del><ins>satisfies</ins> <tt>contiguous_iterator</tt>, <tt>to_address(ranges::begin(E))</tt>.</p></li>
<li><p>(1.3) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>
</li>


<li><p>Modify 24.5.4 <a href="https://timsong-cpp.github.io/cppwp/range.dangling">[range.dangling]</a> as indicated:</p>

<blockquote>
<p>
-1- The tag type <tt>dangling</tt> is used together with the template aliases <tt>safe_iterator_t</tt> 
and <tt>safe_subrange_t</tt> to indicate that an algorithm that typically returns an iterator into or 
subrange of a range argument does not return an iterator or subrange which could potentially reference 
a range whose lifetime has ended for a particular rvalue range argument which does not 
<del>model</del><ins>satisfy</ins> <tt><i>forwarding-range</i></tt> (24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a>).
</p>
[&hellip;]
<p>
-2- [<i>Example:</i>
</p>
<blockquote><pre>
vector&lt;int&gt; f();
auto result1 = ranges::find(f(), 42); <i>// #1</i>
static_assert(same_as&lt;decltype(result1), ranges::dangling&gt;);
auto vec = f();
auto result2 = ranges::find(vec, 42); <i>// #2</i>
static_assert(same_as&lt;decltype(result2), vector&lt;int&gt;::iterator&gt;);
auto result3 = ranges::find(subrange{vec}, 42); <i>// #3</i>
static_assert(same_as&lt;decltype(result3), vector&lt;int&gt;::iterator&gt;);
</pre></blockquote>
<p>
The call to <tt>ranges::find</tt> at <i>#1</i> returns <tt>ranges::dangling</tt> since <tt>f()</tt> is 
an rvalue <tt>vector</tt>; the <tt>vector</tt> could potentially be destroyed before a returned iterator 
is dereferenced. However, the calls at <i>#2</i> and <i>#3</i> both return iterators since the lvalue 
<tt>vec</tt> and specializations of subrange <del>model</del><ins>satisfy</ins> 
<tt><i>forwarding-range</i></tt>. &mdash; <i>end example</i>]
</p>
</blockquote>
</li>

<li><p>Modify 24.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/range.iota.iterator">[range.iota.iterator]</a> as indicated:</p>

<blockquote>
<p>
-1- <tt>iterator::iterator_category</tt> is defined as follows:
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; If <tt>W</tt> <del>models</del><ins>satisfies</ins> <tt><i>advanceable</i></tt>, then 
<tt>iterator_category</tt> is <tt>random_access_iterator_tag</tt>.</p></li>
<li><p>(1.2) &mdash; Otherwise, if <tt>W</tt> <del>models</del><ins>satisfies</ins> <tt><i>decrementable</i></tt>, 
then <tt>iterator_category</tt> is <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(1.3) &mdash; Otherwise, if <tt>W</tt> <del>models</del><ins>satisfies</ins> <tt>incrementable</tt>, 
then <tt>iterator_category</tt> is <tt>forward_iterator_tag</tt>.</p></li>
<li><p>(1.4) &mdash; Otherwise, <tt>iterator_category</tt> is <tt>input_iterator_tag</tt>.</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 24.7.2 <a href="https://timsong-cpp.github.io/cppwp/range.semi.wrap">[range.semi.wrap]</a> as indicated:</p>

<blockquote>
<p>
-1- Many types in this subclause are specified in terms of an exposition-only class template 
<tt><i>semiregular-box</i></tt>. <tt><i>semiregular-box</i>&lt;T&gt;</tt> behaves exactly like 
<tt>optional&lt;T&gt;</tt> with the following differences:
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; [&hellip;]</p></li>
<li><p>(1.2) &mdash; If <tt>T</tt> <del>models</del><ins>satisfies</ins> <tt>default_constructible</tt>, 
the default constructor of <tt><i>semiregular-box</i>&lt;T&gt;</tt> is equivalent to: [&hellip;]</p></li>
<li><p>(1.3) &mdash; If <tt>assignable_from&lt;T&amp;, const T&amp;&gt;</tt> is not 
<del>modeled</del><ins>satisfied</ins>, the copy assignment operator is equivalent to: [&hellip;]</p></li>
<li><p>(1.4) &mdash; If <tt>assignable_from&lt;T&amp;, T&gt;</tt> is not <del>modeled</del><ins>satisfied</ins>, 
the move assignment operator is equivalent to: [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 24.7.3 <a href="https://timsong-cpp.github.io/cppwp/range.all">[range.all]</a> as indicated:</p>

<blockquote>
<p>
-2- The name <tt>views::all</tt> denotes a range adaptor object (24.7.1 <a href="https://timsong-cpp.github.io/cppwp/range.adaptor.object">[range.adaptor.object]</a>). 
For some subexpression <tt>E</tt>, the expression <tt>views::all(E)</tt> is expression-equivalent to:
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; <tt><i>decay-copy</i>(E)</tt> if the decayed type of <tt>E</tt> 
<del>models</del><ins>satisfies</ins> <tt>view</tt>.</p></li>
<li><p>(2.2) &mdash; [&hellip;]</p></li>
<li><p>(2.3) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 24.7.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.filter.iterator">[range.filter.iterator]</a> as indicated:</p>

<blockquote>
<p>
-2- <tt>iterator::iterator_concept</tt> is defined as follows:
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; If <tt>V</tt> <del>models</del><ins>satisfies</ins> <tt>bidirectional_range</tt>, 
then <tt>iterator_concept</tt> denotes <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(2.2) &mdash; Otherwise, if <tt>V</tt> <del>models</del><ins>satisfies</ins> <tt>forward_range</tt>, 
then <tt>iterator_concept</tt> denotes <tt>forward_iterator_tag</tt>.</p></li>
<li><p>(2.3) &mdash; [&hellip;]</p></li>
</ol>
<p/>
-3- <tt>iterator::iterator_category</tt> is defined as follows:
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; Let <tt>C</tt> denote the type <tt>iterator_traits&lt;iterator_t&lt;V&gt;&gt;::iterator_category</tt>.</p></li>
<li><p>(3.2) &mdash; If <tt>C</tt> <del>models</del><ins>satisfies</ins> 
<tt>derived_from&lt;bidirectional_iterator_tag&gt;</tt>, then <tt>iterator_category</tt> denotes 
<tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(3.3) &mdash; Otherwise, if <tt>C</tt> <del>models</del><ins>satisfies</ins> 
<tt>derived_from&lt;forward_iterator_tag&gt;</tt>, then <tt>iterator_category</tt> denotes <tt>forward_iterator_tag</tt>.</p></li>
<li><p>(3.4) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a> as indicated:</p>

<blockquote>
<p>
-1- <tt>iterator::iterator_concept</tt> is defined as follows:
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; If <tt>V</tt> <del>models</del><ins>satisfies</ins> <tt>random_access_range</tt>, then 
<tt>iterator_concept</tt> denotes <tt>random_access_iterator_tag</tt>.</p></li>
<li><p>(1.2) &mdash; Otherwise, if <tt>V</tt> <del>models</del><ins>satisfies</ins> <tt>bidirectional_range</tt>, 
then <tt>iterator_concept</tt> denotes <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(1.3) &mdash; Otherwise, if <tt>V</tt> <del>models</del><ins>satisfies</ins> <tt>forward_range</tt>, 
then <tt>iterator_concept</tt> denotes <tt>forward_iterator_tag</tt>.</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
<p/>
-2- Let <tt>C</tt> denote the type <tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt>. 
If <tt>C</tt> <del>models</del><ins>satisfies</ins> <tt>derived_from&lt;contiguous_iterator_tag&gt;</tt>, 
then <tt>iterator_category</tt> denotes <tt>random_access_iterator_tag</tt>; otherwise, <tt>iterator_category</tt> 
denotes <tt>C</tt>.
</p>
</blockquote>
</li>

<li><p>Modify 24.7.10.3 <a href="https://timsong-cpp.github.io/cppwp/range.join.iterator">[range.join.iterator]</a> as indicated:</p>

<blockquote>
<p>
-1- <tt>iterator::iterator_concept</tt> is defined as follows:
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; If <tt>ref_is_glvalue</tt> is <tt>true</tt> and <tt>Base</tt> and 
<tt>range_reference_t&lt;Base&gt;</tt> each <del>model</del><ins>satisfy</ins> 
<tt>bidirectional_range</tt>, then <tt>iterator_concept</tt> denotes <tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(1.2) &mdash; Otherwise, if <tt>ref_is_glvalue</tt> is <tt>true</tt> and <tt>Base</tt> and 
<tt>range_reference_t&lt;Base&gt;</tt> each <del>model</del><ins>satisfy</ins> 
<tt>forward_range</tt>, then <tt>iterator_concept</tt> denotes <tt>forward_iterator_tag</tt>.</p></li>
<li><p>(1.3) &mdash; [&hellip;]</p></li>
</ol>
<p/>
-2- <tt>iterator::iterator_category</tt> is defined as follows:
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; Let [&hellip;]</p></li>
<li><p>(2.2) &mdash; If <tt>ref_is_glvalue</tt> is <tt>true</tt> and <tt><i>OUTERC</i></tt> and 
<tt><i>INNERC</i></tt> each <del>model</del><ins>satisfy</ins> 
<tt>derived_from&lt;bidirectional_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes 
<tt>bidirectional_iterator_tag</tt>.</p></li>
<li><p>(2.3) &mdash; Otherwise, if <tt>ref_is_glvalue</tt> is <tt>true</tt> and <tt><i>OUTERC</i></tt> 
and <tt><i>INNERC</i></tt> each <del>model</del><ins>satisfy</ins> 
<tt>derived_from&lt;forward_iterator_tag&gt;</tt>, <tt>iterator_category</tt> denotes 
<tt>forward_iterator_tag</tt>.</p></li>
<li><p>(2.4) &mdash; Otherwise, if <tt><i>OUTERC</i></tt> and <tt><i>INNERC</i></tt> each 
<del>model</del><ins>satisfy</ins> <tt>derived_from&lt;input_iterator_tag&gt;</tt>, 
<tt>iterator_category</tt> denotes <tt>input_iterator_tag</tt>.</p></li>
<li><p>(2.5) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 24.7.11.3 <a href="https://timsong-cpp.github.io/cppwp/range.split.outer">[range.split.outer]</a> as indicated:</p>

<blockquote>
<pre>
[&hellip;]
Parent* parent_ = nullptr; <i>// exposition only</i>
iterator_t&lt;Base&gt; current_ = <i>// exposition only, present only if <tt>V</tt> <del>models</del><ins>satisfies</ins> <tt>forward_range</tt></i>
  iterator_t&lt;Base&gt;();
[&hellip;]
</pre>
<p>
-1- Many of the following specifications refer to the notional member <tt><i>current</i></tt> of 
<tt>outer_iterator</tt>. <tt><i>current</i></tt> is equivalent to <tt>current_</tt> if <tt>V</tt> 
<del>models</del><ins>satisfies</ins> <tt>forward_range</tt>, and <tt>parent_-&gt;current_</tt> otherwise.
</p>
</blockquote>
</li>


<li><p>Modify 24.7.11.5 <a href="https://timsong-cpp.github.io/cppwp/range.split.inner">[range.split.inner]</a> as indicated:</p>

<blockquote>
<p>
-1- The <i>typedef-name</i> <tt>iterator_category</tt> denotes
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>forward_iterator_tag</tt> if 
<tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt> <del>models</del><ins>satisfies</ins> 
<tt>derived_from&lt;forward_iterator_tag&gt;</tt>;</p></li>
<li><p>(1.2) &mdash; otherwise, <tt>iterator_traits&lt;iterator_t&lt;Base&gt;&gt;::iterator_category</tt>.</p></li>
</ol> 
</blockquote>
</li>

<li><p>Modify 24.7.12 <a href="https://timsong-cpp.github.io/cppwp/range.counted">[range.counted]</a> as indicated:</p>

<blockquote>
<p>
-2- The name <tt>views::counted</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
Let <tt>E</tt> and <tt>F</tt> be expressions, and let <tt>T</tt> be <tt>decay_t&lt;decltype((E))&gt;</tt>. Then 
the expression <tt>views::counted(E, F)</tt> is expression-equivalent to:
<ol style="list-style-type: none">
<li><p>(2.1) &mdash; If <tt>T</tt> <del>models</del><ins>satisfies</ins> <tt>input_or_output_iterator</tt> 
and <tt>decltype((F))</tt> <del>models</del><ins>satisfies</ins> <tt>convertible_to&lt;iter_difference_t&lt;T&gt;&gt;</tt>,</p>
<ol style="list-style-type: none">
<li><p>(2.1.1) &mdash; <tt>subrange{E, E + static_cast&lt;iter_difference_t&lt;T&gt;&gt;(F)}</tt> if <tt>T</tt> 
<del>models</del><ins>satisfies</ins> <tt>random_access_iterator</tt>.</p></li>
<li><p>(2.1.2) &mdash; [&hellip;]</p></li>
</ol>
</li>
<li><p>(2.2) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 24.7.13.3 <a href="https://timsong-cpp.github.io/cppwp/range.common.adaptor">[range.common.adaptor]</a> as indicated:</p>

<blockquote>
<p>
-1- The name <tt>views::common denotes</tt> a range adaptor object (24.7.1 <a href="https://timsong-cpp.github.io/cppwp/range.adaptor.object">[range.adaptor.object]</a>). 
For some subexpression <tt>E</tt>, the expression <tt>views::common(E)</tt> is expression-equivalent to:
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt>views::all(E)</tt>, if <tt>decltype((E))</tt> <del>models</del><ins>satisfies</ins> 
<tt>common_range</tt> and <tt>views::all(E)</tt> is a well-formed expression.</p></li>
<li><p>(1.2) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</li>

<li><p>Modify 25.5.11 <a href="https://timsong-cpp.github.io/cppwp/alg.equal">[alg.equal]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class InputIterator1, class InputIterator2&gt;
  constexpr bool equal(InputIterator1 first1, InputIterator1 last1,
                       InputIterator2 first2);
[&hellip;]
template&lt;input_range R1, input_range R2, class Pred = ranges::equal_to,
          class Proj1 = identity, class Proj2 = identity&gt;
  requires indirectly_comparable&lt;iterator_t&lt;R1&gt;, iterator_t&lt;R2&gt;, Pred, Proj1, Proj2&gt;
  constexpr bool ranges::equal(R1&amp;&amp; r1, R2&amp;&amp; r2, Pred pred = {},
                               Proj1 proj1 = {}, Proj2 proj2 = {});
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-3- <i>Complexity:</i> If the types of <tt>first1</tt>, <tt>last1</tt>, <tt>first2</tt>, and <tt>last2</tt>:
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; meet the <i>Cpp17RandomAccessIterator</i> requirements (23.3.5.6 <a href="https://timsong-cpp.github.io/cppwp/random.access.iterators">[random.access.iterators]</a>) 
for the overloads in namespace <tt>std</tt>, or</p></li>
<li><p>(3.2) &mdash; pairwise <del>model</del><ins>satisfy</ins> <tt>sized_sentinel_for</tt> 
(23.3.4.8 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.sizedsentinel">[iterator.concept.sizedsentinel]</a>) for the overloads in namespace <tt>ranges</tt>, and 
<tt>last1 - first1 != last2 - first2</tt>, then no applications of the corresponding predicate and
each projection; otherwise,</p></li>
<li><p>(3.3) &mdash; [&hellip;]</p></li>
<li><p>(3.4) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 25.5.12 <a href="https://timsong-cpp.github.io/cppwp/alg.is.permutation">[alg.is.permutation]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;forward_iterator I1, sentinel_for&lt;I1&gt; S1, forward_iterator I2,
         sentinel_for&lt;I2&gt; S2, class Pred = ranges::equal_to, class Proj1 = identity,
         class Proj2 = identity&gt;
  requires indirectly_comparable&lt;I1, I2, Pred, Proj1, Proj2&gt;
  constexpr bool ranges::is_permutation(I1 first1, S1 last1, I2 first2, S2 last2,
                                        Pred pred = {},
                                        Proj1 proj1 = {}, Proj2 proj2 = {});
template&lt;forward_range R1, forward_range R2, class Pred = ranges::equal_to,
         class Proj1 = identity, class Proj2 = identity&gt;
  requires indirectly_comparable&lt;iterator_t&lt;R1&gt;, iterator_t&lt;R2&gt;, Pred, Proj1, Proj2&gt;
  constexpr bool ranges::is_permutation(R1&amp;&amp; r1, R2&amp;&amp; r2, Pred pred = {},
                                        Proj1 proj1 = {}, Proj2 proj2 = {});
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-7- <i>Complexity:</i> No applications of the corresponding predicate and projections if:
<ol style="list-style-type: none">
<li><p>(7.1) &mdash; <tt>S1</tt> and <tt>I1</tt> <del>model</del><ins>satisfy</ins> 
<tt>sized_sentinel_for&lt;S1, I1&gt;</tt>,</p></li>
<li><p>(7.2) &mdash; <tt>S2</tt> and <tt>I2</tt> <del>model</del><ins>satisfy</ins> 
<tt>sized_sentinel_for&lt;S2, I2&gt;</tt>, and</p></li>
<li><p>(7.3) &mdash; [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 25.7.4 <a href="https://timsong-cpp.github.io/cppwp/alg.partitions">[alg.partitions]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class ForwardIterator, class Predicate&gt;
  constexpr ForwardIterator
    partition(ForwardIterator first, ForwardIterator last, Predicate pred);
[&hellip;]
template&lt;forward_range R, class Proj = identity,
         indirect_unary_predicate&lt;projected&lt;iterator_t&lt;R&gt;, Proj&gt;&gt; Pred&gt;
  requires permutable&lt;iterator_t&lt;R&gt;&gt;
  constexpr safe_subrange_t&lt;R&gt;
    ranges::partition(R&amp;&amp; r, Pred pred, Proj proj = {});
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-8- <i>Complexity:</i> Let <tt><i>N</i> = last - first</tt>:
<ol style="list-style-type: none">
<li><p>(8.1) &mdash; For the overload with no <tt>ExecutionPolicy</tt>, exactly <tt><i>N</i></tt> 
applications of the predicate and projection. At most <tt><i>N</i>/2</tt> swaps if the type of 
<tt>first</tt> meets the <i>Cpp17BidirectionalIterator</i> requirements for the
overloads in namespace <tt>std</tt> or <del>models</del><ins>satisfies</ins> <tt>bidirectional_iterator</tt> 
for the overloads in namespace <tt>ranges</tt>, and at most <tt><i>N</i></tt> swaps otherwise.</p></li>
<li><p>(8.2) [&hellip;]</p></li>
</ol>
</p>
</blockquote>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-10, Prague; Daniel comments]</i></p>

<p>
I expect that <a href="https://wg21.link/p2101r0">P2101R0</a> (See 
<a href="https://wiki.edg.com/pub/Wg21prague/LibraryWorkingGroup/d2101r0.html">D2101R0</a>)
is going to resolve this issue.
<p/>
This proposal should also resolve the corresponding NB comments
<a href="https://github.com/cplusplus/nbballot/issues/294">US-298</a>
and <a href="https://github.com/cplusplus/nbballot/issues/296">US-300</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>

</p>




<hr>
<h3><a name="3346" href="3346">3346.</a> <tt>pair</tt> and <tt>tuple</tt> copy and move constructor have backwards specification</h3>
<p><b>Section:</b> 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a>, 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Richard Smith <b>Opened:</b> 2019-11-26 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#pairs.pair">active issues</a> in [pairs.pair].</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs.pair">issues</a> in [pairs.pair].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> p2 and 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> p3 say:
</p>
<blockquote>
<p>
The defaulted move and copy constructor, respectively, of {<tt>pair</tt>,<tt>tuple</tt>} is a constexpr 
function if and only if all required element-wise initializations for copy and move, respectively, 
would satisfy the requirements for a constexpr function.
</p>
</blockquote>
<p>
Note that we specify the copy constructor in terms of element move operations and the move constructor 
in terms of element copy operations. Is that really the intent? This appears to be how this was originally 
specified when the wording was added by <a href="https://wg21.link/n3471">N3471</a>.
</p>

<p><i>[2019-12-01; Daniel comments and provides wording]</i></p>

<p>
These inverted wording effects are an unintended oversight caused by <a href="https://wg21.link/n3471">N3471</a>.
</p>

<p><i>[2019-12-08 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after ten positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4835">N4835</a>.</p>

<ol>
<li><p>Modify 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> as indicated:</p>

<blockquote>
<p>
-2- The defaulted move and copy constructor, respectively, of <tt>pair</tt> shall be a constexpr function 
if and only if all required element-wise initializations for <del>copy</del><ins>move</ins> and 
<del>move</del><ins>copy</ins>, respectively, would satisfy the requirements for a constexpr function.
</p>
</blockquote>
</li>

<li><p>Modify 20.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/tuple.cnstr">[tuple.cnstr]</a> as indicated:</p>

<blockquote>
<p>
-3- The defaulted move and copy constructor, respectively, of <tt>tuple</tt> shall be a constexpr function 
if and only if all required element-wise initializations for <del>copy</del><ins>move</ins> and 
<del>move</del><ins>copy</ins>, respectively, would satisfy the requirements for a constexpr function. 
The defaulted move and copy constructor of <tt>tuple&lt;&gt;</tt> shall be constexpr functions.
</p>
</blockquote>
</li>


</ol>




<hr>
<h3><a name="3347" href="3347">3347.</a> <tt>std::pair&lt;T, U&gt;</tt> now requires <tt>T</tt> and <tt>U</tt> to be less-than-comparable</h3>
<p><b>Section:</b> 20.4.3 <a href="https://timsong-cpp.github.io/cppwp/pairs.spec">[pairs.spec]</a>, 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-12-03 <b>Last modified:</b> 2020-02-10 19:48:51 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#pairs.spec">active issues</a> in [pairs.spec].</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs.spec">issues</a> in [pairs.spec].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="https://wg21.link/p1614r2">P1614R2</a> added <tt>operator&lt;=&gt;</tt> as a hidden friend to 
<tt>std::pair</tt>:
</p>
<blockquote>
<pre>
friend constexpr common_comparison_category_t&lt;<i>synth-three-way-result</i>&lt;T1&gt;, 
                                              <i>synth-three-way-result</i>&lt;T2&gt;&gt;
  operator&lt;=&gt;(const pair&amp; x, const pair&amp; y) { <i>see below</i> }
</pre>
</blockquote>
<p>
That is not a function template, so is not a SFINAE context. If one or both of 
<tt><i>synth-three-way-result</i>&lt;T1&gt;</tt> or <tt><i>synth-three-way-result</i>&lt;T2&gt;</tt> is an 
invalid type then the declaration of <tt>operator&lt;=&gt;</tt> is ill-formed, and so the specialization 
<tt>std::pair&lt;T1, T2&gt;</tt> is ill-formed.
<p/>
A similar problem exists for <tt>std::array</tt>.
<p/>
There are at least two ways to fix this:
</p>
<ol>
<li><p>Constrain the function and delay the use of synth-three-way-result until we know it's valid.</p></li>
<li><p>Replace the hidden friend with a namespace-scope function template, so invalid 
<tt><i>synth-three-way-result</i></tt> types cause substitution failure.</p></li>
</ol>
<p>
The first option is somewhat hard to specify, because current policy is to avoid the use of requires-clauses 
in most of the library clauses. Even with a requires-clause, the potentially-invalid 
<tt><i>synth-three-way-result</i></tt> types cannot be used in the function declarator. Furthermore, the 
<tt>operator&lt;=&gt;</tt> for <tt>std::array</tt> is currently specified in Table [tab:container.opt] and 
so there's nowhere to add a <i>Constraints:</i> element.
<p/>
The second option would partially revert the <a href="https://wg21.link/p1614r2">P1614R2</a> changes for 
<tt>std::pair</tt> and <tt>std::array</tt> and bring them closer to what was in C++17. The main motivation 
for making <tt>operator==</tt> a hidden friend was to allow it to be defaulted, so that <tt>std::pair</tt> 
and <tt>std::array</tt> would be usable as non-type template parameters. Following the acceptance of 
<a href="https://wg21.link/p1907">P1907</a> in Belfast it isn't necessary to default it, so we can go back 
to what was in C++17.
</p>

<p><i>[2019-12-12 Issue Prioritization]</i></p>

<p>Priority to 1 after reflector discussion.</p>

<p><i>[2020-02-10 Move to Immediate Monday afternoon in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 20.2.1 <a href="https://timsong-cpp.github.io/cppwp/utility.syn">[utility.syn]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> This restores the pre-<a href="https://wg21.link/p1614r2">P1614R2</a> 
<tt>operator==</tt> and uses <tt>operator&lt;=&gt;</tt> as replacement for
<tt>operator&lt;</tt>, <tt>operator&lt;=</tt>, <tt>operator&gt;</tt>, <tt>operator&gt;=</tt>.]
</p>
</blockquote>

<blockquote>
<pre>
[&hellip;]

// 20.4 <a href="https://timsong-cpp.github.io/cppwp/pairs">[pairs]</a>, class template pair
template&lt;class T1, class T2&gt;
struct pair;

<i>// 20.4.3 <a href="https://timsong-cpp.github.io/cppwp/pairs.spec">[pairs.spec]</a>, pair specialized algorithms</i>
<ins>template&lt;class T1, class T2&gt;
  constexpr bool operator==(const pair&lt;T1, T2&gt;&amp;, const pair&lt;T1, T2&gt;&amp;);
template&lt;class T1, class T2&gt;
  constexpr common_comparison_category_t&lt;<i>synth-three-way-result</i>&lt;T1&gt;, 
                                         <i>synth-three-way-result</i>&lt;T2&gt;&gt;
  operator&lt;=&gt;(const pair&lt;T1, T2&gt;&amp;, const pair&lt;T1, T2&gt;&amp;);</ins>
  
template&lt;class T1, class T2&gt;
constexpr void swap(pair&lt;T1, T2&gt;&amp; x, pair&lt;T1, T2&gt;&amp; y) noexcept(noexcept(x.swap(y)));
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> as indicated:</p>

<blockquote>
<pre>
  [&hellip;]
  constexpr void swap(pair&amp; p) noexcept(<i>see below</i>);
  
  <del><i>// 20.4.3 <a href="https://timsong-cpp.github.io/cppwp/pairs.spec">[pairs.spec]</a>, pair specialized algorithms</i>
  friend constexpr bool operator==(const pair&amp;, const pair&amp;) = default;
  friend constexpr bool operator==(const pair&amp; x, const pair&amp; y)
    requires (is_reference_v&lt;T1&gt; || is_reference_v&lt;T2&gt;)
    { return x.first == y.first &amp;&amp; x.second == y.second; }
  friend constexpr common_comparison_category_t&lt;<i>synth-three-way-result</i>&lt;T1&gt;,
                                                <i>synth-three-way-result</i>&lt;T2&gt;&gt;
    operator&lt;=&gt;(const pair&amp; x, const pair&amp; y) { <i>see below</i> }</del>
};

template&lt;class T1, class T2&gt;
pair(T1, T2) -&gt; pair&lt;T1, T2&gt;;
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 20.4.3 <a href="https://timsong-cpp.github.io/cppwp/pairs.spec">[pairs.spec]</a> as indicated:</p>

<blockquote>
<p>
<b>20.4.3 Specialized algorithms [pairs.spec]</b>
</p>
<pre>
<ins>template&lt;class T1, class T2&gt;
  constexpr bool operator==(const pair&lt;T1, T2&gt;&amp; x, const pair&lt;T1, T2&gt;&amp; y);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Returns:</i> <tt>x.first == y.first &amp;&amp; x.second == y.second</tt>.</ins>
</p>
</blockquote>
<pre>
<ins>template&lt;class T1, class T2&gt;</ins>
<del>friend</del> constexpr
  common_comparison_category_t&lt;<i>synth-three-way-result</i>&lt;T1&gt;, <i>synth-three-way-result</i>&lt;T2&gt;&gt;
    operator&lt;=&gt;(const pair<ins>&lt;T1, T2&gt;</ins>&amp; x, const pair<ins>&lt;T1, T2&gt;</ins>&amp; y);
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to:
</p>
<blockquote><pre>
if (auto c = <i>synth-three-way</i>(x.first, y.first); c != 0) return c;
return <i>synth-three-way</i>(x.second, y.second);
</pre></blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Modify 22.3.2 <a href="https://timsong-cpp.github.io/cppwp/array.syn">[array.syn]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> This restores the pre-<a href="https://wg21.link/p1614r2">P1614R2</a> 
<tt>operator==</tt> and uses <tt>operator&lt;=&gt;</tt> as replacement for
<tt>operator&lt;</tt>, <tt>operator&lt;=</tt>, <tt>operator&gt;</tt>, <tt>operator&gt;=</tt>.]
</p>
</blockquote>

<blockquote>
<pre>
namespace std {

// 22.3.7 <a href="https://timsong-cpp.github.io/cppwp/array">[array]</a>, class template array
template&lt;class T, size_t N&gt; struct array;

<ins>template&lt;class T, size_t N&gt;
  constexpr bool operator==(const array&lt;T, N&gt;&amp; x, const array&lt;T, N&gt;&amp; y);
template&lt;class T, size_t N&gt;
  constexpr <i>synth-three-way-result</i>&lt;T&gt;
    operator&lt;=&gt;(const array&lt;T, N&gt;&amp; x, const array&lt;T, N&gt;&amp; y);</ins>

template&lt;class T, size_t N&gt;
constexpr void swap(array&lt;T, N&gt;&amp; x, array&lt;T, N&gt;&amp; y) noexcept(noexcept(x.swap(y)));
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> there is no need to add definitions of <tt>operator==</tt> and 
<tt>operator&lt;=&gt;</tt> to  [array.spec] because they are defined by Table 71: 
Container requirements [tab:container.req] and Table 73: Optional container operations 
[tab:container.opt] respectively.]
</p>
</blockquote>

<blockquote>
<pre>
  [&hellip;]
  constexpr T * data() noexcept;
  constexpr const T * data() const noexcept;
  
  <del>friend constexpr bool operator==(const array&amp;, const array&amp;) = default;
  friend constexpr <i>synth-three-way-result</i>&lt;value_type&gt;
    operator&lt;=&gt;(const array&amp;, const array&amp;);</del>
};

template&lt;class T, class... U&gt;
array(T, U...) -&gt; array&lt;T, 1 + sizeof...(U)&gt;;
[&hellip;]
</pre>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3348" href="3348">3348.</a> <tt>__cpp_lib_unwrap_ref</tt> in wrong header</h3>
<p><b>Section:</b> 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a>, 20.14.5.6 <a href="https://timsong-cpp.github.io/cppwp/refwrap.unwrapref">[refwrap.unwrapref]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2019-12-03 <b>Last modified:</b> 2020-02-13 18:10:47 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#version.syn">active issues</a> in [version.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#version.syn">issues</a> in [version.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
cpplearner points out in <a href="https://github.com/BRevzin/sd6/issues/1">this github comment</a> that:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
<p>
Since <tt>unwrap_reference</tt> and <tt>unwrap_ref_decay</tt> are defined in <tt>&lt;functional&gt;</tt> 
([functional.syn]), their feature test macro should also be defined there.
</p>
</blockquote>
<p>
<a href="https://wg21.link/p1902r1">P1902R1</a> adds this feature test macro in <tt>&lt;type_traits&gt;</tt> instead. 
The feature test macro and the type traits should go into the same header: either both in <tt>&lt;functional&gt;</tt> 
or both in <tt>&lt;type_traits&gt;</tt>. 
<p/>
The smallest diff is just to move the macro into <tt>&lt;functional&gt;</tt>.
</p>

<p><i>[2019-12-12 Issue Prioritization]</i></p>

<p>Priority to 2 after reflector discussion.</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a> p2 as indicated:</p>
<blockquote>
<pre>
[&hellip;]
#define __cpp_lib_unordered_map_try_emplace 201411L <i>// also in &lt;unordered_map&gt;</i>
#define __cpp_lib_unwrap_ref                201811L <i>// also in &lt;<del>type_traits</del><ins>functional</ins>&gt;</i>
#define __cpp_lib_variant                   201606L <i>// also in &lt;variant&gt;</i>
[&hellip;]
</pre>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
During LWG discussions it had been suggested that they considered it is an improvement to move the definitions of
<tt>unwrap_reference</tt> and <tt>unwrap_ref_decay</tt> from <tt>&lt;functional&gt;</tt> to <tt>&lt;type_traits&gt;</tt>.
This is what the alternative wording tries to accomplish.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.14.1 <a href="https://timsong-cpp.github.io/cppwp/functional.syn">[functional.syn]</a>, header <tt>&lt;functional&gt;</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
namespace std {
[&hellip;]
<del>template&lt;class T&gt; struct unwrap_reference;
template&lt;class T&gt; using unwrap_reference_t = typename unwrap_reference&lt;T&gt;::type;
template&lt;class T&gt; struct unwrap_ref_decay;
template&lt;class T&gt; using unwrap_ref_decay_t = typename unwrap_ref_decay&lt;T&gt;::type;</del>
[&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Delete sub-clause 20.14.5.6 <a href="https://timsong-cpp.github.io/cppwp/refwrap.unwrapref">[refwrap.unwrapref]</a> completely, as indicated:</p>
<blockquote>
<p>
<del><b>20.14.5.6 Transformation type trait <tt>unwrap_reference</tt> [refwrap.unwrapref]</b></del>
</p>
<pre>
<del>template&lt;class T&gt;
  struct unwrap_reference;</del>
</pre>
<blockquote>
<p>
<del>-1- If <tt>T</tt> is a specialization <tt>reference_wrapper&lt;X&gt;</tt> for some type <tt>X</tt>, the member typedef 
<tt>type</tt> of <tt>unwrap_reference&lt;T&gt;</tt> is <tt>X&amp;</tt>, otherwise it is <tt>T</tt>.</del>
</p>
</blockquote>
<pre>
<del>template&lt;class T&gt;
  struct unwrap_ref_decay;</del>
</pre>
<blockquote>
<p>
<del>-2- The member typedef <tt>type</tt> of <tt>unwrap_ref_decay&lt;T&gt;</tt> denotes the type 
<tt>unwrap_reference_t&lt;decay_t&lt;T&gt;&gt;</tt>.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a>, header <tt>&lt;type_traits&gt;</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
namespace std {
[&hellip;]
<i>// 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a>, other transformations</i>
[&hellip;]
template&lt;class T&gt; struct underlying_type;
template&lt;class Fn, class... ArgTypes&gt; struct invoke_result;
<ins>template&lt;class T&gt; struct unwrap_reference;
template&lt;class T&gt; struct unwrap_ref_decay;</ins>

template&lt;class T&gt;
  using type_identity_t = typename type_identity&lt;T&gt;::type;
[&hellip;]
template&lt;class Fn, class... ArgTypes&gt;
  using invoke_result_t = typename invoke_result&lt;Fn, ArgTypes...&gt;::type;
<ins>template&lt;class T&gt; 
  using unwrap_reference_t = typename unwrap_reference&lt;T&gt;::type;
template&lt;class T&gt; 
  using unwrap_ref_decay_t = typename unwrap_ref_decay&lt;T&gt;::type;</ins>
template&lt;class...&gt;
  using void_t = void;
[&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a>, Table 55 &mdash; "Sign modifications" in  [tab:meta.trans.sign] as indicated:</p>

<table border="1">
<caption>Table 52 &mdash; Other transformations [tab:meta.trans.other]</caption>
<tr>
<th>Template</th>
<th>Comments</th>
</tr> 

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<ins><tt>template &lt;class T&gt;<br/>
struct unwrap_reference;</tt></ins>
</td>
<td>
<ins>If <tt>T</tt> is a specialization <tt>reference_wrapper&lt;X&gt;</tt> for some type <tt>X</tt>, the member typedef 
<tt>type</tt> of <tt>unwrap_reference&lt;T&gt;</tt> is <tt>X&amp;</tt>, otherwise it is <tt>T</tt>.</ins>
</td>
</tr>

<tr>
<td>
<ins><tt>template &lt;class T&gt;<br/>
struct unwrap_ref_decay;</tt></ins>
</td>
<td>
<ins>The member typedef <tt>type</tt> of <tt>unwrap_ref_decay&lt;T&gt;</tt> denotes the type 
<tt>unwrap_reference_t&lt;decay_t&lt;T&gt;&gt;</tt>.</ins>
</td>
</tr>
</table>

</li>

<li><p>Insert between 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> p1 and p2 as indicated:</p>
<blockquote>
<p>
<ins>In addition to being available via inclusion of the <tt>&lt;type_traits&gt;</tt> header, the templates 
<tt>unwrap_reference</tt>, <tt>unwrap_ref_decay</tt>, <tt>unwrap_reference_t</tt>, and <tt>unwrap_ref_decay_t</tt> 
are available when the header <tt>&lt;functional&gt;</tt> (20.14.1 <a href="https://timsong-cpp.github.io/cppwp/functional.syn">[functional.syn]</a>) is included.</ins>
</p>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3349" href="3349">3349.</a> Missing <tt>__cpp_lib_constexpr_complex</tt> for P0415R1</h3>
<p><b>Section:</b> 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2019-12-04 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#version.syn">active issues</a> in [version.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#version.syn">issues</a> in [version.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="https://wg21.link/p1902r1">P1902R1</a> "Missing feature-test macros 2017-2019", accepted in Belfast, said:
</p>
<blockquote style="border-left: 3px solid #ccc;padding-left: 15px;">
<p>
[<a href="https://wg21.link/p0415r1">P0415R1</a>] (Constexpr for <tt>std::complex</tt>): this paper proposes to 
introduce the macro <tt>__cpp_lib_constexpr_complex</tt>. That is, introducing a new macro for this header.
</p>
</blockquote>
<p>
However, <tt>__cpp_lib_constexpr_complex</tt> wasn't mentioned in the Wording section, and doesn't appear 
in the latest WP <a href="https://wg21.link/n4842">N4842</a>.
<p/>
<a href="https://wg21.link/p0415r1">P0415R1</a> was accepted in Albuquerque (November 2017), and the paper itself 
said "For the purposes of SG10, we recommend the feature-testing macro name <tt>__cpp_lib_constexpr_complex</tt>.", 
so this has been accepted and then overlooked by WG21 twice.
</p>

<p><i>[2019-12-12 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after twelve positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a> p2 as indicated:</p>
<blockquote>
<pre>
[&hellip;]
#define __cpp_lib_constexpr_algorithms    201806L <i>// also in &lt;algorithm&gt;</i>
<ins>#define __cpp_lib_constexpr_complex       201711L <i>// also in &lt;complex&gt;</i></ins>
#define __cpp_lib_constexpr_dynamic_alloc 201907L <i>// also in &lt;memory&gt;</i>
[&hellip;]
</pre>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3350" href="3350">3350.</a> Simplify return type of <tt>lexicographical_compare_three_way</tt></h3>
<p><b>Section:</b> 25.7.11 <a href="https://timsong-cpp.github.io/cppwp/alg.three.way">[alg.three.way]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-12-04 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#alg.three.way">issues</a> in [alg.three.way].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current return type is:
</p>
<blockquote><pre>
common_comparison_category_t&lt;decltype(comp(*b1, *b2)), strong_ordering&gt;
</pre></blockquote>
<p>
Finding the common category with <tt>strong_ordering</tt> doesn't do anything. The common category of <tt>X</tt> 
and <tt>strong_ordering</tt> is always <tt>X</tt>, so we can simplify it to:
</p>
<blockquote><pre>
common_comparison_category_t&lt;decltype(comp(*b1, *b2))&gt;
</pre></blockquote>
<p>
This can further be simplified, because the common category of any comparison category type is just that type. 
If it's not a comparison category then the result would be <tt>void</tt>, but the function would be ill-formed 
in that case anyway, as we have:
</p>
<blockquote><p>
<i>Mandates:</i> <tt>decltype(comp(*b1, *b2))</tt> is a comparison category type.
</p></blockquote>
<p>
So the only effect of the complicated return type seems to be to cause the return type to be deduced as 
<tt>void</tt> for specializations of the function template that are ill-formed if called. That doesn't seem useful.
</p>

<p><i>[2019-12-12 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after seven positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 25.4 <a href="https://timsong-cpp.github.io/cppwp/algorithm.syn">[algorithm.syn]</a> as indicated:</p>
<blockquote>
<pre>
[&hellip;]
<i>// 25.7.11 <a href="https://timsong-cpp.github.io/cppwp/alg.three.way">[alg.three.way]</a>, three-way comparison algorithms</i>
template&lt;class InputIterator1, class InputIterator2, class Cmp&gt;
  constexpr auto
    lexicographical_compare_three_way(InputIterator1 b1, InputIterator1 e1,
                                      InputIterator2 b2, InputIterator2 e2,
                                      Cmp comp)
      -&gt; <del>common_comparison_category_t&lt;</del>decltype(comp(*b1, *b2))<del>, strong_ordering&gt;</del>;
template&lt;class InputIterator1, class InputIterator2&gt;
  constexpr auto
    lexicographical_compare_three_way(InputIterator1 b1, InputIterator1 e1,
                                      InputIterator2 b2, InputIterator2 e2);
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 25.7.11 <a href="https://timsong-cpp.github.io/cppwp/alg.three.way">[alg.three.way]</a> as indicated:</p>
<blockquote>
<pre>
template&lt;class InputIterator1, class InputIterator2, class Cmp&gt;
  constexpr auto
    lexicographical_compare_three_way(InputIterator1 b1, InputIterator1 e1,
                                      InputIterator2 b2, InputIterator2 e2,
                                      Cmp comp)
      -&gt; <del>common_comparison_category_t&lt;</del>decltype(comp(*b1, *b2))<del>, strong_ordering&gt;</del>;
</pre>
<blockquote>
<p>
-1- <i>Mandates:</i> <tt>decltype(comp(*b1, *b2))</tt> is a comparison category type.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3351" href="3351">3351.</a> <tt>ranges::enable_safe_range</tt> should not be constrained</h3>
<p><b>Section:</b> 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2019-12-05 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#ranges.syn">active issues</a> in [ranges.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#ranges.syn">issues</a> in [ranges.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Currently <tt>ranges::enable_safe_range</tt> is constrained with <tt>ranges::range</tt>, which not only 
forces the compiler to do unnecessary satisfaction checking when it's used, but also creates a tricky 
dependency cycle (<tt>ranges::range</tt> depends on <tt>ranges::begin</tt> which depends on 
<tt>ranges::enable_safe_range</tt> which depends on <tt>ranges::range</tt>).
<p/>
The only place the variable template is expected to be used is in the <tt>ranges::safe_range</tt> concept, 
which already checks <tt>range&lt;T&gt;</tt> before using <tt>enable_safe_range&lt;T&gt;</tt> anyway.
<p/>
The constraint serves no purpose and should be removed.
</p>

<p><i>[2019-12-12 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after eight positive votes on the reflector.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The definition in 24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a> p7 is already unconstrained, 
which contradicts the synopsis.]
</p>
</blockquote>

<blockquote>
<pre>
[&hellip;]
<i>// 24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a>, ranges</i>
template&lt;class T&gt;
concept range = <i>see below</i>;

template&lt;<del>range</del><ins>class</ins> T&gt;
inline constexpr bool enable_safe_range = false;

template&lt;class T&gt;
concept safe_range = <i>see below</i>;
[&hellip;]
</pre>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3352" href="3352">3352.</a> <tt>strong_equality</tt> isn't a thing</h3>
<p><b>Section:</b> 22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-12-06 <b>Last modified:</b> 2020-02-12 03:28:55 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#container.requirements.general">active issues</a> in [container.requirements.general].</p>
<p><b>View all other</b> <a href="lwg-index.html#container.requirements.general">issues</a> in [container.requirements.general].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[tab:container.req] includes the row:
</p>
<blockquote>
<p>
<b>Expression:</b> <tt>i &lt;=&gt; j</tt>
<p/>
<b>Return Type:</b> <tt>strong_ordering</tt> if <tt>X::iterator</tt> meets the random access iterator requirements, 
otherwise <tt>strong_equality</tt>.
<p/>
<b>Complexity:</b> constant
</p>
</blockquote>
<p>
"<tt>strong_equality</tt>" is (now) a meaningless term that appears nowhere else in the working draft. Presumably 
we want to make the Return Type unconditionally <tt>strong_ordering</tt>, and require this expression to be 
valid only when <tt>i</tt> and <tt>j</tt> are random access iterators. It's not clear to me if the best way to 
do so would be to add a "<i>Constraints</i>" to the "Assertion/note/pre-/post-condition" column of this table row, 
or if we should pull the row out into yet another "conditionally-supported iterator requirements" table.
</p>

<p><i>[2019-12-21 Issue Prioritization]</i></p>

<p>Priority to 1 after reflector discussion.</p>

<p><i>[2020-02-10, Prague; David Olsen provides new wording based upon Tim Songs suggestion]</i></p>

<p><i>[2020-02 Moved to Immediate on Tuesday in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>

<blockquote>
<table border="1">
<caption>Table 71 &mdash; Container requirements [tab:container.req]</caption>
<tr style="text-align:center">
<th>Expression</th>
<th>Return type</th>
<th>Operational<br/>semantics</th>
<th>Assertion/note<br/>pre/post-condition</th>
<th>Complexity</th>
</tr>
<tr>
<td colspan="5" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
<tr>
<td>
<tt>i &lt;=&gt; j</tt>
</td>
<td>
<tt>strong_ordering</tt> <del>if<br/>
<tt>X::iterator</tt> meets the<br/>
random access iterator<br/>
requirements, otherwise<br/>
<tt>strong_equality</tt></del>
</td>
<td></td>
<td>
<ins><i>Constraints:</i> <tt>X::iterator</tt> meets the random access iterator requirements.</ins>
</td>
<td>
constant
</td>
</tr>

<tr>
<td colspan="5" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>
</table>
</blockquote>




<hr>
<h3><a name="3353" href="3353">3353.</a> <tt>locale</tt>'s copy assignment operator should return <tt>locale&amp;</tt></h3>
<p><b>Section:</b> 28.3.1 <a href="https://timsong-cpp.github.io/cppwp/locale">[locale]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2019-12-06 <b>Last modified:</b> 2019-12-21 14:14:21 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#locale">issues</a> in [locale].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Curiously, <tt>locale</tt>'s copy assignment operator currently returns <tt>const locale&amp;</tt>. As Casey 
Carter noted in <a href="https://github.com/microsoft/STL/issues/268">microsoft/STL#268</a>, this is:
</p>
<ul>
<li><p>Weird!</p></li>
<li><p>The only occurrence in the entire Standard Library.</p></li>
<li><p>Preventing <tt>locale</tt> from satisfying <tt>std::copyable</tt>.</p></li>
</ul>
<p>
We aren't aware of any reason for this to be <tt>const</tt>. (I observe that this hasn't changed since 
<a href="https://wg21.link/n1804">N1804</a> on 2005-04-27 and probably goes back to C++98; I suspect that 
when this was originally specified, copy assignment operators were relatively new, and conventions for 
them weren't rigorously followed.)
</p>

<p><i>[2019-12-21 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion based on the observation that we have implementation
divergence.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 28.3.1 <a href="https://timsong-cpp.github.io/cppwp/locale">[locale]</a> as indicated:</p>

<blockquote>
<pre>
[&hellip;]
~locale(); <i>// not virtual</i>
<del>const</del> locale&amp; operator=(const locale&amp; other) noexcept;
template&lt;class Facet&gt; locale combine(const locale&amp; other) const;
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 28.3.1.2 <a href="https://timsong-cpp.github.io/cppwp/locale.cons">[locale.cons]</a> as indicated:</p>

<blockquote>
<pre>
<del>const</del> locale&amp; operator=(const locale&amp; other) noexcept;
</pre>
<blockquote>
<p>
-14- <i>Effects:</i> Creates a copy of <tt>other</tt>, replacing the current value.
<p/>
-15- <i>Returns:</i> <tt>*this</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>



<hr>
<h3><a name="3354" href="3354">3354.</a> <tt>has_strong_structural_equality</tt> has a meaningless definition</h3>
<p><b>Section:</b> 20.15.4.3 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop">[meta.unary.prop]</a>, 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2019-12-08 <b>Last modified:</b> 2020-02-13 18:18:33 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.unary.prop">active issues</a> in [meta.unary.prop].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.unary.prop">issues</a> in [meta.unary.prop].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
After the Belfast 2019 meeting with the acceptance of <a href="https://wg21.link/p1907r1">P1907R1</a>
the core language term "strong structural equality" has been removed and instead a more general 
definition of a "structural type" has been introduced that is suitable to be used as non-type template
parameter. These changes have caused the current definition of the <tt>has_strong_structural_equality</tt>
type trait (which had originally been introduced by <a href="https://wg21.link/p1614r2">P1614R2</a>
during the Cologne 2019 meeting) to become meaningless since it is currently defined as follows:
</p>
<blockquote>
<p>
The type <tt>T</tt> has strong structural equality (11.11.1 <a href="https://timsong-cpp.github.io/cppwp/class.compare.default">[class.compare.default]</a>).
</p>
</blockquote>
<p>
Besides the now undefined term "strong structural equality", the reference to 11.11.1 <a href="https://timsong-cpp.github.io/cppwp/class.compare.default">[class.compare.default]</a>
doesn't make sense anymore, assuming that the trait definition is supposed to refer now to a type that 
can be used as non-type template parameter.
<p/>
During library reflector discussions several informal naming suggestions has been mentioned, such as
<tt>is_structural[_type]</tt>, <tt>can_be_nttp</tt>, <tt>is_nontype_template_parameter_type</tt>.
<p/>
Albeit <tt>is_structural_type</tt> would come very near to the current core terminology, core experts 
have argued that the term "structural type" should be considered as a "core-internal" term that may
easily be replaced post-C++20.
<p/>
In addition to that definition and naming question of that type trait it should be discussed whether
there should exist a specific feature macro for just this type trait, similar to the reason why we 
introduced the <tt>__cpp_lib_has_unique_object_representations</tt> test macro for the
<tt>has_unique_object_representations</tt> type trait while voting in 
<a href="https://wg21.link/p0258r2">P0258R2</a>. The submitter of this issue believes that such a feature 
macro should be added and given that its final definition should be related to the date of the
acceptance of this issue (and should <em>not</em> be related to any historically accepted papers such as 
<a href="https://wg21.link/p1614r2">P1614R2</a>).
</p>

<p><i>[2020-01 Priority set to 1 and questions to LEWG after review on the reflector.]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a>, header <tt>&lt;version&gt;</tt> synopsis, as indicated (The
symbolic <tt>??????L</tt> represents the date to be defined by the project editor):</p>

<blockquote>
<pre>
[&hellip;]
#define __cpp_lib_is_swappable               201603L <i>// also in &lt;type_traits&gt;</i>
<ins>#define __cpp_lib_is_template_parameter_type ??????L <i>// also in &lt;type_traits&gt;</i></ins>
#define __cpp_lib_jthread                    201911L <i>// also in &lt;stop_token&gt;, &lt;thread&gt;</i>
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a>, header <tt>&lt;type_traits&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
template&lt;class T&gt; struct has_unique_object_representations;

template&lt;class T&gt; struct <del>has_strong_structural_equality</del><ins>is_template_parameter_type</ins>;

<i>// 20.15.5 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop.query">[meta.unary.prop.query]</a>, type property queries</i>
[&hellip;]
template&lt;class T&gt;
  inline constexpr bool has_unique_object_representations_v
    = has_unique_object_representations&lt;T&gt;::value;

template&lt;class T&gt;
  inline constexpr bool <del>has_strong_structural_equality_v</del><ins>is_template_parameter_type_v</ins>
    = <del>has_strong_structural_equality</del><ins>is_template_parameter_type</ins>&lt;T&gt;::value;
    
<i>// 20.15.5 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop.query">[meta.unary.prop.query]</a>, type property queries</i>
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a>, Table 47 ([tab:meta.unary.prop]) &mdash; 
"Type property predicates" &mdash; as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 47: Type property predicates [tab:meta.unary.prop]</caption>
<tr>
<th align="center">Template</th>
<th align="center">Condition</th>
<th align="center">Preconditions</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>template&lt;class T&gt;<br/>
struct<br/>
<del>has_strong_structural_equality</del><ins>is_template_parameter_type</ins>;</tt>
</td>

<td>
The type <tt>T</tt> <del>has strong<br/>
structural<br/>
equality (11.11.1 <a href="https://timsong-cpp.github.io/cppwp/class.compare.default">[class.compare.default]</a>)</del><br/>
<ins>can be used as non-type<br/>
<i>template-parameter</i> (13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>)</ins>.
</td>

<td>
<del><tt>T</tt> shall be a complete type,<br/>
<i>cv</i> <tt>void</tt>, or an array of<br/>
unknown bound.</del><br/>
<ins>If <tt>T</tt> is a class type, <tt>T</tt> shall<br/>
be a complete type.</ins>
</td>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02, Prague]</i></p>

<p>
LEWG looked at this and suggested to remove the existing trait <tt>has_strong_structural_equality</tt>
for now until someone demonstrates which usecases exist that would justify its existence.
</p>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Set to Immediate.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a>, header <tt>&lt;type_traits&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
template&lt;class T&gt; struct has_unique_object_representations;

<del>template&lt;class T&gt; struct has_strong_structural_equality;</del>

<i>// 20.15.5 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop.query">[meta.unary.prop.query]</a>, type property queries</i>
[&hellip;]
template&lt;class T&gt;
  inline constexpr bool has_unique_object_representations_v
    = has_unique_object_representations&lt;T&gt;::value;

<del>template&lt;class T&gt;
  inline constexpr bool has_strong_structural_equality_v
    = has_strong_structural_equality&lt;T&gt;::value;</del>
    
<i>// 20.15.5 <a href="https://timsong-cpp.github.io/cppwp/meta.unary.prop.query">[meta.unary.prop.query]</a>, type property queries</i>
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 20.15.2 <a href="https://timsong-cpp.github.io/cppwp/meta.type.synop">[meta.type.synop]</a>, Table 47 ([tab:meta.unary.prop]) &mdash; 
"Type property predicates" &mdash; as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 47: Type property predicates [tab:meta.unary.prop]</caption>
<tr>
<th align="center">Template</th>
<th align="center">Condition</th>
<th align="center">Preconditions</th>
</tr>

<tr>
<td colspan="3" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<del><tt>template&lt;class T&gt;<br/>
struct<br/>
has_strong_structural_equality;</tt></del>
</td>

<td>
<del>The type <tt>T</tt> has strong<br/>
structural<br/>
equality (11.11.1 <a href="https://timsong-cpp.github.io/cppwp/class.compare.default">[class.compare.default]</a>).</del>
</td>

<td>
<del><tt>T</tt> shall be a complete type,<br/>
<i>cv</i> <tt>void</tt>, or an array of<br/>
unknown bound.</del>
</td>
</tr>
</table>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3355" href="3355">3355.</a> The memory algorithms should support move-only input iterators introduced by P1207</h3>
<p><b>Section:</b> 20.10.11.5 <a href="https://timsong-cpp.github.io/cppwp/uninitialized.copy">[uninitialized.copy]</a>, 20.10.11.6 <a href="https://timsong-cpp.github.io/cppwp/uninitialized.move">[uninitialized.move]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Corentin Jabot <b>Opened:</b> 2019-11-12 <b>Last modified:</b> 2020-01-14 11:35:57 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#uninitialized.copy">issues</a> in [uninitialized.copy].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="https://wg21.link/p1207">P1207</a> introduced move-only input iterators but did not modify the 
specialized memory algorithms to support them.
</p>

<p><i>[2020-01 Priority set to 2 after review on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 20.10.11.5 <a href="https://timsong-cpp.github.io/cppwp/uninitialized.copy">[uninitialized.copy]</a> as indicated:</p>

<blockquote>
<pre>
namespace ranges {
  template&lt;input_iterator I, sentinel_for&lt;I&gt; S1,
           <i>no-throw-forward-iterator</i> O, <i>no-throw-sentinel</i>&lt;O&gt; S2&gt;
      requires constructible_from&lt;iter_value_t&lt;O&gt;, iter_reference_t&lt;I&gt;&gt;
    uninitialized_copy_result&lt;I, O&gt;
      uninitialized_copy(I ifirst, S1 ilast, O ofirst, S2 olast);
  template&lt;input_range IR, <i>no-throw-forward-range</i> OR&gt;
      requires constructible_from&lt;range_value_t&lt;OR&gt;, range_reference_t&lt;IR&gt;&gt;
    uninitialized_copy_result&lt;safe_iterator_t&lt;IR&gt;, safe_iterator_t&lt;OR&gt;&gt;
      uninitialized_copy(IR&amp;&amp; in_range, OR&amp;&amp; out_range);
}
</pre>
<blockquote>
<p>
-4- <i>Preconditions:</i> <tt>[ofirst, olast)</tt> shall not overlap with <tt>[ifirst, ilast)</tt>.
<p/>
-5- <i>Effects:</i> Equivalent to:
<blockquote><pre>
for (; ifirst != ilast &amp;&amp; ofirst != olast; ++ofirst, (void)++ifirst) {
  ::new (<i>voidify</i>(*ofirst)) remove_reference_t&lt;iter_reference_t&lt;O&gt;&gt;(*ifirst);
}
return {<ins>std::move(</ins>ifirst<ins>)</ins>, ofirst};
</pre></blockquote>
</p>
</blockquote>
[&hellip;]
<pre>
namespace ranges {
  template&lt;input_iterator I, <i>no-throw-forward-iterator</i> O, <i>no-throw-sentinel</i>&lt;O&gt; S&gt;
      requires constructible_from&lt;iter_value_t&lt;O&gt;, iter_reference_t&lt;I&gt;&gt;
    uninitialized_copy_n_result&lt;I, O&gt;
      uninitialized_copy_n(I ifirst, iter_difference_t&lt;I&gt; n, O ofirst, S olast);
}
</pre>
<blockquote>
<p>
-9- <i>Preconditions:</i> <tt>[ofirst, olast)</tt> shall not overlap with <tt>[ifirst, n)</tt>.
<p/>
-10- <i>Effects:</i> Equivalent to:
<blockquote><pre>
auto t = uninitialized_copy(counted_iterator(ifirst, n),
                            default_sentinel, ofirst, olast);
return {<ins>std::move(</ins>t.in<ins>)</ins>.base(), t.out};
</pre></blockquote>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.10.11.6 <a href="https://timsong-cpp.github.io/cppwp/uninitialized.move">[uninitialized.move]</a> as indicated:</p>

<blockquote>
<pre>
namespace ranges {
  template&lt;input_iterator I, sentinel_for&lt;I&gt; S1,
           <i>no-throw-forward-iterator</i> O, <i>no-throw-sentinel</i>&lt;O&gt; S2&gt;
      requires constructible_from&lt;iter_value_t&lt;O&gt;, iter_rvalue_reference_t&lt;I&gt;&gt;
    uninitialized_move_result&lt;I, O&gt;
      uninitialized_move(I ifirst, S1 ilast, O ofirst, S2 olast);
  template&lt;input_range IR, <i>no-throw-forward-range</i> OR&gt;
      requires constructible_from&lt;range_value_t&lt;OR&gt;, range_rvalue_reference_t&lt;IR&gt;&gt;
    uninitialized_move_result&lt;safe_iterator_t&lt;IR&gt;, safe_iterator_t&lt;OR&gt;&gt;
      uninitialized_move(IR&amp;&amp; in_range, OR&amp;&amp; out_range);
}
</pre>
<blockquote>
<p>
-3- <i>Preconditions:</i> <tt>[ofirst, olast)</tt> shall not overlap with <tt>[ifirst, ilast)</tt>.
<p/>
-4- <i>Effects:</i> Equivalent to:
<blockquote><pre>
for (; ifirst != ilast &amp;&amp; ofirst != olast; ++ofirst, (void)++ifirst) {
  ::new (<i>voidify</i>(*ofirst)) 
    remove_reference_t&lt;iter_reference_t&lt;O&gt;&gt;(ranges::iter_move(*ifirst));
}
return {<ins>std::move(</ins>ifirst<ins>)</ins>, ofirst};
</pre></blockquote>
</p>
</blockquote>
[&hellip;]
<pre>
namespace ranges {
  template&lt;input_iterator I, <i>no-throw-forward-iterator</i> O, <i>no-throw-sentinel</i>&lt;O&gt; S&gt;
      requires constructible_from&lt;iter_value_t&lt;O&gt;, iter_rvalue_reference_t&lt;I&gt;&gt;
    uninitialized_move_n_result&lt;I, O&gt;
      uninitialized_move_n(I ifirst, iter_difference_t&lt;I&gt; n, O ofirst, S olast);
}
</pre>
<blockquote>
<p>
-8- <i>Preconditions:</i> <tt>[ofirst, olast)</tt> shall not overlap with <tt>[ifirst, n)</tt>.
<p/>
-9- <i>Effects:</i> Equivalent to:
<blockquote><pre>
auto t = uninitialized_move(counted_iterator(ifirst, n),
                            default_sentinel, ofirst, olast);
return {<ins>std::move(</ins>t.in<ins>)</ins>.base(), t.out};
</pre></blockquote>
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3356" href="3356">3356.</a> <tt>__cpp_lib_nothrow_convertible</tt> should be <tt>__cpp_lib_<em>is_</em>nothrow_convertible</tt></h3>
<p><b>Section:</b> 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2019-12-09 <b>Last modified:</b> 2020-01-17 04:54:50 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#version.syn">active issues</a> in [version.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#version.syn">issues</a> in [version.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="https://wg21.link/p1902r1">P1902R1</a> introduced the feature test macro 
<tt>__cpp_lib_nothrow_convertible</tt>, but every other example in SD-6 of a feature test macro 
testing for the presence of a single type trait <em>FOO</em> is named <tt>__cpp_lib_<em>FOO</em></tt>. 
This macro should be renamed <tt>__cpp_lib_is_nothrow_convertible</tt>.
<p/>
This naming convention should probably be documented in SD-6 as policy.
</p>

<p><i>[2019-12-21 Issue Prioritization]</i></p>

<p>Status to Tentatively Ready and priority to 0 after seven positive votes on the reflector.
A convincing argument was that currently no vendor had published a release with the previous
feature macro.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a>, header <tt>&lt;version&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
#define __cpp_lib_not_fn                 201603L  <i>// also in &lt;functional&gt;</i>
#define __cpp_lib_<ins>is_</ins>nothrow_convertible 201806L  <i>// also in &lt;type_traits&gt;</i>
#define __cpp_lib_null_iterators         201304L  <i>// also in &lt;iterator&gt;</i>
[&hellip;]
</pre>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3357" href="3357">3357.</a> [fund.ts.v3] <tt>default_random_engine</tt> is overspecified for per-thread engine</h3>
<p><b>Section:</b> 10.1.2.1 [fund.ts.v3::rand.util.randint] <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Zhihao Yuan <b>Opened:</b> 2019-12-10 <b>Last modified:</b> 2020-01-06 17:30:13 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses: fund.ts.v3</b></p>
<p>
Although "implementation may select this type on the basis of performance, size,
quality, or any combination of such factors," but changing this typedef is an ABI-break
for implementations. Specifying per-thread engine to use this typedef results in losses
of performance, size, and/or quality.
<p/>
Since this type is not involved in <tt>randint</tt> facilities' interface (other than its member
typedef), the current specification should be relaxed.
</p>
<p><i>[01-2020 Priority set to 3 and assigned to LEWG after review on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4840">N4840</a>.</p>

<ol>
<li><p>Modify  [fund.ts.v3::rand.syn], header <tt>&lt;experimental/random&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
#include &lt;random&gt;

namespace std::experimental {
inline namespace fundamentals_v3 {

  <i>// 10.1.2.1, Function template randint</i>
  template &lt;class IntType&gt;
  IntType randint(IntType a, IntType b);
  void reseed();
  void reseed(<del>default_random_engine::result_type</del><ins>uint_fast32_t</ins> value);

} // inline namespace fundamentals_v3
} // namespace std::experimental
</pre>
</blockquote>
</li>

<li><p>Modify 10.1.2.1 [fund.ts.v3::rand.util.randint] as indicated:</p>

<blockquote>
<p>
-1- A separate <i>per-thread engine</i> of <del>type <tt>default_random_engine</tt> 
(C++17 &sect;29.6.5)</del><ins>unspecified type that meets the requirements of random 
number engine (C++17 [rand.req.eng])</ins>, initialized to an unpredictable state, 
shall be maintained for each thread. <ins>[<i>Note:</i> The implementation may choose 
the engine type on the basis of performance, size, quality, or any combination of such 
factors, so as to provide at least acceptable engine behavior for relatively casual, 
inexpert, and/or lightweight use. &mdash; <i>end note</i>]</ins>
</p>
[&hellip;]
<pre>
void reseed();
void reseed(<del>default_random_engine::result_type</del><ins>uint_fast32_t</ins> value);
</pre>
<blockquote>
<p>
-7- <i>Effects:</i> Let <tt>g</tt> be the per-thread engine. The first form sets <tt>g</tt> to an unpredictable 
state. The second form invokes <tt>g.seed(value)</tt>.
<p/>
-8- <i>Postconditions:</i> Subsequent calls to <tt>randint</tt> do not depend on values produced by <tt>g</tt> 
before calling reseed. [<i>Note:</i> <tt>reseed</tt> also resets any instances of 
<tt>uniform_int_distribution</tt> used by <tt>randint</tt>. &mdash; <i>end note</i>] 
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3358" href="3358">3358.</a> &sect;[span.cons] is mistaken that <tt>to_address</tt> can throw</h3>
<p><b>Section:</b> 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-12-10 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#span.cons">active issues</a> in [span.cons].</p>
<p><b>View all other</b> <a href="lwg-index.html#span.cons">issues</a> in [span.cons].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[span.cons] paragraphs 6 and 9:
</p>
<blockquote><p>
<i>Throws:</i> When and what <tt>to_address(first)</tt> throws.
</p></blockquote>
<p>
could equivalently be "<i>Throws:</i> Nothing." since all overloads of <tt>std::to_address</tt> are 
<tt>noexcept</tt>. However, paragraph 9 fails to account for the fact that paragraph 8:
</p>
<blockquote><p>
<i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> with 
<tt>last - first</tt>.
</p></blockquote>
<p>
must evaluate <tt>last - first</tt>.
</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after ten positive votes on the reflector.]</i></p>


<p><i>[2020-01-14; Daniel comments]</i></p>

<p>
The fixed wording in 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p9 depends on the no-throw-guarantee of integer-class
conversions to integral types. This guarantee is specified by LWG <a href="3367">3367</a>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> paragraphs 6 and 9 as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> 
<ol>
<li><p>The missing paragraph number of the <i>Preconditions</i> element at p7/p8 has
already been reported as <a href="https://github.com/cplusplus/draft/issues/3540">editorial issue</a></p></li>
<li><p>The effective change to "Throws: Nothing." in p6 has already been 
<a href="https://github.com/cplusplus/draft/commit/e01989e83849323ab49089ea18a52ccbac08d90a">applied editorially</a>.</p></li>
</ol>
]
</p>
</blockquote>

<blockquote>
<pre>
template&lt;class It&gt;
  constexpr span(It first, size_type count);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-4- <i>Preconditions:</i> [&hellip;]
<p/>
-5- <i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> with 
<tt>count</tt>.
<p/>
-6- <i>Throws:</i> <del>When and what <tt>to_address(first)</tt> throws</del><ins>Nothing</ins>.
</p>
</blockquote>
<pre>
template&lt;class It, class End&gt;
  constexpr span(It first, End last);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-?- <i>Preconditions:</i> [&hellip;]
<p/>
-8- <i>Effects:</i> Initializes <tt>data_</tt> with <tt>to_address(first)</tt> and <tt>size_</tt> 
with <tt>last - first</tt>.
<p/>
-9- <i>Throws:</i> When and what <tt><del>to_address(first)</del><ins>last - first</ins></tt> throws.
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3359" href="3359">3359.</a> <tt>&lt;chrono&gt;</tt> leap second support should allow for negative leap seconds</h3>
<p><b>Section:</b> 27.11.8 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap">[time.zone.leap]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Asher Dunn <b>Opened:</b> 2019-12-16 <b>Last modified:</b> 2020-01-14 11:35:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>class leap</tt> (which is expected to be renamed by <a href="https://wg21.link/p1981r0">P1981R0</a> to
<tt>leap_second</tt>) defined in 27.11.8 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap">[time.zone.leap]</a> should include support for both
positive leap seconds (<tt>23:59:60</tt> added to UTC at a specified time) and negative leap seconds
(<tt>23:59:59</tt> removed from UTC at a specified time). While only positive leap seconds have been
inserted to date, the definition of UTC allows for both.
<p/>
Update 27.11.8 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap">[time.zone.leap]</a> to specify the value of leap seconds in addition to
their insertion date, and update wording and examples in 27.7 <a href="https://timsong-cpp.github.io/cppwp/time.clock">[time.clock]</a> and
27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a> that involve leap seconds to account for both types of leap second.
</p>

<p><i>[2020-01 Priority set to 3 after review on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 27.7.2.2 <a href="https://timsong-cpp.github.io/cppwp/time.clock.utc.members">[time.clock.utc.members]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Duration&gt;
  static sys_time&lt;common_type_t&lt;Duration, seconds&gt;&gt;
    to_sys(const utc_time&lt;Duration&gt;&amp; u);
</pre>
<blockquote>
<p>
-2- <i>Returns:</i> A <tt>sys_time t</tt>, such that <tt>from_sys(t) == u</tt> if such a mapping exists.
Otherwise <tt>u</tt> represents a <tt>time_point</tt> during a <ins>positive</ins> leap second
insertion<ins>, the conversion counts that leap second as not inserted,</ins> and the last
representable value of <tt>sys_time</tt> prior to the insertion of the leap second is returned.
</p>
</blockquote>
<pre>
template&lt;class Duration&gt;
  static utc_time&lt;common_type_t&lt;Duration, seconds&gt;&gt;
    from_sys(const sys_time&lt;Duration&gt;&amp; t);
</pre>
<blockquote>
<p>
-3- <i>Returns:</i> A <tt>utc_time u</tt>, such that <tt>u.time_since_epoch() - t.time_since_epoch()</tt>
is equal to the <del>number</del><ins>sum</ins> of leap seconds that were inserted between <tt>t</tt>
and 1970-01-01. If <tt>t</tt> is exactly the date of leap second insertion, then the conversion counts
that leap second as inserted.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.7.2.3 <a href="https://timsong-cpp.github.io/cppwp/time.clock.utc.nonmembers">[time.clock.utc.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Duration&gt;
  leap_second_info get_leap_second_info(const utc_time&lt;Duration&gt;&amp; ut);
</pre>
<blockquote>
<p>
-6- <i>Returns:</i> A <tt>leap_second_info</tt> where <tt>is_leap_second</tt> is <tt>true</tt> if
<tt>ut</tt> is during a <ins>positive</ins> leap second insertion, and otherwise <tt>false</tt>.
<tt>elapsed</tt> is the <del>number</del><ins>sum</ins> of leap seconds between 1970-01-01 and
<tt>ut</tt>. If <tt>is_leap_second</tt> is <tt>true</tt>, the leap second referred to by <tt>ut</tt>
is included in the count.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/time.clock.tai.overview">[time.clock.tai.overview]</a> as indicated:</p>

<blockquote>
<p>
-1- The clock <tt>tai_clock</tt> measures seconds since 1958-01-01 00:00:00 and is offset 10s ahead of
UTC at this date. That is, 1958-01-01 00:00:00 TAI is equivalent to 1957-12-31 23:59:50 UTC. Leap seconds
are not inserted into TAI. Therefore every time a leap second is inserted into UTC, UTC <del>falls another
second behind</del><ins>shifts another second with respect to</ins> TAI. For example by 2000-01-01 there
had been 22 <ins>positive and 0 negative</ins> leap seconds inserted so 2000-01-01 00:00:00 UTC is
equivalent to 2000-01-01 00:00:32 TAI (22s plus the initial 10s offset).
</p>
</blockquote>
</li>

<li><p>Modify 27.7.4.1 <a href="https://timsong-cpp.github.io/cppwp/time.clock.gps.overview">[time.clock.gps.overview]</a> as indicated:</p>

<blockquote>
<p>
-1- The clock <tt>gps_clock</tt> measures seconds since the first Sunday of January, 1980 00:00:00 UTC.
Leap seconds are not inserted into GPS. Therefore every time a leap second is inserted into UTC, UTC
<del>falls another second behind</del><ins>shifts another second with respect to</ins> GPS. Aside from
the offset from <tt>1958y/January/1</tt> to <tt>1980y/January/Sunday[1]</tt>, GPS is behind TAI by 19s
due to the 10s offset between 1958 and 1970 and the additional 9 leap seconds inserted between 1970 and 1980.
</p>
</blockquote>
</li>

<li><p>Modify 27.11.8.1 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap.overview">[time.zone.leap.overview]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::chrono {
  class leap {
  public:
    leap(const leap&amp;) = default;
    leap&amp; operator=(const leap&amp;) = default;

    <i>// unspecified additional constructors</i>

    constexpr sys_seconds date() const noexcept;
    <ins>constexpr seconds value() const noexcept;</ins>
  };
}
</pre>
<p>
-1- Objects of type <tt>leap</tt> representing the date <ins>and value</ins> of the leap second
insertions are constructed and stored in the time zone database when initialized.
<p/>
-2- [<i>Example:</i>
</p>
<blockquote><pre>
for (auto&amp; l : get_tzdb().leaps)
  if (l &lt;= 2018y/March/17d)
    cout &lt;&lt; l.date() &lt;&lt; <ins>": " &lt;&lt; l.value() &lt;&lt;</ins> '\n';
</pre></blockquote>
<p>
Produces the output:
</p>
<blockquote><pre>
1972-07-01 00:00:00<ins>: 1s</ins>
1973-01-01 00:00:00<ins>: 1s</ins>
1974-01-01 00:00:00<ins>: 1s</ins>
1975-01-01 00:00:00<ins>: 1s</ins>
1976-01-01 00:00:00<ins>: 1s</ins>
1977-01-01 00:00:00<ins>: 1s</ins>
1978-01-01 00:00:00<ins>: 1s</ins>
1979-01-01 00:00:00<ins>: 1s</ins>
1980-01-01 00:00:00<ins>: 1s</ins>
1981-07-01 00:00:00<ins>: 1s</ins>
1982-07-01 00:00:00<ins>: 1s</ins>
1983-07-01 00:00:00<ins>: 1s</ins>
1985-07-01 00:00:00<ins>: 1s</ins>
1988-01-01 00:00:00<ins>: 1s</ins>
1990-01-01 00:00:00<ins>: 1s</ins>
1991-01-01 00:00:00<ins>: 1s</ins>
1992-07-01 00:00:00<ins>: 1s</ins>
1993-07-01 00:00:00<ins>: 1s</ins>
1994-07-01 00:00:00<ins>: 1s</ins>
1996-01-01 00:00:00<ins>: 1s</ins>
1997-07-01 00:00:00<ins>: 1s</ins>
1999-01-01 00:00:00<ins>: 1s</ins>
2006-01-01 00:00:00<ins>: 1s</ins>
2009-01-01 00:00:00<ins>: 1s</ins>
2012-07-01 00:00:00<ins>: 1s</ins>
2015-07-01 00:00:00<ins>: 1s</ins>
2017-01-01 00:00:00<ins>: 1s</ins>
</pre></blockquote>
<p>
&mdash; <i>end example</i>]
</p>
</blockquote>
</li>

<li><p>Modify 27.11.8.2 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap.members">[time.zone.leap.members]</a> as indicated:</p>

<blockquote>
<pre>
constexpr sys_seconds date() const noexcept;
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> The date and time at which the leap second was inserted.
</p>
</blockquote>
<pre>
<ins>constexpr seconds value() const noexcept;</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Returns:</i> The value of the leap second. Always <tt>+1s</tt> to indicate a positive
leap second or <tt>-1s</tt> to indicate a negative leap second. All leap seconds inserted up
through 2017 were positive leap seconds.</ins>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.12 <a href="https://timsong-cpp.github.io/cppwp/time.format">[time.format]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Duration, class charT&gt;
  struct formatter&lt;chrono::utc_time&lt;Duration&gt;, charT&gt;;
</pre>
<blockquote>
<p>
-7- <i>Remarks:</i> If <tt>%Z</tt> is used, it is replaced with
<tt><i>STATICALLY-WIDEN</i>&lt;charT&gt;("UTC")</tt>. If <tt>%z</tt> (or a modified
variant of <tt>%z</tt>) is used, an offset of <tt>0min</tt> is formatted. If the argument represents
a time during a <ins>positive</ins> leap second insertion, and if a seconds field is formatted,
the integral portion of that format is <tt><i>STATICALLY-WIDEN</i>&lt;charT&gt;("60")</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3360" href="3360">3360.</a> <tt>three_way_comparable_with</tt> is inconsistent with similar concepts</h3>
<p><b>Section:</b> 17.11.4 <a href="https://timsong-cpp.github.io/cppwp/cmp.concept">[cmp.concept]</a> <b>Status:</b> <a href="lwg-active.html#Voting">Voting</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-12-18 <b>Last modified:</b> 2020-01-25 14:44:39 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Voting">Voting</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The concept <tt>three_way_comparable_with</tt> is defined in 17.11.4 <a href="https://timsong-cpp.github.io/cppwp/cmp.concept">[cmp.concept]</a> as:
</p>
<blockquote>
<pre>
template&lt;class T, class U, class Cat = partial_ordering&gt;
  concept three_way_comparable_with =
    <i>weakly-equality-comparable-with</i>&lt;T, U&gt; &amp;&amp;
    <i>partially-ordered-with</i>&lt;T, U&gt; &amp;&amp;
    three_way_comparable&lt;T, Cat&gt; &amp;&amp;
    three_way_comparable&lt;U, Cat&gt; &amp;&amp;
    common_reference_with&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt; &amp;&amp;
    three_way_comparable&lt;
      common_reference_t&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt;, Cat&gt; &amp;&amp;
    requires(const remove_reference_t&lt;T&gt;&amp; t, const remove_reference_t&lt;U&gt;&amp; u) {
      { t &lt;=&gt; u } -&gt; <i>compares-as</i>&lt;Cat&gt;;
      { u &lt;=&gt; t } -&gt; <i>compares-as</i>&lt;Cat&gt;;
    };
</pre>
</blockquote>
<p>
Which notably doesn't follow the requirement ordering:
</p>
<ol>
<li><p>same-type requirements on <tt>T</tt></p></li>
<li><p>same-type requirements on <tt>U</tt></p></li>
<li><p><tt>common_reference_with</tt> requirement</p></li>
<li><p>same-type requirements on <tt>common_reference_t&lt;T, U&gt;</tt></p></li>
<li><p>cross-type requirements on <tt>T</tt> and <tt>U</tt></p></li>
</ol>
<p>
that the other cross-type comparison concepts (18.5.3 <a href="https://timsong-cpp.github.io/cppwp/concept.equalitycomparable">[concept.equalitycomparable]</a>, 
18.5.4 <a href="https://timsong-cpp.github.io/cppwp/concept.totallyordered">[concept.totallyordered]</a>) use. There were some motivating reasons for that ordering:
</p>
<ol>
<li><p>The existence of a common reference type is effectively an opt-in to cross-type concepts. 
Avoiding checking cross-type expressions when no common reference type exists can enable the 
concepts to work even in the presence of poorly-constrained "accidental" cross-type operator 
templates which could otherwise produce compile errors instead of dissatisfied concepts.</p></li>
<li><p>Putting the simpler same-type requirements first can help produce simpler error messages 
when applying the wrong concept to a pair of types, or the right concept to the wrong pair of types. 
"<tt>Frobnozzle &lt;=&gt; Frobnozzle</tt> is not a valid expression" is more easily deciphered than 
is "<tt>std::common_reference&lt;int, FrobNozzle&gt;</tt> has no member named type".</p></li>
</ol>
<p>
<tt>three_way_comparable_with</tt> should be made consistent with <tt>equality_comparable_with</tt> and 
<tt>totally_ordered_with</tt> for the above reasons and to make it easier to reason about comparison concepts 
in general.
</p>

<p><i>[2020-01 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 17.11.4 <a href="https://timsong-cpp.github.io/cppwp/cmp.concept">[cmp.concept]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T, class U, class Cat = partial_ordering&gt;
  concept three_way_comparable_with =
    <del><i>weakly-equality-comparable-with</i>&lt;T, U&gt; &amp;&amp;</del>
    <del><i>partially-ordered-with</i>&lt;T, U&gt; &amp;&amp;</del>
    three_way_comparable&lt;T, Cat&gt; &amp;&amp;
    three_way_comparable&lt;U, Cat&gt; &amp;&amp;
    common_reference_with&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt; &amp;&amp;
    three_way_comparable&lt;
      common_reference_t&lt;const remove_reference_t&lt;T&gt;&amp;, const remove_reference_t&lt;U&gt;&amp;&gt;, Cat&gt; &amp;&amp;
    <ins><i>weakly-equality-comparable-with</i>&lt;T, U&gt; &amp;&amp;</ins>
    <ins><i>partially-ordered-with</i>&lt;T, U&gt; &amp;&amp;</ins>
    requires(const remove_reference_t&lt;T&gt;&amp; t, const remove_reference_t&lt;U&gt;&amp; u) {
      { t &lt;=&gt; u } -&gt; <i>compares-as</i>&lt;Cat&gt;;
      { u &lt;=&gt; t } -&gt; <i>compares-as</i>&lt;Cat&gt;;
    };
</pre>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3361" href="3361">3361.</a> <tt>safe_range&lt;<i>SomeRange</i>&amp;></tt> case</h3>
<p><b>Section:</b> 24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2019-12-19 <b>Last modified:</b> 2020-01-14 11:35:57 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
24.5.4 <a href="https://timsong-cpp.github.io/cppwp/range.dangling">[range.dangling]</a> p2 hints at how <tt>safe_range</tt> should allow lvalue ranges to model it. 
However, its wording doesn't take into account that case.
</p>

<p><i>[2020-01 Priority set to 3 after review on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.4.2 <a href="https://timsong-cpp.github.io/cppwp/range.range">[range.range]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class T&gt;
  concept safe_range =
    range&lt;T&gt; &amp;&amp;
      (is_lvalue_reference_v&lt;T&gt; || enable_safe_range&lt;remove_cvref_t&lt;T&gt;&gt;);
</pre>
<blockquote>
<p>
-5- <del>Given an expression <tt>E</tt> such that <tt>decltype((E))</tt> is <tt>T</tt>,</del><ins>A type</ins> 
<tt>T</tt> models <tt>safe_range</tt> <del>only</del> <ins>if:</ins>
<ol style="list-style-type: none">
<li><p><ins>(5.1) &mdash; <tt>is_lvalue_reference_v&lt;T&gt;</tt> is <tt>true</tt>, or</ins></p></li>
<li><p><ins>(5.2) &mdash; given an expression <tt>E</tt> such that <tt>decltype((E))</tt> is <tt>T</tt>,</ins>
<del>if</del> the validity of iterators obtained from the object denoted by <tt>E</tt> is not tied to the lifetime of 
that object.</p></li>
</ol>
<p/>
-6- [<i>Note:</i> <del>Since the validity of iterators is not tied to the lifetime of an object 
whose type models <tt>safe_range</tt>, a</del><ins>A</ins> function can accept arguments of <del>such</del> a 
type <ins>that models <tt>safe_range</tt></ins> <del>by value</del> and return iterators obtained from it 
without danger of dangling. &mdash; <i>end note</i>]
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3362" href="3362">3362.</a> Strike <tt>stop_source</tt>'s <tt>operator!=</tt></h3>
<p><b>Section:</b> 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-03 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Just like <tt>stop_token</tt> (see LWG <a href="3254">3254</a>), <tt>stop_source</tt> in 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a>
declares an <tt>operator!=</tt> friend that is unnecessary in light of the new core language rules and 
should be struck.
</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 32.3.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource">[stopsource]</a>, class <tt>stop_source</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  [&hellip;]

  class stop_source {
  public:
    [&hellip;]

    [[nodiscard]] friend bool
    operator==(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;
    <del>[[nodiscard]] friend bool
    operator!=(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;</del>
    friend void swap(stop_source&amp; lhs, stop_source&amp; rhs) noexcept;
  };
}
</pre>
</blockquote>

</li>

<li><p>Modify 32.3.4.3 <a href="https://timsong-cpp.github.io/cppwp/stopsource.cmp">[stopsource.cmp]</a> and 32.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/stopsource.special">[stopsource.special]</a> as indicated:</p>

<blockquote>
<p>
<b>32.3.4.3 <ins>Non-member functions</ins><del>Comparisons</del> [stopsource.<ins>nonmembers</ins><del>cmp</del>]</b>
</p>
<pre>
[[nodiscard]] bool operator==(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Returns:</i> <tt>true</tt> if <tt>lhs</tt> and <tt>rhs</tt> have ownership of the same stop
state or if both <tt>lhs</tt> and <tt>rhs</tt> do not have ownership of a stop state; otherwise <tt>false</tt>.
</p>
</blockquote>
<pre>
<del>[[nodiscard]] bool operator!=(const stop_source&amp; lhs, const stop_source&amp; rhs) noexcept;</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Returns:</i> <tt>!(lhs==rhs)</tt>.</del>
</p>
</blockquote>
<p>
<del><b>32.3.4.4 Specialized algorithms [stopsource.special]</b></del>
</p>
<pre>
friend void swap(stop_source&amp; x, stop_source&amp; y) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to: <tt>x.swap(y)</tt>.
</p>
</blockquote>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3363" href="3363">3363.</a> <tt>drop_while_view</tt> should opt-out of <tt>sized_range</tt></h3>
<p><b>Section:</b> 24.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.while.view">[range.drop.while.view]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-02-12 03:28:55 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>If <tt>drop_while_view</tt>'s <tt>iterator_t</tt> and <tt>sentinel_t</tt>
model <tt>forward_iterator</tt> and <tt>sized_sentinel_for</tt>, it will 
incorrectly satisfy <tt>sized_range</tt> thanks to the size member function
inherited from <tt>view_interface</tt>.</p>

<p>Because it has to compute its <tt>begin()</tt>, it can never model 
<tt>sized_range</tt> due to not meeting its non-amortized O(1) requirement.</p>

<p><i>[2020-01-16 Priority set to 1 after discussion on the reflector.]</i></p>


<p><i>[2020-02-10; Prague 2020; Casey comments and provides alternative wording]</i></p>

<p>
The fundamental issue here is that both <tt>ranges::size</tt> and <tt>view_interface::size</tt> 
(it should be unsurprising that many of the "default" implementations of member <tt>meow</tt> in 
<tt>view_interface</tt> look just like fallback cases of the <tt>ranges::meow</tt> CPO) have 
a case that returns the difference of <tt>ranges::end</tt> and <tt>ranges::begin</tt>. If 
<tt>begin</tt> and <tt>end</tt> are amortized* O(1) but not "true" O(1), then the resulting 
<tt>size</tt> operation is amortized O(1) and not "true" O(1) as required by the 
<tt>sized_range</tt> concept. I don't believe we can or should fix this on a case by case basis,
but we should instead relax the complexity requirement for <tt>sized_range</tt> to be 
handwavy-amortized O(1).
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/N4849">N4849</a>.</p>

<ol>
<li><p>Add the following specialization to 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>:</p>

<blockquote>
<pre>
// [drop.while.view], drop while view
  template&lt;view V, class Pred&gt;
    requires input_range&lt;V&gt; &amp;&amp; is_object_v&lt;Pred&gt; &amp;&amp;
      indirect_unary_predicate&lt;const Pred, iterator_t&lt;V&gt;&gt;
    class drop_while_view;

<ins>
  template&lt;view V, class Pred&gt;
    inline constexpr bool disable_sized_range&lt;drop_while_view&lt;V, Pred&gt;&gt; = true;
</ins>

  namespace views { inline constexpr unspecified drop_while = unspecified; }
</pre>
</blockquote>

</li>
</ol>
</blockquote>

<p><i>[2020-02 Moved to Immediate on Tuesday in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/N4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a> as indicated:</p>

<blockquote>
<p>
-2- Given an lvalue <tt>t</tt> of type <tt>remove_reference_t&lt;T&gt;</tt>, <tt>T</tt> models 
<tt>sized_range</tt> only if
</p>
<ol style="list-style-type: none"> 
<li><p>(2.1) &mdash; <tt>ranges::size(t)</tt> is <ins>amortized</ins> &#x1d4aa;(<tt>1</tt>), does not modify <tt>t</tt>, 
and is equal to <tt>ranges::distance(t)</tt>, and</p></li>
<li><p>[&hellip;]</p></li>
</ol>
<p>
<del>-3- [<i>Note:</i> The complexity requirement for the evaluation of <tt>ranges::size</tt> is non-amortized, unlike the
case for the complexity of the evaluations of <tt>ranges::begin</tt> and <tt>ranges::end</tt> in the <tt>range</tt> concept.
&mdash; <i>end note</i>]</del>
</p>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3364" href="3364">3364.</a> Initialize data members of ranges and their iterators</h3>
<p><b>Section:</b> 24.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.while.view">[range.take.while.view]</a>, 24.7.8.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.view">[range.drop.view]</a>, 24.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.while.view">[range.drop.while.view]</a>, 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#range.take.while.view">issues</a> in [range.take.while.view].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>Before <a href="http://wg21.link/p1035">P1035</a> was accepted, no data member in [ranges] whose type could
potentially be an aggregate or fundamental type was left without initializer. P1035 left some such data members 
without initializer, so it is possible to have them have indeterminate values. We propose restoring consistency.</p>

<p><i>[2020-01-14 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/N4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.7.7.2 <a href="https://timsong-cpp.github.io/cppwp/range.take.while.view">[range.take.while.view]</a> as follows:</p>
<blockquote>
<pre>
class take_while_view : public view_interface&lt;take_while_view&lt;V, Pred&gt;&gt; {
  template&lt;bool&gt; class sentinel;                      <i>// exposition only</i>

  V base_ <ins>= V()</ins>;                                      <i>// exposition only</i>
  semiregular-box&lt;Pred&gt; pred_;                        <i>// exposition only</i>

public:
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.8.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.view">[range.drop.view]</a> as follows:</p>
<blockquote>
<pre>
private:
  V base_ <ins>= V()</ins>;                                     <i>// exposition only</i>
  range_difference_t&lt;V&gt; count_ <ins>= 0</ins>;                  <i>// exposition only</i>
};
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.9.2 <a href="https://timsong-cpp.github.io/cppwp/range.drop.while.view">[range.drop.while.view]</a> as follows:</p>
<blockquote>
<pre>
private:
  V base_ <ins>= V()</ins>;                                     <i>// exposition only</i>
  semiregular-box&lt;Pred&gt; pred_;                       <i>// exposition only</i>
};
</pre>
</blockquote>
</li>

<li><p>Modify 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> as follows:</p>
<blockquote>
<pre>
class elements_view&lt;V, N&gt;::iterator {                <i>// exposition only</i>
  using base-t = conditional_t&lt;Const, const V, V&gt;;
  friend iterator&lt;!Const&gt;;

  iterator_t&lt;base-t&gt; current_ <ins>= iterator_t&lt;base-t&gt;()</ins>;
public:
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3365" href="3365">3365.</a> Rename <i>ref-is-glvalue</i> to <i>deref-is-ref</i></h3>
<p><b>Section:</b> 24.7.10.3 <a href="https://timsong-cpp.github.io/cppwp/range.join.iterator">[range.join.iterator]</a> <b>Status:</b> <a href="lwg-active.html#NAD">Tentatively NAD</a>
 <b>Submitter:</b> Johel Ernesto Guerrero Pe&ntilde;a <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-01-14 12:16:29 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.join.iterator">active issues</a> in [range.join.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.join.iterator">issues</a> in [range.join.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively NAD">Tentatively NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>The name of <i>join_view::iterator::ref-is-glvalue</i>, defined as 
<tt>is_reference_v&lt;range_reference_t&lt;Base&gt;&gt;</tt>, doesn't take into account 
the fact that it may also be true because <tt>range_reference_t&lt;Base&gt;</tt>
is an rvalue (e.g. for <tt>move_iterator&lt;int&gt;</tt>).</p>

<p>We suggest renaming it to <i>deref-is-ref</i>.</p>

<p><i>[2020-01-14 Status set to Tentatively NAD after five positive votes on the reflector. 
This issue was based on a misunderstanding by the submitter which had been cleared up in an 
<a href="https://github.com/cplusplus/draft/issues/3610">related editorial issue</a>.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>Rename all occurrences referring to the symbol 
<i>join_view::iterator::ref-is-glvalue</i> to <i>deref-is-ref</i>.</p>





<hr>
<h3><a name="3366" href="3366">3366.</a> Narrowing conversions between integer and integer-class types</h3>
<p><b>Section:</b> 23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-01-25 14:45:08 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.concept.winc">active issues</a> in [iterator.concept.winc].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.concept.winc">issues</a> in [iterator.concept.winc].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The working draft ignores the possibility that:
</p>
<ol>
<li><p>the value of an expression of integer-class type might not be representable by the target 
integer type of a conversion, and</p></li>
<li><p>the value of an expression of integer type might not be representable by the target 
integer-class type of a conversion.</p></li>
</ol>
<p>
Presumably the behavior of these cases is undefined by omission; is this actually the intent?   
<p/>
Notably (2) could be specified away by mandating that all integer-class types are capable of 
representing the value range of all integer types of the same signedness.
</p>

<p><i>[2020-01-25 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3367" href="3367">3367.</a> Integer-class conversions should not throw</h3>
<p><b>Section:</b> 23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.concept.winc">active issues</a> in [iterator.concept.winc].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.concept.winc">issues</a> in [iterator.concept.winc].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It's widely established that neither conversions of integral types to <tt>bool</tt> nor conversions 
between different integral types throw exceptions. These properties are crucial to supporting exception 
guarantees in algorithms, containers, and other uses of iterators and their difference types. 
Integer-class types must provide the same guarantees to support the same use cases as do integer types.
</p>

<p><i>[2020-01-14; Daniel comments]</i></p>

<ol>
<li><p>We probably need to think about providing the stronger guarantee that all integer-class operations 
are also <tt>noexcept</tt> in addition to the guarantee that they do not throw any exceptions.</p></li>
<li><p>The fixed wording in LWG <a href="3358">3358</a>, 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> p9 depends on the no-throw-guarantee 
of integer-class conversions to integral types.</p></li>
</ol>

<p><i>[2020-01-25 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> There's a bit of drive-by editing here to change occurrences of the meaningless 
"type is convertible to type" to "expression is convertible to type". Paragraph 7 only has drive-by edits. ]
</p>
</blockquote>

<blockquote>
<p>
-6- <del>All</del><ins>Expressions of</ins> integer-class type<del>s</del> are explicitly convertible to 
<del>all</del><ins>any</ins> integral type<del>s and</del><ins>. Expressions of integral type are both</ins>
implicitly and explicitly convertible <del>from all integral types</del><ins>to any integer-class type. 
Conversions between integral and integer-class types do not exit via an exception</ins>.
<p/>
-7- <del>All</del><ins>Expressions <tt><i>E</i></tt> of</ins> integer-class type<del>s</del> <ins><tt>I</tt></ins> 
are contextually convertible to <tt>bool</tt> as if by <tt>bool(<del>a</del><ins><i>E</i></ins> != I(0))</tt><del>, 
where <tt>a</tt> is an instance of the integral-class type <tt>I</tt></del>.
</p>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3368" href="3368">3368.</a> Exactly when does <tt>size</tt> return <tt>end - begin</tt>?</h3>
<p><b>Section:</b> 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-07 <b>Last modified:</b> 2020-01-25 12:29:23 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>Discussion:</b></p>
<p>
The specification of <tt>ranges::size</tt> in 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a> suggests that bullet 1.3 
("Otherwise, <tt><i>make-unsigned-like</i>(ranges::end(E) - ranges::begin(E)) ...")</tt> only applies 
when <tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> is <tt>true</tt>. This is not the 
design intent, but the result of an erroneous attempt to factor out the common 
"<tt>disable_sized_range</tt> is <tt>false</tt>" requirement from the member and non-member <tt>size</tt> 
cases in bullets 1.2.1 and 1.2.2 that occurred between <a href="http://wg21.link/p0896r3">P0896R3</a> and 
<a href="http://wg21.link/p0896r4">P0896R4</a>. The intended design has always been that a range with 
member or non-member <tt>size</tt> with the same syntax but different semantics may opt-out of being 
sized by specializing <tt>disable_sized_range</tt>. It has never been intended that arrays or ranges 
whose iterator and sentinel model <tt>sized_sentinel_for</tt> be able to opt out of being sized via 
<tt>disable_sized_range</tt>. <tt>disable_sized_sentinel_for</tt> can/must be used to opt out in the 
latter case so that library functions oblivious to the range type that operate on the iterator and 
sentinel of such a range will avoid subtraction.
</p>

<p><i>[2020-01-25 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.3.9 <a href="https://timsong-cpp.github.io/cppwp/range.prim.size">[range.prim.size]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> There are drive-by changes here to (1) avoid introducing unused type placeholders, 
(2) avoid reusing "<tt>T</tt>" as both the type of the subexpression and the template parameter of the 
poison pill, and (3) fix the cross-reference for <tt><i>make-unsigned-like</i></tt> which is defined in 
[ranges.syn]/1, not in [range.subrange].]
</p>
</blockquote>

<blockquote>
<p>
-1- The name <tt>size</tt> denotes a customization point object (16.4.2.2.6 <a href="https://timsong-cpp.github.io/cppwp/customization.point.object">[customization.point.object]</a>). 
The expression <tt>ranges::size(E)</tt> for some subexpression <tt>E</tt> with type <tt>T</tt> is 
expression-equivalent to:
</p>
<ol style="list-style-type: none">
<li><p>(1.1) &mdash; <tt><i>decay-copy</i>(extent_v&lt;T&gt;)</tt> if <tt>T</tt> is an array type 
(6.8.2 <a href="https://timsong-cpp.github.io/cppwp/basic.compound">[basic.compound]</a>).</p></li>
<li><p><del>(1.2) &mdash; Otherwise, if <tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> 
(24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a>) is <tt>false</tt>:</del></p>
<li><p>(1.<ins>?</ins><del>2.1</del>) &mdash; <ins>Otherwise, if 
<tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> (24.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.sized">[range.sized]</a>) is <tt>false</tt> 
and</ins> <tt><i>decay-copy</i>(E.size())</tt> <del>if it</del> is a valid expression <del>and its 
type <tt>I</tt> is</del><ins>of</ins> integer-like <ins>type</ins> 
(23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a>)<ins>, <tt><i>decay-copy</i>(E.size())</tt></ins>.</p></li>
<li><p>(1.<ins>?</ins><del>2.2</del>) &mdash; Otherwise, <ins>if 
<tt>disable_sized_range&lt;remove_cv_t&lt;T&gt;&gt;</tt> is <tt>false</tt> and</ins>
<tt><i>decay-copy</i>(size(E))</tt> <del>if it</del> is a valid expression <del>and its type 
<tt>I</tt> is</del><ins>of</ins> integer-like <ins>type</ins> with overload resolution performed in a 
context that includes the declaration:
<blockquote><pre>
<del>template&lt;class T&gt;</del> void size(<del>T</del><ins>auto</ins>&amp;&amp;) = delete;
</pre></blockquote>
and does not include a declaration of <tt>ranges::size</tt><ins>, <tt><i>decay-copy</i>(size(E))</tt></ins>.</p></li>
</li>
<li><p>(1.3) &mdash; Otherwise, <tt><i>make-unsigned-like</i>(ranges::end(E) - ranges::begin(E))</tt> 
(<del>24.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.subrange">[range.subrange]</a></del><ins>24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a></ins>) if it is a valid 
expression and the types <tt>I</tt> and <tt>S</tt> of 
<tt>ranges::begin(E)</tt> and <tt>ranges::end(E)</tt> (respectively) model both
<tt>sized_sentinel_for&lt;S, I&gt;</tt> (23.3.4.8 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.sizedsentinel">[iterator.concept.sizedsentinel]</a>) and 
<tt>forward_iterator&lt;I&gt;</tt>. However, <tt>E</tt> is evaluated only once.
</p></li>
<li><p>(1.4) &mdash; [&hellip;]</p></li>
</ol>
</blockquote>

</li>
</ol>





<hr>
<h3><a name="3369" href="3369">3369.</a> <tt>span</tt>'s deduction-guide for built-in arrays doesn't work</h3>
<p><b>Section:</b> 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2020-01-08 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#span.overview">active issues</a> in [span.overview].</p>
<p><b>View all other</b> <a href="lwg-index.html#span.overview">issues</a> in [span.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/n4842">N4842</a> 22.7.3.1 [span.overview] depicts:
</p>
<blockquote><pre>
template&lt;class T, size_t N&gt;
span(T (&amp;)[N]) -&gt; span&lt;T, N&gt;;
</pre></blockquote> 
<p>
This isn't constrained by 22.7.3.3 [span.deduct]. Then, 22.7.3.2 [span.cons]/10 
specifies:
</p>
<blockquote><pre>
template&lt;size_t N&gt; constexpr span(element_type (&amp;arr)[N]) noexcept;
template&lt;size_t N&gt; constexpr span(array&lt;value_type, N&gt;&amp; arr) noexcept;
template&lt;size_t N&gt; constexpr span(const array&lt;value_type, N&gt;&amp; arr) noexcept;
</pre>
<blockquote>
<p>
<i>Constraints:</i>
</p>
<ul>
<li><p><tt>extent == dynamic_extent || N == extent</tt> is <tt>true</tt>, and</p></li>
<li><p><tt>remove_pointer_t&lt;decltype(data(arr))&gt;(*)[]</tt> is convertible to 
<tt>ElementType(*)[]</tt>.</p></li>
</ul>
</blockquote>
</blockquote>
<p>
Together, these cause CTAD to behave unexpectedly. Here's a minimal test case, reduced from libcxx's 
test suite:
</p>
<blockquote><pre>
C:\Temp&gt;type span_ctad.cpp
#include &lt;stddef.h&gt;
#include &lt;type_traits&gt; 

inline constexpr size_t dynamic_extent = static_cast&lt;size_t&gt;(-1);

template &lt;typename T, size_t Extent = dynamic_extent&gt;
struct span {
  template &lt;size_t Size&gt;
  requires (Extent == dynamic_extent || Extent == Size)
#ifdef WORKAROUND_WITH_TYPE_IDENTITY_T
  span(std::type_identity_t&lt;T&gt; (&amp;)[Size]) {}
#else
  span(T (&amp;)[Size]) {}
#endif
};

template &lt;typename T, size_t Extent&gt;
#ifdef WORKAROUND_WITH_REQUIRES_TRUE
requires (true)
#endif
span(T (&amp;)[Extent]) -&gt; span&lt;T, Extent&gt;;

int main() {
  int arr[] = {1,2,3};
  span s{arr};
  static_assert(std::is_same_v&lt;decltype(s), span&lt;int, 3&gt;&gt;,
    "CTAD should deduce span&lt;int, 3&gt;.");
}

C:\Temp&gt;cl /EHsc /nologo /W4 /std:c++latest span_ctad.cpp
span_ctad.cpp
span_ctad.cpp(26): error C2338: CTAD should deduce span&lt;int, 3&gt;.

C:\Temp&gt;cl /EHsc /nologo /W4 /std:c++latest /DWORKAROUND_WITH_TYPE_IDENTITY_T span_ctad.cpp
span_ctad.cpp

C:\Temp&gt;cl /EHsc /nologo /W4 /std:c++latest /DWORKAROUND_WITH_REQUIRES_TRUE span_ctad.cpp
span_ctad.cpp

C:\Temp&gt;
</pre></blockquote> 
<p>
(MSVC and GCC 10 demonstrate this behavior. Clang is currently affected by 
<a href="https://bugs.llvm.org/show_bug.cgi?id=44484">LLVM#44484</a>.)
<p/>
Usually, when there's an explicit deduction-guide, we can ignore any corresponding constructor, 
because the overload resolution tiebreaker 12.4.3 [over.match.best]/2.10 prefers deduction-guides. 
However, this is a mental shortcut only, and it's possible for guides generated from constructors 
to out-compete deduction-guides during CTAD. That's what's happening here.
<p/>
Specifically, the constructor is constrained, while the deduction-guide is not constrained. This 
activates the "more specialized" tiebreaker first (12.4.3 [over.match.best]/2.5 is considered before 
/2.10 for deduction-guides). That goes through 13.7.6.2 [temp.func.order]/2 and 13.5.4 [temp.constr.order] 
to prefer the more constrained overload.
<p/>
(In the test case, this results in <tt>span&lt;int, dynamic_extent&gt;</tt> being deduced. That's 
because the constructor allows <tt>T</tt> to be deduced to be <tt>int</tt>. The constructor's <tt>Size</tt> 
template parameter is deduced to be 3, but that's unrelated to the class's <tt>Extent</tt> parameter. 
Because <tt>Extent</tt> has a default argument of <tt>dynamic_extent</tt>, CTAD succeeds and deduces 
<tt>span&lt;int, dynamic_extent&gt;</tt>.)
<p/>
There are at least two possible workarounds: we could alter the constructor to prevent it from 
participating in CTAD, or we could constrain the deduction-guide, as depicted in the test case. Either 
way, we should probably include a Note, following the precedent of 21.3.2.2 [string.cons]/12.
<p/>
Note that there are also deduction-guides for span from <tt>std::array</tt>. However, the constructors 
take <tt>array&lt;value_type, N&gt;</tt> with <tt>using value_type = remove_cv_t&lt;ElementType&gt;;</tt> 
so that prevents the constructors from interfering with CTAD.
<p/>
I'm currently proposing to alter the constructor from built-in arrays. An alternative resolution to 
constrain the deduction-guide would look like: "<i>Constraints:</i> <tt>true</tt>. [<i>Note:</i> This 
affects class template argument deduction. &mdash; <i>end note</i>]"
</p>

<p><i>[2020-01-25 Status set to Tentatively Ready after seven positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 22.7.3.1 <a href="https://timsong-cpp.github.io/cppwp/span.overview">[span.overview]</a>, class template <tt>span</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
template&lt;class ElementType, size_t Extent = dynamic_extent&gt;
class span {
public:
  [&hellip;]
  <i>// 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a>, constructors, copy, and assignment</i>
  constexpr span() noexcept;
  [&hellip;]
  template&lt;size_t N&gt;
  constexpr span(<ins>type_identity_t&lt;</ins>element_type<ins>&gt;</ins> (&amp;arr)[N]) noexcept;
  [&hellip;]
};
[&hellip;]
</pre>
</blockquote>

</li>

<li><p>Modify 22.7.3.2 <a href="https://timsong-cpp.github.io/cppwp/span.cons">[span.cons]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;size_t N&gt; constexpr span(<ins>type_identity_t&lt;</ins>element_type<ins>&gt;</ins> (&amp;arr)[N]) noexcept;
template&lt;size_t N&gt; constexpr span(array&lt;value_type, N&gt;&amp; arr) noexcept;
template&lt;size_t N&gt; constexpr span(const array&lt;value_type, N&gt;&amp; arr) noexcept;
</pre>
<blockquote>
<p>
-10- <i>Constraints:</i>
<ol style="list-style-type: none">
<li><p>(10.1) &mdash; <tt>extent == dynamic_extent || N == extent</tt> is <tt>true</tt>, and</p></li>
<li><p>(10.2) &mdash; <tt>remove_pointer_t&lt;decltype(data(arr))&gt;(*)[]</tt> is convertible to 
<tt>ElementType(*)[]</tt>.</p></li>
</ol>
<p/>
-11- <i>Effects:</i> Constructs a <tt>span</tt> that is a view over the supplied array. <ins>[<i>Note:</i> 
<tt>type_identity_t</tt> affects class template argument deduction. &mdash; <i>end note</i>]</ins>
<p/>
-12- <i>Postconditions:</i> <tt>size() == N &amp;&amp; data() == data(arr)</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3370" href="3370">3370.</a> &sect;[cstdint.syn]p2 and &sect;[headers]p5 are not sufficiently clear</h3>
<p><b>Section:</b> 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>, 16.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/headers">[headers]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Dawid Pilarski <b>Opened:</b> 2020-01-14 <b>Last modified:</b> 2020-01-25 14:45:36 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#cstdint.syn">issues</a> in [cstdint.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This issue has been submitted, because the editorial change requests 
<a href="https://github.com/cplusplus/draft/issues/3521">c++-draft-issue 3521</a> and
<a href="https://github.com/cplusplus/draft/pull/3528">c++-draft-pull request 3528</a>
has been rejected as not being editorial changes:
</p>
<p>
Currently given wording of 17.4.1 <a href="https://timsong-cpp.github.io/cppwp/cstdint.syn">[cstdint.syn]</a>p2:
</p>
<blockquote><p>
The header defines all types and macros the same as the C standard library header <tt>&lt;stdint.h&gt;</tt>.
</p></blockquote>
<p>
might be understood as intended: typedefs inside <tt>stdint.h</tt> and inside <tt>cstdint</tt> in namespace 
<tt>std::</tt> refer to the same types, but another interpretation could be, that it's understood as:
<p/>
Definitions in both files are done the same way (<tt>cstdint</tt> provides typedefs not in namespace 
<tt>std</tt>, because it would be a different definition than one in <tt>stdint.h</tt>).
<p/>
Also 16.5.1.2 <a href="https://timsong-cpp.github.io/cppwp/headers">[headers]</a>p5 is non sufficiently clear:
</p>
<blockquote><p>
[&hellip;] the contents of each header <tt>c<i>name</i></tt> is the same as that of the corresponding header 
<tt><i>name</i>.h</tt> [&hellip;]
</p></blockquote>
<p>
As it doesn't say what does "same content" mean. For example is an implementation allowed to do following:
</p>
<blockquote><pre>
// __impl.h
typedef int __my_int;
namespace std { typedef long __my_int; }

// cname header
#include "__impl.h"

namespace std {
  typedef __my_int uint32_t;
}

// name.h header
#include "__impl.h"
typedef __my_int uint32_t;
</pre></blockquote>
<p>
? 
<p/>
In this case typedef from namespace <tt>std</tt> and from global namespace refer to different types?
<p/>
Proposed change:
<p/>
Apply wording, that will unambiguously make typedefs from namespace <tt>std</tt> refer to the same types 
as typedefs from global namespace for all headers <tt><i>name</i>.h</tt> and their corresponding headers 
<tt>c<i>name</i></tt>.
</p>

<p><i>[2020-01-25 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>

<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3371" href="3371">3371.</a> <tt>visit_format_arg</tt> and <tt>make_format_args</tt> are not hidden friends</h3>
<p><b>Section:</b> 20.20.5.1 <a href="https://timsong-cpp.github.io/cppwp/format.arg">[format.arg]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-16 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#format.arg">issues</a> in [format.arg].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
After <a href="https://wg21.link/P1965R0">P1965R0</a>, friend function and function template
declarations always introduce hidden friends under the new blanket wording in
16.5.5.6 <a href="https://timsong-cpp.github.io/cppwp/hidden.friends">[hidden.friends]</a>. However, 20.20.5.1 <a href="https://timsong-cpp.github.io/cppwp/format.arg">[format.arg]</a> contains
"exposition only" friend declarations of <tt>visit_format_arg</tt> and <tt>make_format_args</tt>,
and those are not intended to be hidden. The only reason to have these declarations in the first
place is because these function templates are specified using the exposition-only private data
members of <tt>basic_format_arg</tt>, but that's unnecessary &mdash; for example,
<tt>shared_ptr</tt>'s constructors are not exposition-only friends of <tt>enable_shared_from_this</tt>,
even though the former are shown as assigning to the latter's exposition-only <tt>weak_this</tt>
private data member (see 20.11.3.1 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.const">[util.smartptr.shared.const]</a>p1).
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Edit 20.20.5.1 <a href="https://timsong-cpp.github.io/cppwp/format.arg">[format.arg]</a>, class template <tt>basic_format_arg</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;class Context&gt;
  class basic_format_arg {

    [&hellip;]

<del>    template&lt;class Visitor, class Ctx&gt;
      friend auto visit_format_arg(Visitor&amp;&amp; vis,
                                   basic_format_arg&lt;Ctx&gt; arg);                  // <i>exposition only</i>

    template&lt;class Ctx, class... Args>
      friend <i>format-arg-store</i>&lt;Ctx, Args...&gt;
        make_format_args(const Args&amp;... args);                                  // <i>exposition only</i></del>

    [&hellip;]
  };
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3372" href="3372">3372.</a> <tt>vformat_to</tt> should not try to deduce <tt>Out</tt> twice</h3>
<p><b>Section:</b> 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-16 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#format.functions">active issues</a> in [format.functions].</p>
<p><b>View all other</b> <a href="lwg-index.html#format.functions">issues</a> in [format.functions].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>vformat_to</tt> currently deduces <tt>Out</tt> from its first and last arguments.
This requires its last argument's type to be a specialization of <tt>basic_format_args</tt>,
which notably prevents the use of <tt><i>format-arg-store</i></tt> arguments directly.
This is unnecessary: we should only deduce from the first argument.
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Edit 20.20.1 <a href="https://timsong-cpp.github.io/cppwp/format.syn">[format.syn]</a>, header <tt>&lt;format&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {

  [&hellip;]

  template&lt;class Out&gt;
    Out vformat_to(Out out, string_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, wstring_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, string_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, wstring_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);

  [&hellip;]
}
</pre>
</blockquote>
</li>
<li><p>Edit 20.20.3 <a href="https://timsong-cpp.github.io/cppwp/format.functions">[format.functions]</a> p8 through p10 as indicated:</p>

<blockquote>
<pre>
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, string_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, wstring_view fmt, const Args&amp;... args);
</pre>
<blockquote>
<p> -8- <i>Effects:</i> Equivalent to:</p>
<blockquote>
<pre>
using context = basic_format_context&lt;Out, decltype(fmt)::value_type&gt;;
return vformat_to(out, fmt, <del>{</del>make_format_args&lt;context&gt;(args...)<del>}</del>);
</pre>
</blockquote>
</blockquote>
<pre>
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, const locale&amp; loc, string_view fmt, const Args&amp;... args);
template&lt;class Out, class... Args&gt;
  Out format_to(Out out, const locale&amp; loc, wstring_view fmt, const Args&amp;... args);
</pre>
<blockquote>
<p> -9- <i>Effects:</i> Equivalent to:</p>
<blockquote>
<pre>
using context = basic_format_context&lt;Out, decltype(fmt)::value_type&gt;;
return vformat_to(out, loc, fmt, <del>{</del>make_format_args&lt;context&gt;(args...)<del>}</del>);
</pre>
</blockquote>
</blockquote>
<pre>
  template&lt;class Out&gt;
    Out vformat_to(Out out, string_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, wstring_view fmt, format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, string_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, char&gt; args);
  template&lt;class Out&gt;
    Out vformat_to(Out out, const locale&amp; loc, wstring_view fmt,
                   format_args_t&lt;<ins>type_identity_t&lt;</ins>Out<ins>&gt;</ins>, wchar_t&gt; args);
</pre>
<blockquote>
<p> -10- Let <tt>charT</tt> be <tt>decltype(fmt)::value_type</tt>.</p>
<p> [&hellip;] </p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3373" href="3373">3373.</a> <tt>{to,from}_chars_result</tt> and <tt>format_to_n_result</tt> need the
 "we really mean what we say" wording</h3>
<p><b>Section:</b> 20.19.1 <a href="https://timsong-cpp.github.io/cppwp/charconv.syn">[charconv.syn]</a>, 20.20.1 <a href="https://timsong-cpp.github.io/cppwp/format.syn">[format.syn]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-01-16 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#charconv.syn">issues</a> in [charconv.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
To ensure that <tt>to_chars_result</tt>, <tt>from_chars_result</tt>, and
<tt>format_to_n_result</tt> can be used in structured bindings, they need the
special wording we use to negate the general library permission to add private
data members and bases.
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after six positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Add a paragraph at the end of 20.19.1 <a href="https://timsong-cpp.github.io/cppwp/charconv.syn">[charconv.syn]</a> as follows:</p>

<blockquote>
<p>
-?- The types <tt>to_chars_result</tt> and <tt>from_chars_result</tt> have the
data members and special members specified above. They have no base classes or
members other than those specified.
</p>
</blockquote>
</li>

<li><p>Add a paragraph at the end of 20.20.1 <a href="https://timsong-cpp.github.io/cppwp/format.syn">[format.syn]</a> as follows:</p>

<blockquote>
<p>
-1- The class template <tt>format_to_n_result</tt> has the template parameters,
data members, and special members specified above. It has no base classes or
members other than those specified.
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3374" href="3374">3374.</a> P0653 + P1006 should have made the other <tt>std::to_address</tt> overload <tt>constexpr</tt></h3>
<p><b>Section:</b> 20.10.4 <a href="https://timsong-cpp.github.io/cppwp/pointer.conversion">[pointer.conversion]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2020-01-14 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
While reviewing some interactions with <a href="http://wg21.link/p0653">P0653</a> + 
<a href="http://wg21.link/p1006">P1006</a>, Billy discovered that one of the overloads was 
missing the <tt>constexpr</tt> tag. This might be a typo or a missed merge interaction between 
P0653 (which adds <tt>to_address</tt> with the pointer overload being <tt>constexpr</tt>) and 
P1006 (which makes <tt>pointer_traits::pointer_to constexpr</tt>). Mail was sent the LWG reflector, 
and Glen Fernandes, the author of P0653, indicates that this might have been an oversight.
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after seven positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 20.10.2 <a href="https://timsong-cpp.github.io/cppwp/memory.syn">[memory.syn]</a>, header <tt>&lt;memory&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<i>// 20.10.4 <a href="https://timsong-cpp.github.io/cppwp/pointer.conversion">[pointer.conversion]</a>, pointer conversion</i>
template&lt;class T&gt;
  constexpr T* to_address(T* p) noexcept;
template&lt;class Ptr&gt;
  <ins>constexpr</ins> auto to_address(const Ptr&amp; p) noexcept;
[&hellip;]
</pre>
</blockquote>
</li>

<li><p>Modify 20.10.4 <a href="https://timsong-cpp.github.io/cppwp/pointer.conversion">[pointer.conversion]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Ptr&gt; <ins>constexpr</ins> auto to_address(const Ptr&amp; p) noexcept;
</pre>
<blockquote>
<p>
-3- <i>Returns:</i> <tt>pointer_traits&lt;Ptr&gt;::to_address(p)</tt> if that expression is well-formed 
(see 20.10.3.3 <a href="https://timsong-cpp.github.io/cppwp/pointer.traits.optmem">[pointer.traits.optmem]</a>), otherwise <tt>to_address(p.operator-&gt;())</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3375" href="3375">3375.</a> <tt>decay</tt> in <tt>viewable_range</tt> should be <tt>remove_cvref</tt></h3>
<p><b>Section:</b> 24.4.5 <a href="https://timsong-cpp.github.io/cppwp/range.refinements">[range.refinements]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-14 <b>Last modified:</b> 2020-02-13 12:32:11 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.refinements">active issues</a> in [range.refinements].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.refinements">issues</a> in [range.refinements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The viewable_range concept is defined in 24.4.5 <a href="https://timsong-cpp.github.io/cppwp/range.refinements">[range.refinements]</a> as:
</p>
<blockquote>
<pre>
template&lt;class T&gt;
  concept viewable_range =
    range&lt;T&gt; &amp;&amp; (safe_range&lt;T&gt; || view&lt;decay_t&lt;T&gt;&gt;);
</pre>
</blockquote>
<p>
Since neither pointer types, array types, nor function types model <tt>view</tt>,
<tt>view&lt;decay_t&lt;T&gt;&gt;</tt> here could simplified to <tt>view&lt;remove_cvref_t&lt;T&gt;&gt;</tt>.
The use of <tt>decay_t</tt> is an artifact of the Ranges TS being based on C++14 which didn't have
<tt>remove_cvref_t</tt>. [Note that the proposed change is not purely editorial since the difference
is observable to subsumption.]
</p>

<p><i>[2020-02-01 Status set to Tentatively Ready after five positive votes on the reflector.]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.4.5 <a href="https://timsong-cpp.github.io/cppwp/range.refinements">[range.refinements]</a> as indicated:</p>

<blockquote>
<p>
-4- The <tt>viewable_range</tt> concept specifies the requirements of a <tt>range</tt> type that can be
converted to a <tt>view</tt> safely.
</p>
<pre>
template&lt;class T&gt;
  concept viewable_range =
    range&lt;T&gt; &amp;&amp; (safe_range&lt;T&gt; || view&lt;<del>decay_t</del><ins>remove_cvref</ins>&lt;T&gt;&gt;);
</pre>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-06 Casey provides a corrected P/R]</i></p>

<p>... in response to Jonathan's observation that <tt>remove_cvref&lt;T&gt;</tt> is both the wrong type <em>and</em> not what the
discussion argues for.</p>

<p><i>[2020-02 Status to Immediate on Thursday morning in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.4.5 <a href="https://timsong-cpp.github.io/cppwp/range.refinements">[range.refinements]</a> as indicated:</p>

<blockquote>
<p>
-4- The <tt>viewable_range</tt> concept specifies the requirements of a <tt>range</tt> type that can be
converted to a <tt>view</tt> safely.
</p>
<pre>
template&lt;class T&gt;
  concept viewable_range =
    range&lt;T&gt; &amp;&amp; (safe_range&lt;T&gt; || view&lt;<del>decay_t</del><ins>remove_cvref_t</ins>&lt;T&gt;&gt;);
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3376" href="3376">3376.</a> "integer-like class type" is too restrictive</h3>
<p><b>Section:</b> 23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2020-01-16 <b>Last modified:</b> 2020-02-08 12:01:24 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View other</b> <a href="lwg-index-open.html#iterator.concept.winc">active issues</a> in [iterator.concept.winc].</p>
<p><b>View all other</b> <a href="lwg-index.html#iterator.concept.winc">issues</a> in [iterator.concept.winc].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
23.3.4.4 <a href="https://timsong-cpp.github.io/cppwp/iterator.concept.winc">[iterator.concept.winc]</a> says:
</p>
<blockquote><p>
A type <tt>I</tt> is an <i>integer-class type</i> if it is in a set of implementation-defined class types 
that behave as integer types do, as defined in below.
</p></blockquote>
<p>
and
</p>
<blockquote><p>
A type <tt>I</tt> is integer-like if it models <tt>integral&lt;I&gt;</tt> or if it is an integer-class type.
</p></blockquote>
<p>
Some implementations support built-in integer types that do not necessarily model <tt>std::integral</tt>, 
e.g. with libstdc++ whether <tt>std::is_integral_v&lt;__int128&gt;</tt> is <tt>true</tt> depends whether 
"strict" or "extensions" mode is in use. Because <tt>__int128</tt> is not a class type, it can't be used 
as an integer-like type in strict mode (which effectively means it can't be used at all, to avoid unwanted 
ABI differences between modes).
<p/>
The requirement should be relaxed to permit non-class types which are integer-like but not one of the 
standard integer types (nor extended integer types). If we do that, the name "integer-like class type" 
should probably change.
</p>

<p><i>[2020-02-08 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3377" href="3377">3377.</a> <tt>elements_view::iterator</tt> befriends a specialization of itself</h3>
<p><b>Section:</b> 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-18 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The synopsis of the exposition-only class template <tt>elements_view::iterator</tt> in 
24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> includes the declaration "<tt>friend iterator&lt;!Const&gt;;</tt>". 
We typically don't depict such friend relationships in the Library specification, leaving the 
choice of how to implement access to private data from external sources to implementer magic. 
For consistency, we should strike this occurrence from <tt>elements_view::iterator</tt>.
</p>

<p><i>[2020-02-08 Status set to Tentatively Ready after ten positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a>, class template <tt>elements_view::iterator</tt> 
synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;class V, size_t N&gt;
  template&lt;bool Const&gt;
  class elements_view&lt;V, N&gt;::iterator { <i>// exposition only</i>
    using base_t = conditional_t&lt;Const, const V, V&gt;;
    <del>friend iterator&lt;!Const&gt;;</del>

    iterator_t&lt;base_t&gt; current_;
  public:
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3378" href="3378">3378.</a> <tt>tuple_size_v/tuple_element_t</tt> should be available when <tt>tuple_size/tuple_element</tt> are</h3>
<p><b>Section:</b> 20.5.2 <a href="https://timsong-cpp.github.io/cppwp/tuple.syn">[tuple.syn]</a>, 20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-17 <b>Last modified:</b> 2020-02-08 11:58:46 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a>/6 makes the <tt>const</tt>/<tt>volatile</tt>/<tt>const volatile</tt> partial 
specializations of <tt>tuple_size</tt> available when any of <tt>&lt;array&gt;</tt>, <tt>&lt;ranges&gt;</tt>, 
<tt>&lt;span&gt;</tt>, or <tt>&lt;utility&gt;</tt> is included. 20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a>/8 makes the 
<tt>const</tt>/<tt>volatile</tt>/<tt>const volatile</tt> partial specializations of <tt>tuple_element</tt> 
available when any of those same headers is included. This leads to a couple of problems:
</p>
<ol>
<li><p>For users of the Standard Library, it's not helpful to have these partial specializations of class 
templates available when the preferred interface &mdash; the variable template <tt>tuple_size_v</tt> and 
alias template <tt>tuple_element_t</tt> &mdash; are not.</p></li>
<li><p>For specifiers of the Standard Library, we must update two distinct yet identical lists of headers 
that make this same set of templates available when adding another header.</p></li></ol>
<p>
We could solve both of these problems by coalescing the two paragraphs into one and including the variable 
and alias template in the set of declarations made available by the pertinent (now single) list of headers.
</p>

<p><i>[2020-02-08 Issue Prioritization]</i></p>

<p>Priority to 3 after reflector discussion.</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4842">N4842</a>.</p>

<ol>
<li><p>Modify 20.5.2 <a href="https://timsong-cpp.github.io/cppwp/tuple.syn">[tuple.syn]</a>, header <tt>&lt;tuple&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  [&hellip;]

  <i>// 20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a>, tuple helper classes</i>
  template&lt;class T&gt; struct tuple_size; // not defined
  template&lt;class T&gt; struct tuple_size&lt;const T&gt;;
  template&lt;class T&gt; struct tuple_size&lt;volatile T&gt;;
  template&lt;class T&gt; struct tuple_size&lt;const volatile T&gt;;
  
  <ins>template&lt;class T&gt;
    inline constexpr size_t tuple_size_v = tuple_size&lt;T&gt;::value;</ins>
  <del>template&lt;class... Types&gt; struct tuple_size&lt;tuple&lt;Types...&gt;&gt;;</del>
  
  template&lt;size_t I, class T&gt; struct tuple_element; <i>// not defined</i>
  template&lt;size_t I, class T&gt; struct tuple_element&lt;I, const T&gt;;
  template&lt;size_t I, class T&gt; struct tuple_element&lt;I, volatile T&gt;;
  template&lt;size_t I, class T&gt; struct tuple_element&lt;I, const volatile T&gt;;
  
  <del>template&lt;size_t I, class... Types&gt;
    struct tuple_element&lt;I, tuple&lt;Types...&gt;&gt;;</del>
  
  template&lt;size_t I, class T&gt;
    using tuple_element_t = typename tuple_element&lt;I, T&gt;::type;
    
  <i>// 20.5.7 <a href="https://timsong-cpp.github.io/cppwp/tuple.elem">[tuple.elem]</a>, element access</i>
  <ins>template&lt;class... Types&gt; struct tuple_size&lt;tuple&lt;Types...&gt;&gt;;</ins>
  
  <ins>template&lt;size_t I, class... Types&gt;
    struct tuple_element&lt;I, tuple&lt;Types...&gt;&gt;;</ins>
  
  template&lt;size_t I, class... Types&gt;
    constexpr tuple_element_t&lt;I, tuple&lt;Types...&gt;&gt;&amp; get(tuple&lt;Types...&gt;&amp;) noexcept;
  template&lt;size_t I, class... Types&gt;
    constexpr tuple_element_t&lt;I, tuple&lt;Types...&gt;&gt;&amp;&amp; get(tuple&lt;Types...&gt;&amp;&amp;) noexcept;
  [&hellip;]
  
  <del><i>// 20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a>, tuple helper classes</i></del>
  <del>template&lt;class T&gt;
    inline constexpr size_t tuple_size_v = tuple_size&lt;T&gt;::value;</del>
}
</pre>
</blockquote>
</li>

<li><p>Modify 20.5.6 <a href="https://timsong-cpp.github.io/cppwp/tuple.helper">[tuple.helper]</a> as indicated:</p>

<blockquote>
<p>
<b>20.5.6 Tuple helper classes [tuple.helper]</b>
<p/>
<ins>-?- In addition to being available via inclusion of the <tt>&lt;tuple&gt;</tt> header, the entities 
defined in this subclause [tuple.helper] are available when any of the headers <tt>&lt;array&gt;</tt> 
(22.3.2 <a href="https://timsong-cpp.github.io/cppwp/array.syn">[array.syn]</a>), <tt>&lt;ranges&gt;</tt> (24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>), <tt>&lt;span&gt;</tt> 
(22.7.2 <a href="https://timsong-cpp.github.io/cppwp/span.syn">[span.syn]</a>), or <tt>&lt;utility&gt;</tt> (20.2.1 <a href="https://timsong-cpp.github.io/cppwp/utility.syn">[utility.syn]</a>) are included.</ins>
</p>
<pre>
template&lt;class T&gt; struct tuple_size;
</pre>
<blockquote>
<p>
-1- <i>Remarks:</i> All specializations of <tt>tuple_size</tt> shall meet the <i>Cpp17UnaryTypeTrait</i> 
requirements (20.15.1 <a href="https://timsong-cpp.github.io/cppwp/meta.rqmts">[meta.rqmts]</a>) with a base characteristic of <tt>integral_constant&lt;size_t, N&gt;</tt> 
for some <tt>N</tt>.
</p>
</blockquote>
<pre>
<del>template&lt;class... Types&gt;
  struct tuple_size&lt;tuple&lt;Types...&gt;&gt; : public integral_constant&lt;size_t, sizeof...(Types)&gt; { };

template&lt;size_t I, class... Types&gt;
  struct tuple_element&lt;I, tuple&lt;Types...&gt;&gt; {
    using type = TI;
  };</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Requires:</i> <tt>I &lt; sizeof...(Types)</tt>. The program is ill-formed if <tt>I</tt> is out of bounds.</del>
<p/>
<del>-3- <i>Type:</i> <tt>TI</tt> is the type of the <tt>I<sup>th</sup></tt> element of <tt>Types</tt>, where 
indexing is zero-based.</del>
</p>
</blockquote>
<pre>
template&lt;class T&gt; struct tuple_size&lt;const T&gt;;
template&lt;class T&gt; struct tuple_size&lt;volatile T&gt;;
template&lt;class T&gt; struct tuple_size&lt;const volatile T&gt;;
</pre>
<blockquote>
<p>
-4- Let <tt>TS</tt> denote <tt>tuple_size&lt;T&gt;</tt> of the <i>cv</i>-unqualified type <tt>T</tt>. 
If the expression <tt>TS::value</tt> is well-formed when treated as an unevaluated operand, then each 
of the three templates shall meet the <i>Cpp17UnaryTypeTrait</i> requirements (20.15.1 <a href="https://timsong-cpp.github.io/cppwp/meta.rqmts">[meta.rqmts]</a>) 
with a base characteristic of
<blockquote><pre>
integral_constant&lt;size_t, TS::value&gt;
</pre></blockquote>
Otherwise, they shall have no member value.
<p/>
-5- Access checking is performed as if in a context unrelated to <tt>TS</tt> and <tt>T</tt>. Only the 
validity of the immediate context of the expression is considered. [<i>Note:</i> The compilation of the 
expression can result in side effects such as the instantiation of class template specializations and 
function template specializations, the generation of implicitly-defined functions, and so on. Such side 
effects are not in the "immediate context" and can result in the program being ill-formed. &mdash; <i>end note</i>]
<p/>
<del>-6- In addition to being available via inclusion of the <tt>&lt;tuple&gt;</tt> header, the three 
templates are available when any of the headers <tt>&lt;array&gt;</tt> (22.3.2 <a href="https://timsong-cpp.github.io/cppwp/array.syn">[array.syn]</a>), 
<tt>&lt;ranges&gt;</tt> (24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>), <tt>&lt;span&gt;</tt> (22.7.2 <a href="https://timsong-cpp.github.io/cppwp/span.syn">[span.syn]</a>), 
or <tt>&lt;utility&gt;</tt> (20.2.1 <a href="https://timsong-cpp.github.io/cppwp/utility.syn">[utility.syn]</a>) are included.</del>
</p>
</blockquote>
<pre>
template&lt;size_t I, class T&gt; struct tuple_element&lt;I, const T&gt;;
template&lt;size_t I, class T&gt; struct tuple_element&lt;I, volatile T&gt;;
template&lt;size_t I, class T&gt; struct tuple_element&lt;I, const volatile T&gt;;
</pre>
<blockquote>
<p>
-7- Let <tt>TE</tt> denote <tt>tuple_element_t&lt;I, T&gt;</tt> of the <i>cv</i>-unqualified type <tt>T</tt>. 
Then each of the three templates shall meet the <i>Cpp17TransformationTrait</i> requirements 
(20.15.1 <a href="https://timsong-cpp.github.io/cppwp/meta.rqmts">[meta.rqmts]</a>) with a member typedef type that names the following type:
<ol style="list-style-type: none">
<li><p>(7.1) &mdash; for the first specialization, <tt>add_const_t&lt;TE&gt;</tt>,</p></li>
<li><p>(7.2) &mdash; for the second specialization, <tt>add_volatile_t&lt;TE&gt;</tt>, and</p></li>
<li><p>(7.3) &mdash; for the third specialization, <tt>add_cv_t&lt;TE&gt;</tt>.</p></li>
</ol>
<del>-8- In addition to being available via inclusion of the <tt>&lt;tuple&gt;</tt> header, the three 
templates are available when any of the headers <tt>&lt;array&gt;</tt> (22.3.2 <a href="https://timsong-cpp.github.io/cppwp/array.syn">[array.syn]</a>), 
<tt>&lt;ranges&gt;</tt> (24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>), <tt>&lt;span&gt;</tt> (22.7.2 <a href="https://timsong-cpp.github.io/cppwp/span.syn">[span.syn]</a>), 
or <tt>&lt;utility&gt;</tt> (20.2.1 <a href="https://timsong-cpp.github.io/cppwp/utility.syn">[utility.syn]</a>) are included.</del>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 20.5.7 <a href="https://timsong-cpp.github.io/cppwp/tuple.elem">[tuple.elem]</a> as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> Since this issue performs colliding text changes with 
<a href="https://wg21.link/p1460r0">P1460R0</a>, we perform similar wording changes as suggested
on <a href="https://wg21.link/p1460r0#page=19">page 19 [tuple.helper] p2</a>.]
</p>
</blockquote>

<blockquote>
<p>
<b>20.5.7 Element access [tuple.elem]</b>
</p>
<pre>
<ins>template&lt;class... Types&gt;</ins>
  <ins>struct tuple_size&lt;tuple&lt;Types...&gt;&gt; : public integral_constant&lt;size_t, sizeof...(Types)&gt; { };</ins>

<ins>template&lt;size_t I, class... Types&gt;</ins>
  <ins>struct tuple_element&lt;I, tuple&lt;Types...&gt;&gt; {</ins>
    <ins>using type = TI;</ins>
  <ins>};</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Mandates:</i> <tt>I &lt; sizeof...(Types)</tt>.</ins>
<p/>
<ins>-?- Type: <tt>TI</tt> is the type of the <tt>I<sup>th</sup></tt> element of <tt>Types</tt>, where 
indexing is zero-based.</ins>
</p>
</blockquote>
<pre>
template&lt;size_t I, class... Types&gt;
  constexpr tuple_element_t&lt;I, tuple&lt;Types...&gt;&gt;&amp;
    get(tuple&lt;Types...&gt;&amp; t) noexcept;
[&hellip;]
</pre>
<blockquote>
<p>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3379" href="3379">3379.</a> "<tt>safe</tt>" in several library names is misleading</h3>
<p><b>Section:</b> 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-21 <b>Last modified:</b> 2020-02-13 18:18:33 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#ranges.syn">active issues</a> in [ranges.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#ranges.syn">issues</a> in [ranges.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Various WG21 members have commented that the use of "safe" in the names <tt>safe_range</tt>, 
<tt>enable_safe_range</tt>, <tt>safe_iterator_t</tt>, and <tt>safe_subrange_t</tt> to mean "fairly 
unlikely to produce dangling iterators" is inappropriate. The term "safe" has very strong 
connotations in some application domains, and these names don't intend such connotations. We 
could avoid confusion by changing these names to avoid the use of "safe". The Ranges Illuminati 
has deemed "borrowed" to be more appropriate: it reflects the fact that such ranges often 
"borrow" iterators from an adapted range which allows them to not be lifetime-bound to the 
adapting range.
</p>

<p><i>[2020-02-08 Issue Prioritization]</i></p>

<p>Priority to 1 after reflector discussion. This issue needs to be looked at by LEWG.</p>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Set to Immediate.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li>
<p>
Replace all occurrences of <tt>safe_range</tt>, <tt>enable_safe_range</tt>, <tt>safe_iterator_t</tt>, 
and <tt>safe_subrange_t</tt> in the working draft with <tt>borrowed_range</tt>, <tt>enable_borrowed_range</tt>, <tt>borrowed_iterator_t</tt>, and <tt>borrowed_subrange_t</tt>. 
</p>
</li>
</ol>





<hr>
<h3><a name="3380" href="3380">3380.</a> <tt>common_type</tt> and comparison categories</h3>
<p><b>Section:</b> 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-23 <b>Last modified:</b> 2020-02-14 06:37:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#meta.trans.other">active issues</a> in [meta.trans.other].</p>
<p><b>View all other</b> <a href="lwg-index.html#meta.trans.other">issues</a> in [meta.trans.other].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
There are two paragraphs in the the definition of <tt>common_type</tt>:
</p>
<ul>
<li><p>Otherwise, if both <tt>D1</tt> and <tt>D2</tt> denote comparison category types 
(17.11.2.1 <a href="https://timsong-cpp.github.io/cppwp/cmp.categories.pre">[cmp.categories.pre]</a>), let <tt>C</tt> denote the common comparison type 
(11.11.3 <a href="https://timsong-cpp.github.io/cppwp/class.spaceship">[class.spaceship]</a>) of <tt>D1</tt> and <tt>D2</tt>.</p></li>
<li><p>Otherwise, if <tt>decay_t&lt;decltype(false ? declval&lt;D1&gt;() : declval&lt;D2&gt;())&gt;</tt> 
denotes a valid type, let <tt>C</tt> denote that type.</p></li>
</ul>
<p>
<a href="https://wg21.link/p1614r2">P1614R2</a> added the first bullet so that 
<tt>common_type_t&lt;strong_equality, T&gt;</tt> would be the same type as 
<tt>common_comparison_category_t&lt;strong_equality, T&gt;</tt>; other cases are correctly handled 
by the second (pre-existing) bullet. After application of <a href="https://wg21.link/p1959r0">P1959R0</a> 
in Belfast, <tt>std::strong_equality</tt> is no more. We can now strike the first bullet without 
changing the behavior of <tt>common_type</tt>.
</p>

<p><i>[2020-02-08 Status set to Tentatively Ready after seven positive votes on the reflector.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.15.7.6 <a href="https://timsong-cpp.github.io/cppwp/meta.trans.other">[meta.trans.other]</a> as indicated:</p>

<blockquote>
<p>
-3- Note A: For the <tt>common_type</tt> trait applied to a template parameter pack <tt>T</tt> of types, 
the member <tt>type</tt> shall be either defined or not present as follows:
</p>
<ol style="list-style-type: none">
<li><p>(3.1) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
<li><p>(3.3) &mdash; If <tt>sizeof...(T)</tt> is two, let the first and second types constituting <tt>T</tt> 
be denoted by <tt>T1</tt> and <tt>T2</tt>, respectively, and let <tt>D1</tt> and <tt>D2</tt> denote the 
same types as <tt>decay_t&lt;T1&gt;</tt> and <tt>decay_t&lt;T2&gt;</tt>, respectively.</p>
<ol style="list-style-type: none">
<li><p>(3.3.1) &mdash; If <tt>is_same_v&lt;T1, D1&gt;</tt> is <tt>false</tt> or <tt>is_same_v&lt;T2, D2&gt;</tt> 
is <tt>false</tt>, let <tt>C</tt> denote the same type, if any, as <tt>common_type_t&lt;D1, D2&gt;</tt>.</p></li>
<li><p>(3.3.2) &mdash; [<i>Note:</i> None of the following will apply if there is a specialization 
<tt>common_type&lt;D1, D2&gt;</tt>. &mdash; <i>end note</i>]</p></li>
<li><p><del>(3.3.3) &mdash; Otherwise, if both <tt>D1</tt> and <tt>D2</tt> denote comparison category types 
(17.11.2.1 <a href="https://timsong-cpp.github.io/cppwp/cmp.categories.pre">[cmp.categories.pre]</a>), let <tt>C</tt> denote the common comparison type 
(11.11.3 <a href="https://timsong-cpp.github.io/cppwp/class.spaceship">[class.spaceship]</a>) of <tt>D1</tt> and <tt>D2</tt>.</del></p></li>
<li><p>(3.3.4) &mdash; Otherwise, if</p>
<blockquote><pre>
decay_t&lt;decltype(false ? declval&lt;D1&gt;() : declval&lt;D2&gt;())>
</pre></blockquote>
<p>
denotes a valid type, let <tt>C</tt> denote that type.</p></li>
<li><p>(3.3.5) &mdash; [&hellip;]</p></li>
</ol>
</li>
<li><p>[&hellip;]</p></li>
</ol>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3381" href="3381">3381.</a> <tt>begin</tt> and <tt>data</tt> must agree for <tt>contiguous_range</tt></h3>
<p><b>Section:</b> 24.4.5 <a href="https://timsong-cpp.github.io/cppwp/range.refinements">[range.refinements]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2020-01-25 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.refinements">active issues</a> in [range.refinements].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.refinements">issues</a> in [range.refinements].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The definition of the <tt>contiguous_range</tt> concept in 24.4.5 <a href="https://timsong-cpp.github.io/cppwp/range.refinements">[range.refinements]</a>/2 
requires that <tt>ranges::data(r)</tt> be valid for a <tt>contiguous_range r</tt>, but fails to 
impose the obvious semantic requirement that <tt>to_address(ranges::begin(r)) == ranges::data(r)</tt>. 
In other words, <tt>data</tt> and <tt>begin</tt> must agree so that <tt>[begin(r), end(r))</tt> and 
the counted range <tt>data(r) + [0, size(r))</tt> (this is the new "counted range" specification 
syntax per <a href="https://github.com/cplusplus/draft/issues/2932">working draft issue 2932</a>) denote 
the same sequence of elements.
</p>

<p><i>[2020-02 Prioritized as IMMEDIATE Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.4.5 <a href="https://timsong-cpp.github.io/cppwp/range.refinements">[range.refinements]</a> as indicated:</p>

<blockquote>
<p>
-2- <tt>contiguous_range</tt> additionally requires that the <tt>ranges::data</tt> customization point 
(24.3.11 <a href="https://timsong-cpp.github.io/cppwp/range.prim.data">[range.prim.data]</a>) is usable with the range.
</p>
<pre>
template&lt;class T&gt;
  concept contiguous_range =
    random_access_range&lt;T&gt; &amp;&amp; contiguous_iterator&lt;iterator_t&lt;T&gt;&gt; &amp;&amp;
    requires(T&amp; t) {
      { ranges::data(t) } -&gt; same_as&lt;add_pointer_t&lt;range_reference_t&lt;T&gt;&gt;&gt;;
    };
</pre>
<p>
<ins>-?- Given an expression <tt>t</tt> such that <tt>decltype((t))</tt> is <tt>T&amp;</tt>, <tt>T</tt> 
models <tt>contiguous_range</tt> only if <tt>(to_address(ranges::begin(t)) == ranges::data(t))</tt>.</ins>
<p/>
-3- The <tt>common_range</tt> concept [&hellip;]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3382" href="3382">3382.</a> NTTP for <tt>pair</tt> and <tt>array</tt></h3>
<p><b>Section:</b> 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a>, 22.3.7 <a href="https://timsong-cpp.github.io/cppwp/array">[array]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2020-01-27 <b>Last modified:</b> 2020-02-13 22:32:13 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#pairs.pair">active issues</a> in [pairs.pair].</p>
<p><b>View all other</b> <a href="lwg-index.html#pairs.pair">issues</a> in [pairs.pair].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
We had <a href="https://github.com/cplusplus/nbballot/issues/235">this NB ballot issue</a>, to ensure that 
<tt>std::array</tt> could be a NTTP. But after <a href="https://wg21.link/p1907">P1907</a>, we still need 
some kind of wording to ensure that <tt>std::array</tt> (and also <tt>std::pair</tt>) have no extra 
private members or base classes.
<p/>
This is similar to LWG <a href="3373">3373</a> &mdash; maybe we just need to add:
</p>
<blockquote><p>
The class template <tt>pair</tt>/<tt>array</tt> has the data members specified above. It has no base 
classes or data members other than those specified.
</p></blockquote>

<p><i>[2020-02 Prioritized as P2 Monday morning in Prague]</i></p>


<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> as indicated:</p>

<blockquote>
<p>
-1- Constructors and member functions of <tt>pair</tt> do not throw exceptions unless one of the element-wise 
operations specified to be called for that operation throws an exception.
<p/>
-2- The defaulted move and copy constructor, respectively, of <tt>pair</tt> is a constexpr function if and 
only if all required element-wise initializations for copy and move, respectively, would satisfy the 
requirements for a constexpr function.
<p/>
-3- If <tt>(is_trivially_destructible_v&lt;T1&gt; &amp;&amp; is_trivially_destructible_v&lt;T2&gt;)</tt> 
is <tt>true</tt>, then the destructor of <tt>pair</tt> is trivial.
<p/>
<ins>-?- The class template <tt>pair</tt> has the data members specified above. It has no base classes or 
data members other than those specified.</ins>
</p>
</blockquote>
</li>

<li><p>Modify 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> as indicated:</p>

<blockquote>
<p>
-1- The header <tt>&lt;array&gt;</tt> defines a class template for storing fixed-size sequences of objects. 
An <tt>array</tt> is a contiguous container (22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>). An instance of 
<tt>array&lt;T, N&gt;</tt> stores <tt>N</tt> elements of type <tt>T</tt>, so that <tt>size() == N</tt> is 
an invariant.
<p/>
-2- An <tt>array</tt> is an aggregate (9.4.1 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.aggr">[dcl.init.aggr]</a>) that can be list-initialized with up 
to <tt>N</tt> elements whose types are convertible to <tt>T</tt>.
<p/>
-3- An <tt>array</tt> meets all of the requirements of a container and of a reversible container 
(22.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>), except that a default constructed <tt>array</tt> object is not empty 
and that <tt>swap</tt> does not have constant complexity. An <tt>array</tt> meets some of the requirements 
of a sequence container (22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>). Descriptions are provided here only for
operations on <tt>array</tt> that are not described in one of these tables and for operations where there 
is additional semantic information.
<p/>
<ins>-?- The class template <tt>array</tt> has the data members specified in subclauses 
22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> and 22.3.7.5 <a href="https://timsong-cpp.github.io/cppwp/array.zero">[array.zero]</a>. It has no base classes or 
data members other than those specified.</ins>
<p/>
-4- [&hellip;]
</p>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
Tim Song and Tomasz were trying to come up with general wording that could be reused for both <tt>pair</tt> and 
<tt>array</tt> (and other types). They suggest that if it should be in scope for C++20, it would be better to 
provide non-general wording for <tt>pair</tt> and <tt>array</tt> (that is easier to get right).
<p/>
For completeness (and future wording) the generalized wording is included. The definition of <i>structurally compatible with</i>:
</p>
<blockquote><p>
The type <code>T</code> is <em>structurally compatible with</em> <code><i>subs</i></code>, if for the values 
<code>t1</code> and <code>t2</code> of type <code>T</code>:
</p>
<ul>
 <li><p><code>T</code> is a structural type (13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>) if the types of subobjects of <code>t1</code> 
 designated by <code><i>subs</i></code> are all structural types.</p></li>
 <li><p><code>t1</code> is template-argument-equivalent (13.6 <a href="https://timsong-cpp.github.io/cppwp/temp.type">[temp.type]</a>) to <code>t2</code>, 
 if and only if, for each subject designed by  <code><i>subs</i></code>, the value of subobject 
 of <code>t1</code> is template-argument-equivalent to the value of the correponding subobject of 
 <code>t2</code>.</p></li>
</ul>
</blockquote>
<p>
Then changes for <code>array</code>/<code>pair</code> would then look like:
</p>
<blockquote>
<p>
<code>pair&lt;T, U&gt;</code> is structurally compatible (&lt;some-reference&gt;) with <code>first</code> and <code>second</code>.
<p/>
<code>array&lt;T, N&gt;</code> is structurally compatible with its elements (if any).
</p>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 20.4.2 <a href="https://timsong-cpp.github.io/cppwp/pairs.pair">[pairs.pair]</a> as indicated:</p>

<blockquote>
<p>
-1- Constructors and member functions of <tt>pair</tt> do not throw exceptions unless one of the element-wise 
operations specified to be called for that operation throws an exception.
<p/>
-2- The defaulted move and copy constructor, respectively, of <tt>pair</tt> is a constexpr function if and 
only if all required element-wise initializations for copy and move, respectively, would satisfy the 
requirements for a constexpr function.
<p/>
-3- If <tt>(is_trivially_destructible_v&lt;T1&gt; &amp;&amp; is_trivially_destructible_v&lt;T2&gt;)</tt> 
is <tt>true</tt>, then the destructor of <tt>pair</tt> is trivial.
<p/>
<ins>-?- <code>pair&lt;T, U&gt;</code> is a structural type (13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>) if <code>T</code> 
and <code>U</code> are both structural types. Two values <code>p1</code> and <code>p2</code> of type 
<code>pair&lt;T, U&gt;</code> are template-argument-equivalent (13.6 <a href="https://timsong-cpp.github.io/cppwp/temp.type">[temp.type]</a>) if and only if 
<code>p1.first</code> and <code>p2.first</code> are template-argument-equivalent and <code>p1.second</code> 
and <code>p2.second</code> are template-argument-equivalent.</ins>
</p>
</blockquote>
</li>

<li><p>Modify 22.3.7.1 <a href="https://timsong-cpp.github.io/cppwp/array.overview">[array.overview]</a> as indicated:</p>

<blockquote>
<p>
-1- The header <tt>&lt;array&gt;</tt> defines a class template for storing fixed-size sequences of objects. 
An <tt>array</tt> is a contiguous container (22.2.1 <a href="https://timsong-cpp.github.io/cppwp/container.requirements.general">[container.requirements.general]</a>). An instance of 
<tt>array&lt;T, N&gt;</tt> stores <tt>N</tt> elements of type <tt>T</tt>, so that <tt>size() == N</tt> is 
an invariant.
<p/>
-2- An <tt>array</tt> is an aggregate (9.4.1 <a href="https://timsong-cpp.github.io/cppwp/dcl.init.aggr">[dcl.init.aggr]</a>) that can be list-initialized with up 
to <tt>N</tt> elements whose types are convertible to <tt>T</tt>.
<p/>
-3- An <tt>array</tt> meets all of the requirements of a container and of a reversible container 
(22.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>), except that a default constructed <tt>array</tt> object is not empty 
and that <tt>swap</tt> does not have constant complexity. An <tt>array</tt> meets some of the requirements 
of a sequence container (22.2.3 <a href="https://timsong-cpp.github.io/cppwp/sequence.reqmts">[sequence.reqmts]</a>). Descriptions are provided here only for
operations on <tt>array</tt> that are not described in one of these tables and for operations where there 
is additional semantic information.
<p/>
<ins>-?- <code>array&lt;T, N&gt;</code> is a structural type (13.2 <a href="https://timsong-cpp.github.io/cppwp/temp.param">[temp.param]</a>) if <code>T</code> 
is a structural type. Two values <code>a1</code> and <code>a2</code> of type <code>array&lt;T, N&gt;</code> 
are template-argument-equivalent (13.6 <a href="https://timsong-cpp.github.io/cppwp/temp.type">[temp.type]</a>) if and only if each pair of corresponding 
elements in <code>a1</code> and <code>a2</code> are template-argument-equivalent.</ins>
<p/>
-4- [&hellip;]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3383" href="3383">3383.</a> &sect;[time.zone.leap.nonmembers] <tt>sys_seconds</tt> should be replaced with <tt>seconds</tt></h3>
<p><b>Section:</b> 27.11.8.3 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap.nonmembers">[time.zone.leap.nonmembers]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Jiang An <b>Opened:</b> 2020-01-30 <b>Last modified:</b> 2020-02-12 03:28:55 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In <a href="https://wg21.link/n4849">N4849</a> 27.11.8.3 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap.nonmembers">[time.zone.leap.nonmembers]</a>/12, the type 
template parameter <tt>Duration</tt> is constrained by <tt>three_way_comparable_with&lt;sys_seconds&gt;</tt>. 
However, since <tt>std::chrono::sys_seconds</tt> is a time point type and <tt>Duration</tt> must be a 
duration type, they can never be compared directly via <tt>operator&lt;=&gt;</tt>.
<p/>
I guess that the actual intent is comparing <tt>Duration</tt> with the duration type of 
<tt>std::chrono::sys_seconds</tt>, i.e. <tt>std::chrono::seconds</tt>. And thus <tt>sys_seconds</tt> 
should be replaced with <tt>seconds</tt> here.
</p>

<p><i>[2020-02 Prioritized as P1 Monday morning in Prague]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a>, header <tt>&lt;chrono&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  [&hellip;]
  namespace chrono {
    [&hellip;]
    template&lt;three_way_comparable_with&lt;<del>sys_</del>seconds&gt; Duration&gt;
      auto operator&lt;=&gt;(const leap&amp; x, const sys_time&lt;Duration&gt;&amp; y);
    [&hellip;]
  }
  [&hellip;]
}
</pre>
<blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.11.8.3 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap.nonmembers">[time.zone.leap.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;three_way_comparable_with&lt;<del>sys_</del>seconds&gt; Duration&gt;
  constexpr auto operator&lt;=&gt;(const leap&amp; x, const sys_time&lt;Duration&gt;&amp; y) noexcept;
</pre>
<blockquote>
<p>
-12- <i>Returns:</i> <tt>x.date() &lt;=&gt; y</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-10, Prague; Howard suggests alternative wording]</i></p>

<p>
The below shown alternative wording does more directly describe the constrained code (by comparing 
<tt>time_point</tt>s), even though in the very end the code specifying the effects finally goes down 
to actually return <tt>x.date().time_since_epoch() &lt;=&gt; y.time_since_epoch()</tt> (thus comparing 
<tt>duration</tt>s).
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a>, header <tt>&lt;chrono&gt;</tt> synopsis, as indicated:</p>

<blockquote class="note">
<p>
The synopsis does provide an additional drive-by fix to eliminate the mismatch of the <tt>constexpr</tt>
and <tt>noexcept</tt> in declaration and prototype specification.
</p>
</blockquote>

<blockquote>
<pre>
namespace std {
  [&hellip;]
  namespace chrono {
    [&hellip;]
    template&lt;<del>three_way_comparable_with&lt;sys_seconds&gt;</del><ins>class</ins> Duration&gt;
      <ins>requires three_way_comparable_with&lt;sys_seconds, sys_time&lt;Duration&gt;&gt;</ins>
        <ins>constexpr</ins> auto operator&lt;=&gt;(const leap&amp; x, const sys_time&lt;Duration&gt;&amp; y) <ins>noexcept</ins>;
    [&hellip;]
  }
  [&hellip;]
}
</pre>
<blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.11.8.3 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap.nonmembers">[time.zone.leap.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;<del>three_way_comparable_with&lt;sys_seconds&gt;</del><ins>class</ins> Duration&gt;
  <ins>requires three_way_comparable_with&lt;sys_seconds, sys_time&lt;Duration&gt;&gt;</ins>
    constexpr auto operator&lt;=&gt;(const leap&amp; x, const sys_time&lt;Duration&gt;&amp; y) noexcept;
</pre>
<blockquote>
<p>
-12- <i>Returns:</i> <tt>x.date() &lt;=&gt; y</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2020-02-11, Prague; Daniel suggests alternative wording]</i></p>

<p>
During today's LWG discussion of this issue the observation was made that there also exists a 
mismatch regarding the <tt>noexcept</tt> specifier for both declarations, but for this second deviation
a corresponding change does <em>not</em> seem to be a good drive-by fix candidate, because we have a
function template here that allows supporting user-defined types, whose comparison may throw (Note 
that the corresponding <tt>operator&lt;=&gt;</tt> or other comparison function declarations of the 
<tt>duration</tt> and <tt>time_point</tt> templates are <em>not</em> specified as <tt>noexcept</tt> 
function templates). The revised wording below does therefore intentionally <em>not</em> change the
currently existing <tt>noexcept</tt>-specifier mismatch, but a separate issue should instead be
opened for the general <tt>noexcept</tt>-specifier mismatches for all comparison function templates
of <tt>std::chrono::leap</tt>. Daniel has volunteered to take care for this issue.
</p>

<p><i>[2020-02 Moved to Immediate on Tuesday in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 27.2 <a href="https://timsong-cpp.github.io/cppwp/time.syn">[time.syn]</a>, header <tt>&lt;chrono&gt;</tt> synopsis, as indicated:</p>

<blockquote class="note">
<p>
[<i>Drafting note:</i> The synopsis does provide an additional drive-by fix to eliminate the mismatch of the 
<tt>constexpr</tt> in declaration and prototype specification, but does <em>not</em> so for a similar
mismatch of the exception-specifications of both declarations.]
</p>
</blockquote>

<blockquote>
<pre>
namespace std {
  [&hellip;]
  namespace chrono {
    [&hellip;]
    template&lt;<del>three_way_comparable_with&lt;sys_seconds&gt;</del><ins>class</ins> Duration&gt;
      <ins>requires three_way_comparable_with&lt;sys_seconds, sys_time&lt;Duration&gt;&gt;</ins>
        <ins>constexpr</ins> auto operator&lt;=&gt;(const leap&amp; x, const sys_time&lt;Duration&gt;&amp; y);
    [&hellip;]
  }
  [&hellip;]
}
</pre>
<blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Modify 27.11.8.3 <a href="https://timsong-cpp.github.io/cppwp/time.zone.leap.nonmembers">[time.zone.leap.nonmembers]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;<del>three_way_comparable_with&lt;sys_seconds&gt;</del><ins>class</ins> Duration&gt;
  <ins>requires three_way_comparable_with&lt;sys_seconds, sys_time&lt;Duration&gt;&gt;</ins>
    constexpr auto operator&lt;=&gt;(const leap&amp; x, const sys_time&lt;Duration&gt;&amp; y) noexcept;
</pre>
<blockquote>
<p>
-12- <i>Returns:</i> <tt>x.date() &lt;=&gt; y</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3384" href="3384">3384.</a> <tt>transform_view::<i>sentinel</i></tt> has an incorrect <tt>operator-</tt></h3>
<p><b>Section:</b> 24.7.5.4 <a href="https://timsong-cpp.github.io/cppwp/range.transform.sentinel">[range.transform.sentinel]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Ville Voutilainen <b>Opened:</b> 2020-01-31 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<ol>
<li><p><tt>transform_view::<i>iterator</i></tt> has an exposition-only member <tt><i>current_</i></tt> 
(24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a>)</p></li>
<li><p><tt>transform_view::<i>sentinel</i></tt> has an exposition-only member <tt><i>end_</i></tt>
(24.7.5.4 <a href="https://timsong-cpp.github.io/cppwp/range.transform.sentinel">[range.transform.sentinel]</a>)</p></li>
<li><p>at 24.7.5.4 <a href="https://timsong-cpp.github.io/cppwp/range.transform.sentinel">[range.transform.sentinel]</a>/6 we have:</p></li>
</ol>
<pre>
friend constexpr range_difference_t&lt;<i>Base</i>&gt;
  operator-(const <i>sentinel</i>&amp; y, const <i>iterator</i>&lt;Const&gt;&amp; x)
    requires sized_sentinel_for&lt;sentinel_t&lt;<i>Base</i>&gt;, iterator_t&lt;<i>Base</i>&gt;&gt;;
</pre>
<blockquote><p>
<i>Effects:</i> Equivalent to: <tt>return x.<i>end_</i> - y.<i>current_</i>;</tt>
</p></blockquote>
<p>
<tt>x</tt> is an <tt><i>iterator</i></tt>, so it has <tt><i>current_</i></tt>, not <tt><i>end_</i></tt>. 
<tt>y</tt> is a <tt><i>sentinel</i></tt>, so it has <tt><i>end_</i></tt>, not <tt><i>current_</i></tt>.</p>

<p><i>[2020-02 Prioritized as IMMEDIATE Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.7.5.4 <a href="https://timsong-cpp.github.io/cppwp/range.transform.sentinel">[range.transform.sentinel]</a> as indicated:</p>

<blockquote>
<pre>
friend constexpr range_difference_t&lt;<i>Base</i>&gt;
  operator-(const <i>sentinel</i>&amp; y, const <i>iterator</i>&lt;Const&gt;&amp; x)
    requires sized_sentinel_for&lt;sentinel_t&lt;<i>Base</i>&gt;, iterator_t&lt;<i>Base</i>&gt;&gt;;
</pre>
<blockquote>
<p>
-6- <i>Effects:</i> Equivalent to: <tt>return <del>x</del><ins>y</ins>.<i>end_</i> - <del>y</del><ins>x</ins>.<i>current_</i>;</tt>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3385" href="3385">3385.</a> <tt>common_iterator</tt> is not sufficiently constrained for non-copyable iterators</h3>
<p><b>Section:</b> 23.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/common.iterator">[common.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Corentin Jabot <b>Opened:</b> 2020-01-31 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
We don't actually specify anywhere that non-copyable iterators do not have a <tt>common_iterator</tt> 
(and it would make little sense for them to as algorithms dealing with C++17 iterators are not expecting 
non-copyable things) As it stands <tt>common_iterator</tt> can be created from move only iterator but 
are then non-copyable themselves. <a href="https://wg21.link/p1862">P1862</a> already constrains 
<tt>common_view</tt> in a similar fashion</p>

<p><i>[2020-02 Prioritized as IMMEDIATE Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 23.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.synopsis">[iterator.synopsis]</a>, header <tt>&lt;iterator&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  [&hellip;]
  <i>// 23.5.4 <a href="https://timsong-cpp.github.io/cppwp/iterators.common">[iterators.common]</a>, common iterators</i>
  template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
    requires (!same_as&lt;I, S&gt; <ins>&amp;&amp; copyable&lt;I&gt;</ins>)
      class common_iterator;
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 23.5.4.1 <a href="https://timsong-cpp.github.io/cppwp/common.iterator">[common.iterator]</a>, class template <tt>common_iterator</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
    requires (!same_as&lt;I, S&gt; <ins>&amp;&amp; copyable&lt;I&gt;</ins>)
  class common_iterator {
  public:
    [&hellip;]
  };
  [&hellip;]
}
</pre>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3386" href="3386">3386.</a> <tt>elements_view</tt> needs its own <tt>sentinel</tt> type</h3>
<p><b>Section:</b> 24.7.15 <a href="https://timsong-cpp.github.io/cppwp/range.elements">[range.elements]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2020-02-07 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>elements_view</tt> is effectively a specialized version of <tt>transform_view</tt>.
The latter has a custom <tt>sentinel</tt> type, and so should <tt>elements_view</tt>.
<p/>
In particular, it should not use the underlying range's sentinel directly, for that sentinel
could encode a generic predicate that is equally meaningful for the adapted range. Consider a
range <tt>[i, s)</tt> whose <tt>value_type</tt> is <tt>pair&lt;array&lt;int, 2&gt;, long&gt;</tt>,
where <tt>s</tt> is a generic sentinel that checks if the second element (for this range in particular,
the <tt>long</tt>) is zero:
</p>
<blockquote>
<pre>
struct S {
  friend bool operator==(input_iterator auto const&amp; i, S) /* additional constraints */
  { return get&lt;1&gt;(*i) == 0; }
};
</pre>
</blockquote>
<p>
If we adapt <tt>[i, s)</tt> with <tt>views::keys</tt>, then the resulting adapted range would have
surprising behavior when used with <tt>S{}</tt>: even though it's nominally a range of
<tt>array&lt;int, 2&gt;</tt>, when its iterator is used with the sentinel <tt>S{}</tt> 
it doesn't actually check the second element of the array, but the <tt>long</tt> that's not even
part of the <tt>value_type</tt>:
</p>
<blockquote>
<pre>
void algo(input_range auto&amp;&amp; r) /* constraints */{
  // We want to stop at the first element of the range r whose second element is zero.
  for (auto&amp;&amp; x : subrange{ranges::begin(r), S{}})
  {
    std::cout &lt;&lt; get&lt;0&gt;(x);
  }
}

using P = pair&lt;array&lt;int, 2&gt;, long&gt;;
vector&lt;P&gt; vec =  {
    { {0, 1}, 1L },
    { {1, 0}, 1L },
    { {2, 2}, 0L }
};
   
subrange r{vec.begin(), S{}};              // range with two elements: {0, 1}, {1, 0}

algo(r | views::keys);                     // checks the long, prints '01'
algo(r | views::transform(&amp;P::first));     // checks the second element of the array, prints '0'
</pre>
</blockquote>
<p>
This is an API break since it changes the return type of <tt>end()</tt>, so it should be
fixed before we ship C++20.
</p>

<p><i>[2020-02 Prioritized as P1 Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>The proposed wording is contained in <a href="https://wg21.link/p1994r0">P1994R0</a>.</p>





<hr>
<h3><a name="3387" href="3387">3387.</a> &sect;[range.reverse.view] <tt>reverse_view&lt;V&gt;</tt> unintentionally requires <tt>range&lt;const V&gt;</tt></h3>
<p><b>Section:</b> 24.7.14.2 <a href="https://timsong-cpp.github.io/cppwp/range.reverse.view">[range.reverse.view]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Patrick Palka <b>Opened:</b> 2020-02-04 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>reverse_view&lt;V&gt;</tt> requires <tt>bidirectional_range&lt;V&gt;</tt>, but not <tt>range&lt;const V&gt;</tt>, 
which means that <tt>iterator_t&lt;const V&gt;</tt> might be an invalid type. The return types of the 
<tt>begin() const</tt> and <tt>end() const</tt> overloads make use of <tt>iterator_t&lt;const V&gt;</tt> 
in a non-SFINAE context, which means that instantiating <tt>reverse_view&lt;X&gt;</tt> is ill-formed unless 
<tt>range&lt;const X&gt;</tt> is satisfied.
<p/>
Code like <tt>x | views::filter(p) | views::reverse</tt> fails to compile because 
<tt>const filter_view&lt;&hellip;&gt;</tt> does not model <tt>range</tt>, so 
<tt>iterator_t&lt;const filter_view&lt;&hellip;&gt;&gt;</tt> is invalid.
<p/>
Either <tt>range&lt;const V&gt;</tt> needs to be in the class' <tt>requires</tt>-clause, or the return types 
of the <tt>const</tt>-qualified <tt>begin()</tt> and <tt>end()</tt> need to delay use of 
<tt>iterator_t&lt;const V&gt;</tt> until <tt>range&lt;const V&gt;</tt> is known to be satisfied.
<p/>
Giving these overloads an <tt>auto</tt> return type means the type is determined when the member is called. 
The constraint <tt>common_range&lt;const V&gt;</tt> appropriately restricts the selection of these overloads, 
so they can only be called when the type is valid. This is what <tt>cmcstl2</tt> does. <tt>range-v3</tt> 
makes the <tt>begin() const</tt> and <tt>end() const</tt> members into function templates, so that they 
are SFINAE contexts.
</p>

This is related to <a href="3347">3347</a>.
<p><i>[2020-02 Prioritized as IMMEDIATE Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.7.14.2 <a href="https://timsong-cpp.github.io/cppwp/range.reverse.view">[range.reverse.view]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
namespace std::ranges {
  template&lt;view V&gt;
    requires bidirectional_range&lt;V&gt;
  class reverse_view : public view_interface&lt;reverse_view&lt;V&gt;&gt; {
    [&hellip;]
    constexpr reverse_iterator&lt;iterator_t&lt;V&gt;&gt; begin();
    constexpr reverse_iterator&lt;iterator_t&lt;V&gt;&gt; begin() requires common_range&lt;V&gt;;
    constexpr <del>reverse_iterator&lt;iterator_t&lt;const V&gt;&gt;</del><ins>auto</ins> begin() const
      requires common_range&lt;const V&gt;;  
    
    constexpr reverse_iterator&lt;iterator_t&lt;V&gt;&gt; end();
    constexpr <del>reverse_iterator&lt;iterator_t&lt;const V&gt;&gt;</del><ins>auto</ins> end() const
      requires common_range&lt;const V&gt;;  
    [&hellip;]
  };
  [&hellip;]
}
</pre>
[&hellip;]
</blockquote>
<blockquote>
<pre>
constexpr reverse_iterator&lt;iterator_t&lt;V&gt;&gt; begin() requires common_range&lt;V&gt;;
constexpr <del>reverse_iterator&lt;iterator_t&lt;const V&gt;&gt;</del><ins>auto</ins> begin() const
  requires common_range&lt;const V&gt;;
</pre>
<blockquote>
<p>
-5- <i>Effects:</i> Equivalent to: <tt>return make_reverse_iterator(ranges::end(base_));</tt>
</p>
</blockquote>
<pre>
constexpr reverse_iterator&lt;iterator_t&lt;V&gt;&gt; end();
constexpr <del>reverse_iterator&lt;iterator_t&lt;const V&gt;&gt;</del><ins>auto</ins> end() const
  requires common_range&lt;const V&gt;;
</pre>
<blockquote>
<p>
-6- <i>Effects:</i> Equivalent to: <tt>return make_reverse_iterator(ranges::begin(base_));</tt>
</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3388" href="3388">3388.</a> <tt>view</tt> iterator types have ill-formed <tt>&lt;=&gt;</tt> operators</h3>
<p><b>Section:</b> 24.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/range.iota.iterator">[range.iota.iterator]</a>, 24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a>, 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2020-02-07 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.iota.iterator">active issues</a> in [range.iota.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.iota.iterator">issues</a> in [range.iota.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
24.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/range.iota.iterator">[range.iota.iterator]</a> and 24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a> and 
24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> all declare <tt>operator&lt;=&gt;</tt> similar to this:
</p>
<blockquote><pre>
friend constexpr compare_three_way_result_t&lt;W&gt; operator&lt;=&gt;(
    const iterator&amp; x, const iterator&amp; y)
  requires totally_ordered&lt;W&gt; &amp;&amp; three_way_comparable&lt;W&gt;;
</pre></blockquote>
<p>
Similar to issue <a href="3347">3347</a> and issue <a href="3387">3387</a>, this is ill-formed if 
<tt>three_way_comparable&lt;W&gt;</tt> is not satisfied, because <tt>compare_three_way_result_t&lt;W&gt;</tt> 
is invalid. This declaration is instantiated when the enclosing iterator type is instantiated, making 
any use of <tt>iota_view&lt;W, B&gt;::iterator</tt> ill-formed when <tt>three_way_comparable&lt;W&gt;</tt> 
is not satisfied.
<p/>
We can either add an exposition-only <tt><i>safe-compare-three-way-result-t</i></tt> alias that denotes 
<tt>void</tt> or <tt>std::nonesuch</tt> for spaceship-less types, so the declaration is valid (and then 
disabled by the constraints), or simply make them return <tt>auto</tt>.
</p>

<p><i>[2020-02 Prioritized as IMMEDIATE Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.6.3.3 <a href="https://timsong-cpp.github.io/cppwp/range.iota.iterator">[range.iota.iterator]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
namespace std::ranges {
  template&lt;class W, class Bound&gt;
  struct iota_view&lt;W, Bound&gt;::<i>iterator</i> {
    [&hellip;]
    friend constexpr <del>compare_three_way_result_t&lt;W&gt;</del><ins>auto</ins> operator&lt;=&gt;(
        const <i>iterator</i>&amp; x, const <i>iterator</i>&amp; y)
      requires totally_ordered&lt;W&gt; &amp;&amp; three_way_comparable&lt;W&gt;;
    [&hellip;]
  };
  [&hellip;]
}
</pre>
[&hellip;]
</blockquote>
<blockquote>
<pre>
friend constexpr <del>compare_three_way_result_t&lt;W&gt;</del><ins>auto</ins>
  operator&lt;=&gt;(const <i>iterator</i>&amp; x, const <i>iterator</i>&amp; y)
    requires totally_ordered&lt;W&gt; &amp;&amp; three_way_comparable&lt;W&gt;;
</pre>
<blockquote>
<p>
-19- <i>Effects:</i> Equivalent to: <tt>return x.value_ &lt;=&gt; y.value_;</tt>
</p>
</blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.7.5.3 <a href="https://timsong-cpp.github.io/cppwp/range.transform.iterator">[range.transform.iterator]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
namespace std::ranges {
  template&lt;class V, class F&gt;
  template&lt;bool Const&gt;
  class transform_view&lt;V, F&gt;::<i>iterator</i> {
    [&hellip;]
    friend constexpr <del>compare_three_way_result_t&lt;iterator_t&lt;<i>Base</i>&gt;&gt;</del><ins>auto</ins> 
      operator&lt;=&gt;(const <i>iterator</i>&amp; x, const <i>iterator</i>&amp; y)
        requires random_access_range&lt;<i>Base</i>&gt; &amp;&amp; three_way_comparable&lt;iterator_t&lt;<i>Base</i>&gt;&gt;;
    [&hellip;]
  };
  [&hellip;]
}
</pre>
[&hellip;]
</blockquote>
<blockquote>
<pre>
friend constexpr <del>compare_three_way_result_t&lt;iterator_t&lt;<i>Base</i>&gt;&gt;</del><ins>auto</ins>
  operator&lt;=&gt;(const <i>iterator</i>&amp; x, const <i>iterator</i>&amp; y)
    requires random_access_range&lt;<i>Base</i>&gt; &amp;&amp; three_way_comparable&lt;iterator_t&lt;<i>Base</i>&gt;&gt;;
</pre>
<blockquote>
<p>
-19- <i>Effects:</i> Equivalent to: <tt>return x.<i>current_</i> &lt;=&gt; y.<i>current_</i>;</tt>
</p>
</blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Modify 24.7.15.3 <a href="https://timsong-cpp.github.io/cppwp/range.elements.iterator">[range.elements.iterator]</a> as indicated:</p>

<blockquote>
<blockquote>
<pre>
namespace std::ranges {
  template&lt;class V, size_t N&gt;
  template&lt;bool Const&gt;
  class elements_view&lt;V, N&gt;::<i>iterator</i> {
    [&hellip;]
    friend constexpr <del>compare_three_way_result_t&lt;iterator_t&lt;<i>base-t</i>&gt;&gt;</del><ins>auto</ins> 
      operator&lt;=&gt;(const <i>iterator</i>&amp; x, const <i>iterator</i>&amp; y)
        requires random_access_range&lt;<i>base-t</i>&gt; &amp;&amp; three_way_comparable&lt;iterator_t&lt;<i>base-t</i>&gt;&gt;;
    [&hellip;]
  };
  [&hellip;]
}
</pre>
[&hellip;]
</blockquote>
<blockquote>
<pre>
friend constexpr <del>compare_three_way_result_t&lt;iterator_t&lt;<i>base-t</i>&gt;&gt;</del><ins>auto</ins>
  operator&lt;=&gt;(const <i>iterator</i>&amp; x, const <i>iterator</i>&amp; y)
    requires random_access_range&lt;<i>base-t</i>&gt; &amp;&amp; three_way_comparable&lt;iterator_t&lt;<i>base-t</i>&gt;&gt;;
</pre>
<blockquote>
<p>
-18- <i>Effects:</i> Equivalent to: <tt>return x.<i>current_</i> &lt;=&gt; y.<i>current_</i>;</tt>
</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>




<hr>
<h3><a name="3389" href="3389">3389.</a> A move-only iterator still does not have a <tt>counted_iterator</tt></h3>
<p><b>Section:</b> 23.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/counted.iter.const">[counted.iter.const]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Patrick Palka <b>Opened:</b> 2020-02-07 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="https://wg21.link/p1207r4">P1207R4</a> ("Movability of single-pass iterators") 
introduces the notion of a move-only non-forward iterator and makes some changes to 
the iterator adaptor <tt>counted_iterator</tt> in order to support move-only iterators.
<p/>
The problem is that the constructor of <tt>counted_iterator</tt> (23.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/counted.iter.const">[counted.iter.const]</a> p2) 
accepting such an iterator is specified as "Initializes <tt>current</tt> with <tt>i</tt>" 
which would attempt copy-constructing <tt>current</tt> from <tt>i</tt> instead of move-constructing it.
</p>

<p><i>[2020-02 Prioritized as IMMEDIATE Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 23.5.6.2 <a href="https://timsong-cpp.github.io/cppwp/counted.iter.const">[counted.iter.const]</a> as indicated:</p>

<blockquote>
<pre>
constexpr counted_iterator(I i, iter_difference_t&lt;I&gt; n);
</pre>
<blockquote>
<p>
-1- <i>Preconditions:</i> <tt>n &gt;= 0</tt>.
<p/>
-2- <i>Effects:</i> Initializes <tt>current</tt> with <tt><ins>std::move(</ins>i<ins>)</ins></tt> 
and <tt>length</tt> with <tt>n</tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3390" href="3390">3390.</a> <tt>make_move_iterator()</tt> cannot be used to construct a <tt>move_iterator</tt> for a
move-only iterator</h3>
<p><b>Section:</b> 23.5.3.8 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nonmember">[move.iter.nonmember]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Patrick Palka <b>Opened:</b> 2020-02-07 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#move.iter.nonmember">active issues</a> in [move.iter.nonmember].</p>
<p><b>View all other</b> <a href="lwg-index.html#move.iter.nonmember">issues</a> in [move.iter.nonmember].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="https://wg21.link/p1207r4">P1207R4</a> ("Movability of single-pass iterators") 
introduces the notion of a move-only non-forward iterator and makes some changes to 
the existing specification to realize that support.
<p/>
The problem is that the specification of <tt>make_move_iterator()</tt> provided in 
23.5.3.8 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nonmember">[move.iter.nonmember]</a> p6 does attempt to construct a
<tt>move_iterator&lt;Iterator&gt;</tt> with an lvalue of <tt>i</tt> instead
of an rvalue, having the effect of copying it instead of moving it, thus preventing
to accept move-only iterators.
</p>

<p><i>[2020-02 Prioritized as IMMEDIATE Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 23.5.3.8 <a href="https://timsong-cpp.github.io/cppwp/move.iter.nonmember">[move.iter.nonmember]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Iterator&gt;
constexpr move_iterator&lt;Iterator&gt; make_move_iterator(Iterator i);
</pre>
<blockquote>
<p>
-6- <i>Returns:</i> <tt>move_iterator&lt;Iterator&gt;(<ins>std::move(</ins>i<ins>)</ins>)</tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3391" href="3391">3391.</a> Problems with <tt>counted_iterator/move_iterator::base() const &amp;</tt></h3>
<p><b>Section:</b> 23.5.3 <a href="https://timsong-cpp.github.io/cppwp/move.iterators">[move.iterators]</a>, 23.5.6 <a href="https://timsong-cpp.github.io/cppwp/iterators.counted">[iterators.counted]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Patrick Palka <b>Opened:</b> 2020-02-07 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#move.iterators">issues</a> in [move.iterators].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
It is not possible to use the <tt>const &amp;</tt> overloads of <tt>counted_iterator::base()</tt> or
<tt>move_iterator::base()</tt> to get at an underlying move-only iterator in order to compare it 
against a sentinel.
<p/>
More concretely, assuming issue LWG <a href="3389">3389</a> is fixed, this means that
</p>
<blockquote><pre>
auto v = r | views::take(5);
ranges::begin(v) == ranges::end(v);
</pre></blockquote>
<p>
is invalid when <tt>r</tt> is a <tt>view</tt> whose <tt>begin()</tt> is a move-only input iterator.
The code is invalid because <tt>ranges::take_view::sentinel::operator==()</tt> must call 
<tt>counted_iterator::base()</tt> to compare the underlying iterator against its sentinel, and 
therefore this <tt>operator==()</tt> requires that the underlying iterator is <tt>copy_constructible</tt>.
<p/>
Suggested resolution:
<p/>
Make these <tt>const &amp; base()</tt> overloads return the underlying iterator by <tt>const</tt> reference.  
Remove the <tt>copy_constructible</tt> constraint on these overloads. Perhaps the <tt>base()</tt> 
overloads for the iterator wrappers in 24.7 <a href="https://timsong-cpp.github.io/cppwp/range.adaptors">[range.adaptors]</a> could use the same treatment?
</p>

<p><i>[2020-02 Prioritized as P2 Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 23.5.3.1 <a href="https://timsong-cpp.github.io/cppwp/move.iterator">[move.iterator]</a>, class template <tt>move_iterator</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;class Iterator&gt;
  class move_iterator {
  public:
    using iterator_type = Iterator;
    [&hellip;]
    constexpr <ins>const</ins> iterator_type<ins>&amp;</ins> base() const &amp;;
    constexpr iterator_type base() &amp;&amp;;
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Modify 23.5.3.4 <a href="https://timsong-cpp.github.io/cppwp/move.iter.op.conv">[move.iter.op.conv]</a> as indicated:</p>

<blockquote>
<pre>
constexpr <ins>const</ins> Iterator<ins>&amp;</ins> base() const &amp;;
</pre>
<blockquote>
<p>
<del>-1- <i>Constraints:</i> <tt>Iterator</tt> satisfies <tt>copy_constructible</tt>.</del>
<p/>
<del>-2- <i>Preconditions:</i> <tt>Iterator</tt> models <tt>copy_constructible</tt>.</del>
<p/>
-3- <i>Returns:</i> <tt>current</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 23.5.6.1 <a href="https://timsong-cpp.github.io/cppwp/counted.iterator">[counted.iterator]</a>, class template <tt>counted_iterator</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std {
  template&lt;input_or_output_iterator I&gt;
  class counted_iterator {
  public:
    using iterator_type = I;
    [&hellip;]
    constexpr <ins>const</ins> I<ins>&amp;</ins> base() const &amp; <del>requires copy_constructible&lt;I&gt;</del>;
    constexpr I base() &amp;&amp;;
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Modify 23.5.6.3 <a href="https://timsong-cpp.github.io/cppwp/counted.iter.access">[counted.iter.access]</a> as indicated:</p>

<blockquote>
<pre>
constexpr <ins>const</ins> I<ins>&amp;</ins> base() const &amp; <del>requires copy_constructible&lt;I&gt;</del>;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Equivalent to: <tt>return current;</tt>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3392" href="3392">3392.</a> <tt>ranges::distance()</tt> cannot be used on a move-only iterator with a sized sentinel</h3>
<p><b>Section:</b> 23.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.distance">[range.iter.op.distance]</a> <b>Status:</b> <a href="lwg-active.html#LEWG">LEWG</a>
 <b>Submitter:</b> Patrick Palka <b>Opened:</b> 2020-02-07 <b>Last modified:</b> 2020-02-10 19:13:13 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#LEWG">LEWG</a> status.</p>
<p><b>Discussion:</b></p>
<p>
One cannot use <tt>ranges::distance(I, S)</tt> to compute the distance between a
move-only <tt>counted_iterator</tt> and the <tt>default_sentinel</tt>. In other words,
the following is invalid
</p>
<blockquote><pre>
// iter is a counted_iterator with an move-only underlying iterator
ranges::distance(iter, default_sentinel);
</pre></blockquote>
<p>
and yet
</p>
<blockquote><pre>
(default_sentinel - iter);
</pre></blockquote>
<p>
is valid. The first example is invalid because <tt>ranges::distance()</tt> takes
its first argument by value so when invoking it with an iterator lvalue
argument the iterator must be copyable, which a move-only iterator is
not. The second example is valid because <tt>counted_iterator::operator-()</tt>
takes its iterator argument by <tt>const</tt> reference, so it doesn't require
copyability of the <tt>counted_iterator</tt>.
<p/>
This incongruency poses an inconvenience in generic code which uses
<tt>ranges::distance()</tt> to efficiently compute the distance between two
iterators or between an iterator-sentinel pair. Although it's a bit of
an edge case, it would be good if <tt>ranges::distance()</tt> does the right
thing when the iterator is a move-only lvalue with a sized sentinel.
<p/>
If this is worth fixing, one solution might be to define a separate
overload of <tt>ranges::distance(I, S)</tt> that takes its arguments by <tt>const</tt>
reference, as follows.
</p>

<p><i>[2020-02 Prioritized as P3 and LEWG Monday morning in Prague]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 23.2 <a href="https://timsong-cpp.github.io/cppwp/iterator.synopsis">[iterator.synopsis]</a>, header <tt>&lt;iterator&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
#include &lt;concepts&gt;

namespace std {
  [&hellip;]
  <i>// 23.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.iter.ops">[range.iter.ops]</a>, range iterator operations</i>
  namespace ranges {
    [&hellip;]
    <i>// 23.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.distance">[range.iter.op.distance]</a>, ranges::distance</i>
    template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
      <ins>requires (!sized_sentinel_for&lt;S, I&gt;)</ins>
        constexpr iter_difference_t&lt;I&gt; distance(I first, S last);
    <ins>template&lt;input_or_output_iterator I, sized_sentinel_for&lt;I&gt; S&gt;
      constexpr iter_difference_t&lt;I&gt; distance(const I&amp; first, const S&amp; last);</ins>
    template&lt;range R&gt;
      constexpr range_difference_t&lt;R&gt; distance(R&amp;&amp; r);
    [&hellip;]
  }
  [&hellip;]
}
</pre>
</blockquote>
</li>

<li><p>Modify 23.4.3.2 <a href="https://timsong-cpp.github.io/cppwp/range.iter.op.distance">[range.iter.op.distance]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;input_or_output_iterator I, sentinel_for&lt;I&gt; S&gt;
  <ins>requires (!sized_sentinel_for&lt;S, I&gt;)</ins>
    constexpr iter_difference_t&lt;I&gt; ranges::distance(I first, S last);
</pre>
<blockquote>
<p>
-1- <i>Preconditions:</i> <tt>[first, last)</tt> denotes a range<del>, or <tt>[last, first)</tt> denotes a range 
and <tt>S</tt> and <tt>I</tt> model <tt>same_as&lt;S, I&gt; &amp;&amp; sized_sentinel_for&lt;S, I&gt;</tt></del>.
<p/>
-2- <i>Effects:</i> <del>If <tt>S</tt> and <tt>I</tt> model <tt>sized_sentinel_for&lt;S, I&gt;</tt>, returns 
<tt>(last - first)</tt>; otherwise, r</del><ins>R</ins>eturns the number of increments needed to get from 
<tt>first</tt> to <tt>last</tt>.
</p>
</blockquote>
<pre>
<ins>template&lt;input_or_output_iterator I, sized_sentinel_for&lt;I&gt; S&gt;
  constexpr iter_difference_t&lt;I&gt; ranges::distance(const I&amp; first, const S&amp; last);</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Preconditions:</i> <tt>S</tt> and <tt>I</tt> model <tt>sized_sentinel_for&lt;S, I&gt;</tt> and either:</ins>
<ol style="list-style-type: none"> 
<li><p><ins>(?.1) &mdash; <tt>[first, last)</tt> denotes a range, or</ins></p></li>
<li><p><ins>(?.2) &mdash; <tt>[last, first)</tt> denotes a range and <tt>S</tt> and <tt>I</tt> model 
<tt>same_as&lt;S, I&gt;</tt>.</ins></p></li>
</ol>
<p/>
<ins>-? <i>Effects:</i> Returns <tt>(last - first)</tt>;</ins>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3393" href="3393">3393.</a> Missing/incorrect feature test macro for coroutines</h3>
<p><b>Section:</b> 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Barry Revzin <b>Opened:</b> 2020-01-25 <b>Last modified:</b> 2020-02-12 03:28:55 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View other</b> <a href="lwg-index-open.html#version.syn">active issues</a> in [version.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#version.syn">issues</a> in [version.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
We have a policy, established in <a href="https://wg21.link/p1353">P1353</a> (and needing to be added to SD-6):
<p/>
In some cases a feature requires two macros, one for the language and one for the library. For example, the 
library does not want to define its three-way comparison operations unless the compiler supports the feature.
<p/>
For end-users, it is suggested that they test only the library macro, as that will only be true if the 
language macro is also true. As a result, the language macros contain "impl" to distinguish them from the 
more general version that is expected to be set by the library.
That paper added two papers of macros: one for <tt>&lt;=&gt;</tt> and one for destroying <tt>delete</tt>. 
We have a third such example in coroutines: there is library machinery that needs to be provided only when 
the compiler has language support for it, and the end user should just check the library macro.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 15.11 <a href="https://timsong-cpp.github.io/cppwp/cpp.predefined">[cpp.predefined]</a>, Table [tab:cpp.predefined.ft], as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 18: Feature-test macros [tab:cpp.predefined.ft]</caption>
<tr align="center">
<th>Macro name</th>
<th>Value</th>
</tr> 

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>__cpp<ins>_impl</ins>_coroutines</tt>
</td>
<td>
<tt>201902L</tt>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Modify 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a>, header <tt>&lt;version&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
#define __cpp_lib_constexpr_vector    201907L <i>// also in &lt;vector&gt;</i>
<ins>#define __cpp_lib_coroutines          201902L <i>// also in &lt;coroutine&gt;</i></ins>
#define __cpp_lib_destroying_delete   201806L <i>// also in &lt;new&gt;</i>
[&hellip;]
</pre>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-11, Prague]</i></p>

<p>
LWG observed that the naming suggestion didn't follow naming conventions of SG-10 because of the plural form
<tt>corountines</tt>. The submitter agreed with that complaint, so the revised wording uses now the singular
form.
</p>

<p><i>[2020-02 Moved to Immediate on Tuesday in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 15.11 <a href="https://timsong-cpp.github.io/cppwp/cpp.predefined">[cpp.predefined]</a>, Table [tab:cpp.predefined.ft], as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 18: Feature-test macros [tab:cpp.predefined.ft]</caption>
<tr align="center">
<th>Macro name</th>
<th>Value</th>
</tr> 

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

<tr>
<td>
<tt>__cpp<ins>_impl</ins>_coroutine<del>s</del></tt>
</td>
<td>
<tt>201902L</tt>
</td>
</tr>

<tr>
<td colspan="2" align="center">
<tt>[&hellip;]</tt>
</td>
</tr>

</table>
</blockquote>

</li>

<li><p>Modify 17.3.2 <a href="https://timsong-cpp.github.io/cppwp/version.syn">[version.syn]</a>, header <tt>&lt;version&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
#define __cpp_lib_constexpr_vector    201907L <i>// also in &lt;vector&gt;</i>
<ins>#define __cpp_lib_coroutine           201902L <i>// also in &lt;coroutine&gt;</i></ins>
#define __cpp_lib_destroying_delete   201806L <i>// also in &lt;new&gt;</i>
[&hellip;]
</pre>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3394" href="3394">3394.</a> <tt>ranges::basic_istream_view::<i>iterator</i></tt> has an empty <tt>iterator_traits</tt></h3>
<p><b>Section:</b> 24.6.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.istream.iterator">[range.istream.iterator]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Patrick Palka <b>Opened:</b> 2020-02-09 <b>Last modified:</b> 2020-02-13 15:06:02 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.istream.iterator">active issues</a> in [range.istream.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.istream.iterator">issues</a> in [range.istream.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Every instantiation of <tt>ranges::basic_istream_view::<i>iterator</i></tt> has an empty
<tt>iterator_traits</tt>, i.e. the type
</p>
<blockquote><pre>
iterator_traits&lt;ranges::basic_istream_view&lt;Val, CharT, Traits&gt;::iterator&gt;
</pre></blockquote>
<p>
has no members.
<p/>
This happens because <tt>basic_istream_view::<i>iterator</i></tt> neither models
<tt><i>cpp17-iterator</i></tt> (since this concept requires copyability, which this
iterator is by design not) nor does it define all four of the member
types <tt>difference_type</tt>, <tt>value_type</tt>, <tt>reference</tt>, and 
<tt>iterator_category</tt> (it is missing <tt>reference</tt>). Therefore by 
23.3.2.3 <a href="https://timsong-cpp.github.io/cppwp/iterator.traits">[iterator.traits]</a> p3, this iterator's specialization of 
<tt>iterator_traits</tt> will be empty if generated from the 
<tt>iterator_traits</tt> primary template.
<p/>
Since <tt>basic_istream_view::iterator</tt> is indeed an iterator, its
<tt>iterator_traits</tt> should certainly not be empty. The simplest solution
here is to define the member type <tt>reference</tt> in the definition of
<tt>basic_istream_view::iterator</tt>, which will enable its <tt>iterator_traits</tt>
specialization to be appropriately populated from the primary template.
</p>

<p><i>[2020-02-10; Jonathan comments]</i></p>

<p>
Jonathan and Casey have concerns about the proposed resolution. Casey: The wording makes it look
as if this iterator is supposed to be an <tt><i>cpp17-input-iterator</i></tt>.
<p/>
See also LWG <a href="3283">3283</a> and  <a href="3289">3289</a>.
</p>

<p><i>[2020-02 Prioritized as P2 Monday morning in Prague]</i></p>


<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.6.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.istream.iterator">[range.istream.iterator]</a>, class template 
<tt>basic_istream_view::<i>iterator</i></tt> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;class Val, class CharT, class Traits&gt;
  class basic_istream_view&lt;Val, CharT, Traits&gt;::<i>iterator</i> { <i>// exposition only</i>
  public:
    using iterator_category = input_iterator_tag;
    using difference_type = ptrdiff_t;
    using value_type = Val;
    <ins>using reference = Val&amp;;</ins>

    <i>iterator</i>() = default;
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

</ol>
</blockquote>

<p><i>[2020-02-13, Prague]</i></p>

<p>
LWG decided for NAD: The <tt>ranges::basic_istream_view::iterator</tt> is a move-only type 
and thus cannot meet the <i>Cpp17</i> requirements (even <tt>output_iterator_tag</tt>), as such it should not 
specialize <tt>iterator_traits</tt>, to avoid misleading results when it is passed to new algorithms.
<p/>
A related issue, LWG <a href="3397">3397</a>, is supposed to take care for a problem with the definition of the
<tt>iterator_category</tt> member type of this template.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="3395" href="3395">3395.</a> Definition for three-way comparison needs to be updated (US 152)</h3>
<p><b>Section:</b> 16.3.4 <a href="https://timsong-cpp.github.io/cppwp/defns.comparison">[defns.comparison]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Jeff Garland <b>Opened:</b> 2020-02-10 <b>Last modified:</b> 2020-02-12 03:28:55 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/151">US 152</a></b></p>
<p>
This definition in 16.3.4 <a href="https://timsong-cpp.github.io/cppwp/defns.comparison">[defns.comparison]</a> should be updated to accommodate the new 3-way comparison operator 
(7.6.8 <a href="https://timsong-cpp.github.io/cppwp/expr.spaceship">[expr.spaceship]</a>) as well.
</p>
<p><i>[2020-02 Moved to Immediate on Tuesday in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 16.3.4 <a href="https://timsong-cpp.github.io/cppwp/defns.comparison">[defns.comparison]</a> as indicated:</p>

<blockquote>
<p>
<b>comparison function</b>
<p/>
operator function (12.6 <a href="https://timsong-cpp.github.io/cppwp/over.oper">[over.oper]</a>) for any of the equality (7.6.10 <a href="https://timsong-cpp.github.io/cppwp/expr.eq">[expr.eq]</a>)<ins>,</ins> 
<del>or</del> relational (7.6.9 <a href="https://timsong-cpp.github.io/cppwp/expr.rel">[expr.rel]</a>)<ins>, or three-way comparison 
(7.6.8 <a href="https://timsong-cpp.github.io/cppwp/expr.spaceship">[expr.spaceship]</a>)</ins> operators
</p>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3396" href="3396">3396.</a> Clarify point of reference for <tt>source_location::current()</tt> (DE 169)</h3>
<p><b>Section:</b> 17.8.2.1 <a href="https://timsong-cpp.github.io/cppwp/support.srcloc.cons">[support.srcloc.cons]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Jens Maurer <b>Opened:</b> 2020-02-13 <b>Last modified:</b> 2020-02-14 06:55:06 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p><b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/167">DE 169</a></b></p>
<p>
The expectation of the note that a default argument expression
involving current() causes a source_location to be constructed
that refers to the site of a function call where that default
argument is needed has no basis in normative text.
In particular, 9.2.3.6 paragraph 5 seems to imply that the
name "current" and its semantics are bound where it appears
lexically in the function declaration.
<p/>
Proposed change:
<p/>
Add normative text to express the desired semantics.
</p>

<p><i>[2020-02 Moved to Immediate on Thursday afternoon in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 17.8.2.1 <a href="https://timsong-cpp.github.io/cppwp/support.srcloc.cons">[support.srcloc.cons]</a> as indicated:</p>

<blockquote>
<pre>
static consteval source_location current() noexcept;
</pre>
<blockquote>
<p>
-1- [&hellip;]
<p/>
-2- <i>Remarks:</i> <del>When a default member initializer is used to initialize a non-static data member, any calls to
<tt>current</tt></del><ins>Any call to <tt>current</tt> that appears as a default member initializer (11.4 <a href="https://timsong-cpp.github.io/cppwp/class.mem">[class.mem]</a>), 
or as a subexpression thereof,</ins> should correspond to the location of the constructor <ins>definition</ins> or 
aggregate initialization that <del>initializes the member</del><ins>uses the default member initializer</ins>. 
<ins>Any call to <tt>current</tt> that appears as a default argument (9.3.3.6 <a href="https://timsong-cpp.github.io/cppwp/dcl.fct.default">[dcl.fct.default]</a>), or as a subexpression thereof, 
should correspond to the location of the invocation of the function that uses the default argument (7.6.1.2 <a href="https://timsong-cpp.github.io/cppwp/expr.call">[expr.call]</a>).</ins>
<p/>
<del>-3- [<i>Note:</i> When used as a default argument (9.3.3.6 <a href="https://timsong-cpp.github.io/cppwp/dcl.fct.default">[dcl.fct.default]</a>), the value of the 
<tt>source_location</tt> will be the location of the call to <tt>current</tt> at the call site. &mdash; <i>end note</i>]</del>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3397" href="3397">3397.</a> <tt>ranges::basic_istream_view::iterator</tt> should not provide <tt>iterator_category</tt></h3>
<p><b>Section:</b> 24.6.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.istream.iterator">[range.istream.iterator]</a> <b>Status:</b> <a href="lwg-active.html#Immediate">Immediate</a>
 <b>Submitter:</b> Tomasz Kami&nacute;ski <b>Opened:</b> 2020-02-13 <b>Last modified:</b> 2020-02-14 09:37:04 UTC</p>
<p><b>Priority: </b>1
</p>
<p><b>View other</b> <a href="lwg-index-open.html#range.istream.iterator">active issues</a> in [range.istream.iterator].</p>
<p><b>View all other</b> <a href="lwg-index.html#range.istream.iterator">issues</a> in [range.istream.iterator].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Immediate">Immediate</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The <tt>ranges::basic_istream_view::iterator</tt> is a move-only type, and as such it does not meets the 
<i>Cpp17</i> iterator requirements, yet it does provides <tt>iterator_category</tt> (intended to be used for 
<i>Cpp17</i> iterators). We should provide <tt>iterator_concept</tt> instead.
</p>

<p><i>[2020-02 Status to Immediate on Thursday night in Prague.]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="https://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.6.4.3 <a href="https://timsong-cpp.github.io/cppwp/range.istream.iterator">[range.istream.iterator]</a> as indicated:</p>

<blockquote>
<pre>
namespace std::ranges {
  template&lt;class Val, class CharT, class Traits&gt;
  class basic_istream_view&lt;Val, CharT, Traits&gt;::<i>iterator</i> { <i>// exposition only</i>
  public:
    using <del>iterator_category</del><ins>iterator_concept</ins> = input_iterator_tag;
    using difference_type = ptrdiff_t;
    using value_type = Val;

    <i>iterator</i>() = default;
    [&hellip;]
  };
}
</pre>
<blockquote>
<p>
</p>
</blockquote>
</blockquote>
</li>

</ol>





<hr>
<h3><a name="3398" href="3398">3398.</a> <tt>tuple_element_t</tt> is also wrong for <tt>const subrange</tt></h3>
<p><b>Section:</b> 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2019-02-13 <b>Last modified:</b> 2020-02-13 21:09:02 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#ranges.syn">active issues</a> in [ranges.syn].</p>
<p><b>View all other</b> <a href="lwg-index.html#ranges.syn">issues</a> in [ranges.syn].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
As currently specified, it uses the <i>cv</i>-qualified partial specialization, which incorrectly
adds <i>cv</i>-qualification to the element type.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>, header <tt>&lt;ranges&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]
namespace std {
  namespace views = ranges::views;

  template&lt;class I, class S, ranges::subrange_kind K&gt;
  struct tuple_size&lt;ranges::subrange&lt;I, S, K&gt;&gt;
    : integral_constant&lt;size_t, 2&gt; {};
  template&lt;class I, class S, ranges::subrange_kind K&gt;
  struct tuple_element&lt;0, ranges::subrange&lt;I, S, K&gt;&gt; {
    using type = I;
  };
  template&lt;class I, class S, ranges::subrange_kind K&gt;
  struct tuple_element&lt;1, ranges::subrange&lt;I, S, K&gt;&gt; {
    using type = S;
  };
  <ins>template&lt;class I, class S, ranges::subrange_kind K&gt;</ins>
  <ins>struct tuple_element&lt;0, const ranges::subrange&lt;I, S, K&gt;&gt; {</ins>
    <ins>using type = I;</ins>
  <ins>};</ins>
  <ins>template&lt;class I, class S, ranges::subrange_kind K&gt;</ins>
  <ins>struct tuple_element&lt;1, const ranges::subrange&lt;I, S, K&gt;&gt; {</ins>
    <ins>using type = S;</ins>
  <ins>};</ins>
}
</pre>
</blockquote>
</li>

<li><p>Add the following wording to Annex D:</p>

<blockquote>
<p>
<ins><b>D.? Deprecated <tt>subrange</tt> tuple interface [depr.ranges.syn]</b></ins>
<p/>
<ins>1 The header <tt>&lt;ranges&gt;</tt> (24.2 <a href="https://timsong-cpp.github.io/cppwp/ranges.syn">[ranges.syn]</a>) has the following additions:</ins>
</p>
<blockquote><pre>
<ins>namespace std {</ins>
  <ins>template&lt;size_t X, class I, class S, ranges::subrange_kind K&gt;</ins>
  <ins>struct tuple_element&lt;X, volatile ranges::subrange&lt;I, S, K&gt;&gt; {};</ins>
  <ins>template&lt;size_t X, class I, class S, ranges::subrange_kind K&gt;</ins>
  <ins>struct tuple_element&lt;X, const volatile ranges::subrange&lt;I, S, K&gt;&gt; {};</ins>
<ins>}</ins>
</pre></blockquote>
</blockquote>
</li>

</ol>




<hr>
<h3><a name="3399" href="3399">3399.</a> <tt>basic_syncbuf::emit()</tt> + Qt's <tt>#define emit</tt> = Big Bada-Boom</h3>
<p><b>Section:</b> 29.10.2.1 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.overview">[syncstream.syncbuf.overview]</a> <b>Status:</b> <a href="lwg-active.html#New">New</a>
 <b>Submitter:</b> Marc Mutz <b>Opened:</b> 2019-02-14 <b>Last modified:</b> 2020-02-14 07:38:36 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#syncstream.syncbuf.overview">issues</a> in [syncstream.syncbuf.overview].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#New">New</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current IS contains a function called <tt>emit()</tt> (in <tt>basic_syncbuf</tt>, added by <a href="http://wg21.link/p0053">P0053</a>).
<p/>
<tt>emit</tt> is a macro in pervasive use in every <a href="https://doc.qt.io/qt-5/signalsandslots.html#a-small-example">Qt program</a>. 
<tt>#include</tt>'ing <tt>&lt;osyncstream&gt;</tt> after any Qt header would break, because <tt>emit</tt> was <tt>#define</tt>'d 
to nothing by the Qt headers.
<p/>
It is understood that the committee cannot check every 3rd-party library out there that chooses (badly, as Id readily concur) to 
<tt>#define</tt> a macro of all-lowercase letters, but the <tt>min</tt>/<tt>max</tt> issue in the Windows headers caused so much 
pain for our users, that we probably should avoid a breakage here, for the benefit of our users that have to work Qt.
<p/>
It also doesnt seem like <tt>emit()</tt> is a particularly mandatory name for the syncbuf function. Since it returns <tt>bool</tt>, 
it could just as easily be called <tt>try_emit()</tt> and the issue would be solved.
<p/>
Suggested approach:
<p/>
In <tt>basic_syncbuf</tt>, rename <tt>bool emit()</tt> to <tt>bool try_emit()</tt>. In <tt>basic_osyncstream</tt>, where the function 
doesn't return <tt>bool</tt>, but sets the stream's <tt>failbit</tt>, rename <tt>void emit()</tt> to <tt>void emit_or_fail()</tt>.
</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4849">N4849</a>.</p>

<ol>
<li><p>Modify 29.7.5.4 <a href="https://timsong-cpp.github.io/cppwp/ostream.manip">[ostream.manip]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class charT, class traits&gt;
  basic_ostream&lt;charT, traits&gt;&amp; flush_emit(basic_ostream&lt;charT, traits&gt;&amp; os);
</pre>
<blockquote>
<p>
-12- <i>Effects:</i> Calls <tt>os.flush()</tt>. Then, if <tt>os.rdbuf()</tt> is a <tt>basic_syncbuf&lt;charT, traits, Allocator&gt;*</tt>,
called <tt>buf</tt> for the purpose of exposition, calls <tt>buf-&gt;<ins>try_</ins>emit()</tt>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 29.10.2.1 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.overview">[syncstream.syncbuf.overview]</a> as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<i>// 29.10.2.4 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.members">[syncstream.syncbuf.members]</a>, member functions</i>
bool <ins>try_</ins>emit();
streambuf_type* get_wrapped() const noexcept;
[&hellip;]
</pre>
<blockquote>
<p>
-1- Class template <tt>basic_syncbuf</tt> stores character data written to it, known as the associated output, into
internal buffers allocated using the object's allocator. The associated output is transferred to the wrapped
stream buffer object <tt>*wrapped</tt> when <tt><ins>try_</ins>emit()</tt> is called or when the <tt>basic_syncbuf</tt> 
object is destroyed. Such transfers are atomic with respect to transfers by other <tt>basic_syncbuf</tt> objects 
with the same wrapped stream buffer object.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 29.10.2.2 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.cons">[syncstream.syncbuf.cons]</a> as indicated:</p>

<blockquote>
<pre>
~basic_syncbuf();
</pre>
<blockquote>
<p>
-7- <i>Effects:</i> Calls <tt><ins>try_</ins>emit()</tt>.
<p/>
-8- <i>Throws:</i> Nothing. If an exception is thrown from <tt><ins>try_</ins>emit()</tt>, the destructor catches and ignores that
exception.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 29.10.2.3 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.assign">[syncstream.syncbuf.assign]</a> as indicated:</p>

<blockquote>
<pre>
basic_syncbuf&amp; operator=(basic_syncbuf&amp;&amp; rhs) noexcept;
</pre>
<blockquote>
<p>
-1- <i>Effects:</i> Calls <tt><ins>try_</ins>emit()</tt> then move assigns from <tt>rhs</tt>. After the move assignment <tt>*this</tt> 
has the observable state it would have had if it had been move constructed from <tt>rhs</tt> (29.10.2.2 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.cons">[syncstream.syncbuf.cons]</a>).
</p>
</blockquote>
</blockquote>
</li>

<li><p>Replace in 29.10.2.4 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.members">[syncstream.syncbuf.members]</a> all occurrences of <tt>emit()</tt> by <tt>try_emit()</tt> (five occurrences)</p>
</li>

<li><p>Replace in 29.10.2.5 <a href="https://timsong-cpp.github.io/cppwp/syncstream.syncbuf.virtuals">[syncstream.syncbuf.virtuals]</a> all occurrences of <tt>emit()</tt> by <tt>try_emit()</tt> (three occurrences)</p>
</li>

<li><p>Modify 29.10.3.1 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream.overview">[syncstream.osyncstream.overview]</a> as indicated:</p>

<blockquote>
<pre>
[&hellip;]
<i>// 29.10.3.4 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream.members">[syncstream.osyncstream.members]</a>, member functions</i>
void emit<ins>_or_fail</ins>();
streambuf_type* get_wrapped() const noexcept;
[&hellip;]
</pre>
<blockquote>
</blockquote>
</blockquote>
</li>

<li><p>Replace in 29.10.3.2 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream.cons">[syncstream.osyncstream.cons]</a> all occurrences of <tt>emit()</tt> by <tt>emit_or_fail()</tt> (three occurrences)</p>
</li>

<li><p>Replace in 29.10.3.3 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream.assign">[syncstream.osyncstream.assign]</a> all occurrences of <tt>emit()</tt> by <tt>emit_or_fail()</tt> (two occurrences)</p>
</li>

<li><p>Replace in 29.10.3.4 <a href="https://timsong-cpp.github.io/cppwp/syncstream.osyncstream.members">[syncstream.osyncstream.members]</a> all occurrences of <tt>emit()</tt> by <tt>emit_or_fail()</tt> (six occurrences)</p>
</li>

</ol>




</body>
</html>
