<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Issue 4512: The system_encoded_string() and generic_system_encoded_string() member functions 
of std::filesystem::path are misnamed</title>
<meta property="og:title" content="Issue 4512: The system_encoded_string() and generic_system_encoded_string() member functions 
of std::filesystem::path are misnamed">
<meta property="og:description" content="C++ library issue. Status: Ready">
<meta property="og:url" content="https://timsong-cpp.github.io/lwg-issues/4512.html">
<meta property="og:type" content="website">
<meta property="og:image" content="http://cplusplus.github.io/LWG/images/cpp_logo.png">
<meta property="og:image:alt" content="C++ logo">
<style>
  p {text-align:justify}
  li {text-align:justify}
  pre code.backtick::before { content: "`" }
  pre code.backtick::after { content: "`" }
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table.issues-index { border: 1px solid; border-collapse: collapse; }
  table.issues-index th { text-align: center; padding: 4px; border: 1px solid; }
  table.issues-index td { padding: 4px; border: 1px solid; }
  table.issues-index td:nth-child(1) { text-align: right; }
  table.issues-index td:nth-child(2) { text-align: left; }
  table.issues-index td:nth-child(3) { text-align: left; }
  table.issues-index td:nth-child(4) { text-align: left; }
  table.issues-index td:nth-child(5) { text-align: center; }
  table.issues-index td:nth-child(6) { text-align: center; }
  table.issues-index td:nth-child(7) { text-align: left; }
  table.issues-index td:nth-child(5) span.no-pr { color: red; }
  @media (prefers-color-scheme: dark) {
     html {
        color: #ddd;
        background-color: black;
     }
     ins {
        background-color: #225522
     }
     del {
        background-color: #662222
     }
     a {
        color: #6af
     }
     a:visited {
        color: #6af
     }
     blockquote.note
     {
        background-color: rgba(255, 255, 255, .10)
     }
  }
</style>
</head>
<body>
<hr>
<h3 id="4512"><a href="lwg-active.html#4512">4512</a>. The <code class='backtick'>system_encoded_string()</code> and <code class='backtick'>generic_system_encoded_string()</code> member functions 
of <code class='backtick'>std::filesystem::path</code> are misnamed</h3>
<p><b>Section:</b> 31.12.6.1 <a href="https://timsong-cpp.github.io/cppwp/fs.class.path.general">[fs.class.path.general]</a>, 31.12.6.3.2 <a href="https://timsong-cpp.github.io/cppwp/fs.path.type.cvt">[fs.path.type.cvt]</a>, 31.12.6.5.6 <a href="https://timsong-cpp.github.io/cppwp/fs.path.native.obs">[fs.path.native.obs]</a>, 31.12.6.5.7 <a href="https://timsong-cpp.github.io/cppwp/fs.path.generic.obs">[fs.path.generic.obs]</a>, D.22.2 <a href="https://timsong-cpp.github.io/cppwp/depr.fs.path.obs">[depr.fs.path.obs]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Ready</a>
 <b>Submitter:</b> Tom Honermann <b>Opened:</b> 2026-01-11 <b>Last modified:</b> 2026-02-20</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Ready">Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<b>Addresses <a href="https://github.com/cplusplus/nbballot/issues/879">US 189-304</a></b>
<p/>
The <code class='backtick'>system_encoded_string()</code> and <code class='backtick'>generic_system_encoded_string()</code> member functions of 
<code class='backtick'>std::filesystem::path</code> are misnamed. These functions were added as renamed versions of 
<code class='backtick'>string()</code> and <code class='backtick'>generic_string()</code> respectively by <a href="https://wg21.link/P2319R5" title=" Prevent path presentation problems">P2319R5</a> ("Prevent path 
presentation problems"). The original function names are now deprecated.
<p/>
The C++ standard does not define "system encoding" and casual use of such a term is at best 
ambiguous. In common language, one might expect the "system encoding" to correspond to the 
environment encoding (for which <code class='backtick'>std::text_encoding::environment()</code> provides a definition) 
or the encoding of the current locale. However, neither of these encodings corresponds to 
the encoding these functions are expected to use. 31.12.6.3.2 <a href="https://timsong-cpp.github.io/cppwp/fs.path.type.cvt">[fs.path.type.cvt]</a> defines 
"native encoding" and, for <code class='backtick'>char</code>-based filesystem paths, states (in a note) that 
"For Windows-based operating systems, the native ordinary encoding is determined by calling 
a Windows API function." It is not specified which Windows API function is consulted, but 
existing implementations call <code class='backtick'>AreFileApisANSI()</code> to choose between the Active Code Page 
(<code class='backtick'>CP_ACP</code>) and the OEM Code Page (<code class='backtick'>CP_OEMCP</code>). Microsoft's implementation also checks for 
a thread-local locale and, if the locale encoding is UTF-8, prefers that (<code class='backtick'>CP_UTF8</code>) over 
either of the other two.
</p>

<p><i>[2026-02-20; LWG telecon; Status changed: New &rarr; Ready.]</i></p>



<p id="res-4512"><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="https://wg21.link/N5032" title=" Working Draft, Standard for Programming Language C++">N5032</a>.
</p>

<ol>
<li><p>Modify 31.12.6.1 <a href="https://timsong-cpp.github.io/cppwp/fs.class.path.general">[fs.class.path.general]</a>, class <code>path</code> synopsis, as indicated:</p>

<blockquote>
<pre>
namespace std::filesystem {
  class path {
  public:
    [&hellip;]
    // <i>31.12.6.5.6 <a href="https://timsong-cpp.github.io/cppwp/fs.path.native.obs">[fs.path.native.obs]</a>, native format observers</i>
    [&hellip;]
    std::string display_string() const;
    std::string <del>system</del><ins>native</ins>_encoded_string() const;
    std::wstring wstring() const;
    [&hellip;]
    
    // <i>31.12.6.5.7 <a href="https://timsong-cpp.github.io/cppwp/fs.path.generic.obs">[fs.path.generic.obs]</a>, generic format observers</i>
    [&hellip;]
    std::string generic_display_string() const;
    std::string generic_<del>system</del><ins>native</ins>_encoded_string() const;
    std::wstring generic_wstring() const;
    [&hellip;]
  };
}
</pre>
</blockquote>
</li>

<li><p>Modify 31.12.6.3.2 <a href="https://timsong-cpp.github.io/cppwp/fs.path.type.cvt">[fs.path.type.cvt]</a> as indicated:</p>

<blockquote>
<p>
-2- For member function arguments that take character sequences representing paths and for member functions
returning strings, value type and encoding conversion is performed if the value type of the argument or return
value differs from <code class='backtick'>path::value_type</code>. For the argument or return value, the method of conversion and the
encoding to be converted to is determined by its value type:
</p>
<ul style="list-style-type: none">
<li><p>(2.1) &mdash; <code class='backtick'>char</code>: The encoding is the native ordinary encoding. The method of conversion, if any, 
is operating system dependent.
<p/>
[<i>Note 1</i>: For POSIX-based operating systems <code class='backtick'>path::value_type</code> is <code class='backtick'>char</code> so no conversion from 
<code class='backtick'>char</code> value type arguments or to <code class='backtick'>char</code> value type return values is performed. For Windows-based operating systems, 
the native ordinary encoding is determined by <del>calling a Windows API function</del><ins>the current locale 
encoding and the Windows <code class='backtick'>AreFileApisANSI</code> function</ins>. &mdash; end note]
<p/>
[&hellip;]
</p></li>
<li><p>(2.2) &mdash; [&hellip;]</p></li>
<li><p>[&hellip;]</p></li>
</ul>

</blockquote>
</li>

<li><p>Modify 31.12.6.5.6 <a href="https://timsong-cpp.github.io/cppwp/fs.path.native.obs">[fs.path.native.obs]</a> as indicated:</p>

<blockquote>
<pre>
std::string <del>system</del><ins>native</ins>_encoded_string() const;
std::wstring wstring() const;
std::u8string u8string() const;
std::u16string u16string() const;
std::u32string u32string() const;
</pre>
<blockquote>
<p>
-7- <i>Returns</i>: <code class='backtick'>native()</code>.
<p/>
-8- <i>Remarks</i>: Conversion, if any, is performed as specified by 31.12.6.3 <a href="https://timsong-cpp.github.io/cppwp/fs.path.cvt">[fs.path.cvt]</a>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify 31.12.6.5.7 <a href="https://timsong-cpp.github.io/cppwp/fs.path.generic.obs">[fs.path.generic.obs]</a> as indicated:</p>

<blockquote>
<pre>
std::string generic_<del>system</del><ins>native</ins>_encoded_string() const;
std::wstring generic_wstring() const;
std::u8string generic_u8string() const;
std::u16string generic_u16string() const;
std::u32string generic_u32string() const;
</pre>
<blockquote>
<p>
-5- <i>Returns</i>: The pathname in the generic format.
<p/>
-6- <i>Remarks</i>: Conversion, if any, is specified by 31.12.6.3 <a href="https://timsong-cpp.github.io/cppwp/fs.path.cvt">[fs.path.cvt]</a>.
</p>
</blockquote>
</blockquote>
</li>

<li><p>Modify D.22.2 <a href="https://timsong-cpp.github.io/cppwp/depr.fs.path.obs">[depr.fs.path.obs]</a> as indicated:</p>

<blockquote>
<pre>
std::string string() const;
</pre>
<blockquote>
<p>
-2- <i>Returns</i>: <code><del>system</del><ins>native</ins>_encoded_string()</code>.
</p>
</blockquote>
<pre>
std::string generic_string() const;
</pre>
<blockquote>
<p>
-3- <i>Returns</i>: <code>generic_<del>system</del><ins>native</ins>_encoded_string()</code>.
</p>
</blockquote>
</blockquote>
</li>

</ol>







</body>
</html>
