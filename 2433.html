<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>Issue 2433: uninitialized_copy()/etc. should tolerate overloaded operator&amp;</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<p>Revised 2016-11-28 at 17:11:16 UTC</p>
<hr>
<h3><a name="2433" href="2433">2433.</a> <tt>uninitialized_copy()</tt>/etc. should tolerate overloaded <tt>operator&amp;</tt></h3>
<p><b>Section:</b> 20.10.10 [specialized.algorithms] <b>Status:</b> <a href="lwg-active.html#WP">WP</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2014-10-01 <b>Last modified:</b> 2015-05-22</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#specialized.algorithms">issues</a> in [specialized.algorithms].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#WP">WP</a> status.</p>
<p><b>Discussion:</b></p>
<p>
This restriction isn't necessary anymore. In fact, this is the section that defines <tt>addressof()</tt>.
</p>
<p>
(Editorial note: We can depict these algorithms as calling <tt>addressof()</tt> instead of <tt>std::addressof()</tt> 
thanks to 17.5.1.1 [contents]/3 "Whenever a name <tt>x</tt> defined in the standard library is mentioned, the name 
<tt>x</tt> is assumed to be fully qualified as <tt>::std::x</tt>, unless explicitly described otherwise.")
</p>

<p><i>[Urbana 2014-11-07: Move to Ready]</i></p>




<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N3936.
</p>

<ol>
<li><p>Change 20.10.10 [specialized.algorithms] p1 as depicted:</p>

<blockquote>
<p>
-1- <del>All the iterators that are used as formal template parameters in the following algorithms are required to
have their <tt>operator*</tt> return an object for which <tt>operator&amp;</tt> is defined and returns a pointer to 
<tt>T</tt>.</del> In the algorithm <tt>uninitialized_copy</tt>, the formal template parameter <tt>InputIterator</tt> 
is required to satisfy the requirements of an input iterator (24.2.3). In all of the following algorithms, the formal 
template parameter <tt>ForwardIterator</tt> is required to satisfy the requirements of a forward iterator (24.2.5), 
and is required to have the property that no exceptions are thrown from increment, assignment, comparison, or indirection
through valid iterators. In the following algorithms, if an exception is thrown there are no effects.
</p>
</blockquote>
</li>

<li><p>Change 20.10.10.4 [uninitialized.copy] p1 as depicted:</p>
<blockquote>
<p>
-1- <i>Effects</i>:
</p>
<blockquote>
<pre>
for (; first != last; ++result, ++first)
  ::new (static_cast&lt;void*&gt;(<ins>addressof(</ins><del>&amp;</del>*result<ins>)</ins>))
    typename iterator_traits&lt;ForwardIterator&gt;::value_type(*first);
</pre>
</blockquote>
</blockquote>
</li>

<li><p>Change 20.10.10.4 [uninitialized.copy] p3 as depicted:</p>
<blockquote>
<p>
-3- <i>Effects</i>:
</p>
<blockquote>
<pre>
for (; n &gt; 0; ++result, ++first, --n) {
  ::new (static_cast&lt;void*&gt;(<ins>addressof(</ins><del>&amp;</del>*result<ins>)</ins>))
    typename iterator_traits&lt;ForwardIterator&gt;::value_type(*first);
}
</pre>
</blockquote>
</blockquote>
</li>

<li><p>Change 20.10.10.6 [uninitialized.fill] p1 as depicted:</p>
<blockquote>
<p>
-1- <i>Effects</i>:
</p>
<blockquote>
<pre>
for (; first != last; ++first)
  ::new (static_cast&lt;void*&gt;(<ins>addressof(</ins><del>&amp;</del>*first<ins>)</ins>))
    typename iterator_traits&lt;ForwardIterator&gt;::value_type(x);
</pre>
</blockquote>
</blockquote>
</li>

<li><p>Change 99 [uninitialized.fill.n] p1 as depicted:</p>
<blockquote>
<p>
-1- <i>Effects</i>:
</p>
<blockquote>
<pre>
for (; n--; ++first)
  ::new (static_cast&lt;void*&gt;(<ins>addressof(</ins><del>&amp;</del>*first<ins>)</ins>))
    typename iterator_traits&lt;ForwardIterator&gt;::value_type(x);
return first;
</pre>
</blockquote>
</blockquote>
</li>
</ol>






</body>
</html>
