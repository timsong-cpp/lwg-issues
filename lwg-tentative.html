<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>C++ Standard Library Tentative Issues</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<p><p>Revised 2017-06-17 at 10:55:49 UTC</p>
</p><h2>Tentative Issues</h2>
<hr>
<h3><a name="760" href="760">760.</a> The emplace issue</h3>
<p><b>Section:</b> 26.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a> <b>Status:</b> <a href="lwg-active.html#NAD">Tentatively NAD</a>
 <b>Submitter:</b> Paolo Carlini <b>Opened:</b> 2007-11-11 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all other</b> <a href="lwg-index.html#container.requirements">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively NAD">Tentatively NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>
In an <tt>emplace</tt> member function the function parameter pack may be bound
to a priori unlimited number of objects: some or all of them can be
elements of the container itself. Apparently, in order to conform to the
blanket statement 26.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>/11, the
implementation must check all of them for that possibility. A possible
solution can involve extending the exception in 26.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>/12 also to the emplace member. As a
side note, the <tt>push_back</tt> and <tt>push_front</tt> member
functions are luckily not affected by this problem, can be efficiently
implemented anyway.
</p>

<p><i>[
Related to <a href="767">767</a> and to <a href="2164">2164</a>
]</i></p>


<p><i>[
Bellevue:
]</i></p>


<blockquote>
<p>
The proposed addition (13) is partially redundant with the existing
paragraph 12. Why was the qualifier "rvalues" added to paragraph 12? Why
does it not cover subelements and pointers?
</p>
<p>
Resolution: Alan Talbot to rework language, then set state to Review.
</p>
</blockquote>

<p><i>[
2009-07 Frankfurt
]</i></p>


<blockquote>
<p>
The problem is broader than <tt>emplace</tt>. The LWG doesn't
feel that it knows how to write wording that prohibits all of the
problematic use cases at this time.
</p>
<p>
NAD Future.
</p>
</blockquote>

<p><i>[2015-02 Cologne]</i></p>

<p>
LWG believes that <a href="2164">2164</a> addresses this issue and therefore considers <a href="760">760</a> as NAD. 
</p>


<p><b>Proposed resolution:</b></p>
<p>
Add after 26.2 <a href="https://timsong-cpp.github.io/cppwp/container.requirements">[container.requirements]</a>/12:
</p>

<blockquote>
<p>
-12- Objects passed to member functions of a container as rvalue
references shall not be elements of that container. No diagnostic
required.
</p>
<p>
<ins>
-13- Objects bound to the function parameter pack of the
<tt>emplace</tt> member function shall not be elements or sub-objects of
elements of the container. No diagnostic required.
</ins>
</p>

</blockquote>






<hr>
<h3><a name="2337" href="2337">2337.</a> <tt>shared_ptr operator*()</tt> should not be <tt>noexcept</tt></h3>
<p><b>Section:</b> 23.11.2.2.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.obs">[util.smartptr.shared.obs]</a> <b>Status:</b> <a href="lwg-active.html#NAD">Tentatively NAD</a>
 <b>Submitter:</b> Stephan T. Lavavej <b>Opened:</b> 2013-10-05 <b>Last modified:</b> 2016-01-28 10:19:27 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#util.smartptr.shared.obs">active issues</a> in <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.obs">[util.smartptr.shared.obs]</a>.</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.shared.obs">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.obs">[util.smartptr.shared.obs]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively NAD">Tentatively NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>
23.11.1.2.4 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.observers">[unique.ptr.single.observers]</a>/3: "<tt>pointer operator-&gt;() const noexcept;</tt> <i>Requires:</i> <tt>get() != nullptr</tt>."
<p/>
23.11.2.2.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.obs">[util.smartptr.shared.obs]</a>/2: "<tt>T&amp; operator*() const noexcept;</tt> <i>Requires:</i> <tt>get() != 0</tt>."
<p/>
23.11.2.2.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.obs">[util.smartptr.shared.obs]</a>/5: "<tt>T* operator-&gt;() const noexcept;</tt> <i>Requires:</i> <tt>get() != 0</tt>."
<p/>
Narrow-contract functions should not be <tt>noexcept</tt>.
</p>

<p><i>[2014-02-15 Issaquah]</i></p>

<p>
Issue is contentious, raise to P2.
</p>

<p><i>[2015-02 Cologne]</i></p>

<p>
AM: This ship has sailed. JM: What's the issue? AM: <tt>operator-&gt;</tt> has narrow contract and should never have had 
<tt>noexcept</tt>. DK: Not quite. We explicitly called out that for <tt>shared_ptr</tt> this is fine. You said so in your 
"narrow contract" paper. GR: This would be a fairly major regression in the design of {<tt>unique</tt>,<tt>shared</tt>}<tt>_ptr</tt> 
over raw pointers; raw pointer dereferencing is <tt>noexcept</tt>. It's not a performance regression but a usability regression. 
AM: Do we expect users to query <tt>noexpect</tt> on dereference expressions? Room: Yes. VV: We don't just expect it, we have 
seen it. JM: Yes, users may be querying something like <tt>noexcept(x-&gt;y)</tt> and expect to be checking <tt>y</tt>, but 
silently end up checking <tt>x-&gt;</tt>. 
<p/>
Close as NAD, with explanation from GR.
</p>

<strong>Previous resolution [SUPERSEDED]:</strong>
<blockquote class="note">
<p>This wording is relative to N3691.</p>

<ol>
<li><p>In 23.11.1.2 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single">[unique.ptr.single]</a>/1, class template <tt>unique_ptr</tt> synopsis for single objects, change as indicated:</p>

<blockquote><pre>
pointer operator-&gt;() const <del>noexcept</del>;
</pre></blockquote>
</li>

<li><p>In 23.11.1.2.4 <a href="https://timsong-cpp.github.io/cppwp/unique.ptr.single.observers">[unique.ptr.single.observers]</a> change as indicated:</p>

<blockquote><pre>
pointer operator-&gt;() const <del>noexcept</del>;
</pre><blockquote>
<p>
-3- <i>Requires:</i> <tt>get() != nullptr</tt>.
<p/>
-4- <i>Returns:</i> <tt>get()</tt>.
<p/>
<ins>-?- <i>Throws:</i> Nothing.</ins>
<p/>
-5- <i>Note:</i> use typically requires that <tt>T</tt> be a complete type.
</p>
</blockquote></blockquote>
</li>

<li><p>In 23.11.2.2 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared">[util.smartptr.shared]</a>/1, class template <tt>shared_ptr</tt> synopsis, change as indicated:</p>

<blockquote><pre>
T&amp; operator*() const <del>noexcept</del>;
T* operator-&gt;() const <del>noexcept</del>;
</pre></blockquote>
</li>

<li><p>In 23.11.2.2.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.shared.obs">[util.smartptr.shared.obs]</a> change as indicated:</p>

<blockquote><pre>
T&amp; operator*() const <del>noexcept</del>;
</pre><blockquote>
<p>
-2- <i>Requires:</i> <tt>get() != 0</tt>.
<p/>
-3- <i>Returns:</i> <tt>*get()</tt>.
<p/>
<ins>-?- <i>Throws:</i> Nothing.</ins>
<p/>
-4- <i>Remarks:</i> When <tt>T</tt> is <tt>void</tt>, it is unspecified whether this member function is declared. 
If it is declared, it is unspecified what its return type is, except that the declaration (although not necessarily the
definition) of the function shall be well formed.
</p>
</blockquote></blockquote>

<blockquote><pre>
T* operator-&gt;() const <del>noexcept</del>;
</pre><blockquote>
<p>
-5- <i>Requires:</i> <tt>get() != 0</tt>.
<p/>
-6- <i>Returns:</i> <tt>get()</tt>.
<p/>
<ins>-?- <i>Throws:</i> Nothing.</ins>
</p>
</blockquote></blockquote>
</li>

</ol>
</blockquote>

<p><i>[2015-03-03, Geoffrey provides rationale]</i></p>

<p>
<b>Rationale</b>:
</p>
<blockquote>
<p>
It is by design that these members are <tt>noexcept</tt>, and changing that now would be a substantial regression in functionality. 
These classes were designed to substitute for plain pointers as transparently as possible, so since those operations are effectively 
<tt>noexcept</tt> on plain pointers, they should be <tt>noexcept</tt> on <tt>unique_ptr</tt> and <tt>shared_ptr</tt> as well. 
This matters in practice because we expect these members to be used fairly often inside the <tt>noexcept</tt> operator, and such 
code could be broken by this change. These design considerations override our general policy against <tt>noexcept</tt> for 
narrow-contract functions.
<p/>
It is notable that N3279, which proposed this policy, did not propose striking <tt>noexcept</tt> from these operations. It's not 
clear if the omission of <tt>operator*</tt> and <tt>operator-&gt;</tt> was an oversight, or an intentional reflection of the above 
considerations. N3279 was based on N3248 by the same authors, which states that:
</p>
<blockquote>
<p>
"Most applications of <tt>noexcept</tt> for <tt>unique_ptr</tt> and <tt>shared_ptr</tt> are on functions with wide contracts. 
However, there are preconditions on the atomic access functions, so these should lose the specification."
</p>
</blockquote>
</blockquote>



<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2444" href="2444">2444.</a> Inconsistent complexity for <tt>std::sort_heap</tt></h3>
<p><b>Section:</b> 28.7.7.4 <a href="https://timsong-cpp.github.io/cppwp/sort.heap">[sort.heap]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Fran&ccedil;ois Dumont <b>Opened:</b> 2014-10-07 <b>Last modified:</b> 2017-03-21 22:54:52 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
While creating complexity tests for the GNU libstdc++ implementation <a href="https://gcc.gnu.org/ml/libstdc++/2014-10/msg00048.html">I 
stumbled</a> across a surprising requirement for the <tt>std::sort_heap</tt> algorithm.
<p/>
In 28.7.7.4 <a href="https://timsong-cpp.github.io/cppwp/sort.heap">[sort.heap]</a> p3 the Standard states:
</p>
<blockquote><p>
<i>Complexity</i>: At most <tt><i>N</i> log(<i>N</i>)</tt> comparisons (where <tt><i>N</i> == last - first</tt>).
</p></blockquote>
<p>
As stated on the libstdc++ mailing list by Marc Glisse <tt>sort_heap</tt> can be implemented by <tt><i>N</i></tt> calls to 
<tt>pop_heap</tt>. As max number of comparisons of <tt>pop_heap</tt> is <tt>2 * log(<i>N</i>)</tt> then <tt>sort_heap</tt> 
max limit should be <tt>2 * log(1) + 2 * log(2) + .... + 2 * log(<i>N</i>)</tt> that is to say <tt>2 * log(<i>N</i>!)</tt>. 
In terms of <tt>log(<i>N</i>)</tt> we can also consider that this limit is also cap by <tt>2 * <i>N</i> * log(<i>N</i>)</tt> 
which is surely what the Standard wanted to set as a limit.
<p/>
This is why I would like to propose to replace paragraph 3 by:
</p>
<blockquote><p>
<i>Complexity</i>: At most <tt><ins>2</ins><i>N</i> log(<i>N</i>)</tt> comparisons (where <tt><i>N</i> == last - first</tt>).
</p></blockquote>

<p><i>[2015-02 Cologne]</i></p>

<p>
Marshall will research the maths and report back in Lenexa.
</p>

<p><i>[2015-05-06 Lenexa]</i></p>

<p>STL: I dislike exact complexity requirements, they prevent one or two extra checks in debug mode. Would it be better to say O(N log(N)) not at most?</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Move to Tentatively Ready. STL may write a paper (with Thomas &amp; Robert) offering guidance about Big-O notation vs. exact requirements.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N3936.
</p>

<ol><li>
<p>
In 28.7.7.4 <a href="https://timsong-cpp.github.io/cppwp/sort.heap">[sort.heap]</a> p3 the Standard states:
</p>
<blockquote>
<pre>
template&lt;class RandomAccessIterator&gt;
  void sort_heap(RandomAccessIterator first, RandomAccessIterator last);
template&lt;class RandomAccessIterator, class Compare&gt;
  void sort_heap(RandomAccessIterator first, RandomAccessIterator last,
                 Compare comp);
</pre>
<blockquote><p>
[&hellip;]
<p/>
-3- <i>Complexity</i>: At most <tt><ins>2</ins><i>N</i> log(<i>N</i>)</tt> comparisons (where <tt><i>N</i> == last - first</tt>).
</p></blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2593" href="2593">2593.</a> Moved-from state of Allocators</h3>
<p><b>Section:</b> 20.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> David Krauss <b>Opened:</b> 2016-02-19 <b>Last modified:</b> 2017-06-05 20:39:07 UTC</p>
<p><b>Priority: </b>4
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.requirements">active issues</a> in <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>.</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.requirements">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
20.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a> suggests that the moved-from state of an allocator may be unequal to its 
previous state. Such a move constructor would break most container implementations, which move-construct the 
embedded allocator along with a compressed pair. Even if a moved-from container is empty, it should still 
subsequently allocate from the same resource pool as it did before.
</p>
<blockquote><pre>
std::vector&lt;int, pool&gt; a(500, my_pool);
auto b = std::move(a); // b uses my_pool too.
a.resize(500); // should still use my_pool.
</pre></blockquote>

<p><i>[2016-02, Jacksonville]</i></p>

<p>Marshall will see if this can be resolved editorially.</p>

<p>
After discussion, the editors and I decided that this could not be handled editorially. 
The bit about a moved-from state of an allocator being the same as the original state is a
normative change. I submitted a <a href="https://github.com/cplusplus/draft/pull/727">pull request</a>
to handle the mismatched variables in the table.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to N4567.
</p>

<ol>
<li><p>Change 20.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 28 &mdash; "Allocator requirements" as indicated:
<blockquote class="note">
<p>
Note there's an editorial error in Table 28 in that line and the surrounding ones. The left column was apparently 
updated to use <tt>u</tt> and the right column is still using <tt>a</tt>/<tt>a1</tt>/<tt>b</tt>.
</p>
</blockquote>
</p>

<blockquote>
<table border="1">
<caption>Table 28 &mdash; Allocator requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X u(move(a));<br/>
X u = move(a);</tt>
</td>
<td></td>
<td>
Shall not exit via an exception.
post: <ins><tt>u</tt> is equal to <tt>a</tt> and equal to the prior value of <tt>a</tt></ins><del><tt>a1</tt> 
equals the prior value of <tt>a</tt></del>.
</td>
<td>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>
</ol>

</blockquote>

<p><i>[2016-06-20, Oulu, Daniel comments]</i></p>

<p>
According to the current working draft, the situation has changed due to changes performed by the project editor, the revised 
resolution has been adjusted to N4594.
</p>

<p><i>[2016-08 - Chicago]</i></p>

<p>Thurs AM: Moved to LEWG, as this decision (should allocators only be copyable, not movable) is design.</p>

<p><i>[2017-02 in Kona, LEWG responds]</i></p>

<p>Alisdair Meredith says that if you have a do-not-propagate-on-move-assignment, 
then the move of the allocator must compare equal to the original.</p>
<p>Have a data structure where all allocators are equal. 
Construct an element somewhere else moving from inside the container 
(which doesn't have a POCMA trait); you don't want the allocator of the
moved-from element to now be different. So in that case, the allocator's 
move constructor must behave the same as copy.</p>
<p>We don't need to go as far as this issue, but going that far is ok for Bloomberg.</p>

<p><i>[2017-06-02 Issues Telecon]</i></p>

<p>We discussed containers that have sentinel nodes, etc, and so might have to 
allocate/deallocate using a moved-from allocator - and decided that we didn't
want any part of that</p>
<p>Adjusted the wording slightly, and moved to Tentatively Ready</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to N4594.
</p>

<ol>
<li><p>Change 20.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 28 &mdash; "Allocator requirements" as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 28 &mdash; Allocator requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X u(std::move(a));<br/>
X u = std::move(a);</tt>
</td>
<td></td>
<td>
Shall not exit via an exception.
post: <ins><tt>u</tt> is equal to <tt>a</tt> and equal to the prior value of <tt>a</tt></ins><del><tt>u</tt> is equal to the prior
value of <tt>a</tt>.</del>.
</td>
<td>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>
</ol>
</blockquote>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4594.
</p>

<ol>
<li><p>Change 20.5.3.5 <a href="https://timsong-cpp.github.io/cppwp/allocator.requirements">[allocator.requirements]</a>, Table 28 &mdash; "Allocator requirements" as indicated:</p>

<blockquote>
<table border="1">
<caption>Table 28 &mdash; Allocator requirements</caption>
<tr>
<th>Expression</th>
<th>Return type</th>
<th>Assertion&#47;note<br/>pre-&#47;post-condition</th>
<th>Default</th>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

<tr>
<td>
<tt>X u(std::move(a));<br/>
X u = std::move(a);</tt>
</td>
<td></td>
<td>
Shall not exit via an exception.
post: <ins>The value of <tt>a</tt> is unchanged and is equal to <tt>u</tt></ins><del><tt>u</tt> is equal to the prior value of <tt>a</tt></del>.
</td>
<td>
</td>
</tr>

<tr>
<td colspan="4" align="center">
<tt>&hellip;</tt>
</td>
</tr>

</table>
</blockquote>

</li>
</ol>






<hr>
<h3><a name="2597" href="2597">2597.</a> <tt>std::log</tt> misspecified for complex numbers</h3>
<p><b>Section:</b> 29.5.8 <a href="https://timsong-cpp.github.io/cppwp/complex.transcendentals">[complex.transcendentals]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Thomas Koeppe <b>Opened:</b> 2016-03-01 <b>Last modified:</b> 2017-03-14 03:14:09 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#complex.transcendentals">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/complex.transcendentals">[complex.transcendentals]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The current specification of <tt>std::log</tt> is inconsistent for complex numbers, specifically, the Returns clause 
(29.5.8 <a href="https://timsong-cpp.github.io/cppwp/complex.transcendentals">[complex.transcendentals]</a>). On the one hand, it states that the imaginary part of the return value lies 
in the <em>closed</em> interval <tt>[-<i>i</i> &pi;, +<i>i</i> &pi;]</tt>. On the other hand, it says that "the branch 
cuts are along the negative real axis" and "the imaginary part of <tt>log(x)</tt> is <tt>+&pi;</tt> when <tt>x</tt> 
is a negative real number".
</p>
<p>
The inconsistency lies in the difference between the mathematical concept of a branch cut and the nature of floating 
point numbers in C++. The corresponding specification in the C standard makes it clearer that if <tt>x</tt> is a real 
number, then <tt>log(x + 0<i>i</i>) = +&pi;</tt>, but <tt>log(x - 0<i>i</i>) = -&pi;</tt>, i.e. they consider positive 
and negative zero to represent the two different limits of approaching the branch cut from opposite directions. In 
other words, the term "negative real number" is misleading, and in fact there are <em>two distinct</em> real numbers, 
<tt>x + 0<i>i</i></tt> and <tt>x - 0<i>i</i></tt>, that compare equal but whose logarithms differ by <tt>2 &pi; <i>i</i></tt>.
</p>
<p>
The resolution should consist of two parts:
</p>
<ol>
<li><p>Double-check that our usage and definition of "branch cut" is sufficiently unambiguous. The C standard contains 
a lot more wording around this that we don't have in C++.</p></li>
<li><p>Change the Returns clause of <tt>log</tt> appropriately. For example: "When <tt>x</tt> is a negative real number, 
<tt>imag(log(x + 0<i>i</i>))</tt> is <tt>&pi;</tt>, and <tt>imag(log(x - 0<i>i</i>))</tt> is <tt>-&pi;</tt>."</p></li>
</ol>
<p>
Current implementations seem to behave as described in (2). 
(<a href="http://melpon.org/wandbox/permlink/pwBDeGiY3HDtFAh8">Try-it-at-home link</a>)
</p>

<p><i>[2016-11-12, Issaquah]</i></p>

<p>Move to Open - Thomas to provide wording</p>

<p><i>[2016-11-15, Thomas comments and provides wording]</i></p>

<p>
Following LWG discussion in Issaquah, I now propose to resolve this issue by removing the normative requirement on the 
function limits, and instead adding a note that the intention is to match the behaviour of C. This allows implementations 
to use the behaviour of C without having to specify what floating point numbers really are.
<p/>
The change applies to both <tt>std::log</tt> and <tt>std::sqrt</tt>.
<p/>
Updated try-at-home link, see <a href="http://melpon.org/wandbox/permlink/tVYVUNfeZ1yoFnp8">here</a>.
</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Minor wording update and status to Tentatively Ready.</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>
This wording is relative to N4606.
</p>
<ol>
<li><p>Change the "returns" element for <tt>std::log</tt> (29.5.8 <a href="https://timsong-cpp.github.io/cppwp/complex.transcendentals">[complex.transcendentals]</a> p17):</p>

<blockquote>
<pre>
template&lt;class T&gt; complex&lt;T&gt; log(const complex&lt;T&gt;&amp; x);
</pre>
<blockquote>
<p>
-16- <i>Remarks:</i> The branch cuts are along the negative real axis.
<p/>
-17- <i>Returns:</i> The complex natural (base-&#8495;) logarithm of <tt>x</tt>. For all <tt>x</tt>, <tt>imag(log(x))</tt> 
lies in the interval <tt>[</tt>-&pi;, &pi;<tt>]</tt><del>, and when <tt>x</tt> is a negative real number, <tt>imag(log(x))</tt> 
is &pi;</del>. <ins>[<i>Note:</i> The semantics of <tt>std::log</tt> are intended to be the same in C++ as they are for 
<tt>clog</tt> in C. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Change the "returns" element for <tt>std::sqrt</tt> (29.5.8 <a href="https://timsong-cpp.github.io/cppwp/complex.transcendentals">[complex.transcendentals]</a> p25):</p>

<blockquote>
<pre>
template&lt;class T&gt; complex&lt;T&gt; sqrt(const complex&lt;T&gt;&amp; x);
</pre>
<blockquote>
<p>
-24- <i>Remarks:</i> The branch cuts are along the negative real axis.
<p/>
-25- <i>Returns:</i> The complex square root of <tt>x</tt>, in the range of the right half-plane. <del>If the argument is a
negative real number, the value returned lies on the positive imaginary axis.</del><ins>[<i>Note:</i> The semantics of 
<tt>std::sqrt</tt> are intended to be the same in C++ as they are for <tt>csqrt</tt> in C. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4606.
</p>
<ol>
<li><p>Change the "returns" element for <tt>std::log</tt> (29.5.8 <a href="https://timsong-cpp.github.io/cppwp/complex.transcendentals">[complex.transcendentals]</a> p17):</p>

<blockquote>
<pre>
template&lt;class T&gt; complex&lt;T&gt; log(const complex&lt;T&gt;&amp; x);
</pre>
<blockquote>
<p>
-16- <i>Remarks:</i> The branch cuts are along the negative real axis.
<p/>
-17- <i>Returns:</i> The complex natural (base-&#8495;) logarithm of <tt>x</tt>. For all <tt>x</tt>, <tt>imag(log(x))</tt> 
lies in the interval <tt>[</tt>-&pi;, &pi;<tt>]</tt><del>, and when <tt>x</tt> is a negative real number, <tt>imag(log(x))</tt> 
is &pi;</del>. <ins>[<i>Note:</i> the semantics of this function are intended to be the same in C++ as they are for 
<tt>clog</tt> in C. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</blockquote>
</li>

<li><p>Change the "returns" element for <tt>std::sqrt</tt> (29.5.8 <a href="https://timsong-cpp.github.io/cppwp/complex.transcendentals">[complex.transcendentals]</a> p25):</p>

<blockquote>
<pre>
template&lt;class T&gt; complex&lt;T&gt; sqrt(const complex&lt;T&gt;&amp; x);
</pre>
<blockquote>
<p>
-24- <i>Remarks:</i> The branch cuts are along the negative real axis.
<p/>
-25- <i>Returns:</i> The complex square root of <tt>x</tt>, in the range of the right half-plane. <del>If the argument is a
negative real number, the value returned lies on the positive imaginary axis.</del><ins>[<i>Note:</i> The semantics of 
this function are intended to be the same in C++ as they are for <tt>csqrt</tt> in C. &mdash; <i>end note</i>]</ins>
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2692" href="2692">2692.</a> Overspecification of lvalueness of bitmask elements</h3>
<p><b>Section:</b> 20.4.2.1.4 <a href="https://timsong-cpp.github.io/cppwp/bitmask.types">[bitmask.types]</a> <b>Status:</b> <a href="lwg-active.html#NAD">Tentatively NAD</a>
 <b>Submitter:</b> Hubert Tong <b>Opened:</b> 2016-04-14 <b>Last modified:</b> 2017-02-02 00:41:18 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#bitmask.types">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/bitmask.types">[bitmask.types]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively NAD">Tentatively NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The usual pattern now used for identifying where bitmask elements are declared, namely, as variables, preclude 
declaring them as enumerators.
<p/>
Compare: <tt>ctype_base::space</tt> in C++03 subclause 22.2.1 [lib.category.ctype] versus the same in N4582 
subclause 22.4.1 [category.ctype].
<p/>
It is unclear whether this is intentional. Further it is unclear if odr-use of bitmask elements is intended to be allowed.
</p>

<p><i>[2016-05 Issues Telecon]</i></p>

<p>
Jonathan believes that this was intentional, and was done by N3110. 
Jonathan will provide more precise references.
</p>


<p><b>Proposed resolution:</b></p>





<hr>
<h3><a name="2717" href="2717">2717.</a> <tt>scoped_allocator_adaptor</tt> uses <tt>forward</tt> to do <tt>move</tt>'s job</h3>
<p><b>Section:</b> 23.13.4 <a href="https://timsong-cpp.github.io/cppwp/allocator.adaptor.members">[allocator.adaptor.members]</a> <b>Status:</b> <a href="lwg-active.html#NAD">Tentatively NAD</a>
 <b>Submitter:</b> Billy Robert O'Neal III <b>Opened:</b> 2016-05-24 <b>Last modified:</b> 2016-06-05 16:20:49 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View other</b> <a href="lwg-index-open.html#allocator.adaptor.members">active issues</a> in <a href="https://timsong-cpp.github.io/cppwp/allocator.adaptor.members">[allocator.adaptor.members]</a>.</p>
<p><b>View all other</b> <a href="lwg-index.html#allocator.adaptor.members">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/allocator.adaptor.members">[allocator.adaptor.members]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively NAD">Tentatively NAD</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<tt>scoped_allocator_adaptor</tt> is specified to use <tt>forward</tt> when
what it is really doing is moving elements. It should use <tt>move</tt>.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to N4582.</p>
<ol>
<li><p>Edit 23.13.4 <a href="https://timsong-cpp.github.io/cppwp/allocator.adaptor.members">[allocator.adaptor.members]</a> p15 as indicated:</p>

<blockquote><pre>
template &lt;class T1, class T2, class U, class V&gt;
  void construct(pair&lt;T1, T2&gt;* p, pair&lt;U, V&gt;&amp;&amp; x);
</pre>
<blockquote>
<p>
<em>Effects:</em> Equivalent to <tt>this-&gt;construct(p, piecewise_construct, 
forward_as_tuple(std::<del>forward</del><ins>move</ins>&lt;U&gt;(x.first)), 
forward_as_tuple(std::<del>forward</del><ins>move</ins>&lt;V&gt;(x.second)))</tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>


<p><b>Proposed resolution:</b></p>
<p>
Withdrawn by the submitter, since the prerequisites were incorrect.
</p>





<hr>
<h3><a name="2783" href="2783">2783.</a> <tt>stack::emplace()</tt> and <tt>queue::emplace()</tt> should return <tt>decltype(auto)</tt></h3>
<p><b>Section:</b> 26.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/queue.defn">[queue.defn]</a>, 26.6.6.1 <a href="https://timsong-cpp.github.io/cppwp/stack.defn">[stack.defn]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2016-10-14 <b>Last modified:</b> 2017-03-14 03:14:09 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The <tt>stack</tt> and <tt>queue</tt> adaptors are now defined as:
</p>
<blockquote><pre>
template &lt;class... Args&gt;
reference emplace(Args&amp;&amp;... args) { return c.emplace_back(std::forward&lt;Args&gt;(args)...); }
</pre></blockquote>
<p>
This breaks any code using <tt>queue&lt;UserDefinedSequence&gt;</tt> or <tt>stack&lt;UserDefinedSequence&gt;</tt> 
until the user-defined containers are updated to meet the new C++17 requirements.
<p/>
If we defined them as returning <tt>decltype(auto)</tt> then we don't break any code. When used with <tt>std::vector</tt> 
or <tt>std::deque</tt> they will return <tt>reference</tt>, as required, but when used with C++14-conforming containers 
they will return <tt>void</tt>, as before.
</p>

<p><i>[2016-11-12, Issaquah]</i></p>

<p>Sat AM: P2</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Status to Tentatively Ready.</p>


<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to N4606.
</p>

<ol>
<li><p>Change return type of <tt>emplace</tt> in class definition in 26.6.4.1 <a href="https://timsong-cpp.github.io/cppwp/queue.defn">[queue.defn]</a>:</p>

<blockquote>
<pre>
template &lt;class... Args&gt;
  <del>reference</del><ins>decltype(auto)</ins> emplace(Args&amp;&amp;... args) { return c.emplace_back(std::forward&lt;Args&gt;(args)...); }
</pre>
</blockquote>
</li>

<li><p>Change return type of <tt>emplace</tt> in class definition in 26.6.6.1 <a href="https://timsong-cpp.github.io/cppwp/stack.defn">[stack.defn]</a>:</p>

<blockquote>
<pre>
template &lt;class... Args&gt;
  <del>reference</del><ins>decltype(auto)</ins> emplace(Args&amp;&amp;... args) { return c.emplace_back(std::forward&lt;Args&gt;(args)...); }
</pre>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2937" href="2937">2937.</a> Is <tt>equivalent("existing_thing", "not_existing_thing")</tt> an error?</h3>
<p><b>Section:</b> 30.10.15.12 <a href="https://timsong-cpp.github.io/cppwp/fs.op.equivalent">[fs.op.equivalent]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Billy Robert O'Neal III <b>Opened:</b> 2017-02-27 <b>Last modified:</b> 2017-03-14 03:14:09 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all other</b> <a href="lwg-index.html#fs.op.equivalent">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/fs.op.equivalent">[fs.op.equivalent]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
See discussion on the LWG mailing list with subject "Is equivalent("existing_thing", "not_existing_thing") an error?", abreviated below:
<p/>
Billy O'Neal:
</p>
<blockquote>
<p>
The existing "an error is reported" effects say that an error is reported for <tt>!exists(p1) &amp;&amp; !exists(p2)</tt>, but 
I'm not sure that treating <tt>equivalent("existing_thing", "not_existing_thing")</tt> as "<tt>false</tt>, no error" makes any more 
sense than for <tt>equivalent("not_existing_thing", "not_existing_thing")</tt>.
<p/>
It's also unfortunate that the current spec requires reporting an error for <tt>is_other(p1) &amp;&amp; is_other(p2)</tt> &mdash; 
there's no reason that you can't give a sane answer for paths to NT pipes. (Do POSIX FIFOs give garbage answers here?)
</p>
</blockquote>
<p>
Davis Herring:
</p>
<blockquote>
<p>
I'm fine with an error if either path does not exist. See also Late 29: I would much prefer
</p>
<blockquote><pre>
file_identity identity(const path&amp;, bool resolve = true);
</pre></blockquote>
<p>
which would of course produce an error if the path did not exist (or, with the default <tt>resolve</tt>, was a broken symlink).
<p/>
See Late 30 and 32 (31 has been resolved). FIFOs pose no trouble: you can even <tt>fstat(2)</tt> on the naked file 
descriptors produced by <tt>pipe(2)</tt>. (That said, I observe the strange inconsistency that Linux but not macOS 
gives both ends of a pipe the same <tt>st_ino</tt>.)
<p/>
POSIX has no reason that I know of to treat any file type specially for <tt>equivalent()</tt>.
</p>
</blockquote>
<p>
Billy O'Neal:
</p>
<blockquote>
<p>
I think such a <tt>file_identity</tt> feature would be useful but we can always add it in addition to <tt>equivalent</tt> 
post-C++17.
</p>
</blockquote>
<p>
Beman Dawes:
</p>
<blockquote>
<p>
Looks good to me. Maybe submit this as an issue right away in the hopes it can go in C++17?
</p>
</blockquote>

<p><i>[2017-03-04, Kona]</i></p>

<p>Set priority to 0; Tentatively Ready</p>


<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4640">N4640</a>.</p>

<ol>
<li><p>Make the following edits to 30.10.15.12 <a href="https://timsong-cpp.github.io/cppwp/fs.op.equivalent">[fs.op.equivalent]</a>:</p>

<blockquote>
<pre>
bool equivalent(const path&amp; p1, const path&amp; p2);
bool equivalent(const path&amp; p1, const path&amp; p2, error_code&amp; ec) noexcept;
</pre>
<blockquote>
<p>
<del>-1- Let <tt>s1</tt> and <tt>s2</tt> be <tt>file_status</tt>s determined as if by <tt>status(p1)</tt> and <tt>status(p2)</tt>, 
respectively.</del>
<p/>
<del>-2- <i>Effects:</i> Determines <tt>s1</tt> and <tt>s2</tt>. If <tt>(!exists(s1) &amp;&amp; !exists(s2)) || (is_other(s1) &amp;&amp; 
is_other(s2))</tt> an error is reported (27.10.7).</del>
<p/>
-3- <i>Returns:</i> <tt>true</tt>, if <del><tt>s1 == s2</tt> and</del> <tt>p1</tt> and <tt>p2</tt> resolve to the same file system 
entity, else <tt>false</tt>. The signature with argument <tt>ec</tt> returns <tt>false</tt> if an error occurs.
<p/>
-4- Two paths are considered to resolve to the same file system entity if two candidate entities reside on the
same device at the same location. <ins>[<i>Note:</i> On POSIX platforms, t</ins><del>T</del>his is determined as if by the values 
of the POSIX <tt>stat</tt> structure, obtained as if by <tt>stat()</tt> for the two paths, having equal <tt>st_dev</tt> values and 
equal <tt>st_ino</tt> values. <ins>&mdash; <i>end note</i>]</ins>
<p/>
<ins>-?- <i>Remarks:</i> <tt>!exists(p1) || !exists(p2)</tt> is an error.</ins>
<p/>
-5- <i>Throws:</i> As specified in 27.10.7.
</p>
</blockquote>
</blockquote>

</li>
</ol>







<hr>
<h3><a name="2940" href="2940">2940.</a> <tt>result_of</tt> specification also needs a little cleanup</h3>
<p><b>Section:</b> D.12 <a href="https://timsong-cpp.github.io/cppwp/depr.meta.types">[depr.meta.types]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Daniel Kr&uuml;gler <b>Opened:</b> 2017-03-04 <b>Last modified:</b> 2017-06-10 21:31:39 UTC</p>
<p><b>Priority: </b>3
</p>
<p><b>View all other</b> <a href="lwg-index.html#depr.meta.types">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/depr.meta.types">[depr.meta.types]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/p0604r0">P0604R0</a> missed a similar adjustment that was performed for the
deprecated type trait templates <tt>is_literal_type</tt> and <tt>is_literal_type_v</tt> via LWG <a href="2838">2838</a>: 
<p/>
Moving the <tt>result_of</tt> to Annex D means that the general prohibition against specializing type traits 
in [meta.type.synop]/1 does no longer exist, so should be explicitly spelled out. Wording will be provided
after publication of the successor of <a href="http://wg21.link/n4640">N4640</a>.
</p>

<p><i>[2017-03-04, Kona]</i></p>

<p>Set priority to 3</p>

<p><i>[2017-04-24, Daniel provides wording]</i></p>

<p>
Instead of enumerating all the templates where adding a specialization is valid, a general exclusion rule is provided.
Albeit currently not needed for the templates handled by this sub-clause, a potential exception case is constructed
to ensure correctness for the first deprecated trait template that would permit specializations by the user.
</p>

<p><i>[2017-06-10, Moved to Tentatively Ready after 6 positive votes on c++std-lib]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li><p>Change D.12 <a href="https://timsong-cpp.github.io/cppwp/depr.meta.types">[depr.meta.types]</a> as indicated:</p>
<blockquote>
<p>
-4- The behavior of a program that adds specializations for <ins>any of the templates defined in this subclause</ins> 
<del><tt>is_literal_type</tt> or <tt>is_literal_type_v</tt></del> is undefined<ins>, unless explicitly permitted by the
specification of the corresponding template</ins>.
</p>
</blockquote>
</li>
</ol>







<hr>
<h3><a name="2942" href="2942">2942.</a> LWG 2873's resolution missed <tt>weak_ptr::owner_before</tt></h3>
<p><b>Section:</b> 23.11.2.3.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak.obs">[util.smartptr.weak.obs]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2017-03-09 <b>Last modified:</b> 2017-06-10 21:25:02 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#util.smartptr.weak.obs">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak.obs">[util.smartptr.weak.obs]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The NB comment asked for <tt>noexcept</tt> on <tt>shared_ptr::owner_before</tt>, <tt>weak_ptr::owner_before</tt>, and 
<tt>owner_less::operator()</tt>, but the PR of LWG <a href="2873">2873</a> only added it to the first and the third one.
</p>

<p><i>[2017-06-03, Moved to Tentatively Ready after 6 positive votes on c++std-lib]</i></p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Edit 23.11.2.3 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak">[util.smartptr.weak]</a>,  class template <tt>weak_ptr</tt> synopsis, as indicated:</p>
<blockquote>
<pre>
[&hellip;]
<i>// 23.11.2.3.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak.obs">[util.smartptr.weak.obs]</a>, observers</i>
[&hellip;]
template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const <ins>noexcept</ins>;
template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const <ins>noexcept</ins>;
</pre>
</blockquote>
</li>

<li><p>Edit 23.11.2.3.5 <a href="https://timsong-cpp.github.io/cppwp/util.smartptr.weak.obs">[util.smartptr.weak.obs]</a> immediately before p4 as indicated:</p>
<blockquote>
<pre>
template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const <ins>noexcept</ins>;
template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const <ins>noexcept</ins>;
</pre>
<blockquote>
<p>
-4- <i>Returns:</i> An unspecified value such that [&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>






<hr>
<h3><a name="2954" href="2954">2954.</a> Specialization of the convenience variable templates should be prohibited</h3>
<p><b>Section:</b> 20.5.4 <a href="https://timsong-cpp.github.io/cppwp/constraints">[constraints]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2017-03-31 <b>Last modified:</b> 2017-06-14 18:20:31 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
There's currently no rule against specializing the various <tt>_v</tt>
convenience variable templates outside of <tt>&lt;type_traits&gt;</tt>.
<p/>
There should be; <tt>foo_v&lt;T&gt;</tt> should be always equal to 
<tt>foo&lt;T&gt;::value</tt>. The correct way to influence, say, 
<tt>is_placeholder_v&lt;T&gt;</tt> should be to specialize <tt>is_placeholder</tt>, 
not <tt>is_placeholder_v</tt>. Otherwise, the editorial changes to use the 
<tt>_v</tt> form to the specification would no longer be editorial but have 
normative impact.
<p/>
Adding a global prohibition in 20.5.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/namespace.std">[namespace.std]</a> seems preferable to
adding individual prohibitions to each affected template; the PR below
carves out an exception for variable templates that are intended to be
specialized by users. As far as I know there are no such templates in
the current WP, but the Ranges TS does use them.
</p>

<p><i>[2017-06-14, Moved to Tentatively Ready after 6 positive votes on c++std-lib]</i></p>



<p><b>Proposed resolution:</b></p>
<p>
This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.
</p>

<ol>
<li><p>Add a paragraph to 20.5.4.2.1 <a href="https://timsong-cpp.github.io/cppwp/namespace.std">[namespace.std]</a>, before p2:</p>

<blockquote>
<p>
-1- The behavior of a C++ program is undefined if it adds declarations or definitions to namespace <tt>std</tt> or to a
namespace within namespace <tt>std</tt> unless otherwise specified. A program may add a template specialization
for any standard library template to namespace <tt>std</tt> only if the declaration depends on a user-defined type
and the specialization meets the standard library requirements for the original template and is not explicitly
prohibited.(footnote: [&hellip;])
<p/>
<ins>-?- The behavior of a C++ program is undefined if it declares an explicit or partial specialization of any 
standard library variable template, except where explicitly permitted by the specification of that variable template.</ins>
<p/>
-2- The behavior of a C++ program is undefined if it declares [&hellip;]
</p>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2961" href="2961">2961.</a> Bad postcondition for <tt>set_default_resource</tt></h3>
<p><b>Section:</b> 23.12.4 <a href="https://timsong-cpp.github.io/cppwp/mem.res.global">[mem.res.global]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Casey Carter <b>Opened:</b> 2017-05-09 <b>Last modified:</b> 2017-06-15 19:55:58 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
The specification of <tt>set_default_resource</tt> in <a href="http://wg21.link/n4659">N4659</a> 
23.12.4 <a href="https://timsong-cpp.github.io/cppwp/mem.res.global">[mem.res.global]</a> reads:
</p>
<blockquote>
<pre>
memory_resource* set_default_resource(memory_resource* r) noexcept;
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> If <tt>r</tt> is non-null, sets the value of the default memory resource pointer to <tt>r</tt>, 
otherwise sets the default memory resource pointer to <tt>new_delete_resource()</tt>.
<p/>
-5- <i>Postconditions:</i> <tt>get_default_resource() == r</tt>.
<p/>
-6- <i>Returns:</i> The previous value of the default memory resource pointer.
<p/>
-7- Remarks: [&hellip;]
</p>
</blockquote>
</blockquote>
<p>
It is apparent that the effects specified in para 4 cannot &mdash; and indeed should not &mdash; achieve the 
postcondition specified in para 5 when <tt>r</tt> is null.
</p>
  
<p><i>[2017-05-13, Tim comments]</i></p>

<p>
This is the same issue as LWG <a href="2522">2522</a>, which <i>just</i> missed the Fundamentals TS working draft used for the merge.
A similar resolution (simply striking the <i>Postconditions:</i> paragraph) might be better.
</p>

<p><strong>Previous resolution [SUPERSEDED]:</strong></p>
<blockquote class="note">
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li>
<p>Modify 23.12.4 <a href="https://timsong-cpp.github.io/cppwp/mem.res.global">[mem.res.global]</a> as follows:</p>

<blockquote>
<pre>
memory_resource* set_default_resource(memory_resource* r) noexcept;
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> If <tt>r</tt> is non-null, sets the value of the default memory resource pointer to <tt>r</tt>, 
otherwise sets the default memory resource pointer to <tt>new_delete_resource()</tt>.
<p/>
-5- <i>Postconditions:</i> <ins>If <tt>r</tt> is non-null,</ins> <tt>get_default_resource() == r</tt>. <ins>Otherwise, 
<tt>get_default_resource() == new_delete_resource()</tt>.</ins>
<p/>
-6- <i>Returns:</i> The previous value of the default memory resource pointer.
<p/>
-7- Remarks: [&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>
</blockquote>

<p><i>[2017-06-13, Casey Carter revises proposed wording]</i></p>

<p>
I suggest to strike the Postconditions paragraph ([mem.res.global]/5) completely, as in LWG <a href="2522">2522</a>
</p>

<p><i>[2017-06-15, Moved to Tentatively Ready after 6 positive votes on c++std-lib]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li>
<p>Modify 23.12.4 <a href="https://timsong-cpp.github.io/cppwp/mem.res.global">[mem.res.global]</a> as follows:</p>

<blockquote>
<pre>
memory_resource* set_default_resource(memory_resource* r) noexcept;
</pre>
<blockquote>
<p>
-4- <i>Effects:</i> If <tt>r</tt> is non-null, sets the value of the default memory resource pointer to <tt>r</tt>, 
otherwise sets the default memory resource pointer to <tt>new_delete_resource()</tt>.
<p/>
<del>-5- <i>Postconditions:</i> <tt>get_default_resource() == r</tt>.</del>
<p/>
-6- <i>Returns:</i> The previous value of the default memory resource pointer.
<p/>
-7- Remarks: [&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2966" href="2966">2966.</a> Incomplete resolution of US 74</h3>
<p><b>Section:</b> 30.10.8.4.6 <a href="https://timsong-cpp.github.io/cppwp/fs.path.native.obs">[fs.path.native.obs]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Jonathan Wakely <b>Opened:</b> 2017-05-25 <b>Last modified:</b> 2017-06-12 17:41:51 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
<a href="http://wg21.link/p0492r1#US74">P0492R1 US-74</a> failed to replace one occurrence of <tt>pathstring</tt>, 
in [fs.path.native.obs] p8. It should be changed to <tt>native()</tt>, as with the other native format observers.
</p>

<p><i>[2017-06-12, Moved to Tentatively Ready after 6 positive votes on c++std-lib]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li>
<p>Edit 30.10.8.4.6 <a href="https://timsong-cpp.github.io/cppwp/fs.path.native.obs">[fs.path.native.obs]</a> as indicated:</p>

<blockquote>
<pre>
std::string string() const;
std::wstring wstring() const;
std::string u8string() const;
std::u16string u16string() const;
std::u32string u32string() const;
</pre>
<blockquote>
<p>
-8- <i>Returns:</i> <tt><del>pathstring</del><ins>native()</ins></tt>.
<p/>
-9- <i>Remarks:</i> Conversion, if any, is performed as specified by 30.10.8.2 <a href="https://timsong-cpp.github.io/cppwp/fs.path.cvt">[fs.path.cvt]</a>. The encoding of the string 
returned by <tt>u8string()</tt> is always UTF-8.
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="2974" href="2974">2974.</a> Diagnose out of bounds <tt>tuple_element</tt>/<tt>variant_alternative</tt></h3>
<p><b>Section:</b> 23.4.4 <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a>, 23.7.4 <a href="https://timsong-cpp.github.io/cppwp/variant.helper">[variant.helper]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Agust&iacute;n K-ballo Berg&eacute; <b>Opened:</b> 2017-06-10 <b>Last modified:</b> 2017-06-12 17:47:12 UTC</p>
<p><b>Priority: </b>Not Prioritized
</p>
<p><b>View all other</b> <a href="lwg-index.html#pair.astuple">issues</a> in <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a>.</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Instantiating <tt>tuple_element</tt> with an out-of-bounds index requires a diagnostic for <tt>tuple</tt> and <tt>array</tt>, 
but not for <tt>pair</tt>. The specification requires an out-of-bounds index for <tt>pair</tt> to go to the base template 
instead, which is undefined.
<p/>
Similarly, instantiating <tt>variant_alternative</tt> with an out-of-bounds index violates a requirement, but it is not 
required to be diagnosed.
</p>

<p><i>[2017-06-12, Moved to Tentatively Ready after 5 positive votes on c++std-lib]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li>
<p>Modify 23.2.1 <a href="https://timsong-cpp.github.io/cppwp/utility.syn">[utility.syn]</a>, header <tt>&lt;utility&gt;</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
[&hellip;]

<i>// 23.4.4 <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a>, tuple-like access to pair</i>
template &lt;class T&gt; class tuple_size;
template &lt;size_t I, class T&gt; class tuple_element;
template &lt;class T1, class T2&gt; struct tuple_size&lt;pair&lt;T1, T2&gt;&gt;;
<ins>template &lt;size_t I, class T1, class T2&gt; struct tuple_element&lt;I, pair&lt;T1, T2&gt;&gt;;</ins>
<del>template &lt;class T1, class T2&gt; struct tuple_element&lt;0, pair&lt;T1, T2&gt;&gt;;
template &lt;class T1, class T2&gt; struct tuple_element&lt;1, pair&lt;T1, T2&gt;&gt;;</del>

[&hellip;]
</pre>
</blockquote>
</li>

<li>
<p>Modify 23.4.4 <a href="https://timsong-cpp.github.io/cppwp/pair.astuple">[pair.astuple]</a> as indicated:</p>

<blockquote>
<pre>
<del>tuple_element&lt;0, pair&lt;T1, T2&gt;&gt;::type</del>
</pre>
<blockquote>
<p>
<del>-1- <i>Value:</i> The type <tt>T1</tt>.</del>
</p>
</blockquote>
<pre>
<del>tuple_element&lt;1, pair&lt;T1, T2&gt;&gt;::type</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Value:</i> The type <tt>T2</tt>.</del>
</p>
</blockquote>
<pre>
<ins>tuple_element&lt;I, pair&lt;T1, T2&gt;&gt;::type</ins>
</pre>
<blockquote>
<p>
<ins>-?- <i>Requires:</i> <tt>I &lt; 2</tt>. The program is ill-formed if <tt>I</tt> is out of bounds.</ins>
<p/>
<ins>-?- <i>Value:</i> The type <tt>T1</tt> if <tt>I == 0</tt>, otherwise the type <tt>T2</tt>.</ins>
</p>
</blockquote>
</blockquote>
</li>

<li>
<p>Modify 23.7.4 <a href="https://timsong-cpp.github.io/cppwp/variant.helper">[variant.helper]</a> as indicated:</p>

<blockquote>
<pre>
variant_alternative&lt;I, variant&lt;Types...&gt;&gt;::type
</pre>
<blockquote>
<p>
-4- <i>Requires:</i> <tt>I &lt; sizeof...(Types)</tt>. <ins>The program is ill-formed if <tt>I</tt> is out of bounds.</ins>
<p/>
-5- <i>Value:</i> The type <tt>T<sub><i>I</i></sub></tt>.
</p>
</blockquote>
</blockquote>
</li>
</ol>






</body>
</html>
