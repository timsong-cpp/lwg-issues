<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta charset="utf-8">
<title>C++ Standard Library Tentative Issues</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
</head>
<body>
<p><p>Revised 2018-03-04 at 16:20:20 UTC</p>
</p><h2>Tentative Issues</h2>
<hr>
<h3><a name="2970" href="2970">2970.</a> Return type of <tt>std::visit</tt> misspecified</h3>
<p><b>Section:</b> 23.7.7 <a href="https://timsong-cpp.github.io/cppwp/variant.visit">[variant.visit]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Tim Song <b>Opened:</b> 2017-05-31 <b>Last modified:</b> 2018-03-03 17:19:23 UTC</p>
<p><b>Priority: </b>2
</p>
<p><b>View other</b> <a href="lwg-index-open.html#variant.visit">active issues</a> in [variant.visit].</p>
<p><b>View all other</b> <a href="lwg-index.html#variant.visit">issues</a> in [variant.visit].</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
[variant.visit]/1 correctly uses "type and value category", but then
p3 describes the return type of <tt>visit</tt> to be "the common type of all
possible <tt><i>INVOKE</i></tt> expressions of the <i>Effects:</i> element." 
The type of an expression is never a reference type, due to [expr]/5 removing the
referenceness "prior to any further analysis", so this wording as
written says that <tt>visit</tt> always returns a non-reference type, which is
presumably not the intent.
</p>

<p><i>[2017-07 Toronto Monday issue prioritization]</i></p>

<p>Priority 2; Matt to provide wording</p>

<p><i>[2018-01-11, Thomas K&ouml;ppe comments and suggests wording]</i></p>

<p>
The return type of <tt>std::visit</tt> (originating by <a href="http://wg21.link/p0088r3">P0088R3</a> 
accepted during the Oulo 2016 meeting) is currently misspecified and refers only to the common 
<em>type</em> of all the possible visitation calls, without attention to the value category. This 
seems unintended, and we should preserve the value category.
</p>

<p><i>[2017-01-24, Daniel comments]</i></p>

<p>
This issue should be reviewed in common with LWG <a href="3052">3052</a>.
</p>

<p><i>[
2018-02-23 Moved to Tentatively Ready after 6 positive votes on c++std-lib.
]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4727">N4727</a>.</p>

<ol>
<li><p>Modify 23.7.7 <a href="https://timsong-cpp.github.io/cppwp/variant.visit">[variant.visit]</a> as indicated:</p>

<blockquote>
<pre>
template&lt;class Visitor, class... Variants&gt;
  constexpr <i>see below</i> visit(Visitor&amp;&amp; vis, Variants&amp;&amp;... vars);
</pre>
<blockquote>
<p>
[&hellip;]
<p/>
-3- <i>Returns:</i> <tt><i>e</i>(<i>m</i>)</tt>, where <tt><i>m</i></tt> is the pack for which 
<tt><i>m<sub>i</sub></i></tt> is <tt>vars<i><sub>i</sub></i>.index()</tt> for all 
<tt>0 &lt;= i &lt; n</tt>. The return type is <del>the type of 
<tt><i>e</i>(<i>m</i>)</tt></del><ins><tt>decltype(<i>e</i>(<i>m</i>))</tt></ins>.
<p/>
[&hellip;]
</p>
</blockquote>
</blockquote>
</li>
</ol>





<hr>
<h3><a name="3062" href="3062">3062.</a> Unnecessary <tt>decay_t</tt> in <tt>is_execution_policy_v</tt> should be <tt>remove_cvref_t</tt></h3>
<p><b>Section:</b> 28.4.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a> <b>Status:</b> <a href="lwg-active.html#Ready">Tentatively Ready</a>
 <b>Submitter:</b> Billy O'Neal III <b>Opened:</b> 2018-02-07 <b>Last modified:</b> 2018-02-13 19:42:20 UTC</p>
<p><b>Priority: </b>0
</p>
<p><b>View all issues with</b> <a href="lwg-status.html#Tentatively Ready">Tentatively Ready</a> status.</p>
<p><b>Discussion:</b></p>
<p>
Our compiler throughput friends were hissing at us about throughput regressions in C++17 mode caused by 
the addition of the parallel algorithms' signatures. One change to reduce the throughput impact would 
be to remove unnecessary decay here, as LWG has done in other places recently.
</p>

<p><i>[
2018-02-13 Moved to Tentatively Ready after 7 positive votes on c++std-lib.
]</i></p>



<p><b>Proposed resolution:</b></p>
<p>This wording is relative to <a href="http://wg21.link/n4713">N4713</a>.</p>

<ol>
<li><p>Modify 28.4.5 <a href="https://timsong-cpp.github.io/cppwp/algorithms.parallel.overloads">[algorithms.parallel.overloads]</a> as indicated:</p>

<blockquote>
<p>
-4- Parallel algorithms shall not participate in overload resolution unless 
<tt>is_execution_policy_v&lt;<del>decay</del><ins>remove_cvref</ins>_t&lt;ExecutionPolicy&gt;&gt;</tt> 
is <tt>true</tt>.
</p>
</blockquote>
</li>
</ol>





</body>
</html>
